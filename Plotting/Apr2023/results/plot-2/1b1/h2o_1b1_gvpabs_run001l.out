--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0272.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 86217 MB
Rank =    1  Free Memory = 86213 MB
Rank =    2  Free Memory = 86213 MB
Rank =    3  Free Memory = 86213 MB
Rank =    4  Free Memory = 86213 MB
Rank =    5  Free Memory = 86213 MB
Rank =    6  Free Memory = 86213 MB
Rank =    7  Free Memory = 86213 MB
Rank =    8  Free Memory = 86213 MB
Rank =    9  Free Memory = 86213 MB
Rank =   10  Free Memory = 86213 MB
Rank =   11  Free Memory = 86213 MB
Rank =   12  Free Memory = 86213 MB
Rank =   13  Free Memory = 86213 MB
Rank =   14  Free Memory = 86213 MB
Rank =   15  Free Memory = 86213 MB
Rank =   16  Free Memory = 86213 MB
Rank =   17  Free Memory = 86213 MB
Rank =   18  Free Memory = 86213 MB
Rank =   19  Free Memory = 86213 MB
Rank =   20  Free Memory = 86213 MB
Rank =   21  Free Memory = 86213 MB
Rank =   22  Free Memory = 86212 MB
Rank =   23  Free Memory = 86212 MB
Rank =   24  Free Memory = 86211 MB
Rank =   25  Free Memory = 86211 MB
Rank =   26  Free Memory = 86211 MB
Rank =   27  Free Memory = 86211 MB
Rank =   28  Free Memory = 86211 MB
Rank =   29  Free Memory = 86211 MB
Rank =   30  Free Memory = 86211 MB
Rank =   31  Free Memory = 86211 MB
Rank =   32  Free Memory = 86211 MB
Rank =   33  Free Memory = 86211 MB
Rank =   34  Free Memory = 86211 MB
Rank =   35  Free Memory = 86211 MB
Rank =   36  Free Memory = 86211 MB
Rank =   37  Free Memory = 86211 MB
Rank =   38  Free Memory = 86211 MB
Rank =   39  Free Memory = 86211 MB
Rank =   40  Free Memory = 86206 MB
Rank =   41  Free Memory = 86206 MB
Rank =   42  Free Memory = 86206 MB
Rank =   43  Free Memory = 86206 MB
Rank =   44  Free Memory = 86206 MB
Rank =   45  Free Memory = 86206 MB
Rank =   46  Free Memory = 86206 MB
Rank =   47  Free Memory = 86206 MB
Rank =   48  Free Memory = 86206 MB
Rank =   49  Free Memory = 86206 MB
Rank =   50  Free Memory = 86206 MB
Rank =   51  Free Memory = 86206 MB
Rank =   52  Free Memory = 86206 MB
Rank =   53  Free Memory = 86206 MB
Rank =   54  Free Memory = 86206 MB
Rank =   55  Free Memory = 86205 MB
Rank =   56  Free Memory = 86205 MB
Rank =   57  Free Memory = 86205 MB
Rank =   58  Free Memory = 86205 MB
Rank =   59  Free Memory = 86205 MB
Rank =   60  Free Memory = 86205 MB
Rank =   61  Free Memory = 86205 MB
Rank =   62  Free Memory = 86205 MB
Rank =   63  Free Memory = 86205 MB
Rank =   64  Free Memory = 86205 MB
Rank =   65  Free Memory = 86205 MB
Rank =   66  Free Memory = 86205 MB
Rank =   67  Free Memory = 86205 MB
Rank =   68  Free Memory = 86205 MB
Rank =   69  Free Memory = 86205 MB
Rank =   70  Free Memory = 86205 MB
Rank =   71  Free Memory = 86205 MB
Rank =   72  Free Memory = 86205 MB
Rank =   73  Free Memory = 86205 MB
Rank =   74  Free Memory = 86205 MB
Rank =   75  Free Memory = 86205 MB
Rank =   76  Free Memory = 86205 MB
Rank =   77  Free Memory = 86205 MB
Rank =   78  Free Memory = 86205 MB
Rank =   79  Free Memory = 86205 MB
Rank =   80  Free Memory = 86187 MB
Rank =   81  Free Memory = 86187 MB
Rank =   82  Free Memory = 86187 MB
Rank =   83  Free Memory = 86187 MB
Rank =   84  Free Memory = 86187 MB
Rank =   85  Free Memory = 86187 MB
Rank =   86  Free Memory = 86187 MB
Rank =   87  Free Memory = 86187 MB
Rank =   88  Free Memory = 86187 MB
Rank =   89  Free Memory = 86186 MB
Rank =   90  Free Memory = 86186 MB
Rank =   91  Free Memory = 86186 MB
Rank =   92  Free Memory = 86186 MB
Rank =   93  Free Memory = 86186 MB
Rank =   94  Free Memory = 86186 MB
Rank =   95  Free Memory = 86186 MB
Rank =   96  Free Memory = 86186 MB
Rank =   97  Free Memory = 86186 MB
Rank =   98  Free Memory = 86186 MB
Rank =   99  Free Memory = 86186 MB
Rank =  100  Free Memory = 86186 MB
Rank =  101  Free Memory = 86186 MB
Rank =  102  Free Memory = 86186 MB
Rank =  103  Free Memory = 86186 MB
Rank =  104  Free Memory = 86186 MB
Rank =  105  Free Memory = 86186 MB
Rank =  106  Free Memory = 86186 MB
Rank =  107  Free Memory = 86186 MB
Rank =  108  Free Memory = 86186 MB
Rank =  109  Free Memory = 86186 MB
Rank =  110  Free Memory = 86186 MB
Rank =  111  Free Memory = 86186 MB
Rank =  112  Free Memory = 86186 MB
Rank =  113  Free Memory = 86186 MB
Rank =  114  Free Memory = 86186 MB
Rank =  115  Free Memory = 86186 MB
Rank =  116  Free Memory = 86186 MB
Rank =  117  Free Memory = 86186 MB
Rank =  118  Free Memory = 86186 MB
Rank =  119  Free Memory = 86186 MB
Rank =  120  Free Memory = 87551 MB
Rank =  121  Free Memory = 87551 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001l.xml 
Rank =  127  Free Memory = 87551 MB
Rank =  122  Free Memory = 87551 MB
Rank =  123  Free Memory = 87551 MB
Rank =  124  Free Memory = 87551 MB
Rank =  125  Free Memory = 87551 MB
Rank =  126  Free Memory = 87551 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001l.xml

  Project = H2O
  date    = 2023-04-09 18:40:35 PDT
  host    = n0269.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 275

  Range of prime numbers to use as seeds over processors and threads = 1787-2789


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.093277e-01    1         1  ON     0
     uu_1                 1.425510e-01    1         1  ON     1
     uu_2                 4.102135e-02    1         1  ON     2
     uu_3                -2.135614e-02    1         1  ON     3
     uu_4                -6.669367e-02    1         1  ON     4
     uu_5                -1.013436e-01    1         1  ON     5
     uu_6                -1.284506e-01    1         1  ON     6
     uu_7                -1.417467e-01    1         1  ON     7
     uu_8                -1.335961e-01    1         1  ON     8
     uu_9                -1.050511e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.482036e-01    1         1  ON     0
     ud_1                 1.827664e-01    1         1  ON     1
     ud_2                 6.290547e-02    1         1  ON     2
     ud_3                -7.758491e-03    1         1  ON     3
     ud_4                -6.501466e-02    1         1  ON     4
     ud_5                -1.070518e-01    1         1  ON     5
     ud_6                -1.350173e-01    1         1  ON     6
     ud_7                -1.521298e-01    1         1  ON     7
     ud_8                -1.529889e-01    1         1  ON     8
     ud_9                -1.433617e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.602773e-01    1         1  ON     0
     eO_1                -4.397309e-01    1         1  ON     1
     eO_2                -2.161160e-02    1         1  ON     2
     eO_3                 2.988306e-01    1         1  ON     3
     eO_4                 5.254958e-01    1         1  ON     4
     eO_5                 4.878281e-01    1         1  ON     5
     eO_6                 2.599664e-01    1         1  ON     6
     eO_7                -4.072177e-02    1         1  ON     7
     eO_8                -2.216063e-01    1         1  ON     8
     eO_9                -8.672801e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.451242e-01    1         1  ON     0
     eH1_1                -1.455150e-01    1         1  ON     1
     eH1_2                -9.862932e-02    1         1  ON     2
     eH1_3                -4.477166e-02    1         1  ON     3
     eH1_4                 3.406351e-03    1         1  ON     4
     eH1_5                 3.809184e-02    1         1  ON     5
     eH1_6                 9.666626e-02    1         1  ON     6
     eH1_7                 1.541688e-01    1         1  ON     7
     eH1_8                 1.774576e-01    1         1  ON     8
     eH1_9                 6.824346e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.428643e-01    1         1  ON     0
     eH2_1                -1.431128e-01    1         1  ON     1
     eH2_2                -9.652510e-02    1         1  ON     2
     eH2_3                -4.249329e-02    1         1  ON     3
     eH2_4                 5.715583e-03    1         1  ON     4
     eH2_5                 4.026007e-02    1         1  ON     5
     eH2_6                 9.939527e-02    1         1  ON     6
     eH2_7                 1.552796e-01    1         1  ON     7
     eH2_8                 1.829606e-01    1         1  ON     8
     eH2_9                 5.788089e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 8.649449e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.6795e+00 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0269.savio3:56073] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0269.savio3:56073] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.951
    reference variance = 0.217558
====================================================
  Execution time = 2.0736e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3458e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334575547531
                                         uncertainty =       0.002840659388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334575547531
                                         uncertainty =       0.002840659388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409011756
  error estimate for blocks of size 2^( 2) =       0.000421219314
  error estimate for blocks of size 2^( 3) =       0.000434421010
  error estimate for blocks of size 2^( 4) =       0.000447594403
  error estimate for blocks of size 2^( 5) =       0.000458634762
  error estimate for blocks of size 2^( 6) =       0.000467362852
  error estimate for blocks of size 2^( 7) =       0.000470494646

      target function =                  N/A
              le_mean =     -16.905538374577
             les_mean =     286.131808800792
             stat err =       0.000461021666
             autocorr =       1.270489523487
              std dev =       0.578429973106
             le_variance =       0.334581233787


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690553837458e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905538374577       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905543320601       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905549010052       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905549741642       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905552373251       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905551728665       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905551786501       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905551764134       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905551821710       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905552065048       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.474880e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905538374577       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905540194509       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905541763692       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905542121801       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905543247120       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905542855076       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905542866359       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905542817029       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905542874811       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.194685e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905538374577       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905538890406       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905539255570       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905539427296       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905539711860       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905539591961       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905539611668       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905539596592       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905539608736       residual = 8.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.088048e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6424e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.093825e-01                 1 1 ON  0
uu_1  1.426307e-01                 1 1 ON  1
uu_2  4.101066e-02                 1 1 ON  2
uu_3  -2.128217e-02                1 1 ON  3
uu_4  -6.670927e-02                1 1 ON  4
uu_5  -1.013862e-01                1 1 ON  5
uu_6  -1.284039e-01                1 1 ON  6
uu_7  -1.418574e-01                1 1 ON  7
uu_8  -1.337377e-01                1 1 ON  8
uu_9  -1.051399e-01                1 1 ON  9
ud_0  4.483816e-01                 1 1 ON  10
ud_1  1.829672e-01                 1 1 ON  11
ud_2  6.294566e-02                 1 1 ON  12
ud_3  -7.874506e-03                1 1 ON  13
ud_4  -6.510752e-02                1 1 ON  14
ud_5  -1.071122e-01                1 1 ON  15
ud_6  -1.351301e-01                1 1 ON  16
ud_7  -1.521812e-01                1 1 ON  17
ud_8  -1.529908e-01                1 1 ON  18
ud_9  -1.433267e-01                1 1 ON  19
eO_0  -7.603919e-01                1 1 ON  20
eO_1  -4.395837e-01                1 1 ON  21
eO_2  -2.163104e-02                1 1 ON  22
eO_3  2.988719e-01                 1 1 ON  23
eO_4  5.255801e-01                 1 1 ON  24
eO_5  4.878376e-01                 1 1 ON  25
eO_6  2.600325e-01                 1 1 ON  26
eO_7  -4.072856e-02                1 1 ON  27
eO_8  -2.216905e-01                1 1 ON  28
eO_9  -8.683236e-02                1 1 ON  29
eH1_0 -2.455246e-01                1 1 ON  30
eH1_1 -1.456113e-01                1 1 ON  31
eH1_2 -9.859696e-02                1 1 ON  32
eH1_3 -4.474238e-02                1 1 ON  33
eH1_4 3.475487e-03                 1 1 ON  34
eH1_5 3.811625e-02                 1 1 ON  35
eH1_6 9.664870e-02                 1 1 ON  36
eH1_7 1.542076e-01                 1 1 ON  37
eH1_8 1.775942e-01                 1 1 ON  38
eH1_9 6.842090e-02                 1 1 ON  39
eH2_0 -2.432838e-01                1 1 ON  40
eH2_1 -1.432634e-01                1 1 ON  41
eH2_2 -9.649196e-02                1 1 ON  42
eH2_3 -4.247650e-02                1 1 ON  43
eH2_4 5.811109e-03                 1 1 ON  44
eH2_5 4.027104e-02                 1 1 ON  45
eH2_6 9.943775e-02                 1 1 ON  46
eH2_7 1.553838e-01                 1 1 ON  47
eH2_8 1.830503e-01                 1 1 ON  48
eH2_9 5.804582e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9623
    reference variance = 0.196196
====================================================
  Execution time = 2.3195e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4016e-01
  Total weights = 2.0000e+06
  Execution time = 1.8861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340130760896
                                         uncertainty =       0.003949887949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340130760896
                                         uncertainty =       0.003949887949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412361369
  error estimate for blocks of size 2^( 2) =       0.000424886433
  error estimate for blocks of size 2^( 3) =       0.000438149360
  error estimate for blocks of size 2^( 4) =       0.000450251713
  error estimate for blocks of size 2^( 5) =       0.000459937182
  error estimate for blocks of size 2^( 6) =       0.000468060375
  error estimate for blocks of size 2^( 7) =       0.000474464498

      target function =                  N/A
              le_mean =     -16.906624241973
             les_mean =     286.174026887280
             stat err =       0.000463178442
             autocorr =       1.261655335579
              std dev =       0.583167041293
             le_variance =       0.340083798050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340388389820
                                         uncertainty =       0.003962894344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340388389820
                                         uncertainty =       0.003962894344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412517527
  error estimate for blocks of size 2^( 2) =       0.000425023157
  error estimate for blocks of size 2^( 3) =       0.000438264765
  error estimate for blocks of size 2^( 4) =       0.000450354002
  error estimate for blocks of size 2^( 5) =       0.000460042420
  error estimate for blocks of size 2^( 6) =       0.000468154222
  error estimate for blocks of size 2^( 7) =       0.000474560902

      target function =                  N/A
              le_mean =     -16.906624880177
             les_mean =     286.174306088670
             stat err =       0.000463277887
             autocorr =       1.261241728375
              std dev =       0.583387881094
             le_variance =       0.340341419807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340288006548
                                         uncertainty =       0.003959923788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340288006548
                                         uncertainty =       0.003959923788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412456694
  error estimate for blocks of size 2^( 2) =       0.000424968391
  error estimate for blocks of size 2^( 3) =       0.000438215625
  error estimate for blocks of size 2^( 4) =       0.000450308606
  error estimate for blocks of size 2^( 5) =       0.000459995198
  error estimate for blocks of size 2^( 6) =       0.000468108402
  error estimate for blocks of size 2^( 7) =       0.000474514179

      target function =                  N/A
              le_mean =     -16.906623703148
             les_mean =     286.174165919116
             stat err =       0.000463231596
             autocorr =       1.261361686353
              std dev =       0.583301850998
             le_variance =       0.340241049378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340147483689
                                         uncertainty =       0.003951354301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340147483689
                                         uncertainty =       0.003951354301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412371509
  error estimate for blocks of size 2^( 2) =       0.000424894748
  error estimate for blocks of size 2^( 3) =       0.000438155420
  error estimate for blocks of size 2^( 4) =       0.000450256449
  error estimate for blocks of size 2^( 5) =       0.000459942022
  error estimate for blocks of size 2^( 6) =       0.000468063644
  error estimate for blocks of size 2^( 7) =       0.000474467954

      target function =                  N/A
              le_mean =     -16.906623916435
             les_mean =     286.174032603985
             stat err =       0.000463182517
             autocorr =       1.261615495725
              std dev =       0.583181380233
             le_variance =       0.340100522251


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906624241973        initial
     2.5000e-01     2.5000e+00             1.4749e-03       -16.906624880177  <--
     1.0000e+00     1.0000e+01             4.1947e-04       -16.906623703148
     4.0000e+00     4.0000e+01             1.0880e-04       -16.906623916435

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.2719e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.095759e-01 1 1  ON 0
 uu_1                 1.427787e-01 1 1  ON 1
 uu_2                 4.108691e-02 1 1  ON 2
 uu_3                -2.116687e-02 1 1  ON 3
 uu_4                -6.672037e-02 1 1  ON 4
 uu_5                -1.014689e-01 1 1  ON 5
 uu_6                -1.283766e-01 1 1  ON 6
 uu_7                -1.421155e-01 1 1  ON 7
 uu_8                -1.341212e-01 1 1  ON 8
 uu_9                -1.054049e-01 1 1  ON 9
 ud_0                 4.487888e-01 1 1  ON 10
 ud_1                 1.833027e-01 1 1  ON 11
 ud_2                 6.306247e-02 1 1  ON 12
 ud_3                -8.021399e-03 1 1  ON 13
 ud_4                -6.531540e-02 1 1  ON 14
 ud_5                -1.072785e-01 1 1  ON 15
 ud_6                -1.353719e-01 1 1  ON 16
 ud_7                -1.523218e-01 1 1  ON 17
 ud_8                -1.529962e-01 1 1  ON 18
 ud_9                -1.432243e-01 1 1  ON 19
 eO_0                -7.605551e-01 1 1  ON 20
 eO_1                -4.393528e-01 1 1  ON 21
 eO_2                -2.157596e-02 1 1  ON 22
 eO_3                 2.988845e-01 1 1  ON 23
 eO_4                 5.257932e-01 1 1  ON 24
 eO_5                 4.878913e-01 1 1  ON 25
 eO_6                 2.602294e-01 1 1  ON 26
 eO_7                -4.073251e-02 1 1  ON 27
 eO_8                -2.219299e-01 1 1  ON 28
 eO_9                -8.713335e-02 1 1  ON 29
eH1_0                -2.465158e-01 1 1  ON 30
eH1_1                -1.458614e-01 1 1  ON 31
eH1_2                -9.861015e-02 1 1  ON 32
eH1_3                -4.467536e-02 1 1  ON 33
eH1_4                 3.598039e-03 1 1  ON 34
eH1_5                 3.818619e-02 1 1  ON 35
eH1_6                 9.661085e-02 1 1  ON 36
eH1_7                 1.543155e-01 1 1  ON 37
eH1_8                 1.779887e-01 1 1  ON 38
eH1_9                 6.893315e-02 1 1  ON 39
eH2_0                -2.443392e-01 1 1  ON 40
eH2_1                -1.436004e-01 1 1  ON 41
eH2_2                -9.652943e-02 1 1  ON 42
eH2_3                -4.245975e-02 1 1  ON 43
eH2_4                 5.973443e-03 1 1  ON 44
eH2_5                 4.032212e-02 1 1  ON 45
eH2_6                 9.956696e-02 1 1  ON 46
eH2_7                 1.556794e-01 1 1  ON 47
eH2_8                 1.833131e-01 1 1  ON 48
eH2_9                 5.852219e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9200e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6957e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9553
    reference variance = 0.321511
====================================================
  Execution time = 2.1126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4526e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345303764269
                                         uncertainty =       0.004454148220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345303764269
                                         uncertainty =       0.004454148220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415486229
  error estimate for blocks of size 2^( 2) =       0.000428079144
  error estimate for blocks of size 2^( 3) =       0.000440437831
  error estimate for blocks of size 2^( 4) =       0.000452714269
  error estimate for blocks of size 2^( 5) =       0.000462922962
  error estimate for blocks of size 2^( 6) =       0.000471021826
  error estimate for blocks of size 2^( 7) =       0.000474692569

      target function =                  N/A
              le_mean =     -16.905718963230
             les_mean =     286.148591104106
             stat err =       0.000465337907
             autocorr =       1.254364040725
              std dev =       0.587586260065
             le_variance =       0.345257613017


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690571896323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905718963230       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905721351592       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905724469431       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905727790338       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905726505618       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905728176775       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905725989259       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905725108366       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905725680663       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905727500940       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905727692688       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905727764389       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905727920494       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905727698673       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.493380e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905718963230       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905720324209       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905723267400       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905724458831       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905723433796       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905723829894       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905723795921       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905722971740       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905723226872       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905723420336       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.038859e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905718963230       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905719463471       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905720981110       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905721011587       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905720780814       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905720818107       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905720936872       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905720785848       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905720758089       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.831326e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122136 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6757e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.096992e-01 1 1  ON 0
 uu_1                 1.429758e-01 1 1  ON 1
 uu_2                 4.125786e-02 1 1  ON 2
 uu_3                -2.113141e-02 1 1  ON 3
 uu_4                -6.675567e-02 1 1  ON 4
 uu_5                -1.014147e-01 1 1  ON 5
 uu_6                -1.287912e-01 1 1  ON 6
 uu_7                -1.424247e-01 1 1  ON 7
 uu_8                -1.343870e-01 1 1  ON 8
 uu_9                -1.055150e-01 1 1  ON 9
 ud_0                 4.492524e-01 1 1  ON 10
 ud_1                 1.835158e-01 1 1  ON 11
 ud_2                 6.302315e-02 1 1  ON 12
 ud_3                -8.198508e-03 1 1  ON 13
 ud_4                -6.547104e-02 1 1  ON 14
 ud_5                -1.075204e-01 1 1  ON 15
 ud_6                -1.354777e-01 1 1  ON 16
 ud_7                -1.519796e-01 1 1  ON 17
 ud_8                -1.528826e-01 1 1  ON 18
 ud_9                -1.432085e-01 1 1  ON 19
 eO_0                -7.605489e-01 1 1  ON 20
 eO_1                -4.393005e-01 1 1  ON 21
 eO_2                -2.135792e-02 1 1  ON 22
 eO_3                 2.987709e-01 1 1  ON 23
 eO_4                 5.260397e-01 1 1  ON 24
 eO_5                 4.882316e-01 1 1  ON 25
 eO_6                 2.601852e-01 1 1  ON 26
 eO_7                -4.062282e-02 1 1  ON 27
 eO_8                -2.221910e-01 1 1  ON 28
 eO_9                -8.756822e-02 1 1  ON 29
eH1_0                -2.475546e-01 1 1  ON 30
eH1_1                -1.464060e-01 1 1  ON 31
eH1_2                -9.867025e-02 1 1  ON 32
eH1_3                -4.451074e-02 1 1  ON 33
eH1_4                 3.586748e-03 1 1  ON 34
eH1_5                 3.792497e-02 1 1  ON 35
eH1_6                 9.687469e-02 1 1  ON 36
eH1_7                 1.545387e-01 1 1  ON 37
eH1_8                 1.785080e-01 1 1  ON 38
eH1_9                 6.962858e-02 1 1  ON 39
eH2_0                -2.452547e-01 1 1  ON 40
eH2_1                -1.441121e-01 1 1  ON 41
eH2_2                -9.665355e-02 1 1  ON 42
eH2_3                -4.232710e-02 1 1  ON 43
eH2_4                 5.910568e-03 1 1  ON 44
eH2_5                 4.021961e-02 1 1  ON 45
eH2_6                 9.962439e-02 1 1  ON 46
eH2_7                 1.558179e-01 1 1  ON 47
eH2_8                 1.836858e-01 1 1  ON 48
eH2_9                 5.938074e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8494
    reference variance = 0.214899
====================================================
  Execution time = 2.0173e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4508e-01
  Total weights = 2.0000e+06
  Execution time = 1.8893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344890181564
                                         uncertainty =       0.004710021430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344890181564
                                         uncertainty =       0.004710021430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415198880
  error estimate for blocks of size 2^( 2) =       0.000427842684
  error estimate for blocks of size 2^( 3) =       0.000441164773
  error estimate for blocks of size 2^( 4) =       0.000452967663
  error estimate for blocks of size 2^( 5) =       0.000463530831
  error estimate for blocks of size 2^( 6) =       0.000470463629
  error estimate for blocks of size 2^( 7) =       0.000475673038

      target function =                  N/A
              le_mean =     -16.906728679257
             les_mean =     286.182254681727
             stat err =       0.000465658790
             autocorr =       1.257833810911
              std dev =       0.587179887341
             le_variance =       0.344780220098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345460781547
                                         uncertainty =       0.004712025839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345460781547
                                         uncertainty =       0.004712025839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415542328
  error estimate for blocks of size 2^( 2) =       0.000428158353
  error estimate for blocks of size 2^( 3) =       0.000441451768
  error estimate for blocks of size 2^( 4) =       0.000453228778
  error estimate for blocks of size 2^( 5) =       0.000463784943
  error estimate for blocks of size 2^( 6) =       0.000470688935
  error estimate for blocks of size 2^( 7) =       0.000475910456

      target function =                  N/A
              le_mean =     -16.906724494498
             les_mean =     286.182683812162
             stat err =       0.000465903278
             autocorr =       1.257074440477
              std dev =       0.587665595374
             le_variance =       0.345350851986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345501368370
                                         uncertainty =       0.004712170154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345501368370
                                         uncertainty =       0.004712170154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415566763
  error estimate for blocks of size 2^( 2) =       0.000428179540
  error estimate for blocks of size 2^( 3) =       0.000441471473
  error estimate for blocks of size 2^( 4) =       0.000453249303
  error estimate for blocks of size 2^( 5) =       0.000463806831
  error estimate for blocks of size 2^( 6) =       0.000470712074
  error estimate for blocks of size 2^( 7) =       0.000475940270

      target function =                  N/A
              le_mean =     -16.906725724227
             les_mean =     286.182766010139
             stat err =       0.000465927119
             autocorr =       1.257055255710
              std dev =       0.587700151954
             le_variance =       0.345391468607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345019534507
                                         uncertainty =       0.004710593310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345019534507
                                         uncertainty =       0.004710593310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415276763
  error estimate for blocks of size 2^( 2) =       0.000427913684
  error estimate for blocks of size 2^( 3) =       0.000441229066
  error estimate for blocks of size 2^( 4) =       0.000453026488
  error estimate for blocks of size 2^( 5) =       0.000463588276
  error estimate for blocks of size 2^( 6) =       0.000470515958
  error estimate for blocks of size 2^( 7) =       0.000475728837

      target function =                  N/A
              le_mean =     -16.906727472253
             les_mean =     286.182343227966
             stat err =       0.000465714890
             autocorr =       1.257665031149
              std dev =       0.587290030050
             le_variance =       0.344909579396


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906728679257        initial  <--
     6.2500e-02     6.2500e-01             3.4934e-03       -16.906724494498
     2.5000e-01     2.5000e+00             1.0389e-03       -16.906725724227
     1.0000e+00     1.0000e+01             2.8313e-04       -16.906727472253

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6928
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.095759e-01 1 1  ON 0
 uu_1                 1.427787e-01 1 1  ON 1
 uu_2                 4.108691e-02 1 1  ON 2
 uu_3                -2.116687e-02 1 1  ON 3
 uu_4                -6.672037e-02 1 1  ON 4
 uu_5                -1.014689e-01 1 1  ON 5
 uu_6                -1.283766e-01 1 1  ON 6
 uu_7                -1.421155e-01 1 1  ON 7
 uu_8                -1.341212e-01 1 1  ON 8
 uu_9                -1.054049e-01 1 1  ON 9
 ud_0                 4.487888e-01 1 1  ON 10
 ud_1                 1.833027e-01 1 1  ON 11
 ud_2                 6.306247e-02 1 1  ON 12
 ud_3                -8.021399e-03 1 1  ON 13
 ud_4                -6.531540e-02 1 1  ON 14
 ud_5                -1.072785e-01 1 1  ON 15
 ud_6                -1.353719e-01 1 1  ON 16
 ud_7                -1.523218e-01 1 1  ON 17
 ud_8                -1.529962e-01 1 1  ON 18
 ud_9                -1.432243e-01 1 1  ON 19
 eO_0                -7.605551e-01 1 1  ON 20
 eO_1                -4.393528e-01 1 1  ON 21
 eO_2                -2.157596e-02 1 1  ON 22
 eO_3                 2.988845e-01 1 1  ON 23
 eO_4                 5.257932e-01 1 1  ON 24
 eO_5                 4.878913e-01 1 1  ON 25
 eO_6                 2.602294e-01 1 1  ON 26
 eO_7                -4.073251e-02 1 1  ON 27
 eO_8                -2.219299e-01 1 1  ON 28
 eO_9                -8.713335e-02 1 1  ON 29
eH1_0                -2.465158e-01 1 1  ON 30
eH1_1                -1.458614e-01 1 1  ON 31
eH1_2                -9.861015e-02 1 1  ON 32
eH1_3                -4.467536e-02 1 1  ON 33
eH1_4                 3.598039e-03 1 1  ON 34
eH1_5                 3.818619e-02 1 1  ON 35
eH1_6                 9.661085e-02 1 1  ON 36
eH1_7                 1.543155e-01 1 1  ON 37
eH1_8                 1.779887e-01 1 1  ON 38
eH1_9                 6.893315e-02 1 1  ON 39
eH2_0                -2.443392e-01 1 1  ON 40
eH2_1                -1.436004e-01 1 1  ON 41
eH2_2                -9.652943e-02 1 1  ON 42
eH2_3                -4.245975e-02 1 1  ON 43
eH2_4                 5.973443e-03 1 1  ON 44
eH2_5                 4.032212e-02 1 1  ON 45
eH2_6                 9.956696e-02 1 1  ON 46
eH2_7                 1.556794e-01 1 1  ON 47
eH2_8                 1.833131e-01 1 1  ON 48
eH2_9                 5.852219e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6462e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9262
    reference variance = 0.290494
====================================================
  Execution time = 2.0867e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3844e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338501964009
                                         uncertainty =       0.003271463624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338501964009
                                         uncertainty =       0.003271463624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411365673
  error estimate for blocks of size 2^( 2) =       0.000423902793
  error estimate for blocks of size 2^( 3) =       0.000436357370
  error estimate for blocks of size 2^( 4) =       0.000448556021
  error estimate for blocks of size 2^( 5) =       0.000460057754
  error estimate for blocks of size 2^( 6) =       0.000467306826
  error estimate for blocks of size 2^( 7) =       0.000473170611

      target function =                  N/A
              le_mean =     -16.906222228535
             les_mean =     286.158793305603
             stat err =       0.000462272803
             autocorr =       1.262817492255
              std dev =       0.581758914164
             le_variance =       0.338443434209


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622222854e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906222228535       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906224075408       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906224251650       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906224727360       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906224543354       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906224765851       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906224691731       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906224508091       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906224557788       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.862587e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906222228535       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906222778533       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906222889117       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223043432       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906222958190       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906222879178       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906222954333       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906222906158       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.017090e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906222228535       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906222372937       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906222408906       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906222448773       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906222425555       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906222396349       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906222418170       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906222406888       residual = 5.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.573390e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124982 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6572e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.095627e-01 1 1  ON 0
 uu_1                 1.428091e-01 1 1  ON 1
 uu_2                 4.112900e-02 1 1  ON 2
 uu_3                -2.115492e-02 1 1  ON 3
 uu_4                -6.672547e-02 1 1  ON 4
 uu_5                -1.014854e-01 1 1  ON 5
 uu_6                -1.284395e-01 1 1  ON 6
 uu_7                -1.421532e-01 1 1  ON 7
 uu_8                -1.341449e-01 1 1  ON 8
 uu_9                -1.054157e-01 1 1  ON 9
 ud_0                 4.488087e-01 1 1  ON 10
 ud_1                 1.833109e-01 1 1  ON 11
 ud_2                 6.307297e-02 1 1  ON 12
 ud_3                -8.020825e-03 1 1  ON 13
 ud_4                -6.534401e-02 1 1  ON 14
 ud_5                -1.072713e-01 1 1  ON 15
 ud_6                -1.353012e-01 1 1  ON 16
 ud_7                -1.523016e-01 1 1  ON 17
 ud_8                -1.530343e-01 1 1  ON 18
 ud_9                -1.432650e-01 1 1  ON 19
 eO_0                -7.605577e-01 1 1  ON 20
 eO_1                -4.393106e-01 1 1  ON 21
 eO_2                -2.158893e-02 1 1  ON 22
 eO_3                 2.988784e-01 1 1  ON 23
 eO_4                 5.258114e-01 1 1  ON 24
 eO_5                 4.879343e-01 1 1  ON 25
 eO_6                 2.602607e-01 1 1  ON 26
 eO_7                -4.073349e-02 1 1  ON 27
 eO_8                -2.219743e-01 1 1  ON 28
 eO_9                -8.718730e-02 1 1  ON 29
eH1_0                -2.466175e-01 1 1  ON 30
eH1_1                -1.458965e-01 1 1  ON 31
eH1_2                -9.861857e-02 1 1  ON 32
eH1_3                -4.465283e-02 1 1  ON 33
eH1_4                 3.595752e-03 1 1  ON 34
eH1_5                 3.816756e-02 1 1  ON 35
eH1_6                 9.659406e-02 1 1  ON 36
eH1_7                 1.543029e-01 1 1  ON 37
eH1_8                 1.780746e-01 1 1  ON 38
eH1_9                 6.901944e-02 1 1  ON 39
eH2_0                -2.444257e-01 1 1  ON 40
eH2_1                -1.436051e-01 1 1  ON 41
eH2_2                -9.654396e-02 1 1  ON 42
eH2_3                -4.245287e-02 1 1  ON 43
eH2_4                 5.953491e-03 1 1  ON 44
eH2_5                 4.028787e-02 1 1  ON 45
eH2_6                 9.956281e-02 1 1  ON 46
eH2_7                 1.557259e-01 1 1  ON 47
eH2_8                 1.833580e-01 1 1  ON 48
eH2_9                 5.858373e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8796
    reference variance = 0.325688
====================================================
  Execution time = 2.0212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3963e-01
  Total weights = 2.0000e+06
  Execution time = 1.8850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339589293289
                                         uncertainty =       0.005552754490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339589293289
                                         uncertainty =       0.005552754490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412091615
  error estimate for blocks of size 2^( 2) =       0.000424494146
  error estimate for blocks of size 2^( 3) =       0.000437854337
  error estimate for blocks of size 2^( 4) =       0.000449686670
  error estimate for blocks of size 2^( 5) =       0.000459733798
  error estimate for blocks of size 2^( 6) =       0.000466336257
  error estimate for blocks of size 2^( 7) =       0.000472086757

      target function =                  N/A
              le_mean =     -16.905455540150
             les_mean =     286.134065847757
             stat err =       0.000461960870
             autocorr =       1.256674570788
              std dev =       0.582785550258
             le_variance =       0.339638997590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339570725908
                                         uncertainty =       0.005552369510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339570725908
                                         uncertainty =       0.005552369510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412080376
  error estimate for blocks of size 2^( 2) =       0.000424478798
  error estimate for blocks of size 2^( 3) =       0.000437835490
  error estimate for blocks of size 2^( 4) =       0.000449666731
  error estimate for blocks of size 2^( 5) =       0.000459718144
  error estimate for blocks of size 2^( 6) =       0.000466320723
  error estimate for blocks of size 2^( 7) =       0.000472080524

      target function =                  N/A
              le_mean =     -16.905454320522
             les_mean =     286.134006086482
             stat err =       0.000461946530
             autocorr =       1.256665095124
              std dev =       0.582769656918
             le_variance =       0.339620473024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339573316605
                                         uncertainty =       0.005552370906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339573316605
                                         uncertainty =       0.005552370906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412081941
  error estimate for blocks of size 2^( 2) =       0.000424482118
  error estimate for blocks of size 2^( 3) =       0.000437840422
  error estimate for blocks of size 2^( 4) =       0.000449672134
  error estimate for blocks of size 2^( 5) =       0.000459722007
  error estimate for blocks of size 2^( 6) =       0.000466324330
  error estimate for blocks of size 2^( 7) =       0.000472080831

      target function =                  N/A
              le_mean =     -16.905454894590
             les_mean =     286.134028075330
             stat err =       0.000461949825
             autocorr =       1.256673478781
              std dev =       0.582771869719
             le_variance =       0.339623052136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339586900320
                                         uncertainty =       0.005552694849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339586900320
                                         uncertainty =       0.005552694849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412090165
  error estimate for blocks of size 2^( 2) =       0.000424492387
  error estimate for blocks of size 2^( 3) =       0.000437852334
  error estimate for blocks of size 2^( 4) =       0.000449684583
  error estimate for blocks of size 2^( 5) =       0.000459732071
  error estimate for blocks of size 2^( 6) =       0.000466334503
  error estimate for blocks of size 2^( 7) =       0.000472085810

      target function =                  N/A
              le_mean =     -16.905455447348
             les_mean =     286.134060321050
             stat err =       0.000461959242
             autocorr =       1.256674550255
              std dev =       0.582783500632
             le_variance =       0.339636608609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905455540150        initial  <--
     6.2500e-01     6.2500e+00             3.8626e-04       -16.905454320522
     2.5000e+00     2.5000e+01             1.0171e-04       -16.905454894590
     1.0000e+01     1.0000e+02             2.5734e-05       -16.905455447348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8782
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.095759e-01 1 1  ON 0
 uu_1                 1.427787e-01 1 1  ON 1
 uu_2                 4.108691e-02 1 1  ON 2
 uu_3                -2.116687e-02 1 1  ON 3
 uu_4                -6.672037e-02 1 1  ON 4
 uu_5                -1.014689e-01 1 1  ON 5
 uu_6                -1.283766e-01 1 1  ON 6
 uu_7                -1.421155e-01 1 1  ON 7
 uu_8                -1.341212e-01 1 1  ON 8
 uu_9                -1.054049e-01 1 1  ON 9
 ud_0                 4.487888e-01 1 1  ON 10
 ud_1                 1.833027e-01 1 1  ON 11
 ud_2                 6.306247e-02 1 1  ON 12
 ud_3                -8.021399e-03 1 1  ON 13
 ud_4                -6.531540e-02 1 1  ON 14
 ud_5                -1.072785e-01 1 1  ON 15
 ud_6                -1.353719e-01 1 1  ON 16
 ud_7                -1.523218e-01 1 1  ON 17
 ud_8                -1.529962e-01 1 1  ON 18
 ud_9                -1.432243e-01 1 1  ON 19
 eO_0                -7.605551e-01 1 1  ON 20
 eO_1                -4.393528e-01 1 1  ON 21
 eO_2                -2.157596e-02 1 1  ON 22
 eO_3                 2.988845e-01 1 1  ON 23
 eO_4                 5.257932e-01 1 1  ON 24
 eO_5                 4.878913e-01 1 1  ON 25
 eO_6                 2.602294e-01 1 1  ON 26
 eO_7                -4.073251e-02 1 1  ON 27
 eO_8                -2.219299e-01 1 1  ON 28
 eO_9                -8.713335e-02 1 1  ON 29
eH1_0                -2.465158e-01 1 1  ON 30
eH1_1                -1.458614e-01 1 1  ON 31
eH1_2                -9.861015e-02 1 1  ON 32
eH1_3                -4.467536e-02 1 1  ON 33
eH1_4                 3.598039e-03 1 1  ON 34
eH1_5                 3.818619e-02 1 1  ON 35
eH1_6                 9.661085e-02 1 1  ON 36
eH1_7                 1.543155e-01 1 1  ON 37
eH1_8                 1.779887e-01 1 1  ON 38
eH1_9                 6.893315e-02 1 1  ON 39
eH2_0                -2.443392e-01 1 1  ON 40
eH2_1                -1.436004e-01 1 1  ON 41
eH2_2                -9.652943e-02 1 1  ON 42
eH2_3                -4.245975e-02 1 1  ON 43
eH2_4                 5.973443e-03 1 1  ON 44
eH2_5                 4.032212e-02 1 1  ON 45
eH2_6                 9.956696e-02 1 1  ON 46
eH2_7                 1.556794e-01 1 1  ON 47
eH2_8                 1.833131e-01 1 1  ON 48
eH2_9                 5.852219e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6767e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8693
    reference variance = 0.158108
====================================================
  Execution time = 2.0462e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4161e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341645985014
                                         uncertainty =       0.004854506343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341645985014
                                         uncertainty =       0.004854506343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413288356
  error estimate for blocks of size 2^( 2) =       0.000426539894
  error estimate for blocks of size 2^( 3) =       0.000439740152
  error estimate for blocks of size 2^( 4) =       0.000451902649
  error estimate for blocks of size 2^( 5) =       0.000463146127
  error estimate for blocks of size 2^( 6) =       0.000472474096
  error estimate for blocks of size 2^( 7) =       0.000480031657

      target function =                  N/A
              le_mean =     -16.905864298489
             les_mean =     286.149862037904
             stat err =       0.000466888632
             autocorr =       1.276204468995
              std dev =       0.584477997696
             le_variance =       0.341614529791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690586429849e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864298489       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905864300492       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905864325359       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905864397382       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905864373797       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905864352124       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905864357207       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905864352318       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.689942e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864298489       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905864299001       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905864306017       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905864319789       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905864323179       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905864313792       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905864313492       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905864312310       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.175690e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864298489       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905864298618       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905864300424       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905864303557       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905864304644       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905864302335       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905864302278       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905864301970       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.941195e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127647 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6129e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.095746e-01 1 1  ON 0
 uu_1                 1.427807e-01 1 1  ON 1
 uu_2                 4.108880e-02 1 1  ON 2
 uu_3                -2.116598e-02 1 1  ON 3
 uu_4                -6.672065e-02 1 1  ON 4
 uu_5                -1.014658e-01 1 1  ON 5
 uu_6                -1.283793e-01 1 1  ON 6
 uu_7                -1.421150e-01 1 1  ON 7
 uu_8                -1.341284e-01 1 1  ON 8
 uu_9                -1.054085e-01 1 1  ON 9
 ud_0                 4.487988e-01 1 1  ON 10
 ud_1                 1.833085e-01 1 1  ON 11
 ud_2                 6.305948e-02 1 1  ON 12
 ud_3                -8.025015e-03 1 1  ON 13
 ud_4                -6.532146e-02 1 1  ON 14
 ud_5                -1.072794e-01 1 1  ON 15
 ud_6                -1.353735e-01 1 1  ON 16
 ud_7                -1.523243e-01 1 1  ON 17
 ud_8                -1.529957e-01 1 1  ON 18
 ud_9                -1.432227e-01 1 1  ON 19
 eO_0                -7.605584e-01 1 1  ON 20
 eO_1                -4.393544e-01 1 1  ON 21
 eO_2                -2.156933e-02 1 1  ON 22
 eO_3                 2.988858e-01 1 1  ON 23
 eO_4                 5.257950e-01 1 1  ON 24
 eO_5                 4.878945e-01 1 1  ON 25
 eO_6                 2.602291e-01 1 1  ON 26
 eO_7                -4.073018e-02 1 1  ON 27
 eO_8                -2.219339e-01 1 1  ON 28
 eO_9                -8.713846e-02 1 1  ON 29
eH1_0                -2.465250e-01 1 1  ON 30
eH1_1                -1.458622e-01 1 1  ON 31
eH1_2                -9.861136e-02 1 1  ON 32
eH1_3                -4.467419e-02 1 1  ON 33
eH1_4                 3.597563e-03 1 1  ON 34
eH1_5                 3.818064e-02 1 1  ON 35
eH1_6                 9.661359e-02 1 1  ON 36
eH1_7                 1.543144e-01 1 1  ON 37
eH1_8                 1.779932e-01 1 1  ON 38
eH1_9                 6.894200e-02 1 1  ON 39
eH2_0                -2.443510e-01 1 1  ON 40
eH2_1                -1.436083e-01 1 1  ON 41
eH2_2                -9.652959e-02 1 1  ON 42
eH2_3                -4.245957e-02 1 1  ON 43
eH2_4                 5.976549e-03 1 1  ON 44
eH2_5                 4.032318e-02 1 1  ON 45
eH2_6                 9.956729e-02 1 1  ON 46
eH2_7                 1.556784e-01 1 1  ON 47
eH2_8                 1.833186e-01 1 1  ON 48
eH2_9                 5.853123e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9056
    reference variance = 0.288992
====================================================
  Execution time = 2.0537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3589e-01
  Total weights = 2.0000e+06
  Execution time = 1.8936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335894524533
                                         uncertainty =       0.003475580310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335894524533
                                         uncertainty =       0.003475580310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409807775
  error estimate for blocks of size 2^( 2) =       0.000422663917
  error estimate for blocks of size 2^( 3) =       0.000435392415
  error estimate for blocks of size 2^( 4) =       0.000448609677
  error estimate for blocks of size 2^( 5) =       0.000459384117
  error estimate for blocks of size 2^( 6) =       0.000467603494
  error estimate for blocks of size 2^( 7) =       0.000470231495

      target function =                  N/A
              le_mean =     -16.906178636901
             les_mean =     286.154760759150
             stat err =       0.000461457196
             autocorr =       1.267950964537
              std dev =       0.579555712826
             le_variance =       0.335884824269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335923624495
                                         uncertainty =       0.003475888646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335923624495
                                         uncertainty =       0.003475888646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409825533
  error estimate for blocks of size 2^( 2) =       0.000422680117
  error estimate for blocks of size 2^( 3) =       0.000435407100
  error estimate for blocks of size 2^( 4) =       0.000448623360
  error estimate for blocks of size 2^( 5) =       0.000459396727
  error estimate for blocks of size 2^( 6) =       0.000467616290
  error estimate for blocks of size 2^( 7) =       0.000470243494

      target function =                  N/A
              le_mean =     -16.906178744402
             les_mean =     286.154793505327
             stat err =       0.000461469968
             autocorr =       1.267911262389
              std dev =       0.579580827520
             le_variance =       0.335913935629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335909421036
                                         uncertainty =       0.003475738324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335909421036
                                         uncertainty =       0.003475738324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409816866
  error estimate for blocks of size 2^( 2) =       0.000422672205
  error estimate for blocks of size 2^( 3) =       0.000435399923
  error estimate for blocks of size 2^( 4) =       0.000448616668
  error estimate for blocks of size 2^( 5) =       0.000459390551
  error estimate for blocks of size 2^( 6) =       0.000467610015
  error estimate for blocks of size 2^( 7) =       0.000470237602

      target function =                  N/A
              le_mean =     -16.906178689436
             les_mean =     286.154777437835
             stat err =       0.000461463709
             autocorr =       1.267930503629
              std dev =       0.579568569414
             le_variance =       0.335899726653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335896396799
                                         uncertainty =       0.003475600182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335896396799
                                         uncertainty =       0.003475600182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409808917
  error estimate for blocks of size 2^( 2) =       0.000422664958
  error estimate for blocks of size 2^( 3) =       0.000435393358
  error estimate for blocks of size 2^( 4) =       0.000448610555
  error estimate for blocks of size 2^( 5) =       0.000459384925
  error estimate for blocks of size 2^( 6) =       0.000467604312
  error estimate for blocks of size 2^( 7) =       0.000470232261

      target function =                  N/A
              le_mean =     -16.906178643300
             les_mean =     286.154762848505
             stat err =       0.000461458013
             autocorr =       1.267948386657
              std dev =       0.579557328723
             le_variance =       0.335886697276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906178636901        initial
     6.2500e+00     6.2500e+01             4.6899e-05       -16.906178744402  <--
     2.5000e+01     2.5000e+02             1.1757e-05       -16.906178689436
     1.0000e+02     1.0000e+03             2.9412e-06       -16.906178643300

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 3.0241e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.095709e-01 1 1  ON 0
 uu_1                 1.427869e-01 1 1  ON 1
 uu_2                 4.109412e-02 1 1  ON 2
 uu_3                -2.116323e-02 1 1  ON 3
 uu_4                -6.672140e-02 1 1  ON 4
 uu_5                -1.014566e-01 1 1  ON 5
 uu_6                -1.283869e-01 1 1  ON 6
 uu_7                -1.421136e-01 1 1  ON 7
 uu_8                -1.341498e-01 1 1  ON 8
 uu_9                -1.054193e-01 1 1  ON 9
 ud_0                 4.488282e-01 1 1  ON 10
 ud_1                 1.833249e-01 1 1  ON 11
 ud_2                 6.305146e-02 1 1  ON 12
 ud_3                -8.035934e-03 1 1  ON 13
 ud_4                -6.533893e-02 1 1  ON 14
 ud_5                -1.072824e-01 1 1  ON 15
 ud_6                -1.353781e-01 1 1  ON 16
 ud_7                -1.523314e-01 1 1  ON 17
 ud_8                -1.529941e-01 1 1  ON 18
 ud_9                -1.432178e-01 1 1  ON 19
 eO_0                -7.605681e-01 1 1  ON 20
 eO_1                -4.393585e-01 1 1  ON 21
 eO_2                -2.155005e-02 1 1  ON 22
 eO_3                 2.988897e-01 1 1  ON 23
 eO_4                 5.258004e-01 1 1  ON 24
 eO_5                 4.879040e-01 1 1  ON 25
 eO_6                 2.602281e-01 1 1  ON 26
 eO_7                -4.072319e-02 1 1  ON 27
 eO_8                -2.219456e-01 1 1  ON 28
 eO_9                -8.715375e-02 1 1  ON 29
eH1_0                -2.465525e-01 1 1  ON 30
eH1_1                -1.458648e-01 1 1  ON 31
eH1_2                -9.861491e-02 1 1  ON 32
eH1_3                -4.467094e-02 1 1  ON 33
eH1_4                 3.596189e-03 1 1  ON 34
eH1_5                 3.816417e-02 1 1  ON 35
eH1_6                 9.662171e-02 1 1  ON 36
eH1_7                 1.543113e-01 1 1  ON 37
eH1_8                 1.780066e-01 1 1  ON 38
eH1_9                 6.896845e-02 1 1  ON 39
eH2_0                -2.443861e-01 1 1  ON 40
eH2_1                -1.436313e-01 1 1  ON 41
eH2_2                -9.653042e-02 1 1  ON 42
eH2_3                -4.245900e-02 1 1  ON 43
eH2_4                 5.985663e-03 1 1  ON 44
eH2_5                 4.032633e-02 1 1  ON 45
eH2_6                 9.956826e-02 1 1  ON 46
eH2_7                 1.556757e-01 1 1  ON 47
eH2_8                 1.833349e-01 1 1  ON 48
eH2_9                 5.855824e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6516e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9199
    reference variance = 0.258077
====================================================
  Execution time = 2.1363e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6784e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367863992568
                                         uncertainty =       0.023770308529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367863992568
                                         uncertainty =       0.023770308529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428861344
  error estimate for blocks of size 2^( 2) =       0.000441439509
  error estimate for blocks of size 2^( 3) =       0.000454255800
  error estimate for blocks of size 2^( 4) =       0.000466730549
  error estimate for blocks of size 2^( 5) =       0.000478851663
  error estimate for blocks of size 2^( 6) =       0.000486041516
  error estimate for blocks of size 2^( 7) =       0.000493462431

      target function =                  N/A
              le_mean =     -16.906325136412
             les_mean =     286.191673538623
             stat err =       0.000481271540
             autocorr =       1.259350317478
              std dev =       0.606501528814
             le_variance =       0.367844104454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632513641e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906325136412       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906326431552       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906326183935       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906326003788       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906326096349       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906326261655       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906326317155       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906326326258       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906326336569       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.520508e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906325136412       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906325488945       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906325440490       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906325380908       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906325380874       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906325416153       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906325434818       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906325431825       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 6.434702e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906325136412       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906325226546       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906325215555       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906325199721       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906325197890       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906325206284       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906325210953       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906325209860       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.620572e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130429 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7050e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.095867e-01 1 1  ON 0
 uu_1                 1.427969e-01 1 1  ON 1
 uu_2                 4.111364e-02 1 1  ON 2
 uu_3                -2.117242e-02 1 1  ON 3
 uu_4                -6.672516e-02 1 1  ON 4
 uu_5                -1.014626e-01 1 1  ON 5
 uu_6                -1.284261e-01 1 1  ON 6
 uu_7                -1.421458e-01 1 1  ON 7
 uu_8                -1.341541e-01 1 1  ON 8
 uu_9                -1.054091e-01 1 1  ON 9
 ud_0                 4.488685e-01 1 1  ON 10
 ud_1                 1.833242e-01 1 1  ON 11
 ud_2                 6.303770e-02 1 1  ON 12
 ud_3                -8.054902e-03 1 1  ON 13
 ud_4                -6.535552e-02 1 1  ON 14
 ud_5                -1.072770e-01 1 1  ON 15
 ud_6                -1.353705e-01 1 1  ON 16
 ud_7                -1.523404e-01 1 1  ON 17
 ud_8                -1.529910e-01 1 1  ON 18
 ud_9                -1.432209e-01 1 1  ON 19
 eO_0                -7.605712e-01 1 1  ON 20
 eO_1                -4.393586e-01 1 1  ON 21
 eO_2                -2.153380e-02 1 1  ON 22
 eO_3                 2.988944e-01 1 1  ON 23
 eO_4                 5.257936e-01 1 1  ON 24
 eO_5                 4.879148e-01 1 1  ON 25
 eO_6                 2.602316e-01 1 1  ON 26
 eO_7                -4.071962e-02 1 1  ON 27
 eO_8                -2.219527e-01 1 1  ON 28
 eO_9                -8.717120e-02 1 1  ON 29
eH1_0                -2.466168e-01 1 1  ON 30
eH1_1                -1.458749e-01 1 1  ON 31
eH1_2                -9.862028e-02 1 1  ON 32
eH1_3                -4.465365e-02 1 1  ON 33
eH1_4                 3.618080e-03 1 1  ON 34
eH1_5                 3.815024e-02 1 1  ON 35
eH1_6                 9.661861e-02 1 1  ON 36
eH1_7                 1.543093e-01 1 1  ON 37
eH1_8                 1.780302e-01 1 1  ON 38
eH1_9                 6.900126e-02 1 1  ON 39
eH2_0                -2.444407e-01 1 1  ON 40
eH2_1                -1.436607e-01 1 1  ON 41
eH2_2                -9.652569e-02 1 1  ON 42
eH2_3                -4.247085e-02 1 1  ON 43
eH2_4                 5.995670e-03 1 1  ON 44
eH2_5                 4.033322e-02 1 1  ON 45
eH2_6                 9.956967e-02 1 1  ON 46
eH2_7                 1.556916e-01 1 1  ON 47
eH2_8                 1.833543e-01 1 1  ON 48
eH2_9                 5.859274e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9198
    reference variance = 0.347747
====================================================
  Execution time = 2.0806e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3962e-01
  Total weights = 2.0000e+06
  Execution time = 1.8944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339610700314
                                         uncertainty =       0.003161833279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339610700314
                                         uncertainty =       0.003161833279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412057125
  error estimate for blocks of size 2^( 2) =       0.000424588430
  error estimate for blocks of size 2^( 3) =       0.000437697613
  error estimate for blocks of size 2^( 4) =       0.000450481622
  error estimate for blocks of size 2^( 5) =       0.000461127065
  error estimate for blocks of size 2^( 6) =       0.000471450119
  error estimate for blocks of size 2^( 7) =       0.000477550803

      target function =                  N/A
              le_mean =     -16.906453947278
             les_mean =     286.167767050017
             stat err =       0.000465152403
             autocorr =       1.274311730502
              std dev =       0.582736774508
             le_variance =       0.339582148364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339741065589
                                         uncertainty =       0.003163405576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339741065589
                                         uncertainty =       0.003163405576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412136235
  error estimate for blocks of size 2^( 2) =       0.000424661685
  error estimate for blocks of size 2^( 3) =       0.000437765729
  error estimate for blocks of size 2^( 4) =       0.000450545833
  error estimate for blocks of size 2^( 5) =       0.000461190241
  error estimate for blocks of size 2^( 6) =       0.000471512375
  error estimate for blocks of size 2^( 7) =       0.000477614415

      target function =                  N/A
              le_mean =     -16.906452978251
             les_mean =     286.167864688093
             stat err =       0.000465215716
             autocorr =       1.274169358406
              std dev =       0.582848652861
             le_variance =       0.339712552141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339687008756
                                         uncertainty =       0.003162745318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339687008756
                                         uncertainty =       0.003162745318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412103432
  error estimate for blocks of size 2^( 2) =       0.000424631399
  error estimate for blocks of size 2^( 3) =       0.000437737636
  error estimate for blocks of size 2^( 4) =       0.000450519491
  error estimate for blocks of size 2^( 5) =       0.000461164361
  error estimate for blocks of size 2^( 6) =       0.000471486826
  error estimate for blocks of size 2^( 7) =       0.000477588422

      target function =                  N/A
              le_mean =     -16.906453337027
             les_mean =     286.167822744242
             stat err =       0.000465189775
             autocorr =       1.274230097221
              std dev =       0.582802262343
             le_variance =       0.339658476992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339620591219
                                         uncertainty =       0.003161951807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339620591219
                                         uncertainty =       0.003161951807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412063127
  error estimate for blocks of size 2^( 2) =       0.000424594000
  error estimate for blocks of size 2^( 3) =       0.000437702801
  error estimate for blocks of size 2^( 4) =       0.000450486532
  error estimate for blocks of size 2^( 5) =       0.000461131903
  error estimate for blocks of size 2^( 6) =       0.000471454878
  error estimate for blocks of size 2^( 7) =       0.000477555689

      target function =                  N/A
              le_mean =     -16.906453863987
             les_mean =     286.167774127279
             stat err =       0.000465157250
             autocorr =       1.274301166788
              std dev =       0.582745263335
             le_variance =       0.339592041939


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906453947278        initial  <--
     1.5625e+00     1.5625e+01             2.5205e-04       -16.906452978251
     6.2500e+00     6.2500e+01             6.4347e-05       -16.906453337027
     2.5000e+01     2.5000e+02             1.6206e-05       -16.906453863987

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5157
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.095709e-01 1 1  ON 0
 uu_1                 1.427869e-01 1 1  ON 1
 uu_2                 4.109412e-02 1 1  ON 2
 uu_3                -2.116323e-02 1 1  ON 3
 uu_4                -6.672140e-02 1 1  ON 4
 uu_5                -1.014566e-01 1 1  ON 5
 uu_6                -1.283869e-01 1 1  ON 6
 uu_7                -1.421136e-01 1 1  ON 7
 uu_8                -1.341498e-01 1 1  ON 8
 uu_9                -1.054193e-01 1 1  ON 9
 ud_0                 4.488282e-01 1 1  ON 10
 ud_1                 1.833249e-01 1 1  ON 11
 ud_2                 6.305146e-02 1 1  ON 12
 ud_3                -8.035934e-03 1 1  ON 13
 ud_4                -6.533893e-02 1 1  ON 14
 ud_5                -1.072824e-01 1 1  ON 15
 ud_6                -1.353781e-01 1 1  ON 16
 ud_7                -1.523314e-01 1 1  ON 17
 ud_8                -1.529941e-01 1 1  ON 18
 ud_9                -1.432178e-01 1 1  ON 19
 eO_0                -7.605681e-01 1 1  ON 20
 eO_1                -4.393585e-01 1 1  ON 21
 eO_2                -2.155005e-02 1 1  ON 22
 eO_3                 2.988897e-01 1 1  ON 23
 eO_4                 5.258004e-01 1 1  ON 24
 eO_5                 4.879040e-01 1 1  ON 25
 eO_6                 2.602281e-01 1 1  ON 26
 eO_7                -4.072319e-02 1 1  ON 27
 eO_8                -2.219456e-01 1 1  ON 28
 eO_9                -8.715375e-02 1 1  ON 29
eH1_0                -2.465525e-01 1 1  ON 30
eH1_1                -1.458648e-01 1 1  ON 31
eH1_2                -9.861491e-02 1 1  ON 32
eH1_3                -4.467094e-02 1 1  ON 33
eH1_4                 3.596189e-03 1 1  ON 34
eH1_5                 3.816417e-02 1 1  ON 35
eH1_6                 9.662171e-02 1 1  ON 36
eH1_7                 1.543113e-01 1 1  ON 37
eH1_8                 1.780066e-01 1 1  ON 38
eH1_9                 6.896845e-02 1 1  ON 39
eH2_0                -2.443861e-01 1 1  ON 40
eH2_1                -1.436313e-01 1 1  ON 41
eH2_2                -9.653042e-02 1 1  ON 42
eH2_3                -4.245900e-02 1 1  ON 43
eH2_4                 5.985663e-03 1 1  ON 44
eH2_5                 4.032633e-02 1 1  ON 45
eH2_6                 9.956826e-02 1 1  ON 46
eH2_7                 1.556757e-01 1 1  ON 47
eH2_8                 1.833349e-01 1 1  ON 48
eH2_9                 5.855824e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7599e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9217
    reference variance = 0.214678
====================================================
  Execution time = 2.0394e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3977e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339884890288
                                         uncertainty =       0.005385902076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339884890288
                                         uncertainty =       0.005385902076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412172658
  error estimate for blocks of size 2^( 2) =       0.000424914215
  error estimate for blocks of size 2^( 3) =       0.000438100326
  error estimate for blocks of size 2^( 4) =       0.000450552753
  error estimate for blocks of size 2^( 5) =       0.000460968416
  error estimate for blocks of size 2^( 6) =       0.000469229184
  error estimate for blocks of size 2^( 7) =       0.000473980703

      target function =                  N/A
              le_mean =     -16.905961426067
             les_mean =     286.151304169672
             stat err =       0.000463682764
             autocorr =       1.265562352079
              std dev =       0.582900162874
             le_variance =       0.339772599879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596142607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905961426067       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905961468306       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905961447813       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905961445752       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905961454992       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905961448715       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905961466979       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905961477251       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.670629e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905961426067       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905961436719       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905961431505       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905961431047       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905961433348       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905961431706       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905961436139       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905961438836       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.186291e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905961426067       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905961428736       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905961427427       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905961427316       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905961427891       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905961427476       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905961428575       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905961429257       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.047188e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6010e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.095729e-01 1 1  ON 0
 uu_1                 1.427869e-01 1 1  ON 1
 uu_2                 4.109519e-02 1 1  ON 2
 uu_3                -2.116352e-02 1 1  ON 3
 uu_4                -6.671965e-02 1 1  ON 4
 uu_5                -1.014561e-01 1 1  ON 5
 uu_6                -1.283893e-01 1 1  ON 6
 uu_7                -1.421155e-01 1 1  ON 7
 uu_8                -1.341515e-01 1 1  ON 8
 uu_9                -1.054206e-01 1 1  ON 9
 ud_0                 4.488314e-01 1 1  ON 10
 ud_1                 1.833263e-01 1 1  ON 11
 ud_2                 6.305298e-02 1 1  ON 12
 ud_3                -8.036799e-03 1 1  ON 13
 ud_4                -6.533909e-02 1 1  ON 14
 ud_5                -1.072842e-01 1 1  ON 15
 ud_6                -1.353766e-01 1 1  ON 16
 ud_7                -1.523309e-01 1 1  ON 17
 ud_8                -1.529959e-01 1 1  ON 18
 ud_9                -1.432196e-01 1 1  ON 19
 eO_0                -7.605671e-01 1 1  ON 20
 eO_1                -4.393577e-01 1 1  ON 21
 eO_2                -2.155082e-02 1 1  ON 22
 eO_3                 2.988898e-01 1 1  ON 23
 eO_4                 5.258021e-01 1 1  ON 24
 eO_5                 4.879050e-01 1 1  ON 25
 eO_6                 2.602298e-01 1 1  ON 26
 eO_7                -4.072343e-02 1 1  ON 27
 eO_8                -2.219480e-01 1 1  ON 28
 eO_9                -8.715626e-02 1 1  ON 29
eH1_0                -2.465567e-01 1 1  ON 30
eH1_1                -1.458664e-01 1 1  ON 31
eH1_2                -9.861557e-02 1 1  ON 32
eH1_3                -4.467013e-02 1 1  ON 33
eH1_4                 3.596776e-03 1 1  ON 34
eH1_5                 3.816268e-02 1 1  ON 35
eH1_6                 9.662197e-02 1 1  ON 36
eH1_7                 1.543123e-01 1 1  ON 37
eH1_8                 1.780092e-01 1 1  ON 38
eH1_9                 6.897103e-02 1 1  ON 39
eH2_0                -2.443894e-01 1 1  ON 40
eH2_1                -1.436346e-01 1 1  ON 41
eH2_2                -9.652903e-02 1 1  ON 42
eH2_3                -4.245787e-02 1 1  ON 43
eH2_4                 5.986754e-03 1 1  ON 44
eH2_5                 4.032767e-02 1 1  ON 45
eH2_6                 9.956708e-02 1 1  ON 46
eH2_7                 1.556748e-01 1 1  ON 47
eH2_8                 1.833353e-01 1 1  ON 48
eH2_9                 5.856099e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8544
    reference variance = 0.163402
====================================================
  Execution time = 2.0474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3263e-01
  Total weights = 2.0000e+06
  Execution time = 1.8977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332596161762
                                         uncertainty =       0.002591721979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332596161762
                                         uncertainty =       0.002591721979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407814252
  error estimate for blocks of size 2^( 2) =       0.000420970889
  error estimate for blocks of size 2^( 3) =       0.000434598597
  error estimate for blocks of size 2^( 4) =       0.000447580678
  error estimate for blocks of size 2^( 5) =       0.000458666324
  error estimate for blocks of size 2^( 6) =       0.000465032928
  error estimate for blocks of size 2^( 7) =       0.000472319793

      target function =                  N/A
              le_mean =     -16.905901088867
             les_mean =     286.142116388038
             stat err =       0.000460899931
             autocorr =       1.277286989004
              std dev =       0.576736445691
             le_variance =       0.332624927788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332600761460
                                         uncertainty =       0.002591749478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332600761460
                                         uncertainty =       0.002591749478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407817076
  error estimate for blocks of size 2^( 2) =       0.000420973483
  error estimate for blocks of size 2^( 3) =       0.000434600840
  error estimate for blocks of size 2^( 4) =       0.000447582733
  error estimate for blocks of size 2^( 5) =       0.000458668242
  error estimate for blocks of size 2^( 6) =       0.000465034625
  error estimate for blocks of size 2^( 7) =       0.000472321338

      target function =                  N/A
              le_mean =     -16.905901181228
             les_mean =     286.142124118600
             stat err =       0.000460901735
             autocorr =       1.277279293238
              std dev =       0.576740440306
             le_variance =       0.332629535484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332598465524
                                         uncertainty =       0.002591735692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332598465524
                                         uncertainty =       0.002591735692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407815666
  error estimate for blocks of size 2^( 2) =       0.000420972188
  error estimate for blocks of size 2^( 3) =       0.000434599719
  error estimate for blocks of size 2^( 4) =       0.000447581706
  error estimate for blocks of size 2^( 5) =       0.000458667283
  error estimate for blocks of size 2^( 6) =       0.000465033775
  error estimate for blocks of size 2^( 7) =       0.000472320563

      target function =                  N/A
              le_mean =     -16.905901135502
             les_mean =     286.142120272616
             stat err =       0.000460900832
             autocorr =       1.277283121060
              std dev =       0.576738446409
             le_variance =       0.332627235567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332596449739
                                         uncertainty =       0.002591723691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332596449739
                                         uncertainty =       0.002591723691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407814429
  error estimate for blocks of size 2^( 2) =       0.000420971051
  error estimate for blocks of size 2^( 3) =       0.000434598737
  error estimate for blocks of size 2^( 4) =       0.000447580807
  error estimate for blocks of size 2^( 5) =       0.000458666444
  error estimate for blocks of size 2^( 6) =       0.000465033034
  error estimate for blocks of size 2^( 7) =       0.000472319889

      target function =                  N/A
              le_mean =     -16.905901094691
             les_mean =     286.142116873443
             stat err =       0.000460900043
             autocorr =       1.277286504806
              std dev =       0.576736695787
             le_variance =       0.332625216268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905901088867        initial
     1.5625e+01     1.5625e+02             1.6706e-05       -16.905901181228  <--
     6.2500e+01     6.2500e+02             4.1863e-06       -16.905901135502
     2.5000e+02     2.5000e+03             1.0472e-06       -16.905901094691

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 3.3421e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.095788e-01 1 1  ON 0
 uu_1                 1.427872e-01 1 1  ON 1
 uu_2                 4.109834e-02 1 1  ON 2
 uu_3                -2.116430e-02 1 1  ON 3
 uu_4                -6.671451e-02 1 1  ON 4
 uu_5                -1.014546e-01 1 1  ON 5
 uu_6                -1.283966e-01 1 1  ON 6
 uu_7                -1.421210e-01 1 1  ON 7
 uu_8                -1.341565e-01 1 1  ON 8
 uu_9                -1.054247e-01 1 1  ON 9
 ud_0                 4.488409e-01 1 1  ON 10
 ud_1                 1.833306e-01 1 1  ON 11
 ud_2                 6.305750e-02 1 1  ON 12
 ud_3                -8.039282e-03 1 1  ON 13
 ud_4                -6.533961e-02 1 1  ON 14
 ud_5                -1.072895e-01 1 1  ON 15
 ud_6                -1.353722e-01 1 1  ON 16
 ud_7                -1.523294e-01 1 1  ON 17
 ud_8                -1.530015e-01 1 1  ON 18
 ud_9                -1.432249e-01 1 1  ON 19
 eO_0                -7.605644e-01 1 1  ON 20
 eO_1                -4.393551e-01 1 1  ON 21
 eO_2                -2.155304e-02 1 1  ON 22
 eO_3                 2.988900e-01 1 1  ON 23
 eO_4                 5.258074e-01 1 1  ON 24
 eO_5                 4.879081e-01 1 1  ON 25
 eO_6                 2.602348e-01 1 1  ON 26
 eO_7                -4.072413e-02 1 1  ON 27
 eO_8                -2.219551e-01 1 1  ON 28
 eO_9                -8.716377e-02 1 1  ON 29
eH1_0                -2.465692e-01 1 1  ON 30
eH1_1                -1.458711e-01 1 1  ON 31
eH1_2                -9.861756e-02 1 1  ON 32
eH1_3                -4.466773e-02 1 1  ON 33
eH1_4                 3.598544e-03 1 1  ON 34
eH1_5                 3.815825e-02 1 1  ON 35
eH1_6                 9.662274e-02 1 1  ON 36
eH1_7                 1.543153e-01 1 1  ON 37
eH1_8                 1.780172e-01 1 1  ON 38
eH1_9                 6.897875e-02 1 1  ON 39
eH2_0                -2.443993e-01 1 1  ON 40
eH2_1                -1.436443e-01 1 1  ON 41
eH2_2                -9.652496e-02 1 1  ON 42
eH2_3                -4.245449e-02 1 1  ON 43
eH2_4                 5.990028e-03 1 1  ON 44
eH2_5                 4.033166e-02 1 1  ON 45
eH2_6                 9.956357e-02 1 1  ON 46
eH2_7                 1.556720e-01 1 1  ON 47
eH2_8                 1.833364e-01 1 1  ON 48
eH2_9                 5.856924e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9465e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9611
    reference variance = 0.209348
====================================================
  Execution time = 2.0671e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4406e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344145566584
                                         uncertainty =       0.004368597399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344145566584
                                         uncertainty =       0.004368597399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414766080
  error estimate for blocks of size 2^( 2) =       0.000427816366
  error estimate for blocks of size 2^( 3) =       0.000440822448
  error estimate for blocks of size 2^( 4) =       0.000453458338
  error estimate for blocks of size 2^( 5) =       0.000465055411
  error estimate for blocks of size 2^( 6) =       0.000473423923
  error estimate for blocks of size 2^( 7) =       0.000479471951

      target function =                  N/A
              le_mean =     -16.906024178077
             les_mean =     286.157715140345
             stat err =       0.000467852406
             autocorr =       1.272363696281
              std dev =       0.586567815914
             le_variance =       0.344061802666


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602417808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906024178077       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906024612167       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906024717223       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906024637829       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906024669747       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906024730115       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906024663683       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906024685055       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.548877e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906024178077       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906024290456       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906024320232       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906024298057       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906024319191       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906024323293       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906024306151       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906024310677       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.656393e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906024178077       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906024206423       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906024214106       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906024208480       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906024214863       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906024214480       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906024210575       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906024211650       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.153265e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135732 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6207e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.095746e-01 1 1  ON 0
 uu_1                 1.427954e-01 1 1  ON 1
 uu_2                 4.110956e-02 1 1  ON 2
 uu_3                -2.116837e-02 1 1  ON 3
 uu_4                -6.671138e-02 1 1  ON 4
 uu_5                -1.014548e-01 1 1  ON 5
 uu_6                -1.284122e-01 1 1  ON 6
 uu_7                -1.421284e-01 1 1  ON 7
 uu_8                -1.341573e-01 1 1  ON 8
 uu_9                -1.054245e-01 1 1  ON 9
 ud_0                 4.488471e-01 1 1  ON 10
 ud_1                 1.833339e-01 1 1  ON 11
 ud_2                 6.305171e-02 1 1  ON 12
 ud_3                -8.040070e-03 1 1  ON 13
 ud_4                -6.534995e-02 1 1  ON 14
 ud_5                -1.072819e-01 1 1  ON 15
 ud_6                -1.353746e-01 1 1  ON 16
 ud_7                -1.523224e-01 1 1  ON 17
 ud_8                -1.529996e-01 1 1  ON 18
 ud_9                -1.432272e-01 1 1  ON 19
 eO_0                -7.605666e-01 1 1  ON 20
 eO_1                -4.393538e-01 1 1  ON 21
 eO_2                -2.155471e-02 1 1  ON 22
 eO_3                 2.988954e-01 1 1  ON 23
 eO_4                 5.258066e-01 1 1  ON 24
 eO_5                 4.879149e-01 1 1  ON 25
 eO_6                 2.602381e-01 1 1  ON 26
 eO_7                -4.072427e-02 1 1  ON 27
 eO_8                -2.219586e-01 1 1  ON 28
 eO_9                -8.717065e-02 1 1  ON 29
eH1_0                -2.465820e-01 1 1  ON 30
eH1_1                -1.458798e-01 1 1  ON 31
eH1_2                -9.861495e-02 1 1  ON 32
eH1_3                -4.466453e-02 1 1  ON 33
eH1_4                 3.604855e-03 1 1  ON 34
eH1_5                 3.815589e-02 1 1  ON 35
eH1_6                 9.661561e-02 1 1  ON 36
eH1_7                 1.543143e-01 1 1  ON 37
eH1_8                 1.780271e-01 1 1  ON 38
eH1_9                 6.898856e-02 1 1  ON 39
eH2_0                -2.444159e-01 1 1  ON 40
eH2_1                -1.436467e-01 1 1  ON 41
eH2_2                -9.652791e-02 1 1  ON 42
eH2_3                -4.245069e-02 1 1  ON 43
eH2_4                 5.986994e-03 1 1  ON 44
eH2_5                 4.033378e-02 1 1  ON 45
eH2_6                 9.956181e-02 1 1  ON 46
eH2_7                 1.556698e-01 1 1  ON 47
eH2_8                 1.833443e-01 1 1  ON 48
eH2_9                 5.858243e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.84
    reference variance = 0.274937
====================================================
  Execution time = 2.0343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.7037e-01
  Total weights = 2.0000e+06
  Execution time = 1.8791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370497497056
                                         uncertainty =       0.020254026921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370497497056
                                         uncertainty =       0.020254026921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430329457
  error estimate for blocks of size 2^( 2) =       0.000441780733
  error estimate for blocks of size 2^( 3) =       0.000454644000
  error estimate for blocks of size 2^( 4) =       0.000465869135
  error estimate for blocks of size 2^( 5) =       0.000475437086
  error estimate for blocks of size 2^( 6) =       0.000481552988
  error estimate for blocks of size 2^( 7) =       0.000486384178

      target function =                  N/A
              le_mean =     -16.906674742301
             les_mean =     286.206017539288
             stat err =       0.000477310847
             autocorr =       1.230270064724
              std dev =       0.608577753881
             le_variance =       0.370366882518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370509748689
                                         uncertainty =       0.020250246411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370509748689
                                         uncertainty =       0.020250246411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430336587
  error estimate for blocks of size 2^( 2) =       0.000441786365
  error estimate for blocks of size 2^( 3) =       0.000454648384
  error estimate for blocks of size 2^( 4) =       0.000465872727
  error estimate for blocks of size 2^( 5) =       0.000475441108
  error estimate for blocks of size 2^( 6) =       0.000481557089
  error estimate for blocks of size 2^( 7) =       0.000486389018

      target function =                  N/A
              le_mean =     -16.906674468070
             les_mean =     286.206020540868
             stat err =       0.000477314986
             autocorr =       1.230250629943
              std dev =       0.608587838171
             le_variance =       0.370379156770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370503565663
                                         uncertainty =       0.020251831565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370503565663
                                         uncertainty =       0.020251831565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430332990
  error estimate for blocks of size 2^( 2) =       0.000441783472
  error estimate for blocks of size 2^( 3) =       0.000454646091
  error estimate for blocks of size 2^( 4) =       0.000465870826
  error estimate for blocks of size 2^( 5) =       0.000475438995
  error estimate for blocks of size 2^( 6) =       0.000481554950
  error estimate for blocks of size 2^( 7) =       0.000486386502

      target function =                  N/A
              le_mean =     -16.906674581709
             les_mean =     286.206018190627
             stat err =       0.000477312818
             autocorr =       1.230260027790
              std dev =       0.608582750343
             le_variance =       0.370372964016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370498248442
                                         uncertainty =       0.020253741522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370498248442
                                         uncertainty =       0.020253741522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430329894
  error estimate for blocks of size 2^( 2) =       0.000441781070
  error estimate for blocks of size 2^( 3) =       0.000454644255
  error estimate for blocks of size 2^( 4) =       0.000465869339
  error estimate for blocks of size 2^( 5) =       0.000475437318
  error estimate for blocks of size 2^( 6) =       0.000481553227
  error estimate for blocks of size 2^( 7) =       0.000486384461

      target function =                  N/A
              le_mean =     -16.906674720940
             les_mean =     286.206017570076
             stat err =       0.000477311086
             autocorr =       1.230268799643
              std dev =       0.608578372581
             le_variance =       0.370367635573


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906674742301        initial  <--
     3.9062e+00     3.9062e+01             6.5489e-05       -16.906674468070
     1.5625e+01     1.5625e+02             1.6564e-05       -16.906674581709
     6.2500e+01     6.2500e+02             4.1533e-06       -16.906674720940

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8379
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.095788e-01 1 1  ON 0
 uu_1                 1.427872e-01 1 1  ON 1
 uu_2                 4.109834e-02 1 1  ON 2
 uu_3                -2.116430e-02 1 1  ON 3
 uu_4                -6.671451e-02 1 1  ON 4
 uu_5                -1.014546e-01 1 1  ON 5
 uu_6                -1.283966e-01 1 1  ON 6
 uu_7                -1.421210e-01 1 1  ON 7
 uu_8                -1.341565e-01 1 1  ON 8
 uu_9                -1.054247e-01 1 1  ON 9
 ud_0                 4.488409e-01 1 1  ON 10
 ud_1                 1.833306e-01 1 1  ON 11
 ud_2                 6.305750e-02 1 1  ON 12
 ud_3                -8.039282e-03 1 1  ON 13
 ud_4                -6.533961e-02 1 1  ON 14
 ud_5                -1.072895e-01 1 1  ON 15
 ud_6                -1.353722e-01 1 1  ON 16
 ud_7                -1.523294e-01 1 1  ON 17
 ud_8                -1.530015e-01 1 1  ON 18
 ud_9                -1.432249e-01 1 1  ON 19
 eO_0                -7.605644e-01 1 1  ON 20
 eO_1                -4.393551e-01 1 1  ON 21
 eO_2                -2.155304e-02 1 1  ON 22
 eO_3                 2.988900e-01 1 1  ON 23
 eO_4                 5.258074e-01 1 1  ON 24
 eO_5                 4.879081e-01 1 1  ON 25
 eO_6                 2.602348e-01 1 1  ON 26
 eO_7                -4.072413e-02 1 1  ON 27
 eO_8                -2.219551e-01 1 1  ON 28
 eO_9                -8.716377e-02 1 1  ON 29
eH1_0                -2.465692e-01 1 1  ON 30
eH1_1                -1.458711e-01 1 1  ON 31
eH1_2                -9.861756e-02 1 1  ON 32
eH1_3                -4.466773e-02 1 1  ON 33
eH1_4                 3.598544e-03 1 1  ON 34
eH1_5                 3.815825e-02 1 1  ON 35
eH1_6                 9.662274e-02 1 1  ON 36
eH1_7                 1.543153e-01 1 1  ON 37
eH1_8                 1.780172e-01 1 1  ON 38
eH1_9                 6.897875e-02 1 1  ON 39
eH2_0                -2.443993e-01 1 1  ON 40
eH2_1                -1.436443e-01 1 1  ON 41
eH2_2                -9.652496e-02 1 1  ON 42
eH2_3                -4.245449e-02 1 1  ON 43
eH2_4                 5.990028e-03 1 1  ON 44
eH2_5                 4.033166e-02 1 1  ON 45
eH2_6                 9.956357e-02 1 1  ON 46
eH2_7                 1.556720e-01 1 1  ON 47
eH2_8                 1.833364e-01 1 1  ON 48
eH2_9                 5.856924e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9269
    reference variance = 0.393228
====================================================
  Execution time = 2.1244e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3972e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339758064367
                                         uncertainty =       0.003224985695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339758064367
                                         uncertainty =       0.003224985695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412137892
  error estimate for blocks of size 2^( 2) =       0.000425159413
  error estimate for blocks of size 2^( 3) =       0.000437711597
  error estimate for blocks of size 2^( 4) =       0.000449811527
  error estimate for blocks of size 2^( 5) =       0.000459660418
  error estimate for blocks of size 2^( 6) =       0.000467620546
  error estimate for blocks of size 2^( 7) =       0.000470925960

      target function =                  N/A
              le_mean =     -16.906474656750
             les_mean =     286.168600432785
             stat err =       0.000462004613
             autocorr =       1.256630318595
              std dev =       0.582850995809
             le_variance =       0.339715283315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690647465675e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906474656750       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906474668646       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906474698151       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906474691398       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906474700337       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906474690403       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906474695530       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 6.477238e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906474656750       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906474659734       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906474667130       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906474665446       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906474667716       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906474665210       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906474666507       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.620834e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906474656750       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906474657497       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906474659347       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906474658926       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906474659496       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906474658868       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906474659193       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 4.053038e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6849e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.095788e-01 1 1  ON 0
 uu_1                 1.427877e-01 1 1  ON 1
 uu_2                 4.109946e-02 1 1  ON 2
 uu_3                -2.116480e-02 1 1  ON 3
 uu_4                -6.671452e-02 1 1  ON 4
 uu_5                -1.014543e-01 1 1  ON 5
 uu_6                -1.283970e-01 1 1  ON 6
 uu_7                -1.421209e-01 1 1  ON 7
 uu_8                -1.341568e-01 1 1  ON 8
 uu_9                -1.054255e-01 1 1  ON 9
 ud_0                 4.488421e-01 1 1  ON 10
 ud_1                 1.833307e-01 1 1  ON 11
 ud_2                 6.305838e-02 1 1  ON 12
 ud_3                -8.039395e-03 1 1  ON 13
 ud_4                -6.533923e-02 1 1  ON 14
 ud_5                -1.072895e-01 1 1  ON 15
 ud_6                -1.353719e-01 1 1  ON 16
 ud_7                -1.523303e-01 1 1  ON 17
 ud_8                -1.530023e-01 1 1  ON 18
 ud_9                -1.432255e-01 1 1  ON 19
 eO_0                -7.605638e-01 1 1  ON 20
 eO_1                -4.393552e-01 1 1  ON 21
 eO_2                -2.155271e-02 1 1  ON 22
 eO_3                 2.988901e-01 1 1  ON 23
 eO_4                 5.258071e-01 1 1  ON 24
 eO_5                 4.879090e-01 1 1  ON 25
 eO_6                 2.602352e-01 1 1  ON 26
 eO_7                -4.072395e-02 1 1  ON 27
 eO_8                -2.219560e-01 1 1  ON 28
 eO_9                -8.716483e-02 1 1  ON 29
eH1_0                -2.465708e-01 1 1  ON 30
eH1_1                -1.458718e-01 1 1  ON 31
eH1_2                -9.861770e-02 1 1  ON 32
eH1_3                -4.466771e-02 1 1  ON 33
eH1_4                 3.599022e-03 1 1  ON 34
eH1_5                 3.815865e-02 1 1  ON 35
eH1_6                 9.662291e-02 1 1  ON 36
eH1_7                 1.543151e-01 1 1  ON 37
eH1_8                 1.780180e-01 1 1  ON 38
eH1_9                 6.897964e-02 1 1  ON 39
eH2_0                -2.444005e-01 1 1  ON 40
eH2_1                -1.436452e-01 1 1  ON 41
eH2_2                -9.652498e-02 1 1  ON 42
eH2_3                -4.245472e-02 1 1  ON 43
eH2_4                 5.990607e-03 1 1  ON 44
eH2_5                 4.033183e-02 1 1  ON 45
eH2_6                 9.956325e-02 1 1  ON 46
eH2_7                 1.556718e-01 1 1  ON 47
eH2_8                 1.833369e-01 1 1  ON 48
eH2_9                 5.857064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8475
    reference variance = 0.358042
====================================================
  Execution time = 2.0620e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4137e-01
  Total weights = 2.0000e+06
  Execution time = 1.8770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341462874421
                                         uncertainty =       0.004524023401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341462874421
                                         uncertainty =       0.004524023401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413137577
  error estimate for blocks of size 2^( 2) =       0.000425789876
  error estimate for blocks of size 2^( 3) =       0.000438782994
  error estimate for blocks of size 2^( 4) =       0.000450639180
  error estimate for blocks of size 2^( 5) =       0.000460629632
  error estimate for blocks of size 2^( 6) =       0.000470183450
  error estimate for blocks of size 2^( 7) =       0.000475104735

      target function =                  N/A
              le_mean =     -16.906221202304
             les_mean =     286.161680485337
             stat err =       0.000464139249
             autocorr =       1.262139024830
              std dev =       0.584264764295
             le_variance =       0.341365314797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341463241001
                                         uncertainty =       0.004524085828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341463241001
                                         uncertainty =       0.004524085828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413137798
  error estimate for blocks of size 2^( 2) =       0.000425790041
  error estimate for blocks of size 2^( 3) =       0.000438783066
  error estimate for blocks of size 2^( 4) =       0.000450639215
  error estimate for blocks of size 2^( 5) =       0.000460629701
  error estimate for blocks of size 2^( 6) =       0.000470183503
  error estimate for blocks of size 2^( 7) =       0.000475104655

      target function =                  N/A
              le_mean =     -16.906221213012
             les_mean =     286.161681213584
             stat err =       0.000464139269
             autocorr =       1.262137775569
              std dev =       0.584265077658
             le_variance =       0.341365680971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341463055719
                                         uncertainty =       0.004524054925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341463055719
                                         uncertainty =       0.004524054925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413137686
  error estimate for blocks of size 2^( 2) =       0.000425789958
  error estimate for blocks of size 2^( 3) =       0.000438783029
  error estimate for blocks of size 2^( 4) =       0.000450639196
  error estimate for blocks of size 2^( 5) =       0.000460629666
  error estimate for blocks of size 2^( 6) =       0.000470183476
  error estimate for blocks of size 2^( 7) =       0.000475104694

      target function =                  N/A
              le_mean =     -16.906221207701
             les_mean =     286.161680848924
             stat err =       0.000464139258
             autocorr =       1.262138402954
              std dev =       0.584264919272
             le_variance =       0.341365495892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341462896997
                                         uncertainty =       0.004524027352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341462896997
                                         uncertainty =       0.004524027352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413137590
  error estimate for blocks of size 2^( 2) =       0.000425789886
  error estimate for blocks of size 2^( 3) =       0.000438782998
  error estimate for blocks of size 2^( 4) =       0.000450639182
  error estimate for blocks of size 2^( 5) =       0.000460629636
  error estimate for blocks of size 2^( 6) =       0.000470183453
  error estimate for blocks of size 2^( 7) =       0.000475104730

      target function =                  N/A
              le_mean =     -16.906221202977
             les_mean =     286.161680530645
             stat err =       0.000464139250
             autocorr =       1.262138947183
              std dev =       0.584264783593
             le_variance =       0.341365337347


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906221202304        initial
     3.9062e+01     3.9062e+02             6.4772e-06       -16.906221213012  <--
     1.5625e+02     1.5625e+03             1.6208e-06       -16.906221207701
     6.2500e+02     6.2500e+03             4.0530e-07       -16.906221202977

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 3.0295e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.095789e-01 1 1  ON 0
 uu_1                 1.427893e-01 1 1  ON 1
 uu_2                 4.110276e-02 1 1  ON 2
 uu_3                -2.116625e-02 1 1  ON 3
 uu_4                -6.671454e-02 1 1  ON 4
 uu_5                -1.014534e-01 1 1  ON 5
 uu_6                -1.283984e-01 1 1  ON 6
 uu_7                -1.421206e-01 1 1  ON 7
 uu_8                -1.341575e-01 1 1  ON 8
 uu_9                -1.054281e-01 1 1  ON 9
 ud_0                 4.488458e-01 1 1  ON 10
 ud_1                 1.833313e-01 1 1  ON 11
 ud_2                 6.306101e-02 1 1  ON 12
 ud_3                -8.039713e-03 1 1  ON 13
 ud_4                -6.533812e-02 1 1  ON 14
 ud_5                -1.072894e-01 1 1  ON 15
 ud_6                -1.353710e-01 1 1  ON 16
 ud_7                -1.523329e-01 1 1  ON 17
 ud_8                -1.530046e-01 1 1  ON 18
 ud_9                -1.432275e-01 1 1  ON 19
 eO_0                -7.605619e-01 1 1  ON 20
 eO_1                -4.393554e-01 1 1  ON 21
 eO_2                -2.155171e-02 1 1  ON 22
 eO_3                 2.988901e-01 1 1  ON 23
 eO_4                 5.258062e-01 1 1  ON 24
 eO_5                 4.879116e-01 1 1  ON 25
 eO_6                 2.602366e-01 1 1  ON 26
 eO_7                -4.072341e-02 1 1  ON 27
 eO_8                -2.219585e-01 1 1  ON 28
 eO_9                -8.716801e-02 1 1  ON 29
eH1_0                -2.465757e-01 1 1  ON 30
eH1_1                -1.458739e-01 1 1  ON 31
eH1_2                -9.861813e-02 1 1  ON 32
eH1_3                -4.466765e-02 1 1  ON 33
eH1_4                 3.600456e-03 1 1  ON 34
eH1_5                 3.815988e-02 1 1  ON 35
eH1_6                 9.662342e-02 1 1  ON 36
eH1_7                 1.543145e-01 1 1  ON 37
eH1_8                 1.780202e-01 1 1  ON 38
eH1_9                 6.898229e-02 1 1  ON 39
eH2_0                -2.444040e-01 1 1  ON 40
eH2_1                -1.436480e-01 1 1  ON 41
eH2_2                -9.652502e-02 1 1  ON 42
eH2_3                -4.245542e-02 1 1  ON 43
eH2_4                 5.992339e-03 1 1  ON 44
eH2_5                 4.033234e-02 1 1  ON 45
eH2_6                 9.956229e-02 1 1  ON 46
eH2_7                 1.556713e-01 1 1  ON 47
eH2_8                 1.833384e-01 1 1  ON 48
eH2_9                 5.857484e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9171
    reference variance = 0.208711
====================================================
  Execution time = 2.0710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3645e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336449323889
                                         uncertainty =       0.003392557743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336449323889
                                         uncertainty =       0.003392557743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410149530
  error estimate for blocks of size 2^( 2) =       0.000422702834
  error estimate for blocks of size 2^( 3) =       0.000435386616
  error estimate for blocks of size 2^( 4) =       0.000447791153
  error estimate for blocks of size 2^( 5) =       0.000458742189
  error estimate for blocks of size 2^( 6) =       0.000467224366
  error estimate for blocks of size 2^( 7) =       0.000468101293

      target function =                  N/A
              le_mean =     -16.906789856202
             les_mean =     286.175988346827
             stat err =       0.000460464750
             autocorr =       1.260399851277
              std dev =       0.580039027366
             le_variance =       0.336445273268


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690678985620e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906789856202       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906789949918       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906790019832       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906790070622       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906790192939       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906790201284       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906790160632       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906790162926       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.502873e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906789856202       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906789879923       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906789897490       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906789910408       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906789941444       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906789943916       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906789933884       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906789934100       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 8.790989e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906789856202       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906789862151       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906789866548       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906789869792       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906789877580       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906789878223       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906789875724       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906789875756       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.199875e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6485e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.095818e-01 1 1  ON 0
 uu_1                 1.427889e-01 1 1  ON 1
 uu_2                 4.110237e-02 1 1  ON 2
 uu_3                -2.116734e-02 1 1  ON 3
 uu_4                -6.671241e-02 1 1  ON 4
 uu_5                -1.014528e-01 1 1  ON 5
 uu_6                -1.283993e-01 1 1  ON 6
 uu_7                -1.421254e-01 1 1  ON 7
 uu_8                -1.341598e-01 1 1  ON 8
 uu_9                -1.054281e-01 1 1  ON 9
 ud_0                 4.488490e-01 1 1  ON 10
 ud_1                 1.833326e-01 1 1  ON 11
 ud_2                 6.306287e-02 1 1  ON 12
 ud_3                -8.040431e-03 1 1  ON 13
 ud_4                -6.533777e-02 1 1  ON 14
 ud_5                -1.072921e-01 1 1  ON 15
 ud_6                -1.353715e-01 1 1  ON 16
 ud_7                -1.523329e-01 1 1  ON 17
 ud_8                -1.530068e-01 1 1  ON 18
 ud_9                -1.432281e-01 1 1  ON 19
 eO_0                -7.605631e-01 1 1  ON 20
 eO_1                -4.393501e-01 1 1  ON 21
 eO_2                -2.155235e-02 1 1  ON 22
 eO_3                 2.988905e-01 1 1  ON 23
 eO_4                 5.258051e-01 1 1  ON 24
 eO_5                 4.879127e-01 1 1  ON 25
 eO_6                 2.602379e-01 1 1  ON 26
 eO_7                -4.072286e-02 1 1  ON 27
 eO_8                -2.219606e-01 1 1  ON 28
 eO_9                -8.717113e-02 1 1  ON 29
eH1_0                -2.465844e-01 1 1  ON 30
eH1_1                -1.458736e-01 1 1  ON 31
eH1_2                -9.861896e-02 1 1  ON 32
eH1_3                -4.466528e-02 1 1  ON 33
eH1_4                 3.602234e-03 1 1  ON 34
eH1_5                 3.815627e-02 1 1  ON 35
eH1_6                 9.662436e-02 1 1  ON 36
eH1_7                 1.543144e-01 1 1  ON 37
eH1_8                 1.780232e-01 1 1  ON 38
eH1_9                 6.898666e-02 1 1  ON 39
eH2_0                -2.444128e-01 1 1  ON 40
eH2_1                -1.436528e-01 1 1  ON 41
eH2_2                -9.652291e-02 1 1  ON 42
eH2_3                -4.245241e-02 1 1  ON 43
eH2_4                 5.993989e-03 1 1  ON 44
eH2_5                 4.033277e-02 1 1  ON 45
eH2_6                 9.955963e-02 1 1  ON 46
eH2_7                 1.556716e-01 1 1  ON 47
eH2_8                 1.833412e-01 1 1  ON 48
eH2_9                 5.858038e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8269
    reference variance = 0.348675
====================================================
  Execution time = 2.0230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.8517e-01
  Total weights = 2.0000e+06
  Execution time = 1.8949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385278018789
                                         uncertainty =       0.052502521872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385278018789
                                         uncertainty =       0.052502521872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438841620
  error estimate for blocks of size 2^( 2) =       0.000450728519
  error estimate for blocks of size 2^( 3) =       0.000463073145
  error estimate for blocks of size 2^( 4) =       0.000474541299
  error estimate for blocks of size 2^( 5) =       0.000483988790
  error estimate for blocks of size 2^( 6) =       0.000492999313
  error estimate for blocks of size 2^( 7) =       0.000499544249

      target function =                  N/A
              le_mean =     -16.905697231952
             les_mean =     286.187762640383
             stat err =       0.000487768413
             autocorr =       1.235411746839
              std dev =       0.620615770444
             le_variance =       0.385163934524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385284899513
                                         uncertainty =       0.052503281510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385284899513
                                         uncertainty =       0.052503281510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438845539
  error estimate for blocks of size 2^( 2) =       0.000450732205
  error estimate for blocks of size 2^( 3) =       0.000463076605
  error estimate for blocks of size 2^( 4) =       0.000474544666
  error estimate for blocks of size 2^( 5) =       0.000483992161
  error estimate for blocks of size 2^( 6) =       0.000493002603
  error estimate for blocks of size 2^( 7) =       0.000499547860

      target function =                  N/A
              le_mean =     -16.905697232907
             les_mean =     286.187769552385
             stat err =       0.000487771822
             autocorr =       1.235406951166
              std dev =       0.620621313072
             le_variance =       0.385170814239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385281440075
                                         uncertainty =       0.052502884136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385281440075
                                         uncertainty =       0.052502884136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438843569
  error estimate for blocks of size 2^( 2) =       0.000450730352
  error estimate for blocks of size 2^( 3) =       0.000463074866
  error estimate for blocks of size 2^( 4) =       0.000474542973
  error estimate for blocks of size 2^( 5) =       0.000483990468
  error estimate for blocks of size 2^( 6) =       0.000493000949
  error estimate for blocks of size 2^( 7) =       0.000499546049

      target function =                  N/A
              le_mean =     -16.905697231952
             les_mean =     286.187766061164
             stat err =       0.000487770110
             autocorr =       1.235409370254
              std dev =       0.620618526398
             le_variance =       0.385167355308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385278445492
                                         uncertainty =       0.052502566561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385278445492
                                         uncertainty =       0.052502566561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438841863
  error estimate for blocks of size 2^( 2) =       0.000450728748
  error estimate for blocks of size 2^( 3) =       0.000463073359
  error estimate for blocks of size 2^( 4) =       0.000474541508
  error estimate for blocks of size 2^( 5) =       0.000483988999
  error estimate for blocks of size 2^( 6) =       0.000492999517
  error estimate for blocks of size 2^( 7) =       0.000499544473

      target function =                  N/A
              le_mean =     -16.905697231895
             les_mean =     286.187763065068
             stat err =       0.000487768624
             autocorr =       1.235411450344
              std dev =       0.620616114168
             le_variance =       0.385164361165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905697231952        initial
     9.7656e+00     9.7656e+01             3.5029e-05       -16.905697232907  <--
     3.9062e+01     3.9062e+02             8.7910e-06       -16.905697231952
     1.5625e+02     1.5625e+03             2.1999e-06       -16.905697231895

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.9803e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.095906e-01 1 1  ON 0
 uu_1                 1.427877e-01 1 1  ON 1
 uu_2                 4.110124e-02 1 1  ON 2
 uu_3                -2.117047e-02 1 1  ON 3
 uu_4                -6.670628e-02 1 1  ON 4
 uu_5                -1.014512e-01 1 1  ON 5
 uu_6                -1.284022e-01 1 1  ON 6
 uu_7                -1.421395e-01 1 1  ON 7
 uu_8                -1.341665e-01 1 1  ON 8
 uu_9                -1.054282e-01 1 1  ON 9
 ud_0                 4.488585e-01 1 1  ON 10
 ud_1                 1.833366e-01 1 1  ON 11
 ud_2                 6.306825e-02 1 1  ON 12
 ud_3                -8.042385e-03 1 1  ON 13
 ud_4                -6.533683e-02 1 1  ON 14
 ud_5                -1.072999e-01 1 1  ON 15
 ud_6                -1.353729e-01 1 1  ON 16
 ud_7                -1.523332e-01 1 1  ON 17
 ud_8                -1.530131e-01 1 1  ON 18
 ud_9                -1.432298e-01 1 1  ON 19
 eO_0                -7.605664e-01 1 1  ON 20
 eO_1                -4.393344e-01 1 1  ON 21
 eO_2                -2.155405e-02 1 1  ON 22
 eO_3                 2.988913e-01 1 1  ON 23
 eO_4                 5.258018e-01 1 1  ON 24
 eO_5                 4.879161e-01 1 1  ON 25
 eO_6                 2.602419e-01 1 1  ON 26
 eO_7                -4.072120e-02 1 1  ON 27
 eO_8                -2.219667e-01 1 1  ON 28
 eO_9                -8.718045e-02 1 1  ON 29
eH1_0                -2.466103e-01 1 1  ON 30
eH1_1                -1.458728e-01 1 1  ON 31
eH1_2                -9.862138e-02 1 1  ON 32
eH1_3                -4.465836e-02 1 1  ON 33
eH1_4                 3.607567e-03 1 1  ON 34
eH1_5                 3.814555e-02 1 1  ON 35
eH1_6                 9.662718e-02 1 1  ON 36
eH1_7                 1.543142e-01 1 1  ON 37
eH1_8                 1.780322e-01 1 1  ON 38
eH1_9                 6.899972e-02 1 1  ON 39
eH2_0                -2.444390e-01 1 1  ON 40
eH2_1                -1.436669e-01 1 1  ON 41
eH2_2                -9.651682e-02 1 1  ON 42
eH2_3                -4.244349e-02 1 1  ON 43
eH2_4                 5.998963e-03 1 1  ON 44
eH2_5                 4.033403e-02 1 1  ON 45
eH2_6                 9.955167e-02 1 1  ON 46
eH2_7                 1.556723e-01 1 1  ON 47
eH2_8                 1.833496e-01 1 1  ON 48
eH2_9                 5.859697e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6295e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.969
    reference variance = 0.605969
====================================================
  Execution time = 2.0662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4502e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345004656825
                                         uncertainty =       0.006029484774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345004656825
                                         uncertainty =       0.006029484774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415345706
  error estimate for blocks of size 2^( 2) =       0.000427834054
  error estimate for blocks of size 2^( 3) =       0.000440183045
  error estimate for blocks of size 2^( 4) =       0.000452093974
  error estimate for blocks of size 2^( 5) =       0.000463384873
  error estimate for blocks of size 2^( 6) =       0.000470820395
  error estimate for blocks of size 2^( 7) =       0.000475891682

      target function =                  N/A
              le_mean =     -16.905853860862
             les_mean =     286.152918703424
             stat err =       0.000465547731
             autocorr =       1.256345182774
              std dev =       0.587387530616
             le_variance =       0.345024111124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585386086e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905853860862       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905854316735       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905854669487       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905854704309       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905854888695       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905854937777       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905854963794       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905854995220       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905854994067       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.438053e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905853860862       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905853981126       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905854070262       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905854080775       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905854130351       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905854144499       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905854151414       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905854159802       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.633552e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905853860862       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905853891349       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905853913650       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905853916493       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905853929090       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905853932802       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905853934577       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905853936720       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 9.122149e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6195e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.095908e-01 1 1  ON 0
 uu_1                 1.428004e-01 1 1  ON 1
 uu_2                 4.111778e-02 1 1  ON 2
 uu_3                -2.116961e-02 1 1  ON 3
 uu_4                -6.670025e-02 1 1  ON 4
 uu_5                -1.014547e-01 1 1  ON 5
 uu_6                -1.284185e-01 1 1  ON 6
 uu_7                -1.421487e-01 1 1  ON 7
 uu_8                -1.341787e-01 1 1  ON 8
 uu_9                -1.054392e-01 1 1  ON 9
 ud_0                 4.488816e-01 1 1  ON 10
 ud_1                 1.833446e-01 1 1  ON 11
 ud_2                 6.307563e-02 1 1  ON 12
 ud_3                -8.052221e-03 1 1  ON 13
 ud_4                -6.534674e-02 1 1  ON 14
 ud_5                -1.072956e-01 1 1  ON 15
 ud_6                -1.353629e-01 1 1  ON 16
 ud_7                -1.523372e-01 1 1  ON 17
 ud_8                -1.530255e-01 1 1  ON 18
 ud_9                -1.432387e-01 1 1  ON 19
 eO_0                -7.605701e-01 1 1  ON 20
 eO_1                -4.393366e-01 1 1  ON 21
 eO_2                -2.154935e-02 1 1  ON 22
 eO_3                 2.988939e-01 1 1  ON 23
 eO_4                 5.258120e-01 1 1  ON 24
 eO_5                 4.879266e-01 1 1  ON 25
 eO_6                 2.602481e-01 1 1  ON 26
 eO_7                -4.071951e-02 1 1  ON 27
 eO_8                -2.219798e-01 1 1  ON 28
 eO_9                -8.719483e-02 1 1  ON 29
eH1_0                -2.466467e-01 1 1  ON 30
eH1_1                -1.458862e-01 1 1  ON 31
eH1_2                -9.861945e-02 1 1  ON 32
eH1_3                -4.466212e-02 1 1  ON 33
eH1_4                 3.622361e-03 1 1  ON 34
eH1_5                 3.816028e-02 1 1  ON 35
eH1_6                 9.663358e-02 1 1  ON 36
eH1_7                 1.543095e-01 1 1  ON 37
eH1_8                 1.780357e-01 1 1  ON 38
eH1_9                 6.901420e-02 1 1  ON 39
eH2_0                -2.444734e-01 1 1  ON 40
eH2_1                -1.436727e-01 1 1  ON 41
eH2_2                -9.651200e-02 1 1  ON 42
eH2_3                -4.244247e-02 1 1  ON 43
eH2_4                 6.001617e-03 1 1  ON 44
eH2_5                 4.034402e-02 1 1  ON 45
eH2_6                 9.954508e-02 1 1  ON 46
eH2_7                 1.556688e-01 1 1  ON 47
eH2_8                 1.833628e-01 1 1  ON 48
eH2_9                 5.861722e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.298205
====================================================
  Execution time = 2.1066e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3137e-01
  Total weights = 2.0000e+06
  Execution time = 1.8855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331388394776
                                         uncertainty =       0.002949047241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331388394776
                                         uncertainty =       0.002949047241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407041809
  error estimate for blocks of size 2^( 2) =       0.000419656050
  error estimate for blocks of size 2^( 3) =       0.000432312132
  error estimate for blocks of size 2^( 4) =       0.000444416987
  error estimate for blocks of size 2^( 5) =       0.000454419639
  error estimate for blocks of size 2^( 6) =       0.000461795514
  error estimate for blocks of size 2^( 7) =       0.000463507180

      target function =                  N/A
              le_mean =     -16.905877033373
             les_mean =     286.140044170618
             stat err =       0.000456034830
             autocorr =       1.255214614845
              std dev =       0.575644046935
             le_variance =       0.331366068771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331415415662
                                         uncertainty =       0.002949233777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331415415662
                                         uncertainty =       0.002949233777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407058391
  error estimate for blocks of size 2^( 2) =       0.000419670496
  error estimate for blocks of size 2^( 3) =       0.000432324300
  error estimate for blocks of size 2^( 4) =       0.000444427964
  error estimate for blocks of size 2^( 5) =       0.000454430621
  error estimate for blocks of size 2^( 6) =       0.000461806010
  error estimate for blocks of size 2^( 7) =       0.000463516057

      target function =                  N/A
              le_mean =     -16.905876597208
             les_mean =     286.140056422330
             stat err =       0.000456045163
             autocorr =       1.255169226550
              std dev =       0.575667497782
             le_variance =       0.331393068002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331402109001
                                         uncertainty =       0.002949161018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331402109001
                                         uncertainty =       0.002949161018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407050226
  error estimate for blocks of size 2^( 2) =       0.000419663377
  error estimate for blocks of size 2^( 3) =       0.000432318284
  error estimate for blocks of size 2^( 4) =       0.000444422551
  error estimate for blocks of size 2^( 5) =       0.000454425277
  error estimate for blocks of size 2^( 6) =       0.000461800852
  error estimate for blocks of size 2^( 7) =       0.000463511564

      target function =                  N/A
              le_mean =     -16.905876805258
             les_mean =     286.140050161234
             stat err =       0.000456040061
             autocorr =       1.255191501463
              std dev =       0.575655949656
             le_variance =       0.331379772374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331390114057
                                         uncertainty =       0.002949061888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331390114057
                                         uncertainty =       0.002949061888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407042864
  error estimate for blocks of size 2^( 2) =       0.000419656968
  error estimate for blocks of size 2^( 3) =       0.000432312901
  error estimate for blocks of size 2^( 4) =       0.000444417681
  error estimate for blocks of size 2^( 5) =       0.000454420344
  error estimate for blocks of size 2^( 6) =       0.000461796179
  error estimate for blocks of size 2^( 7) =       0.000463507722

      target function =                  N/A
              le_mean =     -16.905877002787
             les_mean =     286.140044854409
             stat err =       0.000456035481
             autocorr =       1.255211692291
              std dev =       0.575645539149
             le_variance =       0.331367786742


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905877033373        initial  <--
     2.4414e+00     2.4414e+01             1.4381e-04       -16.905876597208
     9.7656e+00     9.7656e+01             3.6336e-05       -16.905876805258
     3.9062e+01     3.9062e+02             9.1221e-06       -16.905877002787

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6033
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.095906e-01 1 1  ON 0
 uu_1                 1.427877e-01 1 1  ON 1
 uu_2                 4.110124e-02 1 1  ON 2
 uu_3                -2.117047e-02 1 1  ON 3
 uu_4                -6.670628e-02 1 1  ON 4
 uu_5                -1.014512e-01 1 1  ON 5
 uu_6                -1.284022e-01 1 1  ON 6
 uu_7                -1.421395e-01 1 1  ON 7
 uu_8                -1.341665e-01 1 1  ON 8
 uu_9                -1.054282e-01 1 1  ON 9
 ud_0                 4.488585e-01 1 1  ON 10
 ud_1                 1.833366e-01 1 1  ON 11
 ud_2                 6.306825e-02 1 1  ON 12
 ud_3                -8.042385e-03 1 1  ON 13
 ud_4                -6.533683e-02 1 1  ON 14
 ud_5                -1.072999e-01 1 1  ON 15
 ud_6                -1.353729e-01 1 1  ON 16
 ud_7                -1.523332e-01 1 1  ON 17
 ud_8                -1.530131e-01 1 1  ON 18
 ud_9                -1.432298e-01 1 1  ON 19
 eO_0                -7.605664e-01 1 1  ON 20
 eO_1                -4.393344e-01 1 1  ON 21
 eO_2                -2.155405e-02 1 1  ON 22
 eO_3                 2.988913e-01 1 1  ON 23
 eO_4                 5.258018e-01 1 1  ON 24
 eO_5                 4.879161e-01 1 1  ON 25
 eO_6                 2.602419e-01 1 1  ON 26
 eO_7                -4.072120e-02 1 1  ON 27
 eO_8                -2.219667e-01 1 1  ON 28
 eO_9                -8.718045e-02 1 1  ON 29
eH1_0                -2.466103e-01 1 1  ON 30
eH1_1                -1.458728e-01 1 1  ON 31
eH1_2                -9.862138e-02 1 1  ON 32
eH1_3                -4.465836e-02 1 1  ON 33
eH1_4                 3.607567e-03 1 1  ON 34
eH1_5                 3.814555e-02 1 1  ON 35
eH1_6                 9.662718e-02 1 1  ON 36
eH1_7                 1.543142e-01 1 1  ON 37
eH1_8                 1.780322e-01 1 1  ON 38
eH1_9                 6.899972e-02 1 1  ON 39
eH2_0                -2.444390e-01 1 1  ON 40
eH2_1                -1.436669e-01 1 1  ON 41
eH2_2                -9.651682e-02 1 1  ON 42
eH2_3                -4.244349e-02 1 1  ON 43
eH2_4                 5.998963e-03 1 1  ON 44
eH2_5                 4.033403e-02 1 1  ON 45
eH2_6                 9.955167e-02 1 1  ON 46
eH2_7                 1.556723e-01 1 1  ON 47
eH2_8                 1.833496e-01 1 1  ON 48
eH2_9                 5.859697e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6896e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9403
    reference variance = 0.222026
====================================================
  Execution time = 2.1120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5696e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356975129930
                                         uncertainty =       0.013911089373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356975129930
                                         uncertainty =       0.013911089373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422466991
  error estimate for blocks of size 2^( 2) =       0.000434994612
  error estimate for blocks of size 2^( 3) =       0.000447920564
  error estimate for blocks of size 2^( 4) =       0.000459247270
  error estimate for blocks of size 2^( 5) =       0.000470009130
  error estimate for blocks of size 2^( 6) =       0.000478905660
  error estimate for blocks of size 2^( 7) =       0.000484240181

      target function =                  N/A
              le_mean =     -16.905667604211
             les_mean =     286.158553681977
             stat err =       0.000473100560
             autocorr =       1.254068798506
              std dev =       0.597458547825
             le_variance =       0.356956716369


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566760421e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905667604211       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905667585768       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905667524230       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905667529745       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905667532555       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905667536268       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905667539430       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905667538519       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.443716e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905667604211       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905667599574       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905667584025       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905667585340       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905667586101       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905667587010       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905667587816       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905667587604       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.613895e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905667604211       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905667603051       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905667599153       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905667599478       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905667599671       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905667599897       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905667600100       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905667600049       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 9.037611e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153738 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6751e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.095917e-01 1 1  ON 0
 uu_1                 1.427879e-01 1 1  ON 1
 uu_2                 4.110195e-02 1 1  ON 2
 uu_3                -2.117164e-02 1 1  ON 3
 uu_4                -6.670696e-02 1 1  ON 4
 uu_5                -1.014511e-01 1 1  ON 5
 uu_6                -1.284040e-01 1 1  ON 6
 uu_7                -1.421405e-01 1 1  ON 7
 uu_8                -1.341660e-01 1 1  ON 8
 uu_9                -1.054280e-01 1 1  ON 9
 ud_0                 4.488588e-01 1 1  ON 10
 ud_1                 1.833375e-01 1 1  ON 11
 ud_2                 6.306854e-02 1 1  ON 12
 ud_3                -8.043591e-03 1 1  ON 13
 ud_4                -6.533712e-02 1 1  ON 14
 ud_5                -1.073005e-01 1 1  ON 15
 ud_6                -1.353733e-01 1 1  ON 16
 ud_7                -1.523339e-01 1 1  ON 17
 ud_8                -1.530119e-01 1 1  ON 18
 ud_9                -1.432292e-01 1 1  ON 19
 eO_0                -7.605660e-01 1 1  ON 20
 eO_1                -4.393363e-01 1 1  ON 21
 eO_2                -2.155340e-02 1 1  ON 22
 eO_3                 2.988920e-01 1 1  ON 23
 eO_4                 5.258015e-01 1 1  ON 24
 eO_5                 4.879174e-01 1 1  ON 25
 eO_6                 2.602426e-01 1 1  ON 26
 eO_7                -4.072073e-02 1 1  ON 27
 eO_8                -2.219670e-01 1 1  ON 28
 eO_9                -8.718177e-02 1 1  ON 29
eH1_0                -2.466139e-01 1 1  ON 30
eH1_1                -1.458738e-01 1 1  ON 31
eH1_2                -9.862239e-02 1 1  ON 32
eH1_3                -4.465750e-02 1 1  ON 33
eH1_4                 3.607614e-03 1 1  ON 34
eH1_5                 3.814546e-02 1 1  ON 35
eH1_6                 9.662765e-02 1 1  ON 36
eH1_7                 1.543146e-01 1 1  ON 37
eH1_8                 1.780334e-01 1 1  ON 38
eH1_9                 6.900204e-02 1 1  ON 39
eH2_0                -2.444420e-01 1 1  ON 40
eH2_1                -1.436690e-01 1 1  ON 41
eH2_2                -9.651601e-02 1 1  ON 42
eH2_3                -4.244348e-02 1 1  ON 43
eH2_4                 6.000398e-03 1 1  ON 44
eH2_5                 4.033438e-02 1 1  ON 45
eH2_6                 9.955105e-02 1 1  ON 46
eH2_7                 1.556719e-01 1 1  ON 47
eH2_8                 1.833508e-01 1 1  ON 48
eH2_9                 5.859914e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8396
    reference variance = 0.256236
====================================================
  Execution time = 2.1242e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3766e-01
  Total weights = 2.0000e+06
  Execution time = 1.8806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337663725352
                                         uncertainty =       0.003592082201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337663725352
                                         uncertainty =       0.003592082201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410886636
  error estimate for blocks of size 2^( 2) =       0.000424002586
  error estimate for blocks of size 2^( 3) =       0.000436989331
  error estimate for blocks of size 2^( 4) =       0.000448701012
  error estimate for blocks of size 2^( 5) =       0.000459628020
  error estimate for blocks of size 2^( 6) =       0.000467008479
  error estimate for blocks of size 2^( 7) =       0.000471372090

      target function =                  N/A
              le_mean =     -16.906706584532
             les_mean =     286.174383022102
             stat err =       0.000461677400
             autocorr =       1.262505267524
              std dev =       0.581081453378
             le_variance =       0.337655655459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337662350273
                                         uncertainty =       0.003592098270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337662350273
                                         uncertainty =       0.003592098270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410885802
  error estimate for blocks of size 2^( 2) =       0.000424001719
  error estimate for blocks of size 2^( 3) =       0.000436988418
  error estimate for blocks of size 2^( 4) =       0.000448700168
  error estimate for blocks of size 2^( 5) =       0.000459627351
  error estimate for blocks of size 2^( 6) =       0.000467007733
  error estimate for blocks of size 2^( 7) =       0.000471371582

      target function =                  N/A
              le_mean =     -16.906706663525
             les_mean =     286.174384322678
             stat err =       0.000461676709
             autocorr =       1.262506610081
              std dev =       0.581080274160
             le_variance =       0.337654285018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337663005290
                                         uncertainty =       0.003592089964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337663005290
                                         uncertainty =       0.003592089964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410886199
  error estimate for blocks of size 2^( 2) =       0.000424002133
  error estimate for blocks of size 2^( 3) =       0.000436988856
  error estimate for blocks of size 2^( 4) =       0.000448700572
  error estimate for blocks of size 2^( 5) =       0.000459627669
  error estimate for blocks of size 2^( 6) =       0.000467008089
  error estimate for blocks of size 2^( 7) =       0.000471371821

      target function =                  N/A
              le_mean =     -16.906706624384
             les_mean =     286.174383651907
             stat err =       0.000461677038
             autocorr =       1.262505969305
              std dev =       0.581080835811
             le_variance =       0.337654937747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337663634252
                                         uncertainty =       0.003592083163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337663634252
                                         uncertainty =       0.003592083163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410886581
  error estimate for blocks of size 2^( 2) =       0.000424002529
  error estimate for blocks of size 2^( 3) =       0.000436989271
  error estimate for blocks of size 2^( 4) =       0.000448700956
  error estimate for blocks of size 2^( 5) =       0.000459627976
  error estimate for blocks of size 2^( 6) =       0.000467008430
  error estimate for blocks of size 2^( 7) =       0.000471372056

      target function =                  N/A
              le_mean =     -16.906706589517
             les_mean =     286.174383099846
             stat err =       0.000461677354
             autocorr =       1.262505356208
              std dev =       0.581081375243
             le_variance =       0.337655564654


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906706584532        initial
     2.4414e+01     2.4414e+02             1.4437e-05       -16.906706663525  <--
     9.7656e+01     9.7656e+02             3.6139e-06       -16.906706624384
     3.9062e+02     3.9062e+03             9.0376e-07       -16.906706589517

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 3.0747e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.095949e-01 1 1  ON 0
 uu_1                 1.427886e-01 1 1  ON 1
 uu_2                 4.110406e-02 1 1  ON 2
 uu_3                -2.117509e-02 1 1  ON 3
 uu_4                -6.670901e-02 1 1  ON 4
 uu_5                -1.014509e-01 1 1  ON 5
 uu_6                -1.284094e-01 1 1  ON 6
 uu_7                -1.421438e-01 1 1  ON 7
 uu_8                -1.341645e-01 1 1  ON 8
 uu_9                -1.054274e-01 1 1  ON 9
 ud_0                 4.488596e-01 1 1  ON 10
 ud_1                 1.833403e-01 1 1  ON 11
 ud_2                 6.306938e-02 1 1  ON 12
 ud_3                -8.047158e-03 1 1  ON 13
 ud_4                -6.533800e-02 1 1  ON 14
 ud_5                -1.073023e-01 1 1  ON 15
 ud_6                -1.353747e-01 1 1  ON 16
 ud_7                -1.523359e-01 1 1  ON 17
 ud_8                -1.530083e-01 1 1  ON 18
 ud_9                -1.432274e-01 1 1  ON 19
 eO_0                -7.605649e-01 1 1  ON 20
 eO_1                -4.393420e-01 1 1  ON 21
 eO_2                -2.155148e-02 1 1  ON 22
 eO_3                 2.988940e-01 1 1  ON 23
 eO_4                 5.258004e-01 1 1  ON 24
 eO_5                 4.879216e-01 1 1  ON 25
 eO_6                 2.602445e-01 1 1  ON 26
 eO_7                -4.071935e-02 1 1  ON 27
 eO_8                -2.219680e-01 1 1  ON 28
 eO_9                -8.718570e-02 1 1  ON 29
eH1_0                -2.466248e-01 1 1  ON 30
eH1_1                -1.458769e-01 1 1  ON 31
eH1_2                -9.862540e-02 1 1  ON 32
eH1_3                -4.465495e-02 1 1  ON 33
eH1_4                 3.607759e-03 1 1  ON 34
eH1_5                 3.814520e-02 1 1  ON 35
eH1_6                 9.662908e-02 1 1  ON 36
eH1_7                 1.543160e-01 1 1  ON 37
eH1_8                 1.780368e-01 1 1  ON 38
eH1_9                 6.900899e-02 1 1  ON 39
eH2_0                -2.444510e-01 1 1  ON 40
eH2_1                -1.436751e-01 1 1  ON 41
eH2_2                -9.651364e-02 1 1  ON 42
eH2_3                -4.244344e-02 1 1  ON 43
eH2_4                 6.004674e-03 1 1  ON 44
eH2_5                 4.033544e-02 1 1  ON 45
eH2_6                 9.954919e-02 1 1  ON 46
eH2_7                 1.556707e-01 1 1  ON 47
eH2_8                 1.833544e-01 1 1  ON 48
eH2_9                 5.860567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7507e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9745
    reference variance = 0.320221
====================================================
  Execution time = 2.3384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4274e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342814174412
                                         uncertainty =       0.004088852338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342814174412
                                         uncertainty =       0.004088852338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413967207
  error estimate for blocks of size 2^( 2) =       0.000427047589
  error estimate for blocks of size 2^( 3) =       0.000440175533
  error estimate for blocks of size 2^( 4) =       0.000453050285
  error estimate for blocks of size 2^( 5) =       0.000464237714
  error estimate for blocks of size 2^( 6) =       0.000473822260
  error estimate for blocks of size 2^( 7) =       0.000481500630

      target function =                  N/A
              le_mean =     -16.905577611585
             les_mean =     286.141291907386
             stat err =       0.000468152722
             autocorr =       1.278919553388
              std dev =       0.585438038922
             le_variance =       0.342737697417


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690557761159e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905577611585       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905577583956       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905577730877       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905577799376       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905577914057       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905577941126       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905577905997       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905577914590       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 5.778903e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905577611585       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905577604517       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905577641591       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905577658354       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905577687965       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905577695744       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905577687188       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905577689237       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.454661e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905577611585       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905577609808       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905577619097       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905577623269       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905577630727       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905577632739       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905577630616       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905577631122       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.643003e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8995e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.095979e-01 1 1  ON 0
 uu_1                 1.427928e-01 1 1  ON 1
 uu_2                 4.110671e-02 1 1  ON 2
 uu_3                -2.117355e-02 1 1  ON 3
 uu_4                -6.670934e-02 1 1  ON 4
 uu_5                -1.014573e-01 1 1  ON 5
 uu_6                -1.284117e-01 1 1  ON 6
 uu_7                -1.421450e-01 1 1  ON 7
 uu_8                -1.341683e-01 1 1  ON 8
 uu_9                -1.054300e-01 1 1  ON 9
 ud_0                 4.488673e-01 1 1  ON 10
 ud_1                 1.833418e-01 1 1  ON 11
 ud_2                 6.306562e-02 1 1  ON 12
 ud_3                -8.052239e-03 1 1  ON 13
 ud_4                -6.534091e-02 1 1  ON 14
 ud_5                -1.073043e-01 1 1  ON 15
 ud_6                -1.353718e-01 1 1  ON 16
 ud_7                -1.523396e-01 1 1  ON 17
 ud_8                -1.530078e-01 1 1  ON 18
 ud_9                -1.432243e-01 1 1  ON 19
 eO_0                -7.605662e-01 1 1  ON 20
 eO_1                -4.393416e-01 1 1  ON 21
 eO_2                -2.155044e-02 1 1  ON 22
 eO_3                 2.988971e-01 1 1  ON 23
 eO_4                 5.258035e-01 1 1  ON 24
 eO_5                 4.879229e-01 1 1  ON 25
 eO_6                 2.602432e-01 1 1  ON 26
 eO_7                -4.071760e-02 1 1  ON 27
 eO_8                -2.219710e-01 1 1  ON 28
 eO_9                -8.719007e-02 1 1  ON 29
eH1_0                -2.466393e-01 1 1  ON 30
eH1_1                -1.458794e-01 1 1  ON 31
eH1_2                -9.862354e-02 1 1  ON 32
eH1_3                -4.465374e-02 1 1  ON 33
eH1_4                 3.610177e-03 1 1  ON 34
eH1_5                 3.814242e-02 1 1  ON 35
eH1_6                 9.662979e-02 1 1  ON 36
eH1_7                 1.543181e-01 1 1  ON 37
eH1_8                 1.780422e-01 1 1  ON 38
eH1_9                 6.901524e-02 1 1  ON 39
eH2_0                -2.444621e-01 1 1  ON 40
eH2_1                -1.436815e-01 1 1  ON 41
eH2_2                -9.651726e-02 1 1  ON 42
eH2_3                -4.244346e-02 1 1  ON 43
eH2_4                 6.004934e-03 1 1  ON 44
eH2_5                 4.033313e-02 1 1  ON 45
eH2_6                 9.955228e-02 1 1  ON 46
eH2_7                 1.556710e-01 1 1  ON 47
eH2_8                 1.833615e-01 1 1  ON 48
eH2_9                 5.861640e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9363
    reference variance = 0.227281
====================================================
  Execution time = 2.0234e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3529e-01
  Total weights = 2.0000e+06
  Execution time = 1.8724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335392341819
                                         uncertainty =       0.002842160086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335392341819
                                         uncertainty =       0.002842160086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409441220
  error estimate for blocks of size 2^( 2) =       0.000422113016
  error estimate for blocks of size 2^( 3) =       0.000435252082
  error estimate for blocks of size 2^( 4) =       0.000447198679
  error estimate for blocks of size 2^( 5) =       0.000457263482
  error estimate for blocks of size 2^( 6) =       0.000465937118
  error estimate for blocks of size 2^( 7) =       0.000471172873

      target function =                  N/A
              le_mean =     -16.905958200015
             les_mean =     286.146706718224
             stat err =       0.000460393038
             autocorr =       1.264370546622
              std dev =       0.579037326261
             le_variance =       0.335284225204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335422481764
                                         uncertainty =       0.002842409906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335422481764
                                         uncertainty =       0.002842409906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409459616
  error estimate for blocks of size 2^( 2) =       0.000422130115
  error estimate for blocks of size 2^( 3) =       0.000435267800
  error estimate for blocks of size 2^( 4) =       0.000447213727
  error estimate for blocks of size 2^( 5) =       0.000457278206
  error estimate for blocks of size 2^( 6) =       0.000465951663
  error estimate for blocks of size 2^( 7) =       0.000471187590

      target function =                  N/A
              le_mean =     -16.905957980600
             les_mean =     286.146729427774
             stat err =       0.000460407796
             autocorr =       1.264337996602
              std dev =       0.579063341631
             le_variance =       0.335314353621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335407942106
                                         uncertainty =       0.002842288484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335407942106
                                         uncertainty =       0.002842288484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409450742
  error estimate for blocks of size 2^( 2) =       0.000422121865
  error estimate for blocks of size 2^( 3) =       0.000435260215
  error estimate for blocks of size 2^( 4) =       0.000447206463
  error estimate for blocks of size 2^( 5) =       0.000457271097
  error estimate for blocks of size 2^( 6) =       0.000465944635
  error estimate for blocks of size 2^( 7) =       0.000471180465

      target function =                  N/A
              le_mean =     -16.905958085748
             les_mean =     286.146718448859
             stat err =       0.000460400665
             autocorr =       1.264353631899
              std dev =       0.579050791776
             le_variance =       0.335299819456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335394308506
                                         uncertainty =       0.002842176244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335394308506
                                         uncertainty =       0.002842176244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409442420
  error estimate for blocks of size 2^( 2) =       0.000422114132
  error estimate for blocks of size 2^( 3) =       0.000435253107
  error estimate for blocks of size 2^( 4) =       0.000447199660
  error estimate for blocks of size 2^( 5) =       0.000457264442
  error estimate for blocks of size 2^( 6) =       0.000465938065
  error estimate for blocks of size 2^( 7) =       0.000471173829

      target function =                  N/A
              le_mean =     -16.905958185460
             les_mean =     286.146708192005
             stat err =       0.000460393999
             autocorr =       1.264368410769
              std dev =       0.579039023838
             le_variance =       0.335286191128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905958200015        initial  <--
     6.1035e+00     6.1035e+01             5.7789e-05       -16.905957980600
     2.4414e+01     2.4414e+02             1.4547e-05       -16.905958085748
     9.7656e+01     9.7656e+02             3.6430e-06       -16.905958185460

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6847
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.095949e-01 1 1  ON 0
 uu_1                 1.427886e-01 1 1  ON 1
 uu_2                 4.110406e-02 1 1  ON 2
 uu_3                -2.117509e-02 1 1  ON 3
 uu_4                -6.670901e-02 1 1  ON 4
 uu_5                -1.014509e-01 1 1  ON 5
 uu_6                -1.284094e-01 1 1  ON 6
 uu_7                -1.421438e-01 1 1  ON 7
 uu_8                -1.341645e-01 1 1  ON 8
 uu_9                -1.054274e-01 1 1  ON 9
 ud_0                 4.488596e-01 1 1  ON 10
 ud_1                 1.833403e-01 1 1  ON 11
 ud_2                 6.306938e-02 1 1  ON 12
 ud_3                -8.047158e-03 1 1  ON 13
 ud_4                -6.533800e-02 1 1  ON 14
 ud_5                -1.073023e-01 1 1  ON 15
 ud_6                -1.353747e-01 1 1  ON 16
 ud_7                -1.523359e-01 1 1  ON 17
 ud_8                -1.530083e-01 1 1  ON 18
 ud_9                -1.432274e-01 1 1  ON 19
 eO_0                -7.605649e-01 1 1  ON 20
 eO_1                -4.393420e-01 1 1  ON 21
 eO_2                -2.155148e-02 1 1  ON 22
 eO_3                 2.988940e-01 1 1  ON 23
 eO_4                 5.258004e-01 1 1  ON 24
 eO_5                 4.879216e-01 1 1  ON 25
 eO_6                 2.602445e-01 1 1  ON 26
 eO_7                -4.071935e-02 1 1  ON 27
 eO_8                -2.219680e-01 1 1  ON 28
 eO_9                -8.718570e-02 1 1  ON 29
eH1_0                -2.466248e-01 1 1  ON 30
eH1_1                -1.458769e-01 1 1  ON 31
eH1_2                -9.862540e-02 1 1  ON 32
eH1_3                -4.465495e-02 1 1  ON 33
eH1_4                 3.607759e-03 1 1  ON 34
eH1_5                 3.814520e-02 1 1  ON 35
eH1_6                 9.662908e-02 1 1  ON 36
eH1_7                 1.543160e-01 1 1  ON 37
eH1_8                 1.780368e-01 1 1  ON 38
eH1_9                 6.900899e-02 1 1  ON 39
eH2_0                -2.444510e-01 1 1  ON 40
eH2_1                -1.436751e-01 1 1  ON 41
eH2_2                -9.651364e-02 1 1  ON 42
eH2_3                -4.244344e-02 1 1  ON 43
eH2_4                 6.004674e-03 1 1  ON 44
eH2_5                 4.033544e-02 1 1  ON 45
eH2_6                 9.954919e-02 1 1  ON 46
eH2_7                 1.556707e-01 1 1  ON 47
eH2_8                 1.833544e-01 1 1  ON 48
eH2_9                 5.860567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8692e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9056
    reference variance = 0.290977
====================================================
  Execution time = 2.0832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4337e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343353313571
                                         uncertainty =       0.004688849072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343353313571
                                         uncertainty =       0.004688849072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414350837
  error estimate for blocks of size 2^( 2) =       0.000426637296
  error estimate for blocks of size 2^( 3) =       0.000438890630
  error estimate for blocks of size 2^( 4) =       0.000449745444
  error estimate for blocks of size 2^( 5) =       0.000459002768
  error estimate for blocks of size 2^( 6) =       0.000466701833
  error estimate for blocks of size 2^( 7) =       0.000470915285

      target function =                  N/A
              le_mean =     -16.906677293795
             les_mean =     286.179110177435
             stat err =       0.000461591332
             autocorr =       1.241020195608
              std dev =       0.585980573556
             le_variance =       0.343373232585


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690667729380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906677293795       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906677297722       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906677296387       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906677291664       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906677292459       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906677295964       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906677297821       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906677298501       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 5.246279e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906677293795       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906677294779       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906677294440       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906677293253       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906677293450       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906677294324       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906677294788       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906677294955       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.312231e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906677293795       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906677294041       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906677293956       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906677293659       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906677293708       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906677293926       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906677294043       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906677294083       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 3.280989e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159047 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6372e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.095951e-01 1 1  ON 0
 uu_1                 1.427888e-01 1 1  ON 1
 uu_2                 4.110439e-02 1 1  ON 2
 uu_3                -2.117503e-02 1 1  ON 3
 uu_4                -6.670882e-02 1 1  ON 4
 uu_5                -1.014506e-01 1 1  ON 5
 uu_6                -1.284096e-01 1 1  ON 6
 uu_7                -1.421443e-01 1 1  ON 7
 uu_8                -1.341653e-01 1 1  ON 8
 uu_9                -1.054279e-01 1 1  ON 9
 ud_0                 4.488596e-01 1 1  ON 10
 ud_1                 1.833405e-01 1 1  ON 11
 ud_2                 6.306976e-02 1 1  ON 12
 ud_3                -8.047207e-03 1 1  ON 13
 ud_4                -6.533792e-02 1 1  ON 14
 ud_5                -1.073025e-01 1 1  ON 15
 ud_6                -1.353746e-01 1 1  ON 16
 ud_7                -1.523357e-01 1 1  ON 17
 ud_8                -1.530084e-01 1 1  ON 18
 ud_9                -1.432276e-01 1 1  ON 19
 eO_0                -7.605647e-01 1 1  ON 20
 eO_1                -4.393415e-01 1 1  ON 21
 eO_2                -2.155175e-02 1 1  ON 22
 eO_3                 2.988938e-01 1 1  ON 23
 eO_4                 5.258007e-01 1 1  ON 24
 eO_5                 4.879218e-01 1 1  ON 25
 eO_6                 2.602448e-01 1 1  ON 26
 eO_7                -4.071925e-02 1 1  ON 27
 eO_8                -2.219686e-01 1 1  ON 28
 eO_9                -8.718623e-02 1 1  ON 29
eH1_0                -2.466261e-01 1 1  ON 30
eH1_1                -1.458774e-01 1 1  ON 31
eH1_2                -9.862547e-02 1 1  ON 32
eH1_3                -4.465449e-02 1 1  ON 33
eH1_4                 3.607624e-03 1 1  ON 34
eH1_5                 3.814531e-02 1 1  ON 35
eH1_6                 9.662898e-02 1 1  ON 36
eH1_7                 1.543165e-01 1 1  ON 37
eH1_8                 1.780375e-01 1 1  ON 38
eH1_9                 6.900951e-02 1 1  ON 39
eH2_0                -2.444521e-01 1 1  ON 40
eH2_1                -1.436757e-01 1 1  ON 41
eH2_2                -9.651332e-02 1 1  ON 42
eH2_3                -4.244332e-02 1 1  ON 43
eH2_4                 6.004808e-03 1 1  ON 44
eH2_5                 4.033576e-02 1 1  ON 45
eH2_6                 9.954889e-02 1 1  ON 46
eH2_7                 1.556705e-01 1 1  ON 47
eH2_8                 1.833546e-01 1 1  ON 48
eH2_9                 5.860649e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8858
    reference variance = 0.311592
====================================================
  Execution time = 2.0519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3713e-01
  Total weights = 2.0000e+06
  Execution time = 1.8712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337205485985
                                         uncertainty =       0.003243580670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337205485985
                                         uncertainty =       0.003243580670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410569859
  error estimate for blocks of size 2^( 2) =       0.000423342428
  error estimate for blocks of size 2^( 3) =       0.000436876502
  error estimate for blocks of size 2^( 4) =       0.000449681220
  error estimate for blocks of size 2^( 5) =       0.000459989111
  error estimate for blocks of size 2^( 6) =       0.000467213176
  error estimate for blocks of size 2^( 7) =       0.000470940438

      target function =                  N/A
              le_mean =     -16.905462703255
             les_mean =     286.131804260546
             stat err =       0.000461955986
             autocorr =       1.265980662686
              std dev =       0.580633462652
             le_variance =       0.337135217951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337203748878
                                         uncertainty =       0.003243553328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337203748878
                                         uncertainty =       0.003243553328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410568801
  error estimate for blocks of size 2^( 2) =       0.000423341403
  error estimate for blocks of size 2^( 3) =       0.000436875520
  error estimate for blocks of size 2^( 4) =       0.000449680261
  error estimate for blocks of size 2^( 5) =       0.000459988206
  error estimate for blocks of size 2^( 6) =       0.000467212242
  error estimate for blocks of size 2^( 7) =       0.000470939503

      target function =                  N/A
              le_mean =     -16.905462704648
             les_mean =     286.131802571117
             stat err =       0.000461955053
             autocorr =       1.265982067704
              std dev =       0.580631967304
             le_variance =       0.337133481456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337204611974
                                         uncertainty =       0.003243566912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337204611974
                                         uncertainty =       0.003243566912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410569327
  error estimate for blocks of size 2^( 2) =       0.000423341913
  error estimate for blocks of size 2^( 3) =       0.000436876008
  error estimate for blocks of size 2^( 4) =       0.000449680738
  error estimate for blocks of size 2^( 5) =       0.000459988656
  error estimate for blocks of size 2^( 6) =       0.000467212706
  error estimate for blocks of size 2^( 7) =       0.000470939968

      target function =                  N/A
              le_mean =     -16.905462703969
             les_mean =     286.131803410953
             stat err =       0.000461955517
             autocorr =       1.265981371274
              std dev =       0.580632710279
             le_variance =       0.337134344246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337205376558
                                         uncertainty =       0.003243578948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337205376558
                                         uncertainty =       0.003243578948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410569792
  error estimate for blocks of size 2^( 2) =       0.000423342364
  error estimate for blocks of size 2^( 3) =       0.000436876440
  error estimate for blocks of size 2^( 4) =       0.000449681160
  error estimate for blocks of size 2^( 5) =       0.000459989054
  error estimate for blocks of size 2^( 6) =       0.000467213117
  error estimate for blocks of size 2^( 7) =       0.000470940379

      target function =                  N/A
              le_mean =     -16.905462703344
             les_mean =     286.131804154158
             stat err =       0.000461955928
             autocorr =       1.265980751441
              std dev =       0.580633368454
             le_variance =       0.337135108562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905462703255        initial
     6.1035e+01     6.1035e+02             5.2463e-06       -16.905462704648  <--
     2.4414e+02     2.4414e+03             1.3122e-06       -16.905462703969
     9.7656e+02     9.7656e+03             3.2810e-07       -16.905462703344

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 2.9987e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.095956e-01 1 1  ON 0
 uu_1                 1.427895e-01 1 1  ON 1
 uu_2                 4.110537e-02 1 1  ON 2
 uu_3                -2.117484e-02 1 1  ON 3
 uu_4                -6.670827e-02 1 1  ON 4
 uu_5                -1.014497e-01 1 1  ON 5
 uu_6                -1.284104e-01 1 1  ON 6
 uu_7                -1.421457e-01 1 1  ON 7
 uu_8                -1.341676e-01 1 1  ON 8
 uu_9                -1.054293e-01 1 1  ON 9
 ud_0                 4.488595e-01 1 1  ON 10
 ud_1                 1.833408e-01 1 1  ON 11
 ud_2                 6.307088e-02 1 1  ON 12
 ud_3                -8.047348e-03 1 1  ON 13
 ud_4                -6.533766e-02 1 1  ON 14
 ud_5                -1.073029e-01 1 1  ON 15
 ud_6                -1.353742e-01 1 1  ON 16
 ud_7                -1.523351e-01 1 1  ON 17
 ud_8                -1.530087e-01 1 1  ON 18
 ud_9                -1.432284e-01 1 1  ON 19
 eO_0                -7.605642e-01 1 1  ON 20
 eO_1                -4.393399e-01 1 1  ON 21
 eO_2                -2.155255e-02 1 1  ON 22
 eO_3                 2.988932e-01 1 1  ON 23
 eO_4                 5.258017e-01 1 1  ON 24
 eO_5                 4.879223e-01 1 1  ON 25
 eO_6                 2.602456e-01 1 1  ON 26
 eO_7                -4.071897e-02 1 1  ON 27
 eO_8                -2.219701e-01 1 1  ON 28
 eO_9                -8.718782e-02 1 1  ON 29
eH1_0                -2.466300e-01 1 1  ON 30
eH1_1                -1.458791e-01 1 1  ON 31
eH1_2                -9.862567e-02 1 1  ON 32
eH1_3                -4.465312e-02 1 1  ON 33
eH1_4                 3.607224e-03 1 1  ON 34
eH1_5                 3.814564e-02 1 1  ON 35
eH1_6                 9.662866e-02 1 1  ON 36
eH1_7                 1.543179e-01 1 1  ON 37
eH1_8                 1.780394e-01 1 1  ON 38
eH1_9                 6.901109e-02 1 1  ON 39
eH2_0                -2.444552e-01 1 1  ON 40
eH2_1                -1.436774e-01 1 1  ON 41
eH2_2                -9.651236e-02 1 1  ON 42
eH2_3                -4.244294e-02 1 1  ON 43
eH2_4                 6.005208e-03 1 1  ON 44
eH2_5                 4.033673e-02 1 1  ON 45
eH2_6                 9.954796e-02 1 1  ON 46
eH2_7                 1.556699e-01 1 1  ON 47
eH2_8                 1.833553e-01 1 1  ON 48
eH2_9                 5.860894e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6368e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8945
    reference variance = 0.099577
====================================================
  Execution time = 2.0971e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3696e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337055455125
                                         uncertainty =       0.003709832762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337055455125
                                         uncertainty =       0.003709832762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410462525
  error estimate for blocks of size 2^( 2) =       0.000423000147
  error estimate for blocks of size 2^( 3) =       0.000435831651
  error estimate for blocks of size 2^( 4) =       0.000447434475
  error estimate for blocks of size 2^( 5) =       0.000457327951
  error estimate for blocks of size 2^( 6) =       0.000463211666
  error estimate for blocks of size 2^( 7) =       0.000465967380

      target function =                  N/A
              le_mean =     -16.907033715098
             les_mean =     286.184747843983
             stat err =       0.000458485368
             autocorr =       1.247682073820
              std dev =       0.580481669829
             le_variance =       0.336958969008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690703371510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907033715098       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907033742706       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907033862088       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907033870069       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907033841465       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907033818750       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907033820623       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907033822624       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.191925e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907033715098       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907033722059       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907033752547       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907033754598       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907033747751       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907033741984       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907033742299       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907033742727       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 5.493443e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907033715098       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907033716842       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907033724505       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907033725021       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907033723330       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907033721883       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907033721951       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907033722054       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.374219e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161663 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6554e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.095958e-01 1 1  ON 0
 uu_1                 1.427890e-01 1 1  ON 1
 uu_2                 4.110808e-02 1 1  ON 2
 uu_3                -2.117553e-02 1 1  ON 3
 uu_4                -6.670855e-02 1 1  ON 4
 uu_5                -1.014483e-01 1 1  ON 5
 uu_6                -1.284126e-01 1 1  ON 6
 uu_7                -1.421479e-01 1 1  ON 7
 uu_8                -1.341683e-01 1 1  ON 8
 uu_9                -1.054294e-01 1 1  ON 9
 ud_0                 4.488623e-01 1 1  ON 10
 ud_1                 1.833416e-01 1 1  ON 11
 ud_2                 6.307035e-02 1 1  ON 12
 ud_3                -8.046737e-03 1 1  ON 13
 ud_4                -6.533852e-02 1 1  ON 14
 ud_5                -1.073044e-01 1 1  ON 15
 ud_6                -1.353732e-01 1 1  ON 16
 ud_7                -1.523349e-01 1 1  ON 17
 ud_8                -1.530101e-01 1 1  ON 18
 ud_9                -1.432281e-01 1 1  ON 19
 eO_0                -7.605651e-01 1 1  ON 20
 eO_1                -4.393380e-01 1 1  ON 21
 eO_2                -2.155190e-02 1 1  ON 22
 eO_3                 2.988924e-01 1 1  ON 23
 eO_4                 5.258025e-01 1 1  ON 24
 eO_5                 4.879238e-01 1 1  ON 25
 eO_6                 2.602466e-01 1 1  ON 26
 eO_7                -4.071927e-02 1 1  ON 27
 eO_8                -2.219719e-01 1 1  ON 28
 eO_9                -8.718944e-02 1 1  ON 29
eH1_0                -2.466355e-01 1 1  ON 30
eH1_1                -1.458800e-01 1 1  ON 31
eH1_2                -9.862450e-02 1 1  ON 32
eH1_3                -4.465375e-02 1 1  ON 33
eH1_4                 3.606347e-03 1 1  ON 34
eH1_5                 3.814679e-02 1 1  ON 35
eH1_6                 9.662700e-02 1 1  ON 36
eH1_7                 1.543177e-01 1 1  ON 37
eH1_8                 1.780425e-01 1 1  ON 38
eH1_9                 6.901475e-02 1 1  ON 39
eH2_0                -2.444607e-01 1 1  ON 40
eH2_1                -1.436800e-01 1 1  ON 41
eH2_2                -9.651245e-02 1 1  ON 42
eH2_3                -4.244255e-02 1 1  ON 43
eH2_4                 6.006704e-03 1 1  ON 44
eH2_5                 4.033976e-02 1 1  ON 45
eH2_6                 9.954884e-02 1 1  ON 46
eH2_7                 1.556696e-01 1 1  ON 47
eH2_8                 1.833556e-01 1 1  ON 48
eH2_9                 5.861140e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8282
    reference variance = 0.201244
====================================================
  Execution time = 2.0477e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4273e-01
  Total weights = 2.0000e+06
  Execution time = 1.8801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342782313031
                                         uncertainty =       0.006699704774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342782313031
                                         uncertainty =       0.006699704774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413964207
  error estimate for blocks of size 2^( 2) =       0.000426640008
  error estimate for blocks of size 2^( 3) =       0.000440150170
  error estimate for blocks of size 2^( 4) =       0.000452635875
  error estimate for blocks of size 2^( 5) =       0.000463662971
  error estimate for blocks of size 2^( 6) =       0.000470790832
  error estimate for blocks of size 2^( 7) =       0.000475598355

      target function =                  N/A
              le_mean =     -16.906219950900
             les_mean =     286.163005586847
             stat err =       0.000465672008
             autocorr =       1.265419963090
              std dev =       0.585433796424
             le_variance =       0.342732729995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342786950773
                                         uncertainty =       0.006699740728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342786950773
                                         uncertainty =       0.006699740728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413967006
  error estimate for blocks of size 2^( 2) =       0.000426642547
  error estimate for blocks of size 2^( 3) =       0.000440152451
  error estimate for blocks of size 2^( 4) =       0.000452638093
  error estimate for blocks of size 2^( 5) =       0.000463664976
  error estimate for blocks of size 2^( 6) =       0.000470792814
  error estimate for blocks of size 2^( 7) =       0.000475600726

      target function =                  N/A
              le_mean =     -16.906220121469
             les_mean =     286.163015988717
             stat err =       0.000465674152
             autocorr =       1.265414504381
              std dev =       0.585437754623
             le_variance =       0.342737364538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342784645749
                                         uncertainty =       0.006699721712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342784645749
                                         uncertainty =       0.006699721712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413965615
  error estimate for blocks of size 2^( 2) =       0.000426641285
  error estimate for blocks of size 2^( 3) =       0.000440151317
  error estimate for blocks of size 2^( 4) =       0.000452636991
  error estimate for blocks of size 2^( 5) =       0.000463663978
  error estimate for blocks of size 2^( 6) =       0.000470791826
  error estimate for blocks of size 2^( 7) =       0.000475599547

      target function =                  N/A
              le_mean =     -16.906220038295
             les_mean =     286.163010872949
             stat err =       0.000465673086
             autocorr =       1.265417211925
              std dev =       0.585435787319
             le_variance =       0.342735061074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342782604882
                                         uncertainty =       0.006699706856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342782604882
                                         uncertainty =       0.006699706856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413964384
  error estimate for blocks of size 2^( 2) =       0.000426640168
  error estimate for blocks of size 2^( 3) =       0.000440150313
  error estimate for blocks of size 2^( 4) =       0.000452636014
  error estimate for blocks of size 2^( 5) =       0.000463663097
  error estimate for blocks of size 2^( 6) =       0.000470790956
  error estimate for blocks of size 2^( 7) =       0.000475598504

      target function =                  N/A
              le_mean =     -16.906219961870
             les_mean =     286.163006249392
             stat err =       0.000465672143
             autocorr =       1.265419618495
              std dev =       0.585434045508
             le_variance =       0.342733021640


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906219950900        initial
     1.5259e+01     1.5259e+02             2.1919e-05       -16.906220121469  <--
     6.1035e+01     6.1035e+02             5.4934e-06       -16.906220038295
     2.4414e+02     2.4414e+03             1.3742e-06       -16.906219961870

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 2.9953e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.095962e-01 1 1  ON 0
 uu_1                 1.427877e-01 1 1  ON 1
 uu_2                 4.111592e-02 1 1  ON 2
 uu_3                -2.117746e-02 1 1  ON 3
 uu_4                -6.670944e-02 1 1  ON 4
 uu_5                -1.014439e-01 1 1  ON 5
 uu_6                -1.284190e-01 1 1  ON 6
 uu_7                -1.421545e-01 1 1  ON 7
 uu_8                -1.341701e-01 1 1  ON 8
 uu_9                -1.054300e-01 1 1  ON 9
 ud_0                 4.488706e-01 1 1  ON 10
 ud_1                 1.833440e-01 1 1  ON 11
 ud_2                 6.306890e-02 1 1  ON 12
 ud_3                -8.044995e-03 1 1  ON 13
 ud_4                -6.534101e-02 1 1  ON 14
 ud_5                -1.073090e-01 1 1  ON 15
 ud_6                -1.353704e-01 1 1  ON 16
 ud_7                -1.523345e-01 1 1  ON 17
 ud_8                -1.530144e-01 1 1  ON 18
 ud_9                -1.432272e-01 1 1  ON 19
 eO_0                -7.605679e-01 1 1  ON 20
 eO_1                -4.393323e-01 1 1  ON 21
 eO_2                -2.154990e-02 1 1  ON 22
 eO_3                 2.988900e-01 1 1  ON 23
 eO_4                 5.258047e-01 1 1  ON 24
 eO_5                 4.879282e-01 1 1  ON 25
 eO_6                 2.602495e-01 1 1  ON 26
 eO_7                -4.072017e-02 1 1  ON 27
 eO_8                -2.219774e-01 1 1  ON 28
 eO_9                -8.719430e-02 1 1  ON 29
eH1_0                -2.466517e-01 1 1  ON 30
eH1_1                -1.458825e-01 1 1  ON 31
eH1_2                -9.862110e-02 1 1  ON 32
eH1_3                -4.465559e-02 1 1  ON 33
eH1_4                 3.603742e-03 1 1  ON 34
eH1_5                 3.815022e-02 1 1  ON 35
eH1_6                 9.662202e-02 1 1  ON 36
eH1_7                 1.543170e-01 1 1  ON 37
eH1_8                 1.780518e-01 1 1  ON 38
eH1_9                 6.902569e-02 1 1  ON 39
eH2_0                -2.444771e-01 1 1  ON 40
eH2_1                -1.436877e-01 1 1  ON 41
eH2_2                -9.651275e-02 1 1  ON 42
eH2_3                -4.244137e-02 1 1  ON 43
eH2_4                 6.011184e-03 1 1  ON 44
eH2_5                 4.034883e-02 1 1  ON 45
eH2_6                 9.955147e-02 1 1  ON 46
eH2_7                 1.556687e-01 1 1  ON 47
eH2_8                 1.833566e-01 1 1  ON 48
eH2_9                 5.861873e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8988
    reference variance = 0.237424
====================================================
  Execution time = 2.0953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3807e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338094697200
                                         uncertainty =       0.003028979900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338094697200
                                         uncertainty =       0.003028979900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411136201
  error estimate for blocks of size 2^( 2) =       0.000424053950
  error estimate for blocks of size 2^( 3) =       0.000436655701
  error estimate for blocks of size 2^( 4) =       0.000448249101
  error estimate for blocks of size 2^( 5) =       0.000458757652
  error estimate for blocks of size 2^( 6) =       0.000466644638
  error estimate for blocks of size 2^( 7) =       0.000469844089

      target function =                  N/A
              le_mean =     -16.906748098532
             les_mean =     286.176197048969
             stat err =       0.000460873870
             autocorr =       1.256587499729
              std dev =       0.581434390772
             le_variance =       0.338065950773


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690674809853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906748098532       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906748254292       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906748381985       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906748367301       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906748449067       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906748442379       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906748505598       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906748486987       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 8.925714e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906748098532       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906748138727       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906748170998       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906748167756       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906748189207       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906748186256       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906748201791       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906748197065       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.263009e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906748098532       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906748108663       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906748116750       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906748115970       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906748121403       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906748120584       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906748124442       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906748123256       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 5.678110e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6671e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.095999e-01 1 1  ON 0
 uu_1                 1.427864e-01 1 1  ON 1
 uu_2                 4.111936e-02 1 1  ON 2
 uu_3                -2.117542e-02 1 1  ON 3
 uu_4                -6.670896e-02 1 1  ON 4
 uu_5                -1.014399e-01 1 1  ON 5
 uu_6                -1.284308e-01 1 1  ON 6
 uu_7                -1.421619e-01 1 1  ON 7
 uu_8                -1.341745e-01 1 1  ON 8
 uu_9                -1.054305e-01 1 1  ON 9
 ud_0                 4.488846e-01 1 1  ON 10
 ud_1                 1.833509e-01 1 1  ON 11
 ud_2                 6.307377e-02 1 1  ON 12
 ud_3                -8.045255e-03 1 1  ON 13
 ud_4                -6.534722e-02 1 1  ON 14
 ud_5                -1.073098e-01 1 1  ON 15
 ud_6                -1.353670e-01 1 1  ON 16
 ud_7                -1.523410e-01 1 1  ON 17
 ud_8                -1.530223e-01 1 1  ON 18
 ud_9                -1.432337e-01 1 1  ON 19
 eO_0                -7.605616e-01 1 1  ON 20
 eO_1                -4.393285e-01 1 1  ON 21
 eO_2                -2.155168e-02 1 1  ON 22
 eO_3                 2.988852e-01 1 1  ON 23
 eO_4                 5.258059e-01 1 1  ON 24
 eO_5                 4.879350e-01 1 1  ON 25
 eO_6                 2.602556e-01 1 1  ON 26
 eO_7                -4.072085e-02 1 1  ON 27
 eO_8                -2.219853e-01 1 1  ON 28
 eO_9                -8.720219e-02 1 1  ON 29
eH1_0                -2.466701e-01 1 1  ON 30
eH1_1                -1.458898e-01 1 1  ON 31
eH1_2                -9.862235e-02 1 1  ON 32
eH1_3                -4.464932e-02 1 1  ON 33
eH1_4                 3.614529e-03 1 1  ON 34
eH1_5                 3.815662e-02 1 1  ON 35
eH1_6                 9.661906e-02 1 1  ON 36
eH1_7                 1.543117e-01 1 1  ON 37
eH1_8                 1.780548e-01 1 1  ON 38
eH1_9                 6.903412e-02 1 1  ON 39
eH2_0                -2.444998e-01 1 1  ON 40
eH2_1                -1.436922e-01 1 1  ON 41
eH2_2                -9.651336e-02 1 1  ON 42
eH2_3                -4.243452e-02 1 1  ON 43
eH2_4                 6.014846e-03 1 1  ON 44
eH2_5                 4.034544e-02 1 1  ON 45
eH2_6                 9.955729e-02 1 1  ON 46
eH2_7                 1.556680e-01 1 1  ON 47
eH2_8                 1.833600e-01 1 1  ON 48
eH2_9                 5.862950e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.851
    reference variance = 0.216132
====================================================
  Execution time = 2.0247e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4272e-01
  Total weights = 2.0000e+06
  Execution time = 1.8804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341459870308
                                         uncertainty =       0.004925851747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341459870308
                                         uncertainty =       0.004925851747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413951953
  error estimate for blocks of size 2^( 2) =       0.000427097961
  error estimate for blocks of size 2^( 3) =       0.000441064168
  error estimate for blocks of size 2^( 4) =       0.000453958158
  error estimate for blocks of size 2^( 5) =       0.000465338752
  error estimate for blocks of size 2^( 6) =       0.000474367713
  error estimate for blocks of size 2^( 7) =       0.000482604299

      target function =                  N/A
              le_mean =     -16.905989480731
             les_mean =     286.155192589334
             stat err =       0.000469067231
             autocorr =       1.284015649094
              std dev =       0.585416465517
             le_variance =       0.342712438099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341479950514
                                         uncertainty =       0.004925971075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341479950514
                                         uncertainty =       0.004925971075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413964056
  error estimate for blocks of size 2^( 2) =       0.000427108837
  error estimate for blocks of size 2^( 3) =       0.000441073850
  error estimate for blocks of size 2^( 4) =       0.000453966884
  error estimate for blocks of size 2^( 5) =       0.000465346691
  error estimate for blocks of size 2^( 6) =       0.000474376468
  error estimate for blocks of size 2^( 7) =       0.000482612759

      target function =                  N/A
              le_mean =     -16.905989603433
             les_mean =     286.155216779075
             stat err =       0.000469075701
             autocorr =       1.283986936716
              std dev =       0.585433582116
             le_variance =       0.342732479069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341470388074
                                         uncertainty =       0.004925916230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341470388074
                                         uncertainty =       0.004925916230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413958292
  error estimate for blocks of size 2^( 2) =       0.000427103660
  error estimate for blocks of size 2^( 3) =       0.000441069247
  error estimate for blocks of size 2^( 4) =       0.000453962745
  error estimate for blocks of size 2^( 5) =       0.000465342930
  error estimate for blocks of size 2^( 6) =       0.000474372322
  error estimate for blocks of size 2^( 7) =       0.000482608769

      target function =                  N/A
              le_mean =     -16.905989532133
             les_mean =     286.155204824734
             stat err =       0.000469071692
             autocorr =       1.284000742227
              std dev =       0.585425431220
             le_variance =       0.342722935519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341461199885
                                         uncertainty =       0.004925859996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341461199885
                                         uncertainty =       0.004925859996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413952754
  error estimate for blocks of size 2^( 2) =       0.000427098681
  error estimate for blocks of size 2^( 3) =       0.000441064810
  error estimate for blocks of size 2^( 4) =       0.000453958738
  error estimate for blocks of size 2^( 5) =       0.000465339280
  error estimate for blocks of size 2^( 6) =       0.000474368296
  error estimate for blocks of size 2^( 7) =       0.000482604865

      target function =                  N/A
              le_mean =     -16.905989486532
             les_mean =     286.155194112474
             stat err =       0.000469067795
             autocorr =       1.284013765829
              std dev =       0.585417598903
             le_variance =       0.342713765106


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905989480731        initial
     3.8147e+00     3.8147e+01             8.9257e-05       -16.905989603433  <--
     1.5259e+01     1.5259e+02             2.2630e-05       -16.905989532133
     6.1035e+01     6.1035e+02             5.6781e-06       -16.905989486532

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 2.9730e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.096105e-01 1 1  ON 0
 uu_1                 1.427838e-01 1 1  ON 1
 uu_2                 4.112888e-02 1 1  ON 2
 uu_3                -2.116940e-02 1 1  ON 3
 uu_4                -6.670713e-02 1 1  ON 4
 uu_5                -1.014290e-01 1 1  ON 5
 uu_6                -1.284646e-01 1 1  ON 6
 uu_7                -1.421837e-01 1 1  ON 7
 uu_8                -1.341875e-01 1 1  ON 8
 uu_9                -1.054324e-01 1 1  ON 9
 ud_0                 4.489246e-01 1 1  ON 10
 ud_1                 1.833713e-01 1 1  ON 11
 ud_2                 6.308854e-02 1 1  ON 12
 ud_3                -8.046015e-03 1 1  ON 13
 ud_4                -6.536391e-02 1 1  ON 14
 ud_5                -1.073127e-01 1 1  ON 15
 ud_6                -1.353572e-01 1 1  ON 16
 ud_7                -1.523594e-01 1 1  ON 17
 ud_8                -1.530456e-01 1 1  ON 18
 ud_9                -1.432531e-01 1 1  ON 19
 eO_0                -7.605436e-01 1 1  ON 20
 eO_1                -4.393172e-01 1 1  ON 21
 eO_2                -2.155611e-02 1 1  ON 22
 eO_3                 2.988705e-01 1 1  ON 23
 eO_4                 5.258092e-01 1 1  ON 24
 eO_5                 4.879555e-01 1 1  ON 25
 eO_6                 2.602739e-01 1 1  ON 26
 eO_7                -4.072291e-02 1 1  ON 27
 eO_8                -2.220088e-01 1 1  ON 28
 eO_9                -8.722559e-02 1 1  ON 29
eH1_0                -2.467246e-01 1 1  ON 30
eH1_1                -1.459109e-01 1 1  ON 31
eH1_2                -9.862633e-02 1 1  ON 32
eH1_3                -4.463100e-02 1 1  ON 33
eH1_4                 3.646505e-03 1 1  ON 34
eH1_5                 3.817568e-02 1 1  ON 35
eH1_6                 9.661029e-02 1 1  ON 36
eH1_7                 1.542961e-01 1 1  ON 37
eH1_8                 1.780637e-01 1 1  ON 38
eH1_9                 6.905905e-02 1 1  ON 39
eH2_0                -2.445664e-01 1 1  ON 40
eH2_1                -1.437053e-01 1 1  ON 41
eH2_2                -9.651543e-02 1 1  ON 42
eH2_3                -4.241483e-02 1 1  ON 43
eH2_4                 6.025964e-03 1 1  ON 44
eH2_5                 4.033538e-02 1 1  ON 45
eH2_6                 9.957438e-02 1 1  ON 46
eH2_7                 1.556660e-01 1 1  ON 47
eH2_8                 1.833698e-01 1 1  ON 48
eH2_9                 5.866134e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6470e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8076
    reference variance = 0.938769
====================================================
  Execution time = 2.1394e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3544e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335476858883
                                         uncertainty =       0.003825474231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335476858883
                                         uncertainty =       0.003825474231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409537807
  error estimate for blocks of size 2^( 2) =       0.000422174458
  error estimate for blocks of size 2^( 3) =       0.000435508777
  error estimate for blocks of size 2^( 4) =       0.000448526427
  error estimate for blocks of size 2^( 5) =       0.000460170958
  error estimate for blocks of size 2^( 6) =       0.000469465216
  error estimate for blocks of size 2^( 7) =       0.000476537385

      target function =                  N/A
              le_mean =     -16.905401557827
             les_mean =     286.128044094793
             stat err =       0.000463674997
             autocorr =       1.281856333675
              std dev =       0.579173921320
             le_variance =       0.335442431137


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540155783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905401557827       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905402454093       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905402628055       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905402429691       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905403059226       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905403263773       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905403047848       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905403345390       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905403381549       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.650368e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905401557827       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905401812920       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905401872804       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905401806243       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905401967563       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905402023962       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905401966593       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905402013304       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905402030649       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 9.369377e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905401557827       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905401623887       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905401640171       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905401622549       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905401662627       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905401676733       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905401662814       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905401671632       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.336654e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7005e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.096414e-01 1 1  ON 0
 uu_1                 1.427810e-01 1 1  ON 1
 uu_2                 4.113339e-02 1 1  ON 2
 uu_3                -2.119876e-02 1 1  ON 3
 uu_4                -6.672837e-02 1 1  ON 4
 uu_5                -1.014468e-01 1 1  ON 5
 uu_6                -1.284977e-01 1 1  ON 6
 uu_7                -1.422028e-01 1 1  ON 7
 uu_8                -1.341693e-01 1 1  ON 8
 uu_9                -1.054199e-01 1 1  ON 9
 ud_0                 4.490013e-01 1 1  ON 10
 ud_1                 1.833708e-01 1 1  ON 11
 ud_2                 6.307572e-02 1 1  ON 12
 ud_3                -8.063808e-03 1 1  ON 13
 ud_4                -6.540473e-02 1 1  ON 14
 ud_5                -1.073314e-01 1 1  ON 15
 ud_6                -1.353494e-01 1 1  ON 16
 ud_7                -1.523448e-01 1 1  ON 17
 ud_8                -1.530352e-01 1 1  ON 18
 ud_9                -1.432533e-01 1 1  ON 19
 eO_0                -7.605237e-01 1 1  ON 20
 eO_1                -4.393177e-01 1 1  ON 21
 eO_2                -2.155414e-02 1 1  ON 22
 eO_3                 2.988525e-01 1 1  ON 23
 eO_4                 5.258268e-01 1 1  ON 24
 eO_5                 4.879511e-01 1 1  ON 25
 eO_6                 2.602919e-01 1 1  ON 26
 eO_7                -4.070498e-02 1 1  ON 27
 eO_8                -2.220228e-01 1 1  ON 28
 eO_9                -8.725663e-02 1 1  ON 29
eH1_0                -2.468183e-01 1 1  ON 30
eH1_1                -1.459551e-01 1 1  ON 31
eH1_2                -9.864420e-02 1 1  ON 32
eH1_3                -4.462008e-02 1 1  ON 33
eH1_4                 3.679600e-03 1 1  ON 34
eH1_5                 3.817385e-02 1 1  ON 35
eH1_6                 9.663216e-02 1 1  ON 36
eH1_7                 1.543075e-01 1 1  ON 37
eH1_8                 1.780896e-01 1 1  ON 38
eH1_9                 6.910169e-02 1 1  ON 39
eH2_0                -2.446264e-01 1 1  ON 40
eH2_1                -1.437540e-01 1 1  ON 41
eH2_2                -9.653287e-02 1 1  ON 42
eH2_3                -4.239080e-02 1 1  ON 43
eH2_4                 6.045251e-03 1 1  ON 44
eH2_5                 4.035147e-02 1 1  ON 45
eH2_6                 9.954725e-02 1 1  ON 46
eH2_7                 1.556658e-01 1 1  ON 47
eH2_8                 1.834052e-01 1 1  ON 48
eH2_9                 5.871412e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8952
    reference variance = 0.154664
====================================================
  Execution time = 2.0406e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3589e-01
  Total weights = 2.0000e+06
  Execution time = 1.8707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335818650926
                                         uncertainty =       0.003065802546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335818650926
                                         uncertainty =       0.003065802546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409765639
  error estimate for blocks of size 2^( 2) =       0.000422696356
  error estimate for blocks of size 2^( 3) =       0.000435847989
  error estimate for blocks of size 2^( 4) =       0.000448333640
  error estimate for blocks of size 2^( 5) =       0.000460387749
  error estimate for blocks of size 2^( 6) =       0.000469322990
  error estimate for blocks of size 2^( 7) =       0.000474732167

      target function =                  N/A
              le_mean =     -16.905912868505
             les_mean =     286.145705508007
             stat err =       0.000463194137
             autocorr =       1.277776893339
              std dev =       0.579496124613
             le_variance =       0.335815758442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336060853394
                                         uncertainty =       0.003067586075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336060853394
                                         uncertainty =       0.003067586075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409913384
  error estimate for blocks of size 2^( 2) =       0.000422834530
  error estimate for blocks of size 2^( 3) =       0.000435975260
  error estimate for blocks of size 2^( 4) =       0.000448453845
  error estimate for blocks of size 2^( 5) =       0.000460502974
  error estimate for blocks of size 2^( 6) =       0.000469436929
  error estimate for blocks of size 2^( 7) =       0.000474844935

      target function =                  N/A
              le_mean =     -16.905912720539
             les_mean =     286.145942711497
             stat err =       0.000463309671
             autocorr =       1.277493013279
              std dev =       0.579705067281
             le_variance =       0.336057965031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335973442188
                                         uncertainty =       0.003066955413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335973442188
                                         uncertainty =       0.003066955413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409860065
  error estimate for blocks of size 2^( 2) =       0.000422784748
  error estimate for blocks of size 2^( 3) =       0.000435929656
  error estimate for blocks of size 2^( 4) =       0.000448410791
  error estimate for blocks of size 2^( 5) =       0.000460461806
  error estimate for blocks of size 2^( 6) =       0.000469396057
  error estimate for blocks of size 2^( 7) =       0.000474804302

      target function =                  N/A
              le_mean =     -16.905912691856
             les_mean =     286.145854322796
             stat err =       0.000463268239
             autocorr =       1.277596881856
              std dev =       0.579629662896
             le_variance =       0.335970546108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335839482194
                                         uncertainty =       0.003065958936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335839482194
                                         uncertainty =       0.003065958936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409778348
  error estimate for blocks of size 2^( 2) =       0.000422708252
  error estimate for blocks of size 2^( 3) =       0.000435858987
  error estimate for blocks of size 2^( 4) =       0.000448344027
  error estimate for blocks of size 2^( 5) =       0.000460397729
  error estimate for blocks of size 2^( 6) =       0.000469332824
  error estimate for blocks of size 2^( 7) =       0.000474741868

      target function =                  N/A
              le_mean =     -16.905912834519
             les_mean =     286.145725189787
             stat err =       0.000463204112
             autocorr =       1.277752669691
              std dev =       0.579514097639
             le_variance =       0.335836589362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905912868505        initial  <--
     9.5367e-01     9.5367e+00             3.6504e-04       -16.905912720539
     3.8147e+00     3.8147e+01             9.3694e-05       -16.905912691856
     1.5259e+01     1.5259e+02             2.3367e-05       -16.905912834519

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8537
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.096105e-01 1 1  ON 0
 uu_1                 1.427838e-01 1 1  ON 1
 uu_2                 4.112888e-02 1 1  ON 2
 uu_3                -2.116940e-02 1 1  ON 3
 uu_4                -6.670713e-02 1 1  ON 4
 uu_5                -1.014290e-01 1 1  ON 5
 uu_6                -1.284646e-01 1 1  ON 6
 uu_7                -1.421837e-01 1 1  ON 7
 uu_8                -1.341875e-01 1 1  ON 8
 uu_9                -1.054324e-01 1 1  ON 9
 ud_0                 4.489246e-01 1 1  ON 10
 ud_1                 1.833713e-01 1 1  ON 11
 ud_2                 6.308854e-02 1 1  ON 12
 ud_3                -8.046015e-03 1 1  ON 13
 ud_4                -6.536391e-02 1 1  ON 14
 ud_5                -1.073127e-01 1 1  ON 15
 ud_6                -1.353572e-01 1 1  ON 16
 ud_7                -1.523594e-01 1 1  ON 17
 ud_8                -1.530456e-01 1 1  ON 18
 ud_9                -1.432531e-01 1 1  ON 19
 eO_0                -7.605436e-01 1 1  ON 20
 eO_1                -4.393172e-01 1 1  ON 21
 eO_2                -2.155611e-02 1 1  ON 22
 eO_3                 2.988705e-01 1 1  ON 23
 eO_4                 5.258092e-01 1 1  ON 24
 eO_5                 4.879555e-01 1 1  ON 25
 eO_6                 2.602739e-01 1 1  ON 26
 eO_7                -4.072291e-02 1 1  ON 27
 eO_8                -2.220088e-01 1 1  ON 28
 eO_9                -8.722559e-02 1 1  ON 29
eH1_0                -2.467246e-01 1 1  ON 30
eH1_1                -1.459109e-01 1 1  ON 31
eH1_2                -9.862633e-02 1 1  ON 32
eH1_3                -4.463100e-02 1 1  ON 33
eH1_4                 3.646505e-03 1 1  ON 34
eH1_5                 3.817568e-02 1 1  ON 35
eH1_6                 9.661029e-02 1 1  ON 36
eH1_7                 1.542961e-01 1 1  ON 37
eH1_8                 1.780637e-01 1 1  ON 38
eH1_9                 6.905905e-02 1 1  ON 39
eH2_0                -2.445664e-01 1 1  ON 40
eH2_1                -1.437053e-01 1 1  ON 41
eH2_2                -9.651543e-02 1 1  ON 42
eH2_3                -4.241483e-02 1 1  ON 43
eH2_4                 6.025964e-03 1 1  ON 44
eH2_5                 4.033538e-02 1 1  ON 45
eH2_6                 9.957438e-02 1 1  ON 46
eH2_7                 1.556660e-01 1 1  ON 47
eH2_8                 1.833698e-01 1 1  ON 48
eH2_9                 5.866134e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6899e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9344
    reference variance = 0.402001
====================================================
  Execution time = 2.0829e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2962e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329591231893
                                         uncertainty =       0.002554567823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329591231893
                                         uncertainty =       0.002554567823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405971145
  error estimate for blocks of size 2^( 2) =       0.000418508895
  error estimate for blocks of size 2^( 3) =       0.000431105835
  error estimate for blocks of size 2^( 4) =       0.000443231962
  error estimate for blocks of size 2^( 5) =       0.000453760233
  error estimate for blocks of size 2^( 6) =       0.000461300773
  error estimate for blocks of size 2^( 7) =       0.000467632265

      target function =                  N/A
              le_mean =     -16.906070897143
             les_mean =     286.144858155533
             stat err =       0.000456481308
             autocorr =       1.264316091121
              std dev =       0.574129899166
             le_variance =       0.329625141117


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607089714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906070897143       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906071029347       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906071116211       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906071120786       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906071065337       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906071076639       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906071135921       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906071144698       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906071140364       residual = 8.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 3.864890e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906070897143       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906070930599       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906070952796       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906070954026       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906070939654       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906070942229       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906070957238       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906070959558       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 9.904873e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906070897143       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906070905533       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906070911113       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906070911426       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906070907801       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906070908428       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906070912192       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906070912780       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.488628e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170083 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8351e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.096123e-01 1 1  ON 0
 uu_1                 1.427827e-01 1 1  ON 1
 uu_2                 4.113359e-02 1 1  ON 2
 uu_3                -2.117003e-02 1 1  ON 3
 uu_4                -6.670576e-02 1 1  ON 4
 uu_5                -1.014287e-01 1 1  ON 5
 uu_6                -1.284672e-01 1 1  ON 6
 uu_7                -1.421863e-01 1 1  ON 7
 uu_8                -1.341904e-01 1 1  ON 8
 uu_9                -1.054339e-01 1 1  ON 9
 ud_0                 4.489345e-01 1 1  ON 10
 ud_1                 1.833736e-01 1 1  ON 11
 ud_2                 6.308852e-02 1 1  ON 12
 ud_3                -8.047297e-03 1 1  ON 13
 ud_4                -6.536784e-02 1 1  ON 14
 ud_5                -1.073125e-01 1 1  ON 15
 ud_6                -1.353583e-01 1 1  ON 16
 ud_7                -1.523631e-01 1 1  ON 17
 ud_8                -1.530482e-01 1 1  ON 18
 ud_9                -1.432529e-01 1 1  ON 19
 eO_0                -7.605434e-01 1 1  ON 20
 eO_1                -4.393177e-01 1 1  ON 21
 eO_2                -2.155269e-02 1 1  ON 22
 eO_3                 2.988710e-01 1 1  ON 23
 eO_4                 5.258097e-01 1 1  ON 24
 eO_5                 4.879590e-01 1 1  ON 25
 eO_6                 2.602748e-01 1 1  ON 26
 eO_7                -4.072476e-02 1 1  ON 27
 eO_8                -2.220120e-01 1 1  ON 28
 eO_9                -8.722841e-02 1 1  ON 29
eH1_0                -2.467315e-01 1 1  ON 30
eH1_1                -1.459152e-01 1 1  ON 31
eH1_2                -9.862467e-02 1 1  ON 32
eH1_3                -4.462967e-02 1 1  ON 33
eH1_4                 3.650799e-03 1 1  ON 34
eH1_5                 3.817301e-02 1 1  ON 35
eH1_6                 9.661070e-02 1 1  ON 36
eH1_7                 1.542963e-01 1 1  ON 37
eH1_8                 1.780658e-01 1 1  ON 38
eH1_9                 6.906250e-02 1 1  ON 39
eH2_0                -2.445715e-01 1 1  ON 40
eH2_1                -1.437115e-01 1 1  ON 41
eH2_2                -9.651566e-02 1 1  ON 42
eH2_3                -4.241326e-02 1 1  ON 43
eH2_4                 6.027364e-03 1 1  ON 44
eH2_5                 4.033428e-02 1 1  ON 45
eH2_6                 9.957440e-02 1 1  ON 46
eH2_7                 1.556670e-01 1 1  ON 47
eH2_8                 1.833720e-01 1 1  ON 48
eH2_9                 5.866672e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8978
    reference variance = 0.408238
====================================================
  Execution time = 2.1066e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3254e-01
  Total weights = 2.0000e+06
  Execution time = 1.8713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332478683354
                                         uncertainty =       0.002833871306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332478683354
                                         uncertainty =       0.002833871306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407760299
  error estimate for blocks of size 2^( 2) =       0.000420563421
  error estimate for blocks of size 2^( 3) =       0.000433715440
  error estimate for blocks of size 2^( 4) =       0.000445241668
  error estimate for blocks of size 2^( 5) =       0.000455369667
  error estimate for blocks of size 2^( 6) =       0.000460764760
  error estimate for blocks of size 2^( 7) =       0.000466464028

      target function =                  N/A
              le_mean =     -16.905953069851
             les_mean =     286.143785956412
             stat err =       0.000456960031
             autocorr =       1.255875395384
              std dev =       0.576660144863
             le_variance =       0.332536922673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332500798663
                                         uncertainty =       0.002833969621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332500798663
                                         uncertainty =       0.002833969621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407773857
  error estimate for blocks of size 2^( 2) =       0.000420575839
  error estimate for blocks of size 2^( 3) =       0.000433726683
  error estimate for blocks of size 2^( 4) =       0.000445252327
  error estimate for blocks of size 2^( 5) =       0.000455379983
  error estimate for blocks of size 2^( 6) =       0.000460775274
  error estimate for blocks of size 2^( 7) =       0.000466474711

      target function =                  N/A
              le_mean =     -16.905953032442
             les_mean =     286.143806805549
             stat err =       0.000456970574
             autocorr =       1.255849832765
              std dev =       0.576679318776
             le_variance =       0.332559036704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332489816043
                                         uncertainty =       0.002833918683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332489816043
                                         uncertainty =       0.002833918683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407767124
  error estimate for blocks of size 2^( 2) =       0.000420569670
  error estimate for blocks of size 2^( 3) =       0.000433721099
  error estimate for blocks of size 2^( 4) =       0.000445247033
  error estimate for blocks of size 2^( 5) =       0.000455374857
  error estimate for blocks of size 2^( 6) =       0.000460770064
  error estimate for blocks of size 2^( 7) =       0.000466469411

      target function =                  N/A
              le_mean =     -16.905953049753
             les_mean =     286.143796408667
             stat err =       0.000456965341
             autocorr =       1.255862545252
              std dev =       0.576669796740
             le_variance =       0.332548054472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332480081835
                                         uncertainty =       0.002833877218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332480081835
                                         uncertainty =       0.002833877218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407761156
  error estimate for blocks of size 2^( 2) =       0.000420564206
  error estimate for blocks of size 2^( 3) =       0.000433716150
  error estimate for blocks of size 2^( 4) =       0.000445242342
  error estimate for blocks of size 2^( 5) =       0.000455370319
  error estimate for blocks of size 2^( 6) =       0.000460765426
  error estimate for blocks of size 2^( 7) =       0.000466464704

      target function =                  N/A
              le_mean =     -16.905953067244
             les_mean =     286.143787266620
             stat err =       0.000456960698
             autocorr =       1.255873779939
              std dev =       0.576661357334
             le_variance =       0.332538321043


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905953069851        initial  <--
     9.5367e+00     9.5367e+01             3.8649e-05       -16.905953032442
     3.8147e+01     3.8147e+02             9.9049e-06       -16.905953049753
     1.5259e+02     1.5259e+03             2.4886e-06       -16.905953067244

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5015
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.096105e-01 1 1  ON 0
 uu_1                 1.427838e-01 1 1  ON 1
 uu_2                 4.112888e-02 1 1  ON 2
 uu_3                -2.116940e-02 1 1  ON 3
 uu_4                -6.670713e-02 1 1  ON 4
 uu_5                -1.014290e-01 1 1  ON 5
 uu_6                -1.284646e-01 1 1  ON 6
 uu_7                -1.421837e-01 1 1  ON 7
 uu_8                -1.341875e-01 1 1  ON 8
 uu_9                -1.054324e-01 1 1  ON 9
 ud_0                 4.489246e-01 1 1  ON 10
 ud_1                 1.833713e-01 1 1  ON 11
 ud_2                 6.308854e-02 1 1  ON 12
 ud_3                -8.046015e-03 1 1  ON 13
 ud_4                -6.536391e-02 1 1  ON 14
 ud_5                -1.073127e-01 1 1  ON 15
 ud_6                -1.353572e-01 1 1  ON 16
 ud_7                -1.523594e-01 1 1  ON 17
 ud_8                -1.530456e-01 1 1  ON 18
 ud_9                -1.432531e-01 1 1  ON 19
 eO_0                -7.605436e-01 1 1  ON 20
 eO_1                -4.393172e-01 1 1  ON 21
 eO_2                -2.155611e-02 1 1  ON 22
 eO_3                 2.988705e-01 1 1  ON 23
 eO_4                 5.258092e-01 1 1  ON 24
 eO_5                 4.879555e-01 1 1  ON 25
 eO_6                 2.602739e-01 1 1  ON 26
 eO_7                -4.072291e-02 1 1  ON 27
 eO_8                -2.220088e-01 1 1  ON 28
 eO_9                -8.722559e-02 1 1  ON 29
eH1_0                -2.467246e-01 1 1  ON 30
eH1_1                -1.459109e-01 1 1  ON 31
eH1_2                -9.862633e-02 1 1  ON 32
eH1_3                -4.463100e-02 1 1  ON 33
eH1_4                 3.646505e-03 1 1  ON 34
eH1_5                 3.817568e-02 1 1  ON 35
eH1_6                 9.661029e-02 1 1  ON 36
eH1_7                 1.542961e-01 1 1  ON 37
eH1_8                 1.780637e-01 1 1  ON 38
eH1_9                 6.905905e-02 1 1  ON 39
eH2_0                -2.445664e-01 1 1  ON 40
eH2_1                -1.437053e-01 1 1  ON 41
eH2_2                -9.651543e-02 1 1  ON 42
eH2_3                -4.241483e-02 1 1  ON 43
eH2_4                 6.025964e-03 1 1  ON 44
eH2_5                 4.033538e-02 1 1  ON 45
eH2_6                 9.957438e-02 1 1  ON 46
eH2_7                 1.556660e-01 1 1  ON 47
eH2_8                 1.833698e-01 1 1  ON 48
eH2_9                 5.866134e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8873e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8189
    reference variance = 0.201865
====================================================
  Execution time = 2.1025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3609e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336103660988
                                         uncertainty =       0.003470114455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336103660988
                                         uncertainty =       0.003470114455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409932229
  error estimate for blocks of size 2^( 2) =       0.000422567202
  error estimate for blocks of size 2^( 3) =       0.000435290719
  error estimate for blocks of size 2^( 4) =       0.000447642255
  error estimate for blocks of size 2^( 5) =       0.000459054585
  error estimate for blocks of size 2^( 6) =       0.000466042305
  error estimate for blocks of size 2^( 7) =       0.000471477471

      target function =                  N/A
              le_mean =     -16.905715878674
             les_mean =     286.139318066878
             stat err =       0.000461054154
             autocorr =       1.264968617571
              std dev =       0.579731717681
             le_variance =       0.336088864485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690571587867e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905715878674       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905715883153       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905715887250       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905715891416       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905715893479       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905715895120       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905715897372       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905715897025       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 3.983287e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905715878674       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905715879795       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905715880820       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905715881862       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905715882379       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905715882790       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905715883352       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905715883265       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 9.963639e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905715878674       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905715878954       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905715879210       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905715879470       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905715879600       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905715879702       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905715879853       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905715879821       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.491249e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172714 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6670e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427839e-01 1 1  ON 1
 uu_2                 4.112900e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670725e-02 1 1  ON 4
 uu_5                -1.014290e-01 1 1  ON 5
 uu_6                -1.284648e-01 1 1  ON 6
 uu_7                -1.421841e-01 1 1  ON 7
 uu_8                -1.341876e-01 1 1  ON 8
 uu_9                -1.054324e-01 1 1  ON 9
 ud_0                 4.489248e-01 1 1  ON 10
 ud_1                 1.833714e-01 1 1  ON 11
 ud_2                 6.308835e-02 1 1  ON 12
 ud_3                -8.046173e-03 1 1  ON 13
 ud_4                -6.536402e-02 1 1  ON 14
 ud_5                -1.073131e-01 1 1  ON 15
 ud_6                -1.353569e-01 1 1  ON 16
 ud_7                -1.523595e-01 1 1  ON 17
 ud_8                -1.530454e-01 1 1  ON 18
 ud_9                -1.432529e-01 1 1  ON 19
 eO_0                -7.605437e-01 1 1  ON 20
 eO_1                -4.393172e-01 1 1  ON 21
 eO_2                -2.155571e-02 1 1  ON 22
 eO_3                 2.988703e-01 1 1  ON 23
 eO_4                 5.258094e-01 1 1  ON 24
 eO_5                 4.879557e-01 1 1  ON 25
 eO_6                 2.602740e-01 1 1  ON 26
 eO_7                -4.072286e-02 1 1  ON 27
 eO_8                -2.220089e-01 1 1  ON 28
 eO_9                -8.722587e-02 1 1  ON 29
eH1_0                -2.467253e-01 1 1  ON 30
eH1_1                -1.459113e-01 1 1  ON 31
eH1_2                -9.862670e-02 1 1  ON 32
eH1_3                -4.463099e-02 1 1  ON 33
eH1_4                 3.646784e-03 1 1  ON 34
eH1_5                 3.817574e-02 1 1  ON 35
eH1_6                 9.661058e-02 1 1  ON 36
eH1_7                 1.542961e-01 1 1  ON 37
eH1_8                 1.780641e-01 1 1  ON 38
eH1_9                 6.905949e-02 1 1  ON 39
eH2_0                -2.445674e-01 1 1  ON 40
eH2_1                -1.437054e-01 1 1  ON 41
eH2_2                -9.651527e-02 1 1  ON 42
eH2_3                -4.241460e-02 1 1  ON 43
eH2_4                 6.026012e-03 1 1  ON 44
eH2_5                 4.033541e-02 1 1  ON 45
eH2_6                 9.957424e-02 1 1  ON 46
eH2_7                 1.556658e-01 1 1  ON 47
eH2_8                 1.833702e-01 1 1  ON 48
eH2_9                 5.866187e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9419
    reference variance = 0.233683
====================================================
  Execution time = 2.0504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3963e-01
  Total weights = 2.0000e+06
  Execution time = 1.8712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339540156385
                                         uncertainty =       0.005123807950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339540156385
                                         uncertainty =       0.005123807950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412085970
  error estimate for blocks of size 2^( 2) =       0.000424982693
  error estimate for blocks of size 2^( 3) =       0.000438397046
  error estimate for blocks of size 2^( 4) =       0.000451447727
  error estimate for blocks of size 2^( 5) =       0.000462757584
  error estimate for blocks of size 2^( 6) =       0.000472864348
  error estimate for blocks of size 2^( 7) =       0.000477769632

      target function =                  N/A
              le_mean =     -16.905987683487
             les_mean =     286.152049078287
             stat err =       0.000466209823
             autocorr =       1.279932836473
              std dev =       0.582777568110
             le_variance =       0.339629693892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339541019704
                                         uncertainty =       0.005123802021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339541019704
                                         uncertainty =       0.005123802021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412086495
  error estimate for blocks of size 2^( 2) =       0.000424983157
  error estimate for blocks of size 2^( 3) =       0.000438397458
  error estimate for blocks of size 2^( 4) =       0.000451448099
  error estimate for blocks of size 2^( 5) =       0.000462757943
  error estimate for blocks of size 2^( 6) =       0.000472864697
  error estimate for blocks of size 2^( 7) =       0.000477769950

      target function =                  N/A
              le_mean =     -16.905987670641
             les_mean =     286.152049508639
             stat err =       0.000466210172
             autocorr =       1.279931496335
              std dev =       0.582778309975
             le_variance =       0.339630558577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339540588202
                                         uncertainty =       0.005123804966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339540588202
                                         uncertainty =       0.005123804966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412086233
  error estimate for blocks of size 2^( 2) =       0.000424982925
  error estimate for blocks of size 2^( 3) =       0.000438397252
  error estimate for blocks of size 2^( 4) =       0.000451447913
  error estimate for blocks of size 2^( 5) =       0.000462757763
  error estimate for blocks of size 2^( 6) =       0.000472864522
  error estimate for blocks of size 2^( 7) =       0.000477769791

      target function =                  N/A
              le_mean =     -16.905987677049
             les_mean =     286.152049293125
             stat err =       0.000466209997
             autocorr =       1.279932165576
              std dev =       0.582777939179
             le_variance =       0.339630126394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339540210366
                                         uncertainty =       0.005123807576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339540210366
                                         uncertainty =       0.005123807576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412086003
  error estimate for blocks of size 2^( 2) =       0.000424982722
  error estimate for blocks of size 2^( 3) =       0.000438397072
  error estimate for blocks of size 2^( 4) =       0.000451447750
  error estimate for blocks of size 2^( 5) =       0.000462757606
  error estimate for blocks of size 2^( 6) =       0.000472864370
  error estimate for blocks of size 2^( 7) =       0.000477769652

      target function =                  N/A
              le_mean =     -16.905987682681
             les_mean =     286.152049105119
             stat err =       0.000466209844
             autocorr =       1.279932752582
              std dev =       0.582777614497
             le_variance =       0.339629747958


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905987683487        initial  <--
     9.5367e+01     9.5367e+02             3.9833e-06       -16.905987670641
     3.8147e+02     3.8147e+03             9.9636e-07       -16.905987677049
     1.5259e+03     1.5259e+04             2.4912e-07       -16.905987682681

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9615
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.096105e-01 1 1  ON 0
 uu_1                 1.427838e-01 1 1  ON 1
 uu_2                 4.112888e-02 1 1  ON 2
 uu_3                -2.116940e-02 1 1  ON 3
 uu_4                -6.670713e-02 1 1  ON 4
 uu_5                -1.014290e-01 1 1  ON 5
 uu_6                -1.284646e-01 1 1  ON 6
 uu_7                -1.421837e-01 1 1  ON 7
 uu_8                -1.341875e-01 1 1  ON 8
 uu_9                -1.054324e-01 1 1  ON 9
 ud_0                 4.489246e-01 1 1  ON 10
 ud_1                 1.833713e-01 1 1  ON 11
 ud_2                 6.308854e-02 1 1  ON 12
 ud_3                -8.046015e-03 1 1  ON 13
 ud_4                -6.536391e-02 1 1  ON 14
 ud_5                -1.073127e-01 1 1  ON 15
 ud_6                -1.353572e-01 1 1  ON 16
 ud_7                -1.523594e-01 1 1  ON 17
 ud_8                -1.530456e-01 1 1  ON 18
 ud_9                -1.432531e-01 1 1  ON 19
 eO_0                -7.605436e-01 1 1  ON 20
 eO_1                -4.393172e-01 1 1  ON 21
 eO_2                -2.155611e-02 1 1  ON 22
 eO_3                 2.988705e-01 1 1  ON 23
 eO_4                 5.258092e-01 1 1  ON 24
 eO_5                 4.879555e-01 1 1  ON 25
 eO_6                 2.602739e-01 1 1  ON 26
 eO_7                -4.072291e-02 1 1  ON 27
 eO_8                -2.220088e-01 1 1  ON 28
 eO_9                -8.722559e-02 1 1  ON 29
eH1_0                -2.467246e-01 1 1  ON 30
eH1_1                -1.459109e-01 1 1  ON 31
eH1_2                -9.862633e-02 1 1  ON 32
eH1_3                -4.463100e-02 1 1  ON 33
eH1_4                 3.646505e-03 1 1  ON 34
eH1_5                 3.817568e-02 1 1  ON 35
eH1_6                 9.661029e-02 1 1  ON 36
eH1_7                 1.542961e-01 1 1  ON 37
eH1_8                 1.780637e-01 1 1  ON 38
eH1_9                 6.905905e-02 1 1  ON 39
eH2_0                -2.445664e-01 1 1  ON 40
eH2_1                -1.437053e-01 1 1  ON 41
eH2_2                -9.651543e-02 1 1  ON 42
eH2_3                -4.241483e-02 1 1  ON 43
eH2_4                 6.025964e-03 1 1  ON 44
eH2_5                 4.033538e-02 1 1  ON 45
eH2_6                 9.957438e-02 1 1  ON 46
eH2_7                 1.556660e-01 1 1  ON 47
eH2_8                 1.833698e-01 1 1  ON 48
eH2_9                 5.866134e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6642e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9078
    reference variance = 0.278754
====================================================
  Execution time = 2.0901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3798e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337986928378
                                         uncertainty =       0.003962068828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337986928378
                                         uncertainty =       0.003962068828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411081414
  error estimate for blocks of size 2^( 2) =       0.000423480286
  error estimate for blocks of size 2^( 3) =       0.000436426168
  error estimate for blocks of size 2^( 4) =       0.000448444929
  error estimate for blocks of size 2^( 5) =       0.000458929892
  error estimate for blocks of size 2^( 6) =       0.000465706073
  error estimate for blocks of size 2^( 7) =       0.000471452632

      target function =                  N/A
              le_mean =     -16.905838501265
             les_mean =     286.145351118950
             stat err =       0.000461133382
             autocorr =       1.258338376806
              std dev =       0.581356910242
             le_variance =       0.337975857086


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690583850126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905838501265       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905838501987       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905838501369       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905838501002       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905838501748       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905838501959       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905838501910       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905838501953       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.816878e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905838501265       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905838501445       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905838501291       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905838501197       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905838501386       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905838501439       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905838501425       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905838501439       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 7.043562e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905838501265       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905838501310       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905838501271       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905838501248       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905838501296       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905838501323       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905838501310       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905838501311       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.760976e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6431e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.096105e-01 1 1  ON 0
 uu_1                 1.427838e-01 1 1  ON 1
 uu_2                 4.112889e-02 1 1  ON 2
 uu_3                -2.116940e-02 1 1  ON 3
 uu_4                -6.670715e-02 1 1  ON 4
 uu_5                -1.014290e-01 1 1  ON 5
 uu_6                -1.284646e-01 1 1  ON 6
 uu_7                -1.421837e-01 1 1  ON 7
 uu_8                -1.341875e-01 1 1  ON 8
 uu_9                -1.054324e-01 1 1  ON 9
 ud_0                 4.489247e-01 1 1  ON 10
 ud_1                 1.833713e-01 1 1  ON 11
 ud_2                 6.308853e-02 1 1  ON 12
 ud_3                -8.046015e-03 1 1  ON 13
 ud_4                -6.536393e-02 1 1  ON 14
 ud_5                -1.073127e-01 1 1  ON 15
 ud_6                -1.353573e-01 1 1  ON 16
 ud_7                -1.523594e-01 1 1  ON 17
 ud_8                -1.530456e-01 1 1  ON 18
 ud_9                -1.432531e-01 1 1  ON 19
 eO_0                -7.605436e-01 1 1  ON 20
 eO_1                -4.393172e-01 1 1  ON 21
 eO_2                -2.155608e-02 1 1  ON 22
 eO_3                 2.988705e-01 1 1  ON 23
 eO_4                 5.258091e-01 1 1  ON 24
 eO_5                 4.879555e-01 1 1  ON 25
 eO_6                 2.602739e-01 1 1  ON 26
 eO_7                -4.072290e-02 1 1  ON 27
 eO_8                -2.220088e-01 1 1  ON 28
 eO_9                -8.722562e-02 1 1  ON 29
eH1_0                -2.467246e-01 1 1  ON 30
eH1_1                -1.459110e-01 1 1  ON 31
eH1_2                -9.862632e-02 1 1  ON 32
eH1_3                -4.463100e-02 1 1  ON 33
eH1_4                 3.646527e-03 1 1  ON 34
eH1_5                 3.817567e-02 1 1  ON 35
eH1_6                 9.661028e-02 1 1  ON 36
eH1_7                 1.542961e-01 1 1  ON 37
eH1_8                 1.780637e-01 1 1  ON 38
eH1_9                 6.905909e-02 1 1  ON 39
eH2_0                -2.445664e-01 1 1  ON 40
eH2_1                -1.437054e-01 1 1  ON 41
eH2_2                -9.651541e-02 1 1  ON 42
eH2_3                -4.241486e-02 1 1  ON 43
eH2_4                 6.025960e-03 1 1  ON 44
eH2_5                 4.033538e-02 1 1  ON 45
eH2_6                 9.957437e-02 1 1  ON 46
eH2_7                 1.556660e-01 1 1  ON 47
eH2_8                 1.833699e-01 1 1  ON 48
eH2_9                 5.866140e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9176
    reference variance = 0.194821
====================================================
  Execution time = 2.0202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2769e-01
  Total weights = 2.0000e+06
  Execution time = 1.8795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327734033768
                                         uncertainty =       0.002139180464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327734033768
                                         uncertainty =       0.002139180464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404779633
  error estimate for blocks of size 2^( 2) =       0.000417503114
  error estimate for blocks of size 2^( 3) =       0.000430133662
  error estimate for blocks of size 2^( 4) =       0.000442272116
  error estimate for blocks of size 2^( 5) =       0.000452920998
  error estimate for blocks of size 2^( 6) =       0.000458822045
  error estimate for blocks of size 2^( 7) =       0.000463438930

      target function =                  N/A
              le_mean =     -16.905750523669
             les_mean =     286.132093707504
             stat err =       0.000454363522
             autocorr =       1.259997287926
              std dev =       0.572444846962
             le_variance =       0.327693102813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327734220825
                                         uncertainty =       0.002139181727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327734220825
                                         uncertainty =       0.002139181727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404779749
  error estimate for blocks of size 2^( 2) =       0.000417503221
  error estimate for blocks of size 2^( 3) =       0.000430133760
  error estimate for blocks of size 2^( 4) =       0.000442272208
  error estimate for blocks of size 2^( 5) =       0.000452921090
  error estimate for blocks of size 2^( 6) =       0.000458822137
  error estimate for blocks of size 2^( 7) =       0.000463439020

      target function =                  N/A
              le_mean =     -16.905750524168
             les_mean =     286.132093911384
             stat err =       0.000454363614
             autocorr =       1.259997075875
              std dev =       0.572445010293
             le_variance =       0.327693289810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327734127322
                                         uncertainty =       0.002139181096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327734127322
                                         uncertainty =       0.002139181096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404779691
  error estimate for blocks of size 2^( 2) =       0.000417503167
  error estimate for blocks of size 2^( 3) =       0.000430133711
  error estimate for blocks of size 2^( 4) =       0.000442272162
  error estimate for blocks of size 2^( 5) =       0.000452921044
  error estimate for blocks of size 2^( 6) =       0.000458822091
  error estimate for blocks of size 2^( 7) =       0.000463438975

      target function =                  N/A
              le_mean =     -16.905750523919
             les_mean =     286.132093809469
             stat err =       0.000454363568
             autocorr =       1.259997181867
              std dev =       0.572444928650
             le_variance =       0.327693196337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327734045463
                                         uncertainty =       0.002139180543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327734045463
                                         uncertainty =       0.002139180543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404779640
  error estimate for blocks of size 2^( 2) =       0.000417503121
  error estimate for blocks of size 2^( 3) =       0.000430133668
  error estimate for blocks of size 2^( 4) =       0.000442272122
  error estimate for blocks of size 2^( 5) =       0.000452921004
  error estimate for blocks of size 2^( 6) =       0.000458822051
  error estimate for blocks of size 2^( 7) =       0.000463438936

      target function =                  N/A
              le_mean =     -16.905750523700
             les_mean =     286.132093720250
             stat err =       0.000454363528
             autocorr =       1.259997274668
              std dev =       0.572444857173
             le_variance =       0.327693114504


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905750523669        initial
     9.5367e+02     9.5367e+03             2.8169e-07       -16.905750524168  <--
     3.8147e+03     3.8147e+04             7.0436e-08       -16.905750523919
     1.5259e+04     1.5259e+05             1.7610e-08       -16.905750523700

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 2.9675e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.096105e-01 1 1  ON 0
 uu_1                 1.427838e-01 1 1  ON 1
 uu_2                 4.112893e-02 1 1  ON 2
 uu_3                -2.116938e-02 1 1  ON 3
 uu_4                -6.670722e-02 1 1  ON 4
 uu_5                -1.014290e-01 1 1  ON 5
 uu_6                -1.284647e-01 1 1  ON 6
 uu_7                -1.421837e-01 1 1  ON 7
 uu_8                -1.341876e-01 1 1  ON 8
 uu_9                -1.054325e-01 1 1  ON 9
 ud_0                 4.489249e-01 1 1  ON 10
 ud_1                 1.833713e-01 1 1  ON 11
 ud_2                 6.308850e-02 1 1  ON 12
 ud_3                -8.046016e-03 1 1  ON 13
 ud_4                -6.536402e-02 1 1  ON 14
 ud_5                -1.073127e-01 1 1  ON 15
 ud_6                -1.353573e-01 1 1  ON 16
 ud_7                -1.523595e-01 1 1  ON 17
 ud_8                -1.530457e-01 1 1  ON 18
 ud_9                -1.432531e-01 1 1  ON 19
 eO_0                -7.605436e-01 1 1  ON 20
 eO_1                -4.393172e-01 1 1  ON 21
 eO_2                -2.155599e-02 1 1  ON 22
 eO_3                 2.988706e-01 1 1  ON 23
 eO_4                 5.258091e-01 1 1  ON 24
 eO_5                 4.879556e-01 1 1  ON 25
 eO_6                 2.602740e-01 1 1  ON 26
 eO_7                -4.072286e-02 1 1  ON 27
 eO_8                -2.220089e-01 1 1  ON 28
 eO_9                -8.722573e-02 1 1  ON 29
eH1_0                -2.467248e-01 1 1  ON 30
eH1_1                -1.459110e-01 1 1  ON 31
eH1_2                -9.862631e-02 1 1  ON 32
eH1_3                -4.463100e-02 1 1  ON 33
eH1_4                 3.646594e-03 1 1  ON 34
eH1_5                 3.817562e-02 1 1  ON 35
eH1_6                 9.661026e-02 1 1  ON 36
eH1_7                 1.542960e-01 1 1  ON 37
eH1_8                 1.780638e-01 1 1  ON 38
eH1_9                 6.905923e-02 1 1  ON 39
eH2_0                -2.445666e-01 1 1  ON 40
eH2_1                -1.437055e-01 1 1  ON 41
eH2_2                -9.651537e-02 1 1  ON 42
eH2_3                -4.241493e-02 1 1  ON 43
eH2_4                 6.025948e-03 1 1  ON 44
eH2_5                 4.033538e-02 1 1  ON 45
eH2_6                 9.957435e-02 1 1  ON 46
eH2_7                 1.556660e-01 1 1  ON 47
eH2_8                 1.833700e-01 1 1  ON 48
eH2_9                 5.866157e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6445e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8866
    reference variance = 1.03975
====================================================
  Execution time = 2.0764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3212e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332049150986
                                         uncertainty =       0.002303815369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332049150986
                                         uncertainty =       0.002303815369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407505407
  error estimate for blocks of size 2^( 2) =       0.000420235619
  error estimate for blocks of size 2^( 3) =       0.000432996934
  error estimate for blocks of size 2^( 4) =       0.000444083723
  error estimate for blocks of size 2^( 5) =       0.000454281444
  error estimate for blocks of size 2^( 6) =       0.000461229954
  error estimate for blocks of size 2^( 7) =       0.000466264186

      target function =                  N/A
              le_mean =     -16.906391130098
             les_mean =     286.158182191169
             stat err =       0.000456464827
             autocorr =       1.254723076200
              std dev =       0.576299673227
             le_variance =       0.332121313361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690639113010e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906391130098       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906391134577       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906391134098       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906391135095       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906391138968       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906391140851       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906391140312       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906391140131       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.082580e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906391130098       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906391131219       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906391131099       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906391131348       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906391132316       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906391132788       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906391132653       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906391132607       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.706959e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906391130098       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906391130378       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906391130348       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906391130411       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906391130654       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906391130770       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906391130740       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906391130727       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 6.767717e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6425e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.096106e-01 1 1  ON 0
 uu_1                 1.427837e-01 1 1  ON 1
 uu_2                 4.112903e-02 1 1  ON 2
 uu_3                -2.116930e-02 1 1  ON 3
 uu_4                -6.670713e-02 1 1  ON 4
 uu_5                -1.014292e-01 1 1  ON 5
 uu_6                -1.284648e-01 1 1  ON 6
 uu_7                -1.421837e-01 1 1  ON 7
 uu_8                -1.341877e-01 1 1  ON 8
 uu_9                -1.054326e-01 1 1  ON 9
 ud_0                 4.489251e-01 1 1  ON 10
 ud_1                 1.833714e-01 1 1  ON 11
 ud_2                 6.308852e-02 1 1  ON 12
 ud_3                -8.046037e-03 1 1  ON 13
 ud_4                -6.536402e-02 1 1  ON 14
 ud_5                -1.073127e-01 1 1  ON 15
 ud_6                -1.353573e-01 1 1  ON 16
 ud_7                -1.523595e-01 1 1  ON 17
 ud_8                -1.530458e-01 1 1  ON 18
 ud_9                -1.432532e-01 1 1  ON 19
 eO_0                -7.605435e-01 1 1  ON 20
 eO_1                -4.393170e-01 1 1  ON 21
 eO_2                -2.155597e-02 1 1  ON 22
 eO_3                 2.988705e-01 1 1  ON 23
 eO_4                 5.258091e-01 1 1  ON 24
 eO_5                 4.879557e-01 1 1  ON 25
 eO_6                 2.602740e-01 1 1  ON 26
 eO_7                -4.072284e-02 1 1  ON 27
 eO_8                -2.220090e-01 1 1  ON 28
 eO_9                -8.722586e-02 1 1  ON 29
eH1_0                -2.467251e-01 1 1  ON 30
eH1_1                -1.459111e-01 1 1  ON 31
eH1_2                -9.862631e-02 1 1  ON 32
eH1_3                -4.463107e-02 1 1  ON 33
eH1_4                 3.646580e-03 1 1  ON 34
eH1_5                 3.817565e-02 1 1  ON 35
eH1_6                 9.661032e-02 1 1  ON 36
eH1_7                 1.542961e-01 1 1  ON 37
eH1_8                 1.780639e-01 1 1  ON 38
eH1_9                 6.905937e-02 1 1  ON 39
eH2_0                -2.445668e-01 1 1  ON 40
eH2_1                -1.437056e-01 1 1  ON 41
eH2_2                -9.651536e-02 1 1  ON 42
eH2_3                -4.241489e-02 1 1  ON 43
eH2_4                 6.025973e-03 1 1  ON 44
eH2_5                 4.033536e-02 1 1  ON 45
eH2_6                 9.957425e-02 1 1  ON 46
eH2_7                 1.556660e-01 1 1  ON 47
eH2_8                 1.833701e-01 1 1  ON 48
eH2_9                 5.866179e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9609
    reference variance = 0.467679
====================================================
  Execution time = 2.0923e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4088e-01
  Total weights = 2.0000e+06
  Execution time = 1.8670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340924722556
                                         uncertainty =       0.006120485443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340924722556
                                         uncertainty =       0.006120485443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412844330
  error estimate for blocks of size 2^( 2) =       0.000426149264
  error estimate for blocks of size 2^( 3) =       0.000439964331
  error estimate for blocks of size 2^( 4) =       0.000453001706
  error estimate for blocks of size 2^( 5) =       0.000464416081
  error estimate for blocks of size 2^( 6) =       0.000471557583
  error estimate for blocks of size 2^( 7) =       0.000478224258

      target function =                  N/A
              le_mean =     -16.906724470946
             les_mean =     286.178213048206
             stat err =       0.000466799907
             autocorr =       1.278465086075
              std dev =       0.583850051080
             le_variance =       0.340880882146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340925149015
                                         uncertainty =       0.006120488373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340925149015
                                         uncertainty =       0.006120488373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412844589
  error estimate for blocks of size 2^( 2) =       0.000426149503
  error estimate for blocks of size 2^( 3) =       0.000439964554
  error estimate for blocks of size 2^( 4) =       0.000453001915
  error estimate for blocks of size 2^( 5) =       0.000464416284
  error estimate for blocks of size 2^( 6) =       0.000471557794
  error estimate for blocks of size 2^( 7) =       0.000478224470

      target function =                  N/A
              le_mean =     -16.906724474323
             les_mean =     286.178213588791
             stat err =       0.000466800116
             autocorr =       1.278464630734
              std dev =       0.583850416251
             le_variance =       0.340881308556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340924935964
                                         uncertainty =       0.006120486908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340924935964
                                         uncertainty =       0.006120486908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412844460
  error estimate for blocks of size 2^( 2) =       0.000426149383
  error estimate for blocks of size 2^( 3) =       0.000439964443
  error estimate for blocks of size 2^( 4) =       0.000453001811
  error estimate for blocks of size 2^( 5) =       0.000464416182
  error estimate for blocks of size 2^( 6) =       0.000471557689
  error estimate for blocks of size 2^( 7) =       0.000478224364

      target function =                  N/A
              le_mean =     -16.906724472634
             les_mean =     286.178213318640
             stat err =       0.000466800012
             autocorr =       1.278464858241
              std dev =       0.583850233818
             le_variance =       0.340881095530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340924749237
                                         uncertainty =       0.006120485626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340924749237
                                         uncertainty =       0.006120485626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412844346
  error estimate for blocks of size 2^( 2) =       0.000426149279
  error estimate for blocks of size 2^( 3) =       0.000439964345
  error estimate for blocks of size 2^( 4) =       0.000453001719
  error estimate for blocks of size 2^( 5) =       0.000464416094
  error estimate for blocks of size 2^( 6) =       0.000471557596
  error estimate for blocks of size 2^( 7) =       0.000478224271

      target function =                  N/A
              le_mean =     -16.906724471157
             les_mean =     286.178213082012
             stat err =       0.000466799920
             autocorr =       1.278465057591
              std dev =       0.583850073927
             le_variance =       0.340880908824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906724470946        initial
     2.3842e+02     2.3842e+03             1.0826e-06       -16.906724474323  <--
     9.5367e+02     9.5367e+03             2.7070e-07       -16.906724472634
     3.8147e+03     3.8147e+04             6.7677e-08       -16.906724471157

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 3.0350e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.096108e-01 1 1  ON 0
 uu_1                 1.427835e-01 1 1  ON 1
 uu_2                 4.112933e-02 1 1  ON 2
 uu_3                -2.116909e-02 1 1  ON 3
 uu_4                -6.670686e-02 1 1  ON 4
 uu_5                -1.014296e-01 1 1  ON 5
 uu_6                -1.284651e-01 1 1  ON 6
 uu_7                -1.421837e-01 1 1  ON 7
 uu_8                -1.341881e-01 1 1  ON 8
 uu_9                -1.054328e-01 1 1  ON 9
 ud_0                 4.489258e-01 1 1  ON 10
 ud_1                 1.833716e-01 1 1  ON 11
 ud_2                 6.308855e-02 1 1  ON 12
 ud_3                -8.046099e-03 1 1  ON 13
 ud_4                -6.536401e-02 1 1  ON 14
 ud_5                -1.073128e-01 1 1  ON 15
 ud_6                -1.353572e-01 1 1  ON 16
 ud_7                -1.523595e-01 1 1  ON 17
 ud_8                -1.530463e-01 1 1  ON 18
 ud_9                -1.432534e-01 1 1  ON 19
 eO_0                -7.605434e-01 1 1  ON 20
 eO_1                -4.393165e-01 1 1  ON 21
 eO_2                -2.155590e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258091e-01 1 1  ON 24
 eO_5                 4.879558e-01 1 1  ON 25
 eO_6                 2.602742e-01 1 1  ON 26
 eO_7                -4.072278e-02 1 1  ON 27
 eO_8                -2.220094e-01 1 1  ON 28
 eO_9                -8.722627e-02 1 1  ON 29
eH1_0                -2.467259e-01 1 1  ON 30
eH1_1                -1.459113e-01 1 1  ON 31
eH1_2                -9.862632e-02 1 1  ON 32
eH1_3                -4.463128e-02 1 1  ON 33
eH1_4                 3.646540e-03 1 1  ON 34
eH1_5                 3.817572e-02 1 1  ON 35
eH1_6                 9.661047e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780643e-01 1 1  ON 38
eH1_9                 6.905980e-02 1 1  ON 39
eH2_0                -2.445676e-01 1 1  ON 40
eH2_1                -1.437060e-01 1 1  ON 41
eH2_2                -9.651533e-02 1 1  ON 42
eH2_3                -4.241475e-02 1 1  ON 43
eH2_4                 6.026047e-03 1 1  ON 44
eH2_5                 4.033530e-02 1 1  ON 45
eH2_6                 9.957394e-02 1 1  ON 46
eH2_7                 1.556661e-01 1 1  ON 47
eH2_8                 1.833706e-01 1 1  ON 48
eH2_9                 5.866246e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.982
    reference variance = 0.400967
====================================================
  Execution time = 2.0999e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.2820e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328245792786
                                         uncertainty =       0.002318475252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328245792786
                                         uncertainty =       0.002318475252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405093184
  error estimate for blocks of size 2^( 2) =       0.000417808908
  error estimate for blocks of size 2^( 3) =       0.000430460624
  error estimate for blocks of size 2^( 4) =       0.000442522315
  error estimate for blocks of size 2^( 5) =       0.000452804362
  error estimate for blocks of size 2^( 6) =       0.000460649148
  error estimate for blocks of size 2^( 7) =       0.000466705153

      target function =                  N/A
              le_mean =     -16.906863423495
             les_mean =     286.170231631281
             stat err =       0.000455670245
             autocorr =       1.265294059911
              std dev =       0.572888274167
             le_variance =       0.328200974678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690686342349e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906863423495       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906863442666       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906863436682       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906863433924       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906863431672       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906863427580       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906863432313       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906863434730       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 5.982155e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906863423495       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906863428299       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906863426799       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906863426100       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906863425527       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906863424499       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906863425688       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906863426289       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.496596e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906863423495       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906863424696       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906863424321       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906863424146       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906863424002       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906863423744       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906863424042       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906863424194       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 3.742152e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180495 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6551e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.096110e-01 1 1  ON 0
 uu_1                 1.427836e-01 1 1  ON 1
 uu_2                 4.112990e-02 1 1  ON 2
 uu_3                -2.116923e-02 1 1  ON 3
 uu_4                -6.670675e-02 1 1  ON 4
 uu_5                -1.014293e-01 1 1  ON 5
 uu_6                -1.284653e-01 1 1  ON 6
 uu_7                -1.421841e-01 1 1  ON 7
 uu_8                -1.341883e-01 1 1  ON 8
 uu_9                -1.054332e-01 1 1  ON 9
 ud_0                 4.489272e-01 1 1  ON 10
 ud_1                 1.833723e-01 1 1  ON 11
 ud_2                 6.308872e-02 1 1  ON 12
 ud_3                -8.046350e-03 1 1  ON 13
 ud_4                -6.536388e-02 1 1  ON 14
 ud_5                -1.073127e-01 1 1  ON 15
 ud_6                -1.353572e-01 1 1  ON 16
 ud_7                -1.523594e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432542e-01 1 1  ON 19
 eO_0                -7.605434e-01 1 1  ON 20
 eO_1                -4.393162e-01 1 1  ON 21
 eO_2                -2.155558e-02 1 1  ON 22
 eO_3                 2.988704e-01 1 1  ON 23
 eO_4                 5.258093e-01 1 1  ON 24
 eO_5                 4.879558e-01 1 1  ON 25
 eO_6                 2.602745e-01 1 1  ON 26
 eO_7                -4.072280e-02 1 1  ON 27
 eO_8                -2.220100e-01 1 1  ON 28
 eO_9                -8.722693e-02 1 1  ON 29
eH1_0                -2.467274e-01 1 1  ON 30
eH1_1                -1.459118e-01 1 1  ON 31
eH1_2                -9.862633e-02 1 1  ON 32
eH1_3                -4.463093e-02 1 1  ON 33
eH1_4                 3.647163e-03 1 1  ON 34
eH1_5                 3.817551e-02 1 1  ON 35
eH1_6                 9.661063e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780648e-01 1 1  ON 38
eH1_9                 6.906039e-02 1 1  ON 39
eH2_0                -2.445689e-01 1 1  ON 40
eH2_1                -1.437064e-01 1 1  ON 41
eH2_2                -9.651529e-02 1 1  ON 42
eH2_3                -4.241467e-02 1 1  ON 43
eH2_4                 6.026490e-03 1 1  ON 44
eH2_5                 4.033518e-02 1 1  ON 45
eH2_6                 9.957387e-02 1 1  ON 46
eH2_7                 1.556661e-01 1 1  ON 47
eH2_8                 1.833710e-01 1 1  ON 48
eH2_9                 5.866325e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9282
    reference variance = 0.433308
====================================================
  Execution time = 2.0397e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.7887e-01
  Total weights = 2.0000e+06
  Execution time = 1.8759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378974662111
                                         uncertainty =       0.025203245983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378974662111
                                         uncertainty =       0.025203245983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435238439
  error estimate for blocks of size 2^( 2) =       0.000447069812
  error estimate for blocks of size 2^( 3) =       0.000458838982
  error estimate for blocks of size 2^( 4) =       0.000470626159
  error estimate for blocks of size 2^( 5) =       0.000480046480
  error estimate for blocks of size 2^( 6) =       0.000489002526
  error estimate for blocks of size 2^( 7) =       0.000495434982

      target function =                  N/A
              le_mean =     -16.906159234509
             les_mean =     286.197084870190
             stat err =       0.000483777537
             autocorr =       1.235483387892
              std dev =       0.615520102871
             le_variance =       0.378864997038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378977744200
                                         uncertainty =       0.025203338824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378977744200
                                         uncertainty =       0.025203338824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435240209
  error estimate for blocks of size 2^( 2) =       0.000447071416
  error estimate for blocks of size 2^( 3) =       0.000458840398
  error estimate for blocks of size 2^( 4) =       0.000470627484
  error estimate for blocks of size 2^( 5) =       0.000480047785
  error estimate for blocks of size 2^( 6) =       0.000489003806
  error estimate for blocks of size 2^( 7) =       0.000495436255

      target function =                  N/A
              le_mean =     -16.906159223260
             les_mean =     286.197087571765
             stat err =       0.000483778832
             autocorr =       1.235479955089
              std dev =       0.615522606405
             le_variance =       0.378868078996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378976206259
                                         uncertainty =       0.025203292052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378976206259
                                         uncertainty =       0.025203292052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435239326
  error estimate for blocks of size 2^( 2) =       0.000447070615
  error estimate for blocks of size 2^( 3) =       0.000458839691
  error estimate for blocks of size 2^( 4) =       0.000470626823
  error estimate for blocks of size 2^( 5) =       0.000480047133
  error estimate for blocks of size 2^( 6) =       0.000489003167
  error estimate for blocks of size 2^( 7) =       0.000495435620

      target function =                  N/A
              le_mean =     -16.906159228842
             les_mean =     286.197086222640
             stat err =       0.000483778186
             autocorr =       1.235481667769
              std dev =       0.615521357161
             le_variance =       0.378866541122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378974855218
                                         uncertainty =       0.025203251730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378974855218
                                         uncertainty =       0.025203251730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435238550
  error estimate for blocks of size 2^( 2) =       0.000447069912
  error estimate for blocks of size 2^( 3) =       0.000458839070
  error estimate for blocks of size 2^( 4) =       0.000470626242
  error estimate for blocks of size 2^( 5) =       0.000480046561
  error estimate for blocks of size 2^( 6) =       0.000489002606
  error estimate for blocks of size 2^( 7) =       0.000495435062

      target function =                  N/A
              le_mean =     -16.906159233798
             les_mean =     286.197085039228
             stat err =       0.000483777618
             autocorr =       1.235483172753
              std dev =       0.615520259729
             le_variance =       0.378865190137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906159234509        initial  <--
     5.9605e+01     5.9605e+02             5.9822e-06       -16.906159223260
     2.3842e+02     2.3842e+03             1.4966e-06       -16.906159228842
     9.5367e+02     9.5367e+03             3.7422e-07       -16.906159233798

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8596
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.096108e-01 1 1  ON 0
 uu_1                 1.427835e-01 1 1  ON 1
 uu_2                 4.112933e-02 1 1  ON 2
 uu_3                -2.116909e-02 1 1  ON 3
 uu_4                -6.670686e-02 1 1  ON 4
 uu_5                -1.014296e-01 1 1  ON 5
 uu_6                -1.284651e-01 1 1  ON 6
 uu_7                -1.421837e-01 1 1  ON 7
 uu_8                -1.341881e-01 1 1  ON 8
 uu_9                -1.054328e-01 1 1  ON 9
 ud_0                 4.489258e-01 1 1  ON 10
 ud_1                 1.833716e-01 1 1  ON 11
 ud_2                 6.308855e-02 1 1  ON 12
 ud_3                -8.046099e-03 1 1  ON 13
 ud_4                -6.536401e-02 1 1  ON 14
 ud_5                -1.073128e-01 1 1  ON 15
 ud_6                -1.353572e-01 1 1  ON 16
 ud_7                -1.523595e-01 1 1  ON 17
 ud_8                -1.530463e-01 1 1  ON 18
 ud_9                -1.432534e-01 1 1  ON 19
 eO_0                -7.605434e-01 1 1  ON 20
 eO_1                -4.393165e-01 1 1  ON 21
 eO_2                -2.155590e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258091e-01 1 1  ON 24
 eO_5                 4.879558e-01 1 1  ON 25
 eO_6                 2.602742e-01 1 1  ON 26
 eO_7                -4.072278e-02 1 1  ON 27
 eO_8                -2.220094e-01 1 1  ON 28
 eO_9                -8.722627e-02 1 1  ON 29
eH1_0                -2.467259e-01 1 1  ON 30
eH1_1                -1.459113e-01 1 1  ON 31
eH1_2                -9.862632e-02 1 1  ON 32
eH1_3                -4.463128e-02 1 1  ON 33
eH1_4                 3.646540e-03 1 1  ON 34
eH1_5                 3.817572e-02 1 1  ON 35
eH1_6                 9.661047e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780643e-01 1 1  ON 38
eH1_9                 6.905980e-02 1 1  ON 39
eH2_0                -2.445676e-01 1 1  ON 40
eH2_1                -1.437060e-01 1 1  ON 41
eH2_2                -9.651533e-02 1 1  ON 42
eH2_3                -4.241475e-02 1 1  ON 43
eH2_4                 6.026047e-03 1 1  ON 44
eH2_5                 4.033530e-02 1 1  ON 45
eH2_6                 9.957394e-02 1 1  ON 46
eH2_7                 1.556661e-01 1 1  ON 47
eH2_8                 1.833706e-01 1 1  ON 48
eH2_9                 5.866246e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6424e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.906
    reference variance = 0.218269
====================================================
  Execution time = 2.1100e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4333e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343321361846
                                         uncertainty =       0.005687894426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343321361846
                                         uncertainty =       0.005687894426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414325636
  error estimate for blocks of size 2^( 2) =       0.000426417370
  error estimate for blocks of size 2^( 3) =       0.000438960070
  error estimate for blocks of size 2^( 4) =       0.000450808802
  error estimate for blocks of size 2^( 5) =       0.000460966069
  error estimate for blocks of size 2^( 6) =       0.000467931933
  error estimate for blocks of size 2^( 7) =       0.000470038413

      target function =                  N/A
              le_mean =     -16.906745385212
             les_mean =     286.181370813938
             stat err =       0.000462436304
             autocorr =       1.245719411235
              std dev =       0.585944933610
             le_variance =       0.343331465223


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690674538521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906745385212       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906745387585       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906745389893       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906745390979       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906745391333       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906745391616       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906745390787       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906745390819       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 5.160984e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906745385212       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906745385805       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906745386382       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906745386653       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906745386744       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906745386813       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906745386606       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906745386621       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.290342e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906745385212       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906745385360       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906745385504       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906745385574       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906745385594       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906745385609       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906745385572       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906745385555       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 3.225914e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183105 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6701e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.096108e-01 1 1  ON 0
 uu_1                 1.427835e-01 1 1  ON 1
 uu_2                 4.112936e-02 1 1  ON 2
 uu_3                -2.116908e-02 1 1  ON 3
 uu_4                -6.670679e-02 1 1  ON 4
 uu_5                -1.014296e-01 1 1  ON 5
 uu_6                -1.284651e-01 1 1  ON 6
 uu_7                -1.421838e-01 1 1  ON 7
 uu_8                -1.341882e-01 1 1  ON 8
 uu_9                -1.054328e-01 1 1  ON 9
 ud_0                 4.489259e-01 1 1  ON 10
 ud_1                 1.833717e-01 1 1  ON 11
 ud_2                 6.308855e-02 1 1  ON 12
 ud_3                -8.046072e-03 1 1  ON 13
 ud_4                -6.536401e-02 1 1  ON 14
 ud_5                -1.073128e-01 1 1  ON 15
 ud_6                -1.353573e-01 1 1  ON 16
 ud_7                -1.523595e-01 1 1  ON 17
 ud_8                -1.530463e-01 1 1  ON 18
 ud_9                -1.432534e-01 1 1  ON 19
 eO_0                -7.605434e-01 1 1  ON 20
 eO_1                -4.393164e-01 1 1  ON 21
 eO_2                -2.155585e-02 1 1  ON 22
 eO_3                 2.988701e-01 1 1  ON 23
 eO_4                 5.258091e-01 1 1  ON 24
 eO_5                 4.879558e-01 1 1  ON 25
 eO_6                 2.602742e-01 1 1  ON 26
 eO_7                -4.072276e-02 1 1  ON 27
 eO_8                -2.220095e-01 1 1  ON 28
 eO_9                -8.722634e-02 1 1  ON 29
eH1_0                -2.467260e-01 1 1  ON 30
eH1_1                -1.459113e-01 1 1  ON 31
eH1_2                -9.862632e-02 1 1  ON 32
eH1_3                -4.463126e-02 1 1  ON 33
eH1_4                 3.646563e-03 1 1  ON 34
eH1_5                 3.817571e-02 1 1  ON 35
eH1_6                 9.661045e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780643e-01 1 1  ON 38
eH1_9                 6.905986e-02 1 1  ON 39
eH2_0                -2.445677e-01 1 1  ON 40
eH2_1                -1.437061e-01 1 1  ON 41
eH2_2                -9.651529e-02 1 1  ON 42
eH2_3                -4.241480e-02 1 1  ON 43
eH2_4                 6.026081e-03 1 1  ON 44
eH2_5                 4.033533e-02 1 1  ON 45
eH2_6                 9.957393e-02 1 1  ON 46
eH2_7                 1.556661e-01 1 1  ON 47
eH2_8                 1.833707e-01 1 1  ON 48
eH2_9                 5.866254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.879
    reference variance = 0.19058
====================================================
  Execution time = 2.2637e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3346e-01
  Total weights = 2.0000e+06
  Execution time = 1.8786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333606697119
                                         uncertainty =       0.002778586501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333606697119
                                         uncertainty =       0.002778586501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408327367
  error estimate for blocks of size 2^( 2) =       0.000421098802
  error estimate for blocks of size 2^( 3) =       0.000434273060
  error estimate for blocks of size 2^( 4) =       0.000446583875
  error estimate for blocks of size 2^( 5) =       0.000457916589
  error estimate for blocks of size 2^( 6) =       0.000467849861
  error estimate for blocks of size 2^( 7) =       0.000474179906

      target function =                  N/A
              le_mean =     -16.906592805117
             les_mean =     286.166342589102
             stat err =       0.000461632558
             autocorr =       1.278132518588
              std dev =       0.577462100745
             le_variance =       0.333462477797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333606857061
                                         uncertainty =       0.002778588786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333606857061
                                         uncertainty =       0.002778588786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408327465
  error estimate for blocks of size 2^( 2) =       0.000421098888
  error estimate for blocks of size 2^( 3) =       0.000434273133
  error estimate for blocks of size 2^( 4) =       0.000446583944
  error estimate for blocks of size 2^( 5) =       0.000457916654
  error estimate for blocks of size 2^( 6) =       0.000467849923
  error estimate for blocks of size 2^( 7) =       0.000474179969

      target function =                  N/A
              le_mean =     -16.906592808249
             les_mean =     286.166342854872
             stat err =       0.000461632623
             autocorr =       1.278132265565
              std dev =       0.577462239167
             le_variance =       0.333462637664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333606777090
                                         uncertainty =       0.002778587643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333606777090
                                         uncertainty =       0.002778587643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408327416
  error estimate for blocks of size 2^( 2) =       0.000421098845
  error estimate for blocks of size 2^( 3) =       0.000434273097
  error estimate for blocks of size 2^( 4) =       0.000446583909
  error estimate for blocks of size 2^( 5) =       0.000457916621
  error estimate for blocks of size 2^( 6) =       0.000467849892
  error estimate for blocks of size 2^( 7) =       0.000474179937

      target function =                  N/A
              le_mean =     -16.906592806684
             les_mean =     286.166342722006
             stat err =       0.000461632590
             autocorr =       1.278132392050
              std dev =       0.577462169956
             le_variance =       0.333462557731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333606707116
                                         uncertainty =       0.002778586643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333606707116
                                         uncertainty =       0.002778586643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408327373
  error estimate for blocks of size 2^( 2) =       0.000421098807
  error estimate for blocks of size 2^( 3) =       0.000434273065
  error estimate for blocks of size 2^( 4) =       0.000446583879
  error estimate for blocks of size 2^( 5) =       0.000457916593
  error estimate for blocks of size 2^( 6) =       0.000467849865
  error estimate for blocks of size 2^( 7) =       0.000474179910

      target function =                  N/A
              le_mean =     -16.906592805313
             les_mean =     286.166342605715
             stat err =       0.000461632562
             autocorr =       1.278132502763
              std dev =       0.577462109396
             le_variance =       0.333462487788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906592805117        initial
     5.9605e+02     5.9605e+03             5.1610e-07       -16.906592808249  <--
     2.3842e+03     2.3842e+04             1.2903e-07       -16.906592806684
     9.5367e+03     9.5367e+04             3.2259e-08       -16.906592805313

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 3.2202e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.096109e-01 1 1  ON 0
 uu_1                 1.427835e-01 1 1  ON 1
 uu_2                 4.112944e-02 1 1  ON 2
 uu_3                -2.116907e-02 1 1  ON 3
 uu_4                -6.670657e-02 1 1  ON 4
 uu_5                -1.014296e-01 1 1  ON 5
 uu_6                -1.284652e-01 1 1  ON 6
 uu_7                -1.421838e-01 1 1  ON 7
 uu_8                -1.341884e-01 1 1  ON 8
 uu_9                -1.054331e-01 1 1  ON 9
 ud_0                 4.489261e-01 1 1  ON 10
 ud_1                 1.833720e-01 1 1  ON 11
 ud_2                 6.308853e-02 1 1  ON 12
 ud_3                -8.045993e-03 1 1  ON 13
 ud_4                -6.536403e-02 1 1  ON 14
 ud_5                -1.073128e-01 1 1  ON 15
 ud_6                -1.353573e-01 1 1  ON 16
 ud_7                -1.523595e-01 1 1  ON 17
 ud_8                -1.530465e-01 1 1  ON 18
 ud_9                -1.432537e-01 1 1  ON 19
 eO_0                -7.605435e-01 1 1  ON 20
 eO_1                -4.393162e-01 1 1  ON 21
 eO_2                -2.155571e-02 1 1  ON 22
 eO_3                 2.988700e-01 1 1  ON 23
 eO_4                 5.258092e-01 1 1  ON 24
 eO_5                 4.879560e-01 1 1  ON 25
 eO_6                 2.602743e-01 1 1  ON 26
 eO_7                -4.072271e-02 1 1  ON 27
 eO_8                -2.220097e-01 1 1  ON 28
 eO_9                -8.722655e-02 1 1  ON 29
eH1_0                -2.467263e-01 1 1  ON 30
eH1_1                -1.459113e-01 1 1  ON 31
eH1_2                -9.862634e-02 1 1  ON 32
eH1_3                -4.463118e-02 1 1  ON 33
eH1_4                 3.646634e-03 1 1  ON 34
eH1_5                 3.817566e-02 1 1  ON 35
eH1_6                 9.661038e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780644e-01 1 1  ON 38
eH1_9                 6.906006e-02 1 1  ON 39
eH2_0                -2.445681e-01 1 1  ON 40
eH2_1                -1.437062e-01 1 1  ON 41
eH2_2                -9.651518e-02 1 1  ON 42
eH2_3                -4.241493e-02 1 1  ON 43
eH2_4                 6.026181e-03 1 1  ON 44
eH2_5                 4.033544e-02 1 1  ON 45
eH2_6                 9.957392e-02 1 1  ON 46
eH2_7                 1.556661e-01 1 1  ON 47
eH2_8                 1.833708e-01 1 1  ON 48
eH2_9                 5.866277e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8913e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9784
    reference variance = 0.188717
====================================================
  Execution time = 2.1257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3783e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337789080857
                                         uncertainty =       0.003665902927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337789080857
                                         uncertainty =       0.003665902927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410995662
  error estimate for blocks of size 2^( 2) =       0.000423949436
  error estimate for blocks of size 2^( 3) =       0.000437263931
  error estimate for blocks of size 2^( 4) =       0.000449656899
  error estimate for blocks of size 2^( 5) =       0.000461058236
  error estimate for blocks of size 2^( 6) =       0.000468017058
  error estimate for blocks of size 2^( 7) =       0.000474835054

      target function =                  N/A
              le_mean =     -16.906294945724
             les_mean =     286.160643491536
             stat err =       0.000463391812
             autocorr =       1.271224442169
              std dev =       0.581235639527
             le_variance =       0.337834868656


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690629494572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906294945724       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906294961536       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906294968275       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906294967958       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906294968838       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906294968023       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906294966892       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906294967898       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 2.477851e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906294945724       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906294949680       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906294951368       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906294951296       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906294951516       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906294951313       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906294951029       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906294951280       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 6.196208e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906294945724       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906294946713       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906294947135       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906294947116       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906294947173       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906294947123       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906294947052       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906294947114       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.549151e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185704 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6907e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.096108e-01 1 1  ON 0
 uu_1                 1.427837e-01 1 1  ON 1
 uu_2                 4.112981e-02 1 1  ON 2
 uu_3                -2.116918e-02 1 1  ON 3
 uu_4                -6.670645e-02 1 1  ON 4
 uu_5                -1.014297e-01 1 1  ON 5
 uu_6                -1.284655e-01 1 1  ON 6
 uu_7                -1.421841e-01 1 1  ON 7
 uu_8                -1.341885e-01 1 1  ON 8
 uu_9                -1.054331e-01 1 1  ON 9
 ud_0                 4.489263e-01 1 1  ON 10
 ud_1                 1.833721e-01 1 1  ON 11
 ud_2                 6.308865e-02 1 1  ON 12
 ud_3                -8.046232e-03 1 1  ON 13
 ud_4                -6.536426e-02 1 1  ON 14
 ud_5                -1.073128e-01 1 1  ON 15
 ud_6                -1.353570e-01 1 1  ON 16
 ud_7                -1.523593e-01 1 1  ON 17
 ud_8                -1.530466e-01 1 1  ON 18
 ud_9                -1.432538e-01 1 1  ON 19
 eO_0                -7.605436e-01 1 1  ON 20
 eO_1                -4.393161e-01 1 1  ON 21
 eO_2                -2.155563e-02 1 1  ON 22
 eO_3                 2.988700e-01 1 1  ON 23
 eO_4                 5.258093e-01 1 1  ON 24
 eO_5                 4.879560e-01 1 1  ON 25
 eO_6                 2.602743e-01 1 1  ON 26
 eO_7                -4.072268e-02 1 1  ON 27
 eO_8                -2.220098e-01 1 1  ON 28
 eO_9                -8.722675e-02 1 1  ON 29
eH1_0                -2.467269e-01 1 1  ON 30
eH1_1                -1.459116e-01 1 1  ON 31
eH1_2                -9.862630e-02 1 1  ON 32
eH1_3                -4.463109e-02 1 1  ON 33
eH1_4                 3.646938e-03 1 1  ON 34
eH1_5                 3.817574e-02 1 1  ON 35
eH1_6                 9.661034e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780646e-01 1 1  ON 38
eH1_9                 6.906032e-02 1 1  ON 39
eH2_0                -2.445685e-01 1 1  ON 40
eH2_1                -1.437064e-01 1 1  ON 41
eH2_2                -9.651529e-02 1 1  ON 42
eH2_3                -4.241478e-02 1 1  ON 43
eH2_4                 6.026223e-03 1 1  ON 44
eH2_5                 4.033523e-02 1 1  ON 45
eH2_6                 9.957401e-02 1 1  ON 46
eH2_7                 1.556662e-01 1 1  ON 47
eH2_8                 1.833709e-01 1 1  ON 48
eH2_9                 5.866308e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9418
    reference variance = 0.209834
====================================================
  Execution time = 2.0308e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4473e-01
  Total weights = 2.0000e+06
  Execution time = 1.8721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344467348972
                                         uncertainty =       0.005016071382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344467348972
                                         uncertainty =       0.005016071382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415170504
  error estimate for blocks of size 2^( 2) =       0.000427543960
  error estimate for blocks of size 2^( 3) =       0.000440308021
  error estimate for blocks of size 2^( 4) =       0.000452069074
  error estimate for blocks of size 2^( 5) =       0.000461853466
  error estimate for blocks of size 2^( 6) =       0.000467668152
  error estimate for blocks of size 2^( 7) =       0.000471808204

      target function =                  N/A
              le_mean =     -16.906040483121
             les_mean =     286.158937738628
             stat err =       0.000463349724
             autocorr =       1.245560524893
              std dev =       0.587139756847
             le_variance =       0.344733094070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344467036188
                                         uncertainty =       0.005016054554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344467036188
                                         uncertainty =       0.005016054554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415170315
  error estimate for blocks of size 2^( 2) =       0.000427543753
  error estimate for blocks of size 2^( 3) =       0.000440307795
  error estimate for blocks of size 2^( 4) =       0.000452068837
  error estimate for blocks of size 2^( 5) =       0.000461853248
  error estimate for blocks of size 2^( 6) =       0.000467667965
  error estimate for blocks of size 2^( 7) =       0.000471808042

      target function =                  N/A
              le_mean =     -16.906040501877
             les_mean =     286.158938058880
             stat err =       0.000463349523
             autocorr =       1.245560578189
              std dev =       0.587139489502
             le_variance =       0.344732780133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344467191584
                                         uncertainty =       0.005016062941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344467191584
                                         uncertainty =       0.005016062941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415170408
  error estimate for blocks of size 2^( 2) =       0.000427543856
  error estimate for blocks of size 2^( 3) =       0.000440307907
  error estimate for blocks of size 2^( 4) =       0.000452068955
  error estimate for blocks of size 2^( 5) =       0.000461853356
  error estimate for blocks of size 2^( 6) =       0.000467668058
  error estimate for blocks of size 2^( 7) =       0.000471808123

      target function =                  N/A
              le_mean =     -16.906040492520
             les_mean =     286.158937898473
             stat err =       0.000463349623
             autocorr =       1.245560552366
              std dev =       0.587139622326
             le_variance =       0.344732936105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344467329265
                                         uncertainty =       0.005016070326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344467329265
                                         uncertainty =       0.005016070326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415170492
  error estimate for blocks of size 2^( 2) =       0.000427543947
  error estimate for blocks of size 2^( 3) =       0.000440308007
  error estimate for blocks of size 2^( 4) =       0.000452069059
  error estimate for blocks of size 2^( 5) =       0.000461853452
  error estimate for blocks of size 2^( 6) =       0.000467668140
  error estimate for blocks of size 2^( 7) =       0.000471808194

      target function =                  N/A
              le_mean =     -16.906040484296
             les_mean =     286.158937758584
             stat err =       0.000463349711
             autocorr =       1.245560528352
              std dev =       0.587139740003
             le_variance =       0.344733074291


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906040483121        initial
     1.4901e+02     1.4901e+03             2.4779e-06       -16.906040501877  <--
     5.9605e+02     5.9605e+03             6.1962e-07       -16.906040492520
     2.3842e+03     2.3842e+04             1.5492e-07       -16.906040484296

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 2.9751e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6680e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8847
    reference variance = 0.220125
====================================================
  Execution time = 2.0924e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3123e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331276054437
                                         uncertainty =       0.002242176563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331276054437
                                         uncertainty =       0.002242176563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406956429
  error estimate for blocks of size 2^( 2) =       0.000419987705
  error estimate for blocks of size 2^( 3) =       0.000432969438
  error estimate for blocks of size 2^( 4) =       0.000444958472
  error estimate for blocks of size 2^( 5) =       0.000456290411
  error estimate for blocks of size 2^( 6) =       0.000462051422
  error estimate for blocks of size 2^( 7) =       0.000465671507

      target function =                  N/A
              le_mean =     -16.905891835562
             les_mean =     286.140405659826
             stat err =       0.000457242953
             autocorr =       1.262403572677
              std dev =       0.575523300764
             le_variance =       0.331227069722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589183556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905891835562       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905891862161       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905891894354       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905891896822       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905891900843       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905891903742       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905891900657       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905891901741       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 9.428494e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905891835562       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905891842238       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905891850317       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905891850955       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905891851927       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905891852726       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905891851924       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905891852188       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 2.359590e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905891835562       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905891837232       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905891839254       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905891839415       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905891839656       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905891839861       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905891839658       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905891839722       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 5.900525e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6662e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.096108e-01 1 1  ON 0
 uu_1                 1.427849e-01 1 1  ON 1
 uu_2                 4.113141e-02 1 1  ON 2
 uu_3                -2.116991e-02 1 1  ON 3
 uu_4                -6.670578e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284665e-01 1 1  ON 6
 uu_7                -1.421855e-01 1 1  ON 7
 uu_8                -1.341894e-01 1 1  ON 8
 uu_9                -1.054337e-01 1 1  ON 9
 ud_0                 4.489286e-01 1 1  ON 10
 ud_1                 1.833727e-01 1 1  ON 11
 ud_2                 6.308910e-02 1 1  ON 12
 ud_3                -8.046728e-03 1 1  ON 13
 ud_4                -6.536543e-02 1 1  ON 14
 ud_5                -1.073120e-01 1 1  ON 15
 ud_6                -1.353555e-01 1 1  ON 16
 ud_7                -1.523587e-01 1 1  ON 17
 ud_8                -1.530481e-01 1 1  ON 18
 ud_9                -1.432551e-01 1 1  ON 19
 eO_0                -7.605438e-01 1 1  ON 20
 eO_1                -4.393162e-01 1 1  ON 21
 eO_2                -2.155445e-02 1 1  ON 22
 eO_3                 2.988697e-01 1 1  ON 23
 eO_4                 5.258102e-01 1 1  ON 24
 eO_5                 4.879569e-01 1 1  ON 25
 eO_6                 2.602752e-01 1 1  ON 26
 eO_7                -4.072237e-02 1 1  ON 27
 eO_8                -2.220113e-01 1 1  ON 28
 eO_9                -8.722840e-02 1 1  ON 29
eH1_0                -2.467311e-01 1 1  ON 30
eH1_1                -1.459134e-01 1 1  ON 31
eH1_2                -9.862586e-02 1 1  ON 32
eH1_3                -4.463059e-02 1 1  ON 33
eH1_4                 3.648275e-03 1 1  ON 34
eH1_5                 3.817626e-02 1 1  ON 35
eH1_6                 9.661068e-02 1 1  ON 36
eH1_7                 1.542968e-01 1 1  ON 37
eH1_8                 1.780656e-01 1 1  ON 38
eH1_9                 6.906177e-02 1 1  ON 39
eH2_0                -2.445714e-01 1 1  ON 40
eH2_1                -1.437082e-01 1 1  ON 41
eH2_2                -9.651573e-02 1 1  ON 42
eH2_3                -4.241408e-02 1 1  ON 43
eH2_4                 6.026807e-03 1 1  ON 44
eH2_5                 4.033498e-02 1 1  ON 45
eH2_6                 9.957387e-02 1 1  ON 46
eH2_7                 1.556667e-01 1 1  ON 47
eH2_8                 1.833721e-01 1 1  ON 48
eH2_9                 5.866535e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9053
    reference variance = 0.148476
====================================================
  Execution time = 2.0727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3865e-01
  Total weights = 2.0000e+06
  Execution time = 1.8781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338754622641
                                         uncertainty =       0.004860498379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338754622641
                                         uncertainty =       0.004860498379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411489428
  error estimate for blocks of size 2^( 2) =       0.000423820711
  error estimate for blocks of size 2^( 3) =       0.000437391364
  error estimate for blocks of size 2^( 4) =       0.000448975298
  error estimate for blocks of size 2^( 5) =       0.000460313162
  error estimate for blocks of size 2^( 6) =       0.000468177367
  error estimate for blocks of size 2^( 7) =       0.000471323799

      target function =                  N/A
              le_mean =     -16.906146926220
             les_mean =     286.156450819546
             stat err =       0.000462197406
             autocorr =       1.261646379081
              std dev =       0.581933929183
             le_variance =       0.338647097934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338759471981
                                         uncertainty =       0.004860585193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338759471981
                                         uncertainty =       0.004860585193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411492372
  error estimate for blocks of size 2^( 2) =       0.000423823414
  error estimate for blocks of size 2^( 3) =       0.000437393884
  error estimate for blocks of size 2^( 4) =       0.000448977658
  error estimate for blocks of size 2^( 5) =       0.000460315524
  error estimate for blocks of size 2^( 6) =       0.000468179760
  error estimate for blocks of size 2^( 7) =       0.000471325972

      target function =                  N/A
              le_mean =     -16.906146922760
             les_mean =     286.156455548714
             stat err =       0.000462199728
             autocorr =       1.261641001432
              std dev =       0.581938092996
             le_variance =       0.338651944080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338757065050
                                         uncertainty =       0.004860542104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338757065050
                                         uncertainty =       0.004860542104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411490910
  error estimate for blocks of size 2^( 2) =       0.000423822072
  error estimate for blocks of size 2^( 3) =       0.000437392633
  error estimate for blocks of size 2^( 4) =       0.000448976487
  error estimate for blocks of size 2^( 5) =       0.000460314352
  error estimate for blocks of size 2^( 6) =       0.000468178573
  error estimate for blocks of size 2^( 7) =       0.000471324893

      target function =                  N/A
              le_mean =     -16.906146924540
             les_mean =     286.156453203528
             stat err =       0.000462198576
             autocorr =       1.261643672719
              std dev =       0.581936026320
             le_variance =       0.338649538729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338754928483
                                         uncertainty =       0.004860503854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338754928483
                                         uncertainty =       0.004860503854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411489613
  error estimate for blocks of size 2^( 2) =       0.000423820881
  error estimate for blocks of size 2^( 3) =       0.000437391523
  error estimate for blocks of size 2^( 4) =       0.000448975447
  error estimate for blocks of size 2^( 5) =       0.000460313311
  error estimate for blocks of size 2^( 6) =       0.000468177518
  error estimate for blocks of size 2^( 7) =       0.000471323936

      target function =                  N/A
              le_mean =     -16.906146926008
             les_mean =     286.156451118033
             stat err =       0.000462197553
             autocorr =       1.261646040222
              std dev =       0.581934191790
             le_variance =       0.338647403575


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906146926220        initial  <--
     3.7253e+01     3.7253e+02             9.4285e-06       -16.906146922760
     1.4901e+02     1.4901e+03             2.3596e-06       -16.906146924540
     5.9605e+02     5.9605e+03             5.9005e-07       -16.906146926008

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1921
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9484
    reference variance = 0.257806
====================================================
  Execution time = 2.0941e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3782e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337924094823
                                         uncertainty =       0.003072285870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337924094823
                                         uncertainty =       0.003072285870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410985585
  error estimate for blocks of size 2^( 2) =       0.000423172312
  error estimate for blocks of size 2^( 3) =       0.000435679389
  error estimate for blocks of size 2^( 4) =       0.000447742244
  error estimate for blocks of size 2^( 5) =       0.000458253221
  error estimate for blocks of size 2^( 6) =       0.000468144344
  error estimate for blocks of size 2^( 7) =       0.000473558881

      target function =                  N/A
              le_mean =     -16.906714933195
             les_mean =     286.174827965679
             stat err =       0.000461924673
             autocorr =       1.263249514353
              std dev =       0.581221388339
             le_variance =       0.337818302263


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690671493320e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906714933195       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906714934088       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906714936058       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906714938906       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906714939455       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906714939314       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906714938904       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906714938956       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 8.863210e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906714933195       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906714933419       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906714933911       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906714934624       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906714934760       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906714934726       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906714934623       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906714934639       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 2.216060e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906714933195       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906714933251       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906714933374       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906714933552       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906714933588       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906714933577       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906714933560       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906714933553       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 5.540312e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190869 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6483e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113098e-02 1 1  ON 2
 uu_3                -2.116955e-02 1 1  ON 3
 uu_4                -6.670605e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284665e-01 1 1  ON 6
 uu_7                -1.421850e-01 1 1  ON 7
 uu_8                -1.341889e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489268e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308898e-02 1 1  ON 12
 ud_3                -8.047002e-03 1 1  ON 13
 ud_4                -6.536495e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353560e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155537e-02 1 1  ON 22
 eO_3                 2.988701e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879564e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072260e-02 1 1  ON 27
 eO_8                -2.220103e-01 1 1  ON 28
 eO_9                -8.722744e-02 1 1  ON 29
eH1_0                -2.467290e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862627e-02 1 1  ON 32
eH1_3                -4.463080e-02 1 1  ON 33
eH1_4                 3.647853e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661021e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780652e-01 1 1  ON 38
eH1_9                 6.906122e-02 1 1  ON 39
eH2_0                -2.445698e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651559e-02 1 1  ON 42
eH2_3                -4.241426e-02 1 1  ON 43
eH2_4                 6.026450e-03 1 1  ON 44
eH2_5                 4.033460e-02 1 1  ON 45
eH2_6                 9.957426e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866408e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8665
    reference variance = 0.262381
====================================================
  Execution time = 2.0817e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5649e-01
  Total weights = 2.0000e+06
  Execution time = 1.8759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356381449728
                                         uncertainty =       0.016513772239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356381449728
                                         uncertainty =       0.016513772239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422192807
  error estimate for blocks of size 2^( 2) =       0.000434705985
  error estimate for blocks of size 2^( 3) =       0.000448135241
  error estimate for blocks of size 2^( 4) =       0.000460636834
  error estimate for blocks of size 2^( 5) =       0.000470860618
  error estimate for blocks of size 2^( 6) =       0.000479742905
  error estimate for blocks of size 2^( 7) =       0.000483379122

      target function =                  N/A
              le_mean =     -16.906423449897
             les_mean =     286.183647220970
             stat err =       0.000473654870
             autocorr =       1.258642390732
              std dev =       0.597070793118
             le_variance =       0.356493531995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356381664511
                                         uncertainty =       0.016513772772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356381664511
                                         uncertainty =       0.016513772772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422192934
  error estimate for blocks of size 2^( 2) =       0.000434706101
  error estimate for blocks of size 2^( 3) =       0.000448135342
  error estimate for blocks of size 2^( 4) =       0.000460636927
  error estimate for blocks of size 2^( 5) =       0.000470860710
  error estimate for blocks of size 2^( 6) =       0.000479742988
  error estimate for blocks of size 2^( 7) =       0.000483379193

      target function =                  N/A
              le_mean =     -16.906423448361
             les_mean =     286.183647383683
             stat err =       0.000473654954
             autocorr =       1.258642082455
              std dev =       0.597070972869
             le_variance =       0.356493746643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356381557153
                                         uncertainty =       0.016513772507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356381557153
                                         uncertainty =       0.016513772507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422192870
  error estimate for blocks of size 2^( 2) =       0.000434706043
  error estimate for blocks of size 2^( 3) =       0.000448135292
  error estimate for blocks of size 2^( 4) =       0.000460636880
  error estimate for blocks of size 2^( 5) =       0.000470860664
  error estimate for blocks of size 2^( 6) =       0.000479742947
  error estimate for blocks of size 2^( 7) =       0.000483379157

      target function =                  N/A
              le_mean =     -16.906423449128
             les_mean =     286.183647302322
             stat err =       0.000473654912
             autocorr =       1.258642236546
              std dev =       0.597070883021
             le_variance =       0.356493639352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356381463157
                                         uncertainty =       0.016513772273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356381463157
                                         uncertainty =       0.016513772273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422192815
  error estimate for blocks of size 2^( 2) =       0.000434705992
  error estimate for blocks of size 2^( 3) =       0.000448135248
  error estimate for blocks of size 2^( 4) =       0.000460636840
  error estimate for blocks of size 2^( 5) =       0.000470860624
  error estimate for blocks of size 2^( 6) =       0.000479742911
  error estimate for blocks of size 2^( 7) =       0.000483379126

      target function =                  N/A
              le_mean =     -16.906423449801
             les_mean =     286.183647231138
             stat err =       0.000473654875
             autocorr =       1.258642371460
              std dev =       0.597070804357
             le_variance =       0.356493545415


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906423449897        initial  <--
     3.7253e+02     3.7253e+03             8.8632e-07       -16.906423448361
     1.4901e+03     1.4901e+04             2.2161e-07       -16.906423449128
     5.9605e+03     5.9605e+04             5.5403e-08       -16.906423449801

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2706
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9862
    reference variance = 0.349016
====================================================
  Execution time = 2.1379e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3612e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336068273665
                                         uncertainty =       0.003312703174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336068273665
                                         uncertainty =       0.003312703174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409948805
  error estimate for blocks of size 2^( 2) =       0.000422497845
  error estimate for blocks of size 2^( 3) =       0.000435793848
  error estimate for blocks of size 2^( 4) =       0.000448329391
  error estimate for blocks of size 2^( 5) =       0.000458586226
  error estimate for blocks of size 2^( 6) =       0.000466775519
  error estimate for blocks of size 2^( 7) =       0.000474875870

      target function =                  N/A
              le_mean =     -16.906083490313
             les_mean =     286.151774859496
             stat err =       0.000462141751
             autocorr =       1.270840835451
              std dev =       0.579755160500
             le_variance =       0.336116046126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608349031e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906083490313       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906083490633       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906083490507       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906083490578       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906083490757       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906083490725       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906083490704       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906083490686       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 7.886176e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906083490313       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906083490393       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906083490361       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906083490377       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906083490425       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906083490426       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906083490414       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906083490409       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.971568e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906083490313       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906083490333       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906083490325       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906083490366       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906083490347       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906083490363       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906083490395       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906083490366       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 4.928936e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193478 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6987e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046952e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155538e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072260e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647845e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906110e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026346e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957427e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866401e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9983
    reference variance = 0.270903
====================================================
  Execution time = 2.0682e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.6363e-01
  Total weights = 2.0000e+06
  Execution time = 1.8854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363746792847
                                         uncertainty =       0.027699224043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363746792847
                                         uncertainty =       0.027699224043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426395622
  error estimate for blocks of size 2^( 2) =       0.000438490324
  error estimate for blocks of size 2^( 3) =       0.000450987413
  error estimate for blocks of size 2^( 4) =       0.000462836852
  error estimate for blocks of size 2^( 5) =       0.000473289991
  error estimate for blocks of size 2^( 6) =       0.000479268534
  error estimate for blocks of size 2^( 7) =       0.000482881613

      target function =                  N/A
              le_mean =     -16.906638911278
             les_mean =     286.198065547648
             stat err =       0.000474569247
             autocorr =       1.238721597789
              std dev =       0.603014471735
             le_variance =       0.363626453121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363746827536
                                         uncertainty =       0.027699214270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363746827536
                                         uncertainty =       0.027699214270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426395642
  error estimate for blocks of size 2^( 2) =       0.000438490343
  error estimate for blocks of size 2^( 3) =       0.000450987431
  error estimate for blocks of size 2^( 4) =       0.000462836868
  error estimate for blocks of size 2^( 5) =       0.000473290007
  error estimate for blocks of size 2^( 6) =       0.000479268550
  error estimate for blocks of size 2^( 7) =       0.000482881629

      target function =                  N/A
              le_mean =     -16.906638910891
             les_mean =     286.198065569288
             stat err =       0.000474569264
             autocorr =       1.238721565310
              std dev =       0.603014500515
             le_variance =       0.363626487831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363746810193
                                         uncertainty =       0.027699219156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363746810193
                                         uncertainty =       0.027699219156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426395632
  error estimate for blocks of size 2^( 2) =       0.000438490333
  error estimate for blocks of size 2^( 3) =       0.000450987422
  error estimate for blocks of size 2^( 4) =       0.000462836860
  error estimate for blocks of size 2^( 5) =       0.000473289999
  error estimate for blocks of size 2^( 6) =       0.000479268542
  error estimate for blocks of size 2^( 7) =       0.000482881621

      target function =                  N/A
              le_mean =     -16.906638911085
             les_mean =     286.198065558468
             stat err =       0.000474569256
             autocorr =       1.238721581546
              std dev =       0.603014486126
             le_variance =       0.363626470478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363746795015
                                         uncertainty =       0.027699223432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363746795015
                                         uncertainty =       0.027699223432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426395623
  error estimate for blocks of size 2^( 2) =       0.000438490325
  error estimate for blocks of size 2^( 3) =       0.000450987414
  error estimate for blocks of size 2^( 4) =       0.000462836853
  error estimate for blocks of size 2^( 5) =       0.000473289992
  error estimate for blocks of size 2^( 6) =       0.000479268535
  error estimate for blocks of size 2^( 7) =       0.000482881614

      target function =                  N/A
              le_mean =     -16.906638911254
             les_mean =     286.198065549000
             stat err =       0.000474569248
             autocorr =       1.238721595767
              std dev =       0.603014473533
             le_variance =       0.363626455291


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906638911278        initial  <--
     3.7253e+03     3.7253e+04             7.8862e-08       -16.906638910891
     1.4901e+04     1.4901e+05             1.9716e-08       -16.906638911085
     5.9605e+04     5.9605e+05             4.9289e-09       -16.906638911254

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1598
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7182e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9337
    reference variance = 0.186809
====================================================
  Execution time = 2.1044e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3930e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5072e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339299627915
                                         uncertainty =       0.003622776066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339299627915
                                         uncertainty =       0.003622776066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411883214
  error estimate for blocks of size 2^( 2) =       0.000424442963
  error estimate for blocks of size 2^( 3) =       0.000437424581
  error estimate for blocks of size 2^( 4) =       0.000450059432
  error estimate for blocks of size 2^( 5) =       0.000461401262
  error estimate for blocks of size 2^( 6) =       0.000469005469
  error estimate for blocks of size 2^( 7) =       0.000473519831

      target function =                  N/A
              le_mean =     -16.905148972104
             les_mean =     286.123357162851
             stat err =       0.000463496499
             autocorr =       1.266323685145
              std dev =       0.582490826929
             le_variance =       0.339295563457


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690514897210e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905148972104       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905148972134       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905148972135       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905148972127       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905148972132       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905148972136       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905148972128       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905148972128       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 9.157236e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905148972104       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905148972112       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905148972112       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905148972113       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905148972110       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905148972112       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905148972091       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905148972139       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 2.289327e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905148972104       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905148972106       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905148972106       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905148972094       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905148972257       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905148971601       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905148972140       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905148972010       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 5.723325e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196071 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6620e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046948e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9397
    reference variance = 0.458552
====================================================
  Execution time = 2.0385e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4520e-01
  Total weights = 2.0000e+06
  Execution time = 1.8724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345239603183
                                         uncertainty =       0.005032299150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345239603183
                                         uncertainty =       0.005032299150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415450036
  error estimate for blocks of size 2^( 2) =       0.000428161705
  error estimate for blocks of size 2^( 3) =       0.000441307048
  error estimate for blocks of size 2^( 4) =       0.000453718980
  error estimate for blocks of size 2^( 5) =       0.000465378157
  error estimate for blocks of size 2^( 6) =       0.000473440167
  error estimate for blocks of size 2^( 7) =       0.000477769223

      target function =                  N/A
              le_mean =     -16.907029848156
             les_mean =     286.192855579062
             stat err =       0.000467576632
             autocorr =       1.266683152146
              std dev =       0.587535075750
             le_variance =       0.345197465236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345239612285
                                         uncertainty =       0.005032299139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345239612285
                                         uncertainty =       0.005032299139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415450042
  error estimate for blocks of size 2^( 2) =       0.000428161710
  error estimate for blocks of size 2^( 3) =       0.000441307053
  error estimate for blocks of size 2^( 4) =       0.000453718985
  error estimate for blocks of size 2^( 5) =       0.000465378162
  error estimate for blocks of size 2^( 6) =       0.000473440171
  error estimate for blocks of size 2^( 7) =       0.000477769228

      target function =                  N/A
              le_mean =     -16.907029848136
             les_mean =     286.192855587496
             stat err =       0.000467576636
             autocorr =       1.266683143352
              std dev =       0.587535083497
             le_variance =       0.345197474339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345239607734
                                         uncertainty =       0.005032299144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345239607734
                                         uncertainty =       0.005032299144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415450039
  error estimate for blocks of size 2^( 2) =       0.000428161707
  error estimate for blocks of size 2^( 3) =       0.000441307051
  error estimate for blocks of size 2^( 4) =       0.000453718983
  error estimate for blocks of size 2^( 5) =       0.000465378160
  error estimate for blocks of size 2^( 6) =       0.000473440169
  error estimate for blocks of size 2^( 7) =       0.000477769225

      target function =                  N/A
              le_mean =     -16.907029848146
             les_mean =     286.192855583279
             stat err =       0.000467576634
             autocorr =       1.266683147750
              std dev =       0.587535079623
             le_variance =       0.345197469788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345239603752
                                         uncertainty =       0.005032299149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345239603752
                                         uncertainty =       0.005032299149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415450037
  error estimate for blocks of size 2^( 2) =       0.000428161705
  error estimate for blocks of size 2^( 3) =       0.000441307049
  error estimate for blocks of size 2^( 4) =       0.000453718981
  error estimate for blocks of size 2^( 5) =       0.000465378158
  error estimate for blocks of size 2^( 6) =       0.000473440167
  error estimate for blocks of size 2^( 7) =       0.000477769223

      target function =                  N/A
              le_mean =     -16.907029848154
             les_mean =     286.192855579589
             stat err =       0.000467576632
             autocorr =       1.266683151600
              std dev =       0.587535076234
             le_variance =       0.345197465805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907029848156        initial  <--
     3.7253e+04     3.7253e+05             9.1572e-09       -16.907029848136
     1.4901e+05     1.4901e+06             2.2893e-09       -16.907029848146
     5.9605e+05     5.9605e+06             5.7233e-10       -16.907029848154

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.2720
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9911e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8933
    reference variance = 0.358889
====================================================
  Execution time = 2.1082e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3810e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338107439282
                                         uncertainty =       0.002903362483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338107439282
                                         uncertainty =       0.002903362483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411156244
  error estimate for blocks of size 2^( 2) =       0.000424092369
  error estimate for blocks of size 2^( 3) =       0.000436768019
  error estimate for blocks of size 2^( 4) =       0.000450362835
  error estimate for blocks of size 2^( 5) =       0.000462161583
  error estimate for blocks of size 2^( 6) =       0.000473222270
  error estimate for blocks of size 2^( 7) =       0.000480397757

      target function =                  N/A
              le_mean =     -16.905917274382
             les_mean =     286.148137632837
             stat err =       0.000466536111
             autocorr =       1.287528201821
              std dev =       0.581462736246
             le_variance =       0.338098913642


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591727438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905917274382       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905917274387       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905917274387       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905917274388       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905917274388       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905917274215       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905917274636       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905917274074       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 7.853824e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905917274382       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905917274383       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905917274383       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905917274383       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905917274014       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905917273268       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905917274946       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905917274695       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.963457e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905917274382       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905917274382       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905917274382       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905917274382       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905917274343       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905917272857       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905917271931       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905917279284       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 4.908622e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198688 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6765e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8985
    reference variance = 0.406873
====================================================
  Execution time = 2.0623e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3567e-01
  Total weights = 2.0000e+06
  Execution time = 1.8808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335533399101
                                         uncertainty =       0.004006851801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335533399101
                                         uncertainty =       0.004006851801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409674717
  error estimate for blocks of size 2^( 2) =       0.000422798880
  error estimate for blocks of size 2^( 3) =       0.000436235525
  error estimate for blocks of size 2^( 4) =       0.000448423848
  error estimate for blocks of size 2^( 5) =       0.000459952303
  error estimate for blocks of size 2^( 6) =       0.000470087553
  error estimate for blocks of size 2^( 7) =       0.000475929337

      target function =                  N/A
              le_mean =     -16.906551808174
             les_mean =     286.167160622680
             stat err =       0.000463598260
             autocorr =       1.280575739365
              std dev =       0.579367541409
             le_variance =       0.335666748038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335533399499
                                         uncertainty =       0.004006851802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335533399499
                                         uncertainty =       0.004006851802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409674718
  error estimate for blocks of size 2^( 2) =       0.000422798880
  error estimate for blocks of size 2^( 3) =       0.000436235525
  error estimate for blocks of size 2^( 4) =       0.000448423849
  error estimate for blocks of size 2^( 5) =       0.000459952303
  error estimate for blocks of size 2^( 6) =       0.000470087553
  error estimate for blocks of size 2^( 7) =       0.000475929337

      target function =                  N/A
              le_mean =     -16.906551808173
             les_mean =     286.167160623042
             stat err =       0.000463598261
             autocorr =       1.280575738848
              std dev =       0.579367541752
             le_variance =       0.335666748435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335533399300
                                         uncertainty =       0.004006851802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335533399300
                                         uncertainty =       0.004006851802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409674717
  error estimate for blocks of size 2^( 2) =       0.000422798880
  error estimate for blocks of size 2^( 3) =       0.000436235525
  error estimate for blocks of size 2^( 4) =       0.000448423849
  error estimate for blocks of size 2^( 5) =       0.000459952303
  error estimate for blocks of size 2^( 6) =       0.000470087553
  error estimate for blocks of size 2^( 7) =       0.000475929337

      target function =                  N/A
              le_mean =     -16.906551808174
             les_mean =     286.167160622861
             stat err =       0.000463598260
             autocorr =       1.280575739107
              std dev =       0.579367541580
             le_variance =       0.335666748237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335533399126
                                         uncertainty =       0.004006851801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335533399126
                                         uncertainty =       0.004006851801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409674717
  error estimate for blocks of size 2^( 2) =       0.000422798880
  error estimate for blocks of size 2^( 3) =       0.000436235525
  error estimate for blocks of size 2^( 4) =       0.000448423849
  error estimate for blocks of size 2^( 5) =       0.000459952303
  error estimate for blocks of size 2^( 6) =       0.000470087553
  error estimate for blocks of size 2^( 7) =       0.000475929337

      target function =                  N/A
              le_mean =     -16.906551808174
             les_mean =     286.167160622702
             stat err =       0.000463598260
             autocorr =       1.280575739330
              std dev =       0.579367541430
             le_variance =       0.335666748063


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906551808174        initial  <--
     3.7253e+05     3.7253e+06             7.8538e-10       -16.906551808173
     1.4901e+06     1.4901e+07             1.9635e-10       -16.906551808174
     5.9605e+06     5.9605e+07             4.9086e-11       -16.906551808174

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0984
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6908e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9033
    reference variance = 0.176132
====================================================
  Execution time = 2.1161e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4509e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345165247463
                                         uncertainty =       0.004246554202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345165247463
                                         uncertainty =       0.004246554202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415385457
  error estimate for blocks of size 2^( 2) =       0.000427812575
  error estimate for blocks of size 2^( 3) =       0.000440314431
  error estimate for blocks of size 2^( 4) =       0.000451871598
  error estimate for blocks of size 2^( 5) =       0.000461361225
  error estimate for blocks of size 2^( 6) =       0.000467413688
  error estimate for blocks of size 2^( 7) =       0.000471713458

      target function =                  N/A
              le_mean =     -16.905991418313
             les_mean =     286.157635819389
             stat err =       0.000463089992
             autocorr =       1.242877185287
              std dev =       0.587443746977
             le_variance =       0.345090155862


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599141831e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905991418313       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905991418313       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905991418313       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905991420810       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905991418676       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905991416697       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905991418178       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905991418218       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 8.224582e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905991418313       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905991418313       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905991418313       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905991418313       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905991424229       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905991431325       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905991421099       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905991423283       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.056146e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905991418313       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905991418313       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905991418313       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905991407563       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905991407692       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905991398718       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905991482673       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905991387962       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 5.140466e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6741e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9418
    reference variance = 0.136677
====================================================
  Execution time = 2.0924e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4178e-01
  Total weights = 2.0000e+06
  Execution time = 1.8718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341856050770
                                         uncertainty =       0.005193335471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341856050770
                                         uncertainty =       0.005193335471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413386758
  error estimate for blocks of size 2^( 2) =       0.000425380880
  error estimate for blocks of size 2^( 3) =       0.000438222448
  error estimate for blocks of size 2^( 4) =       0.000450312632
  error estimate for blocks of size 2^( 5) =       0.000461452897
  error estimate for blocks of size 2^( 6) =       0.000469543570
  error estimate for blocks of size 2^( 7) =       0.000475285073

      target function =                  N/A
              le_mean =     -16.906176505761
             les_mean =     286.160581096591
             stat err =       0.000464148543
             autocorr =       1.260668383075
              std dev =       0.584617159815
             le_variance =       0.341777223550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341856050776
                                         uncertainty =       0.005193335471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341856050776
                                         uncertainty =       0.005193335471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413386758
  error estimate for blocks of size 2^( 2) =       0.000425380880
  error estimate for blocks of size 2^( 3) =       0.000438222448
  error estimate for blocks of size 2^( 4) =       0.000450312632
  error estimate for blocks of size 2^( 5) =       0.000461452897
  error estimate for blocks of size 2^( 6) =       0.000469543570
  error estimate for blocks of size 2^( 7) =       0.000475285073

      target function =                  N/A
              le_mean =     -16.906176505761
             les_mean =     286.160581096598
             stat err =       0.000464148543
             autocorr =       1.260668383075
              std dev =       0.584617159820
             le_variance =       0.341777223556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341856050773
                                         uncertainty =       0.005193335471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341856050773
                                         uncertainty =       0.005193335471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413386758
  error estimate for blocks of size 2^( 2) =       0.000425380880
  error estimate for blocks of size 2^( 3) =       0.000438222448
  error estimate for blocks of size 2^( 4) =       0.000450312632
  error estimate for blocks of size 2^( 5) =       0.000461452897
  error estimate for blocks of size 2^( 6) =       0.000469543570
  error estimate for blocks of size 2^( 7) =       0.000475285073

      target function =                  N/A
              le_mean =     -16.906176505761
             les_mean =     286.160581096594
             stat err =       0.000464148543
             autocorr =       1.260668383077
              std dev =       0.584617159817
             le_variance =       0.341777223553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341856050770
                                         uncertainty =       0.005193335471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341856050770
                                         uncertainty =       0.005193335471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413386758
  error estimate for blocks of size 2^( 2) =       0.000425380880
  error estimate for blocks of size 2^( 3) =       0.000438222448
  error estimate for blocks of size 2^( 4) =       0.000450312632
  error estimate for blocks of size 2^( 5) =       0.000461452897
  error estimate for blocks of size 2^( 6) =       0.000469543570
  error estimate for blocks of size 2^( 7) =       0.000475285073

      target function =                  N/A
              le_mean =     -16.906176505761
             les_mean =     286.160581096591
             stat err =       0.000464148543
             autocorr =       1.260668383075
              std dev =       0.584617159815
             le_variance =       0.341777223550


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906176505761        initial
     3.7253e+06     3.7253e+07             8.2246e-11       -16.906176505761  <--
     1.4901e+07     1.4901e+08             2.0561e-11       -16.906176505761
     5.9605e+07     5.9605e+08             5.1405e-12       -16.906176505761

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 3.0359e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7140e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.88
    reference variance = 0.152529
====================================================
  Execution time = 2.0959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3777e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337870694592
                                         uncertainty =       0.003864153599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337870694592
                                         uncertainty =       0.003864153599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410954264
  error estimate for blocks of size 2^( 2) =       0.000423806045
  error estimate for blocks of size 2^( 3) =       0.000436249330
  error estimate for blocks of size 2^( 4) =       0.000447508912
  error estimate for blocks of size 2^( 5) =       0.000457870233
  error estimate for blocks of size 2^( 6) =       0.000466432056
  error estimate for blocks of size 2^( 7) =       0.000470143293

      target function =                  N/A
              le_mean =     -16.906417788937
             les_mean =     286.164729099814
             stat err =       0.000460488623
             autocorr =       1.255598614703
              std dev =       0.581177094022
             le_variance =       0.337766814616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641778894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906417788937       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906417788938       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906417788938       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906417789181       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906417788887       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906417788787       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906417788958       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906417789904       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.775827e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906417788937       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906417788937       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906417788937       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906417788937       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906417789333       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906417791286       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906417788992       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906417787538       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 9.439561e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906417788937       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906417788937       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906417788937       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906417789078       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906417787952       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906417786616       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906417794335       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906417780493       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.359886e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6546e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8634
    reference variance = 0.21725
====================================================
  Execution time = 2.0246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4512e-01
  Total weights = 2.0000e+06
  Execution time = 1.8789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345195102858
                                         uncertainty =       0.012493158451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345195102858
                                         uncertainty =       0.012493158451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415402950
  error estimate for blocks of size 2^( 2) =       0.000428037580
  error estimate for blocks of size 2^( 3) =       0.000440263710
  error estimate for blocks of size 2^( 4) =       0.000453096749
  error estimate for blocks of size 2^( 5) =       0.000463472256
  error estimate for blocks of size 2^( 6) =       0.000471871545
  error estimate for blocks of size 2^( 7) =       0.000478377741

      target function =                  N/A
              le_mean =     -16.905943831001
             les_mean =     286.156055866914
             stat err =       0.000466704572
             autocorr =       1.262248775440
              std dev =       0.587468486388
             le_variance =       0.345119222499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345195102873
                                         uncertainty =       0.012493158449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345195102873
                                         uncertainty =       0.012493158449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415402950
  error estimate for blocks of size 2^( 2) =       0.000428037580
  error estimate for blocks of size 2^( 3) =       0.000440263710
  error estimate for blocks of size 2^( 4) =       0.000453096749
  error estimate for blocks of size 2^( 5) =       0.000463472256
  error estimate for blocks of size 2^( 6) =       0.000471871545
  error estimate for blocks of size 2^( 7) =       0.000478377741

      target function =                  N/A
              le_mean =     -16.905943831002
             les_mean =     286.156055866965
             stat err =       0.000466704572
             autocorr =       1.262248775366
              std dev =       0.587468486401
             le_variance =       0.345119222514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345195102866
                                         uncertainty =       0.012493158450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345195102866
                                         uncertainty =       0.012493158450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415402950
  error estimate for blocks of size 2^( 2) =       0.000428037580
  error estimate for blocks of size 2^( 3) =       0.000440263710
  error estimate for blocks of size 2^( 4) =       0.000453096749
  error estimate for blocks of size 2^( 5) =       0.000463472256
  error estimate for blocks of size 2^( 6) =       0.000471871545
  error estimate for blocks of size 2^( 7) =       0.000478377741

      target function =                  N/A
              le_mean =     -16.905943831002
             les_mean =     286.156055866939
             stat err =       0.000466704572
             autocorr =       1.262248775406
              std dev =       0.587468486394
             le_variance =       0.345119222506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345195102859
                                         uncertainty =       0.012493158451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345195102859
                                         uncertainty =       0.012493158451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415402950
  error estimate for blocks of size 2^( 2) =       0.000428037580
  error estimate for blocks of size 2^( 3) =       0.000440263710
  error estimate for blocks of size 2^( 4) =       0.000453096749
  error estimate for blocks of size 2^( 5) =       0.000463472256
  error estimate for blocks of size 2^( 6) =       0.000471871545
  error estimate for blocks of size 2^( 7) =       0.000478377741

      target function =                  N/A
              le_mean =     -16.905943831001
             les_mean =     286.156055866917
             stat err =       0.000466704572
             autocorr =       1.262248775446
              std dev =       0.587468486389
             le_variance =       0.345119222500


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905943831001        initial
     9.3132e+05     9.3132e+06             3.7758e-10       -16.905943831002  <--
     3.7253e+06     3.7253e+07             9.4396e-11       -16.905943831002
     1.4901e+07     1.4901e+08             2.3599e-11       -16.905943831001

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 2.9703e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6279e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9947
    reference variance = 0.275262
====================================================
  Execution time = 2.0853e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3263e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332678318367
                                         uncertainty =       0.002740045078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332678318367
                                         uncertainty =       0.002740045078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407816868
  error estimate for blocks of size 2^( 2) =       0.000420633292
  error estimate for blocks of size 2^( 3) =       0.000433089022
  error estimate for blocks of size 2^( 4) =       0.000445089358
  error estimate for blocks of size 2^( 5) =       0.000455885553
  error estimate for blocks of size 2^( 6) =       0.000462684150
  error estimate for blocks of size 2^( 7) =       0.000468582506

      target function =                  N/A
              le_mean =     -16.906076546525
             les_mean =     286.148053225929
             stat err =       0.000458060392
             autocorr =       1.261580916699
              std dev =       0.576740145363
             le_variance =       0.332629195274


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607654653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906076546525       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906076546528       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906076546530       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906076546447       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906076546493       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906076546567       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906076546352       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906076546634       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.426391e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906076546525       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906076546526       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906076546526       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906076546409       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906076546667       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906076546404       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906076546764       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906076546232       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.565980e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906076546525       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906076546525       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906076546526       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906076546495       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906076545809       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906076546525       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906076547167       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906076546517       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 8.914950e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6436e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647848e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9362
    reference variance = 0.288887
====================================================
  Execution time = 2.1126e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4267e-01
  Total weights = 2.0000e+06
  Execution time = 1.8782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342725525909
                                         uncertainty =       0.006118900390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342725525909
                                         uncertainty =       0.006118900390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413928561
  error estimate for blocks of size 2^( 2) =       0.000426662298
  error estimate for blocks of size 2^( 3) =       0.000439321241
  error estimate for blocks of size 2^( 4) =       0.000450857293
  error estimate for blocks of size 2^( 5) =       0.000460727893
  error estimate for blocks of size 2^( 6) =       0.000466996196
  error estimate for blocks of size 2^( 7) =       0.000470659237

      target function =                  N/A
              le_mean =     -16.905743355936
             les_mean =     286.146831952650
             stat err =       0.000462310155
             autocorr =       1.247429696423
              std dev =       0.585383384817
             le_variance =       0.342673707220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342725526678
                                         uncertainty =       0.006118900410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342725526678
                                         uncertainty =       0.006118900410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413928561
  error estimate for blocks of size 2^( 2) =       0.000426662299
  error estimate for blocks of size 2^( 3) =       0.000439321242
  error estimate for blocks of size 2^( 4) =       0.000450857293
  error estimate for blocks of size 2^( 5) =       0.000460727894
  error estimate for blocks of size 2^( 6) =       0.000466996197
  error estimate for blocks of size 2^( 7) =       0.000470659237

      target function =                  N/A
              le_mean =     -16.905743355941
             les_mean =     286.146831953599
             stat err =       0.000462310155
             autocorr =       1.247429695565
              std dev =       0.585383385473
             le_variance =       0.342673707988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342725526293
                                         uncertainty =       0.006118900400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342725526293
                                         uncertainty =       0.006118900400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413928561
  error estimate for blocks of size 2^( 2) =       0.000426662299
  error estimate for blocks of size 2^( 3) =       0.000439321242
  error estimate for blocks of size 2^( 4) =       0.000450857293
  error estimate for blocks of size 2^( 5) =       0.000460727893
  error estimate for blocks of size 2^( 6) =       0.000466996197
  error estimate for blocks of size 2^( 7) =       0.000470659237

      target function =                  N/A
              le_mean =     -16.905743355938
             les_mean =     286.146831953125
             stat err =       0.000462310155
             autocorr =       1.247429695992
              std dev =       0.585383385145
             le_variance =       0.342673707604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342725525957
                                         uncertainty =       0.006118900391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342725525957
                                         uncertainty =       0.006118900391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413928561
  error estimate for blocks of size 2^( 2) =       0.000426662298
  error estimate for blocks of size 2^( 3) =       0.000439321241
  error estimate for blocks of size 2^( 4) =       0.000450857293
  error estimate for blocks of size 2^( 5) =       0.000460727893
  error estimate for blocks of size 2^( 6) =       0.000466996196
  error estimate for blocks of size 2^( 7) =       0.000470659237

      target function =                  N/A
              le_mean =     -16.905743355936
             les_mean =     286.146831952709
             stat err =       0.000462310155
             autocorr =       1.247429696368
              std dev =       0.585383384858
             le_variance =       0.342673707268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905743355936        initial
     2.3283e+05     2.3283e+06             1.4264e-09       -16.905743355941  <--
     9.3132e+05     9.3132e+06             3.5660e-10       -16.905743355938
     3.7253e+06     3.7253e+07             8.9150e-11       -16.905743355936

*****************************************************************************
Applying the update for shift_i =   2.3283e+05     and shift_s =   2.3283e+06
*****************************************************************************

  Execution time = 3.0593e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647849e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906109e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7037e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8883
    reference variance = 0.19075
====================================================
  Execution time = 2.0746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3161e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331697652925
                                         uncertainty =       0.002625150988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331697652925
                                         uncertainty =       0.002625150988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407192298
  error estimate for blocks of size 2^( 2) =       0.000419668432
  error estimate for blocks of size 2^( 3) =       0.000432321327
  error estimate for blocks of size 2^( 4) =       0.000444649008
  error estimate for blocks of size 2^( 5) =       0.000455218446
  error estimate for blocks of size 2^( 6) =       0.000462847218
  error estimate for blocks of size 2^( 7) =       0.000469993619

      target function =                  N/A
              le_mean =     -16.905972898563
             les_mean =     286.143530616581
             stat err =       0.000458177073
             autocorr =       1.266098797411
              std dev =       0.575856870606
             le_variance =       0.331611135424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597289856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905972898563       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905972898583       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905972898600       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905972898618       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905972898612       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905972898610       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905972898575       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905972898611       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 4.840677e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905972898563       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905972898568       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905972898573       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905972898544       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905972898424       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905972898505       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905972898534       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905972899352       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.210170e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905972898563       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905972898565       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905972898566       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905972898558       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905972898385       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905972898632       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905972897719       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905972897470       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.025425e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209133 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6297e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647849e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906110e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437070e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026348e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8565
    reference variance = 0.225804
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3542e-01
  Total weights = 2.0000e+06
  Execution time = 1.8809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335342620854
                                         uncertainty =       0.003205183696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335342620854
                                         uncertainty =       0.003205183696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409526659
  error estimate for blocks of size 2^( 2) =       0.000422153524
  error estimate for blocks of size 2^( 3) =       0.000435264239
  error estimate for blocks of size 2^( 4) =       0.000447740366
  error estimate for blocks of size 2^( 5) =       0.000458525204
  error estimate for blocks of size 2^( 6) =       0.000467224635
  error estimate for blocks of size 2^( 7) =       0.000472404988

      target function =                  N/A
              le_mean =     -16.906403073415
             les_mean =     286.161888882167
             stat err =       0.000461473798
             autocorr =       1.269783671621
              std dev =       0.579158155532
             le_variance =       0.335424169119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335342621992
                                         uncertainty =       0.003205183712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335342621992
                                         uncertainty =       0.003205183712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409526660
  error estimate for blocks of size 2^( 2) =       0.000422153525
  error estimate for blocks of size 2^( 3) =       0.000435264239
  error estimate for blocks of size 2^( 4) =       0.000447740367
  error estimate for blocks of size 2^( 5) =       0.000458525205
  error estimate for blocks of size 2^( 6) =       0.000467224635
  error estimate for blocks of size 2^( 7) =       0.000472404989

      target function =                  N/A
              le_mean =     -16.906403073434
             les_mean =     286.161888883962
             stat err =       0.000461473799
             autocorr =       1.269783669989
              std dev =       0.579158156514
             le_variance =       0.335424170256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335342621423
                                         uncertainty =       0.003205183704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335342621423
                                         uncertainty =       0.003205183704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409526660
  error estimate for blocks of size 2^( 2) =       0.000422153525
  error estimate for blocks of size 2^( 3) =       0.000435264239
  error estimate for blocks of size 2^( 4) =       0.000447740366
  error estimate for blocks of size 2^( 5) =       0.000458525204
  error estimate for blocks of size 2^( 6) =       0.000467224635
  error estimate for blocks of size 2^( 7) =       0.000472404988

      target function =                  N/A
              le_mean =     -16.906403073424
             les_mean =     286.161888883065
             stat err =       0.000461473799
             autocorr =       1.269783670801
              std dev =       0.579158156023
             le_variance =       0.335424169688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335342620925
                                         uncertainty =       0.003205183697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335342620925
                                         uncertainty =       0.003205183697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409526659
  error estimate for blocks of size 2^( 2) =       0.000422153524
  error estimate for blocks of size 2^( 3) =       0.000435264239
  error estimate for blocks of size 2^( 4) =       0.000447740366
  error estimate for blocks of size 2^( 5) =       0.000458525204
  error estimate for blocks of size 2^( 6) =       0.000467224635
  error estimate for blocks of size 2^( 7) =       0.000472404988

      target function =                  N/A
              le_mean =     -16.906403073416
             les_mean =     286.161888882279
             stat err =       0.000461473798
             autocorr =       1.269783671519
              std dev =       0.579158155593
             le_variance =       0.335424169190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906403073415        initial
     5.8208e+04     5.8208e+05             4.8407e-09       -16.906403073434  <--
     2.3283e+05     2.3283e+06             1.2102e-09       -16.906403073424
     9.3132e+05     9.3132e+06             3.0254e-10       -16.906403073416

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 2.9922e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647849e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906110e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026349e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866399e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6254e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9405
    reference variance = 0.446238
====================================================
  Execution time = 2.3024e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4259e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342512524009
                                         uncertainty =       0.004792442474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342512524009
                                         uncertainty =       0.004792442474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413880853
  error estimate for blocks of size 2^( 2) =       0.000426003305
  error estimate for blocks of size 2^( 3) =       0.000439021267
  error estimate for blocks of size 2^( 4) =       0.000450795566
  error estimate for blocks of size 2^( 5) =       0.000460682316
  error estimate for blocks of size 2^( 6) =       0.000468804152
  error estimate for blocks of size 2^( 7) =       0.000475176864

      target function =                  N/A
              le_mean =     -16.906421615896
             les_mean =     286.169686403729
             stat err =       0.000463864725
             autocorr =       1.256122582720
              std dev =       0.585315915215
             le_variance =       0.342594720604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690642161590e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906421615896       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906421615961       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906421615982       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421616026       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906421616015       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906421616053       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906421616038       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906421616034       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 2.574357e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906421615896       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906421615912       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906421615917       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421615928       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906421615933       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906421615897       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906421615926       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906421615960       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 6.435911e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906421615896       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906421615900       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906421615901       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421615904       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906421615898       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906421615846       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906421616152       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906421615872       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.608979e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211755 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8671e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113092e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155539e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722737e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647850e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906110e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651562e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026351e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866400e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.881
    reference variance = 0.283353
====================================================
  Execution time = 2.0366e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3961e-01
  Total weights = 2.0000e+06
  Execution time = 1.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646223414
                                         uncertainty =       0.004312330142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646223414
                                         uncertainty =       0.004312330142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412071654
  error estimate for blocks of size 2^( 2) =       0.000424411687
  error estimate for blocks of size 2^( 3) =       0.000437354372
  error estimate for blocks of size 2^( 4) =       0.000449975818
  error estimate for blocks of size 2^( 5) =       0.000461820916
  error estimate for blocks of size 2^( 6) =       0.000469028268
  error estimate for blocks of size 2^( 7) =       0.000475825384

      target function =                  N/A
              le_mean =     -16.905376902371
             les_mean =     286.131374137257
             stat err =       0.000464162597
             autocorr =       1.268804763095
              std dev =       0.582757321581
             le_variance =       0.339606095856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646216628
                                         uncertainty =       0.004312329810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646216628
                                         uncertainty =       0.004312329810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412071650
  error estimate for blocks of size 2^( 2) =       0.000424411683
  error estimate for blocks of size 2^( 3) =       0.000437354368
  error estimate for blocks of size 2^( 4) =       0.000449975814
  error estimate for blocks of size 2^( 5) =       0.000461820911
  error estimate for blocks of size 2^( 6) =       0.000469028264
  error estimate for blocks of size 2^( 7) =       0.000475825380

      target function =                  N/A
              le_mean =     -16.905376902488
             les_mean =     286.131374134451
             stat err =       0.000464162592
             autocorr =       1.268804766292
              std dev =       0.582757315762
             le_variance =       0.339606089074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646220021
                                         uncertainty =       0.004312329976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646220021
                                         uncertainty =       0.004312329976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412071652
  error estimate for blocks of size 2^( 2) =       0.000424411685
  error estimate for blocks of size 2^( 3) =       0.000437354370
  error estimate for blocks of size 2^( 4) =       0.000449975816
  error estimate for blocks of size 2^( 5) =       0.000461820913
  error estimate for blocks of size 2^( 6) =       0.000469028266
  error estimate for blocks of size 2^( 7) =       0.000475825382

      target function =                  N/A
              le_mean =     -16.905376902429
             les_mean =     286.131374135854
             stat err =       0.000464162594
             autocorr =       1.268804764696
              std dev =       0.582757318671
             le_variance =       0.339606092465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646222990
                                         uncertainty =       0.004312330121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646222990
                                         uncertainty =       0.004312330121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412071654
  error estimate for blocks of size 2^( 2) =       0.000424411686
  error estimate for blocks of size 2^( 3) =       0.000437354372
  error estimate for blocks of size 2^( 4) =       0.000449975818
  error estimate for blocks of size 2^( 5) =       0.000461820915
  error estimate for blocks of size 2^( 6) =       0.000469028268
  error estimate for blocks of size 2^( 7) =       0.000475825384

      target function =                  N/A
              le_mean =     -16.905376902378
             les_mean =     286.131374137082
             stat err =       0.000464162596
             autocorr =       1.268804763305
              std dev =       0.582757321217
             le_variance =       0.339606095432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905376902371        initial
     1.4552e+04     1.4552e+05             2.5744e-08       -16.905376902488  <--
     5.8208e+04     5.8208e+05             6.4359e-09       -16.905376902429
     2.3283e+05     2.3283e+06             1.6090e-09       -16.905376902378

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 2.9819e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113093e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046949e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155538e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722738e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862619e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647852e-03 1 1  ON 34
eH1_5                 3.817598e-02 1 1  ON 35
eH1_6                 9.661025e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906111e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651561e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026356e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866401e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8500e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.0478
    reference variance = 0.826639
====================================================
  Execution time = 2.0832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3923e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339231238397
                                         uncertainty =       0.004273919815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339231238397
                                         uncertainty =       0.004273919815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411844290
  error estimate for blocks of size 2^( 2) =       0.000423894311
  error estimate for blocks of size 2^( 3) =       0.000436237804
  error estimate for blocks of size 2^( 4) =       0.000448144987
  error estimate for blocks of size 2^( 5) =       0.000459589992
  error estimate for blocks of size 2^( 6) =       0.000467538466
  error estimate for blocks of size 2^( 7) =       0.000472691620

      target function =                  N/A
              le_mean =     -16.905746532376
             les_mean =     286.143497086045
             stat err =       0.000461991266
             autocorr =       1.258349939106
              std dev =       0.582435780773
             le_variance =       0.339231438725


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574653238e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746532376       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905746532324       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905746532642       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905746532740       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905746532756       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905746532756       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905746532797       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905746532829       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 8.722799e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746532376       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905746532363       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905746532442       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905746532469       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905746532464       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905746532486       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905746532482       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905746532489       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 2.180723e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746532376       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905746532373       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905746532392       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905746532399       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905746532414       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905746532411       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905746532401       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905746532370       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 5.451823e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6474e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113094e-02 1 1  ON 2
 uu_3                -2.116952e-02 1 1  ON 3
 uu_4                -6.670607e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421850e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308900e-02 1 1  ON 12
 ud_3                -8.046950e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155538e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072260e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722739e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862619e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647853e-03 1 1  ON 34
eH1_5                 3.817598e-02 1 1  ON 35
eH1_6                 9.661025e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906112e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651561e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026360e-03 1 1  ON 44
eH2_5                 4.033462e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866402e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9246
    reference variance = 0.415806
====================================================
  Execution time = 2.0764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3862e-01
  Total weights = 2.0000e+06
  Execution time = 1.8702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338715955315
                                         uncertainty =       0.003652223971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338715955315
                                         uncertainty =       0.003652223971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411471992
  error estimate for blocks of size 2^( 2) =       0.000424233572
  error estimate for blocks of size 2^( 3) =       0.000437583659
  error estimate for blocks of size 2^( 4) =       0.000449144382
  error estimate for blocks of size 2^( 5) =       0.000460144591
  error estimate for blocks of size 2^( 6) =       0.000469197579
  error estimate for blocks of size 2^( 7) =       0.000473606589

      target function =                  N/A
              le_mean =     -16.905823248282
             les_mean =     286.145477933179
             stat err =       0.000463023285
             autocorr =       1.266266466145
              std dev =       0.581909271559
             le_variance =       0.338618400326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338715985220
                                         uncertainty =       0.003652224196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338715985220
                                         uncertainty =       0.003652224196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411472010
  error estimate for blocks of size 2^( 2) =       0.000424233589
  error estimate for blocks of size 2^( 3) =       0.000437583674
  error estimate for blocks of size 2^( 4) =       0.000449144397
  error estimate for blocks of size 2^( 5) =       0.000460144605
  error estimate for blocks of size 2^( 6) =       0.000469197594
  error estimate for blocks of size 2^( 7) =       0.000473606602

      target function =                  N/A
              le_mean =     -16.905823248188
             les_mean =     286.145477959879
             stat err =       0.000463023299
             autocorr =       1.266266431958
              std dev =       0.581909297244
             le_variance =       0.338618430219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338715970269
                                         uncertainty =       0.003652224084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338715970269
                                         uncertainty =       0.003652224084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411472001
  error estimate for blocks of size 2^( 2) =       0.000424233580
  error estimate for blocks of size 2^( 3) =       0.000437583666
  error estimate for blocks of size 2^( 4) =       0.000449144389
  error estimate for blocks of size 2^( 5) =       0.000460144598
  error estimate for blocks of size 2^( 6) =       0.000469197586
  error estimate for blocks of size 2^( 7) =       0.000473606595

      target function =                  N/A
              le_mean =     -16.905823248235
             les_mean =     286.145477946529
             stat err =       0.000463023292
             autocorr =       1.266266449059
              std dev =       0.581909284402
             le_variance =       0.338618415274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338715957185
                                         uncertainty =       0.003652223985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338715957185
                                         uncertainty =       0.003652223985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411471993
  error estimate for blocks of size 2^( 2) =       0.000424233573
  error estimate for blocks of size 2^( 3) =       0.000437583660
  error estimate for blocks of size 2^( 4) =       0.000449144383
  error estimate for blocks of size 2^( 5) =       0.000460144592
  error estimate for blocks of size 2^( 6) =       0.000469197580
  error estimate for blocks of size 2^( 7) =       0.000473606589

      target function =                  N/A
              le_mean =     -16.905823248276
             les_mean =     286.145477934848
             stat err =       0.000463023286
             autocorr =       1.266266464011
              std dev =       0.581909273164
             le_variance =       0.338618402195


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905823248282        initial  <--
     3.6380e+03     3.6380e+04             8.7228e-08       -16.905823248188
     1.4552e+04     1.4552e+05             2.1807e-08       -16.905823248235
     5.8208e+04     5.8208e+05             5.4518e-09       -16.905823248276

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2001
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113093e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046949e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155538e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722738e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862619e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647852e-03 1 1  ON 34
eH1_5                 3.817598e-02 1 1  ON 35
eH1_6                 9.661025e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906111e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651561e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026356e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866401e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6688e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8562
    reference variance = 0.218225
====================================================
  Execution time = 2.1250e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4611e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346295207217
                                         uncertainty =       0.008546501418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346295207217
                                         uncertainty =       0.008546501418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415998926
  error estimate for blocks of size 2^( 2) =       0.000427876610
  error estimate for blocks of size 2^( 3) =       0.000440530176
  error estimate for blocks of size 2^( 4) =       0.000452388431
  error estimate for blocks of size 2^( 5) =       0.000462170491
  error estimate for blocks of size 2^( 6) =       0.000469244662
  error estimate for blocks of size 2^( 7) =       0.000472551762

      target function =                  N/A
              le_mean =     -16.906743914884
             les_mean =     286.184099842754
             stat err =       0.000464088837
             autocorr =       1.244565693290
              std dev =       0.588311322645
             le_variance =       0.346110212352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690674391488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906743914884       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906743914939       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906743914967       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906743914958       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906743914948       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906743914953       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906743914941       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906743914957       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 7.675369e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906743914884       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906743914898       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906743914904       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906743914902       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906743914918       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906743914955       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906743914879       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906743914925       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.918845e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906743914884       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906743914887       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906743914889       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906743914888       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906743914757       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906743914910       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906743914360       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906743914104       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 4.797116e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6822e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113093e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421849e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046948e-03 1 1  ON 13
 ud_4                -6.536493e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155538e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722738e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862619e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647852e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661025e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906111e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651561e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026356e-03 1 1  ON 44
eH2_5                 4.033462e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866401e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8521
    reference variance = 0.397904
====================================================
  Execution time = 2.0741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4439e-01
  Total weights = 2.0000e+06
  Execution time = 1.8810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344327453438
                                         uncertainty =       0.005010761461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344327453438
                                         uncertainty =       0.005010761461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414961430
  error estimate for blocks of size 2^( 2) =       0.000427228964
  error estimate for blocks of size 2^( 3) =       0.000439285123
  error estimate for blocks of size 2^( 4) =       0.000450191432
  error estimate for blocks of size 2^( 5) =       0.000459540722
  error estimate for blocks of size 2^( 6) =       0.000467549238
  error estimate for blocks of size 2^( 7) =       0.000471993316

      target function =                  N/A
              le_mean =     -16.905682106862
             les_mean =     286.146473302389
             stat err =       0.000462318677
             autocorr =       1.241273302702
              std dev =       0.586844081770
             le_variance =       0.344385976309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344327459553
                                         uncertainty =       0.005010761507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344327459553
                                         uncertainty =       0.005010761507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414961433
  error estimate for blocks of size 2^( 2) =       0.000427228968
  error estimate for blocks of size 2^( 3) =       0.000439285126
  error estimate for blocks of size 2^( 4) =       0.000450191435
  error estimate for blocks of size 2^( 5) =       0.000459540725
  error estimate for blocks of size 2^( 6) =       0.000467549240
  error estimate for blocks of size 2^( 7) =       0.000471993319

      target function =                  N/A
              le_mean =     -16.905682106905
             les_mean =     286.146473309965
             stat err =       0.000462318680
             autocorr =       1.241273295170
              std dev =       0.586844086980
             le_variance =       0.344385982424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344327456496
                                         uncertainty =       0.005010761484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344327456496
                                         uncertainty =       0.005010761484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414961432
  error estimate for blocks of size 2^( 2) =       0.000427228966
  error estimate for blocks of size 2^( 3) =       0.000439285125
  error estimate for blocks of size 2^( 4) =       0.000450191433
  error estimate for blocks of size 2^( 5) =       0.000459540724
  error estimate for blocks of size 2^( 6) =       0.000467549239
  error estimate for blocks of size 2^( 7) =       0.000471993318

      target function =                  N/A
              le_mean =     -16.905682106884
             les_mean =     286.146473306177
             stat err =       0.000462318678
             autocorr =       1.241273298932
              std dev =       0.586844084375
             le_variance =       0.344385979367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344327453820
                                         uncertainty =       0.005010761464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344327453820
                                         uncertainty =       0.005010761464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414961430
  error estimate for blocks of size 2^( 2) =       0.000427228964
  error estimate for blocks of size 2^( 3) =       0.000439285124
  error estimate for blocks of size 2^( 4) =       0.000450191432
  error estimate for blocks of size 2^( 5) =       0.000459540722
  error estimate for blocks of size 2^( 6) =       0.000467549238
  error estimate for blocks of size 2^( 7) =       0.000471993316

      target function =                  N/A
              le_mean =     -16.905682106865
             les_mean =     286.146473302863
             stat err =       0.000462318677
             autocorr =       1.241273302237
              std dev =       0.586844082096
             le_variance =       0.344385976691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905682106862        initial
     3.6380e+04     3.6380e+05             7.6754e-09       -16.905682106905  <--
     1.4552e+05     1.4552e+06             1.9188e-09       -16.905682106884
     5.8208e+05     5.8208e+06             4.7971e-10       -16.905682106865

*****************************************************************************
Applying the update for shift_i =   3.6380e+04     and shift_s =   3.6380e+05
*****************************************************************************

  Execution time = 3.0216e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113094e-02 1 1  ON 2
 uu_3                -2.116951e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421850e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046947e-03 1 1  ON 13
 ud_4                -6.536494e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155538e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722738e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862619e-02 1 1  ON 32
eH1_3                -4.463083e-02 1 1  ON 33
eH1_4                 3.647853e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906111e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651561e-02 1 1  ON 42
eH2_3                -4.241431e-02 1 1  ON 43
eH2_4                 6.026356e-03 1 1  ON 44
eH2_5                 4.033462e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866401e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7151e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8565
    reference variance = 0.173205
====================================================
  Execution time = 2.0578e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3190e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331874421649
                                         uncertainty =       0.003241108792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331874421649
                                         uncertainty =       0.003241108792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407367486
  error estimate for blocks of size 2^( 2) =       0.000419908791
  error estimate for blocks of size 2^( 3) =       0.000433096322
  error estimate for blocks of size 2^( 4) =       0.000445888216
  error estimate for blocks of size 2^( 5) =       0.000456518401
  error estimate for blocks of size 2^( 6) =       0.000464670085
  error estimate for blocks of size 2^( 7) =       0.000468941286

      target function =                  N/A
              le_mean =     -16.906500322330
             les_mean =     286.161649520405
             stat err =       0.000459004497
             autocorr =       1.269583165559
              std dev =       0.576104623670
             le_variance =       0.331896537414


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650032233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906500322330       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906500322502       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906500322544       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906500322536       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906500322511       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906500322542       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906500322567       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906500322558       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 3.574450e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906500322330       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906500322373       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906500322383       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906500322363       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906500322373       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906500322366       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906500322396       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906500322402       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 8.936163e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906500322330       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906500322341       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906500322343       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906500322343       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906500322358       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906500322347       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906500322365       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906500322400       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.234043e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6125e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113094e-02 1 1  ON 2
 uu_3                -2.116952e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421850e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308899e-02 1 1  ON 12
 ud_3                -8.046949e-03 1 1  ON 13
 ud_4                -6.536494e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155538e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722738e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647854e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906112e-02 1 1  ON 39
eH2_0                -2.445696e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651561e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026358e-03 1 1  ON 44
eH2_5                 4.033462e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866402e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9109
    reference variance = 0.827495
====================================================
  Execution time = 2.1322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3739e-01
  Total weights = 2.0000e+06
  Execution time = 1.8789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337385761890
                                         uncertainty =       0.004203579745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337385761890
                                         uncertainty =       0.004203579745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410724082
  error estimate for blocks of size 2^( 2) =       0.000423362707
  error estimate for blocks of size 2^( 3) =       0.000435706069
  error estimate for blocks of size 2^( 4) =       0.000446971848
  error estimate for blocks of size 2^( 5) =       0.000457399248
  error estimate for blocks of size 2^( 6) =       0.000464502227
  error estimate for blocks of size 2^( 7) =       0.000468423761

      target function =                  N/A
              le_mean =     -16.906195757068
             les_mean =     286.156843350414
             stat err =       0.000459324271
             autocorr =       1.250657678988
              std dev =       0.580851566935
             le_variance =       0.337388542811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337385768925
                                         uncertainty =       0.004203579834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337385768925
                                         uncertainty =       0.004203579834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410724086
  error estimate for blocks of size 2^( 2) =       0.000423362711
  error estimate for blocks of size 2^( 3) =       0.000435706073
  error estimate for blocks of size 2^( 4) =       0.000446971851
  error estimate for blocks of size 2^( 5) =       0.000457399251
  error estimate for blocks of size 2^( 6) =       0.000464502229
  error estimate for blocks of size 2^( 7) =       0.000468423764

      target function =                  N/A
              le_mean =     -16.906195757186
             les_mean =     286.156843361435
             stat err =       0.000459324274
             autocorr =       1.250657669398
              std dev =       0.580851572988
             le_variance =       0.337388549843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337385765407
                                         uncertainty =       0.004203579789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337385765407
                                         uncertainty =       0.004203579789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410724084
  error estimate for blocks of size 2^( 2) =       0.000423362709
  error estimate for blocks of size 2^( 3) =       0.000435706071
  error estimate for blocks of size 2^( 4) =       0.000446971850
  error estimate for blocks of size 2^( 5) =       0.000457399249
  error estimate for blocks of size 2^( 6) =       0.000464502228
  error estimate for blocks of size 2^( 7) =       0.000468423763

      target function =                  N/A
              le_mean =     -16.906195757127
             les_mean =     286.156843355925
             stat err =       0.000459324273
             autocorr =       1.250657674189
              std dev =       0.580851569962
             le_variance =       0.337388546327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337385762330
                                         uncertainty =       0.004203579750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337385762330
                                         uncertainty =       0.004203579750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410724082
  error estimate for blocks of size 2^( 2) =       0.000423362707
  error estimate for blocks of size 2^( 3) =       0.000435706070
  error estimate for blocks of size 2^( 4) =       0.000446971848
  error estimate for blocks of size 2^( 5) =       0.000457399248
  error estimate for blocks of size 2^( 6) =       0.000464502227
  error estimate for blocks of size 2^( 7) =       0.000468423762

      target function =                  N/A
              le_mean =     -16.906195757075
             les_mean =     286.156843351103
             stat err =       0.000459324271
             autocorr =       1.250657678394
              std dev =       0.580851567314
             le_variance =       0.337388543251


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906195757068        initial
     9.0949e+03     9.0949e+04             3.5744e-08       -16.906195757186  <--
     3.6380e+04     3.6380e+05             8.9362e-09       -16.906195757127
     1.4552e+05     1.4552e+06             2.2340e-09       -16.906195757075

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 3.0799e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113094e-02 1 1  ON 2
 uu_3                -2.116952e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421850e-01 1 1  ON 7
 uu_8                -1.341888e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308897e-02 1 1  ON 12
 ud_3                -8.046952e-03 1 1  ON 13
 ud_4                -6.536495e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155537e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722739e-02 1 1  ON 29
eH1_0                -2.467288e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463085e-02 1 1  ON 33
eH1_4                 3.647856e-03 1 1  ON 34
eH1_5                 3.817597e-02 1 1  ON 35
eH1_6                 9.661024e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906114e-02 1 1  ON 39
eH2_0                -2.445697e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651559e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026364e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957427e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866404e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7127e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9393
    reference variance = 0.169725
====================================================
  Execution time = 2.0791e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4165e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341572792971
                                         uncertainty =       0.003254391080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341572792971
                                         uncertainty =       0.003254391080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413307567
  error estimate for blocks of size 2^( 2) =       0.000425979002
  error estimate for blocks of size 2^( 3) =       0.000439255744
  error estimate for blocks of size 2^( 4) =       0.000451561941
  error estimate for blocks of size 2^( 5) =       0.000461971807
  error estimate for blocks of size 2^( 6) =       0.000469150536
  error estimate for blocks of size 2^( 7) =       0.000472590767

      target function =                  N/A
              le_mean =     -16.906712488118
             les_mean =     286.178573274841
             stat err =       0.000463818763
             autocorr =       1.259360052930
              std dev =       0.584505166588
             le_variance =       0.341646289769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690671248812e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906712488118       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906712488182       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906712488119       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906712488171       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906712488057       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906712488074       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906712488224       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906712488248       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.338211e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906712488118       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906712488134       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906712488118       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906712488129       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906712488103       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906712488109       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906712488159       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906712488150       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 3.345594e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906712488118       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906712488122       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906712488118       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906712488122       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906712488114       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906712488095       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906712488116       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906712488100       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 8.364026e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6394e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427842e-01 1 1  ON 1
 uu_2                 4.113095e-02 1 1  ON 2
 uu_3                -2.116952e-02 1 1  ON 3
 uu_4                -6.670607e-02 1 1  ON 4
 uu_5                -1.014299e-01 1 1  ON 5
 uu_6                -1.284664e-01 1 1  ON 6
 uu_7                -1.421850e-01 1 1  ON 7
 uu_8                -1.341889e-01 1 1  ON 8
 uu_9                -1.054333e-01 1 1  ON 9
 ud_0                 4.489267e-01 1 1  ON 10
 ud_1                 1.833722e-01 1 1  ON 11
 ud_2                 6.308898e-02 1 1  ON 12
 ud_3                -8.046959e-03 1 1  ON 13
 ud_4                -6.536496e-02 1 1  ON 14
 ud_5                -1.073126e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523589e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432541e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155536e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879563e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072259e-02 1 1  ON 27
 eO_8                -2.220102e-01 1 1  ON 28
 eO_9                -8.722741e-02 1 1  ON 29
eH1_0                -2.467289e-01 1 1  ON 30
eH1_1                -1.459126e-01 1 1  ON 31
eH1_2                -9.862618e-02 1 1  ON 32
eH1_3                -4.463085e-02 1 1  ON 33
eH1_4                 3.647866e-03 1 1  ON 34
eH1_5                 3.817598e-02 1 1  ON 35
eH1_6                 9.661025e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906116e-02 1 1  ON 39
eH2_0                -2.445697e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651559e-02 1 1  ON 42
eH2_3                -4.241432e-02 1 1  ON 43
eH2_4                 6.026366e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957428e-02 1 1  ON 46
eH2_7                 1.556666e-01 1 1  ON 47
eH2_8                 1.833713e-01 1 1  ON 48
eH2_9                 5.866406e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.0334
    reference variance = 2.03784
====================================================
  Execution time = 2.0700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4222e-01
  Total weights = 2.0000e+06
  Execution time = 1.8772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342108244541
                                         uncertainty =       0.004457456706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342108244541
                                         uncertainty =       0.004457456706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413651822
  error estimate for blocks of size 2^( 2) =       0.000425813320
  error estimate for blocks of size 2^( 3) =       0.000439341775
  error estimate for blocks of size 2^( 4) =       0.000451024009
  error estimate for blocks of size 2^( 5) =       0.000461619257
  error estimate for blocks of size 2^( 6) =       0.000468783927
  error estimate for blocks of size 2^( 7) =       0.000475019710

      target function =                  N/A
              le_mean =     -16.905961208918
             les_mean =     286.153739886086
             stat err =       0.000464111726
             autocorr =       1.258853520360
              std dev =       0.584992016825
             le_variance =       0.342215659750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342108215918
                                         uncertainty =       0.004457456348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342108215918
                                         uncertainty =       0.004457456348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413651805
  error estimate for blocks of size 2^( 2) =       0.000425813303
  error estimate for blocks of size 2^( 3) =       0.000439341758
  error estimate for blocks of size 2^( 4) =       0.000451023992
  error estimate for blocks of size 2^( 5) =       0.000461619240
  error estimate for blocks of size 2^( 6) =       0.000468783910
  error estimate for blocks of size 2^( 7) =       0.000475019693

      target function =                  N/A
              le_mean =     -16.905961209561
             les_mean =     286.153739879145
             stat err =       0.000464111709
             autocorr =       1.258853533249
              std dev =       0.584991992321
             le_variance =       0.342215631080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342108230226
                                         uncertainty =       0.004457456527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342108230226
                                         uncertainty =       0.004457456527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413651813
  error estimate for blocks of size 2^( 2) =       0.000425813311
  error estimate for blocks of size 2^( 3) =       0.000439341766
  error estimate for blocks of size 2^( 4) =       0.000451024000
  error estimate for blocks of size 2^( 5) =       0.000461619248
  error estimate for blocks of size 2^( 6) =       0.000468783919
  error estimate for blocks of size 2^( 7) =       0.000475019702

      target function =                  N/A
              le_mean =     -16.905961209239
             les_mean =     286.153739882613
             stat err =       0.000464111717
             autocorr =       1.258853526804
              std dev =       0.584992004571
             le_variance =       0.342215645411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342108242751
                                         uncertainty =       0.004457456684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342108242751
                                         uncertainty =       0.004457456684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413651821
  error estimate for blocks of size 2^( 2) =       0.000425813319
  error estimate for blocks of size 2^( 3) =       0.000439341774
  error estimate for blocks of size 2^( 4) =       0.000451024008
  error estimate for blocks of size 2^( 5) =       0.000461619256
  error estimate for blocks of size 2^( 6) =       0.000468783926
  error estimate for blocks of size 2^( 7) =       0.000475019709

      target function =                  N/A
              le_mean =     -16.905961208958
             les_mean =     286.153739885652
             stat err =       0.000464111725
             autocorr =       1.258853521160
              std dev =       0.584992015294
             le_variance =       0.342215657957


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905961208918        initial
     2.2737e+03     2.2737e+04             1.3382e-07       -16.905961209561  <--
     9.0949e+03     9.0949e+04             3.3456e-08       -16.905961209239
     3.6380e+04     3.6380e+05             8.3640e-09       -16.905961208958

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 3.0163e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427843e-01 1 1  ON 1
 uu_2                 4.113097e-02 1 1  ON 2
 uu_3                -2.116950e-02 1 1  ON 3
 uu_4                -6.670604e-02 1 1  ON 4
 uu_5                -1.014298e-01 1 1  ON 5
 uu_6                -1.284665e-01 1 1  ON 6
 uu_7                -1.421850e-01 1 1  ON 7
 uu_8                -1.341889e-01 1 1  ON 8
 uu_9                -1.054334e-01 1 1  ON 9
 ud_0                 4.489268e-01 1 1  ON 10
 ud_1                 1.833723e-01 1 1  ON 11
 ud_2                 6.308901e-02 1 1  ON 12
 ud_3                -8.046977e-03 1 1  ON 13
 ud_4                -6.536499e-02 1 1  ON 14
 ud_5                -1.073127e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523588e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432542e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155533e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879564e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072257e-02 1 1  ON 27
 eO_8                -2.220103e-01 1 1  ON 28
 eO_9                -8.722746e-02 1 1  ON 29
eH1_0                -2.467290e-01 1 1  ON 30
eH1_1                -1.459127e-01 1 1  ON 31
eH1_2                -9.862617e-02 1 1  ON 32
eH1_3                -4.463086e-02 1 1  ON 33
eH1_4                 3.647894e-03 1 1  ON 34
eH1_5                 3.817601e-02 1 1  ON 35
eH1_6                 9.661026e-02 1 1  ON 36
eH1_7                 1.542963e-01 1 1  ON 37
eH1_8                 1.780651e-01 1 1  ON 38
eH1_9                 6.906121e-02 1 1  ON 39
eH2_0                -2.445698e-01 1 1  ON 40
eH2_1                -1.437071e-01 1 1  ON 41
eH2_2                -9.651559e-02 1 1  ON 42
eH2_3                -4.241433e-02 1 1  ON 43
eH2_4                 6.026371e-03 1 1  ON 44
eH2_5                 4.033461e-02 1 1  ON 45
eH2_6                 9.957431e-02 1 1  ON 46
eH2_7                 1.556667e-01 1 1  ON 47
eH2_8                 1.833714e-01 1 1  ON 48
eH2_9                 5.866412e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6656e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9487
    reference variance = 0.325296
====================================================
  Execution time = 2.0762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3556e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335551991720
                                         uncertainty =       0.003373304667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335551991720
                                         uncertainty =       0.003373304667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409612292
  error estimate for blocks of size 2^( 2) =       0.000422648792
  error estimate for blocks of size 2^( 3) =       0.000435432041
  error estimate for blocks of size 2^( 4) =       0.000446642574
  error estimate for blocks of size 2^( 5) =       0.000456439512
  error estimate for blocks of size 2^( 6) =       0.000462524361
  error estimate for blocks of size 2^( 7) =       0.000467019756

      target function =                  N/A
              le_mean =     -16.906142842843
             les_mean =     286.153230114269
             stat err =       0.000458156551
             autocorr =       1.251070661284
              std dev =       0.579279258588
             le_variance =       0.335564459430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614284284e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906142842843       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906142843602       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906142841304       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906142841481       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906142843071       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906142843386       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906142843396       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906142843370       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 5.174213e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906142842843       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906142843033       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906142842458       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906142842503       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906142842900       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906142842979       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906142842981       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906142842974       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.293601e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906142842843       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906142842891       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906142842747       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906142842758       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906142842859       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906142842878       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906142842880       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906142842876       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 3.234032e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6803e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427843e-01 1 1  ON 1
 uu_2                 4.113102e-02 1 1  ON 2
 uu_3                -2.116952e-02 1 1  ON 3
 uu_4                -6.670605e-02 1 1  ON 4
 uu_5                -1.014298e-01 1 1  ON 5
 uu_6                -1.284665e-01 1 1  ON 6
 uu_7                -1.421850e-01 1 1  ON 7
 uu_8                -1.341889e-01 1 1  ON 8
 uu_9                -1.054334e-01 1 1  ON 9
 ud_0                 4.489269e-01 1 1  ON 10
 ud_1                 1.833723e-01 1 1  ON 11
 ud_2                 6.308901e-02 1 1  ON 12
 ud_3                -8.046992e-03 1 1  ON 13
 ud_4                -6.536501e-02 1 1  ON 14
 ud_5                -1.073127e-01 1 1  ON 15
 ud_6                -1.353559e-01 1 1  ON 16
 ud_7                -1.523588e-01 1 1  ON 17
 ud_8                -1.530469e-01 1 1  ON 18
 ud_9                -1.432542e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155529e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258099e-01 1 1  ON 24
 eO_5                 4.879564e-01 1 1  ON 25
 eO_6                 2.602744e-01 1 1  ON 26
 eO_7                -4.072256e-02 1 1  ON 27
 eO_8                -2.220103e-01 1 1  ON 28
 eO_9                -8.722752e-02 1 1  ON 29
eH1_0                -2.467291e-01 1 1  ON 30
eH1_1                -1.459128e-01 1 1  ON 31
eH1_2                -9.862616e-02 1 1  ON 32
eH1_3                -4.463084e-02 1 1  ON 33
eH1_4                 3.647925e-03 1 1  ON 34
eH1_5                 3.817600e-02 1 1  ON 35
eH1_6                 9.661025e-02 1 1  ON 36
eH1_7                 1.542963e-01 1 1  ON 37
eH1_8                 1.780652e-01 1 1  ON 38
eH1_9                 6.906127e-02 1 1  ON 39
eH2_0                -2.445699e-01 1 1  ON 40
eH2_1                -1.437072e-01 1 1  ON 41
eH2_2                -9.651563e-02 1 1  ON 42
eH2_3                -4.241429e-02 1 1  ON 43
eH2_4                 6.026395e-03 1 1  ON 44
eH2_5                 4.033462e-02 1 1  ON 45
eH2_6                 9.957430e-02 1 1  ON 46
eH2_7                 1.556667e-01 1 1  ON 47
eH2_8                 1.833714e-01 1 1  ON 48
eH2_9                 5.866420e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9692
    reference variance = 0.210573
====================================================
  Execution time = 2.1101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4516e-01
  Total weights = 2.0000e+06
  Execution time = 1.8737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345098674478
                                         uncertainty =       0.004538807233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345098674478
                                         uncertainty =       0.004538807233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415426008
  error estimate for blocks of size 2^( 2) =       0.000428046155
  error estimate for blocks of size 2^( 3) =       0.000441011964
  error estimate for blocks of size 2^( 4) =       0.000452590031
  error estimate for blocks of size 2^( 5) =       0.000462606838
  error estimate for blocks of size 2^( 6) =       0.000469565716
  error estimate for blocks of size 2^( 7) =       0.000475115206

      target function =                  N/A
              le_mean =     -16.906914722078
             les_mean =     286.188922783451
             stat err =       0.000464969448
             autocorr =       1.252741513320
              std dev =       0.587501094811
             le_variance =       0.345157536404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345098928235
                                         uncertainty =       0.004538808534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345098928235
                                         uncertainty =       0.004538808534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415426161
  error estimate for blocks of size 2^( 2) =       0.000428046295
  error estimate for blocks of size 2^( 3) =       0.000441012090
  error estimate for blocks of size 2^( 4) =       0.000452590145
  error estimate for blocks of size 2^( 5) =       0.000462606947
  error estimate for blocks of size 2^( 6) =       0.000469565824
  error estimate for blocks of size 2^( 7) =       0.000475115325

      target function =                  N/A
              le_mean =     -16.906914723384
             les_mean =     286.188923081654
             stat err =       0.000464969560
             autocorr =       1.252741197447
              std dev =       0.587501311035
             le_variance =       0.345157790467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345098801394
                                         uncertainty =       0.004538807883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345098801394
                                         uncertainty =       0.004538807883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415426085
  error estimate for blocks of size 2^( 2) =       0.000428046225
  error estimate for blocks of size 2^( 3) =       0.000441012027
  error estimate for blocks of size 2^( 4) =       0.000452590088
  error estimate for blocks of size 2^( 5) =       0.000462606892
  error estimate for blocks of size 2^( 6) =       0.000469565770
  error estimate for blocks of size 2^( 7) =       0.000475115265

      target function =                  N/A
              le_mean =     -16.906914722731
             les_mean =     286.188922932601
             stat err =       0.000464969504
             autocorr =       1.252741355327
              std dev =       0.587501202955
             le_variance =       0.345157663474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345098690344
                                         uncertainty =       0.004538807314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345098690344
                                         uncertainty =       0.004538807314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415426018
  error estimate for blocks of size 2^( 2) =       0.000428046163
  error estimate for blocks of size 2^( 3) =       0.000441011971
  error estimate for blocks of size 2^( 4) =       0.000452590038
  error estimate for blocks of size 2^( 5) =       0.000462606845
  error estimate for blocks of size 2^( 6) =       0.000469565723
  error estimate for blocks of size 2^( 7) =       0.000475115213

      target function =                  N/A
              le_mean =     -16.906914722160
             les_mean =     286.188922802096
             stat err =       0.000464969455
             autocorr =       1.252741493579
              std dev =       0.587501108330
             le_variance =       0.345157552289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906914722078        initial
     5.6843e+02     5.6843e+03             5.1742e-07       -16.906914723384  <--
     2.2737e+03     2.2737e+04             1.2936e-07       -16.906914722731
     9.0949e+03     9.0949e+04             3.2340e-08       -16.906914722160

*****************************************************************************
Applying the update for shift_i =   5.6843e+02     and shift_s =   5.6843e+03
*****************************************************************************

  Execution time = 3.0646e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427843e-01 1 1  ON 1
 uu_2                 4.113117e-02 1 1  ON 2
 uu_3                -2.116956e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014298e-01 1 1  ON 5
 uu_6                -1.284667e-01 1 1  ON 6
 uu_7                -1.421851e-01 1 1  ON 7
 uu_8                -1.341890e-01 1 1  ON 8
 uu_9                -1.054335e-01 1 1  ON 9
 ud_0                 4.489272e-01 1 1  ON 10
 ud_1                 1.833724e-01 1 1  ON 11
 ud_2                 6.308901e-02 1 1  ON 12
 ud_3                -8.047038e-03 1 1  ON 13
 ud_4                -6.536504e-02 1 1  ON 14
 ud_5                -1.073128e-01 1 1  ON 15
 ud_6                -1.353558e-01 1 1  ON 16
 ud_7                -1.523588e-01 1 1  ON 17
 ud_8                -1.530470e-01 1 1  ON 18
 ud_9                -1.432543e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393160e-01 1 1  ON 21
 eO_2                -2.155516e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258100e-01 1 1  ON 24
 eO_5                 4.879564e-01 1 1  ON 25
 eO_6                 2.602745e-01 1 1  ON 26
 eO_7                -4.072252e-02 1 1  ON 27
 eO_8                -2.220104e-01 1 1  ON 28
 eO_9                -8.722770e-02 1 1  ON 29
eH1_0                -2.467293e-01 1 1  ON 30
eH1_1                -1.459130e-01 1 1  ON 31
eH1_2                -9.862611e-02 1 1  ON 32
eH1_3                -4.463077e-02 1 1  ON 33
eH1_4                 3.648018e-03 1 1  ON 34
eH1_5                 3.817598e-02 1 1  ON 35
eH1_6                 9.661022e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780653e-01 1 1  ON 38
eH1_9                 6.906144e-02 1 1  ON 39
eH2_0                -2.445703e-01 1 1  ON 40
eH2_1                -1.437074e-01 1 1  ON 41
eH2_2                -9.651574e-02 1 1  ON 42
eH2_3                -4.241418e-02 1 1  ON 43
eH2_4                 6.026468e-03 1 1  ON 44
eH2_5                 4.033463e-02 1 1  ON 45
eH2_6                 9.957427e-02 1 1  ON 46
eH2_7                 1.556668e-01 1 1  ON 47
eH2_8                 1.833716e-01 1 1  ON 48
eH2_9                 5.866445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7505e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8986
    reference variance = 0.211912
====================================================
  Execution time = 2.0877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3918e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339135452536
                                         uncertainty =       0.004183185643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339135452536
                                         uncertainty =       0.004183185643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411815783
  error estimate for blocks of size 2^( 2) =       0.000424320586
  error estimate for blocks of size 2^( 3) =       0.000437437802
  error estimate for blocks of size 2^( 4) =       0.000449948263
  error estimate for blocks of size 2^( 5) =       0.000459898535
  error estimate for blocks of size 2^( 6) =       0.000467677352
  error estimate for blocks of size 2^( 7) =       0.000471754787

      target function =                  N/A
              le_mean =     -16.906442215753
             les_mean =     286.166972703681
             stat err =       0.000462319734
             autocorr =       1.260314372946
              std dev =       0.582395465886
             le_variance =       0.339184478685


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690644221575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906442215753       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906442219735       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906442227624       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906442230657       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906442230124       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906442228646       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906442231150       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906442230958       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+02 is 1.817940e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906442215753       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906442216749       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906442218724       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906442219481       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906442219348       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906442218977       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906442219602       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906442219553       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 4.545858e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906442215753       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906442216002       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906442216496       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906442216685       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906442216652       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906442216559       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906442216715       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906442216704       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.136528e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227406 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6500e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.096108e-01 1 1  ON 0
 uu_1                 1.427844e-01 1 1  ON 1
 uu_2                 4.113122e-02 1 1  ON 2
 uu_3                -2.116962e-02 1 1  ON 3
 uu_4                -6.670611e-02 1 1  ON 4
 uu_5                -1.014298e-01 1 1  ON 5
 uu_6                -1.284668e-01 1 1  ON 6
 uu_7                -1.421855e-01 1 1  ON 7
 uu_8                -1.341891e-01 1 1  ON 8
 uu_9                -1.054336e-01 1 1  ON 9
 ud_0                 4.489275e-01 1 1  ON 10
 ud_1                 1.833728e-01 1 1  ON 11
 ud_2                 6.308905e-02 1 1  ON 12
 ud_3                -8.047106e-03 1 1  ON 13
 ud_4                -6.536519e-02 1 1  ON 14
 ud_5                -1.073130e-01 1 1  ON 15
 ud_6                -1.353558e-01 1 1  ON 16
 ud_7                -1.523590e-01 1 1  ON 17
 ud_8                -1.530471e-01 1 1  ON 18
 ud_9                -1.432542e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393160e-01 1 1  ON 21
 eO_2                -2.155501e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258100e-01 1 1  ON 24
 eO_5                 4.879565e-01 1 1  ON 25
 eO_6                 2.602745e-01 1 1  ON 26
 eO_7                -4.072246e-02 1 1  ON 27
 eO_8                -2.220106e-01 1 1  ON 28
 eO_9                -8.722791e-02 1 1  ON 29
eH1_0                -2.467297e-01 1 1  ON 30
eH1_1                -1.459133e-01 1 1  ON 31
eH1_2                -9.862636e-02 1 1  ON 32
eH1_3                -4.463077e-02 1 1  ON 33
eH1_4                 3.648263e-03 1 1  ON 34
eH1_5                 3.817616e-02 1 1  ON 35
eH1_6                 9.661032e-02 1 1  ON 36
eH1_7                 1.542963e-01 1 1  ON 37
eH1_8                 1.780655e-01 1 1  ON 38
eH1_9                 6.906174e-02 1 1  ON 39
eH2_0                -2.445708e-01 1 1  ON 40
eH2_1                -1.437076e-01 1 1  ON 41
eH2_2                -9.651576e-02 1 1  ON 42
eH2_3                -4.241403e-02 1 1  ON 43
eH2_4                 6.026635e-03 1 1  ON 44
eH2_5                 4.033460e-02 1 1  ON 45
eH2_6                 9.957424e-02 1 1  ON 46
eH2_7                 1.556667e-01 1 1  ON 47
eH2_8                 1.833718e-01 1 1  ON 48
eH2_9                 5.866480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9239
    reference variance = 0.189186
====================================================
  Execution time = 2.0483e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3809e-01
  Total weights = 2.0000e+06
  Execution time = 1.8750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338218667289
                                         uncertainty =       0.004466869946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338218667289
                                         uncertainty =       0.004466869946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411150853
  error estimate for blocks of size 2^( 2) =       0.000423595391
  error estimate for blocks of size 2^( 3) =       0.000436405917
  error estimate for blocks of size 2^( 4) =       0.000446840012
  error estimate for blocks of size 2^( 5) =       0.000456336125
  error estimate for blocks of size 2^( 6) =       0.000460112439
  error estimate for blocks of size 2^( 7) =       0.000464956767

      target function =                  N/A
              le_mean =     -16.906434702558
             les_mean =     286.165624230277
             stat err =       0.000457061336
             autocorr =       1.235795411262
              std dev =       0.581455112171
             le_variance =       0.338090047470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338219258441
                                         uncertainty =       0.004466870947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338219258441
                                         uncertainty =       0.004466870947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411151212
  error estimate for blocks of size 2^( 2) =       0.000423595707
  error estimate for blocks of size 2^( 3) =       0.000436406187
  error estimate for blocks of size 2^( 4) =       0.000446840240
  error estimate for blocks of size 2^( 5) =       0.000456336365
  error estimate for blocks of size 2^( 6) =       0.000460112677
  error estimate for blocks of size 2^( 7) =       0.000464956990

      target function =                  N/A
              le_mean =     -16.906434700424
             les_mean =     286.165624748877
             stat err =       0.000457061568
             autocorr =       1.235794505588
              std dev =       0.581455620161
             le_variance =       0.338090638217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338218962549
                                         uncertainty =       0.004466870438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338218962549
                                         uncertainty =       0.004466870438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411151032
  error estimate for blocks of size 2^( 2) =       0.000423595549
  error estimate for blocks of size 2^( 3) =       0.000436406052
  error estimate for blocks of size 2^( 4) =       0.000446840125
  error estimate for blocks of size 2^( 5) =       0.000456336245
  error estimate for blocks of size 2^( 6) =       0.000460112558
  error estimate for blocks of size 2^( 7) =       0.000464956878

      target function =                  N/A
              le_mean =     -16.906434701490
             les_mean =     286.165624489225
             stat err =       0.000457061451
             autocorr =       1.235794958468
              std dev =       0.581455365895
             le_variance =       0.338090342528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338218704186
                                         uncertainty =       0.004466870008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338218704186
                                         uncertainty =       0.004466870008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411150875
  error estimate for blocks of size 2^( 2) =       0.000423595411
  error estimate for blocks of size 2^( 3) =       0.000436405933
  error estimate for blocks of size 2^( 4) =       0.000446840026
  error estimate for blocks of size 2^( 5) =       0.000456336140
  error estimate for blocks of size 2^( 6) =       0.000460112454
  error estimate for blocks of size 2^( 7) =       0.000464956781

      target function =                  N/A
              le_mean =     -16.906434702424
             les_mean =     286.165624262626
             stat err =       0.000457061350
             autocorr =       1.235795354668
              std dev =       0.581455143877
             le_variance =       0.338090084342


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906434702558        initial  <--
     1.4211e+02     1.4211e+03             1.8179e-06       -16.906434700424
     5.6843e+02     5.6843e+03             4.5459e-07       -16.906434701490
     2.2737e+03     2.2737e+04             1.1365e-07       -16.906434702424

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9436
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427843e-01 1 1  ON 1
 uu_2                 4.113117e-02 1 1  ON 2
 uu_3                -2.116956e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014298e-01 1 1  ON 5
 uu_6                -1.284667e-01 1 1  ON 6
 uu_7                -1.421851e-01 1 1  ON 7
 uu_8                -1.341890e-01 1 1  ON 8
 uu_9                -1.054335e-01 1 1  ON 9
 ud_0                 4.489272e-01 1 1  ON 10
 ud_1                 1.833724e-01 1 1  ON 11
 ud_2                 6.308901e-02 1 1  ON 12
 ud_3                -8.047038e-03 1 1  ON 13
 ud_4                -6.536504e-02 1 1  ON 14
 ud_5                -1.073128e-01 1 1  ON 15
 ud_6                -1.353558e-01 1 1  ON 16
 ud_7                -1.523588e-01 1 1  ON 17
 ud_8                -1.530470e-01 1 1  ON 18
 ud_9                -1.432543e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393160e-01 1 1  ON 21
 eO_2                -2.155516e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258100e-01 1 1  ON 24
 eO_5                 4.879564e-01 1 1  ON 25
 eO_6                 2.602745e-01 1 1  ON 26
 eO_7                -4.072252e-02 1 1  ON 27
 eO_8                -2.220104e-01 1 1  ON 28
 eO_9                -8.722770e-02 1 1  ON 29
eH1_0                -2.467293e-01 1 1  ON 30
eH1_1                -1.459130e-01 1 1  ON 31
eH1_2                -9.862611e-02 1 1  ON 32
eH1_3                -4.463077e-02 1 1  ON 33
eH1_4                 3.648018e-03 1 1  ON 34
eH1_5                 3.817598e-02 1 1  ON 35
eH1_6                 9.661022e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780653e-01 1 1  ON 38
eH1_9                 6.906144e-02 1 1  ON 39
eH2_0                -2.445703e-01 1 1  ON 40
eH2_1                -1.437074e-01 1 1  ON 41
eH2_2                -9.651574e-02 1 1  ON 42
eH2_3                -4.241418e-02 1 1  ON 43
eH2_4                 6.026468e-03 1 1  ON 44
eH2_5                 4.033463e-02 1 1  ON 45
eH2_6                 9.957427e-02 1 1  ON 46
eH2_7                 1.556668e-01 1 1  ON 47
eH2_8                 1.833716e-01 1 1  ON 48
eH2_9                 5.866445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6504e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9234
    reference variance = 0.448532
====================================================
  Execution time = 2.0532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3945e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339526235656
                                         uncertainty =       0.003223474470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339526235656
                                         uncertainty =       0.003223474470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411979463
  error estimate for blocks of size 2^( 2) =       0.000424498457
  error estimate for blocks of size 2^( 3) =       0.000437492176
  error estimate for blocks of size 2^( 4) =       0.000450348094
  error estimate for blocks of size 2^( 5) =       0.000460539888
  error estimate for blocks of size 2^( 6) =       0.000468237880
  error estimate for blocks of size 2^( 7) =       0.000471267707

      target function =                  N/A
              le_mean =     -16.906871478209
             les_mean =     286.181757166215
             stat err =       0.000462598392
             autocorr =       1.260831656002
              std dev =       0.582626943487
             le_variance =       0.339454155277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690687147821e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906871478209       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906871478009       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906871478459       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906871478475       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906871478603       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906871478798       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906871478724       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906871478713       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+03 is 2.384777e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906871478209       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906871478159       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906871478271       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906871478278       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906871478307       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906871478356       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906871478336       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906871478326       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+03 is 5.962102e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906871478209       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906871478196       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906871478224       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906871478225       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906871478205       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906871478239       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906871478249       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906871478236       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 1.490535e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229988 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6040e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427843e-01 1 1  ON 1
 uu_2                 4.113119e-02 1 1  ON 2
 uu_3                -2.116957e-02 1 1  ON 3
 uu_4                -6.670607e-02 1 1  ON 4
 uu_5                -1.014298e-01 1 1  ON 5
 uu_6                -1.284667e-01 1 1  ON 6
 uu_7                -1.421851e-01 1 1  ON 7
 uu_8                -1.341890e-01 1 1  ON 8
 uu_9                -1.054336e-01 1 1  ON 9
 ud_0                 4.489272e-01 1 1  ON 10
 ud_1                 1.833724e-01 1 1  ON 11
 ud_2                 6.308902e-02 1 1  ON 12
 ud_3                -8.047053e-03 1 1  ON 13
 ud_4                -6.536505e-02 1 1  ON 14
 ud_5                -1.073128e-01 1 1  ON 15
 ud_6                -1.353558e-01 1 1  ON 16
 ud_7                -1.523588e-01 1 1  ON 17
 ud_8                -1.530471e-01 1 1  ON 18
 ud_9                -1.432543e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393159e-01 1 1  ON 21
 eO_2                -2.155513e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258100e-01 1 1  ON 24
 eO_5                 4.879564e-01 1 1  ON 25
 eO_6                 2.602745e-01 1 1  ON 26
 eO_7                -4.072251e-02 1 1  ON 27
 eO_8                -2.220105e-01 1 1  ON 28
 eO_9                -8.722773e-02 1 1  ON 29
eH1_0                -2.467294e-01 1 1  ON 30
eH1_1                -1.459130e-01 1 1  ON 31
eH1_2                -9.862612e-02 1 1  ON 32
eH1_3                -4.463078e-02 1 1  ON 33
eH1_4                 3.648031e-03 1 1  ON 34
eH1_5                 3.817599e-02 1 1  ON 35
eH1_6                 9.661022e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780653e-01 1 1  ON 38
eH1_9                 6.906148e-02 1 1  ON 39
eH2_0                -2.445704e-01 1 1  ON 40
eH2_1                -1.437074e-01 1 1  ON 41
eH2_2                -9.651573e-02 1 1  ON 42
eH2_3                -4.241418e-02 1 1  ON 43
eH2_4                 6.026465e-03 1 1  ON 44
eH2_5                 4.033463e-02 1 1  ON 45
eH2_6                 9.957429e-02 1 1  ON 46
eH2_7                 1.556668e-01 1 1  ON 47
eH2_8                 1.833716e-01 1 1  ON 48
eH2_9                 5.866448e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9114
    reference variance = 0.323909
====================================================
  Execution time = 2.0351e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3871e-01
  Total weights = 2.0000e+06
  Execution time = 1.8769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338613353344
                                         uncertainty =       0.004600593598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338613353344
                                         uncertainty =       0.004600593598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411527323
  error estimate for blocks of size 2^( 2) =       0.000424234104
  error estimate for blocks of size 2^( 3) =       0.000436847829
  error estimate for blocks of size 2^( 4) =       0.000449064180
  error estimate for blocks of size 2^( 5) =       0.000458577933
  error estimate for blocks of size 2^( 6) =       0.000468770830
  error estimate for blocks of size 2^( 7) =       0.000471955035

      target function =                  N/A
              le_mean =     -16.906060519203
             les_mean =     286.153591585243
             stat err =       0.000462091995
             autocorr =       1.260838723678
              std dev =       0.581987521884
             le_variance =       0.338709475629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338613356556
                                         uncertainty =       0.004600590544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338613356556
                                         uncertainty =       0.004600590544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411527325
  error estimate for blocks of size 2^( 2) =       0.000424234104
  error estimate for blocks of size 2^( 3) =       0.000436847827
  error estimate for blocks of size 2^( 4) =       0.000449064177
  error estimate for blocks of size 2^( 5) =       0.000458577930
  error estimate for blocks of size 2^( 6) =       0.000468770828
  error estimate for blocks of size 2^( 7) =       0.000471955037

      target function =                  N/A
              le_mean =     -16.906060518551
             les_mean =     286.153591566444
             stat err =       0.000462091993
             autocorr =       1.260838703593
              std dev =       0.581987524677
             le_variance =       0.338709478880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338613354947
                                         uncertainty =       0.004600592071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338613354947
                                         uncertainty =       0.004600592071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411527324
  error estimate for blocks of size 2^( 2) =       0.000424234104
  error estimate for blocks of size 2^( 3) =       0.000436847828
  error estimate for blocks of size 2^( 4) =       0.000449064179
  error estimate for blocks of size 2^( 5) =       0.000458577932
  error estimate for blocks of size 2^( 6) =       0.000468770829
  error estimate for blocks of size 2^( 7) =       0.000471955036

      target function =                  N/A
              le_mean =     -16.906060518877
             les_mean =     286.153591575839
             stat err =       0.000462091994
             autocorr =       1.260838713643
              std dev =       0.581987523278
             le_variance =       0.338709477252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338613353544
                                         uncertainty =       0.004600593407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338613353544
                                         uncertainty =       0.004600593407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411527323
  error estimate for blocks of size 2^( 2) =       0.000424234104
  error estimate for blocks of size 2^( 3) =       0.000436847829
  error estimate for blocks of size 2^( 4) =       0.000449064180
  error estimate for blocks of size 2^( 5) =       0.000458577933
  error estimate for blocks of size 2^( 6) =       0.000468770830
  error estimate for blocks of size 2^( 7) =       0.000471955035

      target function =                  N/A
              le_mean =     -16.906060519163
             les_mean =     286.153591584067
             stat err =       0.000462091995
             autocorr =       1.260838722425
              std dev =       0.581987522058
             le_variance =       0.338709475832


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906060519203        initial  <--
     1.4211e+03     1.4211e+04             2.3848e-07       -16.906060518551
     5.6843e+03     5.6843e+04             5.9621e-08       -16.906060518877
     2.2737e+04     2.2737e+05             1.4905e-08       -16.906060519163

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8063
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.096107e-01 1 1  ON 0
 uu_1                 1.427843e-01 1 1  ON 1
 uu_2                 4.113117e-02 1 1  ON 2
 uu_3                -2.116956e-02 1 1  ON 3
 uu_4                -6.670608e-02 1 1  ON 4
 uu_5                -1.014298e-01 1 1  ON 5
 uu_6                -1.284667e-01 1 1  ON 6
 uu_7                -1.421851e-01 1 1  ON 7
 uu_8                -1.341890e-01 1 1  ON 8
 uu_9                -1.054335e-01 1 1  ON 9
 ud_0                 4.489272e-01 1 1  ON 10
 ud_1                 1.833724e-01 1 1  ON 11
 ud_2                 6.308901e-02 1 1  ON 12
 ud_3                -8.047038e-03 1 1  ON 13
 ud_4                -6.536504e-02 1 1  ON 14
 ud_5                -1.073128e-01 1 1  ON 15
 ud_6                -1.353558e-01 1 1  ON 16
 ud_7                -1.523588e-01 1 1  ON 17
 ud_8                -1.530470e-01 1 1  ON 18
 ud_9                -1.432543e-01 1 1  ON 19
 eO_0                -7.605439e-01 1 1  ON 20
 eO_1                -4.393160e-01 1 1  ON 21
 eO_2                -2.155516e-02 1 1  ON 22
 eO_3                 2.988702e-01 1 1  ON 23
 eO_4                 5.258100e-01 1 1  ON 24
 eO_5                 4.879564e-01 1 1  ON 25
 eO_6                 2.602745e-01 1 1  ON 26
 eO_7                -4.072252e-02 1 1  ON 27
 eO_8                -2.220104e-01 1 1  ON 28
 eO_9                -8.722770e-02 1 1  ON 29
eH1_0                -2.467293e-01 1 1  ON 30
eH1_1                -1.459130e-01 1 1  ON 31
eH1_2                -9.862611e-02 1 1  ON 32
eH1_3                -4.463077e-02 1 1  ON 33
eH1_4                 3.648018e-03 1 1  ON 34
eH1_5                 3.817598e-02 1 1  ON 35
eH1_6                 9.661022e-02 1 1  ON 36
eH1_7                 1.542964e-01 1 1  ON 37
eH1_8                 1.780653e-01 1 1  ON 38
eH1_9                 6.906144e-02 1 1  ON 39
eH2_0                -2.445703e-01 1 1  ON 40
eH2_1                -1.437074e-01 1 1  ON 41
eH2_2                -9.651574e-02 1 1  ON 42
eH2_3                -4.241418e-02 1 1  ON 43
eH2_4                 6.026468e-03 1 1  ON 44
eH2_5                 4.033463e-02 1 1  ON 45
eH2_6                 9.957427e-02 1 1  ON 46
eH2_7                 1.556668e-01 1 1  ON 47
eH2_8                 1.833716e-01 1 1  ON 48
eH2_9                 5.866445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5854e+01 secs
  Total Execution time = 2.2879e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
