Rank =    0  Free Memory = 77229 MB
Rank =    1  Free Memory = 77229 MB
Rank =    2  Free Memory = 77229 MB
Rank =    3  Free Memory = 77229 MB
Rank =    4  Free Memory = 77229 MB
Rank =    5  Free Memory = 77229 MB
Rank =    6  Free Memory = 77229 MB
Rank =    7  Free Memory = 77229 MB
Rank =    8  Free Memory = 77229 MB
Rank =    9  Free Memory = 77229 MB
Rank =   10  Free Memory = 77229 MB
Rank =   11  Free Memory = 77229 MB
Rank =   12  Free Memory = 77228 MB
Rank =   13  Free Memory = 77228 MB
Rank =   14  Free Memory = 77228 MB
Rank =   15  Free Memory = 77214 MB
Rank =   16  Free Memory = 77213 MB
Rank =   17  Free Memory = 77213 MB
Rank =   18  Free Memory = 77213 MB
Rank =   19  Free Memory = 77213 MB
Rank =   20  Free Memory = 77213 MB
Rank =   21  Free Memory = 77213 MB
Rank =   22  Free Memory = 77213 MB
Rank =   23  Free Memory = 77213 MB
Rank =   24  Free Memory = 77213 MB
Rank =   25  Free Memory = 77213 MB
Rank =   26  Free Memory = 77213 MB
Rank =   27  Free Memory = 77213 MB
Rank =   28  Free Memory = 77213 MB
Rank =   29  Free Memory = 77213 MB
Rank =   30  Free Memory = 77213 MB
Rank =   31  Free Memory = 77213 MB
Rank =   32  Free Memory = 79296 MB
Rank =   33  Free Memory = 79296 MB
Rank =   34  Free Memory = 79296 MB
Rank =   35  Free Memory = 79296 MB
Rank =   36  Free Memory = 79296 MB
Rank =   37  Free Memory = 79296 MB
Rank =   38  Free Memory = 79296 MB
Rank =   39  Free Memory = 79296 MB
Rank =   40  Free Memory = 79296 MB
Rank =   41  Free Memory = 79296 MB
Rank =   42  Free Memory = 79296 MB
Rank =   43  Free Memory = 79296 MB
Rank =   44  Free Memory = 79296 MB
Rank =   45  Free Memory = 79296 MB
Rank =   46  Free Memory = 79296 MB
Rank =   47  Free Memory = 79296 MB
Rank =   48  Free Memory = 79296 MB
Rank =   49  Free Memory = 79296 MB
Rank =   50  Free Memory = 79296 MB
Rank =   51  Free Memory = 79296 MB
Rank =   52  Free Memory = 79296 MB
Rank =   53  Free Memory = 79296 MB
Rank =   54  Free Memory = 79296 MB
Rank =   55  Free Memory = 79296 MB
Rank =   56  Free Memory = 79296 MB
Rank =   57  Free Memory = 79296 MB
Rank =   58  Free Memory = 79296 MB
Rank =   59  Free Memory = 79296 MB
Rank =   60  Free Memory = 79296 MB
Rank =   61  Free Memory = 79296 MB
Rank =   62  Free Memory = 79296 MB
Rank =   63  Free Memory = 79296 MB
Rank =   64  Free Memory = 63150 MB
Rank =   65  Free Memory = 63150 MB
Rank =   66  Free Memory = 63150 MB
Rank =   67  Free Memory = 63150 MB
Rank =   68  Free Memory = 63150 MB
Rank =   69  Free Memory = 63150 MB
Rank =   70  Free Memory = 63150 MB
Rank =   71  Free Memory = 63150 MB
Rank =   72  Free Memory = 63150 MB
Rank =   73  Free Memory = 63150 MB
Rank =   74  Free Memory = 63150 MB
Rank =   75  Free Memory = 63150 MB
Rank =   76  Free Memory = 63150 MB
Rank =   77  Free Memory = 63150 MB
Rank =   78  Free Memory = 63150 MB
Rank =   79  Free Memory = 63150 MB
Rank =   80  Free Memory = 63150 MB
Rank =   81  Free Memory = 63150 MB
Rank =   82  Free Memory = 63150 MB
Rank =   83  Free Memory = 63150 MB
Rank =   84  Free Memory = 63150 MB
Rank =   85  Free Memory = 63150 MB
Rank =   86  Free Memory = 63150 MB
Rank =   87  Free Memory = 63150 MB
Rank =   88  Free Memory = 63150 MB
Rank =   89  Free Memory = 63150 MB
Rank =   90  Free Memory = 63150 MB
Rank =   91  Free Memory = 63150 MB
Rank =   92  Free Memory = 63150 MB
Rank =   93  Free Memory = 63150 MB
Rank =   94  Free Memory = 63150 MB
Rank =   95  Free Memory = 63150 MB
Rank =   96  Free Memory = 70639 MB
Rank =   97  Free Memory = 70639 MB
Rank =   98  Free Memory = 70639 MB
Rank =   99  Free Memory = 70639 MB
Rank =  100  Free Memory = 70639 MB
Rank =  101  Free Memory = 70639 MB
Rank =  102  Free Memory = 70639 MB
Rank =  103  Free Memory = 70639 MB
Rank =  104  Free Memory = 70639 MB
Rank =  105  Free Memory = 70639 MB
Rank =  106  Free Memory = 70639 MB
Rank =  107  Free Memory = 70639 MB
Rank =  108  Free Memory = 70639 MB
Rank =  109  Free Memory = 70639 MB
Rank =  110  Free Memory = 70639 MB
Rank =  111  Free Memory = 70639 MB
Rank =  112  Free Memory = 70639 MB
Rank =  113  Free Memory = 70639 MB
Rank =  114  Free Memory = 70639 MB
Rank =  115  Free Memory = 70639 MB
Rank =  116  Free Memory = 70639 MB
Rank =  117  Free Memory = 70639 MB
Rank =  118  Free Memory = 70639 MB
Rank =  119  Free Memory = 70639 MB
Rank =  120  Free Memory = 70639 MB
Rank =  121  Free Memory = 70639 MB
Rank =  122  Free Memory = 70639 MB
Rank =  123  Free Memory = 70639 MB
Rank =  124  Free Memory = 70639 MB
Rank =  125  Free Memory = 70639 MB
Rank =  126  Free Memory = 70639 MB
Rank =  127  Free Memory = 70639 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001n.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001n.xml

  Project = H2O
  date    = 2023-04-14 12:03:10 PDT
  host    = n0090.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 878

  Range of prime numbers to use as seeds over processors and threads = 6833-8009


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.096107e-01    1         1  ON     0
     uu_1                 1.427843e-01    1         1  ON     1
     uu_2                 4.113117e-02    1         1  ON     2
     uu_3                -2.116956e-02    1         1  ON     3
     uu_4                -6.670608e-02    1         1  ON     4
     uu_5                -1.014298e-01    1         1  ON     5
     uu_6                -1.284667e-01    1         1  ON     6
     uu_7                -1.421851e-01    1         1  ON     7
     uu_8                -1.341890e-01    1         1  ON     8
     uu_9                -1.054335e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.489272e-01    1         1  ON     0
     ud_1                 1.833724e-01    1         1  ON     1
     ud_2                 6.308901e-02    1         1  ON     2
     ud_3                -8.047038e-03    1         1  ON     3
     ud_4                -6.536504e-02    1         1  ON     4
     ud_5                -1.073128e-01    1         1  ON     5
     ud_6                -1.353558e-01    1         1  ON     6
     ud_7                -1.523588e-01    1         1  ON     7
     ud_8                -1.530470e-01    1         1  ON     8
     ud_9                -1.432543e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.605439e-01    1         1  ON     0
     eO_1                -4.393160e-01    1         1  ON     1
     eO_2                -2.155516e-02    1         1  ON     2
     eO_3                 2.988702e-01    1         1  ON     3
     eO_4                 5.258100e-01    1         1  ON     4
     eO_5                 4.879564e-01    1         1  ON     5
     eO_6                 2.602745e-01    1         1  ON     6
     eO_7                -4.072252e-02    1         1  ON     7
     eO_8                -2.220104e-01    1         1  ON     8
     eO_9                -8.722770e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.467293e-01    1         1  ON     0
     eH1_1                -1.459130e-01    1         1  ON     1
     eH1_2                -9.862611e-02    1         1  ON     2
     eH1_3                -4.463077e-02    1         1  ON     3
     eH1_4                 3.648018e-03    1         1  ON     4
     eH1_5                 3.817598e-02    1         1  ON     5
     eH1_6                 9.661022e-02    1         1  ON     6
     eH1_7                 1.542964e-01    1         1  ON     7
     eH1_8                 1.780653e-01    1         1  ON     8
     eH1_9                 6.906144e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.445703e-01    1         1  ON     0
     eH2_1                -1.437074e-01    1         1  ON     1
     eH2_2                -9.651574e-02    1         1  ON     2
     eH2_3                -4.241418e-02    1         1  ON     3
     eH2_4                 6.026468e-03    1         1  ON     4
     eH2_5                 4.033463e-02    1         1  ON     5
     eH2_6                 9.957427e-02    1         1  ON     6
     eH2_7                 1.556668e-01    1         1  ON     7
     eH2_8                 1.833716e-01    1         1  ON     8
     eH2_9                 5.866445e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.062575e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.0316e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9379
    reference variance = 0.297133
====================================================
  Execution time = 2.0927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4057e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340510816791
                                         uncertainty =       0.005025545896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340510816791
                                         uncertainty =       0.005025545896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412656093
  error estimate for blocks of size 2^( 2) =       0.000425203262
  error estimate for blocks of size 2^( 3) =       0.000437873823
  error estimate for blocks of size 2^( 4) =       0.000449834884
  error estimate for blocks of size 2^( 5) =       0.000460967132
  error estimate for blocks of size 2^( 6) =       0.000467452179
  error estimate for blocks of size 2^( 7) =       0.000473320415

      target function =                  N/A
              le_mean =     -16.905992465737
             les_mean =     286.153151182978
             stat err =       0.000462893653
             autocorr =       1.258305015342
              std dev =       0.583583842916
             le_variance =       0.340570101713


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690599246574e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905992465737       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905998831226       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905999721452       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905998746078       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905997664422       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905997265819       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905998232780       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905999042430       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905998865228       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905998890693       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.536278e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905992465737       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905994785310       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905995028280       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905994598067       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905994279799       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905994005892       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905994201717       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905994370545       residual = 9.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.491093e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905992465737       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905993120538       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905993185369       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905993058130       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905992979321       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905992890822       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905992925461       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905992952031       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.166181e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141066 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6577e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.097097e-01                 1 1 ON  0
uu_1  1.427491e-01                 1 1 ON  1
uu_2  4.116957e-02                 1 1 ON  2
uu_3  -2.123746e-02                1 1 ON  3
uu_4  -6.666925e-02                1 1 ON  4
uu_5  -1.014977e-01                1 1 ON  5
uu_6  -1.285299e-01                1 1 ON  6
uu_7  -1.422032e-01                1 1 ON  7
uu_8  -1.342598e-01                1 1 ON  8
uu_9  -1.054662e-01                1 1 ON  9
ud_0  4.491190e-01                 1 1 ON  10
ud_1  1.834293e-01                 1 1 ON  11
ud_2  6.313113e-02                 1 1 ON  12
ud_3  -8.082246e-03                1 1 ON  13
ud_4  -6.547007e-02                1 1 ON  14
ud_5  -1.074095e-01                1 1 ON  15
ud_6  -1.354019e-01                1 1 ON  16
ud_7  -1.523795e-01                1 1 ON  17
ud_8  -1.530523e-01                1 1 ON  18
ud_9  -1.432405e-01                1 1 ON  19
eO_0  -7.604136e-01                1 1 ON  20
eO_1  -4.392772e-01                1 1 ON  21
eO_2  -2.165173e-02                1 1 ON  22
eO_3  2.988403e-01                 1 1 ON  23
eO_4  5.258727e-01                 1 1 ON  24
eO_5  4.880057e-01                 1 1 ON  25
eO_6  2.602885e-01                 1 1 ON  26
eO_7  -4.068506e-02                1 1 ON  27
eO_8  -2.220851e-01                1 1 ON  28
eO_9  -8.734459e-02                1 1 ON  29
eH1_0 -2.469445e-01                1 1 ON  30
eH1_1 -1.460943e-01                1 1 ON  31
eH1_2 -9.867181e-02                1 1 ON  32
eH1_3 -4.446865e-02                1 1 ON  33
eH1_4 3.669726e-03                 1 1 ON  34
eH1_5 3.809401e-02                 1 1 ON  35
eH1_6 9.664292e-02                 1 1 ON  36
eH1_7 1.543343e-01                 1 1 ON  37
eH1_8 1.781922e-01                 1 1 ON  38
eH1_9 6.919124e-02                 1 1 ON  39
eH2_0 -2.450194e-01                1 1 ON  40
eH2_1 -1.437995e-01                1 1 ON  41
eH2_2 -9.643854e-02                1 1 ON  42
eH2_3 -4.225058e-02                1 1 ON  43
eH2_4 6.028926e-03                 1 1 ON  44
eH2_5 4.030102e-02                 1 1 ON  45
eH2_6 9.949895e-02                 1 1 ON  46
eH2_7 1.556359e-01                 1 1 ON  47
eH2_8 1.835246e-01                 1 1 ON  48
eH2_9 5.891015e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.917
    reference variance = 0.706326
====================================================
  Execution time = 2.0859e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3771e-01
  Total weights = 2.0000e+06
  Execution time = 1.9044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337662811115
                                         uncertainty =       0.002866968359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337662811115
                                         uncertainty =       0.002866968359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410856916
  error estimate for blocks of size 2^( 2) =       0.000423753585
  error estimate for blocks of size 2^( 3) =       0.000437112212
  error estimate for blocks of size 2^( 4) =       0.000449603093
  error estimate for blocks of size 2^( 5) =       0.000459530881
  error estimate for blocks of size 2^( 6) =       0.000467370753
  error estimate for blocks of size 2^( 7) =       0.000472052493

      target function =                  N/A
              le_mean =     -16.905586289830
             les_mean =     286.136454445193
             stat err =       0.000462139305
             autocorr =       1.265215809588
              std dev =       0.581039423017
             le_variance =       0.337606811100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863778276
                                         uncertainty =       0.002871793070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863778276
                                         uncertainty =       0.002871793070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410979107
  error estimate for blocks of size 2^( 2) =       0.000423863152
  error estimate for blocks of size 2^( 3) =       0.000437207955
  error estimate for blocks of size 2^( 4) =       0.000449694532
  error estimate for blocks of size 2^( 5) =       0.000459631463
  error estimate for blocks of size 2^( 6) =       0.000467473037
  error estimate for blocks of size 2^( 7) =       0.000472168389

      target function =                  N/A
              le_mean =     -16.905589522130
             les_mean =     286.136764574969
             stat err =       0.000462241856
             autocorr =       1.265024821095
              std dev =       0.581212227269
             le_variance =       0.337807653128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337867259241
                                         uncertainty =       0.002871037335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337867259241
                                         uncertainty =       0.002871037335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410981240
  error estimate for blocks of size 2^( 2) =       0.000423867048
  error estimate for blocks of size 2^( 3) =       0.000437214062
  error estimate for blocks of size 2^( 4) =       0.000449700169
  error estimate for blocks of size 2^( 5) =       0.000459632530
  error estimate for blocks of size 2^( 6) =       0.000467474035
  error estimate for blocks of size 2^( 7) =       0.000472163498

      target function =                  N/A
              le_mean =     -16.905587506610
             les_mean =     286.136699934793
             stat err =       0.000462242558
             autocorr =       1.265015533039
              std dev =       0.581215244161
             le_variance =       0.337811160045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337693580254
                                         uncertainty =       0.002867576244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337693580254
                                         uncertainty =       0.002867576244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410875630
  error estimate for blocks of size 2^( 2) =       0.000423770654
  error estimate for blocks of size 2^( 3) =       0.000437127549
  error estimate for blocks of size 2^( 4) =       0.000449617678
  error estimate for blocks of size 2^( 5) =       0.000459545973
  error estimate for blocks of size 2^( 6) =       0.000467386106
  error estimate for blocks of size 2^( 7) =       0.000472068818

      target function =                  N/A
              le_mean =     -16.905586263785
             les_mean =     286.136484319728
             stat err =       0.000462154644
             autocorr =       1.265184541888
              std dev =       0.581065888076
             le_variance =       0.337637566286


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905586289830        initial
     2.5000e-01     2.5000e+00             1.5363e-03       -16.905589522130  <--
     1.0000e+00     1.0000e+01             4.4911e-04       -16.905587506610
     4.0000e+00     4.0000e+01             1.1662e-04       -16.905586263785

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0416e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.098379e-01 1 1  ON 0
 uu_1                 1.427218e-01 1 1  ON 1
 uu_2                 4.121418e-02 1 1  ON 2
 uu_3                -2.127868e-02 1 1  ON 3
 uu_4                -6.666717e-02 1 1  ON 4
 uu_5                -1.016369e-01 1 1  ON 5
 uu_6                -1.286882e-01 1 1  ON 6
 uu_7                -1.422754e-01 1 1  ON 7
 uu_8                -1.344590e-01 1 1  ON 8
 uu_9                -1.055620e-01 1 1  ON 9
 ud_0                 4.494015e-01 1 1  ON 10
 ud_1                 1.835686e-01 1 1  ON 11
 ud_2                 6.321594e-02 1 1  ON 12
 ud_3                -8.123807e-03 1 1  ON 13
 ud_4                -6.564467e-02 1 1  ON 14
 ud_5                -1.075983e-01 1 1  ON 15
 ud_6                -1.355084e-01 1 1  ON 16
 ud_7                -1.524326e-01 1 1  ON 17
 ud_8                -1.530594e-01 1 1  ON 18
 ud_9                -1.431921e-01 1 1  ON 19
 eO_0                -7.602054e-01 1 1  ON 20
 eO_1                -4.391598e-01 1 1  ON 21
 eO_2                -2.174194e-02 1 1  ON 22
 eO_3                 2.987156e-01 1 1  ON 23
 eO_4                 5.260353e-01 1 1  ON 24
 eO_5                 4.881629e-01 1 1  ON 25
 eO_6                 2.603614e-01 1 1  ON 26
 eO_7                -4.056099e-02 1 1  ON 27
 eO_8                -2.223097e-01 1 1  ON 28
 eO_9                -8.770283e-02 1 1  ON 29
eH1_0                -2.475701e-01 1 1  ON 30
eH1_1                -1.464413e-01 1 1  ON 31
eH1_2                -9.877349e-02 1 1  ON 32
eH1_3                -4.423223e-02 1 1  ON 33
eH1_4                 3.681777e-03 1 1  ON 34
eH1_5                 3.789054e-02 1 1  ON 35
eH1_6                 9.672148e-02 1 1  ON 36
eH1_7                 1.544473e-01 1 1  ON 37
eH1_8                 1.785862e-01 1 1  ON 38
eH1_9                 6.959363e-02 1 1  ON 39
eH2_0                -2.461066e-01 1 1  ON 40
eH2_1                -1.439809e-01 1 1  ON 41
eH2_2                -9.637364e-02 1 1  ON 42
eH2_3                -4.196973e-02 1 1  ON 43
eH2_4                 5.997367e-03 1 1  ON 44
eH2_5                 4.020258e-02 1 1  ON 45
eH2_6                 9.928994e-02 1 1  ON 46
eH2_7                 1.555529e-01 1 1  ON 47
eH2_8                 1.839927e-01 1 1  ON 48
eH2_9                 5.966537e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7000e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9026
    reference variance = 0.288
====================================================
  Execution time = 2.0779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3460e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334705136695
                                         uncertainty =       0.003429660975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334705136695
                                         uncertainty =       0.003429660975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409023602
  error estimate for blocks of size 2^( 2) =       0.000422235883
  error estimate for blocks of size 2^( 3) =       0.000435850430
  error estimate for blocks of size 2^( 4) =       0.000449335950
  error estimate for blocks of size 2^( 5) =       0.000461097833
  error estimate for blocks of size 2^( 6) =       0.000469883083
  error estimate for blocks of size 2^( 7) =       0.000475459733

      target function =                  N/A
              le_mean =     -16.905833351461
             les_mean =     286.141801753756
             stat err =       0.000463944150
             autocorr =       1.286573696233
              std dev =       0.578446725020
             le_variance =       0.334600613686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690583335146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905833351461       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905832894347       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905834763150       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905834555372       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905834296223       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905837296326       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905837573180       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905838484503       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905838789693       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905838810485       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905838656806       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905838253811       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905838327778       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.429272e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905833351461       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905833086153       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905834200686       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905833775930       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905833909730       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905834500916       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905835136374       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905834811570       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905834878021       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905834852673       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.133044e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905833351461       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905833252407       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905833585198       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905833661863       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905833575197       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905833548268       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905833752316       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905833686557       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905833683514       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.222472e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146123 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6298e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120933e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841957e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8577
    reference variance = 0.252234
====================================================
  Execution time = 1.9906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3930e-01
  Total weights = 2.0000e+06
  Execution time = 1.8999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339272572230
                                         uncertainty =       0.005033207933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339272572230
                                         uncertainty =       0.005033207933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411829567
  error estimate for blocks of size 2^( 2) =       0.000425060054
  error estimate for blocks of size 2^( 3) =       0.000438028453
  error estimate for blocks of size 2^( 4) =       0.000450167251
  error estimate for blocks of size 2^( 5) =       0.000459922227
  error estimate for blocks of size 2^( 6) =       0.000468774970
  error estimate for blocks of size 2^( 7) =       0.000471738879

      target function =                  N/A
              le_mean =     -16.906355246902
             les_mean =     286.164054749851
             stat err =       0.000462650832
             autocorr =       1.262035721383
              std dev =       0.582414959449
             le_variance =       0.339207184990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339476317031
                                         uncertainty =       0.005042744270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339476317031
                                         uncertainty =       0.005042744270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411953280
  error estimate for blocks of size 2^( 2) =       0.000425168113
  error estimate for blocks of size 2^( 3) =       0.000438121962
  error estimate for blocks of size 2^( 4) =       0.000450249044
  error estimate for blocks of size 2^( 5) =       0.000460001572
  error estimate for blocks of size 2^( 6) =       0.000468850892
  error estimate for blocks of size 2^( 7) =       0.000471818923

      target function =                  N/A
              le_mean =     -16.906359706170
             les_mean =     286.164409354792
             stat err =       0.000462730108
             autocorr =       1.261710117264
              std dev =       0.582589915876
             le_variance =       0.339411010080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339462032643
                                         uncertainty =       0.005043235629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339462032643
                                         uncertainty =       0.005043235629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411944638
  error estimate for blocks of size 2^( 2) =       0.000425158730
  error estimate for blocks of size 2^( 3) =       0.000438113788
  error estimate for blocks of size 2^( 4) =       0.000450242049
  error estimate for blocks of size 2^( 5) =       0.000459995085
  error estimate for blocks of size 2^( 6) =       0.000468844884
  error estimate for blocks of size 2^( 7) =       0.000471810187

      target function =                  N/A
              le_mean =     -16.906359907742
             les_mean =     286.164401929593
             stat err =       0.000462723051
             autocorr =       1.261724574944
              std dev =       0.582577693687
             le_variance =       0.339396769182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339298573159
                                         uncertainty =       0.005035054131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339298573159
                                         uncertainty =       0.005035054131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411845372
  error estimate for blocks of size 2^( 2) =       0.000425072596
  error estimate for blocks of size 2^( 3) =       0.000438038537
  error estimate for blocks of size 2^( 4) =       0.000450175274
  error estimate for blocks of size 2^( 5) =       0.000459929593
  error estimate for blocks of size 2^( 6) =       0.000468781597
  error estimate for blocks of size 2^( 7) =       0.000471744971

      target function =                  N/A
              le_mean =     -16.906355610857
             les_mean =     286.164093091537
             stat err =       0.000462657859
             autocorr =       1.261977196652
              std dev =       0.582437310261
             le_variance =       0.339233220384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906355246902        initial
     6.2500e-02     6.2500e-01             3.4293e-03       -16.906359706170
     2.5000e-01     2.5000e+00             1.1330e-03       -16.906359907742  <--
     1.0000e+00     1.0000e+01             3.2225e-04       -16.906355610857

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9432e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120933e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841957e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5737e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8957
    reference variance = 0.147848
====================================================
  Execution time = 2.0253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4160e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341647487385
                                         uncertainty =       0.007590577796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341647487385
                                         uncertainty =       0.007590577796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413276913
  error estimate for blocks of size 2^( 2) =       0.000425696191
  error estimate for blocks of size 2^( 3) =       0.000438169221
  error estimate for blocks of size 2^( 4) =       0.000449703787
  error estimate for blocks of size 2^( 5) =       0.000460030578
  error estimate for blocks of size 2^( 6) =       0.000466351507
  error estimate for blocks of size 2^( 7) =       0.000472273842

      target function =                  N/A
              le_mean =     -16.906612891722
             les_mean =     286.175154912965
             stat err =       0.000462089928
             autocorr =       1.250174730377
              std dev =       0.584461815025
             le_variance =       0.341595613222


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661289172e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906612891722       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906612389730       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906614919710       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906618676117       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906622259545       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906623675709       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906622379361       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906621910506       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906622408181       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906621906023       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906623424745       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906623648842       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906623867086       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906623788090       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.227022e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906612891722       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906612592613       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906614302900       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906615699232       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906617333621       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906617661768       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906617137136       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906616827061       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906617123345       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906616972728       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906617100635       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.503657e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906612891722       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906612777411       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906613494064       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906613819951       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906614307423       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906614484577       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906614266454       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906614280409       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906614312588       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.577769e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5769e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.100994e-01 1 1  ON 0
 uu_1                 1.429352e-01 1 1  ON 1
 uu_2                 4.123478e-02 1 1  ON 2
 uu_3                -2.113324e-02 1 1  ON 3
 uu_4                -6.654585e-02 1 1  ON 4
 uu_5                -1.015089e-01 1 1  ON 5
 uu_6                -1.289882e-01 1 1  ON 6
 uu_7                -1.429335e-01 1 1  ON 7
 uu_8                -1.353745e-01 1 1  ON 8
 uu_9                -1.060105e-01 1 1  ON 9
 ud_0                 4.500646e-01 1 1  ON 10
 ud_1                 1.840164e-01 1 1  ON 11
 ud_2                 6.330748e-02 1 1  ON 12
 ud_3                -8.064967e-03 1 1  ON 13
 ud_4                -6.582508e-02 1 1  ON 14
 ud_5                -1.076051e-01 1 1  ON 15
 ud_6                -1.355793e-01 1 1  ON 16
 ud_7                -1.525233e-01 1 1  ON 17
 ud_8                -1.530440e-01 1 1  ON 18
 ud_9                -1.435093e-01 1 1  ON 19
 eO_0                -7.599476e-01 1 1  ON 20
 eO_1                -4.385109e-01 1 1  ON 21
 eO_2                -2.135905e-02 1 1  ON 22
 eO_3                 2.983520e-01 1 1  ON 23
 eO_4                 5.260342e-01 1 1  ON 24
 eO_5                 4.883435e-01 1 1  ON 25
 eO_6                 2.612025e-01 1 1  ON 26
 eO_7                -4.042695e-02 1 1  ON 27
 eO_8                -2.232507e-01 1 1  ON 28
 eO_9                -8.868690e-02 1 1  ON 29
eH1_0                -2.494133e-01 1 1  ON 30
eH1_1                -1.472260e-01 1 1  ON 31
eH1_2                -9.898265e-02 1 1  ON 32
eH1_3                -4.462925e-02 1 1  ON 33
eH1_4                 4.169387e-03 1 1  ON 34
eH1_5                 3.805490e-02 1 1  ON 35
eH1_6                 9.636915e-02 1 1  ON 36
eH1_7                 1.546683e-01 1 1  ON 37
eH1_8                 1.796418e-01 1 1  ON 38
eH1_9                 7.103704e-02 1 1  ON 39
eH2_0                -2.476066e-01 1 1  ON 40
eH2_1                -1.446156e-01 1 1  ON 41
eH2_2                -9.635385e-02 1 1  ON 42
eH2_3                -4.219550e-02 1 1  ON 43
eH2_4                 6.303788e-03 1 1  ON 44
eH2_5                 4.037236e-02 1 1  ON 45
eH2_6                 9.889255e-02 1 1  ON 46
eH2_7                 1.553292e-01 1 1  ON 47
eH2_8                 1.847915e-01 1 1  ON 48
eH2_9                 6.124667e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8937
    reference variance = 0.22959
====================================================
  Execution time = 1.9900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4045e-01
  Total weights = 2.0000e+06
  Execution time = 1.8861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340293785279
                                         uncertainty =       0.004169442686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340293785279
                                         uncertainty =       0.004169442686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412447961
  error estimate for blocks of size 2^( 2) =       0.000425425689
  error estimate for blocks of size 2^( 3) =       0.000437890444
  error estimate for blocks of size 2^( 4) =       0.000449796941
  error estimate for blocks of size 2^( 5) =       0.000460470877
  error estimate for blocks of size 2^( 6) =       0.000469909584
  error estimate for blocks of size 2^( 7) =       0.000471742168

      target function =                  N/A
              le_mean =     -16.906377956891
             les_mean =     286.165842091901
             stat err =       0.000462979893
             autocorr =       1.260044660255
              std dev =       0.583289499963
             le_variance =       0.340226640768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340584286646
                                         uncertainty =       0.004171968037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340584286646
                                         uncertainty =       0.004171968037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412623875
  error estimate for blocks of size 2^( 2) =       0.000425580890
  error estimate for blocks of size 2^( 3) =       0.000438029251
  error estimate for blocks of size 2^( 4) =       0.000449924125
  error estimate for blocks of size 2^( 5) =       0.000460590144
  error estimate for blocks of size 2^( 6) =       0.000470047993
  error estimate for blocks of size 2^( 7) =       0.000471887719

      target function =                  N/A
              le_mean =     -16.906374785780
             les_mean =     286.166025150699
             stat err =       0.000463112495
             autocorr =       1.259691770189
              std dev =       0.583538279556
             le_variance =       0.340516923707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340753771845
                                         uncertainty =       0.004174790751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340753771845
                                         uncertainty =       0.004174790751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412726503
  error estimate for blocks of size 2^( 2) =       0.000425680830
  error estimate for blocks of size 2^( 3) =       0.000438128317
  error estimate for blocks of size 2^( 4) =       0.000450023369
  error estimate for blocks of size 2^( 5) =       0.000460689657
  error estimate for blocks of size 2^( 6) =       0.000470152344
  error estimate for blocks of size 2^( 7) =       0.000471990490

      target function =                  N/A
              le_mean =     -16.906376411580
             les_mean =     286.166249532913
             stat err =       0.000463213965
             autocorr =       1.259617169275
              std dev =       0.583683418678
             le_variance =       0.340686333240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403734619
                                         uncertainty =       0.004170900029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403734619
                                         uncertainty =       0.004170900029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412514560
  error estimate for blocks of size 2^( 2) =       0.000425486998
  error estimate for blocks of size 2^( 3) =       0.000437947787
  error estimate for blocks of size 2^( 4) =       0.000449851645
  error estimate for blocks of size 2^( 5) =       0.000460523812
  error estimate for blocks of size 2^( 6) =       0.000469967515
  error estimate for blocks of size 2^( 7) =       0.000471800475

      target function =                  N/A
              le_mean =     -16.906377213606
             les_mean =     286.165926842883
             stat err =       0.000463035862
             autocorr =       1.259942404167
              std dev =       0.583383685340
             le_variance =       0.340336524321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906377956891        initial  <--
     6.2500e-02     6.2500e-01             3.2270e-03       -16.906374785780
     2.5000e-01     2.5000e+00             9.5037e-04       -16.906376411580
     1.0000e+00     1.0000e+01             2.5778e-04       -16.906377213606

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3568
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120933e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841957e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5155e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8799
    reference variance = 0.173448
====================================================
  Execution time = 2.0425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4479e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5597e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344390625251
                                         uncertainty =       0.006025203894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344390625251
                                         uncertainty =       0.006025203894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415203100
  error estimate for blocks of size 2^( 2) =       0.000428058694
  error estimate for blocks of size 2^( 3) =       0.000440812042
  error estimate for blocks of size 2^( 4) =       0.000451724044
  error estimate for blocks of size 2^( 5) =       0.000460085239
  error estimate for blocks of size 2^( 6) =       0.000467041503
  error estimate for blocks of size 2^( 7) =       0.000469384759

      target function =                  N/A
              le_mean =     -16.906684400338
             les_mean =     286.180764468202
             stat err =       0.000462058886
             autocorr =       1.238435748449
              std dev =       0.587185854705
             le_variance =       0.344787227966


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690668440034e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906684400338       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906685356997       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906685414647       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906685639439       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906686083151       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906686986056       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906686899064       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906686703135       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906686686425       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.897994e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906684400338       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906684679677       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906684673171       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906684657578       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906684835403       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906685013610       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906685014729       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906684980605       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.034237e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906684400338       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906684473234       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906684469455       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906684459068       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906684506389       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906684546826       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906684549830       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906684542819       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.632309e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153811 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5991e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.097718e-01 1 1  ON 0
 uu_1                 1.429262e-01 1 1  ON 1
 uu_2                 4.131886e-02 1 1  ON 2
 uu_3                -2.137406e-02 1 1  ON 3
 uu_4                -6.689812e-02 1 1  ON 4
 uu_5                -1.016675e-01 1 1  ON 5
 uu_6                -1.291138e-01 1 1  ON 6
 uu_7                -1.423518e-01 1 1  ON 7
 uu_8                -1.344582e-01 1 1  ON 8
 uu_9                -1.057530e-01 1 1  ON 9
 ud_0                 4.496503e-01 1 1  ON 10
 ud_1                 1.837822e-01 1 1  ON 11
 ud_2                 6.327977e-02 1 1  ON 12
 ud_3                -8.107341e-03 1 1  ON 13
 ud_4                -6.561708e-02 1 1  ON 14
 ud_5                -1.076119e-01 1 1  ON 15
 ud_6                -1.356633e-01 1 1  ON 16
 ud_7                -1.524696e-01 1 1  ON 17
 ud_8                -1.529325e-01 1 1  ON 18
 ud_9                -1.434662e-01 1 1  ON 19
 eO_0                -7.601261e-01 1 1  ON 20
 eO_1                -4.388898e-01 1 1  ON 21
 eO_2                -2.153607e-02 1 1  ON 22
 eO_3                 2.985667e-01 1 1  ON 23
 eO_4                 5.262654e-01 1 1  ON 24
 eO_5                 4.881518e-01 1 1  ON 25
 eO_6                 2.606708e-01 1 1  ON 26
 eO_7                -4.047530e-02 1 1  ON 27
 eO_8                -2.226530e-01 1 1  ON 28
 eO_9                -8.827438e-02 1 1  ON 29
eH1_0                -2.488065e-01 1 1  ON 30
eH1_1                -1.469060e-01 1 1  ON 31
eH1_2                -9.892350e-02 1 1  ON 32
eH1_3                -4.441841e-02 1 1  ON 33
eH1_4                 3.855007e-03 1 1  ON 34
eH1_5                 3.778230e-02 1 1  ON 35
eH1_6                 9.682323e-02 1 1  ON 36
eH1_7                 1.546510e-01 1 1  ON 37
eH1_8                 1.791700e-01 1 1  ON 38
eH1_9                 7.050078e-02 1 1  ON 39
eH2_0                -2.469571e-01 1 1  ON 40
eH2_1                -1.444386e-01 1 1  ON 41
eH2_2                -9.648284e-02 1 1  ON 42
eH2_3                -4.215494e-02 1 1  ON 43
eH2_4                 6.329359e-03 1 1  ON 44
eH2_5                 4.037093e-02 1 1  ON 45
eH2_6                 9.917887e-02 1 1  ON 46
eH2_7                 1.555053e-01 1 1  ON 47
eH2_8                 1.843854e-01 1 1  ON 48
eH2_9                 6.051759e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9327
    reference variance = 0.327764
====================================================
  Execution time = 2.1118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3911e-01
  Total weights = 2.0000e+06
  Execution time = 2.3657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339142558811
                                         uncertainty =       0.004330347871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339142558811
                                         uncertainty =       0.004330347871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411795893
  error estimate for blocks of size 2^( 2) =       0.000424269209
  error estimate for blocks of size 2^( 3) =       0.000437544057
  error estimate for blocks of size 2^( 4) =       0.000449841553
  error estimate for blocks of size 2^( 5) =       0.000461389022
  error estimate for blocks of size 2^( 6) =       0.000469855720
  error estimate for blocks of size 2^( 7) =       0.000477502540

      target function =                  N/A
              le_mean =     -16.906505386307
             les_mean =     286.169075921955
             stat err =       0.000464647209
             autocorr =       1.273158999483
              std dev =       0.582367336214
             le_variance =       0.339151714289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339053382090
                                         uncertainty =       0.004329653432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339053382090
                                         uncertainty =       0.004329653432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411741711
  error estimate for blocks of size 2^( 2) =       0.000424214954
  error estimate for blocks of size 2^( 3) =       0.000437488433
  error estimate for blocks of size 2^( 4) =       0.000449786769
  error estimate for blocks of size 2^( 5) =       0.000461335915
  error estimate for blocks of size 2^( 6) =       0.000469802535
  error estimate for blocks of size 2^( 7) =       0.000477448348

      target function =                  N/A
              le_mean =     -16.906505292240
             les_mean =     286.168983499793
             stat err =       0.000464593392
             autocorr =       1.273199112989
              std dev =       0.582290711575
             le_variance =       0.339062472787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339067563475
                                         uncertainty =       0.004329871195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339067563475
                                         uncertainty =       0.004329871195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411750337
  error estimate for blocks of size 2^( 2) =       0.000424224282
  error estimate for blocks of size 2^( 3) =       0.000437498905
  error estimate for blocks of size 2^( 4) =       0.000449797641
  error estimate for blocks of size 2^( 5) =       0.000461346135
  error estimate for blocks of size 2^( 6) =       0.000469812890
  error estimate for blocks of size 2^( 7) =       0.000477458711

      target function =                  N/A
              le_mean =     -16.906505077434
             les_mean =     286.168990443054
             stat err =       0.000464603844
             autocorr =       1.273203055841
              std dev =       0.582302910251
             le_variance =       0.339076679287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339131295651
                                         uncertainty =       0.004330277332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339131295651
                                         uncertainty =       0.004330277332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411789052
  error estimate for blocks of size 2^( 2) =       0.000424262491
  error estimate for blocks of size 2^( 3) =       0.000437537341
  error estimate for blocks of size 2^( 4) =       0.000449835037
  error estimate for blocks of size 2^( 5) =       0.000461382640
  error estimate for blocks of size 2^( 6) =       0.000469849352
  error estimate for blocks of size 2^( 7) =       0.000477496021

      target function =                  N/A
              le_mean =     -16.906505329414
             les_mean =     286.169062729893
             stat err =       0.000464640762
             autocorr =       1.273165974360
              std dev =       0.582357661537
             le_variance =       0.339140445950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906505386307        initial  <--
     6.2500e-01     6.2500e+00             3.8980e-04       -16.906505292240
     2.5000e+00     2.5000e+01             1.0342e-04       -16.906505077434
     1.0000e+01     1.0000e+02             2.6323e-05       -16.906505329414

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1489
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120933e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841957e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7147e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9007
    reference variance = 0.276714
====================================================
  Execution time = 2.0820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4293e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342963435166
                                         uncertainty =       0.008284748555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342963435166
                                         uncertainty =       0.008284748555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414086253
  error estimate for blocks of size 2^( 2) =       0.000426957142
  error estimate for blocks of size 2^( 3) =       0.000439799206
  error estimate for blocks of size 2^( 4) =       0.000451991712
  error estimate for blocks of size 2^( 5) =       0.000461477551
  error estimate for blocks of size 2^( 6) =       0.000469293303
  error estimate for blocks of size 2^( 7) =       0.000475555092

      target function =                  N/A
              le_mean =     -16.905990060400
             les_mean =     286.155434600051
             stat err =       0.000464579414
             autocorr =       1.258746568449
              std dev =       0.585606394397
             le_variance =       0.342934849159


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599006040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905990060400       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905990159157       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905990190284       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905990240731       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905990320512       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905990339498       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905990363130       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905990347760       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.900833e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905990060400       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905990085618       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905990094054       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905990107429       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905990128320       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905990133047       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905990139038       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905990135758       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 9.823840e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905990060400       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905990066739       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905990068891       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905990072293       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905990077573       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905990078755       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905990080256       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905990079474       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.460640e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156522 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6389e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.097776e-01 1 1  ON 0
 uu_1                 1.429045e-01 1 1  ON 1
 uu_2                 4.129152e-02 1 1  ON 2
 uu_3                -2.137405e-02 1 1  ON 3
 uu_4                -6.692671e-02 1 1  ON 4
 uu_5                -1.016692e-01 1 1  ON 5
 uu_6                -1.290962e-01 1 1  ON 6
 uu_7                -1.422704e-01 1 1  ON 7
 uu_8                -1.344293e-01 1 1  ON 8
 uu_9                -1.057384e-01 1 1  ON 9
 ud_0                 4.496419e-01 1 1  ON 10
 ud_1                 1.837500e-01 1 1  ON 11
 ud_2                 6.324652e-02 1 1  ON 12
 ud_3                -8.119705e-03 1 1  ON 13
 ud_4                -6.563252e-02 1 1  ON 14
 ud_5                -1.075724e-01 1 1  ON 15
 ud_6                -1.356839e-01 1 1  ON 16
 ud_7                -1.524642e-01 1 1  ON 17
 ud_8                -1.529158e-01 1 1  ON 18
 ud_9                -1.434510e-01 1 1  ON 19
 eO_0                -7.601553e-01 1 1  ON 20
 eO_1                -4.389277e-01 1 1  ON 21
 eO_2                -2.157846e-02 1 1  ON 22
 eO_3                 2.985989e-01 1 1  ON 23
 eO_4                 5.262943e-01 1 1  ON 24
 eO_5                 4.881248e-01 1 1  ON 25
 eO_6                 2.606478e-01 1 1  ON 26
 eO_7                -4.047627e-02 1 1  ON 27
 eO_8                -2.226051e-01 1 1  ON 28
 eO_9                -8.822932e-02 1 1  ON 29
eH1_0                -2.487129e-01 1 1  ON 30
eH1_1                -1.468871e-01 1 1  ON 31
eH1_2                -9.890423e-02 1 1  ON 32
eH1_3                -4.439151e-02 1 1  ON 33
eH1_4                 3.841973e-03 1 1  ON 34
eH1_5                 3.777893e-02 1 1  ON 35
eH1_6                 9.678956e-02 1 1  ON 36
eH1_7                 1.546444e-01 1 1  ON 37
eH1_8                 1.791267e-01 1 1  ON 38
eH1_9                 7.044798e-02 1 1  ON 39
eH2_0                -2.468757e-01 1 1  ON 40
eH2_1                -1.443752e-01 1 1  ON 41
eH2_2                -9.645440e-02 1 1  ON 42
eH2_3                -4.215469e-02 1 1  ON 43
eH2_4                 6.354806e-03 1 1  ON 44
eH2_5                 4.030368e-02 1 1  ON 45
eH2_6                 9.913544e-02 1 1  ON 46
eH2_7                 1.555129e-01 1 1  ON 47
eH2_8                 1.843509e-01 1 1  ON 48
eH2_9                 6.045577e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9184
    reference variance = 0.264543
====================================================
  Execution time = 2.0202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3543e-01
  Total weights = 2.0000e+06
  Execution time = 1.8755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335199525014
                                         uncertainty =       0.002851548195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335199525014
                                         uncertainty =       0.002851548195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409537935
  error estimate for blocks of size 2^( 2) =       0.000421904994
  error estimate for blocks of size 2^( 3) =       0.000434550563
  error estimate for blocks of size 2^( 4) =       0.000447559579
  error estimate for blocks of size 2^( 5) =       0.000459306452
  error estimate for blocks of size 2^( 6) =       0.000467326344
  error estimate for blocks of size 2^( 7) =       0.000472505934

      target function =                  N/A
              le_mean =     -16.906194870960
             les_mean =     286.154867487183
             stat err =       0.000461674577
             autocorr =       1.270818849773
              std dev =       0.579174101656
             le_variance =       0.335442640029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335171234828
                                         uncertainty =       0.002851428946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335171234828
                                         uncertainty =       0.002851428946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409520669
  error estimate for blocks of size 2^( 2) =       0.000421888195
  error estimate for blocks of size 2^( 3) =       0.000434533986
  error estimate for blocks of size 2^( 4) =       0.000447542951
  error estimate for blocks of size 2^( 5) =       0.000459290398
  error estimate for blocks of size 2^( 6) =       0.000467310605
  error estimate for blocks of size 2^( 7) =       0.000472490511

      target function =                  N/A
              le_mean =     -16.906194711511
             les_mean =     286.154833812992
             stat err =       0.000461658616
             autocorr =       1.270838134273
              std dev =       0.579149684597
             le_variance =       0.335414357169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335184393580
                                         uncertainty =       0.002851483669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335184393580
                                         uncertainty =       0.002851483669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409528700
  error estimate for blocks of size 2^( 2) =       0.000421896016
  error estimate for blocks of size 2^( 3) =       0.000434541712
  error estimate for blocks of size 2^( 4) =       0.000447550705
  error estimate for blocks of size 2^( 5) =       0.000459297884
  error estimate for blocks of size 2^( 6) =       0.000467317941
  error estimate for blocks of size 2^( 7) =       0.000472497697

      target function =                  N/A
              le_mean =     -16.906194788263
             les_mean =     286.154849563519
             stat err =       0.000461666057
             autocorr =       1.270829255668
              std dev =       0.579161041983
             le_variance =       0.335427512551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335197599746
                                         uncertainty =       0.002851539964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335197599746
                                         uncertainty =       0.002851539964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409536760
  error estimate for blocks of size 2^( 2) =       0.000421903852
  error estimate for blocks of size 2^( 3) =       0.000434549437
  error estimate for blocks of size 2^( 4) =       0.000447558450
  error estimate for blocks of size 2^( 5) =       0.000459305362
  error estimate for blocks of size 2^( 6) =       0.000467325275
  error estimate for blocks of size 2^( 7) =       0.000472504886

      target function =                  N/A
              le_mean =     -16.906194860435
             les_mean =     286.154865206528
             stat err =       0.000461673493
             autocorr =       1.270820176091
              std dev =       0.579172440008
             le_variance =       0.335440715265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906194870960        initial  <--
     6.2500e+00     6.2500e+01             3.9008e-05       -16.906194711511
     2.5000e+01     2.5000e+02             9.8238e-06       -16.906194788263
     1.0000e+02     1.0000e+03             2.4606e-06       -16.906194860435

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6779
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120933e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841957e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9165
    reference variance = 0.1982
====================================================
  Execution time = 2.0329e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4149e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341467098441
                                         uncertainty =       0.003341084935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341467098441
                                         uncertainty =       0.003341084935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413210506
  error estimate for blocks of size 2^( 2) =       0.000426200868
  error estimate for blocks of size 2^( 3) =       0.000440077677
  error estimate for blocks of size 2^( 4) =       0.000452370910
  error estimate for blocks of size 2^( 5) =       0.000462875319
  error estimate for blocks of size 2^( 6) =       0.000471393002
  error estimate for blocks of size 2^( 7) =       0.000475355090

      target function =                  N/A
              le_mean =     -16.905315191873
             les_mean =     286.131167410863
             stat err =       0.000465498580
             autocorr =       1.269094642212
              std dev =       0.584367902121
             le_variance =       0.341485845030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690531519187e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905315191873       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905315194705       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905315196280       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905315196211       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905315194556       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905315194963       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905315195683       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905315195868       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.664875e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905315191873       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905315192583       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905315192977       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905315192959       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905315192541       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905315192645       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905315192826       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905315192872       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 9.171541e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905315191873       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905315192051       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905315192149       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905315192145       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905315192040       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905315192066       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905315192111       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905315192123       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 2.293472e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159119 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5909e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429011e-01 1 1  ON 1
 uu_2                 4.129123e-02 1 1  ON 2
 uu_3                -2.137683e-02 1 1  ON 3
 uu_4                -6.692695e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290948e-01 1 1  ON 6
 uu_7                -1.422660e-01 1 1  ON 7
 uu_8                -1.344242e-01 1 1  ON 8
 uu_9                -1.057369e-01 1 1  ON 9
 ud_0                 4.496482e-01 1 1  ON 10
 ud_1                 1.837428e-01 1 1  ON 11
 ud_2                 6.324594e-02 1 1  ON 12
 ud_3                -8.121062e-03 1 1  ON 13
 ud_4                -6.563131e-02 1 1  ON 14
 ud_5                -1.075741e-01 1 1  ON 15
 ud_6                -1.356853e-01 1 1  ON 16
 ud_7                -1.524649e-01 1 1  ON 17
 ud_8                -1.529176e-01 1 1  ON 18
 ud_9                -1.434488e-01 1 1  ON 19
 eO_0                -7.601520e-01 1 1  ON 20
 eO_1                -4.389326e-01 1 1  ON 21
 eO_2                -2.158192e-02 1 1  ON 22
 eO_3                 2.986028e-01 1 1  ON 23
 eO_4                 5.262941e-01 1 1  ON 24
 eO_5                 4.881209e-01 1 1  ON 25
 eO_6                 2.606449e-01 1 1  ON 26
 eO_7                -4.047677e-02 1 1  ON 27
 eO_8                -2.226018e-01 1 1  ON 28
 eO_9                -8.822500e-02 1 1  ON 29
eH1_0                -2.487040e-01 1 1  ON 30
eH1_1                -1.468863e-01 1 1  ON 31
eH1_2                -9.890372e-02 1 1  ON 32
eH1_3                -4.438985e-02 1 1  ON 33
eH1_4                 3.842241e-03 1 1  ON 34
eH1_5                 3.777655e-02 1 1  ON 35
eH1_6                 9.678766e-02 1 1  ON 36
eH1_7                 1.546457e-01 1 1  ON 37
eH1_8                 1.791231e-01 1 1  ON 38
eH1_9                 7.044230e-02 1 1  ON 39
eH2_0                -2.468695e-01 1 1  ON 40
eH2_1                -1.443705e-01 1 1  ON 41
eH2_2                -9.645328e-02 1 1  ON 42
eH2_3                -4.215414e-02 1 1  ON 43
eH2_4                 6.354192e-03 1 1  ON 44
eH2_5                 4.030413e-02 1 1  ON 45
eH2_6                 9.913521e-02 1 1  ON 46
eH2_7                 1.555126e-01 1 1  ON 47
eH2_8                 1.843476e-01 1 1  ON 48
eH2_9                 6.044826e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9046
    reference variance = 0.178132
====================================================
  Execution time = 2.0139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3610e-01
  Total weights = 2.0000e+06
  Execution time = 1.8786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336064930490
                                         uncertainty =       0.003227229728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336064930490
                                         uncertainty =       0.003227229728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409936986
  error estimate for blocks of size 2^( 2) =       0.000422661368
  error estimate for blocks of size 2^( 3) =       0.000435987871
  error estimate for blocks of size 2^( 4) =       0.000448832117
  error estimate for blocks of size 2^( 5) =       0.000459937248
  error estimate for blocks of size 2^( 6) =       0.000466401142
  error estimate for blocks of size 2^( 7) =       0.000472976760

      target function =                  N/A
              le_mean =     -16.905455713851
             les_mean =     286.130529389579
             stat err =       0.000462036817
             autocorr =       1.270337032817
              std dev =       0.579738445048
             le_variance =       0.336096664666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336064638241
                                         uncertainty =       0.003227219354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336064638241
                                         uncertainty =       0.003227219354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409936808
  error estimate for blocks of size 2^( 2) =       0.000422661181
  error estimate for blocks of size 2^( 3) =       0.000435987667
  error estimate for blocks of size 2^( 4) =       0.000448831868
  error estimate for blocks of size 2^( 5) =       0.000459937017
  error estimate for blocks of size 2^( 6) =       0.000466400892
  error estimate for blocks of size 2^( 7) =       0.000472976465

      target function =                  N/A
              le_mean =     -16.905455700286
             les_mean =     286.130528638749
             stat err =       0.000462036561
             autocorr =       1.270336729894
              std dev =       0.579738193022
             le_variance =       0.336096372448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336064780974
                                         uncertainty =       0.003227224493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336064780974
                                         uncertainty =       0.003227224493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409936895
  error estimate for blocks of size 2^( 2) =       0.000422661273
  error estimate for blocks of size 2^( 3) =       0.000435987767
  error estimate for blocks of size 2^( 4) =       0.000448831991
  error estimate for blocks of size 2^( 5) =       0.000459937131
  error estimate for blocks of size 2^( 6) =       0.000466401015
  error estimate for blocks of size 2^( 7) =       0.000472976610

      target function =                  N/A
              le_mean =     -16.905455707056
             les_mean =     286.130529010355
             stat err =       0.000462036687
             autocorr =       1.270336883562
              std dev =       0.579738316110
             le_variance =       0.336096515166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336064911689
                                         uncertainty =       0.003227229072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336064911689
                                         uncertainty =       0.003227229072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409936974
  error estimate for blocks of size 2^( 2) =       0.000422661356
  error estimate for blocks of size 2^( 3) =       0.000435987858
  error estimate for blocks of size 2^( 4) =       0.000448832101
  error estimate for blocks of size 2^( 5) =       0.000459937233
  error estimate for blocks of size 2^( 6) =       0.000466401126
  error estimate for blocks of size 2^( 7) =       0.000472976741

      target function =                  N/A
              le_mean =     -16.905455713000
             les_mean =     286.130529342025
             stat err =       0.000462036800
             autocorr =       1.270337014222
              std dev =       0.579738428834
             le_variance =       0.336096645867


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905455713851        initial  <--
     6.2500e+01     6.2500e+02             3.6649e-06       -16.905455700286
     2.5000e+02     2.5000e+03             9.1715e-07       -16.905455707056
     1.0000e+03     1.0000e+04             2.2935e-07       -16.905455713000

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6274
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120933e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841957e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8375
    reference variance = 0.231792
====================================================
  Execution time = 2.0279e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3458e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334663461720
                                         uncertainty =       0.003373333823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334663461720
                                         uncertainty =       0.003373333823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409010101
  error estimate for blocks of size 2^( 2) =       0.000421614694
  error estimate for blocks of size 2^( 3) =       0.000434723305
  error estimate for blocks of size 2^( 4) =       0.000446314165
  error estimate for blocks of size 2^( 5) =       0.000455906280
  error estimate for blocks of size 2^( 6) =       0.000463402613
  error estimate for blocks of size 2^( 7) =       0.000466816045

      target function =                  N/A
              le_mean =     -16.905841643078
             les_mean =     286.142060018897
             stat err =       0.000458109776
             autocorr =       1.254501114627
              std dev =       0.578427631906
             le_variance =       0.334578525352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690584164308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905841643078       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905841645206       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905841644967       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905841645277       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905841645404       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905841644608       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905841645096       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905841645076       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.588588e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905841643078       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905841643610       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905841643550       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905841643628       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905841643659       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905841643461       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905841643581       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905841643578       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 8.971835e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905841643078       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905841643211       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905841643196       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905841643221       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905841643226       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905841643167       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905841643205       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905841643205       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 2.242982e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5842e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129105e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692725e-02 1 1  ON 4
 uu_5                -1.016713e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344242e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496484e-01 1 1  ON 10
 ud_1                 1.837426e-01 1 1  ON 11
 ud_2                 6.324590e-02 1 1  ON 12
 ud_3                -8.120928e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601516e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158213e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047705e-02 1 1  ON 27
 eO_8                -2.226014e-01 1 1  ON 28
 eO_9                -8.822438e-02 1 1  ON 29
eH1_0                -2.487032e-01 1 1  ON 30
eH1_1                -1.468866e-01 1 1  ON 31
eH1_2                -9.890363e-02 1 1  ON 32
eH1_3                -4.438926e-02 1 1  ON 33
eH1_4                 3.841946e-03 1 1  ON 34
eH1_5                 3.777666e-02 1 1  ON 35
eH1_6                 9.678771e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791225e-01 1 1  ON 38
eH1_9                 7.044161e-02 1 1  ON 39
eH2_0                -2.468692e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645266e-02 1 1  ON 42
eH2_3                -4.215408e-02 1 1  ON 43
eH2_4                 6.354533e-03 1 1  ON 44
eH2_5                 4.030375e-02 1 1  ON 45
eH2_6                 9.913492e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044753e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9198
    reference variance = 0.425914
====================================================
  Execution time = 2.0058e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.4365e-01
  Total weights = 2.0000e+06
  Execution time = 1.8693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443739468249
                                         uncertainty =       0.090323860150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443739468249
                                         uncertainty =       0.090323860150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470985675
  error estimate for blocks of size 2^( 2) =       0.000482239877
  error estimate for blocks of size 2^( 3) =       0.000493669476
  error estimate for blocks of size 2^( 4) =       0.000503949591
  error estimate for blocks of size 2^( 5) =       0.000513135531
  error estimate for blocks of size 2^( 6) =       0.000518533649
  error estimate for blocks of size 2^( 7) =       0.000523537098

      target function =                  N/A
              le_mean =     -16.906002230072
             les_mean =     286.256566193552
             stat err =       0.000514788967
             autocorr =       1.194656539809
              std dev =       0.666074329308
             le_variance =       0.443655012163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443739546407
                                         uncertainty =       0.090323887615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443739546407
                                         uncertainty =       0.090323887615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470985717
  error estimate for blocks of size 2^( 2) =       0.000482239913
  error estimate for blocks of size 2^( 3) =       0.000493669508
  error estimate for blocks of size 2^( 4) =       0.000503949622
  error estimate for blocks of size 2^( 5) =       0.000513135565
  error estimate for blocks of size 2^( 6) =       0.000518533684
  error estimate for blocks of size 2^( 7) =       0.000523537133

      target function =                  N/A
              le_mean =     -16.906002227740
             les_mean =     286.256566192833
             stat err =       0.000514789001
             autocorr =       1.194656486454
              std dev =       0.666074387982
             le_variance =       0.443655090326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443739507322
                                         uncertainty =       0.090323873886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443739507322
                                         uncertainty =       0.090323873886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470985696
  error estimate for blocks of size 2^( 2) =       0.000482239895
  error estimate for blocks of size 2^( 3) =       0.000493669492
  error estimate for blocks of size 2^( 4) =       0.000503949607
  error estimate for blocks of size 2^( 5) =       0.000513135548
  error estimate for blocks of size 2^( 6) =       0.000518533666
  error estimate for blocks of size 2^( 7) =       0.000523537116

      target function =                  N/A
              le_mean =     -16.906002228905
             les_mean =     286.256566193167
             stat err =       0.000514788984
             autocorr =       1.194656513130
              std dev =       0.666074358641
             le_variance =       0.443655051239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443739473133
                                         uncertainty =       0.090323861867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443739473133
                                         uncertainty =       0.090323861867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470985678
  error estimate for blocks of size 2^( 2) =       0.000482239879
  error estimate for blocks of size 2^( 3) =       0.000493669478
  error estimate for blocks of size 2^( 4) =       0.000503949593
  error estimate for blocks of size 2^( 5) =       0.000513135533
  error estimate for blocks of size 2^( 6) =       0.000518533651
  error estimate for blocks of size 2^( 7) =       0.000523537100

      target function =                  N/A
              le_mean =     -16.906002229927
             les_mean =     286.256566193502
             stat err =       0.000514788969
             autocorr =       1.194656536471
              std dev =       0.666074332974
             le_variance =       0.443655017047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906002230072        initial  <--
     6.2500e+02     6.2500e+03             3.5886e-07       -16.906002227740
     2.5000e+03     2.5000e+04             8.9718e-08       -16.906002228905
     1.0000e+04     1.0000e+05             2.2430e-08       -16.906002229927

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5139
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120933e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841957e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5363e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9299
    reference variance = 0.26605
====================================================
  Execution time = 2.0510e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3703e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337056648479
                                         uncertainty =       0.004604858531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337056648479
                                         uncertainty =       0.004604858531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410508524
  error estimate for blocks of size 2^( 2) =       0.000422837885
  error estimate for blocks of size 2^( 3) =       0.000435939586
  error estimate for blocks of size 2^( 4) =       0.000448401678
  error estimate for blocks of size 2^( 5) =       0.000457943560
  error estimate for blocks of size 2^( 6) =       0.000464510860
  error estimate for blocks of size 2^( 7) =       0.000473605895

      target function =                  N/A
              le_mean =     -16.906342136977
             les_mean =     286.161438780149
             stat err =       0.000461115498
             autocorr =       1.261755131742
              std dev =       0.580546721756
             le_variance =       0.337034496141


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634213698e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906342136977       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906342137385       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906342137588       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906342137565       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906342137455       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906342137423       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906342137457       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906342137455       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 4.612023e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906342136977       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906342137079       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906342137130       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906342137120       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906342137096       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906342137110       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906342137093       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906342137091       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 1.153011e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906342136977       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906342137003       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906342137015       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906342137003       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906342136979       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906342136884       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906342136989       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906342137012       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+05 is 2.882531e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6080e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692726e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324589e-02 1 1  ON 12
 ud_3                -8.120936e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158218e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226014e-01 1 1  ON 28
 eO_9                -8.822434e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841956e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354575e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8509
    reference variance = 0.17899
====================================================
  Execution time = 2.0091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4345e-01
  Total weights = 2.0000e+06
  Execution time = 1.8891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343405659037
                                         uncertainty =       0.005173140387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343405659037
                                         uncertainty =       0.005173140387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414395745
  error estimate for blocks of size 2^( 2) =       0.000426650307
  error estimate for blocks of size 2^( 3) =       0.000439478888
  error estimate for blocks of size 2^( 4) =       0.000452095525
  error estimate for blocks of size 2^( 5) =       0.000462899146
  error estimate for blocks of size 2^( 6) =       0.000469548709
  error estimate for blocks of size 2^( 7) =       0.000477570233

      target function =                  N/A
              le_mean =     -16.905600044080
             les_mean =     286.142760346353
             stat err =       0.000465528403
             autocorr =       1.262007079177
              std dev =       0.586044083406
             le_variance =       0.343447667696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343405670905
                                         uncertainty =       0.005173140684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343405670905
                                         uncertainty =       0.005173140684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414395753
  error estimate for blocks of size 2^( 2) =       0.000426650314
  error estimate for blocks of size 2^( 3) =       0.000439478894
  error estimate for blocks of size 2^( 4) =       0.000452095530
  error estimate for blocks of size 2^( 5) =       0.000462899151
  error estimate for blocks of size 2^( 6) =       0.000469548714
  error estimate for blocks of size 2^( 7) =       0.000477570237

      target function =                  N/A
              le_mean =     -16.905600043985
             les_mean =     286.142760355020
             stat err =       0.000465528408
             autocorr =       1.262007063086
              std dev =       0.586044093540
             le_variance =       0.343447679574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343405664971
                                         uncertainty =       0.005173140536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343405664971
                                         uncertainty =       0.005173140536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414395749
  error estimate for blocks of size 2^( 2) =       0.000426650311
  error estimate for blocks of size 2^( 3) =       0.000439478891
  error estimate for blocks of size 2^( 4) =       0.000452095527
  error estimate for blocks of size 2^( 5) =       0.000462899148
  error estimate for blocks of size 2^( 6) =       0.000469548712
  error estimate for blocks of size 2^( 7) =       0.000477570235

      target function =                  N/A
              le_mean =     -16.905600044032
             les_mean =     286.142760350687
             stat err =       0.000465528406
             autocorr =       1.262007071127
              std dev =       0.586044088473
             le_variance =       0.343447673635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343405659779
                                         uncertainty =       0.005173140406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343405659779
                                         uncertainty =       0.005173140406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414395746
  error estimate for blocks of size 2^( 2) =       0.000426650308
  error estimate for blocks of size 2^( 3) =       0.000439478889
  error estimate for blocks of size 2^( 4) =       0.000452095525
  error estimate for blocks of size 2^( 5) =       0.000462899146
  error estimate for blocks of size 2^( 6) =       0.000469548709
  error estimate for blocks of size 2^( 7) =       0.000477570233

      target function =                  N/A
              le_mean =     -16.905600044074
             les_mean =     286.142760346895
             stat err =       0.000465528403
             autocorr =       1.262007078171
              std dev =       0.586044084040
             le_variance =       0.343447668438


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905600044080        initial  <--
     6.2500e+03     6.2500e+04             4.6120e-08       -16.905600043985
     2.5000e+04     2.5000e+05             1.1530e-08       -16.905600044032
     1.0000e+05     1.0000e+06             2.8825e-09       -16.905600044074

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6344
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120933e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841957e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5746e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8774
    reference variance = 0.252223
====================================================
  Execution time = 2.0702e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3545e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335477999720
                                         uncertainty =       0.004364593949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335477999720
                                         uncertainty =       0.004364593949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409542304
  error estimate for blocks of size 2^( 2) =       0.000422119607
  error estimate for blocks of size 2^( 3) =       0.000434639252
  error estimate for blocks of size 2^( 4) =       0.000446158021
  error estimate for blocks of size 2^( 5) =       0.000456614449
  error estimate for blocks of size 2^( 6) =       0.000464177874
  error estimate for blocks of size 2^( 7) =       0.000467067364

      target function =                  N/A
              le_mean =     -16.906244371393
             les_mean =     286.156548374534
             stat err =       0.000458504427
             autocorr =       1.253399534228
              std dev =       0.579180280227
             le_variance =       0.335449797004


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624437139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906244371393       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244371395       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906244371410       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906244371408       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906244371371       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906244372059       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906244371401       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906244371412       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 4.112074e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906244371393       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244371393       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906244371397       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906244371397       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906244371237       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906244371512       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906244371506       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906244371479       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 1.028019e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906244371393       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244371393       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906244371394       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906244371319       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906244371399       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906244371394       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906244371394       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906244371440       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+06 is 2.570049e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6226e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120933e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841957e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.0409
    reference variance = 0.548468
====================================================
  Execution time = 2.0290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3456e-01
  Total weights = 2.0000e+06
  Execution time = 1.8831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622541007
                                         uncertainty =       0.003844563515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622541007
                                         uncertainty =       0.003844563515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408996216
  error estimate for blocks of size 2^( 2) =       0.000421392727
  error estimate for blocks of size 2^( 3) =       0.000434287394
  error estimate for blocks of size 2^( 4) =       0.000446155871
  error estimate for blocks of size 2^( 5) =       0.000456372257
  error estimate for blocks of size 2^( 6) =       0.000461976830
  error estimate for blocks of size 2^( 7) =       0.000462844120

      target function =                  N/A
              le_mean =     -16.906747191396
             les_mean =     286.172656235224
             stat err =       0.000456837269
             autocorr =       1.247626167246
              std dev =       0.578407995039
             le_variance =       0.334555808725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622543266
                                         uncertainty =       0.003844563544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622543266
                                         uncertainty =       0.003844563544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408996217
  error estimate for blocks of size 2^( 2) =       0.000421392729
  error estimate for blocks of size 2^( 3) =       0.000434287395
  error estimate for blocks of size 2^( 4) =       0.000446155872
  error estimate for blocks of size 2^( 5) =       0.000456372258
  error estimate for blocks of size 2^( 6) =       0.000461976831
  error estimate for blocks of size 2^( 7) =       0.000462844121

      target function =                  N/A
              le_mean =     -16.906747191429
             les_mean =     286.172656238594
             stat err =       0.000456837270
             autocorr =       1.247626164869
              std dev =       0.578407996992
             le_variance =       0.334555810984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622542136
                                         uncertainty =       0.003844563529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622542136
                                         uncertainty =       0.003844563529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408996216
  error estimate for blocks of size 2^( 2) =       0.000421392728
  error estimate for blocks of size 2^( 3) =       0.000434287395
  error estimate for blocks of size 2^( 4) =       0.000446155871
  error estimate for blocks of size 2^( 5) =       0.000456372258
  error estimate for blocks of size 2^( 6) =       0.000461976830
  error estimate for blocks of size 2^( 7) =       0.000462844121

      target function =                  N/A
              le_mean =     -16.906747191412
             les_mean =     286.172656236909
             stat err =       0.000456837270
             autocorr =       1.247626166052
              std dev =       0.578407996015
             le_variance =       0.334555809855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622541148
                                         uncertainty =       0.003844563517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622541148
                                         uncertainty =       0.003844563517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408996216
  error estimate for blocks of size 2^( 2) =       0.000421392728
  error estimate for blocks of size 2^( 3) =       0.000434287394
  error estimate for blocks of size 2^( 4) =       0.000446155871
  error estimate for blocks of size 2^( 5) =       0.000456372257
  error estimate for blocks of size 2^( 6) =       0.000461976830
  error estimate for blocks of size 2^( 7) =       0.000462844120

      target function =                  N/A
              le_mean =     -16.906747191398
             les_mean =     286.172656235434
             stat err =       0.000456837269
             autocorr =       1.247626167098
              std dev =       0.578407995161
             le_variance =       0.334555808866


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906747191396        initial
     6.2500e+04     6.2500e+05             4.1121e-09       -16.906747191429  <--
     2.5000e+05     2.5000e+06             1.0280e-09       -16.906747191412
     1.0000e+06     1.0000e+07             2.5700e-10       -16.906747191398

*****************************************************************************
Applying the update for shift_i =   6.2500e+04     and shift_s =   6.2500e+05
*****************************************************************************

  Execution time = 2.9810e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6044e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.292126
====================================================
  Execution time = 2.2834e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4180e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341845670003
                                         uncertainty =       0.004704627056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341845670003
                                         uncertainty =       0.004704627056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413399445
  error estimate for blocks of size 2^( 2) =       0.000426156123
  error estimate for blocks of size 2^( 3) =       0.000439285724
  error estimate for blocks of size 2^( 4) =       0.000451576978
  error estimate for blocks of size 2^( 5) =       0.000462678878
  error estimate for blocks of size 2^( 6) =       0.000469412616
  error estimate for blocks of size 2^( 7) =       0.000475623678

      target function =                  N/A
              le_mean =     -16.906134366163
             les_mean =     286.159177238820
             stat err =       0.000464823038
             autocorr =       1.264257414804
              std dev =       0.584635102401
             le_variance =       0.341798202959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613436616e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906134366163       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906134366167       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906134366170       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906134366134       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906134366141       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906134366134       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906134366146       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906134366159       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 2.084218e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906134366163       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906134366164       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906134366165       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906134366163       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906134366158       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906134366093       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906134366129       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906134366183       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 5.210564e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906134366163       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906134366163       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906134366163       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906134366411       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906134366183       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906134366092       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906134366266       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906134366225       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 1.302642e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8506e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120935e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8704
    reference variance = 0.428994
====================================================
  Execution time = 2.0632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3229e-01
  Total weights = 2.0000e+06
  Execution time = 1.8770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332304744188
                                         uncertainty =       0.002764015547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332304744188
                                         uncertainty =       0.002764015547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407606934
  error estimate for blocks of size 2^( 2) =       0.000420378804
  error estimate for blocks of size 2^( 3) =       0.000433550059
  error estimate for blocks of size 2^( 4) =       0.000445048120
  error estimate for blocks of size 2^( 5) =       0.000455684770
  error estimate for blocks of size 2^( 6) =       0.000463642204
  error estimate for blocks of size 2^( 7) =       0.000466875540

      target function =                  N/A
              le_mean =     -16.904946784612
             les_mean =     286.109512449506
             stat err =       0.000457812658
             autocorr =       1.261515138680
              std dev =       0.576443253991
             le_variance =       0.332286825072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332304747627
                                         uncertainty =       0.002764015596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332304747627
                                         uncertainty =       0.002764015596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407606936
  error estimate for blocks of size 2^( 2) =       0.000420378806
  error estimate for blocks of size 2^( 3) =       0.000433550061
  error estimate for blocks of size 2^( 4) =       0.000445048122
  error estimate for blocks of size 2^( 5) =       0.000455684771
  error estimate for blocks of size 2^( 6) =       0.000463642205
  error estimate for blocks of size 2^( 7) =       0.000466875541

      target function =                  N/A
              le_mean =     -16.904946784544
             les_mean =     286.109512450619
             stat err =       0.000457812660
             autocorr =       1.261515132615
              std dev =       0.576443256974
             le_variance =       0.332286828511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332304745908
                                         uncertainty =       0.002764015572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332304745908
                                         uncertainty =       0.002764015572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407606935
  error estimate for blocks of size 2^( 2) =       0.000420378805
  error estimate for blocks of size 2^( 3) =       0.000433550060
  error estimate for blocks of size 2^( 4) =       0.000445048121
  error estimate for blocks of size 2^( 5) =       0.000455684770
  error estimate for blocks of size 2^( 6) =       0.000463642204
  error estimate for blocks of size 2^( 7) =       0.000466875540

      target function =                  N/A
              le_mean =     -16.904946784578
             les_mean =     286.109512450062
             stat err =       0.000457812659
             autocorr =       1.261515135649
              std dev =       0.576443255482
             le_variance =       0.332286826791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332304744403
                                         uncertainty =       0.002764015550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332304744403
                                         uncertainty =       0.002764015550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407606934
  error estimate for blocks of size 2^( 2) =       0.000420378804
  error estimate for blocks of size 2^( 3) =       0.000433550059
  error estimate for blocks of size 2^( 4) =       0.000445048120
  error estimate for blocks of size 2^( 5) =       0.000455684770
  error estimate for blocks of size 2^( 6) =       0.000463642204
  error estimate for blocks of size 2^( 7) =       0.000466875540

      target function =                  N/A
              le_mean =     -16.904946784608
             les_mean =     286.109512449575
             stat err =       0.000457812658
             autocorr =       1.261515138306
              std dev =       0.576443254177
             le_variance =       0.332286825286


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904946784612        initial  <--
     1.5625e+04     1.5625e+05             2.0842e-08       -16.904946784544
     6.2500e+04     6.2500e+05             5.2106e-09       -16.904946784578
     2.5000e+05     2.5000e+06             1.3026e-09       -16.904946784608

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1174
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8630e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9046
    reference variance = 0.28659
====================================================
  Execution time = 2.0758e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3599e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335941194251
                                         uncertainty =       0.002948412340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335941194251
                                         uncertainty =       0.002948412340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409871079
  error estimate for blocks of size 2^( 2) =       0.000422557133
  error estimate for blocks of size 2^( 3) =       0.000435583268
  error estimate for blocks of size 2^( 4) =       0.000448419838
  error estimate for blocks of size 2^( 5) =       0.000459609439
  error estimate for blocks of size 2^( 6) =       0.000466287694
  error estimate for blocks of size 2^( 7) =       0.000469513489

      target function =                  N/A
              le_mean =     -16.905911655446
             les_mean =     286.145837336740
             stat err =       0.000460957615
             autocorr =       1.264816253177
              std dev =       0.579645238920
             le_variance =       0.335988603003


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591165545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905911655446       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905911655444       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905911655446       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905911655443       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905911655562       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905911655452       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905911655370       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905911655448       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.972225e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905911655446       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905911655445       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905911655446       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905911655445       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905911655463       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905911655095       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905911655230       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905911655494       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 4.930564e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905911655446       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905911655445       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905911655446       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905911657157       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905911654469       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905911655478       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905911654679       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905911654063       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 1.232641e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6267e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8659
    reference variance = 0.329343
====================================================
  Execution time = 2.0455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3895e-01
  Total weights = 2.0000e+06
  Execution time = 1.8793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338991300867
                                         uncertainty =       0.004264069789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338991300867
                                         uncertainty =       0.004264069789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411675606
  error estimate for blocks of size 2^( 2) =       0.000424108354
  error estimate for blocks of size 2^( 3) =       0.000436917398
  error estimate for blocks of size 2^( 4) =       0.000449076653
  error estimate for blocks of size 2^( 5) =       0.000459254484
  error estimate for blocks of size 2^( 6) =       0.000466621344
  error estimate for blocks of size 2^( 7) =       0.000472514945

      target function =                  N/A
              le_mean =     -16.906437868610
             les_mean =     286.166594845110
             stat err =       0.000461866856
             autocorr =       1.258703179545
              std dev =       0.582197225531
             le_variance =       0.338953609416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338991300567
                                         uncertainty =       0.004264069777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338991300567
                                         uncertainty =       0.004264069777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411675606
  error estimate for blocks of size 2^( 2) =       0.000424108354
  error estimate for blocks of size 2^( 3) =       0.000436917398
  error estimate for blocks of size 2^( 4) =       0.000449076652
  error estimate for blocks of size 2^( 5) =       0.000459254484
  error estimate for blocks of size 2^( 6) =       0.000466621343
  error estimate for blocks of size 2^( 7) =       0.000472514944

      target function =                  N/A
              le_mean =     -16.906437868603
             les_mean =     286.166594844588
             stat err =       0.000461866856
             autocorr =       1.258703179628
              std dev =       0.582197225274
             le_variance =       0.338953609117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338991300717
                                         uncertainty =       0.004264069783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338991300717
                                         uncertainty =       0.004264069783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411675606
  error estimate for blocks of size 2^( 2) =       0.000424108354
  error estimate for blocks of size 2^( 3) =       0.000436917398
  error estimate for blocks of size 2^( 4) =       0.000449076653
  error estimate for blocks of size 2^( 5) =       0.000459254484
  error estimate for blocks of size 2^( 6) =       0.000466621344
  error estimate for blocks of size 2^( 7) =       0.000472514945

      target function =                  N/A
              le_mean =     -16.906437868607
             les_mean =     286.166594844849
             stat err =       0.000461866856
             autocorr =       1.258703179592
              std dev =       0.582197225402
             le_variance =       0.338953609266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338991300848
                                         uncertainty =       0.004264069788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338991300848
                                         uncertainty =       0.004264069788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411675606
  error estimate for blocks of size 2^( 2) =       0.000424108354
  error estimate for blocks of size 2^( 3) =       0.000436917398
  error estimate for blocks of size 2^( 4) =       0.000449076653
  error estimate for blocks of size 2^( 5) =       0.000459254484
  error estimate for blocks of size 2^( 6) =       0.000466621344
  error estimate for blocks of size 2^( 7) =       0.000472514945

      target function =                  N/A
              le_mean =     -16.906437868610
             les_mean =     286.166594845077
             stat err =       0.000461866856
             autocorr =       1.258703179564
              std dev =       0.582197225515
             le_variance =       0.338953609397


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906437868610        initial  <--
     1.5625e+05     1.5625e+06             1.9722e-09       -16.906437868603
     6.2500e+05     6.2500e+06             4.9306e-10       -16.906437868607
     2.5000e+06     2.5000e+07             1.2326e-10       -16.906437868610

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9454
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6220e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9362
    reference variance = 0.178571
====================================================
  Execution time = 2.0696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3590e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335941926188
                                         uncertainty =       0.003391183102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335941926188
                                         uncertainty =       0.003391183102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409814968
  error estimate for blocks of size 2^( 2) =       0.000422325933
  error estimate for blocks of size 2^( 3) =       0.000434985618
  error estimate for blocks of size 2^( 4) =       0.000446478608
  error estimate for blocks of size 2^( 5) =       0.000458342301
  error estimate for blocks of size 2^( 6) =       0.000468778003
  error estimate for blocks of size 2^( 7) =       0.000475174999

      target function =                  N/A
              le_mean =     -16.906289609312
             les_mean =     286.158524801629
             stat err =       0.000462193478
             autocorr =       1.271955722603
              std dev =       0.579565885498
             le_variance =       0.335896615633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628960931e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906289609312       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906289609313       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906289609312       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906289609296       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906289609061       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906289609197       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906289609606       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906289609383       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.220736e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906289609312       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906289609312       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906289609312       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906289607913       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906289609735       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906289613735       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906289604523       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906289610290       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 3.051854e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906289609312       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906289609312       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906289609312       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906289607288       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906289611378       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906289593758       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906289610864       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906289609312       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+07 is 7.629558e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174770 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6424e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8269
    reference variance = 0.365722
====================================================
  Execution time = 2.0306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3386e-01
  Total weights = 2.0000e+06
  Execution time = 2.0385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333805140374
                                         uncertainty =       0.003688637617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333805140374
                                         uncertainty =       0.003688637617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408569203
  error estimate for blocks of size 2^( 2) =       0.000421061081
  error estimate for blocks of size 2^( 3) =       0.000433927671
  error estimate for blocks of size 2^( 4) =       0.000445112065
  error estimate for blocks of size 2^( 5) =       0.000455217719
  error estimate for blocks of size 2^( 6) =       0.000462795832
  error estimate for blocks of size 2^( 7) =       0.000467624073

      target function =                  N/A
              le_mean =     -16.906885909575
             les_mean =     286.176648580291
             stat err =       0.000457687423
             autocorr =       1.254893010745
              std dev =       0.577804108533
             le_variance =       0.333857587838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333805140322
                                         uncertainty =       0.003688637616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333805140322
                                         uncertainty =       0.003688637616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408569203
  error estimate for blocks of size 2^( 2) =       0.000421061081
  error estimate for blocks of size 2^( 3) =       0.000433927671
  error estimate for blocks of size 2^( 4) =       0.000445112065
  error estimate for blocks of size 2^( 5) =       0.000455217719
  error estimate for blocks of size 2^( 6) =       0.000462795832
  error estimate for blocks of size 2^( 7) =       0.000467624073

      target function =                  N/A
              le_mean =     -16.906885909574
             les_mean =     286.176648580211
             stat err =       0.000457687423
             autocorr =       1.254893010783
              std dev =       0.577804108489
             le_variance =       0.333857587786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333805140348
                                         uncertainty =       0.003688637616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333805140348
                                         uncertainty =       0.003688637616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408569203
  error estimate for blocks of size 2^( 2) =       0.000421061081
  error estimate for blocks of size 2^( 3) =       0.000433927671
  error estimate for blocks of size 2^( 4) =       0.000445112065
  error estimate for blocks of size 2^( 5) =       0.000455217719
  error estimate for blocks of size 2^( 6) =       0.000462795832
  error estimate for blocks of size 2^( 7) =       0.000467624073

      target function =                  N/A
              le_mean =     -16.906885909574
             les_mean =     286.176648580251
             stat err =       0.000457687423
             autocorr =       1.254893010764
              std dev =       0.577804108511
             le_variance =       0.333857587812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333805140370
                                         uncertainty =       0.003688637617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333805140370
                                         uncertainty =       0.003688637617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408569203
  error estimate for blocks of size 2^( 2) =       0.000421061081
  error estimate for blocks of size 2^( 3) =       0.000433927671
  error estimate for blocks of size 2^( 4) =       0.000445112065
  error estimate for blocks of size 2^( 5) =       0.000455217719
  error estimate for blocks of size 2^( 6) =       0.000462795832
  error estimate for blocks of size 2^( 7) =       0.000467624073

      target function =                  N/A
              le_mean =     -16.906885909575
             les_mean =     286.176648580286
             stat err =       0.000457687423
             autocorr =       1.254893010749
              std dev =       0.577804108530
             le_variance =       0.333857587834


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906885909575        initial  <--
     1.5625e+06     1.5625e+07             1.2207e-10       -16.906885909574
     6.2500e+06     6.2500e+07             3.0519e-11       -16.906885909574
     2.5000e+07     2.5000e+08             7.6296e-12       -16.906885909575

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1415
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6575e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9037
    reference variance = 0.206991
====================================================
  Execution time = 2.0621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4687e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346791601390
                                         uncertainty =       0.004558167714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346791601390
                                         uncertainty =       0.004558167714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416453786
  error estimate for blocks of size 2^( 2) =       0.000429071896
  error estimate for blocks of size 2^( 3) =       0.000442416551
  error estimate for blocks of size 2^( 4) =       0.000454519610
  error estimate for blocks of size 2^( 5) =       0.000465916185
  error estimate for blocks of size 2^( 6) =       0.000472765752
  error estimate for blocks of size 2^( 7) =       0.000480028854

      target function =                  N/A
              le_mean =     -16.906193898617
             les_mean =     286.166259475819
             stat err =       0.000468307600
             autocorr =       1.264528968605
              std dev =       0.588954592167
             le_variance =       0.346867511634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619389862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193898617       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193898617       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906193898617       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193898368       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193905362       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193898508       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193883388       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906193903353       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.695008e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193898617       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193898617       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906193898617       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193890638       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193906017       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193836635       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193895445       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906193891182       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 4.237567e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193898617       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193898617       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906193898617       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193759533       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193878828       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193828354       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193875249       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906194090477       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+08 is 1.059375e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177380 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6360e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8965
    reference variance = 0.227808
====================================================
  Execution time = 2.0478e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5041e-01
  Total weights = 2.0000e+06
  Execution time = 1.8799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350437391821
                                         uncertainty =       0.011283255632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350437391821
                                         uncertainty =       0.011283255632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418576165
  error estimate for blocks of size 2^( 2) =       0.000431097835
  error estimate for blocks of size 2^( 3) =       0.000443824083
  error estimate for blocks of size 2^( 4) =       0.000455285005
  error estimate for blocks of size 2^( 5) =       0.000464312450
  error estimate for blocks of size 2^( 6) =       0.000471623628
  error estimate for blocks of size 2^( 7) =       0.000472918582

      target function =                  N/A
              le_mean =     -16.906614907800
             les_mean =     286.184039477224
             stat err =       0.000466034916
             autocorr =       1.239618140605
              std dev =       0.591956089392
             le_variance =       0.350412011768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350437391806
                                         uncertainty =       0.011283255631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350437391806
                                         uncertainty =       0.011283255631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418576165
  error estimate for blocks of size 2^( 2) =       0.000431097835
  error estimate for blocks of size 2^( 3) =       0.000443824083
  error estimate for blocks of size 2^( 4) =       0.000455285005
  error estimate for blocks of size 2^( 5) =       0.000464312450
  error estimate for blocks of size 2^( 6) =       0.000471623628
  error estimate for blocks of size 2^( 7) =       0.000472918582

      target function =                  N/A
              le_mean =     -16.906614907801
             les_mean =     286.184039477214
             stat err =       0.000466034916
             autocorr =       1.239618140622
              std dev =       0.591956089379
             le_variance =       0.350412011753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350437391814
                                         uncertainty =       0.011283255632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350437391814
                                         uncertainty =       0.011283255632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418576165
  error estimate for blocks of size 2^( 2) =       0.000431097835
  error estimate for blocks of size 2^( 3) =       0.000443824083
  error estimate for blocks of size 2^( 4) =       0.000455285005
  error estimate for blocks of size 2^( 5) =       0.000464312450
  error estimate for blocks of size 2^( 6) =       0.000471623628
  error estimate for blocks of size 2^( 7) =       0.000472918582

      target function =                  N/A
              le_mean =     -16.906614907801
             les_mean =     286.184039477219
             stat err =       0.000466034916
             autocorr =       1.239618140610
              std dev =       0.591956089386
             le_variance =       0.350412011761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350437391820
                                         uncertainty =       0.011283255632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350437391820
                                         uncertainty =       0.011283255632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418576165
  error estimate for blocks of size 2^( 2) =       0.000431097835
  error estimate for blocks of size 2^( 3) =       0.000443824083
  error estimate for blocks of size 2^( 4) =       0.000455285005
  error estimate for blocks of size 2^( 5) =       0.000464312450
  error estimate for blocks of size 2^( 6) =       0.000471623628
  error estimate for blocks of size 2^( 7) =       0.000472918582

      target function =                  N/A
              le_mean =     -16.906614907801
             les_mean =     286.184039477223
             stat err =       0.000466034916
             autocorr =       1.239618140606
              std dev =       0.591956089391
             le_variance =       0.350412011767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906614907800        initial
     1.5625e+07     1.5625e+08             1.6950e-11       -16.906614907801  <--
     6.2500e+07     6.2500e+08             4.2376e-12       -16.906614907801
     2.5000e+08     2.5000e+09             1.0594e-12       -16.906614907801

*****************************************************************************
Applying the update for shift_i =   1.5625e+07     and shift_s =   1.5625e+08
*****************************************************************************

  Execution time = 2.9973e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6339e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8479
    reference variance = 0.503783
====================================================
  Execution time = 2.0823e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4388e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343834390228
                                         uncertainty =       0.007387597179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343834390228
                                         uncertainty =       0.007387597179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414654919
  error estimate for blocks of size 2^( 2) =       0.000427510301
  error estimate for blocks of size 2^( 3) =       0.000439903116
  error estimate for blocks of size 2^( 4) =       0.000452341609
  error estimate for blocks of size 2^( 5) =       0.000463046081
  error estimate for blocks of size 2^( 6) =       0.000470429518
  error estimate for blocks of size 2^( 7) =       0.000475017966

      target function =                  N/A
              le_mean =     -16.905890860120
             les_mean =     286.153023006369
             stat err =       0.000465208793
             autocorr =       1.258699866695
              std dev =       0.586410610415
             le_variance =       0.343877404007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589086012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905890860120       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905890860120       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905890860120       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905890860120       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905890860136       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905890857849       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905890861476       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905890860996       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 7.330008e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905890860120       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905890860120       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905890860120       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905890860349       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905890861384       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905890852827       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905890871452       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905890862366       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.832507e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905890860120       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905890860120       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905890860120       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905890863778       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905890872262       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905890827500       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905890858667       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905890817861       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 4.581196e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6407e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.0347
    reference variance = 0.192636
====================================================
  Execution time = 2.0157e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3536e-01
  Total weights = 2.0000e+06
  Execution time = 1.8822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335268420649
                                         uncertainty =       0.003123057114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335268420649
                                         uncertainty =       0.003123057114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409484717
  error estimate for blocks of size 2^( 2) =       0.000421970641
  error estimate for blocks of size 2^( 3) =       0.000434552923
  error estimate for blocks of size 2^( 4) =       0.000445881979
  error estimate for blocks of size 2^( 5) =       0.000454990327
  error estimate for blocks of size 2^( 6) =       0.000463175109
  error estimate for blocks of size 2^( 7) =       0.000467968946

      target function =                  N/A
              le_mean =     -16.906453921265
             les_mean =     286.163539491090
             stat err =       0.000458004090
             autocorr =       1.251017307781
              std dev =       0.579098840374
             le_variance =       0.335355466922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335268420666
                                         uncertainty =       0.003123057114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335268420666
                                         uncertainty =       0.003123057114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409484717
  error estimate for blocks of size 2^( 2) =       0.000421970641
  error estimate for blocks of size 2^( 3) =       0.000434552923
  error estimate for blocks of size 2^( 4) =       0.000445881979
  error estimate for blocks of size 2^( 5) =       0.000454990327
  error estimate for blocks of size 2^( 6) =       0.000463175109
  error estimate for blocks of size 2^( 7) =       0.000467968946

      target function =                  N/A
              le_mean =     -16.906453921264
             les_mean =     286.163539491100
             stat err =       0.000458004090
             autocorr =       1.251017307754
              std dev =       0.579098840388
             le_variance =       0.335355466939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335268420658
                                         uncertainty =       0.003123057114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335268420658
                                         uncertainty =       0.003123057114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409484717
  error estimate for blocks of size 2^( 2) =       0.000421970641
  error estimate for blocks of size 2^( 3) =       0.000434552923
  error estimate for blocks of size 2^( 4) =       0.000445881979
  error estimate for blocks of size 2^( 5) =       0.000454990327
  error estimate for blocks of size 2^( 6) =       0.000463175109
  error estimate for blocks of size 2^( 7) =       0.000467968946

      target function =                  N/A
              le_mean =     -16.906453921265
             les_mean =     286.163539491095
             stat err =       0.000458004090
             autocorr =       1.251017307772
              std dev =       0.579098840381
             le_variance =       0.335355466930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335268420650
                                         uncertainty =       0.003123057114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335268420650
                                         uncertainty =       0.003123057114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409484717
  error estimate for blocks of size 2^( 2) =       0.000421970641
  error estimate for blocks of size 2^( 3) =       0.000434552923
  error estimate for blocks of size 2^( 4) =       0.000445881979
  error estimate for blocks of size 2^( 5) =       0.000454990327
  error estimate for blocks of size 2^( 6) =       0.000463175109
  error estimate for blocks of size 2^( 7) =       0.000467968946

      target function =                  N/A
              le_mean =     -16.906453921265
             les_mean =     286.163539491091
             stat err =       0.000458004090
             autocorr =       1.251017307781
              std dev =       0.579098840375
             le_variance =       0.335355466923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906453921265        initial  <--
     3.9062e+06     3.9062e+07             7.3300e-11       -16.906453921264
     1.5625e+07     1.5625e+08             1.8325e-11       -16.906453921265
     6.2500e+07     6.2500e+08             4.5812e-12       -16.906453921265

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6749
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8338
    reference variance = 0.727194
====================================================
  Execution time = 2.0475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3716e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337067805605
                                         uncertainty =       0.003414682526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337067805605
                                         uncertainty =       0.003414682526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410586426
  error estimate for blocks of size 2^( 2) =       0.000423506166
  error estimate for blocks of size 2^( 3) =       0.000436557245
  error estimate for blocks of size 2^( 4) =       0.000448101600
  error estimate for blocks of size 2^( 5) =       0.000459001194
  error estimate for blocks of size 2^( 6) =       0.000464944861
  error estimate for blocks of size 2^( 7) =       0.000472512655

      target function =                  N/A
              le_mean =     -16.906223707797
             les_mean =     286.157562315306
             stat err =       0.000461140077
             autocorr =       1.261410848741
              std dev =       0.580656891648
             le_variance =       0.337162425819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622370780e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223707797       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223707797       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223707797       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223707797       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223708291       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223707943       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223756824       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906223692760       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 5.990916e-12

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223707797       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223707797       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223707797       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223707493       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223632267       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223710487       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223756694       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906223834366       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 1.497682e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223707797       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223707797       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223707797       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223707797       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223707797       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223979164       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906224180424       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906223499274       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+08 is 3.745774e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182572 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9291e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9445
    reference variance = 0.266963
====================================================
  Execution time = 1.9983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3252e-01
  Total weights = 2.0000e+06
  Execution time = 1.8871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332414679254
                                         uncertainty =       0.002437562770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332414679254
                                         uncertainty =       0.002437562770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407750885
  error estimate for blocks of size 2^( 2) =       0.000420431596
  error estimate for blocks of size 2^( 3) =       0.000433293770
  error estimate for blocks of size 2^( 4) =       0.000444770002
  error estimate for blocks of size 2^( 5) =       0.000454910685
  error estimate for blocks of size 2^( 6) =       0.000462399594
  error estimate for blocks of size 2^( 7) =       0.000469602040

      target function =                  N/A
              le_mean =     -16.906939655903
             les_mean =     286.177129930947
             stat err =       0.000457920580
             autocorr =       1.261218984840
              std dev =       0.576646832017
             le_variance =       0.332521568875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332414679252
                                         uncertainty =       0.002437562770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332414679252
                                         uncertainty =       0.002437562770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407750885
  error estimate for blocks of size 2^( 2) =       0.000420431596
  error estimate for blocks of size 2^( 3) =       0.000433293770
  error estimate for blocks of size 2^( 4) =       0.000444770002
  error estimate for blocks of size 2^( 5) =       0.000454910685
  error estimate for blocks of size 2^( 6) =       0.000462399594
  error estimate for blocks of size 2^( 7) =       0.000469602040

      target function =                  N/A
              le_mean =     -16.906939655903
             les_mean =     286.177129930945
             stat err =       0.000457920580
             autocorr =       1.261218984844
              std dev =       0.576646832015
             le_variance =       0.332521568873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332414679253
                                         uncertainty =       0.002437562770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332414679253
                                         uncertainty =       0.002437562770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407750885
  error estimate for blocks of size 2^( 2) =       0.000420431596
  error estimate for blocks of size 2^( 3) =       0.000433293770
  error estimate for blocks of size 2^( 4) =       0.000444770002
  error estimate for blocks of size 2^( 5) =       0.000454910685
  error estimate for blocks of size 2^( 6) =       0.000462399594
  error estimate for blocks of size 2^( 7) =       0.000469602040

      target function =                  N/A
              le_mean =     -16.906939655903
             les_mean =     286.177129930946
             stat err =       0.000457920580
             autocorr =       1.261218984839
              std dev =       0.576646832016
             le_variance =       0.332521568874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332414679254
                                         uncertainty =       0.002437562770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332414679254
                                         uncertainty =       0.002437562770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407750885
  error estimate for blocks of size 2^( 2) =       0.000420431596
  error estimate for blocks of size 2^( 3) =       0.000433293770
  error estimate for blocks of size 2^( 4) =       0.000444770002
  error estimate for blocks of size 2^( 5) =       0.000454910685
  error estimate for blocks of size 2^( 6) =       0.000462399594
  error estimate for blocks of size 2^( 7) =       0.000469602040

      target function =                  N/A
              le_mean =     -16.906939655903
             les_mean =     286.177129930947
             stat err =       0.000457920580
             autocorr =       1.261218984837
              std dev =       0.576646832017
             le_variance =       0.332521568875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906939655903        initial
     3.9062e+07     3.9062e+08             5.9909e-12       -16.906939655903  <--
     1.5625e+08     1.5625e+09             1.4977e-12       -16.906939655903
     6.2500e+08     6.2500e+09             3.7458e-13       -16.906939655903

*****************************************************************************
Applying the update for shift_i =   3.9062e+07     and shift_s =   3.9062e+08
*****************************************************************************

  Execution time = 2.9534e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8897e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.0288
    reference variance = 0.617611
====================================================
  Execution time = 2.0527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3755e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337622814407
                                         uncertainty =       0.003215039816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337622814407
                                         uncertainty =       0.003215039816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410823873
  error estimate for blocks of size 2^( 2) =       0.000423338929
  error estimate for blocks of size 2^( 3) =       0.000435857367
  error estimate for blocks of size 2^( 4) =       0.000447702834
  error estimate for blocks of size 2^( 5) =       0.000458546908
  error estimate for blocks of size 2^( 6) =       0.000465802941
  error estimate for blocks of size 2^( 7) =       0.000470574480

      target function =                  N/A
              le_mean =     -16.906232811807
             les_mean =     286.158260228066
             stat err =       0.000460656791
             autocorr =       1.257313590045
              std dev =       0.580992693433
             le_variance =       0.337552509823


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623281181e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906232811807       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906232811807       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906232811807       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906232811807       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906232814865       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906232811806       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906232808962       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906232767902       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 3.288123e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906232811807       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906232811807       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906232811807       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906232811884       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906232821074       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906232803599       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906232750288       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906232851761       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 8.220198e-12

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906232811807       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906232811807       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906232811807       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906232811807       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906232822376       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906232731740       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906232958895       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906232522703       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 2.055065e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185186 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6032e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9006
    reference variance = 0.200412
====================================================
  Execution time = 1.9878e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4062e-01
  Total weights = 2.0000e+06
  Execution time = 1.8862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340634598008
                                         uncertainty =       0.004101785287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340634598008
                                         uncertainty =       0.004101785287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412688502
  error estimate for blocks of size 2^( 2) =       0.000425164047
  error estimate for blocks of size 2^( 3) =       0.000437597151
  error estimate for blocks of size 2^( 4) =       0.000448990702
  error estimate for blocks of size 2^( 5) =       0.000458676636
  error estimate for blocks of size 2^( 6) =       0.000467349267
  error estimate for blocks of size 2^( 7) =       0.000471865763

      target function =                  N/A
              le_mean =     -16.906510375296
             les_mean =     286.170716499222
             stat err =       0.000461720592
             autocorr =       1.251738901541
              std dev =       0.583629676709
             le_variance =       0.340623599536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340634598001
                                         uncertainty =       0.004101785287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340634598001
                                         uncertainty =       0.004101785287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412688502
  error estimate for blocks of size 2^( 2) =       0.000425164047
  error estimate for blocks of size 2^( 3) =       0.000437597151
  error estimate for blocks of size 2^( 4) =       0.000448990702
  error estimate for blocks of size 2^( 5) =       0.000458676636
  error estimate for blocks of size 2^( 6) =       0.000467349267
  error estimate for blocks of size 2^( 7) =       0.000471865763

      target function =                  N/A
              le_mean =     -16.906510375296
             les_mean =     286.170716499218
             stat err =       0.000461720592
             autocorr =       1.251738901545
              std dev =       0.583629676703
             le_variance =       0.340623599529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340634598005
                                         uncertainty =       0.004101785287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340634598005
                                         uncertainty =       0.004101785287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412688502
  error estimate for blocks of size 2^( 2) =       0.000425164047
  error estimate for blocks of size 2^( 3) =       0.000437597151
  error estimate for blocks of size 2^( 4) =       0.000448990702
  error estimate for blocks of size 2^( 5) =       0.000458676636
  error estimate for blocks of size 2^( 6) =       0.000467349267
  error estimate for blocks of size 2^( 7) =       0.000471865763

      target function =                  N/A
              le_mean =     -16.906510375296
             les_mean =     286.170716499220
             stat err =       0.000461720592
             autocorr =       1.251738901543
              std dev =       0.583629676706
             le_variance =       0.340623599533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340634598008
                                         uncertainty =       0.004101785287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340634598008
                                         uncertainty =       0.004101785287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412688502
  error estimate for blocks of size 2^( 2) =       0.000425164047
  error estimate for blocks of size 2^( 3) =       0.000437597151
  error estimate for blocks of size 2^( 4) =       0.000448990702
  error estimate for blocks of size 2^( 5) =       0.000458676636
  error estimate for blocks of size 2^( 6) =       0.000467349267
  error estimate for blocks of size 2^( 7) =       0.000471865763

      target function =                  N/A
              le_mean =     -16.906510375296
             les_mean =     286.170716499222
             stat err =       0.000461720592
             autocorr =       1.251738901536
              std dev =       0.583629676709
             le_variance =       0.340623599536


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906510375296        initial
     9.7656e+06     9.7656e+07             3.2881e-11       -16.906510375296  <--
     3.9062e+07     3.9062e+08             8.2202e-12       -16.906510375296
     1.5625e+08     1.5625e+09             2.0551e-12       -16.906510375296

*****************************************************************************
Applying the update for shift_i =   9.7656e+06     and shift_s =   9.7656e+07
*****************************************************************************

  Execution time = 2.9417e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5464e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9252
    reference variance = 0.27938
====================================================
  Execution time = 2.0152e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3766e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337456643381
                                         uncertainty =       0.002596352546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337456643381
                                         uncertainty =       0.002596352546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410888732
  error estimate for blocks of size 2^( 2) =       0.000423300176
  error estimate for blocks of size 2^( 3) =       0.000436550793
  error estimate for blocks of size 2^( 4) =       0.000449120690
  error estimate for blocks of size 2^( 5) =       0.000460057313
  error estimate for blocks of size 2^( 6) =       0.000471043486
  error estimate for blocks of size 2^( 7) =       0.000475653556

      target function =                  N/A
              le_mean =     -16.906200780401
             les_mean =     286.157283758929
             stat err =       0.000463968761
             autocorr =       1.275055290577
              std dev =       0.581084417736
             le_variance =       0.337659100535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620078040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200780401       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200780401       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200780401       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906200780401       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200780143       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200780491       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200777320       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906200784612       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.014498e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200780401       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200780401       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200780401       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906200780169       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200779653       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200775829       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200783286       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906200798028       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.536232e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200780401       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200780401       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200780401       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906200753929       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200784982       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200774932       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200781497       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906200789113       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 6.340566e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5844e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.0077
    reference variance = 1.01842
====================================================
  Execution time = 2.0058e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4084e-01
  Total weights = 2.0000e+06
  Execution time = 1.8800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340890665731
                                         uncertainty =       0.005292676543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340890665731
                                         uncertainty =       0.005292676543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412817597
  error estimate for blocks of size 2^( 2) =       0.000426153262
  error estimate for blocks of size 2^( 3) =       0.000439921355
  error estimate for blocks of size 2^( 4) =       0.000453947544
  error estimate for blocks of size 2^( 5) =       0.000465844424
  error estimate for blocks of size 2^( 6) =       0.000473839599
  error estimate for blocks of size 2^( 7) =       0.000480579579

      target function =                  N/A
              le_mean =     -16.906381343100
             les_mean =     286.166566684480
             stat err =       0.000468552786
             autocorr =       1.288251471149
              std dev =       0.583812244282
             le_variance =       0.340836736574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340890665733
                                         uncertainty =       0.005292676543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340890665733
                                         uncertainty =       0.005292676543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412817597
  error estimate for blocks of size 2^( 2) =       0.000426153262
  error estimate for blocks of size 2^( 3) =       0.000439921355
  error estimate for blocks of size 2^( 4) =       0.000453947544
  error estimate for blocks of size 2^( 5) =       0.000465844424
  error estimate for blocks of size 2^( 6) =       0.000473839599
  error estimate for blocks of size 2^( 7) =       0.000480579579

      target function =                  N/A
              le_mean =     -16.906381343100
             les_mean =     286.166566684491
             stat err =       0.000468552786
             autocorr =       1.288251471129
              std dev =       0.583812244284
             le_variance =       0.340836736576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340890665732
                                         uncertainty =       0.005292676543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340890665732
                                         uncertainty =       0.005292676543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412817597
  error estimate for blocks of size 2^( 2) =       0.000426153262
  error estimate for blocks of size 2^( 3) =       0.000439921355
  error estimate for blocks of size 2^( 4) =       0.000453947544
  error estimate for blocks of size 2^( 5) =       0.000465844424
  error estimate for blocks of size 2^( 6) =       0.000473839599
  error estimate for blocks of size 2^( 7) =       0.000480579579

      target function =                  N/A
              le_mean =     -16.906381343100
             les_mean =     286.166566684485
             stat err =       0.000468552786
             autocorr =       1.288251471136
              std dev =       0.583812244283
             le_variance =       0.340836736575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340890665731
                                         uncertainty =       0.005292676543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340890665731
                                         uncertainty =       0.005292676543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412817597
  error estimate for blocks of size 2^( 2) =       0.000426153262
  error estimate for blocks of size 2^( 3) =       0.000439921355
  error estimate for blocks of size 2^( 4) =       0.000453947544
  error estimate for blocks of size 2^( 5) =       0.000465844424
  error estimate for blocks of size 2^( 6) =       0.000473839599
  error estimate for blocks of size 2^( 7) =       0.000480579579

      target function =                  N/A
              le_mean =     -16.906381343100
             les_mean =     286.166566684480
             stat err =       0.000468552786
             autocorr =       1.288251471146
              std dev =       0.583812244282
             le_variance =       0.340836736574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906381343100        initial
     2.4414e+06     2.4414e+07             1.0145e-10       -16.906381343100  <--
     9.7656e+06     9.7656e+07             2.5362e-11       -16.906381343100
     3.9062e+07     3.9062e+08             6.3406e-12       -16.906381343100

*****************************************************************************
Applying the update for shift_i =   2.4414e+06     and shift_s =   2.4414e+07
*****************************************************************************

  Execution time = 2.9549e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5399e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9158
    reference variance = 0.180308
====================================================
  Execution time = 2.0381e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3151e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331516005070
                                         uncertainty =       0.002737660984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331516005070
                                         uncertainty =       0.002737660984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407128255
  error estimate for blocks of size 2^( 2) =       0.000419673572
  error estimate for blocks of size 2^( 3) =       0.000432519273
  error estimate for blocks of size 2^( 4) =       0.000444874393
  error estimate for blocks of size 2^( 5) =       0.000455184115
  error estimate for blocks of size 2^( 6) =       0.000462962231
  error estimate for blocks of size 2^( 7) =       0.000466965333

      target function =                  N/A
              le_mean =     -16.905737137663
             les_mean =     286.135454834197
             stat err =       0.000457496518
             autocorr =       1.262737556892
              std dev =       0.575766299983
             le_variance =       0.331506832196


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573713766e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737137663       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737137662       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737137662       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737137692       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737137477       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737137725       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737136707       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905737137624       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.635418e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737137663       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737137663       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737137663       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737137662       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737137427       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737139648       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737138970       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905737136694       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 9.088536e-11

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737137663       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737137663       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737137663       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737137235       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737137658       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737136761       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737138072       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905737128896       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.272137e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190368 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5923e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8688
    reference variance = 0.289061
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3646e-01
  Total weights = 2.0000e+06
  Execution time = 1.8779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525213476
                                         uncertainty =       0.002888377317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525213476
                                         uncertainty =       0.002888377317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410159376
  error estimate for blocks of size 2^( 2) =       0.000422435054
  error estimate for blocks of size 2^( 3) =       0.000436154979
  error estimate for blocks of size 2^( 4) =       0.000449065254
  error estimate for blocks of size 2^( 5) =       0.000461192173
  error estimate for blocks of size 2^( 6) =       0.000470091328
  error estimate for blocks of size 2^( 7) =       0.000475988378

      target function =                  N/A
              le_mean =     -16.906643320402
             les_mean =     286.171049622121
             stat err =       0.000464084283
             autocorr =       1.280231282390
              std dev =       0.580052951930
             le_variance =       0.336461427043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525213601
                                         uncertainty =       0.002888377318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525213601
                                         uncertainty =       0.002888377318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410159376
  error estimate for blocks of size 2^( 2) =       0.000422435055
  error estimate for blocks of size 2^( 3) =       0.000436154979
  error estimate for blocks of size 2^( 4) =       0.000449065254
  error estimate for blocks of size 2^( 5) =       0.000461192173
  error estimate for blocks of size 2^( 6) =       0.000470091328
  error estimate for blocks of size 2^( 7) =       0.000475988379

      target function =                  N/A
              le_mean =     -16.906643320404
             les_mean =     286.171049622291
             stat err =       0.000464084283
             autocorr =       1.280231282188
              std dev =       0.580052952038
             le_variance =       0.336461427168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525213539
                                         uncertainty =       0.002888377318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525213539
                                         uncertainty =       0.002888377318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410159376
  error estimate for blocks of size 2^( 2) =       0.000422435054
  error estimate for blocks of size 2^( 3) =       0.000436154979
  error estimate for blocks of size 2^( 4) =       0.000449065254
  error estimate for blocks of size 2^( 5) =       0.000461192173
  error estimate for blocks of size 2^( 6) =       0.000470091328
  error estimate for blocks of size 2^( 7) =       0.000475988378

      target function =                  N/A
              le_mean =     -16.906643320403
             les_mean =     286.171049622206
             stat err =       0.000464084283
             autocorr =       1.280231282282
              std dev =       0.580052951984
             le_variance =       0.336461427106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525213484
                                         uncertainty =       0.002888377317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525213484
                                         uncertainty =       0.002888377317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410159376
  error estimate for blocks of size 2^( 2) =       0.000422435054
  error estimate for blocks of size 2^( 3) =       0.000436154979
  error estimate for blocks of size 2^( 4) =       0.000449065254
  error estimate for blocks of size 2^( 5) =       0.000461192173
  error estimate for blocks of size 2^( 6) =       0.000470091328
  error estimate for blocks of size 2^( 7) =       0.000475988378

      target function =                  N/A
              le_mean =     -16.906643320403
             les_mean =     286.171049622131
             stat err =       0.000464084283
             autocorr =       1.280231282377
              std dev =       0.580052951937
             le_variance =       0.336461427051


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906643320402        initial
     6.1035e+05     6.1035e+06             3.6354e-10       -16.906643320404  <--
     2.4414e+06     2.4414e+07             9.0885e-11       -16.906643320403
     9.7656e+06     9.7656e+07             2.2721e-11       -16.906643320403

*****************************************************************************
Applying the update for shift_i =   6.1035e+05     and shift_s =   6.1035e+06
*****************************************************************************

  Execution time = 2.9610e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5539e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9308
    reference variance = 0.176114
====================================================
  Execution time = 2.1154e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4505e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345135172906
                                         uncertainty =       0.005464052508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345135172906
                                         uncertainty =       0.005464052508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415363935
  error estimate for blocks of size 2^( 2) =       0.000428115267
  error estimate for blocks of size 2^( 3) =       0.000440033617
  error estimate for blocks of size 2^( 4) =       0.000451552720
  error estimate for blocks of size 2^( 5) =       0.000461110771
  error estimate for blocks of size 2^( 6) =       0.000467096314
  error estimate for blocks of size 2^( 7) =       0.000470762282

      target function =                  N/A
              le_mean =     -16.906750178584
             les_mean =     286.183255826169
             stat err =       0.000462630522
             autocorr =       1.240540627144
              std dev =       0.587413310762
             le_variance =       0.345054397661


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690675017858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906750178584       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906750178584       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906750178588       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906750178589       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906750178558       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906750178598       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906750178603       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906750178697       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.607594e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906750178584       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906750178584       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906750178585       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906750178619       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906750178266       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906750178662       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906750178267       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906750178027       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.018987e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906750178584       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906750178584       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906750178584       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906750177856       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906750178584       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906750176266       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906750177872       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906750176578       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.004748e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6661e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044154e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9458
    reference variance = 0.169906
====================================================
  Execution time = 2.0388e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3692e-01
  Total weights = 2.0000e+06
  Execution time = 1.8797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336924224809
                                         uncertainty =       0.003895744852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336924224809
                                         uncertainty =       0.003895744852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410437598
  error estimate for blocks of size 2^( 2) =       0.000423517820
  error estimate for blocks of size 2^( 3) =       0.000436425002
  error estimate for blocks of size 2^( 4) =       0.000447796060
  error estimate for blocks of size 2^( 5) =       0.000457517847
  error estimate for blocks of size 2^( 6) =       0.000464791288
  error estimate for blocks of size 2^( 7) =       0.000469631535

      target function =                  N/A
              le_mean =     -16.906501777048
             les_mean =     286.166720211860
             stat err =       0.000459934182
             autocorr =       1.255732405142
              std dev =       0.580446416978
             le_variance =       0.336918042982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336924224224
                                         uncertainty =       0.003895744847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336924224224
                                         uncertainty =       0.003895744847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410437597
  error estimate for blocks of size 2^( 2) =       0.000423517819
  error estimate for blocks of size 2^( 3) =       0.000436425002
  error estimate for blocks of size 2^( 4) =       0.000447796060
  error estimate for blocks of size 2^( 5) =       0.000457517847
  error estimate for blocks of size 2^( 6) =       0.000464791288
  error estimate for blocks of size 2^( 7) =       0.000469631534

      target function =                  N/A
              le_mean =     -16.906501777051
             les_mean =     286.166720211377
             stat err =       0.000459934182
             autocorr =       1.255732405578
              std dev =       0.580446416474
             le_variance =       0.336918042397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336924224516
                                         uncertainty =       0.003895744849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336924224516
                                         uncertainty =       0.003895744849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410437597
  error estimate for blocks of size 2^( 2) =       0.000423517820
  error estimate for blocks of size 2^( 3) =       0.000436425002
  error estimate for blocks of size 2^( 4) =       0.000447796060
  error estimate for blocks of size 2^( 5) =       0.000457517847
  error estimate for blocks of size 2^( 6) =       0.000464791288
  error estimate for blocks of size 2^( 7) =       0.000469631534

      target function =                  N/A
              le_mean =     -16.906501777050
             les_mean =     286.166720211618
             stat err =       0.000459934182
             autocorr =       1.255732405360
              std dev =       0.580446416726
             le_variance =       0.336918042690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336924224772
                                         uncertainty =       0.003895744852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336924224772
                                         uncertainty =       0.003895744852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410437598
  error estimate for blocks of size 2^( 2) =       0.000423517820
  error estimate for blocks of size 2^( 3) =       0.000436425002
  error estimate for blocks of size 2^( 4) =       0.000447796060
  error estimate for blocks of size 2^( 5) =       0.000457517847
  error estimate for blocks of size 2^( 6) =       0.000464791288
  error estimate for blocks of size 2^( 7) =       0.000469631535

      target function =                  N/A
              le_mean =     -16.906501777048
             les_mean =     286.166720211830
             stat err =       0.000459934182
             autocorr =       1.255732405159
              std dev =       0.580446416946
             le_variance =       0.336918042946


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906501777048        initial
     1.5259e+05     1.5259e+06             1.6076e-09       -16.906501777051  <--
     6.1035e+05     6.1035e+06             4.0190e-10       -16.906501777050
     2.4414e+06     2.4414e+07             1.0047e-10       -16.906501777048

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 2.9880e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6564e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8504
    reference variance = 0.17316
====================================================
  Execution time = 2.0974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3378e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333725819480
                                         uncertainty =       0.003215181154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333725819480
                                         uncertainty =       0.003215181154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408523316
  error estimate for blocks of size 2^( 2) =       0.000421800897
  error estimate for blocks of size 2^( 3) =       0.000435277835
  error estimate for blocks of size 2^( 4) =       0.000446747188
  error estimate for blocks of size 2^( 5) =       0.000457846769
  error estimate for blocks of size 2^( 6) =       0.000466696090
  error estimate for blocks of size 2^( 7) =       0.000472635745

      target function =                  N/A
              le_mean =     -16.905098545893
             les_mean =     286.116139278948
             stat err =       0.000460981448
             autocorr =       1.273307209975
              std dev =       0.577739214066
             le_variance =       0.333782599470


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690509854589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905098545893       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905098545938       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905098545902       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905098545897       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905098545886       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905098545910       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905098545922       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905098545912       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 6.588982e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905098545893       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905098545905       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905098545896       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905098545941       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905098545870       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905098545933       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905098545718       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905098545853       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.647246e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905098545893       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905098545896       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905098545894       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905098545259       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905098545962       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905098546018       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905098546152       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905098545654       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.118116e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195554 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6512e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354577e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.0248
    reference variance = 0.658411
====================================================
  Execution time = 2.2498e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4932e-01
  Total weights = 2.0000e+06
  Execution time = 1.8798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349313126725
                                         uncertainty =       0.009483645133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349313126725
                                         uncertainty =       0.009483645133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417926531
  error estimate for blocks of size 2^( 2) =       0.000430510712
  error estimate for blocks of size 2^( 3) =       0.000443516893
  error estimate for blocks of size 2^( 4) =       0.000455261219
  error estimate for blocks of size 2^( 5) =       0.000466074578
  error estimate for blocks of size 2^( 6) =       0.000473710343
  error estimate for blocks of size 2^( 7) =       0.000478454664

      target function =                  N/A
              le_mean =     -16.906204919638
             les_mean =     286.169089781341
             stat err =       0.000468375201
             autocorr =       1.255994970888
              std dev =       0.591037368723
             le_variance =       0.349325171227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349313129623
                                         uncertainty =       0.009483645257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349313129623
                                         uncertainty =       0.009483645257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417926533
  error estimate for blocks of size 2^( 2) =       0.000430510713
  error estimate for blocks of size 2^( 3) =       0.000443516895
  error estimate for blocks of size 2^( 4) =       0.000455261221
  error estimate for blocks of size 2^( 5) =       0.000466074580
  error estimate for blocks of size 2^( 6) =       0.000473710344
  error estimate for blocks of size 2^( 7) =       0.000478454665

      target function =                  N/A
              le_mean =     -16.906204919603
             les_mean =     286.169089783071
             stat err =       0.000468375202
             autocorr =       1.255994966923
              std dev =       0.591037371176
             le_variance =       0.349325174126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349313128174
                                         uncertainty =       0.009483645195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349313128174
                                         uncertainty =       0.009483645195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417926532
  error estimate for blocks of size 2^( 2) =       0.000430510712
  error estimate for blocks of size 2^( 3) =       0.000443516894
  error estimate for blocks of size 2^( 4) =       0.000455261220
  error estimate for blocks of size 2^( 5) =       0.000466074579
  error estimate for blocks of size 2^( 6) =       0.000473710344
  error estimate for blocks of size 2^( 7) =       0.000478454665

      target function =                  N/A
              le_mean =     -16.906204919620
             les_mean =     286.169089782206
             stat err =       0.000468375202
             autocorr =       1.255994968910
              std dev =       0.591037369949
             le_variance =       0.349325172677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349313126906
                                         uncertainty =       0.009483645141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349313126906
                                         uncertainty =       0.009483645141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417926531
  error estimate for blocks of size 2^( 2) =       0.000430510712
  error estimate for blocks of size 2^( 3) =       0.000443516894
  error estimate for blocks of size 2^( 4) =       0.000455261219
  error estimate for blocks of size 2^( 5) =       0.000466074579
  error estimate for blocks of size 2^( 6) =       0.000473710343
  error estimate for blocks of size 2^( 7) =       0.000478454664

      target function =                  N/A
              le_mean =     -16.906204919635
             les_mean =     286.169089781450
             stat err =       0.000468375201
             autocorr =       1.255994970643
              std dev =       0.591037368877
             le_variance =       0.349325171408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906204919638        initial  <--
     3.8147e+04     3.8147e+05             6.5890e-09       -16.906204919603
     1.5259e+05     1.5259e+06             1.6472e-09       -16.906204919620
     6.1035e+05     6.1035e+06             4.1181e-10       -16.906204919635

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9926
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8513e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8773
    reference variance = 0.215673
====================================================
  Execution time = 2.0804e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4545e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345522488101
                                         uncertainty =       0.004801546029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345522488101
                                         uncertainty =       0.004801546029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415604542
  error estimate for blocks of size 2^( 2) =       0.000428174788
  error estimate for blocks of size 2^( 3) =       0.000440898697
  error estimate for blocks of size 2^( 4) =       0.000453009911
  error estimate for blocks of size 2^( 5) =       0.000462566204
  error estimate for blocks of size 2^( 6) =       0.000469431526
  error estimate for blocks of size 2^( 7) =       0.000473085628

      target function =                  N/A
              le_mean =     -16.906710501874
             les_mean =     286.182314091464
             stat err =       0.000464523317
             autocorr =       1.249264699463
              std dev =       0.587753579323
             le_variance =       0.345454270007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690671050187e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906710501874       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906710501876       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906710501878       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906710501918       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906710501757       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906710501821       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906710501848       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906710502039       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 6.208562e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906710501874       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906710501875       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906710501875       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906710502129       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906710502135       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906710503251       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906710501843       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906710503864       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.552139e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906710501874       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906710501874       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906710501874       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906710501874       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906710505422       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906710502224       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906710502574       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906710502987       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.880341e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198133 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6342e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9671
    reference variance = 0.243439
====================================================
  Execution time = 2.0656e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4011e-01
  Total weights = 2.0000e+06
  Execution time = 1.8694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340243570468
                                         uncertainty =       0.004345831165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340243570468
                                         uncertainty =       0.004345831165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412376769
  error estimate for blocks of size 2^( 2) =       0.000424887151
  error estimate for blocks of size 2^( 3) =       0.000437821507
  error estimate for blocks of size 2^( 4) =       0.000450146714
  error estimate for blocks of size 2^( 5) =       0.000459911119
  error estimate for blocks of size 2^( 6) =       0.000468861211
  error estimate for blocks of size 2^( 7) =       0.000474392729

      target function =                  N/A
              le_mean =     -16.906567918555
             les_mean =     286.172147813405
             stat err =       0.000463327943
             autocorr =       1.262375634832
              std dev =       0.583188819121
             le_variance =       0.340109198748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340243570470
                                         uncertainty =       0.004345831164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340243570470
                                         uncertainty =       0.004345831164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412376769
  error estimate for blocks of size 2^( 2) =       0.000424887151
  error estimate for blocks of size 2^( 3) =       0.000437821507
  error estimate for blocks of size 2^( 4) =       0.000450146714
  error estimate for blocks of size 2^( 5) =       0.000459911119
  error estimate for blocks of size 2^( 6) =       0.000468861211
  error estimate for blocks of size 2^( 7) =       0.000474392729

      target function =                  N/A
              le_mean =     -16.906567918553
             les_mean =     286.172147813343
             stat err =       0.000463327943
             autocorr =       1.262375634731
              std dev =       0.583188819123
             le_variance =       0.340109198750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340243570469
                                         uncertainty =       0.004345831165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340243570469
                                         uncertainty =       0.004345831165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412376769
  error estimate for blocks of size 2^( 2) =       0.000424887151
  error estimate for blocks of size 2^( 3) =       0.000437821507
  error estimate for blocks of size 2^( 4) =       0.000450146714
  error estimate for blocks of size 2^( 5) =       0.000459911119
  error estimate for blocks of size 2^( 6) =       0.000468861211
  error estimate for blocks of size 2^( 7) =       0.000474392729

      target function =                  N/A
              le_mean =     -16.906567918554
             les_mean =     286.172147813374
             stat err =       0.000463327943
             autocorr =       1.262375634785
              std dev =       0.583188819122
             le_variance =       0.340109198749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340243570468
                                         uncertainty =       0.004345831165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340243570468
                                         uncertainty =       0.004345831165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412376769
  error estimate for blocks of size 2^( 2) =       0.000424887151
  error estimate for blocks of size 2^( 3) =       0.000437821507
  error estimate for blocks of size 2^( 4) =       0.000450146714
  error estimate for blocks of size 2^( 5) =       0.000459911119
  error estimate for blocks of size 2^( 6) =       0.000468861211
  error estimate for blocks of size 2^( 7) =       0.000474392729

      target function =                  N/A
              le_mean =     -16.906567918555
             les_mean =     286.172147813401
             stat err =       0.000463327943
             autocorr =       1.262375634827
              std dev =       0.583188819121
             le_variance =       0.340109198748


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906567918555        initial  <--
     3.8147e+05     3.8147e+06             6.2086e-10       -16.906567918553
     1.5259e+06     1.5259e+07             1.5521e-10       -16.906567918554
     6.1035e+06     6.1035e+07             3.8803e-11       -16.906567918555

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1010
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.351847
====================================================
  Execution time = 2.0802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4892e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348980852330
                                         uncertainty =       0.017941919608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348980852330
                                         uncertainty =       0.017941919608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417685207
  error estimate for blocks of size 2^( 2) =       0.000430005826
  error estimate for blocks of size 2^( 3) =       0.000443086460
  error estimate for blocks of size 2^( 4) =       0.000455136452
  error estimate for blocks of size 2^( 5) =       0.000464998391
  error estimate for blocks of size 2^( 6) =       0.000472337774
  error estimate for blocks of size 2^( 7) =       0.000476394334

      target function =                  N/A
              le_mean =     -16.905852263961
             les_mean =     286.156762460902
             stat err =       0.000467216738
             autocorr =       1.251234172053
              std dev =       0.590696084712
             le_variance =       0.348921864494


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585226396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905852263961       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905852263961       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905852263961       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905852263960       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905852263960       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905852264408       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905852262441       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905852262135       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 5.801395e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905852263961       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905852263961       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905852263961       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905852269617       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905852269449       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905852274567       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905852263180       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905852252958       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.450326e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905852263961       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905852263961       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905852263961       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905852357965       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905852288344       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905852286963       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905852236921       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905852272497       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 3.625706e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6478e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841959e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9187
    reference variance = 0.543741
====================================================
  Execution time = 2.0268e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3656e-01
  Total weights = 2.0000e+06
  Execution time = 1.8782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336634490058
                                         uncertainty =       0.002437029659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336634490058
                                         uncertainty =       0.002437029659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410221314
  error estimate for blocks of size 2^( 2) =       0.000422744356
  error estimate for blocks of size 2^( 3) =       0.000435897051
  error estimate for blocks of size 2^( 4) =       0.000447410540
  error estimate for blocks of size 2^( 5) =       0.000458541140
  error estimate for blocks of size 2^( 6) =       0.000466942674
  error estimate for blocks of size 2^( 7) =       0.000470430453

      target function =                  N/A
              le_mean =     -16.907277469437
             les_mean =     286.192594313598
             stat err =       0.000460831202
             autocorr =       1.261964998526
              std dev =       0.580140546201
             le_variance =       0.336563053346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336634490025
                                         uncertainty =       0.002437029659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336634490025
                                         uncertainty =       0.002437029659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410221314
  error estimate for blocks of size 2^( 2) =       0.000422744356
  error estimate for blocks of size 2^( 3) =       0.000435897051
  error estimate for blocks of size 2^( 4) =       0.000447410540
  error estimate for blocks of size 2^( 5) =       0.000458541140
  error estimate for blocks of size 2^( 6) =       0.000466942674
  error estimate for blocks of size 2^( 7) =       0.000470430453

      target function =                  N/A
              le_mean =     -16.907277469437
             les_mean =     286.192594313566
             stat err =       0.000460831202
             autocorr =       1.261964998553
              std dev =       0.580140546173
             le_variance =       0.336563053314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336634490041
                                         uncertainty =       0.002437029659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336634490041
                                         uncertainty =       0.002437029659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410221314
  error estimate for blocks of size 2^( 2) =       0.000422744356
  error estimate for blocks of size 2^( 3) =       0.000435897051
  error estimate for blocks of size 2^( 4) =       0.000447410540
  error estimate for blocks of size 2^( 5) =       0.000458541140
  error estimate for blocks of size 2^( 6) =       0.000466942674
  error estimate for blocks of size 2^( 7) =       0.000470430453

      target function =                  N/A
              le_mean =     -16.907277469437
             les_mean =     286.192594313582
             stat err =       0.000460831202
             autocorr =       1.261964998539
              std dev =       0.580140546187
             le_variance =       0.336563053330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336634490056
                                         uncertainty =       0.002437029659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336634490056
                                         uncertainty =       0.002437029659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410221314
  error estimate for blocks of size 2^( 2) =       0.000422744356
  error estimate for blocks of size 2^( 3) =       0.000435897051
  error estimate for blocks of size 2^( 4) =       0.000447410540
  error estimate for blocks of size 2^( 5) =       0.000458541140
  error estimate for blocks of size 2^( 6) =       0.000466942674
  error estimate for blocks of size 2^( 7) =       0.000470430453

      target function =                  N/A
              le_mean =     -16.907277469437
             les_mean =     286.192594313596
             stat err =       0.000460831202
             autocorr =       1.261964998532
              std dev =       0.580140546199
             le_variance =       0.336563053344


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907277469437        initial
     3.8147e+06     3.8147e+07             5.8014e-11       -16.907277469437  <--
     1.5259e+07     1.5259e+08             1.4503e-11       -16.907277469437
     6.1035e+07     6.1035e+08             3.6257e-12       -16.907277469437

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 2.9778e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6262e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9853
    reference variance = 0.326211
====================================================
  Execution time = 2.0931e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3885e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338934307959
                                         uncertainty =       0.003713837236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338934307959
                                         uncertainty =       0.003713837236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411615107
  error estimate for blocks of size 2^( 2) =       0.000424904301
  error estimate for blocks of size 2^( 3) =       0.000438835311
  error estimate for blocks of size 2^( 4) =       0.000452036348
  error estimate for blocks of size 2^( 5) =       0.000465880178
  error estimate for blocks of size 2^( 6) =       0.000476052881
  error estimate for blocks of size 2^( 7) =       0.000482128121

      target function =                  N/A
              le_mean =     -16.905419976961
             les_mean =     286.132078419850
             stat err =       0.000469024382
             autocorr =       1.298399171555
              std dev =       0.582111666120
             le_variance =       0.338853991833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690541997696e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905419976961       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905419976963       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905419976963       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905419976963       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905419976961       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905419976648       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905419976320       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905419977650       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.750665e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905419976961       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905419976962       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905419976962       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905419977852       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905419978858       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905419977571       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905419975090       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905419994691       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 6.876666e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905419976961       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905419976961       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905419976961       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905419976545       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905419976961       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905419978060       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905419971456       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905419969695       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.719160e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203347 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6436e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8562
    reference variance = 0.444942
====================================================
  Execution time = 2.0409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3651e-01
  Total weights = 2.0000e+06
  Execution time = 1.8922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336182939258
                                         uncertainty =       0.003505168902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336182939258
                                         uncertainty =       0.003505168902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410188478
  error estimate for blocks of size 2^( 2) =       0.000422740192
  error estimate for blocks of size 2^( 3) =       0.000435988360
  error estimate for blocks of size 2^( 4) =       0.000447618648
  error estimate for blocks of size 2^( 5) =       0.000456596100
  error estimate for blocks of size 2^( 6) =       0.000464145323
  error estimate for blocks of size 2^( 7) =       0.000471707650

      target function =                  N/A
              le_mean =     -16.906608964721
             les_mean =     286.169935692590
             stat err =       0.000460016930
             autocorr =       1.257710588527
              std dev =       0.580094108628
             le_variance =       0.336509174865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336182939536
                                         uncertainty =       0.003505168904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336182939536
                                         uncertainty =       0.003505168904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410188478
  error estimate for blocks of size 2^( 2) =       0.000422740192
  error estimate for blocks of size 2^( 3) =       0.000435988360
  error estimate for blocks of size 2^( 4) =       0.000447618648
  error estimate for blocks of size 2^( 5) =       0.000456596100
  error estimate for blocks of size 2^( 6) =       0.000464145323
  error estimate for blocks of size 2^( 7) =       0.000471707650

      target function =                  N/A
              le_mean =     -16.906608964722
             les_mean =     286.169935692909
             stat err =       0.000460016930
             autocorr =       1.257710588237
              std dev =       0.580094108868
             le_variance =       0.336509175143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336182939397
                                         uncertainty =       0.003505168903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336182939397
                                         uncertainty =       0.003505168903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410188478
  error estimate for blocks of size 2^( 2) =       0.000422740192
  error estimate for blocks of size 2^( 3) =       0.000435988360
  error estimate for blocks of size 2^( 4) =       0.000447618648
  error estimate for blocks of size 2^( 5) =       0.000456596100
  error estimate for blocks of size 2^( 6) =       0.000464145323
  error estimate for blocks of size 2^( 7) =       0.000471707650

      target function =                  N/A
              le_mean =     -16.906608964721
             les_mean =     286.169935692750
             stat err =       0.000460016930
             autocorr =       1.257710588376
              std dev =       0.580094108748
             le_variance =       0.336509175004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336182939276
                                         uncertainty =       0.003505168902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336182939276
                                         uncertainty =       0.003505168902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410188478
  error estimate for blocks of size 2^( 2) =       0.000422740192
  error estimate for blocks of size 2^( 3) =       0.000435988360
  error estimate for blocks of size 2^( 4) =       0.000447618648
  error estimate for blocks of size 2^( 5) =       0.000456596100
  error estimate for blocks of size 2^( 6) =       0.000464145323
  error estimate for blocks of size 2^( 7) =       0.000471707650

      target function =                  N/A
              le_mean =     -16.906608964721
             les_mean =     286.169935692610
             stat err =       0.000460016930
             autocorr =       1.257710588502
              std dev =       0.580094108643
             le_variance =       0.336509174882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906608964721        initial
     9.5367e+05     9.5367e+06             2.7507e-10       -16.906608964722  <--
     3.8147e+06     3.8147e+07             6.8767e-11       -16.906608964721
     1.5259e+07     1.5259e+08             1.7192e-11       -16.906608964721

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 2.9980e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9298
    reference variance = 0.204611
====================================================
  Execution time = 2.0792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4195e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342073097943
                                         uncertainty =       0.005919852040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342073097943
                                         uncertainty =       0.005919852040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413493294
  error estimate for blocks of size 2^( 2) =       0.000426359159
  error estimate for blocks of size 2^( 3) =       0.000439072293
  error estimate for blocks of size 2^( 4) =       0.000451682467
  error estimate for blocks of size 2^( 5) =       0.000462187137
  error estimate for blocks of size 2^( 6) =       0.000471445353
  error estimate for blocks of size 2^( 7) =       0.000475308332

      target function =                  N/A
              le_mean =     -16.906976955207
             les_mean =     286.187823000485
             stat err =       0.000465155822
             autocorr =       1.265493684839
              std dev =       0.584767823635
             le_variance =       0.341953407559


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690697695521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906976955207       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906976955209       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906976955209       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906976955275       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906976955202       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906976955168       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906976955325       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906976955225       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.190341e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906976955207       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906976955208       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906976955208       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906976955207       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906976955536       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906976954695       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906976955245       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906976955705       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.975853e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906976955207       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906976955207       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906976955207       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906976955207       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906976958682       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906976955109       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906976955139       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906976955218       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 7.439632e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205889 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6317e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.919
    reference variance = 0.350331
====================================================
  Execution time = 2.0102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4198e-01
  Total weights = 2.0000e+06
  Execution time = 1.8827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342059011255
                                         uncertainty =       0.004404652698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342059011255
                                         uncertainty =       0.004404652698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413506743
  error estimate for blocks of size 2^( 2) =       0.000425858679
  error estimate for blocks of size 2^( 3) =       0.000438908937
  error estimate for blocks of size 2^( 4) =       0.000450803121
  error estimate for blocks of size 2^( 5) =       0.000461819920
  error estimate for blocks of size 2^( 6) =       0.000469205976
  error estimate for blocks of size 2^( 7) =       0.000473181263

      target function =                  N/A
              le_mean =     -16.906586581680
             les_mean =     286.174645326314
             stat err =       0.000463752570
             autocorr =       1.257788055406
              std dev =       0.584786844462
             le_variance =       0.341975653456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342059010736
                                         uncertainty =       0.004404652692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342059010736
                                         uncertainty =       0.004404652692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413506743
  error estimate for blocks of size 2^( 2) =       0.000425858679
  error estimate for blocks of size 2^( 3) =       0.000438908937
  error estimate for blocks of size 2^( 4) =       0.000450803120
  error estimate for blocks of size 2^( 5) =       0.000461819920
  error estimate for blocks of size 2^( 6) =       0.000469205976
  error estimate for blocks of size 2^( 7) =       0.000473181263

      target function =                  N/A
              le_mean =     -16.906586581679
             les_mean =     286.174645325775
             stat err =       0.000463752570
             autocorr =       1.257788055729
              std dev =       0.584786844019
             le_variance =       0.341975652938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342059010996
                                         uncertainty =       0.004404652695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342059010996
                                         uncertainty =       0.004404652695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413506743
  error estimate for blocks of size 2^( 2) =       0.000425858679
  error estimate for blocks of size 2^( 3) =       0.000438908937
  error estimate for blocks of size 2^( 4) =       0.000450803121
  error estimate for blocks of size 2^( 5) =       0.000461819920
  error estimate for blocks of size 2^( 6) =       0.000469205976
  error estimate for blocks of size 2^( 7) =       0.000473181263

      target function =                  N/A
              le_mean =     -16.906586581680
             les_mean =     286.174645326045
             stat err =       0.000463752570
             autocorr =       1.257788055563
              std dev =       0.584786844241
             le_variance =       0.341975653197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342059011223
                                         uncertainty =       0.004404652698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342059011223
                                         uncertainty =       0.004404652698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413506743
  error estimate for blocks of size 2^( 2) =       0.000425858679
  error estimate for blocks of size 2^( 3) =       0.000438908937
  error estimate for blocks of size 2^( 4) =       0.000450803121
  error estimate for blocks of size 2^( 5) =       0.000461819920
  error estimate for blocks of size 2^( 6) =       0.000469205976
  error estimate for blocks of size 2^( 7) =       0.000473181263

      target function =                  N/A
              le_mean =     -16.906586581680
             les_mean =     286.174645326281
             stat err =       0.000463752570
             autocorr =       1.257788055422
              std dev =       0.584786844435
             le_variance =       0.341975653424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906586581680        initial  <--
     2.3842e+05     2.3842e+06             1.1903e-09       -16.906586581679
     9.5367e+05     9.5367e+06             2.9759e-10       -16.906586581680
     3.8147e+06     3.8147e+07             7.4396e-11       -16.906586581680

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6229
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9214
    reference variance = 0.227853
====================================================
  Execution time = 2.0332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4554e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345566186964
                                         uncertainty =       0.006132507177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345566186964
                                         uncertainty =       0.006132507177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415653801
  error estimate for blocks of size 2^( 2) =       0.000428044782
  error estimate for blocks of size 2^( 3) =       0.000440576614
  error estimate for blocks of size 2^( 4) =       0.000452667469
  error estimate for blocks of size 2^( 5) =       0.000463718858
  error estimate for blocks of size 2^( 6) =       0.000472149017
  error estimate for blocks of size 2^( 7) =       0.000476850944

      target function =                  N/A
              le_mean =     -16.905879547543
             les_mean =     286.154299268653
             stat err =       0.000466346572
             autocorr =       1.258792259785
              std dev =       0.587823243310
             le_variance =       0.345536165375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587954754e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905879547543       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905879547544       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905879547544       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905879547545       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905879547545       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905879547545       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905879547626       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905879547446       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 8.766781e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905879547543       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905879547544       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905879547544       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905879547544       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905879548009       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905879552047       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905879549802       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905879546632       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.191730e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905879547543       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905879547543       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905879547543       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905879518368       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905879547142       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905879540551       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905879537423       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905879540973       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 5.478817e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208462 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5902e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9524
    reference variance = 0.665272
====================================================
  Execution time = 2.0004e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3433e-01
  Total weights = 2.0000e+06
  Execution time = 1.8880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334307844540
                                         uncertainty =       0.003261655290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334307844540
                                         uncertainty =       0.003261655290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408861251
  error estimate for blocks of size 2^( 2) =       0.000421947995
  error estimate for blocks of size 2^( 3) =       0.000435070617
  error estimate for blocks of size 2^( 4) =       0.000446406838
  error estimate for blocks of size 2^( 5) =       0.000456163602
  error estimate for blocks of size 2^( 6) =       0.000464588493
  error estimate for blocks of size 2^( 7) =       0.000469264915

      target function =                  N/A
              le_mean =     -16.906803949859
             les_mean =     286.174354676458
             stat err =       0.000459105962
             autocorr =       1.260880591369
              std dev =       0.578217125870
             le_variance =       0.334335044650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334307844555
                                         uncertainty =       0.003261655290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334307844555
                                         uncertainty =       0.003261655290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408861251
  error estimate for blocks of size 2^( 2) =       0.000421947995
  error estimate for blocks of size 2^( 3) =       0.000435070617
  error estimate for blocks of size 2^( 4) =       0.000446406838
  error estimate for blocks of size 2^( 5) =       0.000456163602
  error estimate for blocks of size 2^( 6) =       0.000464588493
  error estimate for blocks of size 2^( 7) =       0.000469264915

      target function =                  N/A
              le_mean =     -16.906803949859
             les_mean =     286.174354676463
             stat err =       0.000459105962
             autocorr =       1.260880591339
              std dev =       0.578217125883
             le_variance =       0.334335044664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334307844547
                                         uncertainty =       0.003261655290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334307844547
                                         uncertainty =       0.003261655290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408861251
  error estimate for blocks of size 2^( 2) =       0.000421947995
  error estimate for blocks of size 2^( 3) =       0.000435070617
  error estimate for blocks of size 2^( 4) =       0.000446406838
  error estimate for blocks of size 2^( 5) =       0.000456163602
  error estimate for blocks of size 2^( 6) =       0.000464588493
  error estimate for blocks of size 2^( 7) =       0.000469264915

      target function =                  N/A
              le_mean =     -16.906803949859
             les_mean =     286.174354676460
             stat err =       0.000459105962
             autocorr =       1.260880591355
              std dev =       0.578217125876
             le_variance =       0.334335044657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334307844541
                                         uncertainty =       0.003261655290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334307844541
                                         uncertainty =       0.003261655290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408861251
  error estimate for blocks of size 2^( 2) =       0.000421947995
  error estimate for blocks of size 2^( 3) =       0.000435070617
  error estimate for blocks of size 2^( 4) =       0.000446406838
  error estimate for blocks of size 2^( 5) =       0.000456163602
  error estimate for blocks of size 2^( 6) =       0.000464588493
  error estimate for blocks of size 2^( 7) =       0.000469264915

      target function =                  N/A
              le_mean =     -16.906803949859
             les_mean =     286.174354676458
             stat err =       0.000459105962
             autocorr =       1.260880591368
              std dev =       0.578217125871
             le_variance =       0.334335044650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906803949859        initial  <--
     2.3842e+06     2.3842e+07             8.7668e-11       -16.906803949859
     9.5367e+06     9.5367e+07             2.1917e-11       -16.906803949859
     3.8147e+07     3.8147e+08             5.4788e-12       -16.906803949859

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5589
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5468e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9229
    reference variance = 0.205703
====================================================
  Execution time = 2.2056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4185e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341923348290
                                         uncertainty =       0.004345548255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341923348290
                                         uncertainty =       0.004345548255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413432745
  error estimate for blocks of size 2^( 2) =       0.000426196620
  error estimate for blocks of size 2^( 3) =       0.000439483107
  error estimate for blocks of size 2^( 4) =       0.000452530449
  error estimate for blocks of size 2^( 5) =       0.000463505652
  error estimate for blocks of size 2^( 6) =       0.000473629268
  error estimate for blocks of size 2^( 7) =       0.000477004771

      target function =                  N/A
              le_mean =     -16.905994240576
             les_mean =     286.154494360923
             stat err =       0.000466667535
             autocorr =       1.274105633852
              std dev =       0.584682195259
             le_variance =       0.341853269452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599424058e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905994240576       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905994240576       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905994240576       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905994240576       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905994233618       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905994243226       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905994238256       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905994240795       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.037973e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905994240576       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905994240576       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905994240576       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905994240576       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905994251747       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905994243471       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905994189635       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905994241325       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.594902e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905994240576       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905994240576       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905994240576       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905994187105       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905994240576       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905994054897       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905994373033       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905994016570       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 6.487260e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7651e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9439
    reference variance = 0.25129
====================================================
  Execution time = 1.9842e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4980e-01
  Total weights = 2.0000e+06
  Execution time = 1.8933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349810124355
                                         uncertainty =       0.007570194737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349810124355
                                         uncertainty =       0.007570194737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418213156
  error estimate for blocks of size 2^( 2) =       0.000430476293
  error estimate for blocks of size 2^( 3) =       0.000443433484
  error estimate for blocks of size 2^( 4) =       0.000454932691
  error estimate for blocks of size 2^( 5) =       0.000464154576
  error estimate for blocks of size 2^( 6) =       0.000471537261
  error estimate for blocks of size 2^( 7) =       0.000477647416

      target function =                  N/A
              le_mean =     -16.906652052093
             les_mean =     286.184687923968
             stat err =       0.000467067986
             autocorr =       1.247282473728
              std dev =       0.591442717695
             le_variance =       0.349804488315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349810124362
                                         uncertainty =       0.007570194737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349810124362
                                         uncertainty =       0.007570194737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418213156
  error estimate for blocks of size 2^( 2) =       0.000430476293
  error estimate for blocks of size 2^( 3) =       0.000443433484
  error estimate for blocks of size 2^( 4) =       0.000454932691
  error estimate for blocks of size 2^( 5) =       0.000464154576
  error estimate for blocks of size 2^( 6) =       0.000471537261
  error estimate for blocks of size 2^( 7) =       0.000477647416

      target function =                  N/A
              le_mean =     -16.906652052093
             les_mean =     286.184687923976
             stat err =       0.000467067986
             autocorr =       1.247282473712
              std dev =       0.591442717701
             le_variance =       0.349804488322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349810124358
                                         uncertainty =       0.007570194737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349810124358
                                         uncertainty =       0.007570194737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418213156
  error estimate for blocks of size 2^( 2) =       0.000430476293
  error estimate for blocks of size 2^( 3) =       0.000443433484
  error estimate for blocks of size 2^( 4) =       0.000454932691
  error estimate for blocks of size 2^( 5) =       0.000464154576
  error estimate for blocks of size 2^( 6) =       0.000471537261
  error estimate for blocks of size 2^( 7) =       0.000477647416

      target function =                  N/A
              le_mean =     -16.906652052093
             les_mean =     286.184687923972
             stat err =       0.000467067986
             autocorr =       1.247282473719
              std dev =       0.591442717698
             le_variance =       0.349804488318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349810124355
                                         uncertainty =       0.007570194737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349810124355
                                         uncertainty =       0.007570194737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418213156
  error estimate for blocks of size 2^( 2) =       0.000430476293
  error estimate for blocks of size 2^( 3) =       0.000443433484
  error estimate for blocks of size 2^( 4) =       0.000454932691
  error estimate for blocks of size 2^( 5) =       0.000464154576
  error estimate for blocks of size 2^( 6) =       0.000471537261
  error estimate for blocks of size 2^( 7) =       0.000477647416

      target function =                  N/A
              le_mean =     -16.906652052093
             les_mean =     286.184687923968
             stat err =       0.000467067986
             autocorr =       1.247282473723
              std dev =       0.591442717696
             le_variance =       0.349804488315


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906652052093        initial
     2.3842e+07     2.3842e+08             1.0380e-11       -16.906652052093  <--
     9.5367e+07     9.5367e+08             2.5949e-12       -16.906652052093
     3.8147e+08     3.8147e+09             6.4873e-13       -16.906652052093

*****************************************************************************
Applying the update for shift_i =   2.3842e+07     and shift_s =   2.3842e+08
*****************************************************************************

  Execution time = 2.9430e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7087e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.822
    reference variance = 0.455624
====================================================
  Execution time = 2.0345e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4824e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348164060494
                                         uncertainty =       0.008432328929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348164060494
                                         uncertainty =       0.008432328929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417278194
  error estimate for blocks of size 2^( 2) =       0.000429228202
  error estimate for blocks of size 2^( 3) =       0.000441719964
  error estimate for blocks of size 2^( 4) =       0.000452802188
  error estimate for blocks of size 2^( 5) =       0.000462677418
  error estimate for blocks of size 2^( 6) =       0.000470829745
  error estimate for blocks of size 2^( 7) =       0.000475607487

      target function =                  N/A
              le_mean =     -16.905689494939
             les_mean =     286.150579307758
             stat err =       0.000465479209
             autocorr =       1.244369034867
              std dev =       0.590120481416
             le_variance =       0.348242182587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568949494e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905689494939       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905689494939       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905689494939       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905689496189       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905689499451       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905689492511       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905689498679       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905689495291       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 5.907183e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905689494939       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905689494939       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905689494939       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905689504205       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905689493431       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905689506359       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905689483545       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905689492705       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.476796e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905689494939       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905689494939       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905689494939       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905689494939       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905689495216       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905689450665       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905689687756       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905689462289       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 3.691900e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213770 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5834e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9867
    reference variance = 1.33541
====================================================
  Execution time = 2.0019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 7.8529e-01
  Total weights = 2.0000e+06
  Execution time = 1.8828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.785951622735
                                         uncertainty =       0.443942862314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.785951622735
                                         uncertainty =       0.443942862314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000626612440
  error estimate for blocks of size 2^( 2) =       0.000634791176
  error estimate for blocks of size 2^( 3) =       0.000644085844
  error estimate for blocks of size 2^( 4) =       0.000651244780
  error estimate for blocks of size 2^( 5) =       0.000658732149
  error estimate for blocks of size 2^( 6) =       0.000663430698
  error estimate for blocks of size 2^( 7) =       0.000665450974

      target function =                  N/A
              le_mean =     -16.906502087255
             les_mean =     286.615098733186
             stat err =       0.000659714651
             autocorr =       1.108445214079
              std dev =       0.886163810745
             le_variance =       0.785286299473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.785951622722
                                         uncertainty =       0.443942862300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.785951622722
                                         uncertainty =       0.443942862300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000626612440
  error estimate for blocks of size 2^( 2) =       0.000634791176
  error estimate for blocks of size 2^( 3) =       0.000644085844
  error estimate for blocks of size 2^( 4) =       0.000651244780
  error estimate for blocks of size 2^( 5) =       0.000658732149
  error estimate for blocks of size 2^( 6) =       0.000663430698
  error estimate for blocks of size 2^( 7) =       0.000665450974

      target function =                  N/A
              le_mean =     -16.906502087255
             les_mean =     286.615098733172
             stat err =       0.000659714651
             autocorr =       1.108445214074
              std dev =       0.886163810737
             le_variance =       0.785286299460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.785951622728
                                         uncertainty =       0.443942862307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.785951622728
                                         uncertainty =       0.443942862307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000626612440
  error estimate for blocks of size 2^( 2) =       0.000634791176
  error estimate for blocks of size 2^( 3) =       0.000644085844
  error estimate for blocks of size 2^( 4) =       0.000651244780
  error estimate for blocks of size 2^( 5) =       0.000658732149
  error estimate for blocks of size 2^( 6) =       0.000663430698
  error estimate for blocks of size 2^( 7) =       0.000665450974

      target function =                  N/A
              le_mean =     -16.906502087255
             les_mean =     286.615098733179
             stat err =       0.000659714651
             autocorr =       1.108445214077
              std dev =       0.886163810741
             le_variance =       0.785286299467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.785951622734
                                         uncertainty =       0.443942862313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.785951622734
                                         uncertainty =       0.443942862313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000626612440
  error estimate for blocks of size 2^( 2) =       0.000634791176
  error estimate for blocks of size 2^( 3) =       0.000644085844
  error estimate for blocks of size 2^( 4) =       0.000651244780
  error estimate for blocks of size 2^( 5) =       0.000658732149
  error estimate for blocks of size 2^( 6) =       0.000663430698
  error estimate for blocks of size 2^( 7) =       0.000665450974

      target function =                  N/A
              le_mean =     -16.906502087255
             les_mean =     286.615098733185
             stat err =       0.000659714651
             autocorr =       1.108445214079
              std dev =       0.886163810744
             le_variance =       0.785286299473


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906502087255        initial  <--
     5.9605e+06     5.9605e+07             5.9072e-11       -16.906502087255
     2.3842e+07     2.3842e+08             1.4768e-11       -16.906502087255
     9.5367e+07     9.5367e+08             3.6919e-12       -16.906502087255

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5390
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5379e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.851
    reference variance = 0.296574
====================================================
  Execution time = 2.0597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3845e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338548487591
                                         uncertainty =       0.004508204209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338548487591
                                         uncertainty =       0.004508204209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411367267
  error estimate for blocks of size 2^( 2) =       0.000424219461
  error estimate for blocks of size 2^( 3) =       0.000437116408
  error estimate for blocks of size 2^( 4) =       0.000449057544
  error estimate for blocks of size 2^( 5) =       0.000458698854
  error estimate for blocks of size 2^( 6) =       0.000466189078
  error estimate for blocks of size 2^( 7) =       0.000468897924

      target function =                  N/A
              le_mean =     -16.905536490754
             les_mean =     286.135609926892
             stat err =       0.000460710850
             autocorr =       1.254288438421
              std dev =       0.581761167410
             le_variance =       0.338446055906


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553649075e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905536490754       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905536490754       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905536490754       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905536479210       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905536489006       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905536495288       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905536538410       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905536585048       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 3.858466e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905536490754       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905536490754       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905536490754       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905536470432       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905536490754       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905536283718       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905536554853       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905536593628       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 9.646202e-13

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905536490754       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905536490754       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905536490754       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905536322791       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905536490754       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905536650333       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905535853650       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905536621036       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 2.411010e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216368 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6079e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9684
    reference variance = 0.183683
====================================================
  Execution time = 1.9934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4071e-01
  Total weights = 2.0000e+06
  Execution time = 1.8910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338850623539
                                         uncertainty =       0.004434387365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338850623539
                                         uncertainty =       0.004434387365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412740456
  error estimate for blocks of size 2^( 2) =       0.000425383433
  error estimate for blocks of size 2^( 3) =       0.000438310483
  error estimate for blocks of size 2^( 4) =       0.000450374465
  error estimate for blocks of size 2^( 5) =       0.000459969029
  error estimate for blocks of size 2^( 6) =       0.000466192011
  error estimate for blocks of size 2^( 7) =       0.000473391069

      target function =                  N/A
              le_mean =     -16.905863163645
             les_mean =     286.148918506299
             stat err =       0.000462481643
             autocorr =       1.255552621481
              std dev =       0.583703151236
             le_variance =       0.340709368763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338850623540
                                         uncertainty =       0.004434387365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338850623540
                                         uncertainty =       0.004434387365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412740456
  error estimate for blocks of size 2^( 2) =       0.000425383433
  error estimate for blocks of size 2^( 3) =       0.000438310483
  error estimate for blocks of size 2^( 4) =       0.000450374465
  error estimate for blocks of size 2^( 5) =       0.000459969029
  error estimate for blocks of size 2^( 6) =       0.000466192011
  error estimate for blocks of size 2^( 7) =       0.000473391069

      target function =                  N/A
              le_mean =     -16.905863163645
             les_mean =     286.148918506300
             stat err =       0.000462481643
             autocorr =       1.255552621474
              std dev =       0.583703151237
             le_variance =       0.340709368764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338850623540
                                         uncertainty =       0.004434387365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338850623540
                                         uncertainty =       0.004434387365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412740456
  error estimate for blocks of size 2^( 2) =       0.000425383433
  error estimate for blocks of size 2^( 3) =       0.000438310483
  error estimate for blocks of size 2^( 4) =       0.000450374465
  error estimate for blocks of size 2^( 5) =       0.000459969029
  error estimate for blocks of size 2^( 6) =       0.000466192011
  error estimate for blocks of size 2^( 7) =       0.000473391069

      target function =                  N/A
              le_mean =     -16.905863163645
             les_mean =     286.148918506299
             stat err =       0.000462481643
             autocorr =       1.255552621478
              std dev =       0.583703151237
             le_variance =       0.340709368764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338850623539
                                         uncertainty =       0.004434387365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338850623539
                                         uncertainty =       0.004434387365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412740456
  error estimate for blocks of size 2^( 2) =       0.000425383433
  error estimate for blocks of size 2^( 3) =       0.000438310483
  error estimate for blocks of size 2^( 4) =       0.000450374465
  error estimate for blocks of size 2^( 5) =       0.000459969029
  error estimate for blocks of size 2^( 6) =       0.000466192011
  error estimate for blocks of size 2^( 7) =       0.000473391069

      target function =                  N/A
              le_mean =     -16.905863163645
             les_mean =     286.148918506299
             stat err =       0.000462481643
             autocorr =       1.255552621475
              std dev =       0.583703151236
             le_variance =       0.340709368763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905863163645        initial
     5.9605e+07     5.9605e+08             3.8585e-12       -16.905863163645  <--
     2.3842e+08     2.3842e+09             9.6462e-13       -16.905863163645
     9.5367e+08     9.5367e+09             2.4110e-13       -16.905863163645

*****************************************************************************
Applying the update for shift_i =   5.9605e+07     and shift_s =   5.9605e+08
*****************************************************************************

  Execution time = 2.9491e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5578e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9314
    reference variance = 0.31517
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5674e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356768806407
                                         uncertainty =       0.016178166273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356768806407
                                         uncertainty =       0.016178166273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422336431
  error estimate for blocks of size 2^( 2) =       0.000434427896
  error estimate for blocks of size 2^( 3) =       0.000446381068
  error estimate for blocks of size 2^( 4) =       0.000457504884
  error estimate for blocks of size 2^( 5) =       0.000466945779
  error estimate for blocks of size 2^( 6) =       0.000473321206
  error estimate for blocks of size 2^( 7) =       0.000476604666

      target function =                  N/A
              le_mean =     -16.906044024584
             les_mean =     286.171060505233
             stat err =       0.000468594134
             autocorr =       1.231052581080
              std dev =       0.597273909038
             le_variance =       0.356736122417


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690604402458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906044024584       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906044024584       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906044024584       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906044024418       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906044032913       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906044015401       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906044025742       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906044018807       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.839026e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906044024584       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906044024584       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906044024584       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906044010908       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906044024584       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906044021614       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906044021918       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906044036279       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 4.597575e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906044024584       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906044024584       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906044024584       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906044305722       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906044024584       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906044004739       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906043997648       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906044004910       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 1.149398e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5919e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9891
    reference variance = 0.303378
====================================================
  Execution time = 2.0134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4130e-01
  Total weights = 2.0000e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341429258133
                                         uncertainty =       0.004815561298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341429258133
                                         uncertainty =       0.004815561298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413098288
  error estimate for blocks of size 2^( 2) =       0.000426002070
  error estimate for blocks of size 2^( 3) =       0.000438637811
  error estimate for blocks of size 2^( 4) =       0.000451244481
  error estimate for blocks of size 2^( 5) =       0.000462840983
  error estimate for blocks of size 2^( 6) =       0.000470215203
  error estimate for blocks of size 2^( 7) =       0.000476503829

      target function =                  N/A
              le_mean =     -16.906155458328
             les_mean =     286.159392601382
             stat err =       0.000465201124
             autocorr =       1.268161957067
              std dev =       0.584209201297
             le_variance =       0.341300390880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341429258133
                                         uncertainty =       0.004815561298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341429258133
                                         uncertainty =       0.004815561298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413098288
  error estimate for blocks of size 2^( 2) =       0.000426002070
  error estimate for blocks of size 2^( 3) =       0.000438637811
  error estimate for blocks of size 2^( 4) =       0.000451244481
  error estimate for blocks of size 2^( 5) =       0.000462840983
  error estimate for blocks of size 2^( 6) =       0.000470215203
  error estimate for blocks of size 2^( 7) =       0.000476503829

      target function =                  N/A
              le_mean =     -16.906155458328
             les_mean =     286.159392601384
             stat err =       0.000465201124
             autocorr =       1.268161957058
              std dev =       0.584209201297
             le_variance =       0.341300390881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341429258133
                                         uncertainty =       0.004815561298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341429258133
                                         uncertainty =       0.004815561298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413098288
  error estimate for blocks of size 2^( 2) =       0.000426002070
  error estimate for blocks of size 2^( 3) =       0.000438637811
  error estimate for blocks of size 2^( 4) =       0.000451244481
  error estimate for blocks of size 2^( 5) =       0.000462840983
  error estimate for blocks of size 2^( 6) =       0.000470215203
  error estimate for blocks of size 2^( 7) =       0.000476503829

      target function =                  N/A
              le_mean =     -16.906155458328
             les_mean =     286.159392601383
             stat err =       0.000465201124
             autocorr =       1.268161957060
              std dev =       0.584209201297
             le_variance =       0.341300390881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341429258133
                                         uncertainty =       0.004815561298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341429258133
                                         uncertainty =       0.004815561298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413098288
  error estimate for blocks of size 2^( 2) =       0.000426002070
  error estimate for blocks of size 2^( 3) =       0.000438637811
  error estimate for blocks of size 2^( 4) =       0.000451244481
  error estimate for blocks of size 2^( 5) =       0.000462840983
  error estimate for blocks of size 2^( 6) =       0.000470215203
  error estimate for blocks of size 2^( 7) =       0.000476503829

      target function =                  N/A
              le_mean =     -16.906155458328
             les_mean =     286.159392601382
             stat err =       0.000465201124
             autocorr =       1.268161957059
              std dev =       0.584209201297
             le_variance =       0.341300390880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906155458328        initial
     1.4901e+07     1.4901e+08             1.8390e-11       -16.906155458328  <--
     5.9605e+07     5.9605e+08             4.5976e-12       -16.906155458328
     2.3842e+08     2.3842e+09             1.1494e-12       -16.906155458328

*****************************************************************************
Applying the update for shift_i =   1.4901e+07     and shift_s =   1.4901e+08
*****************************************************************************

  Execution time = 2.9645e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5570e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9014
    reference variance = 0.165085
====================================================
  Execution time = 2.0656e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4433e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344401985596
                                         uncertainty =       0.010966086125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344401985596
                                         uncertainty =       0.010966086125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414928397
  error estimate for blocks of size 2^( 2) =       0.000427477060
  error estimate for blocks of size 2^( 3) =       0.000440365803
  error estimate for blocks of size 2^( 4) =       0.000451699357
  error estimate for blocks of size 2^( 5) =       0.000462240918
  error estimate for blocks of size 2^( 6) =       0.000470109478
  error estimate for blocks of size 2^( 7) =       0.000476967339

      target function =                  N/A
              le_mean =     -16.906150222403
             les_mean =     286.162246318984
             stat err =       0.000465254273
             autocorr =       1.257286998392
              std dev =       0.586797365949
             le_variance =       0.344331148685


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615022240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906150222403       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906150222403       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906150222404       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906150222377       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906150220869       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906150223476       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906150220549       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906150220645       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 7.794552e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906150222403       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906150222403       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906150222403       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906150222403       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906150219329       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906150210239       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906150224487       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906150212606       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.948640e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906150222403       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906150222403       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906150222403       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906150222403       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906150222403       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906150202101       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906150202922       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906150224528       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 4.871612e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221521 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6289e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.5772
    reference variance = 6.84559
====================================================
  Execution time = 1.9799e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4060e-01
  Total weights = 2.0000e+06
  Execution time = 1.8850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340231317094
                                         uncertainty =       0.004316237098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340231317094
                                         uncertainty =       0.004316237098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412674556
  error estimate for blocks of size 2^( 2) =       0.000425014089
  error estimate for blocks of size 2^( 3) =       0.000438448171
  error estimate for blocks of size 2^( 4) =       0.000451361899
  error estimate for blocks of size 2^( 5) =       0.000462410622
  error estimate for blocks of size 2^( 6) =       0.000470898962
  error estimate for blocks of size 2^( 7) =       0.000474987862

      target function =                  N/A
              le_mean =     -16.906648649724
             les_mean =     286.175368972550
             stat err =       0.000464914836
             autocorr =       1.269203984776
              std dev =       0.583609953325
             le_variance =       0.340600577620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340231317110
                                         uncertainty =       0.004316237098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340231317110
                                         uncertainty =       0.004316237098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412674556
  error estimate for blocks of size 2^( 2) =       0.000425014089
  error estimate for blocks of size 2^( 3) =       0.000438448171
  error estimate for blocks of size 2^( 4) =       0.000451361899
  error estimate for blocks of size 2^( 5) =       0.000462410622
  error estimate for blocks of size 2^( 6) =       0.000470898962
  error estimate for blocks of size 2^( 7) =       0.000474987862

      target function =                  N/A
              le_mean =     -16.906648649724
             les_mean =     286.175368972563
             stat err =       0.000464914836
             autocorr =       1.269203984757
              std dev =       0.583609953338
             le_variance =       0.340600577635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340231317102
                                         uncertainty =       0.004316237098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340231317102
                                         uncertainty =       0.004316237098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412674556
  error estimate for blocks of size 2^( 2) =       0.000425014089
  error estimate for blocks of size 2^( 3) =       0.000438448171
  error estimate for blocks of size 2^( 4) =       0.000451361899
  error estimate for blocks of size 2^( 5) =       0.000462410622
  error estimate for blocks of size 2^( 6) =       0.000470898962
  error estimate for blocks of size 2^( 7) =       0.000474987862

      target function =                  N/A
              le_mean =     -16.906648649724
             les_mean =     286.175368972557
             stat err =       0.000464914836
             autocorr =       1.269203984771
              std dev =       0.583609953332
             le_variance =       0.340600577628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340231317095
                                         uncertainty =       0.004316237098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340231317095
                                         uncertainty =       0.004316237098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412674556
  error estimate for blocks of size 2^( 2) =       0.000425014089
  error estimate for blocks of size 2^( 3) =       0.000438448171
  error estimate for blocks of size 2^( 4) =       0.000451361899
  error estimate for blocks of size 2^( 5) =       0.000462410622
  error estimate for blocks of size 2^( 6) =       0.000470898962
  error estimate for blocks of size 2^( 7) =       0.000474987862

      target function =                  N/A
              le_mean =     -16.906648649724
             les_mean =     286.175368972551
             stat err =       0.000464914836
             autocorr =       1.269203984784
              std dev =       0.583609953326
             le_variance =       0.340600577621


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906648649724        initial  <--
     3.7253e+06     3.7253e+07             7.7946e-11       -16.906648649724
     1.4901e+07     1.4901e+08             1.9486e-11       -16.906648649724
     5.9605e+07     5.9605e+08             4.8716e-12       -16.906648649724

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2894
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9016
    reference variance = 0.213652
====================================================
  Execution time = 2.0176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4202e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342071318272
                                         uncertainty =       0.007892542622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342071318272
                                         uncertainty =       0.007892542622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413532250
  error estimate for blocks of size 2^( 2) =       0.000425824242
  error estimate for blocks of size 2^( 3) =       0.000438496580
  error estimate for blocks of size 2^( 4) =       0.000450007578
  error estimate for blocks of size 2^( 5) =       0.000459416642
  error estimate for blocks of size 2^( 6) =       0.000465541621
  error estimate for blocks of size 2^( 7) =       0.000468558687

      target function =                  N/A
              le_mean =     -16.907140471389
             les_mean =     286.193416592607
             stat err =       0.000460881132
             autocorr =       1.242107225925
              std dev =       0.584822917064
             le_variance =       0.342017844323


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690714047139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907140471389       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907140471389       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907140471389       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907140471389       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907140482334       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907140444471       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907140498160       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907140486281       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 5.758846e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907140471389       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907140471389       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907140471389       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907140471389       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907140471389       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907140471389       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907140471389       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907140494955       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 1.439734e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907140471389       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907140471389       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907140471389       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907140578342       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907140516086       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907139769385       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907140478670       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907140165823       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+08 is 3.601564e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224094 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8804e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8678
    reference variance = 0.280599
====================================================
  Execution time = 2.0049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4538e-01
  Total weights = 2.0000e+06
  Execution time = 1.8900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345391936174
                                         uncertainty =       0.005248499622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345391936174
                                         uncertainty =       0.005248499622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415560363
  error estimate for blocks of size 2^( 2) =       0.000428413753
  error estimate for blocks of size 2^( 3) =       0.000442526621
  error estimate for blocks of size 2^( 4) =       0.000454768870
  error estimate for blocks of size 2^( 5) =       0.000467643241
  error estimate for blocks of size 2^( 6) =       0.000476417120
  error estimate for blocks of size 2^( 7) =       0.000482608267

      target function =                  N/A
              le_mean =     -16.905839342097
             les_mean =     286.152784518787
             stat err =       0.000470359375
             autocorr =       1.281124611432
              std dev =       0.587691101420
             le_variance =       0.345380830688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345391936170
                                         uncertainty =       0.005248499622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345391936170
                                         uncertainty =       0.005248499622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415560363
  error estimate for blocks of size 2^( 2) =       0.000428413753
  error estimate for blocks of size 2^( 3) =       0.000442526621
  error estimate for blocks of size 2^( 4) =       0.000454768870
  error estimate for blocks of size 2^( 5) =       0.000467643241
  error estimate for blocks of size 2^( 6) =       0.000476417120
  error estimate for blocks of size 2^( 7) =       0.000482608267

      target function =                  N/A
              le_mean =     -16.905839342097
             les_mean =     286.152784518781
             stat err =       0.000470359375
             autocorr =       1.281124611447
              std dev =       0.587691101416
             le_variance =       0.345380830684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345391936172
                                         uncertainty =       0.005248499622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345391936172
                                         uncertainty =       0.005248499622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415560363
  error estimate for blocks of size 2^( 2) =       0.000428413753
  error estimate for blocks of size 2^( 3) =       0.000442526621
  error estimate for blocks of size 2^( 4) =       0.000454768870
  error estimate for blocks of size 2^( 5) =       0.000467643241
  error estimate for blocks of size 2^( 6) =       0.000476417120
  error estimate for blocks of size 2^( 7) =       0.000482608267

      target function =                  N/A
              le_mean =     -16.905839342097
             les_mean =     286.152784518784
             stat err =       0.000470359375
             autocorr =       1.281124611432
              std dev =       0.587691101418
             le_variance =       0.345380830686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345391936174
                                         uncertainty =       0.005248499622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345391936174
                                         uncertainty =       0.005248499622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415560363
  error estimate for blocks of size 2^( 2) =       0.000428413753
  error estimate for blocks of size 2^( 3) =       0.000442526621
  error estimate for blocks of size 2^( 4) =       0.000454768870
  error estimate for blocks of size 2^( 5) =       0.000467643241
  error estimate for blocks of size 2^( 6) =       0.000476417120
  error estimate for blocks of size 2^( 7) =       0.000482608267

      target function =                  N/A
              le_mean =     -16.905839342097
             les_mean =     286.152784518786
             stat err =       0.000470359375
             autocorr =       1.281124611430
              std dev =       0.587691101420
             le_variance =       0.345380830688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905839342097        initial  <--
     3.7253e+07     3.7253e+08             5.7588e-12       -16.905839342097
     1.4901e+08     1.4901e+09             1.4397e-12       -16.905839342097
     5.9605e+08     5.9605e+09             3.6016e-13       -16.905839342097

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5967
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8801
    reference variance = 0.197466
====================================================
  Execution time = 2.0211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3285e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332872002684
                                         uncertainty =       0.002691578663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332872002684
                                         uncertainty =       0.002691578663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407950083
  error estimate for blocks of size 2^( 2) =       0.000420934256
  error estimate for blocks of size 2^( 3) =       0.000434735933
  error estimate for blocks of size 2^( 4) =       0.000447666774
  error estimate for blocks of size 2^( 5) =       0.000458941241
  error estimate for blocks of size 2^( 6) =       0.000467210793
  error estimate for blocks of size 2^( 7) =       0.000473411760

      target function =                  N/A
              le_mean =     -16.905988875627
             les_mean =     286.145306236074
             stat err =       0.000461807642
             autocorr =       1.281469223366
              std dev =       0.576928539478
             le_variance =       0.332846539665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598887563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988875627       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988875627       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905988875627       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905989010140       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905988898257       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905989654373       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905988984192       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905989317847       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 8.604050e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988875627       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988875627       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905988875627       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905988875627       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905988540435       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905988987970       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905990040058       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905988909741       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 2.151630e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988875627       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988875627       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905988875627       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905988875627       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905985875063       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905993822419       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905989311691       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905990033629       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+09 is 5.376814e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226677 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5704e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9766
    reference variance = 0.183177
====================================================
  Execution time = 1.9987e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4568e-01
  Total weights = 2.0000e+06
  Execution time = 1.8841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733670830
                                         uncertainty =       0.005624901065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733670830
                                         uncertainty =       0.005624901065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415743219
  error estimate for blocks of size 2^( 2) =       0.000428643533
  error estimate for blocks of size 2^( 3) =       0.000441761459
  error estimate for blocks of size 2^( 4) =       0.000453890771
  error estimate for blocks of size 2^( 5) =       0.000465800566
  error estimate for blocks of size 2^( 6) =       0.000473701710
  error estimate for blocks of size 2^( 7) =       0.000477457689

      target function =                  N/A
              le_mean =     -16.905840686277
             les_mean =     286.153133984551
             stat err =       0.000467712684
             autocorr =       1.265633458893
              std dev =       0.587949698201
             le_variance =       0.345684847614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733670830
                                         uncertainty =       0.005624901065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733670830
                                         uncertainty =       0.005624901065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415743219
  error estimate for blocks of size 2^( 2) =       0.000428643533
  error estimate for blocks of size 2^( 3) =       0.000441761459
  error estimate for blocks of size 2^( 4) =       0.000453890771
  error estimate for blocks of size 2^( 5) =       0.000465800566
  error estimate for blocks of size 2^( 6) =       0.000473701710
  error estimate for blocks of size 2^( 7) =       0.000477457689

      target function =                  N/A
              le_mean =     -16.905840686277
             les_mean =     286.153133984551
             stat err =       0.000467712684
             autocorr =       1.265633458888
              std dev =       0.587949698201
             le_variance =       0.345684847615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733670830
                                         uncertainty =       0.005624901065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733670830
                                         uncertainty =       0.005624901065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415743219
  error estimate for blocks of size 2^( 2) =       0.000428643533
  error estimate for blocks of size 2^( 3) =       0.000441761459
  error estimate for blocks of size 2^( 4) =       0.000453890771
  error estimate for blocks of size 2^( 5) =       0.000465800566
  error estimate for blocks of size 2^( 6) =       0.000473701710
  error estimate for blocks of size 2^( 7) =       0.000477457689

      target function =                  N/A
              le_mean =     -16.905840686277
             les_mean =     286.153133984551
             stat err =       0.000467712684
             autocorr =       1.265633458889
              std dev =       0.587949698201
             le_variance =       0.345684847614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733670830
                                         uncertainty =       0.005624901065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733670830
                                         uncertainty =       0.005624901065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415743219
  error estimate for blocks of size 2^( 2) =       0.000428643533
  error estimate for blocks of size 2^( 3) =       0.000441761459
  error estimate for blocks of size 2^( 4) =       0.000453890771
  error estimate for blocks of size 2^( 5) =       0.000465800566
  error estimate for blocks of size 2^( 6) =       0.000473701710
  error estimate for blocks of size 2^( 7) =       0.000477457689

      target function =                  N/A
              le_mean =     -16.905840686277
             les_mean =     286.153133984551
             stat err =       0.000467712684
             autocorr =       1.265633458890
              std dev =       0.587949698201
             le_variance =       0.345684847614


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905840686277        initial  <--
     3.7253e+08     3.7253e+09             8.6041e-13       -16.905840686277
     1.4901e+09     1.4901e+10             2.1516e-13       -16.905840686277
     5.9605e+09     5.9605e+10             5.3768e-14       -16.905840686277

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5169
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5232e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9183
    reference variance = 0.194515
====================================================
  Execution time = 1.9844e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347119235837
                                         uncertainty =       0.007383597745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347119235837
                                         uncertainty =       0.007383597745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416583128
  error estimate for blocks of size 2^( 2) =       0.000429271519
  error estimate for blocks of size 2^( 3) =       0.000441702148
  error estimate for blocks of size 2^( 4) =       0.000453481937
  error estimate for blocks of size 2^( 5) =       0.000463650291
  error estimate for blocks of size 2^( 6) =       0.000470593460
  error estimate for blocks of size 2^( 7) =       0.000475655858

      target function =                  N/A
              le_mean =     -16.906493047895
             les_mean =     286.176590010195
             stat err =       0.000465845387
             autocorr =       1.250490061237
              std dev =       0.589137509609
             le_variance =       0.347083005228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649304789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906493047895       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906493047895       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906493047895       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906493594643       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906493087481       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906492912667       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906490998684       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906496056760       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 6.016488e-14

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906493047895       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906493047895       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906493047895       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906492810340       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906494393370       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906495234774       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498262567       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906484086675       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906476190150       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906530029090       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906479279944       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906442700256       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906633056533       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906834171307       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905481118021       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906734293944       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906253644790       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905552100664       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905909731062       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906139024899       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906452508578       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906756076756       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.907962524776       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906195561765       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.907493459883       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.907332728124       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906014645632       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908039353343       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.904526029000       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.904154327146       residual = 7.20e-04           smallest_sin_value = 9.98e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.907534059331       residual = 1.45e-04           smallest_sin_value = 9.97e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+10 is 1.498924e-14

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906493047895       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906493047895       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906493047895       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906456941731       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906500109763       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906475906288       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906461425366       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906672758027       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906437871078       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906584277029       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906506453429       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905163072745       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905763329368       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907858442010       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908114970549       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906792567203       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910999075942       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910486011934       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906330376342       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.899462735671       residual = 6.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.917339039172       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.899640648380       residual = 6.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.902670394223       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908721652552       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905285595189       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.915930545764       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.902762575830       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908328638050       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.911496352233       residual = 3.31e-03           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -16.900546007588       residual = 4.71e-03           smallest_sin_value = 9.95e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.58e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+10 is 3.686004e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253875 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5378e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9987
    reference variance = 0.347325
====================================================
  Execution time = 1.9731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3808e-01
  Total weights = 2.0000e+06
  Execution time = 1.8836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338129687014
                                         uncertainty =       0.003756313997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338129687014
                                         uncertainty =       0.003756313997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411142673
  error estimate for blocks of size 2^( 2) =       0.000424098495
  error estimate for blocks of size 2^( 3) =       0.000437583000
  error estimate for blocks of size 2^( 4) =       0.000450630344
  error estimate for blocks of size 2^( 5) =       0.000462457326
  error estimate for blocks of size 2^( 6) =       0.000471229366
  error estimate for blocks of size 2^( 7) =       0.000481606600

      target function =                  N/A
              le_mean =     -16.905743795655
             les_mean =     286.142249710317
             stat err =       0.000466480909
             autocorr =       1.287308507004
              std dev =       0.581443544133
             le_variance =       0.338076595014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338129687014
                                         uncertainty =       0.003756313997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338129687014
                                         uncertainty =       0.003756313997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411142673
  error estimate for blocks of size 2^( 2) =       0.000424098495
  error estimate for blocks of size 2^( 3) =       0.000437583000
  error estimate for blocks of size 2^( 4) =       0.000450630344
  error estimate for blocks of size 2^( 5) =       0.000462457326
  error estimate for blocks of size 2^( 6) =       0.000471229366
  error estimate for blocks of size 2^( 7) =       0.000481606600

      target function =                  N/A
              le_mean =     -16.905743795655
             les_mean =     286.142249710317
             stat err =       0.000466480909
             autocorr =       1.287308506999
              std dev =       0.581443544133
             le_variance =       0.338076595014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338129687014
                                         uncertainty =       0.003756313997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338129687014
                                         uncertainty =       0.003756313997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411142673
  error estimate for blocks of size 2^( 2) =       0.000424098495
  error estimate for blocks of size 2^( 3) =       0.000437583000
  error estimate for blocks of size 2^( 4) =       0.000450630344
  error estimate for blocks of size 2^( 5) =       0.000462457326
  error estimate for blocks of size 2^( 6) =       0.000471229366
  error estimate for blocks of size 2^( 7) =       0.000481606600

      target function =                  N/A
              le_mean =     -16.905743795655
             les_mean =     286.142249710317
             stat err =       0.000466480909
             autocorr =       1.287308506996
              std dev =       0.581443544133
             le_variance =       0.338076595014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338129687014
                                         uncertainty =       0.003756313997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338129687014
                                         uncertainty =       0.003756313997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411142673
  error estimate for blocks of size 2^( 2) =       0.000424098495
  error estimate for blocks of size 2^( 3) =       0.000437583000
  error estimate for blocks of size 2^( 4) =       0.000450630344
  error estimate for blocks of size 2^( 5) =       0.000462457326
  error estimate for blocks of size 2^( 6) =       0.000471229366
  error estimate for blocks of size 2^( 7) =       0.000481606600

      target function =                  N/A
              le_mean =     -16.905743795655
             les_mean =     286.142249710317
             stat err =       0.000466480909
             autocorr =       1.287308507004
              std dev =       0.581443544133
             le_variance =       0.338076595014


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905743795655        initial
     3.7253e+09     3.7253e+10             6.0165e-14       -16.905743795655  <--
     1.4901e+10     1.4901e+11             1.4989e-14       -16.905743795655
     5.9605e+10     5.9605e+11             3.6860e-15       -16.905743795655

*****************************************************************************
Applying the update for shift_i =   3.7253e+09     and shift_s =   3.7253e+10
*****************************************************************************

  Execution time = 2.9253e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8521
    reference variance = 0.135927
====================================================
  Execution time = 2.0244e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5675e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356862817730
                                         uncertainty =       0.016277094762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356862817730
                                         uncertainty =       0.016277094762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422344642
  error estimate for blocks of size 2^( 2) =       0.000434934896
  error estimate for blocks of size 2^( 3) =       0.000447313385
  error estimate for blocks of size 2^( 4) =       0.000458932821
  error estimate for blocks of size 2^( 5) =       0.000468420670
  error estimate for blocks of size 2^( 6) =       0.000474684579
  error estimate for blocks of size 2^( 7) =       0.000480338966

      target function =                  N/A
              le_mean =     -16.906451677171
             les_mean =     286.184858127966
             stat err =       0.000470594259
             autocorr =       1.241535868007
              std dev =       0.597285521196
             le_variance =       0.356749993831


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645167717e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906451677171       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906451677171       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906451677171       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906451677171       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906451647022       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906451179366       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906451166089       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906451498198       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 2.852026e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906451677171       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906451677171       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906451677171       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906451677171       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906452224371       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906452409992       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906451577678       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906450468184       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 7.114854e-14

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906451677171       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906451677171       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906451677171       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906441642793       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906446189251       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906449167544       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906451846986       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906451324489       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+10 is 1.799509e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256445 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5791e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9981
    reference variance = 0.561573
====================================================
  Execution time = 1.9920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3375e-01
  Total weights = 2.0000e+06
  Execution time = 1.8822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333769110270
                                         uncertainty =       0.002573707983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333769110270
                                         uncertainty =       0.002573707983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408503643
  error estimate for blocks of size 2^( 2) =       0.000420829036
  error estimate for blocks of size 2^( 3) =       0.000433827946
  error estimate for blocks of size 2^( 4) =       0.000445877768
  error estimate for blocks of size 2^( 5) =       0.000456657100
  error estimate for blocks of size 2^( 6) =       0.000463337634
  error estimate for blocks of size 2^( 7) =       0.000468436030

      target function =                  N/A
              le_mean =     -16.905837628802
             les_mean =     286.141096217589
             stat err =       0.000458577133
             autocorr =       1.260180980287
              std dev =       0.577711392528
             le_variance =       0.333750453057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333769110270
                                         uncertainty =       0.002573707983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333769110270
                                         uncertainty =       0.002573707983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408503643
  error estimate for blocks of size 2^( 2) =       0.000420829036
  error estimate for blocks of size 2^( 3) =       0.000433827946
  error estimate for blocks of size 2^( 4) =       0.000445877768
  error estimate for blocks of size 2^( 5) =       0.000456657100
  error estimate for blocks of size 2^( 6) =       0.000463337634
  error estimate for blocks of size 2^( 7) =       0.000468436030

      target function =                  N/A
              le_mean =     -16.905837628802
             les_mean =     286.141096217589
             stat err =       0.000458577133
             autocorr =       1.260180980287
              std dev =       0.577711392528
             le_variance =       0.333750453057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333769110270
                                         uncertainty =       0.002573707983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333769110270
                                         uncertainty =       0.002573707983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408503643
  error estimate for blocks of size 2^( 2) =       0.000420829036
  error estimate for blocks of size 2^( 3) =       0.000433827946
  error estimate for blocks of size 2^( 4) =       0.000445877768
  error estimate for blocks of size 2^( 5) =       0.000456657100
  error estimate for blocks of size 2^( 6) =       0.000463337634
  error estimate for blocks of size 2^( 7) =       0.000468436030

      target function =                  N/A
              le_mean =     -16.905837628802
             les_mean =     286.141096217589
             stat err =       0.000458577133
             autocorr =       1.260180980288
              std dev =       0.577711392528
             le_variance =       0.333750453057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333769110270
                                         uncertainty =       0.002573707983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333769110270
                                         uncertainty =       0.002573707983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408503643
  error estimate for blocks of size 2^( 2) =       0.000420829036
  error estimate for blocks of size 2^( 3) =       0.000433827946
  error estimate for blocks of size 2^( 4) =       0.000445877768
  error estimate for blocks of size 2^( 5) =       0.000456657100
  error estimate for blocks of size 2^( 6) =       0.000463337634
  error estimate for blocks of size 2^( 7) =       0.000468436030

      target function =                  N/A
              le_mean =     -16.905837628802
             les_mean =     286.141096217589
             stat err =       0.000458577133
             autocorr =       1.260180980292
              std dev =       0.577711392528
             le_variance =       0.333750453057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905837628802        initial  <--
     9.3132e+08     9.3132e+09             2.8520e-13       -16.905837628802
     3.7253e+09     3.7253e+10             7.1149e-14       -16.905837628802
     1.4901e+10     1.4901e+11             1.7995e-14       -16.905837628802

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4344
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5232e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9304
    reference variance = 0.209
====================================================
  Execution time = 2.0147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3711e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337201865423
                                         uncertainty =       0.003271930717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337201865423
                                         uncertainty =       0.003271930717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410553543
  error estimate for blocks of size 2^( 2) =       0.000422871720
  error estimate for blocks of size 2^( 3) =       0.000435643212
  error estimate for blocks of size 2^( 4) =       0.000447723458
  error estimate for blocks of size 2^( 5) =       0.000456131952
  error estimate for blocks of size 2^( 6) =       0.000464509831
  error estimate for blocks of size 2^( 7) =       0.000471751491

      target function =                  N/A
              le_mean =     -16.906510480800
             les_mean =     286.167204892749
             stat err =       0.000460029183
             autocorr =       1.255541743277
              std dev =       0.580610389064
             le_variance =       0.337108423888


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690651048080e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906510480800       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906510480800       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906510480800       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906510480800       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906508612164       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906509857534       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906516574148       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906514982346       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+09 is 2.475828e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906510480800       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906510480800       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906510480800       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906505570388       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906510480800       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906513563231       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906523631948       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906429137923       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906534645028       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906297902187       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907053269239       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906976451948       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906723233554       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907296747278       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906745968219       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905769252291       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906323079264       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906195582193       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906509673630       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906715816005       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906668169932       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.912684522311       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905813389345       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907634381977       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903523870333       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.902920838139       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.902601439283       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.907446213967       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908712012009       residual = 6.49e-04           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -16.906691741052       residual = 9.82e-06           smallest_sin_value = 9.96e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.67e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+10 is 6.299560e-15

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906510480800       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906510480800       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906510480800       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906512259666       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906394701716       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906600985725       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906538285996       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906492173979       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906154565578       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906375472309       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907596323222       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906489319267       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906445585279       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907908327307       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904572708740       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906474658994       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906394574039       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905481362903       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905114437623       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910709339141       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.903641157751       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.916030049912       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909959456715       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.921411118092       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.902540715349       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.909855713713       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.900009413372       residual = 5.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.922526188138       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.912715573292       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.890723406576       residual = 3.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.897523124959       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.928729990100       residual = 6.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.912059383272       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.901784735503       residual = 1.39e-02           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.936949537450       residual = 1.10e-01           smallest_sin_value = 9.97e-01
davidson iteration   35:   krylov dim =  36   energy =     -16.905062769722       residual = 7.21e-04           smallest_sin_value = 9.96e-01
davidson iteration   36 stopping due to small subspace S singular value of 9.53e-01
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+11 is 2.012527e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290180 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5703e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9095
    reference variance = 0.272895
====================================================
  Execution time = 1.9662e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3945e-01
  Total weights = 2.0000e+06
  Execution time = 1.8853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339468975620
                                         uncertainty =       0.004260093772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339468975620
                                         uncertainty =       0.004260093772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411978069
  error estimate for blocks of size 2^( 2) =       0.000424630361
  error estimate for blocks of size 2^( 3) =       0.000437572889
  error estimate for blocks of size 2^( 4) =       0.000449543177
  error estimate for blocks of size 2^( 5) =       0.000459905130
  error estimate for blocks of size 2^( 6) =       0.000465728862
  error estimate for blocks of size 2^( 7) =       0.000472284009

      target function =                  N/A
              le_mean =     -16.906868552955
             les_mean =     286.181655955495
             stat err =       0.000461865294
             autocorr =       1.256847148571
              std dev =       0.582624972292
             le_variance =       0.339451858338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339468975620
                                         uncertainty =       0.004260093772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339468975620
                                         uncertainty =       0.004260093772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411978069
  error estimate for blocks of size 2^( 2) =       0.000424630361
  error estimate for blocks of size 2^( 3) =       0.000437572889
  error estimate for blocks of size 2^( 4) =       0.000449543177
  error estimate for blocks of size 2^( 5) =       0.000459905130
  error estimate for blocks of size 2^( 6) =       0.000465728862
  error estimate for blocks of size 2^( 7) =       0.000472284009

      target function =                  N/A
              le_mean =     -16.906868552955
             les_mean =     286.181655955495
             stat err =       0.000461865294
             autocorr =       1.256847148572
              std dev =       0.582624972292
             le_variance =       0.339451858338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339468975620
                                         uncertainty =       0.004260093772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339468975620
                                         uncertainty =       0.004260093772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411978069
  error estimate for blocks of size 2^( 2) =       0.000424630361
  error estimate for blocks of size 2^( 3) =       0.000437572889
  error estimate for blocks of size 2^( 4) =       0.000449543177
  error estimate for blocks of size 2^( 5) =       0.000459905130
  error estimate for blocks of size 2^( 6) =       0.000465728862
  error estimate for blocks of size 2^( 7) =       0.000472284009

      target function =                  N/A
              le_mean =     -16.906868552955
             les_mean =     286.181655955495
             stat err =       0.000461865294
             autocorr =       1.256847148570
              std dev =       0.582624972292
             le_variance =       0.339451858338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339468975620
                                         uncertainty =       0.004260093772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339468975620
                                         uncertainty =       0.004260093772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411978069
  error estimate for blocks of size 2^( 2) =       0.000424630361
  error estimate for blocks of size 2^( 3) =       0.000437572889
  error estimate for blocks of size 2^( 4) =       0.000449543177
  error estimate for blocks of size 2^( 5) =       0.000459905130
  error estimate for blocks of size 2^( 6) =       0.000465728862
  error estimate for blocks of size 2^( 7) =       0.000472284009

      target function =                  N/A
              le_mean =     -16.906868552955
             les_mean =     286.181655955495
             stat err =       0.000461865294
             autocorr =       1.256847148563
              std dev =       0.582624972292
             le_variance =       0.339451858338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906868552955        initial  <--
     9.3132e+09     9.3132e+10             2.4758e-14       -16.906868552955
     3.7253e+10     3.7253e+11             6.2996e-15       -16.906868552955
     1.4901e+11     1.4901e+12             2.0125e-15       -16.906868552955

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1883
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4920e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8713
    reference variance = 0.345207
====================================================
  Execution time = 2.0068e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5506e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355135477886
                                         uncertainty =       0.015107639897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355135477886
                                         uncertainty =       0.015107639897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421343536
  error estimate for blocks of size 2^( 2) =       0.000433823711
  error estimate for blocks of size 2^( 3) =       0.000445972238
  error estimate for blocks of size 2^( 4) =       0.000457993063
  error estimate for blocks of size 2^( 5) =       0.000468480557
  error estimate for blocks of size 2^( 6) =       0.000477389465
  error estimate for blocks of size 2^( 7) =       0.000481945297

      target function =                  N/A
              le_mean =     -16.906379358554
             les_mean =     286.180723588400
             stat err =       0.000471452095
             autocorr =       1.251994639443
              std dev =       0.595869742976
             le_variance =       0.355060750595


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637935855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906379358554       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906379358554       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906379358554       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906360393632       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906379358554       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906374691481       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906358339528       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906359843762       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906437223714       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906385758016       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906108326757       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906278689208       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906586361971       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905916600530       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906158917012       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908877730779       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905496448966       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906730606697       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906907752621       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.904614054069       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.902027677610       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910917328663       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.898284377382       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.899939215941       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.899651867690       residual = 6.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.917370320685       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.898273684896       residual = 8.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908255493551       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.911445412399       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.897911080105       residual = 9.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.908923643608       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.913274381096       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.918996617856       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.898563503218       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.905913895719       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.898635320322       residual = 8.77e-03           smallest_sin_value = 9.99e-01
davidson iteration   36:   krylov dim =  37   energy =     -16.907900695074       residual = 1.06e-03           smallest_sin_value = 9.99e-01
davidson iteration   37 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 2.589484e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906379358554       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906379358554       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906379358554       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906379358554       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906379358554       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906379358554       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906314038232       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905810887276       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906510588999       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904971937903       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906264297088       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907129331924       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905668105582       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909010726142       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909599008864       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906198152538       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.914894621819       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.902427660086       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.912930426811       residual = 6.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906507393206       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.914734347269       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.898846418354       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.918006905019       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.864888526846       residual = 2.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.937780170174       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.934485156666       residual = 9.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.919872324588       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.930242854511       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.923321941006       residual = 4.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.917996418268       residual = 3.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.799884981230       residual = 1.52e+00           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.877553678123       residual = 1.13e-01           smallest_sin_value = 9.98e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.925074199093       residual = 5.09e-02           smallest_sin_value = 9.93e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.47e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+11 is 6.483033e-16

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906379358554       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906379358554       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906379358554       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906295387303       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906379358554       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.902315055632       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918158308004       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.899129721517       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.891287065902       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.929095816285       residual = 6.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.943610674227       residual = 1.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.849234979970       residual = 4.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.921338447242       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.892460173790       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.892568750930       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.047573290480       residual = 2.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.847320483249       residual = 4.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.049960998054       residual = 2.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.067615566665       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.844410449423       residual = 5.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.746866721129       residual = 3.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.982236383230       residual = 7.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.124145775359       residual = 6.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.992677200313       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.794318291301       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.848071447150       residual = 5.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.913191190545       residual = 5.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.039495643782       residual = 2.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.104068163521       residual = 4.96e+00           smallest_sin_value = 9.98e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+12 is 2.865209e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5697e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8416
    reference variance = 0.23562
====================================================
  Execution time = 1.9773e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3935e-01
  Total weights = 2.0000e+06
  Execution time = 2.0938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392449400
                                         uncertainty =       0.005191269782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392449400
                                         uncertainty =       0.005191269782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411917162
  error estimate for blocks of size 2^( 2) =       0.000424897257
  error estimate for blocks of size 2^( 3) =       0.000437889243
  error estimate for blocks of size 2^( 4) =       0.000448935652
  error estimate for blocks of size 2^( 5) =       0.000459809973
  error estimate for blocks of size 2^( 6) =       0.000467015069
  error estimate for blocks of size 2^( 7) =       0.000471008900

      target function =                  N/A
              le_mean =     -16.905592141692
             les_mean =     286.138396987653
             stat err =       0.000461692398
             autocorr =       1.256277772410
              std dev =       0.582538836539
             le_variance =       0.339351496076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392449400
                                         uncertainty =       0.005191269782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392449400
                                         uncertainty =       0.005191269782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411917162
  error estimate for blocks of size 2^( 2) =       0.000424897257
  error estimate for blocks of size 2^( 3) =       0.000437889243
  error estimate for blocks of size 2^( 4) =       0.000448935652
  error estimate for blocks of size 2^( 5) =       0.000459809973
  error estimate for blocks of size 2^( 6) =       0.000467015069
  error estimate for blocks of size 2^( 7) =       0.000471008900

      target function =                  N/A
              le_mean =     -16.905592141692
             les_mean =     286.138396987653
             stat err =       0.000461692398
             autocorr =       1.256277772410
              std dev =       0.582538836539
             le_variance =       0.339351496076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392449400
                                         uncertainty =       0.005191269782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392449400
                                         uncertainty =       0.005191269782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411917162
  error estimate for blocks of size 2^( 2) =       0.000424897257
  error estimate for blocks of size 2^( 3) =       0.000437889243
  error estimate for blocks of size 2^( 4) =       0.000448935652
  error estimate for blocks of size 2^( 5) =       0.000459809973
  error estimate for blocks of size 2^( 6) =       0.000467015069
  error estimate for blocks of size 2^( 7) =       0.000471008900

      target function =                  N/A
              le_mean =     -16.905592141692
             les_mean =     286.138396987653
             stat err =       0.000461692398
             autocorr =       1.256277772410
              std dev =       0.582538836539
             le_variance =       0.339351496076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392449400
                                         uncertainty =       0.005191269782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392449400
                                         uncertainty =       0.005191269782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411917162
  error estimate for blocks of size 2^( 2) =       0.000424897257
  error estimate for blocks of size 2^( 3) =       0.000437889243
  error estimate for blocks of size 2^( 4) =       0.000448935652
  error estimate for blocks of size 2^( 5) =       0.000459809973
  error estimate for blocks of size 2^( 6) =       0.000467015069
  error estimate for blocks of size 2^( 7) =       0.000471008900

      target function =                  N/A
              le_mean =     -16.905592141692
             les_mean =     286.138396987653
             stat err =       0.000461692398
             autocorr =       1.256277772410
              std dev =       0.582538836539
             le_variance =       0.339351496076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905592141692        initial  <--
     9.3132e+10     9.3132e+11             2.5895e-15       -16.905592141692
     3.7253e+11     3.7253e+12             6.4830e-16       -16.905592141692
     1.4901e+12     1.4901e+13             2.8652e-17       -16.905592141692

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6831
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6388e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17
    reference variance = 0.337665
====================================================
  Execution time = 1.9925e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3799e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338125021613
                                         uncertainty =       0.004514821407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338125021613
                                         uncertainty =       0.004514821407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411088581
  error estimate for blocks of size 2^( 2) =       0.000423416193
  error estimate for blocks of size 2^( 3) =       0.000436432622
  error estimate for blocks of size 2^( 4) =       0.000448501408
  error estimate for blocks of size 2^( 5) =       0.000458531345
  error estimate for blocks of size 2^( 6) =       0.000464847680
  error estimate for blocks of size 2^( 7) =       0.000469673016

      target function =                  N/A
              le_mean =     -16.906070816187
             les_mean =     286.153217916085
             stat err =       0.000460388362
             autocorr =       1.254231913206
              std dev =       0.581367046852
             le_variance =       0.337987643165


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607081619e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906070816187       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906070816187       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906070816187       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906065080355       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906888791101       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907156917878       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904135184477       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907308863594       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.902049939532       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.912117115769       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.915322449547       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.889674494859       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.933811190780       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909936321088       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905303306316       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907513956139       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.923921882966       residual = 4.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.911495251571       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.860767867667       residual = 2.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.895746033986       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.900746554084       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.794393194318       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.975413123143       residual = 5.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.926515765234       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.811241954870       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.706239868931       residual = 5.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.992257832585       residual = 9.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.858171263226       residual = 3.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.030032373908       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.925548365274       residual = 5.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.922608943338       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.865819245099       residual = 2.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.144156837037       residual = 6.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.820494570231       residual = 9.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.948860026346       residual = 3.04e-01           smallest_sin_value = 9.96e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+11 is 2.238077e-16

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906070816187       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906070816187       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906070816187       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906070816187       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.357928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5450e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8695
    reference variance = 0.43915
====================================================
  Execution time = 1.9882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3357e-01
  Total weights = 2.0000e+06
  Execution time = 1.8882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333648802599
                                         uncertainty =       0.003055231844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333648802599
                                         uncertainty =       0.003055231844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408391438
  error estimate for blocks of size 2^( 2) =       0.000421292803
  error estimate for blocks of size 2^( 3) =       0.000434224393
  error estimate for blocks of size 2^( 4) =       0.000446907742
  error estimate for blocks of size 2^( 5) =       0.000458719808
  error estimate for blocks of size 2^( 6) =       0.000466172759
  error estimate for blocks of size 2^( 7) =       0.000472339604

      target function =                  N/A
              le_mean =     -16.906429805850
             les_mean =     286.160935746673
             stat err =       0.000461034978
             autocorr =       1.274425625205
              std dev =       0.577552710442
             le_variance =       0.333567133338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333648802599
                                         uncertainty =       0.003055231844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333648802599
                                         uncertainty =       0.003055231844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408391438
  error estimate for blocks of size 2^( 2) =       0.000421292803
  error estimate for blocks of size 2^( 3) =       0.000434224393
  error estimate for blocks of size 2^( 4) =       0.000446907742
  error estimate for blocks of size 2^( 5) =       0.000458719808
  error estimate for blocks of size 2^( 6) =       0.000466172759
  error estimate for blocks of size 2^( 7) =       0.000472339604

      target function =                  N/A
              le_mean =     -16.906429805850
             les_mean =     286.160935746673
             stat err =       0.000461034978
             autocorr =       1.274425625205
              std dev =       0.577552710442
             le_variance =       0.333567133338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333648802599
                                         uncertainty =       0.003055231844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333648802599
                                         uncertainty =       0.003055231844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408391438
  error estimate for blocks of size 2^( 2) =       0.000421292803
  error estimate for blocks of size 2^( 3) =       0.000434224393
  error estimate for blocks of size 2^( 4) =       0.000446907742
  error estimate for blocks of size 2^( 5) =       0.000458719808
  error estimate for blocks of size 2^( 6) =       0.000466172759
  error estimate for blocks of size 2^( 7) =       0.000472339604

      target function =                  N/A
              le_mean =     -16.906429805850
             les_mean =     286.160935746673
             stat err =       0.000461034978
             autocorr =       1.274425625205
              std dev =       0.577552710442
             le_variance =       0.333567133338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333648802599
                                         uncertainty =       0.003055231844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333648802599
                                         uncertainty =       0.003055231844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408391438
  error estimate for blocks of size 2^( 2) =       0.000421292803
  error estimate for blocks of size 2^( 3) =       0.000434224393
  error estimate for blocks of size 2^( 4) =       0.000446907742
  error estimate for blocks of size 2^( 5) =       0.000458719808
  error estimate for blocks of size 2^( 6) =       0.000466172759
  error estimate for blocks of size 2^( 7) =       0.000472339604

      target function =                  N/A
              le_mean =     -16.906429805850
             les_mean =     286.160935746673
             stat err =       0.000461034978
             autocorr =       1.274425625205
              std dev =       0.577552710442
             le_variance =       0.333567133338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906429805850        initial  <--
     9.3132e+11     9.3132e+12             2.2381e-16       -16.906429805850
     3.7253e+12     3.7253e+13             0.0000e+00       -16.906429805850
     1.4901e+13     1.4901e+14             0.0000e+00       -16.906429805850

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4162
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4873e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.924
    reference variance = 0.210938
====================================================
  Execution time = 2.0358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3711e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337172850678
                                         uncertainty =       0.003211575049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337172850678
                                         uncertainty =       0.003211575049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410555779
  error estimate for blocks of size 2^( 2) =       0.000423076781
  error estimate for blocks of size 2^( 3) =       0.000435877858
  error estimate for blocks of size 2^( 4) =       0.000447270653
  error estimate for blocks of size 2^( 5) =       0.000458462544
  error estimate for blocks of size 2^( 6) =       0.000467952838
  error estimate for blocks of size 2^( 7) =       0.000472917473

      target function =                  N/A
              le_mean =     -16.906524175110
             les_mean =     286.167671609889
             stat err =       0.000461650877
             autocorr =       1.264395645396
              std dev =       0.580613550369
             le_variance =       0.337112094872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652417511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+12, overlap shift 9.3132e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906524175110       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906524175110       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+12 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906524175110       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906524175110       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+13 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906524175110       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906524175110       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.358970 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5833e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8994
    reference variance = 0.177072
====================================================
  Execution time = 2.0204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4938e-01
  Total weights = 2.0000e+06
  Execution time = 1.8856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349496697645
                                         uncertainty =       0.006666818813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349496697645
                                         uncertainty =       0.006666818813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417960966
  error estimate for blocks of size 2^( 2) =       0.000430366961
  error estimate for blocks of size 2^( 3) =       0.000443291942
  error estimate for blocks of size 2^( 4) =       0.000455373151
  error estimate for blocks of size 2^( 5) =       0.000465728089
  error estimate for blocks of size 2^( 6) =       0.000473327091
  error estimate for blocks of size 2^( 7) =       0.000477344958

      target function =                  N/A
              le_mean =     -16.905923424498
             les_mean =     286.159629398449
             stat err =       0.000467943322
             autocorr =       1.253473219483
              std dev =       0.591086066629
             le_variance =       0.349382738163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349496697645
                                         uncertainty =       0.006666818813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349496697645
                                         uncertainty =       0.006666818813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417960966
  error estimate for blocks of size 2^( 2) =       0.000430366961
  error estimate for blocks of size 2^( 3) =       0.000443291942
  error estimate for blocks of size 2^( 4) =       0.000455373151
  error estimate for blocks of size 2^( 5) =       0.000465728089
  error estimate for blocks of size 2^( 6) =       0.000473327091
  error estimate for blocks of size 2^( 7) =       0.000477344958

      target function =                  N/A
              le_mean =     -16.905923424498
             les_mean =     286.159629398449
             stat err =       0.000467943322
             autocorr =       1.253473219483
              std dev =       0.591086066629
             le_variance =       0.349382738163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349496697645
                                         uncertainty =       0.006666818813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349496697645
                                         uncertainty =       0.006666818813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417960966
  error estimate for blocks of size 2^( 2) =       0.000430366961
  error estimate for blocks of size 2^( 3) =       0.000443291942
  error estimate for blocks of size 2^( 4) =       0.000455373151
  error estimate for blocks of size 2^( 5) =       0.000465728089
  error estimate for blocks of size 2^( 6) =       0.000473327091
  error estimate for blocks of size 2^( 7) =       0.000477344958

      target function =                  N/A
              le_mean =     -16.905923424498
             les_mean =     286.159629398449
             stat err =       0.000467943322
             autocorr =       1.253473219483
              std dev =       0.591086066629
             le_variance =       0.349382738163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349496697645
                                         uncertainty =       0.006666818813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349496697645
                                         uncertainty =       0.006666818813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417960966
  error estimate for blocks of size 2^( 2) =       0.000430366961
  error estimate for blocks of size 2^( 3) =       0.000443291942
  error estimate for blocks of size 2^( 4) =       0.000455373151
  error estimate for blocks of size 2^( 5) =       0.000465728089
  error estimate for blocks of size 2^( 6) =       0.000473327091
  error estimate for blocks of size 2^( 7) =       0.000477344958

      target function =                  N/A
              le_mean =     -16.905923424498
             les_mean =     286.159629398449
             stat err =       0.000467943322
             autocorr =       1.253473219483
              std dev =       0.591086066629
             le_variance =       0.349382738163


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905923424498        initial  <--
     9.3132e+12     9.3132e+13             0.0000e+00       -16.905923424498
     3.7253e+13     3.7253e+14             0.0000e+00       -16.905923424498
     1.4901e+14     1.4901e+15             0.0000e+00       -16.905923424498

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7302
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5572e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8833
    reference variance = 0.221639
====================================================
  Execution time = 1.9981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4161e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341561764217
                                         uncertainty =       0.005603169185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341561764217
                                         uncertainty =       0.005603169185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413288296
  error estimate for blocks of size 2^( 2) =       0.000425916593
  error estimate for blocks of size 2^( 3) =       0.000438947750
  error estimate for blocks of size 2^( 4) =       0.000450810017
  error estimate for blocks of size 2^( 5) =       0.000461514142
  error estimate for blocks of size 2^( 6) =       0.000470079515
  error estimate for blocks of size 2^( 7) =       0.000474971689

      target function =                  N/A
              le_mean =     -16.906349320401
             les_mean =     286.166261604187
             stat err =       0.000464343841
             autocorr =       1.262330758654
              std dev =       0.584477913671
             le_variance =       0.341614431570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634932040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349320401       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349320401       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349320401       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349320401       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+15, overlap shift 1.4901e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349320401       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349320401       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.360021 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5535e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9921
    reference variance = 0.284813
====================================================
  Execution time = 1.9956e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3771e-01
  Total weights = 2.0000e+06
  Execution time = 1.8888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337718440077
                                         uncertainty =       0.003743060661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337718440077
                                         uncertainty =       0.003743060661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410922155
  error estimate for blocks of size 2^( 2) =       0.000423451320
  error estimate for blocks of size 2^( 3) =       0.000436745353
  error estimate for blocks of size 2^( 4) =       0.000448322196
  error estimate for blocks of size 2^( 5) =       0.000457650669
  error estimate for blocks of size 2^( 6) =       0.000465805568
  error estimate for blocks of size 2^( 7) =       0.000469965425

      target function =                  N/A
              le_mean =     -16.906071705486
             les_mean =     286.152974377747
             stat err =       0.000460435965
             autocorr =       1.255507649415
              std dev =       0.581131685231
             le_variance =       0.337714035579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337718440077
                                         uncertainty =       0.003743060661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337718440077
                                         uncertainty =       0.003743060661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410922155
  error estimate for blocks of size 2^( 2) =       0.000423451320
  error estimate for blocks of size 2^( 3) =       0.000436745353
  error estimate for blocks of size 2^( 4) =       0.000448322196
  error estimate for blocks of size 2^( 5) =       0.000457650669
  error estimate for blocks of size 2^( 6) =       0.000465805568
  error estimate for blocks of size 2^( 7) =       0.000469965425

      target function =                  N/A
              le_mean =     -16.906071705486
             les_mean =     286.152974377747
             stat err =       0.000460435965
             autocorr =       1.255507649415
              std dev =       0.581131685231
             le_variance =       0.337714035579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337718440077
                                         uncertainty =       0.003743060661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337718440077
                                         uncertainty =       0.003743060661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410922155
  error estimate for blocks of size 2^( 2) =       0.000423451320
  error estimate for blocks of size 2^( 3) =       0.000436745353
  error estimate for blocks of size 2^( 4) =       0.000448322196
  error estimate for blocks of size 2^( 5) =       0.000457650669
  error estimate for blocks of size 2^( 6) =       0.000465805568
  error estimate for blocks of size 2^( 7) =       0.000469965425

      target function =                  N/A
              le_mean =     -16.906071705486
             les_mean =     286.152974377747
             stat err =       0.000460435965
             autocorr =       1.255507649415
              std dev =       0.581131685231
             le_variance =       0.337714035579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337718440077
                                         uncertainty =       0.003743060661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337718440077
                                         uncertainty =       0.003743060661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410922155
  error estimate for blocks of size 2^( 2) =       0.000423451320
  error estimate for blocks of size 2^( 3) =       0.000436745353
  error estimate for blocks of size 2^( 4) =       0.000448322196
  error estimate for blocks of size 2^( 5) =       0.000457650669
  error estimate for blocks of size 2^( 6) =       0.000465805568
  error estimate for blocks of size 2^( 7) =       0.000469965425

      target function =                  N/A
              le_mean =     -16.906071705486
             les_mean =     286.152974377747
             stat err =       0.000460435965
             autocorr =       1.255507649415
              std dev =       0.581131685231
             le_variance =       0.337714035579


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906071705486        initial  <--
     9.3132e+13     9.3132e+14             0.0000e+00       -16.906071705486
     3.7253e+14     3.7253e+15             0.0000e+00       -16.906071705486
     1.4901e+15     1.4901e+16             0.0000e+00       -16.906071705486

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5015
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5045e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8707
    reference variance = 0.21754
====================================================
  Execution time = 1.9957e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3786e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337562862374
                                         uncertainty =       0.005133823263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337562862374
                                         uncertainty =       0.005133823263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411010725
  error estimate for blocks of size 2^( 2) =       0.000424006795
  error estimate for blocks of size 2^( 3) =       0.000436796601
  error estimate for blocks of size 2^( 4) =       0.000449562788
  error estimate for blocks of size 2^( 5) =       0.000461239678
  error estimate for blocks of size 2^( 6) =       0.000469139987
  error estimate for blocks of size 2^( 7) =       0.000476778046

      target function =                  N/A
              le_mean =     -16.906465359112
             les_mean =     286.166430401731
             stat err =       0.000464180125
             autocorr =       1.275459795252
              std dev =       0.581256941285
             le_variance =       0.337859631792


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690646535911e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+14, overlap shift 9.3132e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465359112       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465359112       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+15, overlap shift 3.7253e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465359112       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465359112       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+16, overlap shift 1.4901e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465359112       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465359112       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5598e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9346
    reference variance = 0.207646
====================================================
  Execution time = 2.0415e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4820e-01
  Total weights = 2.0000e+06
  Execution time = 1.8855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348256426923
                                         uncertainty =       0.010367923464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348256426923
                                         uncertainty =       0.010367923464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417254580
  error estimate for blocks of size 2^( 2) =       0.000429397571
  error estimate for blocks of size 2^( 3) =       0.000442388294
  error estimate for blocks of size 2^( 4) =       0.000454088205
  error estimate for blocks of size 2^( 5) =       0.000463121645
  error estimate for blocks of size 2^( 6) =       0.000470968634
  error estimate for blocks of size 2^( 7) =       0.000476688178

      target function =                  N/A
              le_mean =     -16.905384945513
             les_mean =     286.140242751056
             stat err =       0.000466216666
             autocorr =       1.248456351138
              std dev =       0.590087086109
             le_variance =       0.348202769193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348256426923
                                         uncertainty =       0.010367923464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348256426923
                                         uncertainty =       0.010367923464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417254580
  error estimate for blocks of size 2^( 2) =       0.000429397571
  error estimate for blocks of size 2^( 3) =       0.000442388294
  error estimate for blocks of size 2^( 4) =       0.000454088205
  error estimate for blocks of size 2^( 5) =       0.000463121645
  error estimate for blocks of size 2^( 6) =       0.000470968634
  error estimate for blocks of size 2^( 7) =       0.000476688178

      target function =                  N/A
              le_mean =     -16.905384945513
             les_mean =     286.140242751056
             stat err =       0.000466216666
             autocorr =       1.248456351138
              std dev =       0.590087086109
             le_variance =       0.348202769193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348256426923
                                         uncertainty =       0.010367923464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348256426923
                                         uncertainty =       0.010367923464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417254580
  error estimate for blocks of size 2^( 2) =       0.000429397571
  error estimate for blocks of size 2^( 3) =       0.000442388294
  error estimate for blocks of size 2^( 4) =       0.000454088205
  error estimate for blocks of size 2^( 5) =       0.000463121645
  error estimate for blocks of size 2^( 6) =       0.000470968634
  error estimate for blocks of size 2^( 7) =       0.000476688178

      target function =                  N/A
              le_mean =     -16.905384945513
             les_mean =     286.140242751056
             stat err =       0.000466216666
             autocorr =       1.248456351138
              std dev =       0.590087086109
             le_variance =       0.348202769193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348256426923
                                         uncertainty =       0.010367923464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348256426923
                                         uncertainty =       0.010367923464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417254580
  error estimate for blocks of size 2^( 2) =       0.000429397571
  error estimate for blocks of size 2^( 3) =       0.000442388294
  error estimate for blocks of size 2^( 4) =       0.000454088205
  error estimate for blocks of size 2^( 5) =       0.000463121645
  error estimate for blocks of size 2^( 6) =       0.000470968634
  error estimate for blocks of size 2^( 7) =       0.000476688178

      target function =                  N/A
              le_mean =     -16.905384945513
             les_mean =     286.140242751056
             stat err =       0.000466216666
             autocorr =       1.248456351138
              std dev =       0.590087086109
             le_variance =       0.348202769193


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905384945513        initial  <--
     9.3132e+14     9.3132e+15             0.0000e+00       -16.905384945513
     3.7253e+15     3.7253e+16             0.0000e+00       -16.905384945513
     1.4901e+16     1.4901e+17             0.0000e+00       -16.905384945513

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9139
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.097779e-01 1 1  ON 0
 uu_1                 1.429008e-01 1 1  ON 1
 uu_2                 4.129106e-02 1 1  ON 2
 uu_3                -2.137689e-02 1 1  ON 3
 uu_4                -6.692727e-02 1 1  ON 4
 uu_5                -1.016714e-01 1 1  ON 5
 uu_6                -1.290944e-01 1 1  ON 6
 uu_7                -1.422658e-01 1 1  ON 7
 uu_8                -1.344241e-01 1 1  ON 8
 uu_9                -1.057365e-01 1 1  ON 9
 ud_0                 4.496483e-01 1 1  ON 10
 ud_1                 1.837425e-01 1 1  ON 11
 ud_2                 6.324588e-02 1 1  ON 12
 ud_3                -8.120934e-03 1 1  ON 13
 ud_4                -6.563152e-02 1 1  ON 14
 ud_5                -1.075742e-01 1 1  ON 15
 ud_6                -1.356855e-01 1 1  ON 16
 ud_7                -1.524652e-01 1 1  ON 17
 ud_8                -1.529177e-01 1 1  ON 18
 ud_9                -1.434486e-01 1 1  ON 19
 eO_0                -7.601517e-01 1 1  ON 20
 eO_1                -4.389333e-01 1 1  ON 21
 eO_2                -2.158219e-02 1 1  ON 22
 eO_3                 2.986033e-01 1 1  ON 23
 eO_4                 5.262940e-01 1 1  ON 24
 eO_5                 4.881205e-01 1 1  ON 25
 eO_6                 2.606447e-01 1 1  ON 26
 eO_7                -4.047704e-02 1 1  ON 27
 eO_8                -2.226013e-01 1 1  ON 28
 eO_9                -8.822433e-02 1 1  ON 29
eH1_0                -2.487031e-01 1 1  ON 30
eH1_1                -1.468865e-01 1 1  ON 31
eH1_2                -9.890365e-02 1 1  ON 32
eH1_3                -4.438922e-02 1 1  ON 33
eH1_4                 3.841960e-03 1 1  ON 34
eH1_5                 3.777663e-02 1 1  ON 35
eH1_6                 9.678769e-02 1 1  ON 36
eH1_7                 1.546459e-01 1 1  ON 37
eH1_8                 1.791224e-01 1 1  ON 38
eH1_9                 7.044155e-02 1 1  ON 39
eH2_0                -2.468691e-01 1 1  ON 40
eH2_1                -1.443698e-01 1 1  ON 41
eH2_2                -9.645268e-02 1 1  ON 42
eH2_3                -4.215406e-02 1 1  ON 43
eH2_4                 6.354578e-03 1 1  ON 44
eH2_5                 4.030376e-02 1 1  ON 45
eH2_6                 9.913490e-02 1 1  ON 46
eH2_7                 1.555124e-01 1 1  ON 47
eH2_8                 1.843471e-01 1 1  ON 48
eH2_9                 6.044747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5518e+01 secs
  Total Execution time = 2.2440e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
