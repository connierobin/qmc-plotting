Rank =    0  Free Memory = 79808 MB
Rank =    1  Free Memory = 79807 MB
Rank =    2  Free Memory = 79807 MB
Rank =    3  Free Memory = 79807 MB
Rank =    4  Free Memory = 79807 MB
Rank =    5  Free Memory = 79807 MB
Rank =    6  Free Memory = 79807 MB
Rank =    7  Free Memory = 79806 MB
Rank =    8  Free Memory = 79806 MB
Rank =    9  Free Memory = 79806 MB
Rank =   10  Free Memory = 79806 MB
Rank =   11  Free Memory = 79806 MB
Rank =   12  Free Memory = 79806 MB
Rank =   13  Free Memory = 79806 MB
Rank =   14  Free Memory = 79806 MB
Rank =   15  Free Memory = 79790 MB
Rank =   16  Free Memory = 79789 MB
Rank =   17  Free Memory = 79789 MB
Rank =   18  Free Memory = 79789 MB
Rank =   19  Free Memory = 79789 MB
Rank =   20  Free Memory = 79789 MB
Rank =   21  Free Memory = 79789 MB
Rank =   22  Free Memory = 79789 MB
Rank =   23  Free Memory = 79789 MB
Rank =   24  Free Memory = 79789 MB
Rank =   25  Free Memory = 79789 MB
Rank =   26  Free Memory = 79789 MB
Rank =   27  Free Memory = 79789 MB
Rank =   28  Free Memory = 79789 MB
Rank =   29  Free Memory = 79789 MB
Rank =   30  Free Memory = 79789 MB
Rank =   31  Free Memory = 79789 MB
Rank =   32  Free Memory = 80941 MB
Rank =   33  Free Memory = 80941 MB
Rank =   34  Free Memory = 80941 MB
Rank =   35  Free Memory = 80941 MB
Rank =   36  Free Memory = 80941 MB
Rank =   37  Free Memory = 80941 MB
Rank =   38  Free Memory = 80941 MB
Rank =   39  Free Memory = 80941 MB
Rank =   40  Free Memory = 80941 MB
Rank =   41  Free Memory = 80941 MB
Rank =   42  Free Memory = 80941 MB
Rank =   43  Free Memory = 80941 MB
Rank =   44  Free Memory = 80941 MB
Rank =   45  Free Memory = 80941 MB
Rank =   46  Free Memory = 80941 MB
Rank =   47  Free Memory = 80941 MB
Rank =   48  Free Memory = 80941 MB
Rank =   49  Free Memory = 80940 MB
Rank =   50  Free Memory = 80940 MB
Rank =   51  Free Memory = 80940 MB
Rank =   52  Free Memory = 80940 MB
Rank =   53  Free Memory = 80940 MB
Rank =   54  Free Memory = 80940 MB
Rank =   55  Free Memory = 80940 MB
Rank =   56  Free Memory = 80940 MB
Rank =   57  Free Memory = 80940 MB
Rank =   58  Free Memory = 80940 MB
Rank =   59  Free Memory = 80940 MB
Rank =   60  Free Memory = 80940 MB
Rank =   61  Free Memory = 80940 MB
Rank =   62  Free Memory = 80940 MB
Rank =   63  Free Memory = 80940 MB
Rank =   64  Free Memory = 80940 MB
Rank =   65  Free Memory = 80940 MB
Rank =   66  Free Memory = 80940 MB
Rank =   67  Free Memory = 80940 MB
Rank =   68  Free Memory = 80940 MB
Rank =   69  Free Memory = 80940 MB
Rank =   70  Free Memory = 80940 MB
Rank =   71  Free Memory = 80940 MB
Rank =   72  Free Memory = 89943 MB
Rank =   73  Free Memory = 89943 MB
Rank =   74  Free Memory = 89943 MB
Rank =   75  Free Memory = 89943 MB
Rank =   76  Free Memory = 89943 MB
Rank =   77  Free Memory = 89943 MB
Rank =   78  Free Memory = 89943 MB
Rank =   79  Free Memory = 89943 MB
Rank =   80  Free Memory = 89943 MB
Rank =   81  Free Memory = 89943 MB
Rank =   82  Free Memory = 89943 MB
Rank =   83  Free Memory = 89943 MB
Rank =   84  Free Memory = 89943 MB
Rank =   85  Free Memory = 89943 MB
Rank =   86  Free Memory = 89943 MB
Rank =   87  Free Memory = 89943 MB
Rank =   88  Free Memory = 89943 MB
Rank =   89  Free Memory = 89943 MB
Rank =   90  Free Memory = 89943 MB
Rank =   91  Free Memory = 89943 MB
Rank =   92  Free Memory = 89943 MB
Rank =   93  Free Memory = 89943 MB
Rank =   94  Free Memory = 89943 MB
Rank =   95  Free Memory = 89943 MB
Rank =   96  Free Memory = 89943 MB
Rank =   97  Free Memory = 89943 MB
Rank =   98  Free Memory = 89943 MB
Rank =   99  Free Memory = 89943 MB
Rank =  100  Free Memory = 89943 MB
Rank =  101  Free Memory = 89943 MB
Rank =  102  Free Memory = 89943 MB
Rank =  103  Free Memory = 89943 MB
Rank =  104  Free Memory = 89943 MB
Rank =  105  Free Memory = 89943 MB
Rank =  106  Free Memory = 89943 MB
Rank =  107  Free Memory = 89943 MB
Rank =  108  Free Memory = 89943 MB
Rank =  109  Free Memory = 89943 MB
Rank =  110  Free Memory = 89943 MB
Rank =  111  Free Memory = 89943 MB
Rank =  112  Free Memory = 86989 MB
Rank =  113  Free Memory = 86989 MB
Rank =  114  Free Memory = 86989 MB
Rank =  115  Free Memory = 86989 MB
Rank =  116  Free Memory = 86989 MB
Rank =  117  Free Memory = 86989 MB
Rank =  118  Free Memory = 86989 MB
Rank =  119  Free Memory = 86989 MB
Rank =  120  Free Memory = 86989 MB
  Input file(s): opt_form_pi2pistar_gvpabs_run001j.xml 
Rank =  121  Free Memory = 86989 MB
Rank =  122  Free Memory = 86989 MB
Rank =  123  Free Memory = 86989 MB
Rank =  124  Free Memory = 86989 MB
Rank =  125  Free Memory = 86989 MB
Rank =  126  Free Memory = 86989 MB
Rank =  127  Free Memory = 86989 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_pi2pistar_gvpabs_run001j.xml

  Project = FORM
  date    = 2023-04-01 10:21:57 PDT
  host    = n0029.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 53

  Range of prime numbers to use as seeds over processors and threads = 257-1093


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.788559e-01    1         1  ON     0
     uu_1                 1.044870e-01    1         1  ON     1
     uu_2                -9.974884e-03    1         1  ON     2
     uu_3                -7.760616e-02    1         1  ON     3
     uu_4                -1.152365e-01    1         1  ON     4
     uu_5                -1.350288e-01    1         1  ON     5
     uu_6                -1.402198e-01    1         1  ON     6
     uu_7                -1.274953e-01    1         1  ON     7
     uu_8                -9.163988e-02    1         1  ON     8
     uu_9                -1.292108e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.399830e-01    1         1  ON     0
     ud_1                 1.560955e-01    1         1  ON     1
     ud_2                 7.229770e-03    1         1  ON     2
     ud_3                -7.461450e-02    1         1  ON     3
     ud_4                -1.204869e-01    1         1  ON     4
     ud_5                -1.480506e-01    1         1  ON     5
     ud_6                -1.606933e-01    1         1  ON     6
     ud_7                -1.560007e-01    1         1  ON     7
     ud_8                -1.264484e-01    1         1  ON     8
     ud_9                -5.892102e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.732969e-01    1         1  ON     0
     eC_1                -4.035478e-01    1         1  ON     1
     eC_2                -1.080731e-01    1         1  ON     2
     eC_3                 9.607600e-02    1         1  ON     3
     eC_4                 2.176087e-01    1         1  ON     4
     eC_5                 3.072464e-01    1         1  ON     5
     eC_6                 2.605211e-01    1         1  ON     6
     eC_7                 1.569144e-01    1         1  ON     7
     eC_8                 3.849640e-02    1         1  ON     8
     eC_9                 6.625033e-03    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.051642e+00    1         1  ON     0
     eO_1                -6.635056e-01    1         1  ON     1
     eO_2                -1.835746e-01    1         1  ON     2
     eO_3                 1.224324e-01    1         1  ON     3
     eO_4                 3.203065e-01    1         1  ON     4
     eO_5                 4.257929e-01    1         1  ON     5
     eO_6                 4.071230e-01    1         1  ON     6
     eO_7                 3.487159e-01    1         1  ON     7
     eO_8                 1.788292e-01    1         1  ON     8
     eO_9                 6.590916e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.467596e-01    1         1  ON     0
     eH1_1                -4.675644e-02    1         1  ON     1
     eH1_2                -2.634570e-02    1         1  ON     2
     eH1_3                -2.595068e-02    1         1  ON     3
     eH1_4                 1.008636e-02    1         1  ON     4
     eH1_5                 1.825686e-02    1         1  ON     5
     eH1_6                 4.367776e-02    1         1  ON     6
     eH1_7                 4.210144e-02    1         1  ON     7
     eH1_8                 4.882056e-02    1         1  ON     8
     eH1_9                 6.207064e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.479474e-01    1         1  ON     0
     eH2_1                -4.769881e-02    1         1  ON     1
     eH2_2                -2.693164e-02    1         1  ON     2
     eH2_3                -2.653919e-02    1         1  ON     3
     eH2_4                 9.465941e-03    1         1  ON     4
     eH2_5                 1.747214e-02    1         1  ON     5
     eH2_6                 4.315340e-02    1         1  ON     6
     eH2_7                 4.175880e-02    1         1  ON     7
     eH2_8                 5.549858e-02    1         1  ON     8
     eH2_9                 6.160298e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 140 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 8.212874e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 28 unique up determinants.
Found 28 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.8092e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  4.0107225728e-02 -5.0659535091e-01 -4.8356690577e-01
    u -2.0203417087e-01 -1.2691590666e+00 -2.1169263951e+00
    u  2.9913287695e-01 -2.3710879234e-01  2.0101719070e+00
    u  4.8474243406e-02 -5.3051852953e-01  9.5378285444e-01
    u -5.5511775119e-01 -9.8683271286e-02  1.4043240644e+00
    u  6.9646297924e-01  2.5004217823e+00 -2.4744046405e+00
    d -1.1004432466e+00 -7.1118992563e-01 -1.4300801983e+00
    d -3.6824818327e-02  7.5687344105e-01 -1.6708867165e+00
    d -9.4375526199e-01  1.5348935511e-01  1.1974289766e+00
    d -8.9321447322e-02 -6.9596903295e-02  1.4810785623e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.4252
    reference variance = 0.380451
====================================================
  Execution time = 4.6015e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5925e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5505e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559330257536
                                         uncertainty =       0.008717752115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559330257536
                                         uncertainty =       0.008717752115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528797185
  error estimate for blocks of size 2^( 2) =       0.000548974704
  error estimate for blocks of size 2^( 3) =       0.000567854397
  error estimate for blocks of size 2^( 4) =       0.000582591633
  error estimate for blocks of size 2^( 5) =       0.000593020923
  error estimate for blocks of size 2^( 6) =       0.000597450449
  error estimate for blocks of size 2^( 7) =       0.000601421860

      target function =                  N/A
              le_mean =     -22.435559455763
             les_mean =     503.913580740075
             stat err =       0.000593621216
             autocorr =       1.260203144688
              std dev =       0.747832151365
             le_variance =       0.559252926616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.243555945576e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435559455763       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435560921096       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435565327023       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435567781698       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435573852391       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435572827348       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435574363784       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435577597718       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435578663482       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435577727310       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435577084964       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.435577298289       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.435577114614       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.435577340439       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.435577373992       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 3.048457e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435559455763       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435560001492       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435561200187       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435561960364       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435564335067       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435564670827       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435564663286       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435565011043       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435565155277       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435565034717       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435564844375       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.435564875353       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 7.484796e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435559455763       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435559611228       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435559903254       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435560100062       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435560727773       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435560934624       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435560923706       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435560945561       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435560969509       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435560952107       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435560906835       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.435560914430       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 1.866792e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152466 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1682e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.789548e-01                 1 1 ON  0
uu_1  1.045427e-01                 1 1 ON  1
uu_2  -9.983650e-03                1 1 ON  2
uu_3  -7.765000e-02                1 1 ON  3
uu_4  -1.152779e-01                1 1 ON  4
uu_5  -1.350062e-01                1 1 ON  5
uu_6  -1.402858e-01                1 1 ON  6
uu_7  -1.277095e-01                1 1 ON  7
uu_8  -9.193868e-02                1 1 ON  8
uu_9  -1.315369e-02                1 1 ON  9
ud_0  4.400619e-01                 1 1 ON  10
ud_1  1.561161e-01                 1 1 ON  11
ud_2  7.220586e-03                 1 1 ON  12
ud_3  -7.465014e-02                1 1 ON  13
ud_4  -1.205672e-01                1 1 ON  14
ud_5  -1.481984e-01                1 1 ON  15
ud_6  -1.607833e-01                1 1 ON  16
ud_7  -1.559813e-01                1 1 ON  17
ud_8  -1.265056e-01                1 1 ON  18
ud_9  -5.900973e-02                1 1 ON  19
eC_0  -5.736433e-01                1 1 ON  20
eC_1  -4.039256e-01                1 1 ON  21
eC_2  -1.082076e-01                1 1 ON  22
eC_3  9.597549e-02                 1 1 ON  23
eC_4  2.175554e-01                 1 1 ON  24
eC_5  3.071700e-01                 1 1 ON  25
eC_6  2.607138e-01                 1 1 ON  26
eC_7  1.575712e-01                 1 1 ON  27
eC_8  3.871713e-02                 1 1 ON  28
eC_9  6.648428e-03                 1 1 ON  29
eO_0  -1.051836e+00                1 1 ON  30
eO_1  -6.638936e-01                1 1 ON  31
eO_2  -1.838885e-01                1 1 ON  32
eO_3  1.221909e-01                 1 1 ON  33
eO_4  3.200945e-01                 1 1 ON  34
eO_5  4.256123e-01                 1 1 ON  35
eO_6  4.071335e-01                 1 1 ON  36
eO_7  3.490543e-01                 1 1 ON  37
eO_8  1.795777e-01                 1 1 ON  38
eO_9  6.626822e-02                 1 1 ON  39
eH1_0 -1.469320e-01                1 1 ON  40
eH1_1 -4.693978e-02                1 1 ON  41
eH1_2 -2.644120e-02                1 1 ON  42
eH1_3 -2.602442e-02                1 1 ON  43
eH1_4 1.008415e-02                 1 1 ON  44
eH1_5 1.834901e-02                 1 1 ON  45
eH1_6 4.380972e-02                 1 1 ON  46
eH1_7 4.212712e-02                 1 1 ON  47
eH1_8 4.878835e-02                 1 1 ON  48
eH1_9 6.228041e-02                 1 1 ON  49
eH2_0 -1.480674e-01                1 1 ON  50
eH2_1 -4.778100e-02                1 1 ON  51
eH2_2 -2.722867e-02                1 1 ON  52
eH2_3 -2.645723e-02                1 1 ON  53
eH2_4 9.482039e-03                 1 1 ON  54
eH2_5 1.738905e-02                 1 1 ON  55
eH2_6 4.333518e-02                 1 1 ON  56
eH2_7 4.180336e-02                 1 1 ON  57
eH2_8 5.546435e-02                 1 1 ON  58
eH2_9 6.179282e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.3523
    reference variance = 0.436642
====================================================
  Execution time = 4.4815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6203e-01
  Total weights = 2.0000e+06
  Execution time = 3.8612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561521991307
                                         uncertainty =       0.003981344395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561521991307
                                         uncertainty =       0.003981344395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530025639
  error estimate for blocks of size 2^( 2) =       0.000550857580
  error estimate for blocks of size 2^( 3) =       0.000570546123
  error estimate for blocks of size 2^( 4) =       0.000586675603
  error estimate for blocks of size 2^( 5) =       0.000596067000
  error estimate for blocks of size 2^( 6) =       0.000600715896
  error estimate for blocks of size 2^( 7) =       0.000605696703

      target function =                  N/A
              le_mean =     -22.435993359234
             les_mean =     503.935652091360
             stat err =       0.000597288801
             autocorr =       1.269915973890
              std dev =       0.749569447553
             le_variance =       0.561854356705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562002422610
                                         uncertainty =       0.003985216355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562002422610
                                         uncertainty =       0.003985216355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530252329
  error estimate for blocks of size 2^( 2) =       0.000551076249
  error estimate for blocks of size 2^( 3) =       0.000570747393
  error estimate for blocks of size 2^( 4) =       0.000586869990
  error estimate for blocks of size 2^( 5) =       0.000596240146
  error estimate for blocks of size 2^( 6) =       0.000600872830
  error estimate for blocks of size 2^( 7) =       0.000605841175

      target function =                  N/A
              le_mean =     -22.435995347376
             les_mean =     503.936222010926
             stat err =       0.000597456035
             autocorr =       1.269541013736
              std dev =       0.749890035011
             le_variance =       0.562335064609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561871941780
                                         uncertainty =       0.003984455039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561871941780
                                         uncertainty =       0.003984455039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530190780
  error estimate for blocks of size 2^( 2) =       0.000551017070
  error estimate for blocks of size 2^( 3) =       0.000570693775
  error estimate for blocks of size 2^( 4) =       0.000586820902
  error estimate for blocks of size 2^( 5) =       0.000596198468
  error estimate for blocks of size 2^( 6) =       0.000600838883
  error estimate for blocks of size 2^( 7) =       0.000605812981

      target function =                  N/A
              le_mean =     -22.435994457886
             les_mean =     503.936051559392
             stat err =       0.000597417808
             autocorr =       1.269673299468
              std dev =       0.749802991591
             le_variance =       0.562204526199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561577414723
                                         uncertainty =       0.003981852005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561577414723
                                         uncertainty =       0.003981852005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530051798
  error estimate for blocks of size 2^( 2) =       0.000550882703
  error estimate for blocks of size 2^( 3) =       0.000570569366
  error estimate for blocks of size 2^( 4) =       0.000586698560
  error estimate for blocks of size 2^( 5) =       0.000596087991
  error estimate for blocks of size 2^( 6) =       0.000600735828
  error estimate for blocks of size 2^( 7) =       0.000605715652

      target function =                  N/A
              le_mean =     -22.435993365434
             les_mean =     503.935707829235
             stat err =       0.000597309508
             autocorr =       1.269878680851
              std dev =       0.749606440995
             le_variance =       0.561909816381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435993359234        initial
     2.5000e-01     2.5000e+00             3.0485e-03       -22.435995347376  <--
     1.0000e+00     1.0000e+01             7.4848e-04       -22.435994457886
     4.0000e+00     4.0000e+01             1.8668e-04       -22.435993365434

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.4136e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.791190e-01 1 1  ON 0
 uu_1                 1.046218e-01 1 1  ON 1
 uu_2                -9.988795e-03 1 1  ON 2
 uu_3                -7.772268e-02 1 1  ON 3
 uu_4                -1.153562e-01 1 1  ON 4
 uu_5                -1.350378e-01 1 1  ON 5
 uu_6                -1.404780e-01 1 1  ON 6
 uu_7                -1.282066e-01 1 1  ON 7
 uu_8                -9.279992e-02 1 1  ON 8
 uu_9                -1.389371e-02 1 1  ON 9
 ud_0                 4.401986e-01 1 1  ON 10
 ud_1                 1.561546e-01 1 1  ON 11
 ud_2                 7.212519e-03 1 1  ON 12
 ud_3                -7.474110e-02 1 1  ON 13
 ud_4                -1.207464e-01 1 1  ON 14
 ud_5                -1.484959e-01 1 1  ON 15
 ud_6                -1.610439e-01 1 1  ON 16
 ud_7                -1.560496e-01 1 1  ON 17
 ud_8                -1.267025e-01 1 1  ON 18
 ud_9                -5.928737e-02 1 1  ON 19
 eC_0                -5.746216e-01 1 1  ON 20
 eC_1                -4.048876e-01 1 1  ON 21
 eC_2                -1.087597e-01 1 1  ON 22
 eC_3                 9.560536e-02 1 1  ON 23
 eC_4                 2.172932e-01 1 1  ON 24
 eC_5                 3.069650e-01 1 1  ON 25
 eC_6                 2.612981e-01 1 1  ON 26
 eC_7                 1.595733e-01 1 1  ON 27
 eC_8                 3.940017e-02 1 1  ON 28
 eC_9                 6.722391e-03 1 1  ON 29
 eO_0                -1.052698e+00 1 1  ON 30
 eO_1                -6.648970e-01 1 1  ON 31
 eO_2                -1.848147e-01 1 1  ON 32
 eO_3                 1.213884e-01 1 1  ON 33
 eO_4                 3.194206e-01 1 1  ON 34
 eO_5                 4.251231e-01 1 1  ON 35
 eO_6                 4.072085e-01 1 1  ON 36
 eO_7                 3.500955e-01 1 1  ON 37
 eO_8                 1.818777e-01 1 1  ON 38
 eO_9                 6.737815e-02 1 1  ON 39
eH1_0                -1.474224e-01 1 1  ON 40
eH1_1                -4.738674e-02 1 1  ON 41
eH1_2                -2.671496e-02 1 1  ON 42
eH1_3                -2.620886e-02 1 1  ON 43
eH1_4                 1.005968e-02 1 1  ON 44
eH1_5                 1.850321e-02 1 1  ON 45
eH1_6                 4.413551e-02 1 1  ON 46
eH1_7                 4.223119e-02 1 1  ON 47
eH1_8                 4.867730e-02 1 1  ON 48
eH1_9                 6.291779e-02 1 1  ON 49
eH2_0                -1.484065e-01 1 1  ON 50
eH2_1                -4.804108e-02 1 1  ON 51
eH2_2                -2.783396e-02 1 1  ON 52
eH2_3                -2.641543e-02 1 1  ON 53
eH2_4                 9.467142e-03 1 1  ON 54
eH2_5                 1.724293e-02 1 1  ON 55
eH2_6                 4.370047e-02 1 1  ON 56
eH2_7                 4.197965e-02 1 1  ON 57
eH2_8                 5.535330e-02 1 1  ON 58
eH2_9                 6.236914e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2583e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2389e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.4695
    reference variance = 0.448639
====================================================
  Execution time = 4.5864e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6183e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5461e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561890996087
                                         uncertainty =       0.004723563166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561890996087
                                         uncertainty =       0.004723563166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530012507
  error estimate for blocks of size 2^( 2) =       0.000550501127
  error estimate for blocks of size 2^( 3) =       0.000568547103
  error estimate for blocks of size 2^( 4) =       0.000582920926
  error estimate for blocks of size 2^( 5) =       0.000591406163
  error estimate for blocks of size 2^( 6) =       0.000596201695
  error estimate for blocks of size 2^( 7) =       0.000596785589

      target function =                  N/A
              le_mean =     -22.436937781933
             les_mean =     503.978003264142
             stat err =       0.000591828593
             autocorr =       1.246865623503
              std dev =       0.749550875352
             le_variance =       0.561826514742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243693778193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436937781933       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436936286997       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436942313527       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436950951929       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436958590072       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436954399701       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436954656484       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436958010547       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436961499354       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436973110722       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436978070884       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436975743395       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436976130314       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436977111699       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436975953818       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436975396982       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436975535860       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436975904040       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 1.223474e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436937781933       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436936794717       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436937433864       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436942484888       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436947281546       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436946093938       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436943916103       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436944674349       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436946535188       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436948711031       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436948617158       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436947996098       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436948170604       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436948217682       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 2.835114e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436937781933       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436937363356       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436937265446       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436938536036       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436940047363       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436940329027       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436939206100       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436939733933       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436940091158       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436940306486       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436940163937       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436940189054       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 6.958395e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1342e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.790692e-01 1 1  ON 0
 uu_1                 1.045127e-01 1 1  ON 1
 uu_2                -1.009429e-02 1 1  ON 2
 uu_3                -7.775299e-02 1 1  ON 3
 uu_4                -1.155163e-01 1 1  ON 4
 uu_5                -1.353675e-01 1 1  ON 5
 uu_6                -1.409669e-01 1 1  ON 6
 uu_7                -1.288267e-01 1 1  ON 7
 uu_8                -9.394438e-02 1 1  ON 8
 uu_9                -1.473256e-02 1 1  ON 9
 ud_0                 4.402106e-01 1 1  ON 10
 ud_1                 1.561442e-01 1 1  ON 11
 ud_2                 7.187483e-03 1 1  ON 12
 ud_3                -7.492082e-02 1 1  ON 13
 ud_4                -1.211705e-01 1 1  ON 14
 ud_5                -1.486118e-01 1 1  ON 15
 ud_6                -1.612481e-01 1 1  ON 16
 ud_7                -1.562469e-01 1 1  ON 17
 ud_8                -1.271903e-01 1 1  ON 18
 ud_9                -5.972420e-02 1 1  ON 19
 eC_0                -5.755435e-01 1 1  ON 20
 eC_1                -4.058572e-01 1 1  ON 21
 eC_2                -1.095114e-01 1 1  ON 22
 eC_3                 9.508518e-02 1 1  ON 23
 eC_4                 2.165996e-01 1 1  ON 24
 eC_5                 3.066716e-01 1 1  ON 25
 eC_6                 2.618260e-01 1 1  ON 26
 eC_7                 1.619854e-01 1 1  ON 27
 eC_8                 4.042668e-02 1 1  ON 28
 eC_9                 6.873733e-03 1 1  ON 29
 eO_0                -1.054393e+00 1 1  ON 30
 eO_1                -6.663578e-01 1 1  ON 31
 eO_2                -1.859475e-01 1 1  ON 32
 eO_3                 1.202573e-01 1 1  ON 33
 eO_4                 3.186188e-01 1 1  ON 34
 eO_5                 4.251034e-01 1 1  ON 35
 eO_6                 4.070949e-01 1 1  ON 36
 eO_7                 3.515653e-01 1 1  ON 37
 eO_8                 1.847128e-01 1 1  ON 38
 eO_9                 6.892960e-02 1 1  ON 39
eH1_0                -1.472574e-01 1 1  ON 40
eH1_1                -4.709294e-02 1 1  ON 41
eH1_2                -2.725860e-02 1 1  ON 42
eH1_3                -2.670492e-02 1 1  ON 43
eH1_4                 9.694085e-03 1 1  ON 44
eH1_5                 1.806748e-02 1 1  ON 45
eH1_6                 4.385760e-02 1 1  ON 46
eH1_7                 4.283532e-02 1 1  ON 47
eH1_8                 4.859724e-02 1 1  ON 48
eH1_9                 6.358636e-02 1 1  ON 49
eH2_0                -1.487201e-01 1 1  ON 50
eH2_1                -4.780843e-02 1 1  ON 51
eH2_2                -2.817342e-02 1 1  ON 52
eH2_3                -2.687631e-02 1 1  ON 53
eH2_4                 9.023106e-03 1 1  ON 54
eH2_5                 1.731728e-02 1 1  ON 55
eH2_6                 4.388074e-02 1 1  ON 56
eH2_7                 4.222366e-02 1 1  ON 57
eH2_8                 5.499304e-02 1 1  ON 58
eH2_9                 6.310569e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.4383
    reference variance = 0.678594
====================================================
  Execution time = 4.9362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.6252e-01
  Total weights = 2.0000e+06
  Execution time = 3.8607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562505590393
                                         uncertainty =       0.004533394650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562505590393
                                         uncertainty =       0.004533394650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530293103
  error estimate for blocks of size 2^( 2) =       0.000551215827
  error estimate for blocks of size 2^( 3) =       0.000570944907
  error estimate for blocks of size 2^( 4) =       0.000585426129
  error estimate for blocks of size 2^( 5) =       0.000594964123
  error estimate for blocks of size 2^( 6) =       0.000600400244
  error estimate for blocks of size 2^( 7) =       0.000604845060

      target function =                  N/A
              le_mean =     -22.435217562968
             les_mean =     503.901408366539
             stat err =       0.000596408889
             autocorr =       1.264900190505
              std dev =       0.749947698190
             le_variance =       0.562421550021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562933461614
                                         uncertainty =       0.004538718029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562933461614
                                         uncertainty =       0.004538718029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530494790
  error estimate for blocks of size 2^( 2) =       0.000551397292
  error estimate for blocks of size 2^( 3) =       0.000571077231
  error estimate for blocks of size 2^( 4) =       0.000585492635
  error estimate for blocks of size 2^( 5) =       0.000595001817
  error estimate for blocks of size 2^( 6) =       0.000600409964
  error estimate for blocks of size 2^( 7) =       0.000604848726

      target function =                  N/A
              le_mean =     -22.435222158515
             les_mean =     503.902042465753
             stat err =       0.000596438285
             autocorr =       1.264063174769
              std dev =       0.750232927340
             le_variance =       0.562849445266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562708293584
                                         uncertainty =       0.004535209273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562708293584
                                         uncertainty =       0.004535209273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530388623
  error estimate for blocks of size 2^( 2) =       0.000551309451
  error estimate for blocks of size 2^( 3) =       0.000571015985
  error estimate for blocks of size 2^( 4) =       0.000585455974
  error estimate for blocks of size 2^( 5) =       0.000594981268
  error estimate for blocks of size 2^( 6) =       0.000600397578
  error estimate for blocks of size 2^( 7) =       0.000604850276

      target function =                  N/A
              le_mean =     -22.435220923135
             les_mean =     503.901761772357
             stat err =       0.000596421274
             autocorr =       1.264497141460
              std dev =       0.750082784634
             le_variance =       0.562624183805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562511986764
                                         uncertainty =       0.004533666138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562511986764
                                         uncertainty =       0.004533666138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530296107
  error estimate for blocks of size 2^( 2) =       0.000551219787
  error estimate for blocks of size 2^( 3) =       0.000570946628
  error estimate for blocks of size 2^( 4) =       0.000585421975
  error estimate for blocks of size 2^( 5) =       0.000594958533
  error estimate for blocks of size 2^( 6) =       0.000600390899
  error estimate for blocks of size 2^( 7) =       0.000604838924

      target function =                  N/A
              le_mean =     -22.435217336440
             les_mean =     503.901404575000
             stat err =       0.000596402583
             autocorr =       1.264859108858
              std dev =       0.749951947072
             le_variance =       0.562427922917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435217562968        initial
     6.2500e-02     6.2500e-01             1.2235e-02       -22.435222158515  <--
     2.5000e-01     2.5000e+00             2.8351e-03       -22.435220923135
     1.0000e+00     1.0000e+01             6.9584e-04       -22.435217336440

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 6.8657e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.787962e-01 1 1  ON 0
 uu_1                 1.042307e-01 1 1  ON 1
 uu_2                -1.048187e-02 1 1  ON 2
 uu_3                -7.819518e-02 1 1  ON 3
 uu_4                -1.161922e-01 1 1  ON 4
 uu_5                -1.363740e-01 1 1  ON 5
 uu_6                -1.424126e-01 1 1  ON 6
 uu_7                -1.307997e-01 1 1  ON 7
 uu_8                -9.717130e-02 1 1  ON 8
 uu_9                -1.789175e-02 1 1  ON 9
 ud_0                 4.402489e-01 1 1  ON 10
 ud_1                 1.561463e-01 1 1  ON 11
 ud_2                 7.077146e-03 1 1  ON 12
 ud_3                -7.522677e-02 1 1  ON 13
 ud_4                -1.217161e-01 1 1  ON 14
 ud_5                -1.491712e-01 1 1  ON 15
 ud_6                -1.619649e-01 1 1  ON 16
 ud_7                -1.572804e-01 1 1  ON 17
 ud_8                -1.289793e-01 1 1  ON 18
 ud_9                -6.153568e-02 1 1  ON 19
 eC_0                -5.787987e-01 1 1  ON 20
 eC_1                -4.089945e-01 1 1  ON 21
 eC_2                -1.120055e-01 1 1  ON 22
 eC_3                 9.310315e-02 1 1  ON 23
 eC_4                 2.149395e-01 1 1  ON 24
 eC_5                 3.056382e-01 1 1  ON 25
 eC_6                 2.633382e-01 1 1  ON 26
 eC_7                 1.699089e-01 1 1  ON 27
 eC_8                 4.391758e-02 1 1  ON 28
 eC_9                 7.399926e-03 1 1  ON 29
 eO_0                -1.059442e+00 1 1  ON 30
 eO_1                -6.710460e-01 1 1  ON 31
 eO_2                -1.900517e-01 1 1  ON 32
 eO_3                 1.164235e-01 1 1  ON 33
 eO_4                 3.157226e-01 1 1  ON 34
 eO_5                 4.240800e-01 1 1  ON 35
 eO_6                 4.075633e-01 1 1  ON 36
 eO_7                 3.563585e-01 1 1  ON 37
 eO_8                 1.941124e-01 1 1  ON 38
 eO_9                 7.416423e-02 1 1  ON 39
eH1_0                -1.473360e-01 1 1  ON 40
eH1_1                -4.717223e-02 1 1  ON 41
eH1_2                -2.830918e-02 1 1  ON 42
eH1_3                -2.789296e-02 1 1  ON 43
eH1_4                 8.596765e-03 1 1  ON 44
eH1_5                 1.714671e-02 1 1  ON 45
eH1_6                 4.339903e-02 1 1  ON 46
eH1_7                 4.425432e-02 1 1  ON 47
eH1_8                 4.824975e-02 1 1  ON 48
eH1_9                 6.578718e-02 1 1  ON 49
eH2_0                -1.492905e-01 1 1  ON 50
eH2_1                -4.792879e-02 1 1  ON 51
eH2_2                -2.894828e-02 1 1  ON 52
eH2_3                -2.799266e-02 1 1  ON 53
eH2_4                 8.054592e-03 1 1  ON 54
eH2_5                 1.697313e-02 1 1  ON 55
eH2_6                 4.414506e-02 1 1  ON 56
eH2_7                 4.315253e-02 1 1  ON 57
eH2_8                 5.376728e-02 1 1  ON 58
eH2_9                 6.549992e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3001e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2421e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.4405
    reference variance = 0.563627
====================================================
  Execution time = 4.5369e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.8741e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5343e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.587403290875
                                         uncertainty =       0.020346069908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.587403290875
                                         uncertainty =       0.020346069908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000541943402
  error estimate for blocks of size 2^( 2) =       0.000561893393
  error estimate for blocks of size 2^( 3) =       0.000580312559
  error estimate for blocks of size 2^( 4) =       0.000594195736
  error estimate for blocks of size 2^( 5) =       0.000602515022
  error estimate for blocks of size 2^( 6) =       0.000607355393
  error estimate for blocks of size 2^( 7) =       0.000612029288

      target function =                  N/A
              le_mean =     -22.436741369116
             les_mean =     503.994768273438
             stat err =       0.000604023860
             autocorr =       1.242225160614
              std dev =       0.766423709534
             le_variance =       0.587405302535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243674136912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436741369116       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436742944818       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436741059178       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436749729440       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436755250870       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436755068700       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436758926661       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436785569921       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436794673578       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436801252787       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436811870027       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436825023854       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436839291529       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436844640124       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436845572103       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436848420525       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436850297022       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436851836521       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436852152095       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436852780440       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436852946365       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.436853253443       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.436852978050       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.436853192339       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.436853560290       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-02 is 6.095186e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436741369116       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436742665961       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436741152116       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436746467191       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436752032570       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436751291647       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436752821269       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436763608059       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436765223522       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436767506300       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436768418634       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436770325790       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436772280799       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436772742685       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436772616152       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436773066341       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436773205406       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436773404669       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436773394745       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 1.210145e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436741369116       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436742128441       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436741360640       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436742652827       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436746848700       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436746250328       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436746742156       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436747801816       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436749239962       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436749046728       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436749449539       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436749339226       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436749681314       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436749761682       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 2.884390e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176137 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0735e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.785138e-01 1 1  ON 0
 uu_1                 1.036557e-01 1 1  ON 1
 uu_2                -1.103716e-02 1 1  ON 2
 uu_3                -7.871580e-02 1 1  ON 3
 uu_4                -1.169463e-01 1 1  ON 4
 uu_5                -1.374267e-01 1 1  ON 5
 uu_6                -1.433708e-01 1 1  ON 6
 uu_7                -1.320977e-01 1 1  ON 7
 uu_8                -9.955243e-02 1 1  ON 8
 uu_9                -2.223712e-02 1 1  ON 9
 ud_0                 4.407366e-01 1 1  ON 10
 ud_1                 1.571625e-01 1 1  ON 11
 ud_2                 7.920585e-03 1 1  ON 12
 ud_3                -7.429788e-02 1 1  ON 13
 ud_4                -1.209148e-01 1 1  ON 14
 ud_5                -1.490607e-01 1 1  ON 15
 ud_6                -1.624711e-01 1 1  ON 16
 ud_7                -1.594502e-01 1 1  ON 17
 ud_8                -1.318391e-01 1 1  ON 18
 ud_9                -6.593541e-02 1 1  ON 19
 eC_0                -5.829750e-01 1 1  ON 20
 eC_1                -4.121144e-01 1 1  ON 21
 eC_2                -1.158533e-01 1 1  ON 22
 eC_3                 9.002095e-02 1 1  ON 23
 eC_4                 2.132169e-01 1 1  ON 24
 eC_5                 3.047240e-01 1 1  ON 25
 eC_6                 2.667725e-01 1 1  ON 26
 eC_7                 1.788271e-01 1 1  ON 27
 eC_8                 4.782724e-02 1 1  ON 28
 eC_9                 7.940802e-03 1 1  ON 29
 eO_0                -1.065276e+00 1 1  ON 30
 eO_1                -6.771145e-01 1 1  ON 31
 eO_2                -1.961329e-01 1 1  ON 32
 eO_3                 1.123715e-01 1 1  ON 33
 eO_4                 3.128885e-01 1 1  ON 34
 eO_5                 4.218902e-01 1 1  ON 35
 eO_6                 4.096967e-01 1 1  ON 36
 eO_7                 3.618115e-01 1 1  ON 37
 eO_8                 2.062139e-01 1 1  ON 38
 eO_9                 7.986002e-02 1 1  ON 39
eH1_0                -1.488608e-01 1 1  ON 40
eH1_1                -4.894516e-02 1 1  ON 41
eH1_2                -2.958874e-02 1 1  ON 42
eH1_3                -2.863179e-02 1 1  ON 43
eH1_4                 8.314164e-03 1 1  ON 44
eH1_5                 1.669824e-02 1 1  ON 45
eH1_6                 4.316827e-02 1 1  ON 46
eH1_7                 4.528006e-02 1 1  ON 47
eH1_8                 4.954951e-02 1 1  ON 48
eH1_9                 6.823068e-02 1 1  ON 49
eH2_0                -1.499434e-01 1 1  ON 50
eH2_1                -4.965545e-02 1 1  ON 51
eH2_2                -2.932951e-02 1 1  ON 52
eH2_3                -2.835687e-02 1 1  ON 53
eH2_4                 8.375703e-03 1 1  ON 54
eH2_5                 1.721221e-02 1 1  ON 55
eH2_6                 4.418136e-02 1 1  ON 56
eH2_7                 4.342641e-02 1 1  ON 57
eH2_8                 5.113114e-02 1 1  ON 58
eH2_9                 6.836629e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.3255
    reference variance = 0.372365
====================================================
  Execution time = 4.4807e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5833e-01
  Total weights = 2.0000e+06
  Execution time = 3.8607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558903635445
                                         uncertainty =       0.006527778983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558903635445
                                         uncertainty =       0.006527778983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528699341
  error estimate for blocks of size 2^( 2) =       0.000549236416
  error estimate for blocks of size 2^( 3) =       0.000568483517
  error estimate for blocks of size 2^( 4) =       0.000583251797
  error estimate for blocks of size 2^( 5) =       0.000592553267
  error estimate for blocks of size 2^( 6) =       0.000595330069
  error estimate for blocks of size 2^( 7) =       0.000599830881

      target function =                  N/A
              le_mean =     -22.436642948197
             les_mean =     503.961992491437
             stat err =       0.000592741504
             autocorr =       1.256935918825
              std dev =       0.747693778286
             le_variance =       0.559045986088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558315219144
                                         uncertainty =       0.006469184423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558315219144
                                         uncertainty =       0.006469184423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528421284
  error estimate for blocks of size 2^( 2) =       0.000548884324
  error estimate for blocks of size 2^( 3) =       0.000568032949
  error estimate for blocks of size 2^( 4) =       0.000582722262
  error estimate for blocks of size 2^( 5) =       0.000591927953
  error estimate for blocks of size 2^( 6) =       0.000594577288
  error estimate for blocks of size 2^( 7) =       0.000598979420

      target function =                  N/A
              le_mean =     -22.436656379688
             les_mean =     503.962007328327
             stat err =       0.000592051731
             autocorr =       1.255332306178
              std dev =       0.747300546890
             le_variance =       0.558458107382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557535827940
                                         uncertainty =       0.006494347865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557535827940
                                         uncertainty =       0.006494347865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528052337
  error estimate for blocks of size 2^( 2) =       0.000548571931
  error estimate for blocks of size 2^( 3) =       0.000567804943
  error estimate for blocks of size 2^( 4) =       0.000582587218
  error estimate for blocks of size 2^( 5) =       0.000591881663
  error estimate for blocks of size 2^( 6) =       0.000594601894
  error estimate for blocks of size 2^( 7) =       0.000599048262

      target function =                  N/A
              le_mean =     -22.436628188861
             les_mean =     503.959962747800
             stat err =       0.000592029759
             autocorr =       1.256993804346
              std dev =       0.746778776772
             le_variance =       0.557678541438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558401219497
                                         uncertainty =       0.006518202333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558401219497
                                         uncertainty =       0.006518202333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528461714
  error estimate for blocks of size 2^( 2) =       0.000549000249
  error estimate for blocks of size 2^( 3) =       0.000568251893
  error estimate for blocks of size 2^( 4) =       0.000583032870
  error estimate for blocks of size 2^( 5) =       0.000592340176
  error estimate for blocks of size 2^( 6) =       0.000595108704
  error estimate for blocks of size 2^( 7) =       0.000599598339

      target function =                  N/A
              le_mean =     -22.436633174340
             les_mean =     503.961051487559
             stat err =       0.000592520022
             autocorr =       1.257126560997
              std dev =       0.747357723549
             le_variance =       0.558543566948


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436642948197        initial
     1.5625e-02     1.5625e-01             6.0952e-02       -22.436656379688  <--
     6.2500e-02     6.2500e-01             1.2101e-02       -22.436628188861
     2.5000e-01     2.5000e+00             2.8844e-03       -22.436633174340

*****************************************************************************
Applying the update for shift_i =   1.5625e-02     and shift_s =   1.5625e-01
*****************************************************************************

  Execution time = 6.4130e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.772091e-01 1 1  ON 0
 uu_1                 1.021560e-01 1 1  ON 1
 uu_2                -1.275916e-02 1 1  ON 2
 uu_3                -8.082536e-02 1 1  ON 3
 uu_4                -1.197982e-01 1 1  ON 4
 uu_5                -1.412867e-01 1 1  ON 5
 uu_6                -1.483274e-01 1 1  ON 6
 uu_7                -1.391739e-01 1 1  ON 7
 uu_8                -1.098408e-01 1 1  ON 8
 uu_9                -3.852767e-02 1 1  ON 9
 ud_0                 4.433880e-01 1 1  ON 10
 ud_1                 1.600366e-01 1 1  ON 11
 ud_2                 1.045158e-02 1 1  ON 12
 ud_3                -7.219596e-02 1 1  ON 13
 ud_4                -1.196804e-01 1 1  ON 14
 ud_5                -1.493120e-01 1 1  ON 15
 ud_6                -1.646663e-01 1 1  ON 16
 ud_7                -1.650274e-01 1 1  ON 17
 ud_8                -1.414925e-01 1 1  ON 18
 ud_9                -8.095701e-02 1 1  ON 19
 eC_0                -5.982430e-01 1 1  ON 20
 eC_1                -4.262992e-01 1 1  ON 21
 eC_2                -1.297870e-01 1 1  ON 22
 eC_3                 7.826274e-02 1 1  ON 23
 eC_4                 2.053432e-01 1 1  ON 24
 eC_5                 3.020867e-01 1 1  ON 25
 eC_6                 2.769920e-01 1 1  ON 26
 eC_7                 2.138770e-01 1 1  ON 27
 eC_8                 6.537574e-02 1 1  ON 28
 eC_9                 1.054681e-02 1 1  ON 29
 eO_0                -1.089981e+00 1 1  ON 30
 eO_1                -7.013493e-01 1 1  ON 31
 eO_2                -2.185695e-01 1 1  ON 32
 eO_3                 9.426758e-02 1 1  ON 33
 eO_4                 3.003517e-01 1 1  ON 34
 eO_5                 4.158291e-01 1 1  ON 35
 eO_6                 4.156430e-01 1 1  ON 36
 eO_7                 3.823863e-01 1 1  ON 37
 eO_8                 2.550643e-01 1 1  ON 38
 eO_9                 1.050310e-01 1 1  ON 39
eH1_0                -1.537320e-01 1 1  ON 40
eH1_1                -5.383549e-02 1 1  ON 41
eH1_2                -3.385480e-02 1 1  ON 42
eH1_3                -3.186643e-02 1 1  ON 43
eH1_4                 6.186127e-03 1 1  ON 44
eH1_5                 1.545006e-02 1 1  ON 45
eH1_6                 4.309119e-02 1 1  ON 46
eH1_7                 4.751934e-02 1 1  ON 47
eH1_8                 5.163824e-02 1 1  ON 48
eH1_9                 7.771088e-02 1 1  ON 49
eH2_0                -1.530341e-01 1 1  ON 50
eH2_1                -5.347383e-02 1 1  ON 51
eH2_2                -3.197392e-02 1 1  ON 52
eH2_3                -3.030875e-02 1 1  ON 53
eH2_4                 7.623735e-03 1 1  ON 54
eH2_5                 1.735780e-02 1 1  ON 55
eH2_6                 4.475799e-02 1 1  ON 56
eH2_7                 4.510393e-02 1 1  ON 57
eH2_8                 4.105538e-02 1 1  ON 58
eH2_9                 7.932929e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2487e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2409e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4698
    reference variance = 0.397646
====================================================
  Execution time = 4.5818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5330e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5466e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553331793518
                                         uncertainty =       0.004133220600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553331793518
                                         uncertainty =       0.004133220600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525977267
  error estimate for blocks of size 2^( 2) =       0.000546581716
  error estimate for blocks of size 2^( 3) =       0.000565531518
  error estimate for blocks of size 2^( 4) =       0.000579622328
  error estimate for blocks of size 2^( 5) =       0.000589118711
  error estimate for blocks of size 2^( 6) =       0.000593117437
  error estimate for blocks of size 2^( 7) =       0.000599612386

      target function =                  N/A
              le_mean =     -22.436622526641
             les_mean =     503.955334296617
             stat err =       0.000590367716
             autocorr =       1.259827986890
              std dev =       0.743844184156
             le_variance =       0.553304170303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243662252664e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436622526641       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436626420881       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436634404187       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436634830671       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436639959335       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436640443687       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436641348541       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436647820856       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436663028848       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436680241590       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436694180000       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436692607297       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436738863364       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436760583595       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436771608726       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436775416696       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436787644844       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436797891235       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436802231682       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436803213834       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436806737990       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.436807832756       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.436809034797       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.436809528817       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.436810180608       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.436809969489       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.436812800536       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.436811829135       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.436811514657       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.436811014314       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.436810840243       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.436810216420       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.436810665869       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.436811618936       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.436812059775       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-03 is 3.732416e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436622526641       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436626245490       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436633677534       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436634013793       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436638786922       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436639282701       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436640060090       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436645836796       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436656268324       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436669509884       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436675290035       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436671048190       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436689478087       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436692928356       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436693414749       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436692271678       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436694056804       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436696073355       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436696684721       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436696330831       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436696678040       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.436696640927       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.436696706623       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.436696738642       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-02 is 3.784998e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436622526641       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436625677796       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436631495035       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436631700108       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436635639411       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436636011334       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436636403657       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436640519369       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436643851144       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436649884559       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436648728448       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436647045299       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436650830623       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436650337460       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436650318325       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436649686329       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436649834578       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436650201353       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 8.256860e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206909 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1324e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.766643e-01 1 1  ON 0
 uu_1                 1.013117e-01 1 1  ON 1
 uu_2                -1.439335e-02 1 1  ON 2
 uu_3                -8.315790e-02 1 1  ON 3
 uu_4                -1.224621e-01 1 1  ON 4
 uu_5                -1.447551e-01 1 1  ON 5
 uu_6                -1.535377e-01 1 1  ON 6
 uu_7                -1.467402e-01 1 1  ON 7
 uu_8                -1.186325e-01 1 1  ON 8
 uu_9                -5.403521e-02 1 1  ON 9
 ud_0                 4.456804e-01 1 1  ON 10
 ud_1                 1.614893e-01 1 1  ON 11
 ud_2                 1.148105e-02 1 1  ON 12
 ud_3                -7.204594e-02 1 1  ON 13
 ud_4                -1.202613e-01 1 1  ON 14
 ud_5                -1.510205e-01 1 1  ON 15
 ud_6                -1.680861e-01 1 1  ON 16
 ud_7                -1.684523e-01 1 1  ON 17
 ud_8                -1.474826e-01 1 1  ON 18
 ud_9                -8.842203e-02 1 1  ON 19
 eC_0                -6.099577e-01 1 1  ON 20
 eC_1                -4.399932e-01 1 1  ON 21
 eC_2                -1.406765e-01 1 1  ON 22
 eC_3                 7.006224e-02 1 1  ON 23
 eC_4                 1.987018e-01 1 1  ON 24
 eC_5                 2.980066e-01 1 1  ON 25
 eC_6                 2.857345e-01 1 1  ON 26
 eC_7                 2.420203e-01 1 1  ON 27
 eC_8                 8.173089e-02 1 1  ON 28
 eC_9                 1.250183e-02 1 1  ON 29
 eO_0                -1.111536e+00 1 1  ON 30
 eO_1                -7.209296e-01 1 1  ON 31
 eO_2                -2.359438e-01 1 1  ON 32
 eO_3                 7.796521e-02 1 1  ON 33
 eO_4                 2.892475e-01 1 1  ON 34
 eO_5                 4.122549e-01 1 1  ON 35
 eO_6                 4.185981e-01 1 1  ON 36
 eO_7                 3.934261e-01 1 1  ON 37
 eO_8                 2.929142e-01 1 1  ON 38
 eO_9                 1.330453e-01 1 1  ON 39
eH1_0                -1.577547e-01 1 1  ON 40
eH1_1                -5.571413e-02 1 1  ON 41
eH1_2                -3.450035e-02 1 1  ON 42
eH1_3                -3.378990e-02 1 1  ON 43
eH1_4                 4.537159e-03 1 1  ON 44
eH1_5                 1.548281e-02 1 1  ON 45
eH1_6                 4.650052e-02 1 1  ON 46
eH1_7                 4.909134e-02 1 1  ON 47
eH1_8                 4.508246e-02 1 1  ON 48
eH1_9                 8.424616e-02 1 1  ON 49
eH2_0                -1.560117e-01 1 1  ON 50
eH2_1                -5.450572e-02 1 1  ON 51
eH2_2                -3.576941e-02 1 1  ON 52
eH2_3                -3.312656e-02 1 1  ON 53
eH2_4                 4.785305e-03 1 1  ON 54
eH2_5                 1.555152e-02 1 1  ON 55
eH2_6                 4.526561e-02 1 1  ON 56
eH2_7                 4.678234e-02 1 1  ON 57
eH2_8                 4.004453e-02 1 1  ON 58
eH2_9                 8.634718e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4695
    reference variance = 0.595792
====================================================
  Execution time = 4.4793e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6400e-01
  Total weights = 2.0000e+06
  Execution time = 3.8568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561064178645
                                         uncertainty =       0.008244522767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561064178645
                                         uncertainty =       0.008244522767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529655770
  error estimate for blocks of size 2^( 2) =       0.000550196409
  error estimate for blocks of size 2^( 3) =       0.000569633826
  error estimate for blocks of size 2^( 4) =       0.000584844159
  error estimate for blocks of size 2^( 5) =       0.000595287297
  error estimate for blocks of size 2^( 6) =       0.000598619965
  error estimate for blocks of size 2^( 7) =       0.000602987384

      target function =                  N/A
              le_mean =     -22.436506105905
             les_mean =     503.957876430089
             stat err =       0.000595434701
             autocorr =       1.263807319255
              std dev =       0.749046373954
             le_variance =       0.561070470333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580251230130
                                         uncertainty =       0.008534731323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580251230130
                                         uncertainty =       0.008534731323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538633482
  error estimate for blocks of size 2^( 2) =       0.000559085711
  error estimate for blocks of size 2^( 3) =       0.000578059228
  error estimate for blocks of size 2^( 4) =       0.000592842543
  error estimate for blocks of size 2^( 5) =       0.000602732342
  error estimate for blocks of size 2^( 6) =       0.000605865869
  error estimate for blocks of size 2^( 7) =       0.000610214179

      target function =                  N/A
              le_mean =     -22.437666362512
             les_mean =     504.029123560733
             stat err =       0.000602913733
             autocorr =       1.252920920088
              std dev =       0.761742775124
             le_variance =       0.580252055454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567202804263
                                         uncertainty =       0.008354587512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567202804263
                                         uncertainty =       0.008354587512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532545006
  error estimate for blocks of size 2^( 2) =       0.000552943940
  error estimate for blocks of size 2^( 3) =       0.000572139799
  error estimate for blocks of size 2^( 4) =       0.000587134261
  error estimate for blocks of size 2^( 5) =       0.000597391947
  error estimate for blocks of size 2^( 6) =       0.000600595964
  error estimate for blocks of size 2^( 7) =       0.000604994028

      target function =                  N/A
              le_mean =     -22.436506021499
             les_mean =     503.964010535633
             stat err =       0.000597529050
             autocorr =       1.258941111358
              std dev =       0.753132369830
             le_variance =       0.567208366486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562604891712
                                         uncertainty =       0.008273725685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562604891712
                                         uncertainty =       0.008273725685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530382495
  error estimate for blocks of size 2^( 2) =       0.000550882684
  error estimate for blocks of size 2^( 3) =       0.000570263601
  error estimate for blocks of size 2^( 4) =       0.000585423047
  error estimate for blocks of size 2^( 5) =       0.000595833414
  error estimate for blocks of size 2^( 6) =       0.000599128368
  error estimate for blocks of size 2^( 7) =       0.000603508809

      target function =                  N/A
              le_mean =     -22.436487370023
             les_mean =     503.958576406698
             stat err =       0.000595973410
             autocorr =       1.262627959602
              std dev =       0.750074118212
             le_variance =       0.562611182812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436506105905        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     1.5625e-02     1.5625e-01             3.7850e-02       -22.436506021499
     6.2500e-02     6.2500e-01             8.2569e-03       -22.436487370023

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.4036
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.772091e-01 1 1  ON 0
 uu_1                 1.021560e-01 1 1  ON 1
 uu_2                -1.275916e-02 1 1  ON 2
 uu_3                -8.082536e-02 1 1  ON 3
 uu_4                -1.197982e-01 1 1  ON 4
 uu_5                -1.412867e-01 1 1  ON 5
 uu_6                -1.483274e-01 1 1  ON 6
 uu_7                -1.391739e-01 1 1  ON 7
 uu_8                -1.098408e-01 1 1  ON 8
 uu_9                -3.852767e-02 1 1  ON 9
 ud_0                 4.433880e-01 1 1  ON 10
 ud_1                 1.600366e-01 1 1  ON 11
 ud_2                 1.045158e-02 1 1  ON 12
 ud_3                -7.219596e-02 1 1  ON 13
 ud_4                -1.196804e-01 1 1  ON 14
 ud_5                -1.493120e-01 1 1  ON 15
 ud_6                -1.646663e-01 1 1  ON 16
 ud_7                -1.650274e-01 1 1  ON 17
 ud_8                -1.414925e-01 1 1  ON 18
 ud_9                -8.095701e-02 1 1  ON 19
 eC_0                -5.982430e-01 1 1  ON 20
 eC_1                -4.262992e-01 1 1  ON 21
 eC_2                -1.297870e-01 1 1  ON 22
 eC_3                 7.826274e-02 1 1  ON 23
 eC_4                 2.053432e-01 1 1  ON 24
 eC_5                 3.020867e-01 1 1  ON 25
 eC_6                 2.769920e-01 1 1  ON 26
 eC_7                 2.138770e-01 1 1  ON 27
 eC_8                 6.537574e-02 1 1  ON 28
 eC_9                 1.054681e-02 1 1  ON 29
 eO_0                -1.089981e+00 1 1  ON 30
 eO_1                -7.013493e-01 1 1  ON 31
 eO_2                -2.185695e-01 1 1  ON 32
 eO_3                 9.426758e-02 1 1  ON 33
 eO_4                 3.003517e-01 1 1  ON 34
 eO_5                 4.158291e-01 1 1  ON 35
 eO_6                 4.156430e-01 1 1  ON 36
 eO_7                 3.823863e-01 1 1  ON 37
 eO_8                 2.550643e-01 1 1  ON 38
 eO_9                 1.050310e-01 1 1  ON 39
eH1_0                -1.537320e-01 1 1  ON 40
eH1_1                -5.383549e-02 1 1  ON 41
eH1_2                -3.385480e-02 1 1  ON 42
eH1_3                -3.186643e-02 1 1  ON 43
eH1_4                 6.186127e-03 1 1  ON 44
eH1_5                 1.545006e-02 1 1  ON 45
eH1_6                 4.309119e-02 1 1  ON 46
eH1_7                 4.751934e-02 1 1  ON 47
eH1_8                 5.163824e-02 1 1  ON 48
eH1_9                 7.771088e-02 1 1  ON 49
eH2_0                -1.530341e-01 1 1  ON 50
eH2_1                -5.347383e-02 1 1  ON 51
eH2_2                -3.197392e-02 1 1  ON 52
eH2_3                -3.030875e-02 1 1  ON 53
eH2_4                 7.623735e-03 1 1  ON 54
eH2_5                 1.735780e-02 1 1  ON 55
eH2_6                 4.475799e-02 1 1  ON 56
eH2_7                 4.510393e-02 1 1  ON 57
eH2_8                 4.105538e-02 1 1  ON 58
eH2_9                 7.932929e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2673e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2424e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.5092
    reference variance = 0.321742
====================================================
  Execution time = 4.7738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6414e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5509e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564308227087
                                         uncertainty =       0.005440641992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564308227087
                                         uncertainty =       0.005440641992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531101724
  error estimate for blocks of size 2^( 2) =       0.000551445123
  error estimate for blocks of size 2^( 3) =       0.000570433593
  error estimate for blocks of size 2^( 4) =       0.000584475121
  error estimate for blocks of size 2^( 5) =       0.000593825773
  error estimate for blocks of size 2^( 6) =       0.000597271635
  error estimate for blocks of size 2^( 7) =       0.000600768250

      target function =                  N/A
              le_mean =     -22.437161868558
             les_mean =     503.990370516038
             stat err =       0.000594085195
             autocorr =       1.251244083220
              std dev =       0.751091260936
             le_variance =       0.564138082254


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243716186856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437161868558       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437169577659       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437170108806       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437173187038       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437171196079       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437176252084       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437171316603       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437176375942       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437179322583       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437180319441       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437187637439       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437188527266       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437190375607       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437192435210       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437195277638       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437195162687       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437196078368       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437195595207       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437195067994       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.437195391550       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 1.523311e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437161868558       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437167077551       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437167052116       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437169841189       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437168579043       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437170836777       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437168552228       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437171159182       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437171876270       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437172722222       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437172863575       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437173464755       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437173580937       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437173883642       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437174078796       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 3.601519e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437161868558       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437164136072       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437164132202       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437165629110       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437165140194       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437165848528       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437165961356       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437166290793       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437166220200       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437166551500       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437166375910       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437166474918       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437166466832       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 8.884040e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3264e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.777483e-01 1 1  ON 0
 uu_1                 1.027687e-01 1 1  ON 1
 uu_2                -1.235634e-02 1 1  ON 2
 uu_3                -8.089810e-02 1 1  ON 3
 uu_4                -1.199435e-01 1 1  ON 4
 uu_5                -1.413918e-01 1 1  ON 5
 uu_6                -1.488489e-01 1 1  ON 6
 uu_7                -1.399952e-01 1 1  ON 7
 uu_8                -1.111567e-01 1 1  ON 8
 uu_9                -4.051526e-02 1 1  ON 9
 ud_0                 4.437747e-01 1 1  ON 10
 ud_1                 1.597277e-01 1 1  ON 11
 ud_2                 1.032245e-02 1 1  ON 12
 ud_3                -7.243463e-02 1 1  ON 13
 ud_4                -1.198625e-01 1 1  ON 14
 ud_5                -1.493190e-01 1 1  ON 15
 ud_6                -1.650927e-01 1 1  ON 16
 ud_7                -1.648404e-01 1 1  ON 17
 ud_8                -1.413288e-01 1 1  ON 18
 ud_9                -8.158162e-02 1 1  ON 19
 eC_0                -5.988997e-01 1 1  ON 20
 eC_1                -4.278279e-01 1 1  ON 21
 eC_2                -1.309695e-01 1 1  ON 22
 eC_3                 7.711550e-02 1 1  ON 23
 eC_4                 2.045834e-01 1 1  ON 24
 eC_5                 3.022095e-01 1 1  ON 25
 eC_6                 2.783771e-01 1 1  ON 26
 eC_7                 2.162280e-01 1 1  ON 27
 eC_8                 6.658443e-02 1 1  ON 28
 eC_9                 1.075767e-02 1 1  ON 29
 eO_0                -1.091988e+00 1 1  ON 30
 eO_1                -7.026848e-01 1 1  ON 31
 eO_2                -2.196004e-01 1 1  ON 32
 eO_3                 9.232082e-02 1 1  ON 33
 eO_4                 2.993258e-01 1 1  ON 34
 eO_5                 4.159981e-01 1 1  ON 35
 eO_6                 4.154094e-01 1 1  ON 36
 eO_7                 3.836883e-01 1 1  ON 37
 eO_8                 2.586658e-01 1 1  ON 38
 eO_9                 1.070393e-01 1 1  ON 39
eH1_0                -1.543183e-01 1 1  ON 40
eH1_1                -5.416536e-02 1 1  ON 41
eH1_2                -3.437818e-02 1 1  ON 42
eH1_3                -3.194947e-02 1 1  ON 43
eH1_4                 6.066908e-03 1 1  ON 44
eH1_5                 1.571871e-02 1 1  ON 45
eH1_6                 4.386403e-02 1 1  ON 46
eH1_7                 4.718534e-02 1 1  ON 47
eH1_8                 5.147919e-02 1 1  ON 48
eH1_9                 7.826932e-02 1 1  ON 49
eH2_0                -1.534388e-01 1 1  ON 50
eH2_1                -5.328861e-02 1 1  ON 51
eH2_2                -3.259349e-02 1 1  ON 52
eH2_3                -3.085555e-02 1 1  ON 53
eH2_4                 7.232486e-03 1 1  ON 54
eH2_5                 1.700119e-02 1 1  ON 55
eH2_6                 4.462579e-02 1 1  ON 56
eH2_7                 4.585814e-02 1 1  ON 57
eH2_8                 4.126372e-02 1 1  ON 58
eH2_9                 8.000631e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.4533
    reference variance = 0.53413
====================================================
  Execution time = 4.4521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6039e-01
  Total weights = 2.0000e+06
  Execution time = 3.8603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559260759117
                                         uncertainty =       0.007226598997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559260759117
                                         uncertainty =       0.007226598997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528782268
  error estimate for blocks of size 2^( 2) =       0.000549583845
  error estimate for blocks of size 2^( 3) =       0.000568229304
  error estimate for blocks of size 2^( 4) =       0.000583183954
  error estimate for blocks of size 2^( 5) =       0.000593370205
  error estimate for blocks of size 2^( 6) =       0.000599655210
  error estimate for blocks of size 2^( 7) =       0.000602131796

      target function =                  N/A
              le_mean =     -22.436555638224
             les_mean =     503.958250001874
             stat err =       0.000594585291
             autocorr =       1.264371087498
              std dev =       0.747811055267
             le_variance =       0.559221374379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561243487905
                                         uncertainty =       0.007287599647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561243487905
                                         uncertainty =       0.007287599647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529719193
  error estimate for blocks of size 2^( 2) =       0.000550476909
  error estimate for blocks of size 2^( 3) =       0.000569049862
  error estimate for blocks of size 2^( 4) =       0.000583917260
  error estimate for blocks of size 2^( 5) =       0.000594068722
  error estimate for blocks of size 2^( 6) =       0.000600312506
  error estimate for blocks of size 2^( 7) =       0.000602737287

      target function =                  N/A
              le_mean =     -22.436548849747
             les_mean =     503.959928854309
             stat err =       0.000595258944
             autocorr =       1.262758907329
              std dev =       0.749136067636
             le_variance =       0.561204847833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561640559953
                                         uncertainty =       0.007285116401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561640559953
                                         uncertainty =       0.007285116401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529906679
  error estimate for blocks of size 2^( 2) =       0.000550664885
  error estimate for blocks of size 2^( 3) =       0.000569239168
  error estimate for blocks of size 2^( 4) =       0.000584111739
  error estimate for blocks of size 2^( 5) =       0.000594276640
  error estimate for blocks of size 2^( 6) =       0.000600527450
  error estimate for blocks of size 2^( 7) =       0.000602959918

      target function =                  N/A
              le_mean =     -22.436546231551
             les_mean =     503.960208696583
             stat err =       0.000595468937
             autocorr =       1.262755983885
              std dev =       0.749401212209
             le_variance =       0.561602176860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559806368141
                                         uncertainty =       0.007239073539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559806368141
                                         uncertainty =       0.007239073539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529040286
  error estimate for blocks of size 2^( 2) =       0.000549831535
  error estimate for blocks of size 2^( 3) =       0.000568461021
  error estimate for blocks of size 2^( 4) =       0.000583397455
  error estimate for blocks of size 2^( 5) =       0.000593581292
  error estimate for blocks of size 2^( 6) =       0.000599860404
  error estimate for blocks of size 2^( 7) =       0.000602328330

      target function =                  N/A
              le_mean =     -22.436550317191
             les_mean =     503.958557103858
             stat err =       0.000594791870
             autocorr =       1.264015964780
              std dev =       0.748175947153
             le_variance =       0.559767247898


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436555638224        initial  <--
     3.9062e-02     3.9062e-01             1.5233e-02       -22.436548849747
     1.5625e-01     1.5625e+00             3.6015e-03       -22.436546231551
     6.2500e-01     6.2500e+00             8.8840e-04       -22.436550317191

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8408
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.772091e-01 1 1  ON 0
 uu_1                 1.021560e-01 1 1  ON 1
 uu_2                -1.275916e-02 1 1  ON 2
 uu_3                -8.082536e-02 1 1  ON 3
 uu_4                -1.197982e-01 1 1  ON 4
 uu_5                -1.412867e-01 1 1  ON 5
 uu_6                -1.483274e-01 1 1  ON 6
 uu_7                -1.391739e-01 1 1  ON 7
 uu_8                -1.098408e-01 1 1  ON 8
 uu_9                -3.852767e-02 1 1  ON 9
 ud_0                 4.433880e-01 1 1  ON 10
 ud_1                 1.600366e-01 1 1  ON 11
 ud_2                 1.045158e-02 1 1  ON 12
 ud_3                -7.219596e-02 1 1  ON 13
 ud_4                -1.196804e-01 1 1  ON 14
 ud_5                -1.493120e-01 1 1  ON 15
 ud_6                -1.646663e-01 1 1  ON 16
 ud_7                -1.650274e-01 1 1  ON 17
 ud_8                -1.414925e-01 1 1  ON 18
 ud_9                -8.095701e-02 1 1  ON 19
 eC_0                -5.982430e-01 1 1  ON 20
 eC_1                -4.262992e-01 1 1  ON 21
 eC_2                -1.297870e-01 1 1  ON 22
 eC_3                 7.826274e-02 1 1  ON 23
 eC_4                 2.053432e-01 1 1  ON 24
 eC_5                 3.020867e-01 1 1  ON 25
 eC_6                 2.769920e-01 1 1  ON 26
 eC_7                 2.138770e-01 1 1  ON 27
 eC_8                 6.537574e-02 1 1  ON 28
 eC_9                 1.054681e-02 1 1  ON 29
 eO_0                -1.089981e+00 1 1  ON 30
 eO_1                -7.013493e-01 1 1  ON 31
 eO_2                -2.185695e-01 1 1  ON 32
 eO_3                 9.426758e-02 1 1  ON 33
 eO_4                 3.003517e-01 1 1  ON 34
 eO_5                 4.158291e-01 1 1  ON 35
 eO_6                 4.156430e-01 1 1  ON 36
 eO_7                 3.823863e-01 1 1  ON 37
 eO_8                 2.550643e-01 1 1  ON 38
 eO_9                 1.050310e-01 1 1  ON 39
eH1_0                -1.537320e-01 1 1  ON 40
eH1_1                -5.383549e-02 1 1  ON 41
eH1_2                -3.385480e-02 1 1  ON 42
eH1_3                -3.186643e-02 1 1  ON 43
eH1_4                 6.186127e-03 1 1  ON 44
eH1_5                 1.545006e-02 1 1  ON 45
eH1_6                 4.309119e-02 1 1  ON 46
eH1_7                 4.751934e-02 1 1  ON 47
eH1_8                 5.163824e-02 1 1  ON 48
eH1_9                 7.771088e-02 1 1  ON 49
eH2_0                -1.530341e-01 1 1  ON 50
eH2_1                -5.347383e-02 1 1  ON 51
eH2_2                -3.197392e-02 1 1  ON 52
eH2_3                -3.030875e-02 1 1  ON 53
eH2_4                 7.623735e-03 1 1  ON 54
eH2_5                 1.735780e-02 1 1  ON 55
eH2_6                 4.475799e-02 1 1  ON 56
eH2_7                 4.510393e-02 1 1  ON 57
eH2_8                 4.105538e-02 1 1  ON 58
eH2_9                 7.932929e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2711e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2435e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4883
    reference variance = 0.283917
====================================================
  Execution time = 4.5759e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.6291e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5324e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562853788209
                                         uncertainty =       0.004363724488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562853788209
                                         uncertainty =       0.004363724488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530522998
  error estimate for blocks of size 2^( 2) =       0.000550850251
  error estimate for blocks of size 2^( 3) =       0.000569744248
  error estimate for blocks of size 2^( 4) =       0.000584763278
  error estimate for blocks of size 2^( 5) =       0.000594950199
  error estimate for blocks of size 2^( 6) =       0.000601821401
  error estimate for blocks of size 2^( 7) =       0.000605439059

      target function =                  N/A
              le_mean =     -22.435389782081
             les_mean =     503.909623694633
             stat err =       0.000596743484
             autocorr =       1.265222600623
              std dev =       0.750272818512
             le_variance =       0.562909302198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243538978208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435389782081       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435394003822       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435398037889       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435400318746       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435401102679       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435400200295       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435401194007       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435401244151       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435401551666       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435401436879       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435401330197       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.435401363735       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.435401303235       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 1.401785e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435389782081       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435391250981       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435392740286       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435393625902       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435394183301       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435393980214       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435394018078       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435394022781       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435394294477       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435394266158       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435394140754       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.435394110553       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 3.468348e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435389782081       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435390189175       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435390618985       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435390892727       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435391069727       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435391039106       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435391026348       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435391026459       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435391100767       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435391105600       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435391071324       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 8.635884e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221548 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1097e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.771665e-01 1 1  ON 0
 uu_1                 1.022630e-01 1 1  ON 1
 uu_2                -1.271004e-02 1 1  ON 2
 uu_3                -8.090698e-02 1 1  ON 3
 uu_4                -1.198771e-01 1 1  ON 4
 uu_5                -1.412916e-01 1 1  ON 5
 uu_6                -1.484228e-01 1 1  ON 6
 uu_7                -1.393664e-01 1 1  ON 7
 uu_8                -1.098574e-01 1 1  ON 8
 uu_9                -3.859243e-02 1 1  ON 9
 ud_0                 4.435412e-01 1 1  ON 10
 ud_1                 1.599418e-01 1 1  ON 11
 ud_2                 1.043814e-02 1 1  ON 12
 ud_3                -7.226425e-02 1 1  ON 13
 ud_4                -1.197471e-01 1 1  ON 14
 ud_5                -1.493014e-01 1 1  ON 15
 ud_6                -1.647373e-01 1 1  ON 16
 ud_7                -1.649411e-01 1 1  ON 17
 ud_8                -1.415300e-01 1 1  ON 18
 ud_9                -8.103253e-02 1 1  ON 19
 eC_0                -5.982310e-01 1 1  ON 20
 eC_1                -4.265562e-01 1 1  ON 21
 eC_2                -1.298488e-01 1 1  ON 22
 eC_3                 7.817436e-02 1 1  ON 23
 eC_4                 2.052501e-01 1 1  ON 24
 eC_5                 3.020880e-01 1 1  ON 25
 eC_6                 2.770511e-01 1 1  ON 26
 eC_7                 2.141237e-01 1 1  ON 27
 eC_8                 6.552741e-02 1 1  ON 28
 eC_9                 1.057185e-02 1 1  ON 29
 eO_0                -1.090314e+00 1 1  ON 30
 eO_1                -7.015418e-01 1 1  ON 31
 eO_2                -2.186138e-01 1 1  ON 32
 eO_3                 9.418134e-02 1 1  ON 33
 eO_4                 3.003116e-01 1 1  ON 34
 eO_5                 4.158081e-01 1 1  ON 35
 eO_6                 4.155766e-01 1 1  ON 36
 eO_7                 3.825394e-01 1 1  ON 37
 eO_8                 2.554111e-01 1 1  ON 38
 eO_9                 1.052390e-01 1 1  ON 39
eH1_0                -1.538241e-01 1 1  ON 40
eH1_1                -5.384573e-02 1 1  ON 41
eH1_2                -3.385866e-02 1 1  ON 42
eH1_3                -3.187923e-02 1 1  ON 43
eH1_4                 6.118061e-03 1 1  ON 44
eH1_5                 1.550240e-02 1 1  ON 45
eH1_6                 4.318644e-02 1 1  ON 46
eH1_7                 4.744931e-02 1 1  ON 47
eH1_8                 5.158931e-02 1 1  ON 48
eH1_9                 7.779047e-02 1 1  ON 49
eH2_0                -1.530510e-01 1 1  ON 50
eH2_1                -5.342292e-02 1 1  ON 51
eH2_2                -3.204926e-02 1 1  ON 52
eH2_3                -3.029600e-02 1 1  ON 53
eH2_4                 7.549267e-03 1 1  ON 54
eH2_5                 1.733536e-02 1 1  ON 55
eH2_6                 4.467343e-02 1 1  ON 56
eH2_7                 4.517104e-02 1 1  ON 57
eH2_8                 4.108099e-02 1 1  ON 58
eH2_9                 7.939277e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.3555
    reference variance = 0.784072
====================================================
  Execution time = 4.5225e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 6.3787e-01
  Total weights = 2.0000e+06
  Execution time = 3.8442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.637776177676
                                         uncertainty =       0.079663399465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.637776177676
                                         uncertainty =       0.079663399465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000564571587
  error estimate for blocks of size 2^( 2) =       0.000583131947
  error estimate for blocks of size 2^( 3) =       0.000600272341
  error estimate for blocks of size 2^( 4) =       0.000615091215
  error estimate for blocks of size 2^( 5) =       0.000623904362
  error estimate for blocks of size 2^( 6) =       0.000629089398
  error estimate for blocks of size 2^( 7) =       0.000632168497

      target function =                  N/A
              le_mean =     -22.436186567769
             les_mean =     504.019949538688
             stat err =       0.000625063368
             autocorr =       1.225773024724
              std dev =       0.798424795266
             le_variance =       0.637482153696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.638827267983
                                         uncertainty =       0.079903184840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.638827267983
                                         uncertainty =       0.079903184840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000565036514
  error estimate for blocks of size 2^( 2) =       0.000583577767
  error estimate for blocks of size 2^( 3) =       0.000600695844
  error estimate for blocks of size 2^( 4) =       0.000615494659
  error estimate for blocks of size 2^( 5) =       0.000624291327
  error estimate for blocks of size 2^( 6) =       0.000629457716
  error estimate for blocks of size 2^( 7) =       0.000632525599

      target function =                  N/A
              le_mean =     -22.436189361326
             les_mean =     504.021125263182
             stat err =       0.000625442325
             autocorr =       1.225240960336
              std dev =       0.799082301864
             le_variance =       0.638532525153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.638549589688
                                         uncertainty =       0.079855223439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.638549589688
                                         uncertainty =       0.079855223439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000564913716
  error estimate for blocks of size 2^( 2) =       0.000583460134
  error estimate for blocks of size 2^( 3) =       0.000600586216
  error estimate for blocks of size 2^( 4) =       0.000615391513
  error estimate for blocks of size 2^( 5) =       0.000624194879
  error estimate for blocks of size 2^( 6) =       0.000629369075
  error estimate for blocks of size 2^( 7) =       0.000632440500

      target function =                  N/A
              le_mean =     -22.436188608619
             les_mean =     504.020813975734
             stat err =       0.000625348992
             autocorr =       1.225407880478
              std dev =       0.798908638907
             le_variance =       0.638255013320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.637890017680
                                         uncertainty =       0.079693043940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.637890017680
                                         uncertainty =       0.079693043940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000564621957
  error estimate for blocks of size 2^( 2) =       0.000583180248
  error estimate for blocks of size 2^( 3) =       0.000600318678
  error estimate for blocks of size 2^( 4) =       0.000615135627
  error estimate for blocks of size 2^( 5) =       0.000623947494
  error estimate for blocks of size 2^( 6) =       0.000629131130
  error estimate for blocks of size 2^( 7) =       0.000632209115

      target function =                  N/A
              le_mean =     -22.436186761629
             les_mean =     504.020071992309
             stat err =       0.000625105842
             autocorr =       1.225720893654
              std dev =       0.798496029041
             le_variance =       0.637595908395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436186567769        initial
     3.9062e-01     3.9062e+00             1.4018e-03       -22.436189361326  <--
     1.5625e+00     1.5625e+01             3.4683e-04       -22.436188608619
     6.2500e+00     6.2500e+01             8.6359e-05       -22.436186761629

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 6.4476e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.771878e-01 1 1  ON 0
 uu_1                 1.024366e-01 1 1  ON 1
 uu_2                -1.267276e-02 1 1  ON 2
 uu_3                -8.107808e-02 1 1  ON 3
 uu_4                -1.200796e-01 1 1  ON 4
 uu_5                -1.414099e-01 1 1  ON 5
 uu_6                -1.486677e-01 1 1  ON 6
 uu_7                -1.398306e-01 1 1  ON 7
 uu_8                -1.099792e-01 1 1  ON 8
 uu_9                -3.879399e-02 1 1  ON 9
 ud_0                 4.437275e-01 1 1  ON 10
 ud_1                 1.598304e-01 1 1  ON 11
 ud_2                 1.037878e-02 1 1  ON 12
 ud_3                -7.239158e-02 1 1  ON 13
 ud_4                -1.198737e-01 1 1  ON 14
 ud_5                -1.493296e-01 1 1  ON 15
 ud_6                -1.648414e-01 1 1  ON 16
 ud_7                -1.648045e-01 1 1  ON 17
 ud_8                -1.416268e-01 1 1  ON 18
 ud_9                -8.124678e-02 1 1  ON 19
 eC_0                -5.983412e-01 1 1  ON 20
 eC_1                -4.271742e-01 1 1  ON 21
 eC_2                -1.300809e-01 1 1  ON 22
 eC_3                 7.791908e-02 1 1  ON 23
 eC_4                 2.050034e-01 1 1  ON 24
 eC_5                 3.020744e-01 1 1  ON 25
 eC_6                 2.772209e-01 1 1  ON 26
 eC_7                 2.148745e-01 1 1  ON 27
 eC_8                 6.599181e-02 1 1  ON 28
 eC_9                 1.064904e-02 1 1  ON 29
 eO_0                -1.091179e+00 1 1  ON 30
 eO_1                -7.021136e-01 1 1  ON 31
 eO_2                -2.188523e-01 1 1  ON 32
 eO_3                 9.385492e-02 1 1  ON 33
 eO_4                 3.001403e-01 1 1  ON 34
 eO_5                 4.157514e-01 1 1  ON 35
 eO_6                 4.154262e-01 1 1  ON 36
 eO_7                 3.829941e-01 1 1  ON 37
 eO_8                 2.564661e-01 1 1  ON 38
 eO_9                 1.058758e-01 1 1  ON 39
eH1_0                -1.540850e-01 1 1  ON 40
eH1_1                -5.388202e-02 1 1  ON 41
eH1_2                -3.390120e-02 1 1  ON 42
eH1_3                -3.192480e-02 1 1  ON 43
eH1_4                 6.006415e-03 1 1  ON 44
eH1_5                 1.561959e-02 1 1  ON 45
eH1_6                 4.343210e-02 1 1  ON 46
eH1_7                 4.725457e-02 1 1  ON 47
eH1_8                 5.143631e-02 1 1  ON 48
eH1_9                 7.803137e-02 1 1  ON 49
eH2_0                -1.531120e-01 1 1  ON 50
eH2_1                -5.333076e-02 1 1  ON 51
eH2_2                -3.223181e-02 1 1  ON 52
eH2_3                -3.031717e-02 1 1  ON 53
eH2_4                 7.384449e-03 1 1  ON 54
eH2_5                 1.727318e-02 1 1  ON 55
eH2_6                 4.447098e-02 1 1  ON 56
eH2_7                 4.534075e-02 1 1  ON 57
eH2_8                 4.115373e-02 1 1  ON 58
eH2_9                 7.958730e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2559e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2433e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.4772
    reference variance = 0.668034
====================================================
  Execution time = 4.7212e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7036e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5116e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570394172616
                                         uncertainty =       0.007041971266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570394172616
                                         uncertainty =       0.007041971266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534021993
  error estimate for blocks of size 2^( 2) =       0.000553922273
  error estimate for blocks of size 2^( 3) =       0.000572753808
  error estimate for blocks of size 2^( 4) =       0.000587193207
  error estimate for blocks of size 2^( 5) =       0.000595456950
  error estimate for blocks of size 2^( 6) =       0.000600896008
  error estimate for blocks of size 2^( 7) =       0.000604586667

      target function =                  N/A
              le_mean =     -22.436454956073
             les_mean =     503.964869687902
             stat err =       0.000597033208
             autocorr =       1.249909848271
              std dev =       0.755221144552
             le_variance =       0.570358977178


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243645495607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436454956073       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436456166374       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436456754695       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436456498312       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436459759198       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436465082424       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436464496039       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436463152486       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436464135285       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436467616204       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436467529034       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436467260761       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436467682529       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436467842696       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436467862974       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436467696687       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 5.703238e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436454956073       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436455609053       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436455695246       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436455799775       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436456843300       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436458607699       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436457904088       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436457719389       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436457896962       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436458431778       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436458446443       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436458382044       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 1.406735e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436454956073       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436455185840       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436455181415       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436455415283       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436455451291       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436456085153       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436455772505       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436455688545       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436455787848       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436455833064       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436455847730       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 3.508337e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2342e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.773303e-01 1 1  ON 0
 uu_1                 1.024906e-01 1 1  ON 1
 uu_2                -1.269326e-02 1 1  ON 2
 uu_3                -8.120246e-02 1 1  ON 3
 uu_4                -1.200524e-01 1 1  ON 4
 uu_5                -1.414014e-01 1 1  ON 5
 uu_6                -1.488984e-01 1 1  ON 6
 uu_7                -1.400821e-01 1 1  ON 7
 uu_8                -1.103071e-01 1 1  ON 8
 uu_9                -3.938283e-02 1 1  ON 9
 ud_0                 4.438494e-01 1 1  ON 10
 ud_1                 1.600413e-01 1 1  ON 11
 ud_2                 1.041998e-02 1 1  ON 12
 ud_3                -7.244261e-02 1 1  ON 13
 ud_4                -1.198346e-01 1 1  ON 14
 ud_5                -1.493114e-01 1 1  ON 15
 ud_6                -1.649111e-01 1 1  ON 16
 ud_7                -1.648661e-01 1 1  ON 17
 ud_8                -1.417810e-01 1 1  ON 18
 ud_9                -8.170865e-02 1 1  ON 19
 eC_0                -5.985647e-01 1 1  ON 20
 eC_1                -4.277275e-01 1 1  ON 21
 eC_2                -1.303321e-01 1 1  ON 22
 eC_3                 7.756545e-02 1 1  ON 23
 eC_4                 2.047155e-01 1 1  ON 24
 eC_5                 3.020900e-01 1 1  ON 25
 eC_6                 2.775772e-01 1 1  ON 26
 eC_7                 2.156928e-01 1 1  ON 27
 eC_8                 6.643002e-02 1 1  ON 28
 eC_9                 1.071289e-02 1 1  ON 29
 eO_0                -1.092108e+00 1 1  ON 30
 eO_1                -7.025982e-01 1 1  ON 31
 eO_2                -2.191696e-01 1 1  ON 32
 eO_3                 9.338311e-02 1 1  ON 33
 eO_4                 2.995654e-01 1 1  ON 34
 eO_5                 4.157080e-01 1 1  ON 35
 eO_6                 4.152665e-01 1 1  ON 36
 eO_7                 3.835547e-01 1 1  ON 37
 eO_8                 2.578728e-01 1 1  ON 38
 eO_9                 1.066567e-01 1 1  ON 39
eH1_0                -1.542519e-01 1 1  ON 40
eH1_1                -5.383614e-02 1 1  ON 41
eH1_2                -3.394161e-02 1 1  ON 42
eH1_3                -3.196613e-02 1 1  ON 43
eH1_4                 6.003889e-03 1 1  ON 44
eH1_5                 1.560206e-02 1 1  ON 45
eH1_6                 4.350556e-02 1 1  ON 46
eH1_7                 4.736505e-02 1 1  ON 47
eH1_8                 5.118580e-02 1 1  ON 48
eH1_9                 7.815480e-02 1 1  ON 49
eH2_0                -1.531223e-01 1 1  ON 50
eH2_1                -5.323562e-02 1 1  ON 51
eH2_2                -3.234630e-02 1 1  ON 52
eH2_3                -3.038928e-02 1 1  ON 53
eH2_4                 7.253166e-03 1 1  ON 54
eH2_5                 1.718652e-02 1 1  ON 55
eH2_6                 4.425930e-02 1 1  ON 56
eH2_7                 4.556278e-02 1 1  ON 57
eH2_8                 4.104087e-02 1 1  ON 58
eH2_9                 7.981572e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.4401
    reference variance = 0.473682
====================================================
  Execution time = 4.6814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5738e-01
  Total weights = 2.0000e+06
  Execution time = 3.8415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557198587013
                                         uncertainty =       0.004384633380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557198587013
                                         uncertainty =       0.004384633380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527762838
  error estimate for blocks of size 2^( 2) =       0.000548031258
  error estimate for blocks of size 2^( 3) =       0.000567000048
  error estimate for blocks of size 2^( 4) =       0.000581945964
  error estimate for blocks of size 2^( 5) =       0.000590864231
  error estimate for blocks of size 2^( 6) =       0.000595450575
  error estimate for blocks of size 2^( 7) =       0.000598149783

      target function =                  N/A
              le_mean =     -22.436411391378
             les_mean =     503.949623071161
             stat err =       0.000591602638
             autocorr =       1.256558149009
              std dev =       0.746369363331
             le_variance =       0.557067226519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557902175924
                                         uncertainty =       0.004385158495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557902175924
                                         uncertainty =       0.004385158495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528095952
  error estimate for blocks of size 2^( 2) =       0.000548336593
  error estimate for blocks of size 2^( 3) =       0.000567271361
  error estimate for blocks of size 2^( 4) =       0.000582184344
  error estimate for blocks of size 2^( 5) =       0.000591075759
  error estimate for blocks of size 2^( 6) =       0.000595646018
  error estimate for blocks of size 2^( 7) =       0.000598320236

      target function =                  N/A
              le_mean =     -22.436406935878
             les_mean =     503.950126582226
             stat err =       0.000591806589
             autocorr =       1.255838855120
              std dev =       0.746840457396
             le_variance =       0.557770668803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557840731455
                                         uncertainty =       0.004384681148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557840731455
                                         uncertainty =       0.004384681148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528066891
  error estimate for blocks of size 2^( 2) =       0.000548311304
  error estimate for blocks of size 2^( 3) =       0.000567251893
  error estimate for blocks of size 2^( 4) =       0.000582169912
  error estimate for blocks of size 2^( 5) =       0.000591065261
  error estimate for blocks of size 2^( 6) =       0.000595638512
  error estimate for blocks of size 2^( 7) =       0.000598318872

      target function =                  N/A
              le_mean =     -22.436407948763
             les_mean =     503.950110648032
             stat err =       0.000591798139
             autocorr =       1.255941216029
              std dev =       0.746799359641
             le_variance =       0.557709283560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557287788424
                                         uncertainty =       0.004384484273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557287788424
                                         uncertainty =       0.004384484273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527805088
  error estimate for blocks of size 2^( 2) =       0.000548069693
  error estimate for blocks of size 2^( 3) =       0.000567034043
  error estimate for blocks of size 2^( 4) =       0.000581975537
  error estimate for blocks of size 2^( 5) =       0.000590890008
  error estimate for blocks of size 2^( 6) =       0.000595473857
  error estimate for blocks of size 2^( 7) =       0.000598170112

      target function =                  N/A
              le_mean =     -22.436410595498
             les_mean =     503.949676552926
             stat err =       0.000591627379
             autocorr =       1.256462068827
              std dev =       0.746429113680
             le_variance =       0.557156421749


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436411391378        initial  <--
     9.7656e-02     9.7656e-01             5.7032e-03       -22.436406935878
     3.9062e-01     3.9062e+00             1.4067e-03       -22.436407948763
     1.5625e+00     1.5625e+01             3.5083e-04       -22.436410595498

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.0551
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.771878e-01 1 1  ON 0
 uu_1                 1.024366e-01 1 1  ON 1
 uu_2                -1.267276e-02 1 1  ON 2
 uu_3                -8.107808e-02 1 1  ON 3
 uu_4                -1.200796e-01 1 1  ON 4
 uu_5                -1.414099e-01 1 1  ON 5
 uu_6                -1.486677e-01 1 1  ON 6
 uu_7                -1.398306e-01 1 1  ON 7
 uu_8                -1.099792e-01 1 1  ON 8
 uu_9                -3.879399e-02 1 1  ON 9
 ud_0                 4.437275e-01 1 1  ON 10
 ud_1                 1.598304e-01 1 1  ON 11
 ud_2                 1.037878e-02 1 1  ON 12
 ud_3                -7.239158e-02 1 1  ON 13
 ud_4                -1.198737e-01 1 1  ON 14
 ud_5                -1.493296e-01 1 1  ON 15
 ud_6                -1.648414e-01 1 1  ON 16
 ud_7                -1.648045e-01 1 1  ON 17
 ud_8                -1.416268e-01 1 1  ON 18
 ud_9                -8.124678e-02 1 1  ON 19
 eC_0                -5.983412e-01 1 1  ON 20
 eC_1                -4.271742e-01 1 1  ON 21
 eC_2                -1.300809e-01 1 1  ON 22
 eC_3                 7.791908e-02 1 1  ON 23
 eC_4                 2.050034e-01 1 1  ON 24
 eC_5                 3.020744e-01 1 1  ON 25
 eC_6                 2.772209e-01 1 1  ON 26
 eC_7                 2.148745e-01 1 1  ON 27
 eC_8                 6.599181e-02 1 1  ON 28
 eC_9                 1.064904e-02 1 1  ON 29
 eO_0                -1.091179e+00 1 1  ON 30
 eO_1                -7.021136e-01 1 1  ON 31
 eO_2                -2.188523e-01 1 1  ON 32
 eO_3                 9.385492e-02 1 1  ON 33
 eO_4                 3.001403e-01 1 1  ON 34
 eO_5                 4.157514e-01 1 1  ON 35
 eO_6                 4.154262e-01 1 1  ON 36
 eO_7                 3.829941e-01 1 1  ON 37
 eO_8                 2.564661e-01 1 1  ON 38
 eO_9                 1.058758e-01 1 1  ON 39
eH1_0                -1.540850e-01 1 1  ON 40
eH1_1                -5.388202e-02 1 1  ON 41
eH1_2                -3.390120e-02 1 1  ON 42
eH1_3                -3.192480e-02 1 1  ON 43
eH1_4                 6.006415e-03 1 1  ON 44
eH1_5                 1.561959e-02 1 1  ON 45
eH1_6                 4.343210e-02 1 1  ON 46
eH1_7                 4.725457e-02 1 1  ON 47
eH1_8                 5.143631e-02 1 1  ON 48
eH1_9                 7.803137e-02 1 1  ON 49
eH2_0                -1.531120e-01 1 1  ON 50
eH2_1                -5.333076e-02 1 1  ON 51
eH2_2                -3.223181e-02 1 1  ON 52
eH2_3                -3.031717e-02 1 1  ON 53
eH2_4                 7.384449e-03 1 1  ON 54
eH2_5                 1.727318e-02 1 1  ON 55
eH2_6                 4.447098e-02 1 1  ON 56
eH2_7                 4.534075e-02 1 1  ON 57
eH2_8                 4.115373e-02 1 1  ON 58
eH2_9                 7.958730e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2842e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2437e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.5078
    reference variance = 0.483352
====================================================
  Execution time = 4.5200e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7768e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5310e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577672376806
                                         uncertainty =       0.009725667353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577672376806
                                         uncertainty =       0.009725667353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537437370
  error estimate for blocks of size 2^( 2) =       0.000557833827
  error estimate for blocks of size 2^( 3) =       0.000576681539
  error estimate for blocks of size 2^( 4) =       0.000591168033
  error estimate for blocks of size 2^( 5) =       0.000599843058
  error estimate for blocks of size 2^( 6) =       0.000607528029
  error estimate for blocks of size 2^( 7) =       0.000612386341

      target function =                  N/A
              le_mean =     -22.436638448310
             les_mean =     503.980422425487
             stat err =       0.000602731366
             autocorr =       1.257742862592
              std dev =       0.760051218106
             le_variance =       0.577677854144


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243663844831e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436638448310       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436638604183       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436638791882       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436637767787       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436637953374       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436638517792       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436638631190       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436638712800       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436638667432       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436638944666       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436639016698       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436639013299       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 5.484899e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436638448310       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436638491685       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436638542835       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436638199127       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436638228684       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436638394345       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436638430084       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436638429223       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436638390836       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436638448592       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436638496151       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 1.361828e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436638448310       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436638459469       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436638472591       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436638379004       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436638384324       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436638426647       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436638436643       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436638435597       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436638422710       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436638436052       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436638449426       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+01 is 3.400956e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232531 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0522e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.772053e-01 1 1  ON 0
 uu_1                 1.024524e-01 1 1  ON 1
 uu_2                -1.268465e-02 1 1  ON 2
 uu_3                -8.110499e-02 1 1  ON 3
 uu_4                -1.200823e-01 1 1  ON 4
 uu_5                -1.414326e-01 1 1  ON 5
 uu_6                -1.487339e-01 1 1  ON 6
 uu_7                -1.398627e-01 1 1  ON 7
 uu_8                -1.099960e-01 1 1  ON 8
 uu_9                -3.883422e-02 1 1  ON 9
 ud_0                 4.437487e-01 1 1  ON 10
 ud_1                 1.598030e-01 1 1  ON 11
 ud_2                 1.036936e-02 1 1  ON 12
 ud_3                -7.241633e-02 1 1  ON 13
 ud_4                -1.198944e-01 1 1  ON 14
 ud_5                -1.493346e-01 1 1  ON 15
 ud_6                -1.648695e-01 1 1  ON 16
 ud_7                -1.647893e-01 1 1  ON 17
 ud_8                -1.416138e-01 1 1  ON 18
 ud_9                -8.126577e-02 1 1  ON 19
 eC_0                -5.983952e-01 1 1  ON 20
 eC_1                -4.272509e-01 1 1  ON 21
 eC_2                -1.301016e-01 1 1  ON 22
 eC_3                 7.789732e-02 1 1  ON 23
 eC_4                 2.049776e-01 1 1  ON 24
 eC_5                 3.020622e-01 1 1  ON 25
 eC_6                 2.772553e-01 1 1  ON 26
 eC_7                 2.149772e-01 1 1  ON 27
 eC_8                 6.604912e-02 1 1  ON 28
 eC_9                 1.066235e-02 1 1  ON 29
 eO_0                -1.091278e+00 1 1  ON 30
 eO_1                -7.021491e-01 1 1  ON 31
 eO_2                -2.188775e-01 1 1  ON 32
 eO_3                 9.376399e-02 1 1  ON 33
 eO_4                 3.000849e-01 1 1  ON 34
 eO_5                 4.157660e-01 1 1  ON 35
 eO_6                 4.154154e-01 1 1  ON 36
 eO_7                 3.830457e-01 1 1  ON 37
 eO_8                 2.566022e-01 1 1  ON 38
 eO_9                 1.059570e-01 1 1  ON 39
eH1_0                -1.541009e-01 1 1  ON 40
eH1_1                -5.391778e-02 1 1  ON 41
eH1_2                -3.391389e-02 1 1  ON 42
eH1_3                -3.188768e-02 1 1  ON 43
eH1_4                 5.966521e-03 1 1  ON 44
eH1_5                 1.561413e-02 1 1  ON 45
eH1_6                 4.344083e-02 1 1  ON 46
eH1_7                 4.725886e-02 1 1  ON 47
eH1_8                 5.142942e-02 1 1  ON 48
eH1_9                 7.806614e-02 1 1  ON 49
eH2_0                -1.531351e-01 1 1  ON 50
eH2_1                -5.334330e-02 1 1  ON 51
eH2_2                -3.223725e-02 1 1  ON 52
eH2_3                -3.034230e-02 1 1  ON 53
eH2_4                 7.359821e-03 1 1  ON 54
eH2_5                 1.724419e-02 1 1  ON 55
eH2_6                 4.451437e-02 1 1  ON 56
eH2_7                 4.537885e-02 1 1  ON 57
eH2_8                 4.113843e-02 1 1  ON 58
eH2_9                 7.961287e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.3256
    reference variance = 0.875414
====================================================
  Execution time = 4.4712e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.5639e-01
  Total weights = 2.0000e+06
  Execution time = 3.8478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556218404229
                                         uncertainty =       0.003454247129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556218404229
                                         uncertainty =       0.003454247129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527404313
  error estimate for blocks of size 2^( 2) =       0.000547769305
  error estimate for blocks of size 2^( 3) =       0.000566179537
  error estimate for blocks of size 2^( 4) =       0.000581174467
  error estimate for blocks of size 2^( 5) =       0.000590853842
  error estimate for blocks of size 2^( 6) =       0.000597069156
  error estimate for blocks of size 2^( 7) =       0.000599266447

      target function =                  N/A
              le_mean =     -22.435417514580
             les_mean =     503.904269394542
             stat err =       0.000592090978
             autocorr =       1.260345261775
              std dev =       0.745862332587
             le_variance =       0.556310619172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556477106711
                                         uncertainty =       0.003456196754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556477106711
                                         uncertainty =       0.003456196754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527526945
  error estimate for blocks of size 2^( 2) =       0.000547885898
  error estimate for blocks of size 2^( 3) =       0.000566287283
  error estimate for blocks of size 2^( 4) =       0.000581275479
  error estimate for blocks of size 2^( 5) =       0.000590952989
  error estimate for blocks of size 2^( 6) =       0.000597163236
  error estimate for blocks of size 2^( 7) =       0.000599358837

      target function =                  N/A
              le_mean =     -22.435415812493
             les_mean =     503.904451756665
             stat err =       0.000592187635
             autocorr =       1.260170692972
              std dev =       0.746035760189
             le_variance =       0.556569355480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556378368455
                                         uncertainty =       0.003455471150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556378368455
                                         uncertainty =       0.003455471150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527480150
  error estimate for blocks of size 2^( 2) =       0.000547841287
  error estimate for blocks of size 2^( 3) =       0.000566246127
  error estimate for blocks of size 2^( 4) =       0.000581237293
  error estimate for blocks of size 2^( 5) =       0.000590915788
  error estimate for blocks of size 2^( 6) =       0.000597128344
  error estimate for blocks of size 2^( 7) =       0.000599324795

      target function =                  N/A
              le_mean =     -22.435416386785
             les_mean =     503.904378788350
             stat err =       0.000592151555
             autocorr =       1.260240711775
              std dev =       0.745969582590
             le_variance =       0.556470618149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556239654639
                                         uncertainty =       0.003454410458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556239654639
                                         uncertainty =       0.003454410458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527414389
  error estimate for blocks of size 2^( 2) =       0.000547778861
  error estimate for blocks of size 2^( 3) =       0.000566188378
  error estimate for blocks of size 2^( 4) =       0.000581182824
  error estimate for blocks of size 2^( 5) =       0.000590862089
  error estimate for blocks of size 2^( 6) =       0.000597077057
  error estimate for blocks of size 2^( 7) =       0.000599274240

      target function =                  N/A
              le_mean =     -22.435417352815
             les_mean =     503.904283391836
             stat err =       0.000592099052
             autocorr =       1.260331480776
              std dev =       0.745876581616
             le_variance =       0.556331875003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435417514580        initial  <--
     9.7656e-01     9.7656e+00             5.4849e-04       -22.435415812493
     3.9062e+00     3.9062e+01             1.3618e-04       -22.435416386785
     1.5625e+01     1.5625e+02             3.4010e-05       -22.435417352815

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0020
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.771878e-01 1 1  ON 0
 uu_1                 1.024366e-01 1 1  ON 1
 uu_2                -1.267276e-02 1 1  ON 2
 uu_3                -8.107808e-02 1 1  ON 3
 uu_4                -1.200796e-01 1 1  ON 4
 uu_5                -1.414099e-01 1 1  ON 5
 uu_6                -1.486677e-01 1 1  ON 6
 uu_7                -1.398306e-01 1 1  ON 7
 uu_8                -1.099792e-01 1 1  ON 8
 uu_9                -3.879399e-02 1 1  ON 9
 ud_0                 4.437275e-01 1 1  ON 10
 ud_1                 1.598304e-01 1 1  ON 11
 ud_2                 1.037878e-02 1 1  ON 12
 ud_3                -7.239158e-02 1 1  ON 13
 ud_4                -1.198737e-01 1 1  ON 14
 ud_5                -1.493296e-01 1 1  ON 15
 ud_6                -1.648414e-01 1 1  ON 16
 ud_7                -1.648045e-01 1 1  ON 17
 ud_8                -1.416268e-01 1 1  ON 18
 ud_9                -8.124678e-02 1 1  ON 19
 eC_0                -5.983412e-01 1 1  ON 20
 eC_1                -4.271742e-01 1 1  ON 21
 eC_2                -1.300809e-01 1 1  ON 22
 eC_3                 7.791908e-02 1 1  ON 23
 eC_4                 2.050034e-01 1 1  ON 24
 eC_5                 3.020744e-01 1 1  ON 25
 eC_6                 2.772209e-01 1 1  ON 26
 eC_7                 2.148745e-01 1 1  ON 27
 eC_8                 6.599181e-02 1 1  ON 28
 eC_9                 1.064904e-02 1 1  ON 29
 eO_0                -1.091179e+00 1 1  ON 30
 eO_1                -7.021136e-01 1 1  ON 31
 eO_2                -2.188523e-01 1 1  ON 32
 eO_3                 9.385492e-02 1 1  ON 33
 eO_4                 3.001403e-01 1 1  ON 34
 eO_5                 4.157514e-01 1 1  ON 35
 eO_6                 4.154262e-01 1 1  ON 36
 eO_7                 3.829941e-01 1 1  ON 37
 eO_8                 2.564661e-01 1 1  ON 38
 eO_9                 1.058758e-01 1 1  ON 39
eH1_0                -1.540850e-01 1 1  ON 40
eH1_1                -5.388202e-02 1 1  ON 41
eH1_2                -3.390120e-02 1 1  ON 42
eH1_3                -3.192480e-02 1 1  ON 43
eH1_4                 6.006415e-03 1 1  ON 44
eH1_5                 1.561959e-02 1 1  ON 45
eH1_6                 4.343210e-02 1 1  ON 46
eH1_7                 4.725457e-02 1 1  ON 47
eH1_8                 5.143631e-02 1 1  ON 48
eH1_9                 7.803137e-02 1 1  ON 49
eH2_0                -1.531120e-01 1 1  ON 50
eH2_1                -5.333076e-02 1 1  ON 51
eH2_2                -3.223181e-02 1 1  ON 52
eH2_3                -3.031717e-02 1 1  ON 53
eH2_4                 7.384449e-03 1 1  ON 54
eH2_5                 1.727318e-02 1 1  ON 55
eH2_6                 4.447098e-02 1 1  ON 56
eH2_7                 4.534075e-02 1 1  ON 57
eH2_8                 4.115373e-02 1 1  ON 58
eH2_9                 7.958730e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2453e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.4796
    reference variance = 0.586825
====================================================
  Execution time = 4.5380e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5891e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5559e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558943757357
                                         uncertainty =       0.003836593054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558943757357
                                         uncertainty =       0.003836593054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528634705
  error estimate for blocks of size 2^( 2) =       0.000549401235
  error estimate for blocks of size 2^( 3) =       0.000568255363
  error estimate for blocks of size 2^( 4) =       0.000583211451
  error estimate for blocks of size 2^( 5) =       0.000593467835
  error estimate for blocks of size 2^( 6) =       0.000597526967
  error estimate for blocks of size 2^( 7) =       0.000599538778

      target function =                  N/A
              le_mean =     -22.437329266178
             les_mean =     503.992653622423
             stat err =       0.000593436258
             autocorr =       1.260192271331
              std dev =       0.747602369585
             le_variance =       0.558909303009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243732926618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437329266178       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437329360813       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437329412743       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437329406363       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437329520465       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437329496343       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437329497719       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437329504175       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437329524064       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437329518598       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437329523602       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 5.913321e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437329266178       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437329290104       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437329303398       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437329301720       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437329330469       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437329325184       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437329325137       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437329328388       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437329331422       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437329330100       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+01 is 1.469605e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437329266178       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437329272176       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437329275520       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437329275095       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437329282287       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437329281111       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437329280851       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437329281498       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437329282558       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437329282212       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 3.674348e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0951e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.771871e-01 1 1  ON 0
 uu_1                 1.024359e-01 1 1  ON 1
 uu_2                -1.267112e-02 1 1  ON 2
 uu_3                -8.108199e-02 1 1  ON 3
 uu_4                -1.200786e-01 1 1  ON 4
 uu_5                -1.414116e-01 1 1  ON 5
 uu_6                -1.486686e-01 1 1  ON 6
 uu_7                -1.398343e-01 1 1  ON 7
 uu_8                -1.099795e-01 1 1  ON 8
 uu_9                -3.879858e-02 1 1  ON 9
 ud_0                 4.437281e-01 1 1  ON 10
 ud_1                 1.598296e-01 1 1  ON 11
 ud_2                 1.037932e-02 1 1  ON 12
 ud_3                -7.239476e-02 1 1  ON 13
 ud_4                -1.198727e-01 1 1  ON 14
 ud_5                -1.493295e-01 1 1  ON 15
 ud_6                -1.648442e-01 1 1  ON 16
 ud_7                -1.648026e-01 1 1  ON 17
 ud_8                -1.416265e-01 1 1  ON 18
 ud_9                -8.124968e-02 1 1  ON 19
 eC_0                -5.983453e-01 1 1  ON 20
 eC_1                -4.271807e-01 1 1  ON 21
 eC_2                -1.300816e-01 1 1  ON 22
 eC_3                 7.791430e-02 1 1  ON 23
 eC_4                 2.050025e-01 1 1  ON 24
 eC_5                 3.020699e-01 1 1  ON 25
 eC_6                 2.772232e-01 1 1  ON 26
 eC_7                 2.148863e-01 1 1  ON 27
 eC_8                 6.599851e-02 1 1  ON 28
 eC_9                 1.064990e-02 1 1  ON 29
 eO_0                -1.091186e+00 1 1  ON 30
 eO_1                -7.021194e-01 1 1  ON 31
 eO_2                -2.188562e-01 1 1  ON 32
 eO_3                 9.384924e-02 1 1  ON 33
 eO_4                 3.001331e-01 1 1  ON 34
 eO_5                 4.157540e-01 1 1  ON 35
 eO_6                 4.154239e-01 1 1  ON 36
 eO_7                 3.829982e-01 1 1  ON 37
 eO_8                 2.564808e-01 1 1  ON 38
 eO_9                 1.058844e-01 1 1  ON 39
eH1_0                -1.540871e-01 1 1  ON 40
eH1_1                -5.388320e-02 1 1  ON 41
eH1_2                -3.389957e-02 1 1  ON 42
eH1_3                -3.192595e-02 1 1  ON 43
eH1_4                 6.004797e-03 1 1  ON 44
eH1_5                 1.561938e-02 1 1  ON 45
eH1_6                 4.343245e-02 1 1  ON 46
eH1_7                 4.725398e-02 1 1  ON 47
eH1_8                 5.143455e-02 1 1  ON 48
eH1_9                 7.803519e-02 1 1  ON 49
eH2_0                -1.531132e-01 1 1  ON 50
eH2_1                -5.333381e-02 1 1  ON 51
eH2_2                -3.223456e-02 1 1  ON 52
eH2_3                -3.031816e-02 1 1  ON 53
eH2_4                 7.384906e-03 1 1  ON 54
eH2_5                 1.727081e-02 1 1  ON 55
eH2_6                 4.447289e-02 1 1  ON 56
eH2_7                 4.534227e-02 1 1  ON 57
eH2_8                 4.115332e-02 1 1  ON 58
eH2_9                 7.959094e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.3899
    reference variance = 0.493341
====================================================
  Execution time = 4.7115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7403e-01
  Total weights = 2.0000e+06
  Execution time = 3.8375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574118602093
                                         uncertainty =       0.020357161888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574118602093
                                         uncertainty =       0.020357161888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535739255
  error estimate for blocks of size 2^( 2) =       0.000555675786
  error estimate for blocks of size 2^( 3) =       0.000574270479
  error estimate for blocks of size 2^( 4) =       0.000588253540
  error estimate for blocks of size 2^( 5) =       0.000597279341
  error estimate for blocks of size 2^( 6) =       0.000601989006
  error estimate for blocks of size 2^( 7) =       0.000606336933

      target function =                  N/A
              le_mean =     -22.436585288895
             les_mean =     503.974392237393
             stat err =       0.000598464705
             autocorr =       1.247872305070
              std dev =       0.757649720211
             le_variance =       0.574033098536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574126779892
                                         uncertainty =       0.020357608564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574126779892
                                         uncertainty =       0.020357608564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535743069
  error estimate for blocks of size 2^( 2) =       0.000555679411
  error estimate for blocks of size 2^( 3) =       0.000574273687
  error estimate for blocks of size 2^( 4) =       0.000588256097
  error estimate for blocks of size 2^( 5) =       0.000597282194
  error estimate for blocks of size 2^( 6) =       0.000601991858
  error estimate for blocks of size 2^( 7) =       0.000606338962

      target function =                  N/A
              le_mean =     -22.436585073546
             les_mean =     503.974390747723
             stat err =       0.000598467278
             autocorr =       1.247865266651
              std dev =       0.757655114348
             le_variance =       0.574041272298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574122542160
                                         uncertainty =       0.020357390456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574122542160
                                         uncertainty =       0.020357390456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535741092
  error estimate for blocks of size 2^( 2) =       0.000555677541
  error estimate for blocks of size 2^( 3) =       0.000574272027
  error estimate for blocks of size 2^( 4) =       0.000588254757
  error estimate for blocks of size 2^( 5) =       0.000597280727
  error estimate for blocks of size 2^( 6) =       0.000601990381
  error estimate for blocks of size 2^( 7) =       0.000606337873

      target function =                  N/A
              le_mean =     -22.436585174062
             les_mean =     503.974391022313
             stat err =       0.000598465934
             autocorr =       1.247868872249
              std dev =       0.757652318924
             le_variance =       0.574037036371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574119092199
                                         uncertainty =       0.020357190823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574119092199
                                         uncertainty =       0.020357190823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535739483
  error estimate for blocks of size 2^( 2) =       0.000555676005
  error estimate for blocks of size 2^( 3) =       0.000574270671
  error estimate for blocks of size 2^( 4) =       0.000588253691
  error estimate for blocks of size 2^( 5) =       0.000597279514
  error estimate for blocks of size 2^( 6) =       0.000601989177
  error estimate for blocks of size 2^( 7) =       0.000606337048

      target function =                  N/A
              le_mean =     -22.436585274335
             les_mean =     503.974392073869
             stat err =       0.000598464857
             autocorr =       1.247871876259
              std dev =       0.757650043464
             le_variance =       0.574033588361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436585288895        initial  <--
     9.7656e+00     9.7656e+01             5.9133e-05       -22.436585073546
     3.9062e+01     3.9062e+02             1.4696e-05       -22.436585174062
     1.5625e+02     1.5625e+03             3.6743e-06       -22.436585274335

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.1983
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.771878e-01 1 1  ON 0
 uu_1                 1.024366e-01 1 1  ON 1
 uu_2                -1.267276e-02 1 1  ON 2
 uu_3                -8.107808e-02 1 1  ON 3
 uu_4                -1.200796e-01 1 1  ON 4
 uu_5                -1.414099e-01 1 1  ON 5
 uu_6                -1.486677e-01 1 1  ON 6
 uu_7                -1.398306e-01 1 1  ON 7
 uu_8                -1.099792e-01 1 1  ON 8
 uu_9                -3.879399e-02 1 1  ON 9
 ud_0                 4.437275e-01 1 1  ON 10
 ud_1                 1.598304e-01 1 1  ON 11
 ud_2                 1.037878e-02 1 1  ON 12
 ud_3                -7.239158e-02 1 1  ON 13
 ud_4                -1.198737e-01 1 1  ON 14
 ud_5                -1.493296e-01 1 1  ON 15
 ud_6                -1.648414e-01 1 1  ON 16
 ud_7                -1.648045e-01 1 1  ON 17
 ud_8                -1.416268e-01 1 1  ON 18
 ud_9                -8.124678e-02 1 1  ON 19
 eC_0                -5.983412e-01 1 1  ON 20
 eC_1                -4.271742e-01 1 1  ON 21
 eC_2                -1.300809e-01 1 1  ON 22
 eC_3                 7.791908e-02 1 1  ON 23
 eC_4                 2.050034e-01 1 1  ON 24
 eC_5                 3.020744e-01 1 1  ON 25
 eC_6                 2.772209e-01 1 1  ON 26
 eC_7                 2.148745e-01 1 1  ON 27
 eC_8                 6.599181e-02 1 1  ON 28
 eC_9                 1.064904e-02 1 1  ON 29
 eO_0                -1.091179e+00 1 1  ON 30
 eO_1                -7.021136e-01 1 1  ON 31
 eO_2                -2.188523e-01 1 1  ON 32
 eO_3                 9.385492e-02 1 1  ON 33
 eO_4                 3.001403e-01 1 1  ON 34
 eO_5                 4.157514e-01 1 1  ON 35
 eO_6                 4.154262e-01 1 1  ON 36
 eO_7                 3.829941e-01 1 1  ON 37
 eO_8                 2.564661e-01 1 1  ON 38
 eO_9                 1.058758e-01 1 1  ON 39
eH1_0                -1.540850e-01 1 1  ON 40
eH1_1                -5.388202e-02 1 1  ON 41
eH1_2                -3.390120e-02 1 1  ON 42
eH1_3                -3.192480e-02 1 1  ON 43
eH1_4                 6.006415e-03 1 1  ON 44
eH1_5                 1.561959e-02 1 1  ON 45
eH1_6                 4.343210e-02 1 1  ON 46
eH1_7                 4.725457e-02 1 1  ON 47
eH1_8                 5.143631e-02 1 1  ON 48
eH1_9                 7.803137e-02 1 1  ON 49
eH2_0                -1.531120e-01 1 1  ON 50
eH2_1                -5.333076e-02 1 1  ON 51
eH2_2                -3.223181e-02 1 1  ON 52
eH2_3                -3.031717e-02 1 1  ON 53
eH2_4                 7.384449e-03 1 1  ON 54
eH2_5                 1.727318e-02 1 1  ON 55
eH2_6                 4.447098e-02 1 1  ON 56
eH2_7                 4.534075e-02 1 1  ON 57
eH2_8                 4.115373e-02 1 1  ON 58
eH2_9                 7.958730e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2916e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.5228
    reference variance = 0.617384
====================================================
  Execution time = 4.5337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6511e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5052e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565179991725
                                         uncertainty =       0.005869768261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565179991725
                                         uncertainty =       0.005869768261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531557972
  error estimate for blocks of size 2^( 2) =       0.000552078696
  error estimate for blocks of size 2^( 3) =       0.000570732687
  error estimate for blocks of size 2^( 4) =       0.000584223714
  error estimate for blocks of size 2^( 5) =       0.000592296929
  error estimate for blocks of size 2^( 6) =       0.000599039705
  error estimate for blocks of size 2^( 7) =       0.000597894693

      target function =                  N/A
              le_mean =     -22.436380170695
             les_mean =     503.956262637142
             stat err =       0.000593363760
             autocorr =       1.246065191999
              std dev =       0.751736493542
             le_variance =       0.565107755723


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243638017070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436380170695       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436380179763       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436380189642       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436380188214       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436380176817       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436380172344       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436380188966       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436380185009       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436380188970       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436380187912       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 5.359872e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436380170695       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436380172965       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436380175440       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436380175087       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436380172229       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436380171100       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436380175248       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436380174258       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436380175252       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436380174985       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+02 is 1.340065e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436380170695       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436380171263       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436380171882       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436380171794       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436380171079       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436380170795       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436380171833       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436380171584       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436380171834       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436380171770       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+03 is 3.350222e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240295 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0401e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.771878e-01 1 1  ON 0
 uu_1                 1.024366e-01 1 1  ON 1
 uu_2                -1.267287e-02 1 1  ON 2
 uu_3                -8.107806e-02 1 1  ON 3
 uu_4                -1.200797e-01 1 1  ON 4
 uu_5                -1.414097e-01 1 1  ON 5
 uu_6                -1.486680e-01 1 1  ON 6
 uu_7                -1.398309e-01 1 1  ON 7
 uu_8                -1.099797e-01 1 1  ON 8
 uu_9                -3.879466e-02 1 1  ON 9
 ud_0                 4.437276e-01 1 1  ON 10
 ud_1                 1.598303e-01 1 1  ON 11
 ud_2                 1.037897e-02 1 1  ON 12
 ud_3                -7.239195e-02 1 1  ON 13
 ud_4                -1.198737e-01 1 1  ON 14
 ud_5                -1.493300e-01 1 1  ON 15
 ud_6                -1.648411e-01 1 1  ON 16
 ud_7                -1.648045e-01 1 1  ON 17
 ud_8                -1.416269e-01 1 1  ON 18
 ud_9                -8.124706e-02 1 1  ON 19
 eC_0                -5.983415e-01 1 1  ON 20
 eC_1                -4.271751e-01 1 1  ON 21
 eC_2                -1.300812e-01 1 1  ON 22
 eC_3                 7.791906e-02 1 1  ON 23
 eC_4                 2.050030e-01 1 1  ON 24
 eC_5                 3.020746e-01 1 1  ON 25
 eC_6                 2.772213e-01 1 1  ON 26
 eC_7                 2.148753e-01 1 1  ON 27
 eC_8                 6.599225e-02 1 1  ON 28
 eC_9                 1.064911e-02 1 1  ON 29
 eO_0                -1.091180e+00 1 1  ON 30
 eO_1                -7.021140e-01 1 1  ON 31
 eO_2                -2.188526e-01 1 1  ON 32
 eO_3                 9.385436e-02 1 1  ON 33
 eO_4                 3.001395e-01 1 1  ON 34
 eO_5                 4.157513e-01 1 1  ON 35
 eO_6                 4.154261e-01 1 1  ON 36
 eO_7                 3.829948e-01 1 1  ON 37
 eO_8                 2.564674e-01 1 1  ON 38
 eO_9                 1.058767e-01 1 1  ON 39
eH1_0                -1.540851e-01 1 1  ON 40
eH1_1                -5.388227e-02 1 1  ON 41
eH1_2                -3.390098e-02 1 1  ON 42
eH1_3                -3.192455e-02 1 1  ON 43
eH1_4                 6.006247e-03 1 1  ON 44
eH1_5                 1.561953e-02 1 1  ON 45
eH1_6                 4.343258e-02 1 1  ON 46
eH1_7                 4.725428e-02 1 1  ON 47
eH1_8                 5.143586e-02 1 1  ON 48
eH1_9                 7.803155e-02 1 1  ON 49
eH2_0                -1.531125e-01 1 1  ON 50
eH2_1                -5.333066e-02 1 1  ON 51
eH2_2                -3.223199e-02 1 1  ON 52
eH2_3                -3.031731e-02 1 1  ON 53
eH2_4                 7.384119e-03 1 1  ON 54
eH2_5                 1.727307e-02 1 1  ON 55
eH2_6                 4.447123e-02 1 1  ON 56
eH2_7                 4.534120e-02 1 1  ON 57
eH2_8                 4.115379e-02 1 1  ON 58
eH2_9                 7.958748e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.3906
    reference variance = 0.362675
====================================================
  Execution time = 4.4253e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5933e-01
  Total weights = 2.0000e+06
  Execution time = 3.8378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559223370010
                                         uncertainty =       0.004897479194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559223370010
                                         uncertainty =       0.004897479194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528833218
  error estimate for blocks of size 2^( 2) =       0.000549240671
  error estimate for blocks of size 2^( 3) =       0.000568811782
  error estimate for blocks of size 2^( 4) =       0.000583254406
  error estimate for blocks of size 2^( 5) =       0.000593580698
  error estimate for blocks of size 2^( 6) =       0.000598768162
  error estimate for blocks of size 2^( 7) =       0.000605086421

      target function =                  N/A
              le_mean =     -22.436960847598
             les_mean =     503.976540942092
             stat err =       0.000595172422
             autocorr =       1.266625258816
              std dev =       0.747883109253
             le_variance =       0.559329145105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559223762392
                                         uncertainty =       0.004897506161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559223762392
                                         uncertainty =       0.004897506161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528833404
  error estimate for blocks of size 2^( 2) =       0.000549240850
  error estimate for blocks of size 2^( 3) =       0.000568811912
  error estimate for blocks of size 2^( 4) =       0.000583254513
  error estimate for blocks of size 2^( 5) =       0.000593580774
  error estimate for blocks of size 2^( 6) =       0.000598768255
  error estimate for blocks of size 2^( 7) =       0.000605086615

      target function =                  N/A
              le_mean =     -22.436960853620
             les_mean =     503.976541605888
             stat err =       0.000595172539
             autocorr =       1.266624867876
              std dev =       0.747883372361
             le_variance =       0.559329538654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559223565845
                                         uncertainty =       0.004897492747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559223565845
                                         uncertainty =       0.004897492747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528833311
  error estimate for blocks of size 2^( 2) =       0.000549240760
  error estimate for blocks of size 2^( 3) =       0.000568811847
  error estimate for blocks of size 2^( 4) =       0.000583254459
  error estimate for blocks of size 2^( 5) =       0.000593580736
  error estimate for blocks of size 2^( 6) =       0.000598768209
  error estimate for blocks of size 2^( 7) =       0.000605086518

      target function =                  N/A
              le_mean =     -22.436960850620
             les_mean =     503.976541274102
             stat err =       0.000595172480
             autocorr =       1.266625063996
              std dev =       0.747883240569
             le_variance =       0.559329341525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559223394469
                                         uncertainty =       0.004897480890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559223394469
                                         uncertainty =       0.004897480890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528833230
  error estimate for blocks of size 2^( 2) =       0.000549240682
  error estimate for blocks of size 2^( 3) =       0.000568811790
  error estimate for blocks of size 2^( 4) =       0.000583254413
  error estimate for blocks of size 2^( 5) =       0.000593580703
  error estimate for blocks of size 2^( 6) =       0.000598768168
  error estimate for blocks of size 2^( 7) =       0.000605086433

      target function =                  N/A
              le_mean =     -22.436960847975
             les_mean =     503.976540983544
             stat err =       0.000595172429
             autocorr =       1.266625234492
              std dev =       0.747883125654
             le_variance =       0.559329169638


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436960847598        initial
     9.7656e+01     9.7656e+02             5.3599e-06       -22.436960853620  <--
     3.9062e+02     3.9062e+03             1.3401e-06       -22.436960850620
     1.5625e+03     1.5625e+04             3.3502e-07       -22.436960847975

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 6.3448e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.771877e-01 1 1  ON 0
 uu_1                 1.024367e-01 1 1  ON 1
 uu_2                -1.267321e-02 1 1  ON 2
 uu_3                -8.107799e-02 1 1  ON 3
 uu_4                -1.200801e-01 1 1  ON 4
 uu_5                -1.414088e-01 1 1  ON 5
 uu_6                -1.486692e-01 1 1  ON 6
 uu_7                -1.398318e-01 1 1  ON 7
 uu_8                -1.099810e-01 1 1  ON 8
 uu_9                -3.879667e-02 1 1  ON 9
 ud_0                 4.437279e-01 1 1  ON 10
 ud_1                 1.598301e-01 1 1  ON 11
 ud_2                 1.037956e-02 1 1  ON 12
 ud_3                -7.239306e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493310e-01 1 1  ON 15
 ud_6                -1.648403e-01 1 1  ON 16
 ud_7                -1.648047e-01 1 1  ON 17
 ud_8                -1.416274e-01 1 1  ON 18
 ud_9                -8.124790e-02 1 1  ON 19
 eC_0                -5.983426e-01 1 1  ON 20
 eC_1                -4.271776e-01 1 1  ON 21
 eC_2                -1.300821e-01 1 1  ON 22
 eC_3                 7.791902e-02 1 1  ON 23
 eC_4                 2.050019e-01 1 1  ON 24
 eC_5                 3.020750e-01 1 1  ON 25
 eC_6                 2.772223e-01 1 1  ON 26
 eC_7                 2.148778e-01 1 1  ON 27
 eC_8                 6.599358e-02 1 1  ON 28
 eC_9                 1.064934e-02 1 1  ON 29
 eO_0                -1.091182e+00 1 1  ON 30
 eO_1                -7.021154e-01 1 1  ON 31
 eO_2                -2.188537e-01 1 1  ON 32
 eO_3                 9.385267e-02 1 1  ON 33
 eO_4                 3.001369e-01 1 1  ON 34
 eO_5                 4.157510e-01 1 1  ON 35
 eO_6                 4.154259e-01 1 1  ON 36
 eO_7                 3.829968e-01 1 1  ON 37
 eO_8                 2.564714e-01 1 1  ON 38
 eO_9                 1.058791e-01 1 1  ON 39
eH1_0                -1.540854e-01 1 1  ON 40
eH1_1                -5.388302e-02 1 1  ON 41
eH1_2                -3.390033e-02 1 1  ON 42
eH1_3                -3.192382e-02 1 1  ON 43
eH1_4                 6.005746e-03 1 1  ON 44
eH1_5                 1.561937e-02 1 1  ON 45
eH1_6                 4.343404e-02 1 1  ON 46
eH1_7                 4.725342e-02 1 1  ON 47
eH1_8                 5.143451e-02 1 1  ON 48
eH1_9                 7.803212e-02 1 1  ON 49
eH2_0                -1.531139e-01 1 1  ON 50
eH2_1                -5.333035e-02 1 1  ON 51
eH2_2                -3.223252e-02 1 1  ON 52
eH2_3                -3.031773e-02 1 1  ON 53
eH2_4                 7.383128e-03 1 1  ON 54
eH2_5                 1.727276e-02 1 1  ON 55
eH2_6                 4.447196e-02 1 1  ON 56
eH2_7                 4.534255e-02 1 1  ON 57
eH2_8                 4.115398e-02 1 1  ON 58
eH2_9                 7.958800e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2388e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2437e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.4087
    reference variance = 0.298972
====================================================
  Execution time = 4.6061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5577e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5345e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555795967705
                                         uncertainty =       0.003151331322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555795967705
                                         uncertainty =       0.003151331322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527145849
  error estimate for blocks of size 2^( 2) =       0.000547444896
  error estimate for blocks of size 2^( 3) =       0.000566770077
  error estimate for blocks of size 2^( 4) =       0.000582415841
  error estimate for blocks of size 2^( 5) =       0.000591953055
  error estimate for blocks of size 2^( 6) =       0.000598662068
  error estimate for blocks of size 2^( 7) =       0.000603456036

      target function =                  N/A
              le_mean =     -22.437019731736
             les_mean =     503.975619656962
             stat err =       0.000594121750
             autocorr =       1.270250344059
              std dev =       0.745496809194
             le_variance =       0.555765492518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243701973174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437019731736       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437019725698       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437019748688       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437019776990       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437019806681       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437019819047       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437019824059       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437019839610       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437019844361       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437019843748       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437019841762       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+01 is 2.214217e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437019731736       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437019730218       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437019736009       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437019743179       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437019750710       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437019753809       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437019755062       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437019758830       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437019759982       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437019759816       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437019759378       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 5.536072e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437019731736       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437019731356       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437019732807       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437019734605       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437019736495       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437019737270       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437019737585       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437019738518       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437019738805       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437019738760       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437019738655       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+02 is 1.384051e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1418e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.771880e-01 1 1  ON 0
 uu_1                 1.024370e-01 1 1  ON 1
 uu_2                -1.267215e-02 1 1  ON 2
 uu_3                -8.107854e-02 1 1  ON 3
 uu_4                -1.200792e-01 1 1  ON 4
 uu_5                -1.414097e-01 1 1  ON 5
 uu_6                -1.486695e-01 1 1  ON 6
 uu_7                -1.398334e-01 1 1  ON 7
 uu_8                -1.099835e-01 1 1  ON 8
 uu_9                -3.879938e-02 1 1  ON 9
 ud_0                 4.437262e-01 1 1  ON 10
 ud_1                 1.598307e-01 1 1  ON 11
 ud_2                 1.037989e-02 1 1  ON 12
 ud_3                -7.239402e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493310e-01 1 1  ON 15
 ud_6                -1.648408e-01 1 1  ON 16
 ud_7                -1.648032e-01 1 1  ON 17
 ud_8                -1.416284e-01 1 1  ON 18
 ud_9                -8.124904e-02 1 1  ON 19
 eC_0                -5.983426e-01 1 1  ON 20
 eC_1                -4.271812e-01 1 1  ON 21
 eC_2                -1.300834e-01 1 1  ON 22
 eC_3                 7.791839e-02 1 1  ON 23
 eC_4                 2.050009e-01 1 1  ON 24
 eC_5                 3.020752e-01 1 1  ON 25
 eC_6                 2.772235e-01 1 1  ON 26
 eC_7                 2.148806e-01 1 1  ON 27
 eC_8                 6.599569e-02 1 1  ON 28
 eC_9                 1.064980e-02 1 1  ON 29
 eO_0                -1.091186e+00 1 1  ON 30
 eO_1                -7.021169e-01 1 1  ON 31
 eO_2                -2.188550e-01 1 1  ON 32
 eO_3                 9.384891e-02 1 1  ON 33
 eO_4                 3.001347e-01 1 1  ON 34
 eO_5                 4.157523e-01 1 1  ON 35
 eO_6                 4.154253e-01 1 1  ON 36
 eO_7                 3.829989e-01 1 1  ON 37
 eO_8                 2.564770e-01 1 1  ON 38
 eO_9                 1.058823e-01 1 1  ON 39
eH1_0                -1.540849e-01 1 1  ON 40
eH1_1                -5.388363e-02 1 1  ON 41
eH1_2                -3.389888e-02 1 1  ON 42
eH1_3                -3.192391e-02 1 1  ON 43
eH1_4                 6.005384e-03 1 1  ON 44
eH1_5                 1.561846e-02 1 1  ON 45
eH1_6                 4.343487e-02 1 1  ON 46
eH1_7                 4.725255e-02 1 1  ON 47
eH1_8                 5.143302e-02 1 1  ON 48
eH1_9                 7.803267e-02 1 1  ON 49
eH2_0                -1.531150e-01 1 1  ON 50
eH2_1                -5.333015e-02 1 1  ON 51
eH2_2                -3.223335e-02 1 1  ON 52
eH2_3                -3.031783e-02 1 1  ON 53
eH2_4                 7.381983e-03 1 1  ON 54
eH2_5                 1.727168e-02 1 1  ON 55
eH2_6                 4.447382e-02 1 1  ON 56
eH2_7                 4.534326e-02 1 1  ON 57
eH2_8                 4.115372e-02 1 1  ON 58
eH2_9                 7.958886e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.403
    reference variance = 0.394417
====================================================
  Execution time = 4.4550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6295e-01
  Total weights = 2.0000e+06
  Execution time = 3.8385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562984226758
                                         uncertainty =       0.005674036134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562984226758
                                         uncertainty =       0.005674036134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530542809
  error estimate for blocks of size 2^( 2) =       0.000551451551
  error estimate for blocks of size 2^( 3) =       0.000570779711
  error estimate for blocks of size 2^( 4) =       0.000585289383
  error estimate for blocks of size 2^( 5) =       0.000594310729
  error estimate for blocks of size 2^( 6) =       0.000600859032
  error estimate for blocks of size 2^( 7) =       0.000605661644

      target function =                  N/A
              le_mean =     -22.436327358808
             les_mean =     503.951736413584
             stat err =       0.000596530197
             autocorr =       1.264223914473
              std dev =       0.750300835315
             le_variance =       0.562951343474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562979173196
                                         uncertainty =       0.005674164707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562979173196
                                         uncertainty =       0.005674164707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530540428
  error estimate for blocks of size 2^( 2) =       0.000551449286
  error estimate for blocks of size 2^( 3) =       0.000570777421
  error estimate for blocks of size 2^( 4) =       0.000585286978
  error estimate for blocks of size 2^( 5) =       0.000594308242
  error estimate for blocks of size 2^( 6) =       0.000600856565
  error estimate for blocks of size 2^( 7) =       0.000605659041

      target function =                  N/A
              le_mean =     -22.436327441948
             les_mean =     503.951735091538
             stat err =       0.000596527706
             autocorr =       1.264224706619
              std dev =       0.750297468134
             le_variance =       0.562946290688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562981601160
                                         uncertainty =       0.005674100558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562981601160
                                         uncertainty =       0.005674100558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530541572
  error estimate for blocks of size 2^( 2) =       0.000551450374
  error estimate for blocks of size 2^( 3) =       0.000570778524
  error estimate for blocks of size 2^( 4) =       0.000585288139
  error estimate for blocks of size 2^( 5) =       0.000594309443
  error estimate for blocks of size 2^( 6) =       0.000600857756
  error estimate for blocks of size 2^( 7) =       0.000605660298

      target function =                  N/A
              le_mean =     -22.436327400607
             les_mean =     503.951735664019
             stat err =       0.000596528909
             autocorr =       1.264224351727
              std dev =       0.750299085876
             le_variance =       0.562948718266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562983895252
                                         uncertainty =       0.005674044191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562983895252
                                         uncertainty =       0.005674044191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530542652
  error estimate for blocks of size 2^( 2) =       0.000551451402
  error estimate for blocks of size 2^( 3) =       0.000570779562
  error estimate for blocks of size 2^( 4) =       0.000585289226
  error estimate for blocks of size 2^( 5) =       0.000594310567
  error estimate for blocks of size 2^( 6) =       0.000600858871
  error estimate for blocks of size 2^( 7) =       0.000605661474

      target function =                  N/A
              le_mean =     -22.436327364024
             les_mean =     503.951736316177
             stat err =       0.000596530034
             autocorr =       1.264223970463
              std dev =       0.750300614432
             le_variance =       0.562951012017


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436327358808        initial
     2.4414e+01     2.4414e+02             2.2142e-05       -22.436327441948  <--
     9.7656e+01     9.7656e+02             5.5361e-06       -22.436327400607
     3.9062e+02     3.9062e+03             1.3841e-06       -22.436327364024

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 6.3764e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239684e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600202e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383764e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830049e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004304e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2520e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.3608
    reference variance = 0.339297
====================================================
  Execution time = 4.8806e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7531e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5129e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575448228953
                                         uncertainty =       0.013927259056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575448228953
                                         uncertainty =       0.013927259056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536334649
  error estimate for blocks of size 2^( 2) =       0.000555997423
  error estimate for blocks of size 2^( 3) =       0.000575025662
  error estimate for blocks of size 2^( 4) =       0.000589524031
  error estimate for blocks of size 2^( 5) =       0.000598977356
  error estimate for blocks of size 2^( 6) =       0.000603003184
  error estimate for blocks of size 2^( 7) =       0.000603216772

      target function =                  N/A
              le_mean =     -22.435810458702
             les_mean =     503.940900363458
             stat err =       0.000598680336
             autocorr =       1.246000674074
              std dev =       0.758491735164
             le_variance =       0.575309712312


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243581045870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435810458702       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435810884327       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435811096135       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435811471383       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435811530241       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435811535922       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435811458152       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435811431721       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435811473039       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435811464855       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435811473581       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+00 is 8.236938e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435810458702       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435810567728       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435810622431       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435810722378       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435810742777       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435810739634       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435810715497       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435810711255       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435810720074       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435810718577       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435810721604       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+01 is 2.060423e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435810458702       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435810486127       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435810499919       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435810525321       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435810530823       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435810529741       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435810525755       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435810522700       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435810524536       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435810524254       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435810525055       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 5.151660e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3947e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.771902e-01 1 1  ON 0
 uu_1                 1.024359e-01 1 1  ON 1
 uu_2                -1.266886e-02 1 1  ON 2
 uu_3                -8.108753e-02 1 1  ON 3
 uu_4                -1.200742e-01 1 1  ON 4
 uu_5                -1.414118e-01 1 1  ON 5
 uu_6                -1.486723e-01 1 1  ON 6
 uu_7                -1.398401e-01 1 1  ON 7
 uu_8                -1.099970e-01 1 1  ON 8
 uu_9                -3.881774e-02 1 1  ON 9
 ud_0                 4.437143e-01 1 1  ON 10
 ud_1                 1.598382e-01 1 1  ON 11
 ud_2                 1.038351e-02 1 1  ON 12
 ud_3                -7.240014e-02 1 1  ON 13
 ud_4                -1.198729e-01 1 1  ON 14
 ud_5                -1.493338e-01 1 1  ON 15
 ud_6                -1.648436e-01 1 1  ON 16
 ud_7                -1.647972e-01 1 1  ON 17
 ud_8                -1.416312e-01 1 1  ON 18
 ud_9                -8.125642e-02 1 1  ON 19
 eC_0                -5.983514e-01 1 1  ON 20
 eC_1                -4.271999e-01 1 1  ON 21
 eC_2                -1.300860e-01 1 1  ON 22
 eC_3                 7.791308e-02 1 1  ON 23
 eC_4                 2.049893e-01 1 1  ON 24
 eC_5                 3.020722e-01 1 1  ON 25
 eC_6                 2.772340e-01 1 1  ON 26
 eC_7                 2.149036e-01 1 1  ON 27
 eC_8                 6.600936e-02 1 1  ON 28
 eC_9                 1.065285e-02 1 1  ON 29
 eO_0                -1.091210e+00 1 1  ON 30
 eO_1                -7.021292e-01 1 1  ON 31
 eO_2                -2.188590e-01 1 1  ON 32
 eO_3                 9.382297e-02 1 1  ON 33
 eO_4                 3.001198e-01 1 1  ON 34
 eO_5                 4.157589e-01 1 1  ON 35
 eO_6                 4.154195e-01 1 1  ON 36
 eO_7                 3.830110e-01 1 1  ON 37
 eO_8                 2.565142e-01 1 1  ON 38
 eO_9                 1.059060e-01 1 1  ON 39
eH1_0                -1.540863e-01 1 1  ON 40
eH1_1                -5.389212e-02 1 1  ON 41
eH1_2                -3.389606e-02 1 1  ON 42
eH1_3                -3.192388e-02 1 1  ON 43
eH1_4                 5.999672e-03 1 1  ON 44
eH1_5                 1.561370e-02 1 1  ON 45
eH1_6                 4.344646e-02 1 1  ON 46
eH1_7                 4.725507e-02 1 1  ON 47
eH1_8                 5.142549e-02 1 1  ON 48
eH1_9                 7.803689e-02 1 1  ON 49
eH2_0                -1.531215e-01 1 1  ON 50
eH2_1                -5.332584e-02 1 1  ON 51
eH2_2                -3.223649e-02 1 1  ON 52
eH2_3                -3.031650e-02 1 1  ON 53
eH2_4                 7.379340e-03 1 1  ON 54
eH2_5                 1.726108e-02 1 1  ON 55
eH2_6                 4.448113e-02 1 1  ON 56
eH2_7                 4.534372e-02 1 1  ON 57
eH2_8                 4.115132e-02 1 1  ON 58
eH2_9                 7.959382e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.5089
    reference variance = 0.490554
====================================================
  Execution time = 4.4983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5402e-01
  Total weights = 2.0000e+06
  Execution time = 3.8468e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553985349010
                                         uncertainty =       0.003673030873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553985349010
                                         uncertainty =       0.003673030873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526320638
  error estimate for blocks of size 2^( 2) =       0.000546690994
  error estimate for blocks of size 2^( 3) =       0.000566071453
  error estimate for blocks of size 2^( 4) =       0.000579111684
  error estimate for blocks of size 2^( 5) =       0.000587765359
  error estimate for blocks of size 2^( 6) =       0.000592595794
  error estimate for blocks of size 2^( 7) =       0.000591796105

      target function =                  N/A
              le_mean =     -22.436946455768
             les_mean =     503.970592810007
             stat err =       0.000587817236
             autocorr =       1.247337078740
              std dev =       0.744329784460
             le_variance =       0.554026828034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553967117918
                                         uncertainty =       0.003672387633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553967117918
                                         uncertainty =       0.003672387633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526311993
  error estimate for blocks of size 2^( 2) =       0.000546683187
  error estimate for blocks of size 2^( 3) =       0.000566063358
  error estimate for blocks of size 2^( 4) =       0.000579102752
  error estimate for blocks of size 2^( 5) =       0.000587755801
  error estimate for blocks of size 2^( 6) =       0.000592585604
  error estimate for blocks of size 2^( 7) =       0.000591785152

      target function =                  N/A
              le_mean =     -22.436946385777
             les_mean =     503.970571469758
             stat err =       0.000587807327
             autocorr =       1.247336002214
              std dev =       0.744317558930
             le_variance =       0.554008628531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553974489826
                                         uncertainty =       0.003672682833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553974489826
                                         uncertainty =       0.003672682833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526315488
  error estimate for blocks of size 2^( 2) =       0.000546686317
  error estimate for blocks of size 2^( 3) =       0.000566066657
  error estimate for blocks of size 2^( 4) =       0.000579106467
  error estimate for blocks of size 2^( 5) =       0.000587759826
  error estimate for blocks of size 2^( 6) =       0.000592589924
  error estimate for blocks of size 2^( 7) =       0.000591789844

      target function =                  N/A
              le_mean =     -22.436946405866
             les_mean =     503.970579728297
             stat err =       0.000587811515
             autocorr =       1.247337212508
              std dev =       0.744322501067
             le_variance =       0.554015985595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553983927479
                                         uncertainty =       0.003672986462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553983927479
                                         uncertainty =       0.003672986462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526319964
  error estimate for blocks of size 2^( 2) =       0.000546690381
  error estimate for blocks of size 2^( 3) =       0.000566070826
  error estimate for blocks of size 2^( 4) =       0.000579111004
  error estimate for blocks of size 2^( 5) =       0.000587764639
  error estimate for blocks of size 2^( 6) =       0.000592595032
  error estimate for blocks of size 2^( 7) =       0.000591795294

      target function =                  N/A
              le_mean =     -22.436946448621
             les_mean =     503.970591069890
             stat err =       0.000587816492
             autocorr =       1.247337119327
              std dev =       0.744328830980
             le_variance =       0.554025408627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436946455768        initial  <--
     6.1035e+00     6.1035e+01             8.2369e-05       -22.436946385777
     2.4414e+01     2.4414e+02             2.0604e-05       -22.436946405866
     9.7656e+01     9.7656e+02             5.1517e-06       -22.436946448621

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2415
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239684e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600202e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383764e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830049e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004304e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2820e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.3661
    reference variance = 0.511865
====================================================
  Execution time = 4.5390e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6493e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5185e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565028107365
                                         uncertainty =       0.006252498870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565028107365
                                         uncertainty =       0.006252498870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531475279
  error estimate for blocks of size 2^( 2) =       0.000551471739
  error estimate for blocks of size 2^( 3) =       0.000569903386
  error estimate for blocks of size 2^( 4) =       0.000584309937
  error estimate for blocks of size 2^( 5) =       0.000592644915
  error estimate for blocks of size 2^( 6) =       0.000596979058
  error estimate for blocks of size 2^( 7) =       0.000602223540

      target function =                  N/A
              le_mean =     -22.435607204508
             les_mean =     503.921402295823
             stat err =       0.000594039363
             autocorr =       1.249293011530
              std dev =       0.751619546922
             le_variance =       0.564931943315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243560720451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435607204508       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435607207049       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435607202212       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435607196918       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435607220353       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435607224499       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435607226185       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435607238824       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435607236259       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435607234737       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435607232601       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 8.348271e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435607204508       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435607205145       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435607203931       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435607202594       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435607208471       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435607209505       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435607209950       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435607213102       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435607212449       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435607212085       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435607211549       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 2.087093e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435607204508       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435607204667       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435607204364       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435607204029       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435607205499       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435607205760       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435607205871       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435607206656       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435607206492       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435607206403       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435607206268       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 5.217747e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0587e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.771886e-01 1 1  ON 0
 uu_1                 1.024380e-01 1 1  ON 1
 uu_2                -1.266889e-02 1 1  ON 2
 uu_3                -8.108056e-02 1 1  ON 3
 uu_4                -1.200767e-01 1 1  ON 4
 uu_5                -1.414122e-01 1 1  ON 5
 uu_6                -1.486709e-01 1 1  ON 6
 uu_7                -1.398386e-01 1 1  ON 7
 uu_8                -1.099915e-01 1 1  ON 8
 uu_9                -3.880822e-02 1 1  ON 9
 ud_0                 4.437218e-01 1 1  ON 10
 ud_1                 1.598324e-01 1 1  ON 11
 ud_2                 1.038098e-02 1 1  ON 12
 ud_3                -7.239709e-02 1 1  ON 13
 ud_4                -1.198734e-01 1 1  ON 14
 ud_5                -1.493312e-01 1 1  ON 15
 ud_6                -1.648426e-01 1 1  ON 16
 ud_7                -1.647985e-01 1 1  ON 17
 ud_8                -1.416314e-01 1 1  ON 18
 ud_9                -8.125339e-02 1 1  ON 19
 eC_0                -5.983424e-01 1 1  ON 20
 eC_1                -4.271941e-01 1 1  ON 21
 eC_2                -1.300878e-01 1 1  ON 22
 eC_3                 7.791642e-02 1 1  ON 23
 eC_4                 2.049972e-01 1 1  ON 24
 eC_5                 3.020757e-01 1 1  ON 25
 eC_6                 2.772273e-01 1 1  ON 26
 eC_7                 2.148905e-01 1 1  ON 27
 eC_8                 6.600286e-02 1 1  ON 28
 eC_9                 1.065134e-02 1 1  ON 29
 eO_0                -1.091198e+00 1 1  ON 30
 eO_1                -7.021224e-01 1 1  ON 31
 eO_2                -2.188597e-01 1 1  ON 32
 eO_3                 9.383655e-02 1 1  ON 33
 eO_4                 3.001278e-01 1 1  ON 34
 eO_5                 4.157565e-01 1 1  ON 35
 eO_6                 4.154230e-01 1 1  ON 36
 eO_7                 3.830057e-01 1 1  ON 37
 eO_8                 2.564956e-01 1 1  ON 38
 eO_9                 1.058932e-01 1 1  ON 39
eH1_0                -1.540836e-01 1 1  ON 40
eH1_1                -5.388603e-02 1 1  ON 41
eH1_2                -3.389445e-02 1 1  ON 42
eH1_3                -3.192405e-02 1 1  ON 43
eH1_4                 6.003702e-03 1 1  ON 44
eH1_5                 1.561550e-02 1 1  ON 45
eH1_6                 4.343855e-02 1 1  ON 46
eH1_7                 4.724992e-02 1 1  ON 47
eH1_8                 5.142809e-02 1 1  ON 48
eH1_9                 7.803465e-02 1 1  ON 49
eH2_0                -1.531185e-01 1 1  ON 50
eH2_1                -5.332953e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031853e-02 1 1  ON 53
eH2_4                 7.378538e-03 1 1  ON 54
eH2_5                 1.726826e-02 1 1  ON 55
eH2_6                 4.447910e-02 1 1  ON 56
eH2_7                 4.534538e-02 1 1  ON 57
eH2_8                 4.115303e-02 1 1  ON 58
eH2_9                 7.959185e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.3614
    reference variance = 0.487616
====================================================
  Execution time = 4.5069e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6147e-01
  Total weights = 2.0000e+06
  Execution time = 3.8397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561474094592
                                         uncertainty =       0.005800220451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561474094592
                                         uncertainty =       0.005800220451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529844690
  error estimate for blocks of size 2^( 2) =       0.000549991245
  error estimate for blocks of size 2^( 3) =       0.000569006379
  error estimate for blocks of size 2^( 4) =       0.000583628278
  error estimate for blocks of size 2^( 5) =       0.000592614311
  error estimate for blocks of size 2^( 6) =       0.000598754275
  error estimate for blocks of size 2^( 7) =       0.000603042957

      target function =                  N/A
              le_mean =     -22.437330376152
             les_mean =     503.995264918837
             stat err =       0.000594509955
             autocorr =       1.258986550064
              std dev =       0.749313546496
             le_variance =       0.561470790963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561476738012
                                         uncertainty =       0.005800261161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561476738012
                                         uncertainty =       0.005800261161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529845939
  error estimate for blocks of size 2^( 2) =       0.000549992433
  error estimate for blocks of size 2^( 3) =       0.000569007485
  error estimate for blocks of size 2^( 4) =       0.000583629288
  error estimate for blocks of size 2^( 5) =       0.000592615272
  error estimate for blocks of size 2^( 6) =       0.000598755150
  error estimate for blocks of size 2^( 7) =       0.000603043875

      target function =                  N/A
              le_mean =     -22.437330342426
             les_mean =     503.995266052031
             stat err =       0.000594510896
             autocorr =       1.258984600653
              std dev =       0.749315312548
             le_variance =       0.561473437619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561475420663
                                         uncertainty =       0.005800240855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561475420663
                                         uncertainty =       0.005800240855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529845316
  error estimate for blocks of size 2^( 2) =       0.000549991841
  error estimate for blocks of size 2^( 3) =       0.000569006934
  error estimate for blocks of size 2^( 4) =       0.000583628785
  error estimate for blocks of size 2^( 5) =       0.000592614794
  error estimate for blocks of size 2^( 6) =       0.000598754714
  error estimate for blocks of size 2^( 7) =       0.000603043418

      target function =                  N/A
              le_mean =     -22.437330359172
             les_mean =     503.995265484561
             stat err =       0.000594510428
             autocorr =       1.258985573791
              std dev =       0.749314432443
             le_variance =       0.561472118667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561474260473
                                         uncertainty =       0.005800223003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561474260473
                                         uncertainty =       0.005800223003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529844768
  error estimate for blocks of size 2^( 2) =       0.000549991320
  error estimate for blocks of size 2^( 3) =       0.000569006449
  error estimate for blocks of size 2^( 4) =       0.000583628342
  error estimate for blocks of size 2^( 5) =       0.000592614372
  error estimate for blocks of size 2^( 6) =       0.000598754330
  error estimate for blocks of size 2^( 7) =       0.000603043015

      target function =                  N/A
              le_mean =     -22.437330374024
             les_mean =     503.995264989410
             stat err =       0.000594510014
             autocorr =       1.258986427987
              std dev =       0.749313657321
             le_variance =       0.561470957048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437330376152        initial  <--
     6.1035e+01     6.1035e+02             8.3483e-06       -22.437330342426
     2.4414e+02     2.4414e+03             2.0871e-06       -22.437330359172
     9.7656e+02     9.7656e+03             5.2177e-07       -22.437330374024

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3209
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239684e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600202e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383764e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830049e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004304e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2491e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2428e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.4151
    reference variance = 0.38236
====================================================
  Execution time = 4.5773e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.6533e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5644e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565080744923
                                         uncertainty =       0.006990015082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565080744923
                                         uncertainty =       0.006990015082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531663464
  error estimate for blocks of size 2^( 2) =       0.000551160830
  error estimate for blocks of size 2^( 3) =       0.000570296082
  error estimate for blocks of size 2^( 4) =       0.000583879425
  error estimate for blocks of size 2^( 5) =       0.000593872802
  error estimate for blocks of size 2^( 6) =       0.000600441776
  error estimate for blocks of size 2^( 7) =       0.000602165681

      target function =                  N/A
              le_mean =     -22.434920211278
             les_mean =     503.890976680777
             stat err =       0.000595089921
             autocorr =       1.252828305514
              std dev =       0.751885680822
             le_variance =       0.565332077025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243492021128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434920211278       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434920211728       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434920211953       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434920211331       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434920212051       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434920212966       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434920214078       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434920214002       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434920213602       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434920213634       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434920213690       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 9.504202e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434920211278       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434920211391       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434920211447       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434920211291       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434920211472       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434920211702       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434920211976       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434920211956       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434920211861       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434920211868       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434920211884       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+03 is 2.376054e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434920211278       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434920211306       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434920211320       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434920211281       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434920211326       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434920211387       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434920211458       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434920211445       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434920211402       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434920211422       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434920211442       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+03 is 5.940138e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257778 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1429e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.771888e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266907e-02 1 1  ON 2
 uu_3                -8.108010e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486705e-01 1 1  ON 6
 uu_7                -1.398381e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880759e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038080e-02 1 1  ON 12
 ud_3                -7.239688e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648425e-01 1 1  ON 16
 ud_7                -1.647987e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125253e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271923e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791652e-02 1 1  ON 23
 eC_4                 2.049977e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772270e-01 1 1  ON 26
 eC_7                 2.148891e-01 1 1  ON 27
 eC_8                 6.600210e-02 1 1  ON 28
 eC_9                 1.065120e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021214e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383751e-02 1 1  ON 33
 eO_4                 3.001280e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154235e-01 1 1  ON 36
 eO_7                 3.830051e-01 1 1  ON 37
 eO_8                 2.564938e-01 1 1  ON 38
 eO_9                 1.058921e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388550e-02 1 1  ON 41
eH1_2                -3.389458e-02 1 1  ON 42
eH1_3                -3.192415e-02 1 1  ON 43
eH1_4                 6.004301e-03 1 1  ON 44
eH1_5                 1.561576e-02 1 1  ON 45
eH1_6                 4.343746e-02 1 1  ON 46
eH1_7                 4.724983e-02 1 1  ON 47
eH1_8                 5.142849e-02 1 1  ON 48
eH1_9                 7.803437e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332956e-02 1 1  ON 51
eH2_2                -3.223584e-02 1 1  ON 52
eH2_3                -3.031813e-02 1 1  ON 53
eH2_4                 7.378498e-03 1 1  ON 54
eH2_5                 1.726842e-02 1 1  ON 55
eH2_6                 4.447948e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115293e-02 1 1  ON 58
eH2_9                 7.959145e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.3851
    reference variance = 0.617909
====================================================
  Execution time = 4.6478e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.6388e-01
  Total weights = 2.0000e+06
  Execution time = 3.8316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563965083277
                                         uncertainty =       0.004556085008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563965083277
                                         uncertainty =       0.004556085008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530979225
  error estimate for blocks of size 2^( 2) =       0.000551578598
  error estimate for blocks of size 2^( 3) =       0.000570577884
  error estimate for blocks of size 2^( 4) =       0.000584494293
  error estimate for blocks of size 2^( 5) =       0.000594456282
  error estimate for blocks of size 2^( 6) =       0.000598721404
  error estimate for blocks of size 2^( 7) =       0.000600542317

      target function =                  N/A
              le_mean =     -22.435390377728
             les_mean =     503.910618993575
             stat err =       0.000594553574
             autocorr =       1.253796143368
              std dev =       0.750918021124
             le_variance =       0.563877874449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563965348203
                                         uncertainty =       0.004556085360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563965348203
                                         uncertainty =       0.004556085360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530979349
  error estimate for blocks of size 2^( 2) =       0.000551578715
  error estimate for blocks of size 2^( 3) =       0.000570577991
  error estimate for blocks of size 2^( 4) =       0.000584494384
  error estimate for blocks of size 2^( 5) =       0.000594456372
  error estimate for blocks of size 2^( 6) =       0.000598721490
  error estimate for blocks of size 2^( 7) =       0.000600542391

      target function =                  N/A
              le_mean =     -22.435390373845
             les_mean =     503.910619084067
             stat err =       0.000594553660
             autocorr =       1.253795916087
              std dev =       0.750918197397
             le_variance =       0.563878139182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563965215712
                                         uncertainty =       0.004556085183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563965215712
                                         uncertainty =       0.004556085183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530979287
  error estimate for blocks of size 2^( 2) =       0.000551578657
  error estimate for blocks of size 2^( 3) =       0.000570577938
  error estimate for blocks of size 2^( 4) =       0.000584494338
  error estimate for blocks of size 2^( 5) =       0.000594456327
  error estimate for blocks of size 2^( 6) =       0.000598721447
  error estimate for blocks of size 2^( 7) =       0.000600542354

      target function =                  N/A
              le_mean =     -22.435390375786
             les_mean =     503.910619038738
             stat err =       0.000594553617
             autocorr =       1.253796029737
              std dev =       0.750918109242
             le_variance =       0.563878006787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563965099830
                                         uncertainty =       0.004556085030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563965099830
                                         uncertainty =       0.004556085030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530979233
  error estimate for blocks of size 2^( 2) =       0.000551578606
  error estimate for blocks of size 2^( 3) =       0.000570577891
  error estimate for blocks of size 2^( 4) =       0.000584494298
  error estimate for blocks of size 2^( 5) =       0.000594456287
  error estimate for blocks of size 2^( 6) =       0.000598721409
  error estimate for blocks of size 2^( 7) =       0.000600542321

      target function =                  N/A
              le_mean =     -22.435390377485
             les_mean =     503.910618999217
             stat err =       0.000594553579
             autocorr =       1.253796129164
              std dev =       0.750918032138
             le_variance =       0.563877890990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435390377728        initial  <--
     6.1035e+02     6.1035e+03             9.5042e-07       -22.435390373845
     2.4414e+03     2.4414e+04             2.3761e-07       -22.435390375786
     9.7656e+03     9.7656e+04             5.9401e-08       -22.435390377485

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.6567
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239684e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600202e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383764e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830049e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004304e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2709e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2426e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.3801
    reference variance = 0.363589
====================================================
  Execution time = 4.5400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6779e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5245e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567856604601
                                         uncertainty =       0.005056841209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567856604601
                                         uncertainty =       0.005056841209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532818250
  error estimate for blocks of size 2^( 2) =       0.000553156462
  error estimate for blocks of size 2^( 3) =       0.000572811246
  error estimate for blocks of size 2^( 4) =       0.000587835451
  error estimate for blocks of size 2^( 5) =       0.000598236246
  error estimate for blocks of size 2^( 6) =       0.000602196949
  error estimate for blocks of size 2^( 7) =       0.000605560156

      target function =                  N/A
              le_mean =     -22.436364864492
             les_mean =     503.958258624157
             stat err =       0.000598457201
             autocorr =       1.261560287734
              std dev =       0.753518795667
             le_variance =       0.567790575423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243636486449e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436364864492       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436364864636       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436364864752       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436364864868       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436364864869       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436364864848       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436364864797       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436364864831       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436364864836       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436364864872       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436364864853       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+03 is 8.438974e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436364864492       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436364864528       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436364864557       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436364864587       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436364864580       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436364864586       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436364864582       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436364864589       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436364864634       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436364864531       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436364864717       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+04 is 2.109742e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436364864492       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436364864501       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436364864509       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436364864516       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436364864497       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436364864515       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436364864542       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436364864490       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436364864493       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436364864474       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436364864321       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+04 is 5.274356e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0658e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880751e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648425e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389458e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004300e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378567e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447939e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.3698
    reference variance = 0.426947
====================================================
  Execution time = 4.5001e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.9165e-01
  Total weights = 2.0000e+06
  Execution time = 3.8389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591742493243
                                         uncertainty =       0.022581624458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591742493243
                                         uncertainty =       0.022581624458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543900085
  error estimate for blocks of size 2^( 2) =       0.000563864374
  error estimate for blocks of size 2^( 3) =       0.000582700970
  error estimate for blocks of size 2^( 4) =       0.000596919869
  error estimate for blocks of size 2^( 5) =       0.000606350733
  error estimate for blocks of size 2^( 6) =       0.000611870082
  error estimate for blocks of size 2^( 7) =       0.000615928842

      target function =                  N/A
              le_mean =     -22.436363747041
             les_mean =     503.982072498723
             stat err =       0.000607767382
             autocorr =       1.248637927917
              std dev =       0.769190876848
             le_variance =       0.591654605026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591742473718
                                         uncertainty =       0.022581623380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591742473718
                                         uncertainty =       0.022581623380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543900076
  error estimate for blocks of size 2^( 2) =       0.000563864366
  error estimate for blocks of size 2^( 3) =       0.000582700962
  error estimate for blocks of size 2^( 4) =       0.000596919861
  error estimate for blocks of size 2^( 5) =       0.000606350725
  error estimate for blocks of size 2^( 6) =       0.000611870075
  error estimate for blocks of size 2^( 7) =       0.000615928836

      target function =                  N/A
              le_mean =     -22.436363747004
             les_mean =     503.982072477560
             stat err =       0.000607767374
             autocorr =       1.248637938197
              std dev =       0.769190864159
             le_variance =       0.591654585506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591742483479
                                         uncertainty =       0.022581623919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591742483479
                                         uncertainty =       0.022581623919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543900081
  error estimate for blocks of size 2^( 2) =       0.000563864370
  error estimate for blocks of size 2^( 3) =       0.000582700966
  error estimate for blocks of size 2^( 4) =       0.000596919865
  error estimate for blocks of size 2^( 5) =       0.000606350729
  error estimate for blocks of size 2^( 6) =       0.000611870079
  error estimate for blocks of size 2^( 7) =       0.000615928839

      target function =                  N/A
              le_mean =     -22.436363747022
             les_mean =     503.982072488140
             stat err =       0.000607767378
             autocorr =       1.248637933053
              std dev =       0.769190870502
             le_variance =       0.591654595264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591742492022
                                         uncertainty =       0.022581624391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591742492022
                                         uncertainty =       0.022581624391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543900084
  error estimate for blocks of size 2^( 2) =       0.000563864374
  error estimate for blocks of size 2^( 3) =       0.000582700969
  error estimate for blocks of size 2^( 4) =       0.000596919868
  error estimate for blocks of size 2^( 5) =       0.000606350733
  error estimate for blocks of size 2^( 6) =       0.000611870082
  error estimate for blocks of size 2^( 7) =       0.000615928841

      target function =                  N/A
              le_mean =     -22.436363747038
             les_mean =     503.982072497400
             stat err =       0.000607767381
             autocorr =       1.248637928563
              std dev =       0.769190876054
             le_variance =       0.591654603805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436363747041        initial  <--
     6.1035e+03     6.1035e+04             8.4390e-08       -22.436363747004
     2.4414e+04     2.4414e+05             2.1097e-08       -22.436363747022
     9.7656e+04     9.7656e+05             5.2744e-09       -22.436363747038

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1327
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239684e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600202e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383764e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830049e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004304e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2480e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2423e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.4964
    reference variance = 0.341582
====================================================
  Execution time = 4.5166e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7413e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5256e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574083952680
                                         uncertainty =       0.018680326387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574083952680
                                         uncertainty =       0.018680326387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535782764
  error estimate for blocks of size 2^( 2) =       0.000555800968
  error estimate for blocks of size 2^( 3) =       0.000574693878
  error estimate for blocks of size 2^( 4) =       0.000589799499
  error estimate for blocks of size 2^( 5) =       0.000598345569
  error estimate for blocks of size 2^( 6) =       0.000603142572
  error estimate for blocks of size 2^( 7) =       0.000604933203

      target function =                  N/A
              le_mean =     -22.436494465863
             les_mean =     503.970409970231
             stat err =       0.000599055211
             autocorr =       1.250133010282
              std dev =       0.757711251467
             le_variance =       0.574126340599


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243649446586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436494465863       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436494465883       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436494465894       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436494465905       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436494465933       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436494465918       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436494465951       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436494465913       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436494465976       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436494465897       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436494465963       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+04 is 9.646596e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436494465863       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436494465868       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436494465871       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436494465873       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436494465876       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436494465794       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436494465844       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436494465915       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436494466129       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436494466323       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436494465342       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+05 is 2.411650e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436494465863       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436494465864       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436494465865       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436494465735       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436494465819       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436494465869       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436494466250       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436494466432       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436494464337       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436494460560       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436494464788       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+05 is 6.029099e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0434e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239684e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600202e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383764e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830049e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389458e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004304e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.4444
    reference variance = 0.418192
====================================================
  Execution time = 4.6869e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5512e-01
  Total weights = 2.0000e+06
  Execution time = 3.8414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555280775377
                                         uncertainty =       0.002991375335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555280775377
                                         uncertainty =       0.002991375335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526840011
  error estimate for blocks of size 2^( 2) =       0.000547656906
  error estimate for blocks of size 2^( 3) =       0.000566839621
  error estimate for blocks of size 2^( 4) =       0.000580578097
  error estimate for blocks of size 2^( 5) =       0.000590014184
  error estimate for blocks of size 2^( 6) =       0.000593898967
  error estimate for blocks of size 2^( 7) =       0.000598476161

      target function =                  N/A
              le_mean =     -22.436915854724
             les_mean =     503.970313589554
             stat err =       0.000590741853
             autocorr =       1.257297292242
              std dev =       0.745064289264
             le_variance =       0.555120795137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555280778528
                                         uncertainty =       0.002991375359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555280778528
                                         uncertainty =       0.002991375359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526840013
  error estimate for blocks of size 2^( 2) =       0.000547656908
  error estimate for blocks of size 2^( 3) =       0.000566839622
  error estimate for blocks of size 2^( 4) =       0.000580578099
  error estimate for blocks of size 2^( 5) =       0.000590014185
  error estimate for blocks of size 2^( 6) =       0.000593898968
  error estimate for blocks of size 2^( 7) =       0.000598476162

      target function =                  N/A
              le_mean =     -22.436915854700
             les_mean =     503.970313591603
             stat err =       0.000590741854
             autocorr =       1.257297289692
              std dev =       0.745064291378
             le_variance =       0.555120798286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555280776953
                                         uncertainty =       0.002991375347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555280776953
                                         uncertainty =       0.002991375347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526840012
  error estimate for blocks of size 2^( 2) =       0.000547656907
  error estimate for blocks of size 2^( 3) =       0.000566839621
  error estimate for blocks of size 2^( 4) =       0.000580578098
  error estimate for blocks of size 2^( 5) =       0.000590014185
  error estimate for blocks of size 2^( 6) =       0.000593898968
  error estimate for blocks of size 2^( 7) =       0.000598476162

      target function =                  N/A
              le_mean =     -22.436915854712
             les_mean =     503.970313590578
             stat err =       0.000590741853
             autocorr =       1.257297290963
              std dev =       0.745064290321
             le_variance =       0.555120796711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555280775574
                                         uncertainty =       0.002991375337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555280775574
                                         uncertainty =       0.002991375337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526840011
  error estimate for blocks of size 2^( 2) =       0.000547656906
  error estimate for blocks of size 2^( 3) =       0.000566839621
  error estimate for blocks of size 2^( 4) =       0.000580578097
  error estimate for blocks of size 2^( 5) =       0.000590014184
  error estimate for blocks of size 2^( 6) =       0.000593898967
  error estimate for blocks of size 2^( 7) =       0.000598476161

      target function =                  N/A
              le_mean =     -22.436915854723
             les_mean =     503.970313589682
             stat err =       0.000590741853
             autocorr =       1.257297292081
              std dev =       0.745064289396
             le_variance =       0.555120795334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436915854724        initial  <--
     6.1035e+04     6.1035e+05             9.6466e-09       -22.436915854700
     2.4414e+05     2.4414e+06             2.4117e-09       -22.436915854712
     9.7656e+05     9.7656e+06             6.0291e-10       -22.436915854723

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.0935
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239684e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600202e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383764e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830049e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004304e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2653e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2426e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.449
    reference variance = 0.455685
====================================================
  Execution time = 4.6874e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5937e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5358e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557539792607
                                         uncertainty =       0.003935220716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557539792607
                                         uncertainty =       0.003935220716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528851789
  error estimate for blocks of size 2^( 2) =       0.000549220771
  error estimate for blocks of size 2^( 3) =       0.000567422520
  error estimate for blocks of size 2^( 4) =       0.000582185868
  error estimate for blocks of size 2^( 5) =       0.000590237297
  error estimate for blocks of size 2^( 6) =       0.000595735560
  error estimate for blocks of size 2^( 7) =       0.000597544388

      target function =                  N/A
              le_mean =     -22.436268893541
             les_mean =     503.945530012754
             stat err =       0.000591425778
             autocorr =       1.250640662446
              std dev =       0.747909372298
             le_variance =       0.559368429171


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243626889354e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436268893541       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436268893541       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436268893542       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436268893542       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436268893629       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436268893623       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436268892844       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436268893934       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436268892744       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436268895557       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436268891652       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+05 is 8.460148e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436268893541       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436268893541       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436268893541       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436268893541       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436268892901       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436268893544       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436268895019       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436268893147       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436268893745       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436268891668       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436268892246       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+06 is 2.115045e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436268893541       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436268893541       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436268893541       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436268896594       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436268891510       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436268895760       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436268885018       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436268890232       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436268899099       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436268927302       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436268855979       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+06 is 5.287671e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270818 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2244e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239684e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600202e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383764e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830049e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004304e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4879
    reference variance = 0.511538
====================================================
  Execution time = 4.5359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.6279e-01
  Total weights = 2.0000e+06
  Execution time = 3.8297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562851855452
                                         uncertainty =       0.008047149013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562851855452
                                         uncertainty =       0.008047149013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530467763
  error estimate for blocks of size 2^( 2) =       0.000550766249
  error estimate for blocks of size 2^( 3) =       0.000569959334
  error estimate for blocks of size 2^( 4) =       0.000584718875
  error estimate for blocks of size 2^( 5) =       0.000593907429
  error estimate for blocks of size 2^( 6) =       0.000600875562
  error estimate for blocks of size 2^( 7) =       0.000601374214

      target function =                  N/A
              le_mean =     -22.435150455944
             les_mean =     503.898767795044
             stat err =       0.000595219020
             autocorr =       1.259028635649
              std dev =       0.750194705127
             le_variance =       0.562792095601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562851855551
                                         uncertainty =       0.008047149005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562851855551
                                         uncertainty =       0.008047149005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530467763
  error estimate for blocks of size 2^( 2) =       0.000550766249
  error estimate for blocks of size 2^( 3) =       0.000569959334
  error estimate for blocks of size 2^( 4) =       0.000584718876
  error estimate for blocks of size 2^( 5) =       0.000593907429
  error estimate for blocks of size 2^( 6) =       0.000600875562
  error estimate for blocks of size 2^( 7) =       0.000601374214

      target function =                  N/A
              le_mean =     -22.435150455945
             les_mean =     503.898767795193
             stat err =       0.000595219020
             autocorr =       1.259028635487
              std dev =       0.750194705193
             le_variance =       0.562792095700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562851855502
                                         uncertainty =       0.008047149009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562851855502
                                         uncertainty =       0.008047149009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530467763
  error estimate for blocks of size 2^( 2) =       0.000550766249
  error estimate for blocks of size 2^( 3) =       0.000569959334
  error estimate for blocks of size 2^( 4) =       0.000584718875
  error estimate for blocks of size 2^( 5) =       0.000593907429
  error estimate for blocks of size 2^( 6) =       0.000600875562
  error estimate for blocks of size 2^( 7) =       0.000601374214

      target function =                  N/A
              le_mean =     -22.435150455944
             les_mean =     503.898767795118
             stat err =       0.000595219020
             autocorr =       1.259028635568
              std dev =       0.750194705160
             le_variance =       0.562792095651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562851855459
                                         uncertainty =       0.008047149012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562851855459
                                         uncertainty =       0.008047149012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530467763
  error estimate for blocks of size 2^( 2) =       0.000550766249
  error estimate for blocks of size 2^( 3) =       0.000569959334
  error estimate for blocks of size 2^( 4) =       0.000584718875
  error estimate for blocks of size 2^( 5) =       0.000593907429
  error estimate for blocks of size 2^( 6) =       0.000600875562
  error estimate for blocks of size 2^( 7) =       0.000601374214

      target function =                  N/A
              le_mean =     -22.435150455944
             les_mean =     503.898767795053
             stat err =       0.000595219020
             autocorr =       1.259028635640
              std dev =       0.750194705132
             le_variance =       0.562792095608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435150455944        initial
     6.1035e+05     6.1035e+06             8.4601e-10       -22.435150455945  <--
     2.4414e+06     2.4414e+07             2.1150e-10       -22.435150455944
     9.7656e+06     9.7656e+07             5.2877e-11       -22.435150455944

*****************************************************************************
Applying the update for shift_i =   6.1035e+05     and shift_s =   6.1035e+06
*****************************************************************************

  Execution time = 6.4555e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239684e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600202e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383764e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830049e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004304e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2681e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2428e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.4747
    reference variance = 0.394708
====================================================
  Execution time = 4.5154e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7337e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5331e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573489686299
                                         uncertainty =       0.010299913313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573489686299
                                         uncertainty =       0.010299913313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535429961
  error estimate for blocks of size 2^( 2) =       0.000555483388
  error estimate for blocks of size 2^( 3) =       0.000573954226
  error estimate for blocks of size 2^( 4) =       0.000587875580
  error estimate for blocks of size 2^( 5) =       0.000596507007
  error estimate for blocks of size 2^( 6) =       0.000599499742
  error estimate for blocks of size 2^( 7) =       0.000603882095

      target function =                  N/A
              le_mean =     -22.436346626876
             les_mean =     503.963020161260
             stat err =       0.000596941106
             autocorr =       1.242961374126
              std dev =       0.757212312785
             le_variance =       0.573370486634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243634662688e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436346626876       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436346626880       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436346626884       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436346626892       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436346626915       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436346626927       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436346626920       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436346626806       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436346626558       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436346626386       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436346626795       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+05 is 3.537411e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436346626876       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436346626877       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436346626878       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436346626608       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436346626546       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436346626883       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436346626471       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436346625873       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436346625357       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436346628404       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436346622896       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+05 is 8.843546e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436346626876       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436346626876       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436346626876       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436346626877       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436346626919       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436346627021       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436346626883       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436346627012       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436346629640       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436346636746       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436346613293       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+06 is 2.210921e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275187 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0498e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239684e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600202e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383764e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830049e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389458e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004304e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.336
    reference variance = 0.364833
====================================================
  Execution time = 4.4615e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6272e-01
  Total weights = 2.0000e+06
  Execution time = 3.8368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562584544135
                                         uncertainty =       0.005223222042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562584544135
                                         uncertainty =       0.005223222042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530435921
  error estimate for blocks of size 2^( 2) =       0.000550626809
  error estimate for blocks of size 2^( 3) =       0.000569155633
  error estimate for blocks of size 2^( 4) =       0.000583411237
  error estimate for blocks of size 2^( 5) =       0.000591170737
  error estimate for blocks of size 2^( 6) =       0.000595757069
  error estimate for blocks of size 2^( 7) =       0.000600161132

      target function =                  N/A
              le_mean =     -22.435904120394
             les_mean =     503.932517951249
             stat err =       0.000592625044
             autocorr =       1.248228651130
              std dev =       0.750149673798
             le_variance =       0.562724533100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562584545240
                                         uncertainty =       0.005223222047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562584545240
                                         uncertainty =       0.005223222047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530435922
  error estimate for blocks of size 2^( 2) =       0.000550626810
  error estimate for blocks of size 2^( 3) =       0.000569155633
  error estimate for blocks of size 2^( 4) =       0.000583411237
  error estimate for blocks of size 2^( 5) =       0.000591170737
  error estimate for blocks of size 2^( 6) =       0.000595757070
  error estimate for blocks of size 2^( 7) =       0.000600161133

      target function =                  N/A
              le_mean =     -22.435904120400
             les_mean =     503.932517952635
             stat err =       0.000592625044
             autocorr =       1.248228650434
              std dev =       0.750149674535
             le_variance =       0.562724534205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562584544688
                                         uncertainty =       0.005223222044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562584544688
                                         uncertainty =       0.005223222044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530435922
  error estimate for blocks of size 2^( 2) =       0.000550626809
  error estimate for blocks of size 2^( 3) =       0.000569155633
  error estimate for blocks of size 2^( 4) =       0.000583411237
  error estimate for blocks of size 2^( 5) =       0.000591170737
  error estimate for blocks of size 2^( 6) =       0.000595757069
  error estimate for blocks of size 2^( 7) =       0.000600161133

      target function =                  N/A
              le_mean =     -22.435904120397
             les_mean =     503.932517951942
             stat err =       0.000592625044
             autocorr =       1.248228650778
              std dev =       0.750149674167
             le_variance =       0.562724533652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562584544204
                                         uncertainty =       0.005223222042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562584544204
                                         uncertainty =       0.005223222042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530435921
  error estimate for blocks of size 2^( 2) =       0.000550626809
  error estimate for blocks of size 2^( 3) =       0.000569155633
  error estimate for blocks of size 2^( 4) =       0.000583411237
  error estimate for blocks of size 2^( 5) =       0.000591170737
  error estimate for blocks of size 2^( 6) =       0.000595757069
  error estimate for blocks of size 2^( 7) =       0.000600161132

      target function =                  N/A
              le_mean =     -22.435904120394
             les_mean =     503.932517951336
             stat err =       0.000592625044
             autocorr =       1.248228651078
              std dev =       0.750149673844
             le_variance =       0.562724533169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435904120394        initial
     1.5259e+05     1.5259e+06             3.5374e-09       -22.435904120400  <--
     6.1035e+05     6.1035e+06             8.8435e-10       -22.435904120397
     2.4414e+06     2.4414e+07             2.2109e-10       -22.435904120394

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 6.3846e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239684e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830049e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389458e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004303e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2435e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2427e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.5384
    reference variance = 0.524321
====================================================
  Execution time = 4.7442e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7872e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5657e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578804984962
                                         uncertainty =       0.015453178759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578804984962
                                         uncertainty =       0.015453178759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537922776
  error estimate for blocks of size 2^( 2) =       0.000558387073
  error estimate for blocks of size 2^( 3) =       0.000576803861
  error estimate for blocks of size 2^( 4) =       0.000590934733
  error estimate for blocks of size 2^( 5) =       0.000601701640
  error estimate for blocks of size 2^( 6) =       0.000608023414
  error estimate for blocks of size 2^( 7) =       0.000608537565

      target function =                  N/A
              le_mean =     -22.436909246590
             les_mean =     503.993618076730
             stat err =       0.000602299338
             autocorr =       1.253674825257
              std dev =       0.760737685653
             le_variance =       0.578721826373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243690924659e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436909246590       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436909246602       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436909246605       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436909246581       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436909246646       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436909246631       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436909246654       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436909246603       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436909246696       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436909246659       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436909246586       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+04 is 1.426578e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436909246590       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436909246593       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436909246594       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436909246521       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436909246588       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436909246517       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436909246643       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436909246695       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436909246511       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436909246979       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436909246582       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+05 is 3.566447e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436909246590       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436909246591       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436909246591       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436909246591       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436909246594       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436909246238       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436909246603       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436909246599       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436909244824       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436909243342       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436909248648       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+05 is 8.916087e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279534 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3111e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125247e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004302e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343736e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142856e-02 1 1  ON 48
eH1_9                 7.803432e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378565e-03 1 1  ON 54
eH2_5                 1.726847e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534539e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.4523
    reference variance = 0.314942
====================================================
  Execution time = 4.5574e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5180e-01
  Total weights = 2.0000e+06
  Execution time = 3.8532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551636153474
                                         uncertainty =       0.002912918631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551636153474
                                         uncertainty =       0.002912918631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525263830
  error estimate for blocks of size 2^( 2) =       0.000545305797
  error estimate for blocks of size 2^( 3) =       0.000564438712
  error estimate for blocks of size 2^( 4) =       0.000578460392
  error estimate for blocks of size 2^( 5) =       0.000587744089
  error estimate for blocks of size 2^( 6) =       0.000592564276
  error estimate for blocks of size 2^( 7) =       0.000595397571

      target function =                  N/A
              le_mean =     -22.436551363387
             les_mean =     503.950640987699
             stat err =       0.000588541582
             autocorr =       1.255449686943
              std dev =       0.742835231860
             le_variance =       0.551804181692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551636159638
                                         uncertainty =       0.002912918664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551636159638
                                         uncertainty =       0.002912918664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525263833
  error estimate for blocks of size 2^( 2) =       0.000545305800
  error estimate for blocks of size 2^( 3) =       0.000564438715
  error estimate for blocks of size 2^( 4) =       0.000578460394
  error estimate for blocks of size 2^( 5) =       0.000587744091
  error estimate for blocks of size 2^( 6) =       0.000592564279
  error estimate for blocks of size 2^( 7) =       0.000595397572

      target function =                  N/A
              le_mean =     -22.436551363442
             les_mean =     503.950640996319
             stat err =       0.000588541584
             autocorr =       1.255449682163
              std dev =       0.742835236016
             le_variance =       0.551804187867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551636156556
                                         uncertainty =       0.002912918648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551636156556
                                         uncertainty =       0.002912918648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525263831
  error estimate for blocks of size 2^( 2) =       0.000545305798
  error estimate for blocks of size 2^( 3) =       0.000564438714
  error estimate for blocks of size 2^( 4) =       0.000578460393
  error estimate for blocks of size 2^( 5) =       0.000587744090
  error estimate for blocks of size 2^( 6) =       0.000592564278
  error estimate for blocks of size 2^( 7) =       0.000595397572

      target function =                  N/A
              le_mean =     -22.436551363414
             les_mean =     503.950640992009
             stat err =       0.000588541583
             autocorr =       1.255449684554
              std dev =       0.742835233938
             le_variance =       0.551804184780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551636153859
                                         uncertainty =       0.002912918633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551636153859
                                         uncertainty =       0.002912918633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525263830
  error estimate for blocks of size 2^( 2) =       0.000545305797
  error estimate for blocks of size 2^( 3) =       0.000564438713
  error estimate for blocks of size 2^( 4) =       0.000578460392
  error estimate for blocks of size 2^( 5) =       0.000587744089
  error estimate for blocks of size 2^( 6) =       0.000592564277
  error estimate for blocks of size 2^( 7) =       0.000595397571

      target function =                  N/A
              le_mean =     -22.436551363391
             les_mean =     503.950640988238
             stat err =       0.000588541582
             autocorr =       1.255449686648
              std dev =       0.742835232120
             le_variance =       0.551804182078


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436551363387        initial
     3.8147e+04     3.8147e+05             1.4266e-08       -22.436551363442  <--
     1.5259e+05     1.5259e+06             3.5664e-09       -22.436551363414
     6.1035e+05     6.1035e+06             8.9161e-10       -22.436551363391

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 6.4876e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004299e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2800e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2431e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.3867
    reference variance = 0.680766
====================================================
  Execution time = 4.5870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5610e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5405e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556202226992
                                         uncertainty =       0.004158760673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556202226992
                                         uncertainty =       0.004158760673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527303482
  error estimate for blocks of size 2^( 2) =       0.000547591295
  error estimate for blocks of size 2^( 3) =       0.000566932732
  error estimate for blocks of size 2^( 4) =       0.000581687550
  error estimate for blocks of size 2^( 5) =       0.000591094365
  error estimate for blocks of size 2^( 6) =       0.000596435087
  error estimate for blocks of size 2^( 7) =       0.000595990760

      target function =                  N/A
              le_mean =     -22.435989656052
             les_mean =     503.929729492415
             stat err =       0.000591301940
             autocorr =       1.257469123858
              std dev =       0.745719735550
             le_variance =       0.556097923988


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243598965605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435989656052       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435989656243       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435989656335       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435989656559       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435989656608       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435989656663       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435989656526       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435989656480       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435989656540       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435989656504       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435989656583       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+03 is 5.987263e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435989656052       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435989656100       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435989656123       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435989656179       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435989656193       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435989656254       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435989656180       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435989656187       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435989656196       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435989656185       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435989656122       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+04 is 1.496816e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435989656052       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435989656064       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435989656070       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435989656084       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435989656163       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435989656073       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435989655994       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435989656181       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435989656102       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435989655951       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435989656009       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+05 is 3.742041e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283904 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1288e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880751e-02 1 1  ON 9
 ud_0                 4.437214e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648425e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600204e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021214e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383762e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004294e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332955e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378562e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959144e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.4056
    reference variance = 0.534798
====================================================
  Execution time = 4.4743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6479e-01
  Total weights = 2.0000e+06
  Execution time = 3.8382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564657416313
                                         uncertainty =       0.007579863734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564657416313
                                         uncertainty =       0.007579863734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531407206
  error estimate for blocks of size 2^( 2) =       0.000552177844
  error estimate for blocks of size 2^( 3) =       0.000571357935
  error estimate for blocks of size 2^( 4) =       0.000586169051
  error estimate for blocks of size 2^( 5) =       0.000596740020
  error estimate for blocks of size 2^( 6) =       0.000601442971
  error estimate for blocks of size 2^( 7) =       0.000601924665

      target function =                  N/A
              le_mean =     -22.435539019504
             les_mean =     503.918198051187
             stat err =       0.000596569177
             autocorr =       1.260279123894
              std dev =       0.751523278335
             le_variance =       0.564787237879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564657442412
                                         uncertainty =       0.007579863057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564657442412
                                         uncertainty =       0.007579863057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531407219
  error estimate for blocks of size 2^( 2) =       0.000552177856
  error estimate for blocks of size 2^( 3) =       0.000571357946
  error estimate for blocks of size 2^( 4) =       0.000586169061
  error estimate for blocks of size 2^( 5) =       0.000596740029
  error estimate for blocks of size 2^( 6) =       0.000601442980
  error estimate for blocks of size 2^( 7) =       0.000601924674

      target function =                  N/A
              le_mean =     -22.435539019502
             les_mean =     503.918198077203
             stat err =       0.000596569186
             autocorr =       1.260279104836
              std dev =       0.751523295701
             le_variance =       0.564787263982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564657429363
                                         uncertainty =       0.007579863395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564657429363
                                         uncertainty =       0.007579863395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531407212
  error estimate for blocks of size 2^( 2) =       0.000552177850
  error estimate for blocks of size 2^( 3) =       0.000571357940
  error estimate for blocks of size 2^( 4) =       0.000586169056
  error estimate for blocks of size 2^( 5) =       0.000596740025
  error estimate for blocks of size 2^( 6) =       0.000601442976
  error estimate for blocks of size 2^( 7) =       0.000601924669

      target function =                  N/A
              le_mean =     -22.435539019503
             les_mean =     503.918198064195
             stat err =       0.000596569181
             autocorr =       1.260279114367
              std dev =       0.751523287018
             le_variance =       0.564787250931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564657417944
                                         uncertainty =       0.007579863691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564657417944
                                         uncertainty =       0.007579863691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531407207
  error estimate for blocks of size 2^( 2) =       0.000552177845
  error estimate for blocks of size 2^( 3) =       0.000571357936
  error estimate for blocks of size 2^( 4) =       0.000586169051
  error estimate for blocks of size 2^( 5) =       0.000596740021
  error estimate for blocks of size 2^( 6) =       0.000601442972
  error estimate for blocks of size 2^( 7) =       0.000601924666

      target function =                  N/A
              le_mean =     -22.435539019504
             les_mean =     503.918198052813
             stat err =       0.000596569177
             autocorr =       1.260279122700
              std dev =       0.751523279421
             le_variance =       0.564787239511


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435539019504        initial  <--
     9.5367e+03     9.5367e+04             5.9873e-08       -22.435539019502
     3.8147e+04     3.8147e+05             1.4968e-08       -22.435539019503
     1.5259e+05     1.5259e+06             3.7420e-09       -22.435539019504

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9657
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004299e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2526e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2429e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4905
    reference variance = 0.274786
====================================================
  Execution time = 4.5690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 6.1562e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5220e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.615726661005
                                         uncertainty =       0.052010923011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.615726661005
                                         uncertainty =       0.052010923011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000554804162
  error estimate for blocks of size 2^( 2) =       0.000574404894
  error estimate for blocks of size 2^( 3) =       0.000593148513
  error estimate for blocks of size 2^( 4) =       0.000606524829
  error estimate for blocks of size 2^( 5) =       0.000615035105
  error estimate for blocks of size 2^( 6) =       0.000620824404
  error estimate for blocks of size 2^( 7) =       0.000624998259

      target function =                  N/A
              le_mean =     -22.435913171378
             les_mean =     503.985814843099
             stat err =       0.000616845649
             autocorr =       1.236156879338
              std dev =       0.784611570957
             le_variance =       0.615615317280


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243591317138e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435913171378       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435913171387       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435913171391       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435913171396       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435913171436       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435913171415       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435913171407       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435913171312       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435913171366       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435913171390       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435913171824       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+04 is 5.891287e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435913171378       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435913171380       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435913171381       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435913171383       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435913171571       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435913171473       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435913171434       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435913172310       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435913171278       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435913170752       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435913171631       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+05 is 1.472821e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435913171378       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435913171379       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435913171379       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435913171379       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435913171488       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435913171517       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435913170979       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435913174033       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435913172187       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435913173605       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435913169875       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+06 is 3.682076e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288225 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0922e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648425e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4259
    reference variance = 0.562143
====================================================
  Execution time = 4.9206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6606e-01
  Total weights = 2.0000e+06
  Execution time = 3.8588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566082365890
                                         uncertainty =       0.008202598041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566082365890
                                         uncertainty =       0.008202598041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532006369
  error estimate for blocks of size 2^( 2) =       0.000552506374
  error estimate for blocks of size 2^( 3) =       0.000570926815
  error estimate for blocks of size 2^( 4) =       0.000585556967
  error estimate for blocks of size 2^( 5) =       0.000594890948
  error estimate for blocks of size 2^( 6) =       0.000599673587
  error estimate for blocks of size 2^( 7) =       0.000601841172

      target function =                  N/A
              le_mean =     -22.436922797639
             les_mean =     503.981565898186
             stat err =       0.000595490668
             autocorr =       1.252899560660
              std dev =       0.752370622771
             le_variance =       0.566061554009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566082369578
                                         uncertainty =       0.008202598086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566082369578
                                         uncertainty =       0.008202598086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532006371
  error estimate for blocks of size 2^( 2) =       0.000552506376
  error estimate for blocks of size 2^( 3) =       0.000570926817
  error estimate for blocks of size 2^( 4) =       0.000585556968
  error estimate for blocks of size 2^( 5) =       0.000594890949
  error estimate for blocks of size 2^( 6) =       0.000599673588
  error estimate for blocks of size 2^( 7) =       0.000601841174

      target function =                  N/A
              le_mean =     -22.436922797634
             les_mean =     503.981565901664
             stat err =       0.000595490670
             autocorr =       1.252899558529
              std dev =       0.752370625221
             le_variance =       0.566061557696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566082367734
                                         uncertainty =       0.008202598064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566082367734
                                         uncertainty =       0.008202598064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532006370
  error estimate for blocks of size 2^( 2) =       0.000552506375
  error estimate for blocks of size 2^( 3) =       0.000570926816
  error estimate for blocks of size 2^( 4) =       0.000585556968
  error estimate for blocks of size 2^( 5) =       0.000594890949
  error estimate for blocks of size 2^( 6) =       0.000599673587
  error estimate for blocks of size 2^( 7) =       0.000601841173

      target function =                  N/A
              le_mean =     -22.436922797637
             les_mean =     503.981565899925
             stat err =       0.000595490669
             autocorr =       1.252899559595
              std dev =       0.752370623996
             le_variance =       0.566061555852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566082366120
                                         uncertainty =       0.008202598044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566082366120
                                         uncertainty =       0.008202598044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532006369
  error estimate for blocks of size 2^( 2) =       0.000552506374
  error estimate for blocks of size 2^( 3) =       0.000570926815
  error estimate for blocks of size 2^( 4) =       0.000585556967
  error estimate for blocks of size 2^( 5) =       0.000594890948
  error estimate for blocks of size 2^( 6) =       0.000599673587
  error estimate for blocks of size 2^( 7) =       0.000601841172

      target function =                  N/A
              le_mean =     -22.436922797639
             les_mean =     503.981565898403
             stat err =       0.000595490668
             autocorr =       1.252899560532
              std dev =       0.752370622924
             le_variance =       0.566061554239


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436922797639        initial  <--
     9.5367e+04     9.5367e+05             5.8913e-09       -22.436922797634
     3.8147e+05     3.8147e+06             1.4728e-09       -22.436922797637
     1.5259e+06     1.5259e+07             3.6821e-10       -22.436922797639

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.5356
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004299e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2947e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2430e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.4299
    reference variance = 1.05899
====================================================
  Execution time = 4.5312e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6065e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5247e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560627013951
                                         uncertainty =       0.006724707523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560627013951
                                         uncertainty =       0.006724707523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529458673
  error estimate for blocks of size 2^( 2) =       0.000549609809
  error estimate for blocks of size 2^( 3) =       0.000568517687
  error estimate for blocks of size 2^( 4) =       0.000583678966
  error estimate for blocks of size 2^( 5) =       0.000592382839
  error estimate for blocks of size 2^( 6) =       0.000600415585
  error estimate for blocks of size 2^( 7) =       0.000603636456

      target function =                  N/A
              le_mean =     -22.437269374112
             les_mean =     503.991709659586
             stat err =       0.000595028462
             autocorr =       1.263023250123
              std dev =       0.748767636498
             le_variance =       0.560652973467


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243726937411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437269374112       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437269374111       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437269374112       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437269374094       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437269373358       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437269374172       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437269373877       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437269373709       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437269370466       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437269372156       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437269372428       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+05 is 6.046967e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437269374112       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437269374112       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437269374112       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437269373949       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437269374058       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437269370856       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437269373334       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437269373408       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437269374499       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437269377088       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437269373456       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+06 is 1.511756e-10

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437269374112       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437269374112       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437269374112       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437269374112       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437269374763       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437269375354       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437269378787       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437269412024       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437269320268       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437269346724       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437269364955       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+07 is 3.779351e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292533 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0571e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004299e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.721
    reference variance = 3.29179
====================================================
  Execution time = 4.4617e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5632e-01
  Total weights = 2.0000e+06
  Execution time = 3.8398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555885831745
                                         uncertainty =       0.003730291296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555885831745
                                         uncertainty =       0.003730291296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527410433
  error estimate for blocks of size 2^( 2) =       0.000547467704
  error estimate for blocks of size 2^( 3) =       0.000566132893
  error estimate for blocks of size 2^( 4) =       0.000581532462
  error estimate for blocks of size 2^( 5) =       0.000590869909
  error estimate for blocks of size 2^( 6) =       0.000595463534
  error estimate for blocks of size 2^( 7) =       0.000599567549

      target function =                  N/A
              le_mean =     -22.435858928571
             les_mean =     503.924089114023
             stat err =       0.000591858363
             autocorr =       1.259325927403
              std dev =       0.745870987120
             le_variance =       0.556323529428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555885831758
                                         uncertainty =       0.003730291297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555885831758
                                         uncertainty =       0.003730291297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527410433
  error estimate for blocks of size 2^( 2) =       0.000547467704
  error estimate for blocks of size 2^( 3) =       0.000566132893
  error estimate for blocks of size 2^( 4) =       0.000581532462
  error estimate for blocks of size 2^( 5) =       0.000590869909
  error estimate for blocks of size 2^( 6) =       0.000595463534
  error estimate for blocks of size 2^( 7) =       0.000599567549

      target function =                  N/A
              le_mean =     -22.435858928571
             les_mean =     503.924089114015
             stat err =       0.000591858363
             autocorr =       1.259325927378
              std dev =       0.745870987129
             le_variance =       0.556323529441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555885831751
                                         uncertainty =       0.003730291296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555885831751
                                         uncertainty =       0.003730291296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527410433
  error estimate for blocks of size 2^( 2) =       0.000547467704
  error estimate for blocks of size 2^( 3) =       0.000566132893
  error estimate for blocks of size 2^( 4) =       0.000581532462
  error estimate for blocks of size 2^( 5) =       0.000590869909
  error estimate for blocks of size 2^( 6) =       0.000595463534
  error estimate for blocks of size 2^( 7) =       0.000599567549

      target function =                  N/A
              le_mean =     -22.435858928571
             les_mean =     503.924089114019
             stat err =       0.000591858363
             autocorr =       1.259325927397
              std dev =       0.745870987125
             le_variance =       0.556323529434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555885831746
                                         uncertainty =       0.003730291296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555885831746
                                         uncertainty =       0.003730291296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527410433
  error estimate for blocks of size 2^( 2) =       0.000547467704
  error estimate for blocks of size 2^( 3) =       0.000566132893
  error estimate for blocks of size 2^( 4) =       0.000581532462
  error estimate for blocks of size 2^( 5) =       0.000590869909
  error estimate for blocks of size 2^( 6) =       0.000595463534
  error estimate for blocks of size 2^( 7) =       0.000599567549

      target function =                  N/A
              le_mean =     -22.435858928571
             les_mean =     503.924089114022
             stat err =       0.000591858363
             autocorr =       1.259325927396
              std dev =       0.745870987121
             le_variance =       0.556323529429


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435858928571        initial  <--
     9.5367e+05     9.5367e+06             6.0470e-10       -22.435858928571
     3.8147e+06     3.8147e+07             1.5118e-10       -22.435858928571
     1.5259e+07     1.5259e+08             3.7794e-11       -22.435858928571

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8559
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004299e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2444e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2437e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.4108
    reference variance = 0.331529
====================================================
  Execution time = 4.5266e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6603e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5158e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566118739883
                                         uncertainty =       0.006225264428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566118739883
                                         uncertainty =       0.006225264428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531991709
  error estimate for blocks of size 2^( 2) =       0.000552105121
  error estimate for blocks of size 2^( 3) =       0.000570696699
  error estimate for blocks of size 2^( 4) =       0.000583997778
  error estimate for blocks of size 2^( 5) =       0.000594105900
  error estimate for blocks of size 2^( 6) =       0.000598265175
  error estimate for blocks of size 2^( 7) =       0.000601159471

      target function =                  N/A
              le_mean =     -22.436130755248
             les_mean =     503.945993340681
             stat err =       0.000594382081
             autocorr =       1.248307811625
              std dev =       0.752349890084
             le_variance =       0.566030357109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243613075525e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436130755248       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436130755248       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436130755248       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436130755248       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436130756715       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436130757111       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436130761431       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436130772611       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436130753213       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436130741945       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436130756383       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+06 is 5.400391e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436130755248       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436130755248       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436130755248       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436130755248       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436130770812       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436130776982       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436130735072       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436130745866       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436130590607       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436130795734       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436130713001       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+07 is 1.349971e-11

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436130755248       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436130755248       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436130755248       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436130785465       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436130762361       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436130740537       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436130743100       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436130697821       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436130923555       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436131456266       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436130604388       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+08 is 3.376571e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0436e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004299e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.4803
    reference variance = 0.349464
====================================================
  Execution time = 4.4982e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6378e-01
  Total weights = 2.0000e+06
  Execution time = 3.8427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563783987636
                                         uncertainty =       0.006027102111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563783987636
                                         uncertainty =       0.006027102111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530932476
  error estimate for blocks of size 2^( 2) =       0.000551230397
  error estimate for blocks of size 2^( 3) =       0.000569680294
  error estimate for blocks of size 2^( 4) =       0.000584832561
  error estimate for blocks of size 2^( 5) =       0.000593622603
  error estimate for blocks of size 2^( 6) =       0.000599851117
  error estimate for blocks of size 2^( 7) =       0.000600306186

      target function =                  N/A
              le_mean =     -22.436468107846
             les_mean =     503.958879460046
             stat err =       0.000594653117
             autocorr =       1.254436890861
              std dev =       0.750851907868
             le_variance =       0.563778587550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563783987638
                                         uncertainty =       0.006027102111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563783987638
                                         uncertainty =       0.006027102111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530932476
  error estimate for blocks of size 2^( 2) =       0.000551230397
  error estimate for blocks of size 2^( 3) =       0.000569680294
  error estimate for blocks of size 2^( 4) =       0.000584832561
  error estimate for blocks of size 2^( 5) =       0.000593622603
  error estimate for blocks of size 2^( 6) =       0.000599851117
  error estimate for blocks of size 2^( 7) =       0.000600306186

      target function =                  N/A
              le_mean =     -22.436468107846
             les_mean =     503.958879460054
             stat err =       0.000594653117
             autocorr =       1.254436890854
              std dev =       0.750851907870
             le_variance =       0.563778587551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563783987637
                                         uncertainty =       0.006027102111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563783987637
                                         uncertainty =       0.006027102111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530932476
  error estimate for blocks of size 2^( 2) =       0.000551230397
  error estimate for blocks of size 2^( 3) =       0.000569680294
  error estimate for blocks of size 2^( 4) =       0.000584832561
  error estimate for blocks of size 2^( 5) =       0.000593622603
  error estimate for blocks of size 2^( 6) =       0.000599851117
  error estimate for blocks of size 2^( 7) =       0.000600306186

      target function =                  N/A
              le_mean =     -22.436468107846
             les_mean =     503.958879460050
             stat err =       0.000594653117
             autocorr =       1.254436890856
              std dev =       0.750851907869
             le_variance =       0.563778587551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563783987636
                                         uncertainty =       0.006027102111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563783987636
                                         uncertainty =       0.006027102111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530932476
  error estimate for blocks of size 2^( 2) =       0.000551230397
  error estimate for blocks of size 2^( 3) =       0.000569680294
  error estimate for blocks of size 2^( 4) =       0.000584832561
  error estimate for blocks of size 2^( 5) =       0.000593622603
  error estimate for blocks of size 2^( 6) =       0.000599851117
  error estimate for blocks of size 2^( 7) =       0.000600306186

      target function =                  N/A
              le_mean =     -22.436468107846
             les_mean =     503.958879460046
             stat err =       0.000594653117
             autocorr =       1.254436890863
              std dev =       0.750851907869
             le_variance =       0.563778587550


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436468107846        initial
     9.5367e+06     9.5367e+07             5.4004e-11       -22.436468107846  <--
     3.8147e+07     3.8147e+08             1.3500e-11       -22.436468107846
     1.5259e+08     1.5259e+09             3.3766e-12       -22.436468107846

*****************************************************************************
Applying the update for shift_i =   9.5367e+06     and shift_s =   9.5367e+07
*****************************************************************************

  Execution time = 6.5572e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004299e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2603e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2437e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.3398
    reference variance = 0.351944
====================================================
  Execution time = 4.7615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.5478e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5093e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554817148102
                                         uncertainty =       0.003651996351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554817148102
                                         uncertainty =       0.003651996351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526677326
  error estimate for blocks of size 2^( 2) =       0.000547335010
  error estimate for blocks of size 2^( 3) =       0.000566370853
  error estimate for blocks of size 2^( 4) =       0.000580894271
  error estimate for blocks of size 2^( 5) =       0.000590662349
  error estimate for blocks of size 2^( 6) =       0.000598517956
  error estimate for blocks of size 2^( 7) =       0.000598192894

      target function =                  N/A
              le_mean =     -22.434912058538
             les_mean =     503.880056808648
             stat err =       0.000592066867
             autocorr =       1.263724113417
              std dev =       0.744834217599
             le_variance =       0.554778011706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243491205854e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434912058538       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434912058538       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434912058539       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434912056928       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434912058403       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434912059573       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434912058861       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434912055434       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434912053268       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434912058875       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434912068877       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+06 is 2.226393e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434912058538       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434912058538       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434912058538       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434912058538       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434912056549       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434912057444       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434912062719       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434912052357       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434912055821       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434912055777       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434912085582       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+06 is 5.565932e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434912058538       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434912058538       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434912058538       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434912058538       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434912044705       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434912061847       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434912063057       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434912062042       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434912038075       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434912147998       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434911816195       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+07 is 1.391610e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301261 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2721e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004299e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.4323
    reference variance = 0.687952
====================================================
  Execution time = 4.4057e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6415e-01
  Total weights = 2.0000e+06
  Execution time = 3.8418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564180785027
                                         uncertainty =       0.008192655053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564180785027
                                         uncertainty =       0.008192655053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531105343
  error estimate for blocks of size 2^( 2) =       0.000551639673
  error estimate for blocks of size 2^( 3) =       0.000570198326
  error estimate for blocks of size 2^( 4) =       0.000583991919
  error estimate for blocks of size 2^( 5) =       0.000592482220
  error estimate for blocks of size 2^( 6) =       0.000597626559
  error estimate for blocks of size 2^( 7) =       0.000600931255

      target function =                  N/A
              le_mean =     -22.436629361211
             les_mean =     503.966482580794
             stat err =       0.000593757988
             autocorr =       1.249849124723
              std dev =       0.751096378962
             le_variance =       0.564145770490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564180785167
                                         uncertainty =       0.008192655056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564180785167
                                         uncertainty =       0.008192655056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531105343
  error estimate for blocks of size 2^( 2) =       0.000551639673
  error estimate for blocks of size 2^( 3) =       0.000570198326
  error estimate for blocks of size 2^( 4) =       0.000583991919
  error estimate for blocks of size 2^( 5) =       0.000592482220
  error estimate for blocks of size 2^( 6) =       0.000597626559
  error estimate for blocks of size 2^( 7) =       0.000600931255

      target function =                  N/A
              le_mean =     -22.436629361212
             les_mean =     503.966482580939
             stat err =       0.000593757988
             autocorr =       1.249849124626
              std dev =       0.751096379056
             le_variance =       0.564145770630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564180785097
                                         uncertainty =       0.008192655054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564180785097
                                         uncertainty =       0.008192655054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531105343
  error estimate for blocks of size 2^( 2) =       0.000551639673
  error estimate for blocks of size 2^( 3) =       0.000570198326
  error estimate for blocks of size 2^( 4) =       0.000583991919
  error estimate for blocks of size 2^( 5) =       0.000592482220
  error estimate for blocks of size 2^( 6) =       0.000597626559
  error estimate for blocks of size 2^( 7) =       0.000600931255

      target function =                  N/A
              le_mean =     -22.436629361212
             les_mean =     503.966482580866
             stat err =       0.000593757988
             autocorr =       1.249849124676
              std dev =       0.751096379009
             le_variance =       0.564145770560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564180785036
                                         uncertainty =       0.008192655053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564180785036
                                         uncertainty =       0.008192655053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531105343
  error estimate for blocks of size 2^( 2) =       0.000551639673
  error estimate for blocks of size 2^( 3) =       0.000570198326
  error estimate for blocks of size 2^( 4) =       0.000583991919
  error estimate for blocks of size 2^( 5) =       0.000592482220
  error estimate for blocks of size 2^( 6) =       0.000597626559
  error estimate for blocks of size 2^( 7) =       0.000600931255

      target function =                  N/A
              le_mean =     -22.436629361211
             les_mean =     503.966482580803
             stat err =       0.000593757988
             autocorr =       1.249849124718
              std dev =       0.751096378968
             le_variance =       0.564145770499


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436629361211        initial
     2.3842e+06     2.3842e+07             2.2264e-10       -22.436629361212  <--
     9.5367e+06     9.5367e+07             5.5659e-11       -22.436629361212
     3.8147e+07     3.8147e+08             1.3916e-11       -22.436629361211

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 6.3321e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2605e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2435e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.3855
    reference variance = 0.440196
====================================================
  Execution time = 4.5120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5413e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562304026025
                                         uncertainty =       0.004432711165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562304026025
                                         uncertainty =       0.004432711165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530275709
  error estimate for blocks of size 2^( 2) =       0.000551116836
  error estimate for blocks of size 2^( 3) =       0.000570458199
  error estimate for blocks of size 2^( 4) =       0.000584154166
  error estimate for blocks of size 2^( 5) =       0.000592836585
  error estimate for blocks of size 2^( 6) =       0.000597163531
  error estimate for blocks of size 2^( 7) =       0.000601370917

      target function =                  N/A
              le_mean =     -22.435928315429
             les_mean =     503.933263748245
             stat err =       0.000593881300
             autocorr =       1.254283862194
              std dev =       0.749923098974
             le_variance =       0.562384654375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243592831543e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435928315429       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435928315431       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435928315432       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435928315433       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435928315434       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435928315396       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435928315064       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435928316066       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435928315177       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435928313630       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435928314789       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+05 is 8.980238e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435928315429       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435928315429       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435928315430       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435928315810       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435928315182       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435928315979       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435928315404       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435928315598       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435928315655       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435928315383       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435928316705       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+06 is 2.245075e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435928315429       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435928315429       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435928315429       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435928315429       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435928320735       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435928313033       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435928315568       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435928316836       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435928321395       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435928315054       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435928305810       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+06 is 5.612652e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305549 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0546e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.5432
    reference variance = 0.411036
====================================================
  Execution time = 4.4335e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6160e-01
  Total weights = 2.0000e+06
  Execution time = 3.8297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561682488478
                                         uncertainty =       0.003863479513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561682488478
                                         uncertainty =       0.003863479513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529903834
  error estimate for blocks of size 2^( 2) =       0.000550261585
  error estimate for blocks of size 2^( 3) =       0.000569703249
  error estimate for blocks of size 2^( 4) =       0.000584043837
  error estimate for blocks of size 2^( 5) =       0.000592867113
  error estimate for blocks of size 2^( 6) =       0.000596223324
  error estimate for blocks of size 2^( 7) =       0.000598782504

      target function =                  N/A
              le_mean =     -22.436029396177
             les_mean =     503.937010932750
             stat err =       0.000592979194
             autocorr =       1.252231969962
              std dev =       0.749397189380
             le_variance =       0.561596147450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561682488849
                                         uncertainty =       0.003863479516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561682488849
                                         uncertainty =       0.003863479516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529903835
  error estimate for blocks of size 2^( 2) =       0.000550261586
  error estimate for blocks of size 2^( 3) =       0.000569703250
  error estimate for blocks of size 2^( 4) =       0.000584043837
  error estimate for blocks of size 2^( 5) =       0.000592867113
  error estimate for blocks of size 2^( 6) =       0.000596223324
  error estimate for blocks of size 2^( 7) =       0.000598782504

      target function =                  N/A
              le_mean =     -22.436029396176
             les_mean =     503.937010933094
             stat err =       0.000592979195
             autocorr =       1.252231969650
              std dev =       0.749397189627
             le_variance =       0.561596147821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561682488664
                                         uncertainty =       0.003863479515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561682488664
                                         uncertainty =       0.003863479515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529903835
  error estimate for blocks of size 2^( 2) =       0.000550261585
  error estimate for blocks of size 2^( 3) =       0.000569703250
  error estimate for blocks of size 2^( 4) =       0.000584043837
  error estimate for blocks of size 2^( 5) =       0.000592867113
  error estimate for blocks of size 2^( 6) =       0.000596223324
  error estimate for blocks of size 2^( 7) =       0.000598782504

      target function =                  N/A
              le_mean =     -22.436029396176
             les_mean =     503.937010932922
             stat err =       0.000592979194
             autocorr =       1.252231969801
              std dev =       0.749397189504
             le_variance =       0.561596147636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561682488502
                                         uncertainty =       0.003863479513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561682488502
                                         uncertainty =       0.003863479513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529903834
  error estimate for blocks of size 2^( 2) =       0.000550261585
  error estimate for blocks of size 2^( 3) =       0.000569703250
  error estimate for blocks of size 2^( 4) =       0.000584043837
  error estimate for blocks of size 2^( 5) =       0.000592867113
  error estimate for blocks of size 2^( 6) =       0.000596223324
  error estimate for blocks of size 2^( 7) =       0.000598782504

      target function =                  N/A
              le_mean =     -22.436029396177
             les_mean =     503.937010932772
             stat err =       0.000592979194
             autocorr =       1.252231969938
              std dev =       0.749397189395
             le_variance =       0.561596147474


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436029396177        initial  <--
     5.9605e+05     5.9605e+06             8.9802e-10       -22.436029396176
     2.3842e+06     2.3842e+07             2.2451e-10       -22.436029396176
     9.5367e+06     9.5367e+07             5.6127e-11       -22.436029396177

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.5377
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2409e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2436e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.3766
    reference variance = 0.423089
====================================================
  Execution time = 4.7646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7857e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5122e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578618460438
                                         uncertainty =       0.020528665105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578618460438
                                         uncertainty =       0.020528665105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537854595
  error estimate for blocks of size 2^( 2) =       0.000558337848
  error estimate for blocks of size 2^( 3) =       0.000577157649
  error estimate for blocks of size 2^( 4) =       0.000592284660
  error estimate for blocks of size 2^( 5) =       0.000601984701
  error estimate for blocks of size 2^( 6) =       0.000608605543
  error estimate for blocks of size 2^( 7) =       0.000610734712

      target function =                  N/A
              le_mean =     -22.436810058119
             les_mean =     503.989020426568
             stat err =       0.000603402404
             autocorr =       1.258590081866
              std dev =       0.760641263502
             le_variance =       0.578575131742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243681005812e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436810058119       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436810058119       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436810058119       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436810058119       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436810058119       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436810058120       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436810055878       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436810042872       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436810033152       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436810056127       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436810045910       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+06 is 8.586291e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436810058119       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436810058119       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436810058119       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436810058119       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436810060910       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436810067574       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436810051495       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436810067494       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436810044955       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436810060342       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436810060297       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+07 is 2.146662e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436810058119       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436810058119       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436810058119       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436810061307       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436810045678       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436810025426       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436810043525       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436810043510       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436810006367       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436810141225       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436809853930       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+07 is 5.367378e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309894 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2781e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.3904
    reference variance = 0.529925
====================================================
  Execution time = 4.6378e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6009e-01
  Total weights = 2.0000e+06
  Execution time = 3.7903e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560063836174
                                         uncertainty =       0.004708063743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560063836174
                                         uncertainty =       0.004708063743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529191249
  error estimate for blocks of size 2^( 2) =       0.000549475288
  error estimate for blocks of size 2^( 3) =       0.000568777957
  error estimate for blocks of size 2^( 4) =       0.000583337600
  error estimate for blocks of size 2^( 5) =       0.000592951283
  error estimate for blocks of size 2^( 6) =       0.000597419520
  error estimate for blocks of size 2^( 7) =       0.000602045528

      target function =                  N/A
              le_mean =     -22.436457788842
             les_mean =     503.954724585428
             stat err =       0.000593938483
             autocorr =       1.259672428045
              std dev =       0.748389440727
             le_variance =       0.560086754992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560063836198
                                         uncertainty =       0.004708063743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560063836198
                                         uncertainty =       0.004708063743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529191249
  error estimate for blocks of size 2^( 2) =       0.000549475288
  error estimate for blocks of size 2^( 3) =       0.000568777957
  error estimate for blocks of size 2^( 4) =       0.000583337600
  error estimate for blocks of size 2^( 5) =       0.000592951283
  error estimate for blocks of size 2^( 6) =       0.000597419520
  error estimate for blocks of size 2^( 7) =       0.000602045528

      target function =                  N/A
              le_mean =     -22.436457788842
             les_mean =     503.954724585459
             stat err =       0.000593938483
             autocorr =       1.259672428031
              std dev =       0.748389440743
             le_variance =       0.560086755016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560063836186
                                         uncertainty =       0.004708063743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560063836186
                                         uncertainty =       0.004708063743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529191249
  error estimate for blocks of size 2^( 2) =       0.000549475288
  error estimate for blocks of size 2^( 3) =       0.000568777957
  error estimate for blocks of size 2^( 4) =       0.000583337600
  error estimate for blocks of size 2^( 5) =       0.000592951283
  error estimate for blocks of size 2^( 6) =       0.000597419520
  error estimate for blocks of size 2^( 7) =       0.000602045528

      target function =                  N/A
              le_mean =     -22.436457788842
             les_mean =     503.954724585443
             stat err =       0.000593938483
             autocorr =       1.259672428035
              std dev =       0.748389440735
             le_variance =       0.560086755004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560063836175
                                         uncertainty =       0.004708063743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560063836175
                                         uncertainty =       0.004708063743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529191249
  error estimate for blocks of size 2^( 2) =       0.000549475288
  error estimate for blocks of size 2^( 3) =       0.000568777957
  error estimate for blocks of size 2^( 4) =       0.000583337600
  error estimate for blocks of size 2^( 5) =       0.000592951283
  error estimate for blocks of size 2^( 6) =       0.000597419520
  error estimate for blocks of size 2^( 7) =       0.000602045528

      target function =                  N/A
              le_mean =     -22.436457788842
             les_mean =     503.954724585430
             stat err =       0.000593938483
             autocorr =       1.259672428047
              std dev =       0.748389440728
             le_variance =       0.560086754993


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436457788842        initial
     5.9605e+06     5.9605e+07             8.5863e-11       -22.436457788842  <--
     2.3842e+07     2.3842e+08             2.1467e-11       -22.436457788842
     9.5367e+07     9.5367e+08             5.3674e-12       -22.436457788842

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 6.5932e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2872e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.3307
    reference variance = 0.414303
====================================================
  Execution time = 4.5390e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5739e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5178e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557400411671
                                         uncertainty =       0.003480930349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557400411671
                                         uncertainty =       0.003480930349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527913732
  error estimate for blocks of size 2^( 2) =       0.000548256593
  error estimate for blocks of size 2^( 3) =       0.000566703621
  error estimate for blocks of size 2^( 4) =       0.000581496342
  error estimate for blocks of size 2^( 5) =       0.000590242373
  error estimate for blocks of size 2^( 6) =       0.000596239438
  error estimate for blocks of size 2^( 7) =       0.000598394351

      target function =                  N/A
              le_mean =     -22.436113251892
             les_mean =     503.936563390317
             stat err =       0.000591593126
             autocorr =       1.255799541699
              std dev =       0.746582759845
             le_variance =       0.557385817297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243611325189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436113251892       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436113251892       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436113251892       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436113252086       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436113250771       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436113251858       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436113252466       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436113251451       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436113255660       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436113258948       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436113246962       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+06 is 3.740280e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436113251892       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436113251892       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436113251892       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436113252179       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436113254782       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436113251183       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436113251267       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436113249838       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436113252930       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436113276918       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436113249847       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+06 is 9.350779e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436113251892       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436113251892       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436113251892       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436113251892       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436113251906       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436113243620       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436113260016       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436113234636       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436113166553       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436113225403       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436113094808       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+07 is 2.337400e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314167 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0580e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.3341
    reference variance = 0.550413
====================================================
  Execution time = 4.5309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5850e-01
  Total weights = 2.0000e+06
  Execution time = 3.7884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558284542017
                                         uncertainty =       0.004997177684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558284542017
                                         uncertainty =       0.004997177684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528438909
  error estimate for blocks of size 2^( 2) =       0.000548225092
  error estimate for blocks of size 2^( 3) =       0.000567242797
  error estimate for blocks of size 2^( 4) =       0.000581957149
  error estimate for blocks of size 2^( 5) =       0.000591345096
  error estimate for blocks of size 2^( 6) =       0.000595753546
  error estimate for blocks of size 2^( 7) =       0.000601700199

      target function =                  N/A
              le_mean =     -22.436716882331
             les_mean =     503.964759540463
             stat err =       0.000592688998
             autocorr =       1.257952248641
              std dev =       0.747325472479
             le_variance =       0.558495361816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558284542168
                                         uncertainty =       0.004997177687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558284542168
                                         uncertainty =       0.004997177687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528438909
  error estimate for blocks of size 2^( 2) =       0.000548225092
  error estimate for blocks of size 2^( 3) =       0.000567242797
  error estimate for blocks of size 2^( 4) =       0.000581957149
  error estimate for blocks of size 2^( 5) =       0.000591345096
  error estimate for blocks of size 2^( 6) =       0.000595753546
  error estimate for blocks of size 2^( 7) =       0.000601700199

      target function =                  N/A
              le_mean =     -22.436716882332
             les_mean =     503.964759540634
             stat err =       0.000592688998
             autocorr =       1.257952248514
              std dev =       0.747325472579
             le_variance =       0.558495361966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558284542093
                                         uncertainty =       0.004997177686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558284542093
                                         uncertainty =       0.004997177686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528438909
  error estimate for blocks of size 2^( 2) =       0.000548225092
  error estimate for blocks of size 2^( 3) =       0.000567242797
  error estimate for blocks of size 2^( 4) =       0.000581957149
  error estimate for blocks of size 2^( 5) =       0.000591345096
  error estimate for blocks of size 2^( 6) =       0.000595753546
  error estimate for blocks of size 2^( 7) =       0.000601700199

      target function =                  N/A
              le_mean =     -22.436716882332
             les_mean =     503.964759540548
             stat err =       0.000592688998
             autocorr =       1.257952248575
              std dev =       0.747325472529
             le_variance =       0.558495361891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558284542027
                                         uncertainty =       0.004997177685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558284542027
                                         uncertainty =       0.004997177685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528438909
  error estimate for blocks of size 2^( 2) =       0.000548225092
  error estimate for blocks of size 2^( 3) =       0.000567242797
  error estimate for blocks of size 2^( 4) =       0.000581957149
  error estimate for blocks of size 2^( 5) =       0.000591345096
  error estimate for blocks of size 2^( 6) =       0.000595753546
  error estimate for blocks of size 2^( 7) =       0.000601700199

      target function =                  N/A
              le_mean =     -22.436716882331
             les_mean =     503.964759540473
             stat err =       0.000592688998
             autocorr =       1.257952248630
              std dev =       0.747325472485
             le_variance =       0.558495361825


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436716882331        initial
     1.4901e+06     1.4901e+07             3.7403e-10       -22.436716882332  <--
     5.9605e+06     5.9605e+07             9.3508e-11       -22.436716882332
     2.3842e+07     2.3842e+08             2.3374e-11       -22.436716882331

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 6.4275e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2486e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2431e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.4322
    reference variance = 0.667715
====================================================
  Execution time = 4.5518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5912e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5361e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559112464614
                                         uncertainty =       0.004268227822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559112464614
                                         uncertainty =       0.004268227822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528733173
  error estimate for blocks of size 2^( 2) =       0.000549071179
  error estimate for blocks of size 2^( 3) =       0.000567685668
  error estimate for blocks of size 2^( 4) =       0.000582911378
  error estimate for blocks of size 2^( 5) =       0.000592222236
  error estimate for blocks of size 2^( 6) =       0.000594843391
  error estimate for blocks of size 2^( 7) =       0.000598837487

      target function =                  N/A
              le_mean =     -22.436823965141
             les_mean =     503.970186900664
             stat err =       0.000592203623
             autocorr =       1.254495191573
              std dev =       0.747741624814
             le_variance =       0.559117537480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243682396514e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436823965141       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436823965144       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436823965147       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436823965147       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436823965086       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436823965034       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436823964682       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436823965277       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436823965140       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436823966496       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436823966225       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+05 is 1.486920e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436823965141       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436823965142       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436823965143       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436823965143       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436823965143       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436823965340       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436823965211       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436823965041       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436823959648       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436823963291       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436823966968       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+06 is 3.717281e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436823965141       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436823965142       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436823965142       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436823963259       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436823965114       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436823965373       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436823965327       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436823972342       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436823956717       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436823984599       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436823974913       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+06 is 9.293434e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318546 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0892e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.4908
    reference variance = 0.468096
====================================================
  Execution time = 4.6401e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5864e-01
  Total weights = 2.0000e+06
  Execution time = 3.8000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558693868149
                                         uncertainty =       0.004239390490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558693868149
                                         uncertainty =       0.004239390490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528505110
  error estimate for blocks of size 2^( 2) =       0.000548817349
  error estimate for blocks of size 2^( 3) =       0.000567637164
  error estimate for blocks of size 2^( 4) =       0.000581870149
  error estimate for blocks of size 2^( 5) =       0.000591230957
  error estimate for blocks of size 2^( 6) =       0.000597668324
  error estimate for blocks of size 2^( 7) =       0.000601244351

      target function =                  N/A
              le_mean =     -22.436052746983
             les_mean =     503.935097888983
             stat err =       0.000593003445
             autocorr =       1.258971942540
              std dev =       0.747419094538
             le_variance =       0.558635302880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558693867945
                                         uncertainty =       0.004239390489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558693867945
                                         uncertainty =       0.004239390489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528505110
  error estimate for blocks of size 2^( 2) =       0.000548817349
  error estimate for blocks of size 2^( 3) =       0.000567637164
  error estimate for blocks of size 2^( 4) =       0.000581870149
  error estimate for blocks of size 2^( 5) =       0.000591230957
  error estimate for blocks of size 2^( 6) =       0.000597668324
  error estimate for blocks of size 2^( 7) =       0.000601244351

      target function =                  N/A
              le_mean =     -22.436052746976
             les_mean =     503.935097888450
             stat err =       0.000593003445
             autocorr =       1.258971942558
              std dev =       0.747419094402
             le_variance =       0.558635302676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558693868047
                                         uncertainty =       0.004239390489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558693868047
                                         uncertainty =       0.004239390489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528505110
  error estimate for blocks of size 2^( 2) =       0.000548817349
  error estimate for blocks of size 2^( 3) =       0.000567637164
  error estimate for blocks of size 2^( 4) =       0.000581870149
  error estimate for blocks of size 2^( 5) =       0.000591230957
  error estimate for blocks of size 2^( 6) =       0.000597668324
  error estimate for blocks of size 2^( 7) =       0.000601244351

      target function =                  N/A
              le_mean =     -22.436052746980
             les_mean =     503.935097888716
             stat err =       0.000593003445
             autocorr =       1.258971942550
              std dev =       0.747419094470
             le_variance =       0.558635302778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558693868137
                                         uncertainty =       0.004239390490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558693868137
                                         uncertainty =       0.004239390490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528505110
  error estimate for blocks of size 2^( 2) =       0.000548817349
  error estimate for blocks of size 2^( 3) =       0.000567637164
  error estimate for blocks of size 2^( 4) =       0.000581870149
  error estimate for blocks of size 2^( 5) =       0.000591230957
  error estimate for blocks of size 2^( 6) =       0.000597668324
  error estimate for blocks of size 2^( 7) =       0.000601244351

      target function =                  N/A
              le_mean =     -22.436052746983
             les_mean =     503.935097888949
             stat err =       0.000593003445
             autocorr =       1.258971942541
              std dev =       0.747419094530
             le_variance =       0.558635302868


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436052746983        initial  <--
     3.7253e+05     3.7253e+06             1.4869e-09       -22.436052746976
     1.4901e+06     1.4901e+07             3.7173e-10       -22.436052746980
     5.9605e+06     5.9605e+07             9.2934e-11       -22.436052746983

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.9857
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2788e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2432e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.4618
    reference variance = 0.412272
====================================================
  Execution time = 4.5753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5453e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5401e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554552982955
                                         uncertainty =       0.003149436077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554552982955
                                         uncertainty =       0.003149436077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526560658
  error estimate for blocks of size 2^( 2) =       0.000546821831
  error estimate for blocks of size 2^( 3) =       0.000565637596
  error estimate for blocks of size 2^( 4) =       0.000579704348
  error estimate for blocks of size 2^( 5) =       0.000588408649
  error estimate for blocks of size 2^( 6) =       0.000593996100
  error estimate for blocks of size 2^( 7) =       0.000594936024

      target function =                  N/A
              le_mean =     -22.436031346209
             les_mean =     503.930034543310
             stat err =       0.000589261280
             autocorr =       1.252330608439
              std dev =       0.744669223537
             le_variance =       0.554532252484


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243603134621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436031346209       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436031346210       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436031346211       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436031345689       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436031345447       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436031343963       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436031344684       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436031349236       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436031349841       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436031346309       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+06 is 1.530204e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436031346209       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436031346210       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436031346210       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436031346210       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436031341024       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436031342869       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436031358979       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436031334307       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436031306123       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436031282450       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+07 is 3.825388e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436031346209       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436031346209       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436031346209       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436031346210       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436031347054       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436031338447       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436031361198       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436031358728       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436031345179       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436031346849       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+07 is 9.564130e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.322312 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1167e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.4634
    reference variance = 0.47492
====================================================
  Execution time = 4.4481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.4969e-01
  Total weights = 2.0000e+06
  Execution time = 3.7918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.549638021228
                                         uncertainty =       0.003343290212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.549638021228
                                         uncertainty =       0.003343290212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000524257899
  error estimate for blocks of size 2^( 2) =       0.000544471795
  error estimate for blocks of size 2^( 3) =       0.000564327070
  error estimate for blocks of size 2^( 4) =       0.000579141476
  error estimate for blocks of size 2^( 5) =       0.000588208336
  error estimate for blocks of size 2^( 6) =       0.000594705645
  error estimate for blocks of size 2^( 7) =       0.000601107615

      target function =                  N/A
              le_mean =     -22.436513887350
             les_mean =     503.946847832220
             stat err =       0.000590790768
             autocorr =       1.269923133562
              std dev =       0.741412631273
             le_variance =       0.549692689812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.549638021319
                                         uncertainty =       0.003343290213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.549638021319
                                         uncertainty =       0.003343290213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000524257899
  error estimate for blocks of size 2^( 2) =       0.000544471795
  error estimate for blocks of size 2^( 3) =       0.000564327070
  error estimate for blocks of size 2^( 4) =       0.000579141476
  error estimate for blocks of size 2^( 5) =       0.000588208336
  error estimate for blocks of size 2^( 6) =       0.000594705645
  error estimate for blocks of size 2^( 7) =       0.000601107615

      target function =                  N/A
              le_mean =     -22.436513887350
             les_mean =     503.946847832317
             stat err =       0.000590790768
             autocorr =       1.269923133496
              std dev =       0.741412631335
             le_variance =       0.549692689903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.549638021274
                                         uncertainty =       0.003343290212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.549638021274
                                         uncertainty =       0.003343290212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000524257899
  error estimate for blocks of size 2^( 2) =       0.000544471795
  error estimate for blocks of size 2^( 3) =       0.000564327070
  error estimate for blocks of size 2^( 4) =       0.000579141476
  error estimate for blocks of size 2^( 5) =       0.000588208336
  error estimate for blocks of size 2^( 6) =       0.000594705645
  error estimate for blocks of size 2^( 7) =       0.000601107615

      target function =                  N/A
              le_mean =     -22.436513887350
             les_mean =     503.946847832268
             stat err =       0.000590790768
             autocorr =       1.269923133528
              std dev =       0.741412631304
             le_variance =       0.549692689857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.549638021234
                                         uncertainty =       0.003343290212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.549638021234
                                         uncertainty =       0.003343290212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000524257899
  error estimate for blocks of size 2^( 2) =       0.000544471795
  error estimate for blocks of size 2^( 3) =       0.000564327070
  error estimate for blocks of size 2^( 4) =       0.000579141476
  error estimate for blocks of size 2^( 5) =       0.000588208336
  error estimate for blocks of size 2^( 6) =       0.000594705645
  error estimate for blocks of size 2^( 7) =       0.000601107615

      target function =                  N/A
              le_mean =     -22.436513887350
             les_mean =     503.946847832226
             stat err =       0.000590790768
             autocorr =       1.269923133557
              std dev =       0.741412631277
             le_variance =       0.549692689817


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436513887350        initial
     3.7253e+06     3.7253e+07             1.5302e-10       -22.436513887350  <--
     1.4901e+07     1.4901e+08             3.8254e-11       -22.436513887350
     5.9605e+07     5.9605e+08             9.5641e-12       -22.436513887350

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 6.3453e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2463e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2433e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.4606
    reference variance = 0.378443
====================================================
  Execution time = 4.5252e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5966e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5204e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559791466464
                                         uncertainty =       0.004712762208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559791466464
                                         uncertainty =       0.004712762208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528989441
  error estimate for blocks of size 2^( 2) =       0.000549314532
  error estimate for blocks of size 2^( 3) =       0.000568792245
  error estimate for blocks of size 2^( 4) =       0.000583780030
  error estimate for blocks of size 2^( 5) =       0.000592294925
  error estimate for blocks of size 2^( 6) =       0.000596165899
  error estimate for blocks of size 2^( 7) =       0.000600562314

      target function =                  N/A
              le_mean =     -22.436234041869
             les_mean =     503.944257358918
             stat err =       0.000593200792
             autocorr =       1.257504182107
              std dev =       0.748104041706
             le_variance =       0.559659657217


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243623404187e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436234041869       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436234041869       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436234041869       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436234042089       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436234041245       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436234042551       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436234041933       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436234041712       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436234039877       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436234037534       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+05 is 5.868325e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436234041869       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436234041869       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436234041869       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436234042158       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436234041869       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436234040685       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436234042210       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436234045285       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436234044228       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436234034189       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+06 is 1.467082e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436234041869       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436234041869       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436234041869       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436234041869       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436234034120       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436234041203       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436234050312       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436234086685       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436234083534       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436233995403       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+07 is 3.668024e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.326043 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0468e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.5189
    reference variance = 0.572583
====================================================
  Execution time = 4.4731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5589e-01
  Total weights = 2.0000e+06
  Execution time = 3.8099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555907423171
                                         uncertainty =       0.006374772155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555907423171
                                         uncertainty =       0.006374772155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527203179
  error estimate for blocks of size 2^( 2) =       0.000547423803
  error estimate for blocks of size 2^( 3) =       0.000565596703
  error estimate for blocks of size 2^( 4) =       0.000579362636
  error estimate for blocks of size 2^( 5) =       0.000588337932
  error estimate for blocks of size 2^( 6) =       0.000592073374
  error estimate for blocks of size 2^( 7) =       0.000595049983

      target function =                  N/A
              le_mean =     -22.436406698537
             les_mean =     503.948231647491
             stat err =       0.000588705981
             autocorr =       1.246926504197
              std dev =       0.745577885445
             le_variance =       0.555886383265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555907423253
                                         uncertainty =       0.006374772157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555907423253
                                         uncertainty =       0.006374772157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527203179
  error estimate for blocks of size 2^( 2) =       0.000547423803
  error estimate for blocks of size 2^( 3) =       0.000565596703
  error estimate for blocks of size 2^( 4) =       0.000579362636
  error estimate for blocks of size 2^( 5) =       0.000588337932
  error estimate for blocks of size 2^( 6) =       0.000592073374
  error estimate for blocks of size 2^( 7) =       0.000595049983

      target function =                  N/A
              le_mean =     -22.436406698538
             les_mean =     503.948231647584
             stat err =       0.000588705981
             autocorr =       1.246926504134
              std dev =       0.745577885500
             le_variance =       0.555886383347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555907423212
                                         uncertainty =       0.006374772156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555907423212
                                         uncertainty =       0.006374772156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527203179
  error estimate for blocks of size 2^( 2) =       0.000547423803
  error estimate for blocks of size 2^( 3) =       0.000565596703
  error estimate for blocks of size 2^( 4) =       0.000579362636
  error estimate for blocks of size 2^( 5) =       0.000588337932
  error estimate for blocks of size 2^( 6) =       0.000592073374
  error estimate for blocks of size 2^( 7) =       0.000595049983

      target function =                  N/A
              le_mean =     -22.436406698537
             les_mean =     503.948231647537
             stat err =       0.000588705981
             autocorr =       1.246926504162
              std dev =       0.745577885473
             le_variance =       0.555886383306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555907423176
                                         uncertainty =       0.006374772155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555907423176
                                         uncertainty =       0.006374772155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527203179
  error estimate for blocks of size 2^( 2) =       0.000547423803
  error estimate for blocks of size 2^( 3) =       0.000565596703
  error estimate for blocks of size 2^( 4) =       0.000579362636
  error estimate for blocks of size 2^( 5) =       0.000588337932
  error estimate for blocks of size 2^( 6) =       0.000592073374
  error estimate for blocks of size 2^( 7) =       0.000595049983

      target function =                  N/A
              le_mean =     -22.436406698537
             les_mean =     503.948231647497
             stat err =       0.000588705981
             autocorr =       1.246926504187
              std dev =       0.745577885449
             le_variance =       0.555886383270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436406698537        initial
     9.3132e+05     9.3132e+06             5.8683e-10       -22.436406698538  <--
     3.7253e+06     3.7253e+07             1.4671e-10       -22.436406698537
     1.4901e+07     1.4901e+08             3.6680e-11       -22.436406698537

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 6.3815e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2429e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2435e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.3351
    reference variance = 0.429071
====================================================
  Execution time = 4.8398e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2435e+01
  VMC Evar = 5.5515e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4959e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555169749130
                                         uncertainty =       0.003494385730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555169749130
                                         uncertainty =       0.003494385730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526855687
  error estimate for blocks of size 2^( 2) =       0.000546908814
  error estimate for blocks of size 2^( 3) =       0.000566348482
  error estimate for blocks of size 2^( 4) =       0.000580994136
  error estimate for blocks of size 2^( 5) =       0.000588962579
  error estimate for blocks of size 2^( 6) =       0.000593232219
  error estimate for blocks of size 2^( 7) =       0.000595946446

      target function =                  N/A
              le_mean =     -22.435185661372
             les_mean =     503.892709213306
             stat err =       0.000589783845
             autocorr =       1.253148099344
              std dev =       0.745086458507
             le_variance =       0.555153830650


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243518566137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435185661372       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435185661376       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435185661377       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435185661303       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435185661296       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435185661478       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435185661508       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435185661329       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435185661594       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435185660948       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+05 is 2.146907e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435185661372       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435185661373       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435185661373       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435185661334       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435185661478       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435185660544       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435185661488       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435185660257       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435185660870       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435185664006       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+05 is 5.367261e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435185661372       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435185661372       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435185661372       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435185661373       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435185659703       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435185661130       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435185661120       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435185662674       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435185652855       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435185666399       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+06 is 1.341803e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3370e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648425e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.2851
    reference variance = 0.34448
====================================================
  Execution time = 4.5185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7561e-01
  Total weights = 2.0000e+06
  Execution time = 3.7914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575716118623
                                         uncertainty =       0.016668863902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575716118623
                                         uncertainty =       0.016668863902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536473625
  error estimate for blocks of size 2^( 2) =       0.000556397474
  error estimate for blocks of size 2^( 3) =       0.000575817057
  error estimate for blocks of size 2^( 4) =       0.000590161447
  error estimate for blocks of size 2^( 5) =       0.000600777165
  error estimate for blocks of size 2^( 6) =       0.000604998560
  error estimate for blocks of size 2^( 7) =       0.000608446373

      target function =                  N/A
              le_mean =     -22.436280469572
             les_mean =     503.962288921089
             stat err =       0.000601095886
             autocorr =       1.255424967945
              std dev =       0.758688275641
             le_variance =       0.575607899596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575716119145
                                         uncertainty =       0.016668863902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575716119145
                                         uncertainty =       0.016668863902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536473625
  error estimate for blocks of size 2^( 2) =       0.000556397474
  error estimate for blocks of size 2^( 3) =       0.000575817057
  error estimate for blocks of size 2^( 4) =       0.000590161447
  error estimate for blocks of size 2^( 5) =       0.000600777165
  error estimate for blocks of size 2^( 6) =       0.000604998560
  error estimate for blocks of size 2^( 7) =       0.000608446373

      target function =                  N/A
              le_mean =     -22.436280469571
             les_mean =     503.962288921584
             stat err =       0.000601095886
             autocorr =       1.255424967503
              std dev =       0.758688275986
             le_variance =       0.575607900118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575716118884
                                         uncertainty =       0.016668863902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575716118884
                                         uncertainty =       0.016668863902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536473625
  error estimate for blocks of size 2^( 2) =       0.000556397474
  error estimate for blocks of size 2^( 3) =       0.000575817057
  error estimate for blocks of size 2^( 4) =       0.000590161447
  error estimate for blocks of size 2^( 5) =       0.000600777165
  error estimate for blocks of size 2^( 6) =       0.000604998560
  error estimate for blocks of size 2^( 7) =       0.000608446373

      target function =                  N/A
              le_mean =     -22.436280469572
             les_mean =     503.962288921337
             stat err =       0.000601095886
             autocorr =       1.255424967722
              std dev =       0.758688275813
             le_variance =       0.575607899857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575716118656
                                         uncertainty =       0.016668863902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575716118656
                                         uncertainty =       0.016668863902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536473625
  error estimate for blocks of size 2^( 2) =       0.000556397474
  error estimate for blocks of size 2^( 3) =       0.000575817057
  error estimate for blocks of size 2^( 4) =       0.000590161447
  error estimate for blocks of size 2^( 5) =       0.000600777165
  error estimate for blocks of size 2^( 6) =       0.000604998560
  error estimate for blocks of size 2^( 7) =       0.000608446373

      target function =                  N/A
              le_mean =     -22.436280469572
             les_mean =     503.962288921120
             stat err =       0.000601095886
             autocorr =       1.255424967923
              std dev =       0.758688275663
             le_variance =       0.575607899628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436280469572        initial  <--
     2.3283e+05     2.3283e+06             2.1469e-09       -22.436280469571
     9.3132e+05     9.3132e+06             5.3673e-10       -22.436280469572
     3.7253e+06     3.7253e+07             1.3418e-10       -22.436280469572

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1708
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2755e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2431e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.4065
    reference variance = 0.334783
====================================================
  Execution time = 4.5043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5097e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5156e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.550351490434
                                         uncertainty =       0.004052021069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.550351490434
                                         uncertainty =       0.004052021069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000524865710
  error estimate for blocks of size 2^( 2) =       0.000544704714
  error estimate for blocks of size 2^( 3) =       0.000564297650
  error estimate for blocks of size 2^( 4) =       0.000578871310
  error estimate for blocks of size 2^( 5) =       0.000586917807
  error estimate for blocks of size 2^( 6) =       0.000591075508
  error estimate for blocks of size 2^( 7) =       0.000594446742

      target function =                  N/A
              le_mean =     -22.435544301840
             les_mean =     503.904615872374
             stat err =       0.000587827842
             autocorr =       1.254307162393
              std dev =       0.742272206146
             le_variance =       0.550968028018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243554430184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435544301840       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435544301841       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435544301841       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435544301843       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435544301842       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435544300894       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435544301253       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435544298730       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435544302161       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435544295239       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435544296646       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+06 is 2.246734e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435544301840       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435544301840       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435544301840       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435544301838       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435544300412       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435544298650       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435544306016       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435544301869       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435544307617       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435544304847       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435544327422       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+06 is 5.616966e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435544301840       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435544301840       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435544301840       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435544267294       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435544307350       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435544298260       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435544236849       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435544241107       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435544273318       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435544318390       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435544245700       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+07 is 1.404031e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334357 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0212e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.4444
    reference variance = 0.36683
====================================================
  Execution time = 4.4235e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5621e-01
  Total weights = 2.0000e+06
  Execution time = 3.8447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556218356857
                                         uncertainty =       0.005824730636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556218356857
                                         uncertainty =       0.005824730636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527356461
  error estimate for blocks of size 2^( 2) =       0.000547453085
  error estimate for blocks of size 2^( 3) =       0.000566690707
  error estimate for blocks of size 2^( 4) =       0.000581545665
  error estimate for blocks of size 2^( 5) =       0.000589398687
  error estimate for blocks of size 2^( 6) =       0.000594010837
  error estimate for blocks of size 2^( 7) =       0.000596848068

      target function =                  N/A
              le_mean =     -22.435952069536
             les_mean =     503.928154663309
             stat err =       0.000590450814
             autocorr =       1.253599782859
              std dev =       0.745794660018
             le_variance =       0.556209674911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556218356979
                                         uncertainty =       0.005824730638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556218356979
                                         uncertainty =       0.005824730638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527356462
  error estimate for blocks of size 2^( 2) =       0.000547453085
  error estimate for blocks of size 2^( 3) =       0.000566690707
  error estimate for blocks of size 2^( 4) =       0.000581545665
  error estimate for blocks of size 2^( 5) =       0.000589398687
  error estimate for blocks of size 2^( 6) =       0.000594010837
  error estimate for blocks of size 2^( 7) =       0.000596848068

      target function =                  N/A
              le_mean =     -22.435952069535
             les_mean =     503.928154663415
             stat err =       0.000590450814
             autocorr =       1.253599782762
              std dev =       0.745794660100
             le_variance =       0.556209675033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556218356918
                                         uncertainty =       0.005824730637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556218356918
                                         uncertainty =       0.005824730637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527356462
  error estimate for blocks of size 2^( 2) =       0.000547453085
  error estimate for blocks of size 2^( 3) =       0.000566690707
  error estimate for blocks of size 2^( 4) =       0.000581545665
  error estimate for blocks of size 2^( 5) =       0.000589398687
  error estimate for blocks of size 2^( 6) =       0.000594010837
  error estimate for blocks of size 2^( 7) =       0.000596848068

      target function =                  N/A
              le_mean =     -22.435952069536
             les_mean =     503.928154663362
             stat err =       0.000590450814
             autocorr =       1.253599782810
              std dev =       0.745794660059
             le_variance =       0.556209674972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556218356865
                                         uncertainty =       0.005824730636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556218356865
                                         uncertainty =       0.005824730636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527356461
  error estimate for blocks of size 2^( 2) =       0.000547453085
  error estimate for blocks of size 2^( 3) =       0.000566690707
  error estimate for blocks of size 2^( 4) =       0.000581545665
  error estimate for blocks of size 2^( 5) =       0.000589398687
  error estimate for blocks of size 2^( 6) =       0.000594010837
  error estimate for blocks of size 2^( 7) =       0.000596848068

      target function =                  N/A
              le_mean =     -22.435952069536
             les_mean =     503.928154663316
             stat err =       0.000590450814
             autocorr =       1.253599782854
              std dev =       0.745794660023
             le_variance =       0.556209674919


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435952069536        initial  <--
     2.3283e+06     2.3283e+07             2.2467e-10       -22.435952069535
     9.3132e+06     9.3132e+07             5.6170e-11       -22.435952069536
     3.7253e+07     3.7253e+08             1.4040e-11       -22.435952069536

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.4945
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2371e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2430e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.4952
    reference variance = 0.38679
====================================================
  Execution time = 4.5126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.8651e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5133e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.586372859467
                                         uncertainty =       0.013940197241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.586372859467
                                         uncertainty =       0.013940197241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000541528651
  error estimate for blocks of size 2^( 2) =       0.000561515484
  error estimate for blocks of size 2^( 3) =       0.000580154708
  error estimate for blocks of size 2^( 4) =       0.000595084496
  error estimate for blocks of size 2^( 5) =       0.000604302954
  error estimate for blocks of size 2^( 6) =       0.000610615746
  error estimate for blocks of size 2^( 7) =       0.000616022560

      target function =                  N/A
              le_mean =     -22.437224686290
             les_mean =     504.015557888482
             stat err =       0.000606506439
             autocorr =       1.254376631140
              std dev =       0.765837161993
             le_variance =       0.586506558689


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243722468629e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437224686290       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437224686290       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437224686290       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437224685277       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437224696760       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437224670104       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437224681964       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437224673781       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437224705207       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437224809059       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+07 is 2.312039e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437224686290       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437224686290       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437224686290       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437224644027       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437224686290       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437224643764       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437224706976       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437224557348       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437224502893       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437224605072       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+07 is 5.778844e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437224686290       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437224686290       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437224686290       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437224702646       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437224686290       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437224676477       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437224421916       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437224691042       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437225345852       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437224051091       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+08 is 1.444702e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347410 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3383e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.4758
    reference variance = 0.89737
====================================================
  Execution time = 4.6388e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6564e-01
  Total weights = 2.0000e+06
  Execution time = 3.8455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565710997549
                                         uncertainty =       0.006951496222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565710997549
                                         uncertainty =       0.006951496222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531809812
  error estimate for blocks of size 2^( 2) =       0.000551646232
  error estimate for blocks of size 2^( 3) =       0.000570766998
  error estimate for blocks of size 2^( 4) =       0.000585337575
  error estimate for blocks of size 2^( 5) =       0.000594110699
  error estimate for blocks of size 2^( 6) =       0.000600130770
  error estimate for blocks of size 2^( 7) =       0.000600777980

      target function =                  N/A
              le_mean =     -22.435702000731
             les_mean =     503.926367335637
             stat err =       0.000595089256
             autocorr =       1.252136071729
              std dev =       0.752092649125
             le_variance =       0.565643352867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565710997547
                                         uncertainty =       0.006951496222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565710997547
                                         uncertainty =       0.006951496222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531809812
  error estimate for blocks of size 2^( 2) =       0.000551646232
  error estimate for blocks of size 2^( 3) =       0.000570766998
  error estimate for blocks of size 2^( 4) =       0.000585337575
  error estimate for blocks of size 2^( 5) =       0.000594110699
  error estimate for blocks of size 2^( 6) =       0.000600130770
  error estimate for blocks of size 2^( 7) =       0.000600777980

      target function =                  N/A
              le_mean =     -22.435702000731
             les_mean =     503.926367335633
             stat err =       0.000595089256
             autocorr =       1.252136071731
              std dev =       0.752092649123
             le_variance =       0.565643352865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565710997548
                                         uncertainty =       0.006951496222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565710997548
                                         uncertainty =       0.006951496222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531809812
  error estimate for blocks of size 2^( 2) =       0.000551646232
  error estimate for blocks of size 2^( 3) =       0.000570766998
  error estimate for blocks of size 2^( 4) =       0.000585337575
  error estimate for blocks of size 2^( 5) =       0.000594110699
  error estimate for blocks of size 2^( 6) =       0.000600130770
  error estimate for blocks of size 2^( 7) =       0.000600777980

      target function =                  N/A
              le_mean =     -22.435702000731
             les_mean =     503.926367335635
             stat err =       0.000595089256
             autocorr =       1.252136071729
              std dev =       0.752092649124
             le_variance =       0.565643352866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565710997549
                                         uncertainty =       0.006951496222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565710997549
                                         uncertainty =       0.006951496222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531809812
  error estimate for blocks of size 2^( 2) =       0.000551646232
  error estimate for blocks of size 2^( 3) =       0.000570766998
  error estimate for blocks of size 2^( 4) =       0.000585337575
  error estimate for blocks of size 2^( 5) =       0.000594110699
  error estimate for blocks of size 2^( 6) =       0.000600130770
  error estimate for blocks of size 2^( 7) =       0.000600777980

      target function =                  N/A
              le_mean =     -22.435702000731
             les_mean =     503.926367335636
             stat err =       0.000595089256
             autocorr =       1.252136071734
              std dev =       0.752092649124
             le_variance =       0.565643352867


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435702000731        initial
     2.3283e+07     2.3283e+08             2.3120e-11       -22.435702000731
     9.3132e+07     9.3132e+08             5.7788e-12       -22.435702000731
     3.7253e+08     3.7253e+09             1.4447e-12       -22.435702000731  <--

*****************************************************************************
Applying the update for shift_i =   3.7253e+08     and shift_s =   3.7253e+09
*****************************************************************************

  Execution time = 6.5673e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2906e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2432e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.5487
    reference variance = 0.472009
====================================================
  Execution time = 4.4976e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2434e+01
  VMC Evar = 5.6267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5210e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562531778786
                                         uncertainty =       0.006662185384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562531778786
                                         uncertainty =       0.006662185384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530412184
  error estimate for blocks of size 2^( 2) =       0.000550829225
  error estimate for blocks of size 2^( 3) =       0.000570164750
  error estimate for blocks of size 2^( 4) =       0.000584338547
  error estimate for blocks of size 2^( 5) =       0.000594540268
  error estimate for blocks of size 2^( 6) =       0.000600246038
  error estimate for blocks of size 2^( 7) =       0.000603519867

      target function =                  N/A
              le_mean =     -22.434215859098
             les_mean =     503.856715101296
             stat err =       0.000595661180
             autocorr =       1.261164135025
              std dev =       0.750116104358
             le_variance =       0.562674170017


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243421585910e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434215859098       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434215859098       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434215859098       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434215844315       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434215736751       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434215849646       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434215860249       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434216007373       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434215822086       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434216060858       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+07 is 5.591603e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434215859098       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434215859098       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434215859098       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434216045827       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434215857952       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434215758683       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434215928240       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434215806403       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434215163816       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434214629873       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.434215763413       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+08 is 1.412304e-12

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.434215859098       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.434215859098       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.434215859098       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.434215859098       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.434215753038       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.434216109234       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434215375294       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.434213726189       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.434214925450       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.434215903507       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+09 is 3.480773e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.351340 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0201e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.4459
    reference variance = 0.386255
====================================================
  Execution time = 4.4651e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5639e-01
  Total weights = 2.0000e+06
  Execution time = 3.8397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556296133723
                                         uncertainty =       0.004901059940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556296133723
                                         uncertainty =       0.004901059940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527443130
  error estimate for blocks of size 2^( 2) =       0.000547883667
  error estimate for blocks of size 2^( 3) =       0.000566402889
  error estimate for blocks of size 2^( 4) =       0.000580030639
  error estimate for blocks of size 2^( 5) =       0.000590075702
  error estimate for blocks of size 2^( 6) =       0.000597118843
  error estimate for blocks of size 2^( 7) =       0.000599731410

      target function =                  N/A
              le_mean =     -22.435838107374
             les_mean =     503.923223812300
             stat err =       0.000591739149
             autocorr =       1.258662593984
              std dev =       0.745917227454
             le_variance =       0.556392510212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556296133725
                                         uncertainty =       0.004901059940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556296133725
                                         uncertainty =       0.004901059940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527443130
  error estimate for blocks of size 2^( 2) =       0.000547883667
  error estimate for blocks of size 2^( 3) =       0.000566402889
  error estimate for blocks of size 2^( 4) =       0.000580030639
  error estimate for blocks of size 2^( 5) =       0.000590075702
  error estimate for blocks of size 2^( 6) =       0.000597118843
  error estimate for blocks of size 2^( 7) =       0.000599731410

      target function =                  N/A
              le_mean =     -22.435838107374
             les_mean =     503.923223812301
             stat err =       0.000591739149
             autocorr =       1.258662593980
              std dev =       0.745917227455
             le_variance =       0.556392510214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556296133724
                                         uncertainty =       0.004901059940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556296133724
                                         uncertainty =       0.004901059940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527443130
  error estimate for blocks of size 2^( 2) =       0.000547883667
  error estimate for blocks of size 2^( 3) =       0.000566402889
  error estimate for blocks of size 2^( 4) =       0.000580030639
  error estimate for blocks of size 2^( 5) =       0.000590075702
  error estimate for blocks of size 2^( 6) =       0.000597118843
  error estimate for blocks of size 2^( 7) =       0.000599731410

      target function =                  N/A
              le_mean =     -22.435838107374
             les_mean =     503.923223812301
             stat err =       0.000591739149
             autocorr =       1.258662593978
              std dev =       0.745917227454
             le_variance =       0.556392510213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556296133723
                                         uncertainty =       0.004901059940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556296133723
                                         uncertainty =       0.004901059940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527443130
  error estimate for blocks of size 2^( 2) =       0.000547883667
  error estimate for blocks of size 2^( 3) =       0.000566402889
  error estimate for blocks of size 2^( 4) =       0.000580030639
  error estimate for blocks of size 2^( 5) =       0.000590075702
  error estimate for blocks of size 2^( 6) =       0.000597118843
  error estimate for blocks of size 2^( 7) =       0.000599731410

      target function =                  N/A
              le_mean =     -22.435838107374
             les_mean =     503.923223812300
             stat err =       0.000591739149
             autocorr =       1.258662593981
              std dev =       0.745917227454
             le_variance =       0.556392510212


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435838107374        initial
     9.3132e+07     9.3132e+08             5.5916e-12       -22.435838107374
     3.7253e+08     3.7253e+09             1.4123e-12       -22.435838107374
     1.4901e+09     1.4901e+10             3.4808e-13       -22.435838107374  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e+09     and shift_s =   1.4901e+10
*****************************************************************************

  Execution time = 6.3886e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2409e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.5643
    reference variance = 0.930321
====================================================
  Execution time = 4.5012e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7014e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5201e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570153429345
                                         uncertainty =       0.006840233631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570153429345
                                         uncertainty =       0.006840233631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533920780
  error estimate for blocks of size 2^( 2) =       0.000554304173
  error estimate for blocks of size 2^( 3) =       0.000572538040
  error estimate for blocks of size 2^( 4) =       0.000586746817
  error estimate for blocks of size 2^( 5) =       0.000595765863
  error estimate for blocks of size 2^( 6) =       0.000600394735
  error estimate for blocks of size 2^( 7) =       0.000601641009

      target function =                  N/A
              le_mean =     -22.436595844610
             les_mean =     503.970975606968
             stat err =       0.000596137106
             autocorr =       1.246633127178
              std dev =       0.755078007678
             le_variance =       0.570142797680


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243659584461e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436595844610       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436595844610       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436595844610       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436595843400       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436595921657       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436595704460       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436595658998       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436596135670       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436595652002       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436596320674       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+08 is 1.316829e-12

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436595844610       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436595844610       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436595844610       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436595844610       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436595845792       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436596029181       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436599629502       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436594933279       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436596811399       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436600862863       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436586659113       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436591484680       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436594678637       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+09 is 3.360707e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436595844610       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436595844610       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436595844610       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436595844610       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436598533142       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436591785690       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436595972470       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436591010858       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436593829192       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436630832650       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436569437623       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436567269904       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436563855275       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436577710586       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436604712531       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436558923975       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436591698964       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436649732491       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436576086115       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436547135721       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436656567578       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.436610790154       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.436673271396       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.436606543316       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.436944881798       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.436960425558       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.436617033527       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.436772359398       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.436478959747       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.436419688848       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.436400167849       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.436613193884       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.436358742457       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.436638763059       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.436815503613       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.436410469713       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.436376457395       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.436586278012       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -22.436361131430       residual = 2.70e-05           smallest_sin_value = 9.99e-01
davidson iteration   39:   krylov dim =  40   energy =     -22.436631420635       residual = 1.80e-06           smallest_sin_value = 9.99e-01
davidson iteration   40:   krylov dim =  41   energy =     -22.435600416316       residual = 5.77e-04           smallest_sin_value = 9.97e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+09 is 7.912510e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383362 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0253e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.3343
    reference variance = 0.379347
====================================================
  Execution time = 4.4340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6280e-01
  Total weights = 2.0000e+06
  Execution time = 4.3354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562906176052
                                         uncertainty =       0.005305961967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562906176052
                                         uncertainty =       0.005305961967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530473313
  error estimate for blocks of size 2^( 2) =       0.000550419450
  error estimate for blocks of size 2^( 3) =       0.000569762742
  error estimate for blocks of size 2^( 4) =       0.000584280051
  error estimate for blocks of size 2^( 5) =       0.000596490454
  error estimate for blocks of size 2^( 6) =       0.000602251411
  error estimate for blocks of size 2^( 7) =       0.000604399991

      target function =                  N/A
              le_mean =     -22.436865993447
             les_mean =     503.975759197041
             stat err =       0.000596855477
             autocorr =       1.265934648582
              std dev =       0.750202553025
             le_variance =       0.562803870565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562906176052
                                         uncertainty =       0.005305961967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562906176052
                                         uncertainty =       0.005305961967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530473313
  error estimate for blocks of size 2^( 2) =       0.000550419450
  error estimate for blocks of size 2^( 3) =       0.000569762742
  error estimate for blocks of size 2^( 4) =       0.000584280051
  error estimate for blocks of size 2^( 5) =       0.000596490454
  error estimate for blocks of size 2^( 6) =       0.000602251411
  error estimate for blocks of size 2^( 7) =       0.000604399991

      target function =                  N/A
              le_mean =     -22.436865993447
             les_mean =     503.975759197041
             stat err =       0.000596855477
             autocorr =       1.265934648577
              std dev =       0.750202553025
             le_variance =       0.562803870565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562906176052
                                         uncertainty =       0.005305961967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562906176052
                                         uncertainty =       0.005305961967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530473313
  error estimate for blocks of size 2^( 2) =       0.000550419450
  error estimate for blocks of size 2^( 3) =       0.000569762742
  error estimate for blocks of size 2^( 4) =       0.000584280051
  error estimate for blocks of size 2^( 5) =       0.000596490454
  error estimate for blocks of size 2^( 6) =       0.000602251411
  error estimate for blocks of size 2^( 7) =       0.000604399991

      target function =                  N/A
              le_mean =     -22.436865993447
             les_mean =     503.975759197040
             stat err =       0.000596855477
             autocorr =       1.265934648572
              std dev =       0.750202553025
             le_variance =       0.562803870565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562906176052
                                         uncertainty =       0.005305961967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562906176052
                                         uncertainty =       0.005305961967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530473313
  error estimate for blocks of size 2^( 2) =       0.000550419450
  error estimate for blocks of size 2^( 3) =       0.000569762742
  error estimate for blocks of size 2^( 4) =       0.000584280051
  error estimate for blocks of size 2^( 5) =       0.000596490454
  error estimate for blocks of size 2^( 6) =       0.000602251411
  error estimate for blocks of size 2^( 7) =       0.000604399991

      target function =                  N/A
              le_mean =     -22.436865993447
             les_mean =     503.975759197041
             stat err =       0.000596855477
             autocorr =       1.265934648578
              std dev =       0.750202553025
             le_variance =       0.562803870565


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436865993447        initial  <--
     3.7253e+08     3.7253e+09             1.3168e-12       -22.436865993447
     1.4901e+09     1.4901e+10             3.3607e-13       -22.436865993447
     5.9605e+09     5.9605e+10             7.9125e-14       -22.436865993447

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3363
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2460e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.4843
    reference variance = 0.509418
====================================================
  Execution time = 4.6877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6086e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5161e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560987118638
                                         uncertainty =       0.004621183924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560987118638
                                         uncertainty =       0.004621183924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529555816
  error estimate for blocks of size 2^( 2) =       0.000550212941
  error estimate for blocks of size 2^( 3) =       0.000569101232
  error estimate for blocks of size 2^( 4) =       0.000584987805
  error estimate for blocks of size 2^( 5) =       0.000593083524
  error estimate for blocks of size 2^( 6) =       0.000597389724
  error estimate for blocks of size 2^( 7) =       0.000599118430

      target function =                  N/A
              le_mean =     -22.436785514149
             les_mean =     503.970202652840
             stat err =       0.000593644871
             autocorr =       1.256695194806
              std dev =       0.748905017574
             le_variance =       0.560858725348


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243678551415e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436785514149       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436785514149       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436785514149       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436785514149       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436785513485       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436785757941       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436783965559       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436786483109       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436777326752       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436789503273       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436776781389       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436792662863       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436779826439       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436782729382       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+09 is 1.510489e-13

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436785514149       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436785514149       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436785514149       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436785514149       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436786042657       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436784420943       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436786958207       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436811669152       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436720272213       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436731177678       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436817787317       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436734135229       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436775779647       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436834184345       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436769343413       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436777521642       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436857411892       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436674774667       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436865072637       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436844092150       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436066479913       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.435978356121       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.437480272977       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.436578366804       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.436648869724       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.437984006965       residual = 6.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.436554351047       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.436714354863       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.435321001371       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.437161161812       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.436688951070       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.436620000319       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.435805726891       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.436798827941       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.437471229562       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.436453216826       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.439248818806       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.434246529353       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -22.437451876057       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -22.435058718309       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -22.434854470697       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -22.434062291431       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -22.438577043617       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -22.436177174406       residual = 2.52e-04           smallest_sin_value = 9.97e-01
davidson iteration   44 stopping due to small subspace S singular value of 9.65e-01
davidson solver did not converge after         44 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+10 is 3.949657e-14

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436785514149       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436785514149       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436785514149       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436785514149       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436775098427       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436788515204       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436784815965       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436819927107       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436788648402       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436863267227       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436883740104       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436709575204       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437062502067       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436487335837       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436764729243       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436424604119       residual = 8.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437165168013       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.435558574536       residual = 8.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436620948575       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.435113246911       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.436888315927       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.436456735646       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.441096211027       residual = 9.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.434799758458       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.437450224653       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.436123756604       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.438496756474       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.436456090652       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.434152985394       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.435422274585       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.436113862704       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.436848158059       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.431732727591       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.436793511356       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.434337281893       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.440863247482       residual = 8.62e-03           smallest_sin_value = 9.99e-01
davidson iteration   36:   krylov dim =  37   energy =     -22.438357358127       residual = 2.21e-03           smallest_sin_value = 9.99e-01
davidson iteration   37:   krylov dim =  38   energy =     -22.435368731762       residual = 1.13e-03           smallest_sin_value = 9.95e-01
davidson iteration   38 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+10 is 9.046165e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.444559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2108e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.3831
    reference variance = 0.495502
====================================================
  Execution time = 4.4788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6796e-01
  Total weights = 2.0000e+06
  Execution time = 3.8383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568078247250
                                         uncertainty =       0.006265603848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568078247250
                                         uncertainty =       0.006265603848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532899046
  error estimate for blocks of size 2^( 2) =       0.000553354338
  error estimate for blocks of size 2^( 3) =       0.000572221268
  error estimate for blocks of size 2^( 4) =       0.000586324114
  error estimate for blocks of size 2^( 5) =       0.000596043493
  error estimate for blocks of size 2^( 6) =       0.000599579218
  error estimate for blocks of size 2^( 7) =       0.000603604832

      target function =                  N/A
              le_mean =     -22.436021421474
             les_mean =     503.943019728195
             stat err =       0.000596387914
             autocorr =       1.252471296842
              std dev =       0.753633058807
             le_variance =       0.567962787328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568078247250
                                         uncertainty =       0.006265603848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568078247250
                                         uncertainty =       0.006265603848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532899046
  error estimate for blocks of size 2^( 2) =       0.000553354338
  error estimate for blocks of size 2^( 3) =       0.000572221268
  error estimate for blocks of size 2^( 4) =       0.000586324114
  error estimate for blocks of size 2^( 5) =       0.000596043493
  error estimate for blocks of size 2^( 6) =       0.000599579218
  error estimate for blocks of size 2^( 7) =       0.000603604832

      target function =                  N/A
              le_mean =     -22.436021421474
             les_mean =     503.943019728195
             stat err =       0.000596387914
             autocorr =       1.252471296840
              std dev =       0.753633058807
             le_variance =       0.567962787327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568078247250
                                         uncertainty =       0.006265603848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568078247250
                                         uncertainty =       0.006265603848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532899046
  error estimate for blocks of size 2^( 2) =       0.000553354338
  error estimate for blocks of size 2^( 3) =       0.000572221268
  error estimate for blocks of size 2^( 4) =       0.000586324114
  error estimate for blocks of size 2^( 5) =       0.000596043493
  error estimate for blocks of size 2^( 6) =       0.000599579218
  error estimate for blocks of size 2^( 7) =       0.000603604832

      target function =                  N/A
              le_mean =     -22.436021421474
             les_mean =     503.943019728195
             stat err =       0.000596387914
             autocorr =       1.252471296840
              std dev =       0.753633058807
             le_variance =       0.567962787327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568078247250
                                         uncertainty =       0.006265603848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568078247250
                                         uncertainty =       0.006265603848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532899046
  error estimate for blocks of size 2^( 2) =       0.000553354338
  error estimate for blocks of size 2^( 3) =       0.000572221268
  error estimate for blocks of size 2^( 4) =       0.000586324114
  error estimate for blocks of size 2^( 5) =       0.000596043493
  error estimate for blocks of size 2^( 6) =       0.000599579218
  error estimate for blocks of size 2^( 7) =       0.000603604832

      target function =                  N/A
              le_mean =     -22.436021421474
             les_mean =     503.943019728195
             stat err =       0.000596387914
             autocorr =       1.252471296841
              std dev =       0.753633058807
             le_variance =       0.567962787328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436021421474        initial  <--
     3.7253e+09     3.7253e+10             1.5105e-13       -22.436021421474
     1.4901e+10     1.4901e+11             3.9497e-14       -22.436021421474
     5.9605e+10     5.9605e+11             9.0462e-15       -22.436021421474

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0455
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2617e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.4057
    reference variance = 0.455086
====================================================
  Execution time = 4.4949e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5196e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5202e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551993902079
                                         uncertainty =       0.003415831316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551993902079
                                         uncertainty =       0.003415831316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525336632
  error estimate for blocks of size 2^( 2) =       0.000545521525
  error estimate for blocks of size 2^( 3) =       0.000564102399
  error estimate for blocks of size 2^( 4) =       0.000578137528
  error estimate for blocks of size 2^( 5) =       0.000587000231
  error estimate for blocks of size 2^( 6) =       0.000590715293
  error estimate for blocks of size 2^( 7) =       0.000592382390

      target function =                  N/A
              le_mean =     -22.436326051195
             les_mean =     503.940683552550
             stat err =       0.000587058860
             autocorr =       1.248785721024
              std dev =       0.742938189203
             le_variance =       0.551957152976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243632605120e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436326051195       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436326051195       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436326051195       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436325916957       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436325206517       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436322962120       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436280534585       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436260805584       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435841625951       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436564714449       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436209856144       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436336277526       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436504023867       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436138191414       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436198566961       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.438042623287       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436618176308       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.435967713401       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437266636327       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.435614306711       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.435186437592       residual = 6.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.436854267042       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.435456138769       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.436651180324       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.436015073788       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.435055188706       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.435312210525       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.436210992231       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.436546339440       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.435920523734       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.438250777909       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.437875059172       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.433552835379       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.435258149124       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.434172779119       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.435824452614       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.438692477849       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.434135015406       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -22.440450517307       residual = 8.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -22.440542070648       residual = 9.16e-03           smallest_sin_value = 9.99e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+10 is 1.151359e-14

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436326051195       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436326051195       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436326051195       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436326051195       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436325518704       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436421094715       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436356631111       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436277142894       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437796232350       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436360307288       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436131081739       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.434454873923       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436940032750       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.435891108443       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437523640659       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.441868669068       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.439779623848       residual = 5.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436231989984       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.429014727509       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.432384542571       residual = 8.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.425607923732       residual = 6.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.431742902917       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.430428463558       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.441310903629       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.434338316538       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.442015885115       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.441567407062       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.434968621448       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.432352515355       residual = 8.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.440963523848       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.451398219254       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.426582602368       residual = 6.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.434207892115       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.436254653538       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.429747282070       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.419320076364       residual = 1.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.444784990259       residual = 4.46e-02           smallest_sin_value = 9.99e-01
davidson iteration   37:   krylov dim =  38   energy =     -22.424814978766       residual = 6.73e-02           smallest_sin_value = 9.96e-01
davidson iteration   38 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+11 is 3.287279e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436326051195       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436326051195       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436326051195       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436326051195       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436184373842       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436022589511       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437435525313       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.433888692787       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436537279780       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.440506786097       residual = 8.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437632752629       residual = 8.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.431073316783       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.428150203801       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.430101048051       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.444049815489       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.444129925942       residual = 3.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.431264286548       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.430299639904       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.431030525148       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.428494377506       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.428779575545       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.428284650362       residual = 3.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.426099356949       residual = 6.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.420428925424       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.438963659511       residual = 5.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.446833955728       residual = 5.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.428657542311       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.441055399563       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.441726928595       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.438229599705       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.440805746825       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.446779600300       residual = 5.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.414275691135       residual = 2.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.397667107697       residual = 7.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.396926436912       residual = 8.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.450192065283       residual = 1.10e-01           smallest_sin_value = 9.99e-01
davidson iteration   36:   krylov dim =  37   energy =     -22.424729815081       residual = 6.26e-02           smallest_sin_value = 9.94e-01
davidson iteration   37 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+11 is 2.572668e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.515011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0230e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.4249
    reference variance = 0.484251
====================================================
  Execution time = 4.4523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5756e-01
  Total weights = 2.0000e+06
  Execution time = 3.8389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557476241884
                                         uncertainty =       0.005998552028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557476241884
                                         uncertainty =       0.005998552028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527995631
  error estimate for blocks of size 2^( 2) =       0.000548233321
  error estimate for blocks of size 2^( 3) =       0.000567231453
  error estimate for blocks of size 2^( 4) =       0.000581854381
  error estimate for blocks of size 2^( 5) =       0.000591070403
  error estimate for blocks of size 2^( 6) =       0.000598023505
  error estimate for blocks of size 2^( 7) =       0.000601651459

      target function =                  N/A
              le_mean =     -22.436102707919
             les_mean =     503.936263215004
             stat err =       0.000593149937
             autocorr =       1.262026049305
              std dev =       0.746698582773
             le_variance =       0.557558773515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557476241884
                                         uncertainty =       0.005998552028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557476241884
                                         uncertainty =       0.005998552028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527995631
  error estimate for blocks of size 2^( 2) =       0.000548233321
  error estimate for blocks of size 2^( 3) =       0.000567231453
  error estimate for blocks of size 2^( 4) =       0.000581854381
  error estimate for blocks of size 2^( 5) =       0.000591070403
  error estimate for blocks of size 2^( 6) =       0.000598023505
  error estimate for blocks of size 2^( 7) =       0.000601651459

      target function =                  N/A
              le_mean =     -22.436102707919
             les_mean =     503.936263215004
             stat err =       0.000593149937
             autocorr =       1.262026049305
              std dev =       0.746698582773
             le_variance =       0.557558773515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557476241884
                                         uncertainty =       0.005998552028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557476241884
                                         uncertainty =       0.005998552028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527995631
  error estimate for blocks of size 2^( 2) =       0.000548233321
  error estimate for blocks of size 2^( 3) =       0.000567231453
  error estimate for blocks of size 2^( 4) =       0.000581854381
  error estimate for blocks of size 2^( 5) =       0.000591070403
  error estimate for blocks of size 2^( 6) =       0.000598023505
  error estimate for blocks of size 2^( 7) =       0.000601651459

      target function =                  N/A
              le_mean =     -22.436102707919
             les_mean =     503.936263215004
             stat err =       0.000593149937
             autocorr =       1.262026049305
              std dev =       0.746698582773
             le_variance =       0.557558773515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557476241884
                                         uncertainty =       0.005998552028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557476241884
                                         uncertainty =       0.005998552028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527995631
  error estimate for blocks of size 2^( 2) =       0.000548233321
  error estimate for blocks of size 2^( 3) =       0.000567231453
  error estimate for blocks of size 2^( 4) =       0.000581854381
  error estimate for blocks of size 2^( 5) =       0.000591070403
  error estimate for blocks of size 2^( 6) =       0.000598023505
  error estimate for blocks of size 2^( 7) =       0.000601651459

      target function =                  N/A
              le_mean =     -22.436102707919
             les_mean =     503.936263215004
             stat err =       0.000593149937
             autocorr =       1.262026049305
              std dev =       0.746698582773
             le_variance =       0.557558773515


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436102707919        initial  <--
     3.7253e+10     3.7253e+11             1.1514e-14       -22.436102707919
     1.4901e+11     1.4901e+12             3.2873e-15       -22.436102707919
     5.9605e+11     5.9605e+12             2.5727e-16       -22.436102707919

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.7687
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2401e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2434e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.4702
    reference variance = 0.751748
====================================================
  Execution time = 4.6520e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6098e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5385e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561032690799
                                         uncertainty =       0.006493991645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561032690799
                                         uncertainty =       0.006493991645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529610938
  error estimate for blocks of size 2^( 2) =       0.000549690970
  error estimate for blocks of size 2^( 3) =       0.000568554035
  error estimate for blocks of size 2^( 4) =       0.000582392249
  error estimate for blocks of size 2^( 5) =       0.000591872504
  error estimate for blocks of size 2^( 6) =       0.000596351021
  error estimate for blocks of size 2^( 7) =       0.000601003293

      target function =                  N/A
              le_mean =     -22.436017479261
             les_mean =     503.935855540422
             stat err =       0.000592904767
             autocorr =       1.253302748766
              std dev =       0.748982971251
             le_variance =       0.560975491225


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243601747926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436017479261       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436017479261       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436017479261       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436093395853       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435855275004       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436023996924       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436364839280       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436447006805       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435922497424       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435113489813       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435564172064       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436566203205       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437976007756       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.434341421808       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.432555112673       residual = 6.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.427628276169       residual = 3.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.409001343042       residual = 3.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.423969682903       residual = 7.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.438830804284       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.428504503504       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.400466125200       residual = 6.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.450137921830       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.423983147087       residual = 7.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.452910503620       residual = 1.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.437890197770       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.453765710054       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.435539613159       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.438529446980       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.424417048490       residual = 7.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.443909906502       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.427241693048       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.437468151246       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.436940015203       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.436952073185       residual = 9.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.430084030046       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.468704113167       residual = 5.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.451417705429       residual = 1.22e-01           smallest_sin_value = 9.99e-01
davidson iteration   37:   krylov dim =  38   energy =     -22.485208769235       residual = 1.26e+00           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   energy =     -22.455673943093       residual = 1.91e-01           smallest_sin_value = 9.96e-01
davidson iteration   39 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+11 is 7.780136e-16

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436017479261       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436017479261       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436017479261       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436017479261       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436017479260       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436017479264       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436023934330       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436295644107       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437219479425       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.449601812765       residual = 9.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.432114099693       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.471359637409       residual = 6.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.446664506926       residual = 5.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.424646494784       residual = 6.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.428855134632       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.403589278170       residual = 5.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.471792785833       residual = 6.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.399936391958       residual = 6.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.487957248757       residual = 1.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.495098532354       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.411867888549       residual = 3.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.490093055288       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.397058953612       residual = 8.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.495753467285       residual = 1.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.474452488169       residual = 7.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.382304605575       residual = 1.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.473939491920       residual = 7.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.429082347987       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.375362850956       residual = 1.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.445156135860       residual = 4.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.456077647393       residual = 2.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.475079155928       residual = 8.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.563933341032       residual = 8.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.445990273404       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.446568157539       residual = 3.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.413812763367       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.456552829476       residual = 2.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.493225463786       residual = 1.89e+00           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   energy =     -22.038704712596       residual = 8.41e+01           smallest_sin_value = 9.98e-01
davidson iteration   39:   krylov dim =  40   energy =     -22.875964595787       residual = 9.80e+01           smallest_sin_value = 9.91e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+12 is 2.383131e-16

solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436017479261       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436017479261       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436017479261       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436017479260       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421416492162       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.425213029453       residual = 6.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.413850550949       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.429392382050       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.448949707165       residual = 6.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.428131855515       residual = 3.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.401461685162       residual = 6.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.545164416024       residual = 6.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.322875124524       residual = 6.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.432941033240       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.549220389037       residual = 6.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.386081115431       residual = 1.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.594583371480       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.681413588223       residual = 3.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.297982908535       residual = 9.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.219924787499       residual = 2.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.609578102090       residual = 1.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.722401622300       residual = 3.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.465142079955       residual = 6.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.489926201935       residual = 1.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.374564843746       residual = 2.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.355945580008       residual = 3.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.509959295369       residual = 6.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.183671824492       residual = 4.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.171655779789       residual = 3.94e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.444950043102       residual = 2.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.317192332305       residual = 8.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.293035141188       residual = 1.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.109987484601       residual = 5.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.344548994936       residual = 5.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.524676302583       residual = 4.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -23.137695950790       residual = 2.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.477085881562       residual = 5.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.427235152396       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -22.292692449789       residual = 1.06e+01           smallest_sin_value = 9.99e-01
davidson iteration   39:   krylov dim =  40   energy =     -21.535294322594       residual = 4.38e+02           smallest_sin_value = 9.95e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.55e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+12 is 8.989269e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.592678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4325e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6113
    reference variance = 0.555382
====================================================
  Execution time = 4.4980e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 6.9089e-01
  Total weights = 2.0000e+06
  Execution time = 3.8413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.691056718739
                                         uncertainty =       0.130550622991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.691056718739
                                         uncertainty =       0.130550622991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000587743930
  error estimate for blocks of size 2^( 2) =       0.000605456443
  error estimate for blocks of size 2^( 3) =       0.000622961061
  error estimate for blocks of size 2^( 4) =       0.000635285291
  error estimate for blocks of size 2^( 5) =       0.000643936932
  error estimate for blocks of size 2^( 6) =       0.000646267310
  error estimate for blocks of size 2^( 7) =       0.000649298555

      target function =                  N/A
              le_mean =     -22.436895712993
             les_mean =     504.105174743891
             stat err =       0.000643697022
             autocorr =       1.199462556895
              std dev =       0.831195436484
             le_variance =       0.690885853633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.691056718739
                                         uncertainty =       0.130550622991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.691056718739
                                         uncertainty =       0.130550622991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000587743930
  error estimate for blocks of size 2^( 2) =       0.000605456443
  error estimate for blocks of size 2^( 3) =       0.000622961061
  error estimate for blocks of size 2^( 4) =       0.000635285291
  error estimate for blocks of size 2^( 5) =       0.000643936932
  error estimate for blocks of size 2^( 6) =       0.000646267310
  error estimate for blocks of size 2^( 7) =       0.000649298555

      target function =                  N/A
              le_mean =     -22.436895712993
             les_mean =     504.105174743891
             stat err =       0.000643697022
             autocorr =       1.199462556893
              std dev =       0.831195436484
             le_variance =       0.690885853633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.691056718739
                                         uncertainty =       0.130550622991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.691056718739
                                         uncertainty =       0.130550622991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000587743930
  error estimate for blocks of size 2^( 2) =       0.000605456443
  error estimate for blocks of size 2^( 3) =       0.000622961061
  error estimate for blocks of size 2^( 4) =       0.000635285291
  error estimate for blocks of size 2^( 5) =       0.000643936932
  error estimate for blocks of size 2^( 6) =       0.000646267310
  error estimate for blocks of size 2^( 7) =       0.000649298555

      target function =                  N/A
              le_mean =     -22.436895712993
             les_mean =     504.105174743891
             stat err =       0.000643697022
             autocorr =       1.199462556892
              std dev =       0.831195436484
             le_variance =       0.690885853633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.691056718739
                                         uncertainty =       0.130550622991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.691056718739
                                         uncertainty =       0.130550622991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000587743930
  error estimate for blocks of size 2^( 2) =       0.000605456443
  error estimate for blocks of size 2^( 3) =       0.000622961061
  error estimate for blocks of size 2^( 4) =       0.000635285291
  error estimate for blocks of size 2^( 5) =       0.000643936932
  error estimate for blocks of size 2^( 6) =       0.000646267310
  error estimate for blocks of size 2^( 7) =       0.000649298555

      target function =                  N/A
              le_mean =     -22.436895712993
             les_mean =     504.105174743891
             stat err =       0.000643697022
             autocorr =       1.199462556891
              std dev =       0.831195436484
             le_variance =       0.690885853633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436895712993        initial  <--
     3.7253e+11     3.7253e+12             7.7801e-16       -22.436895712993
     1.4901e+12     1.4901e+13             2.3831e-16       -22.436895712993
     5.9605e+12     5.9605e+13             8.9893e-18       -22.436895712993

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2551
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2859e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2437e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.4791
    reference variance = 0.727858
====================================================
  Execution time = 4.5842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6260e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5135e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562375789306
                                         uncertainty =       0.004422519689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562375789306
                                         uncertainty =       0.004422519689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530376467
  error estimate for blocks of size 2^( 2) =       0.000551078028
  error estimate for blocks of size 2^( 3) =       0.000570163151
  error estimate for blocks of size 2^( 4) =       0.000584588111
  error estimate for blocks of size 2^( 5) =       0.000593616879
  error estimate for blocks of size 2^( 6) =       0.000599807726
  error estimate for blocks of size 2^( 7) =       0.000601161908

      target function =                  N/A
              le_mean =     -22.436134900629
             les_mean =     503.942747391835
             stat err =       0.000594793656
             autocorr =       1.257662648843
              std dev =       0.750065593072
             le_variance =       0.562598393910


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243613490063e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436134900629       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436134900629       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436134900629       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436134900629       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436134900629       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436134900629       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.593756 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0986e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.347
    reference variance = 0.595448
====================================================
  Execution time = 4.4297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5996e-01
  Total weights = 2.0000e+06
  Execution time = 3.7820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559961567080
                                         uncertainty =       0.005446748268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559961567080
                                         uncertainty =       0.005446748268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529130818
  error estimate for blocks of size 2^( 2) =       0.000549001748
  error estimate for blocks of size 2^( 3) =       0.000567950652
  error estimate for blocks of size 2^( 4) =       0.000582154616
  error estimate for blocks of size 2^( 5) =       0.000591929791
  error estimate for blocks of size 2^( 6) =       0.000596822502
  error estimate for blocks of size 2^( 7) =       0.000600828765

      target function =                  N/A
              le_mean =     -22.437565991264
             les_mean =     504.004326178495
             stat err =       0.000592933919
             autocorr =       1.255701679787
              std dev =       0.748303979775
             le_variance =       0.559958846148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559961567080
                                         uncertainty =       0.005446748268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559961567080
                                         uncertainty =       0.005446748268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529130818
  error estimate for blocks of size 2^( 2) =       0.000549001748
  error estimate for blocks of size 2^( 3) =       0.000567950652
  error estimate for blocks of size 2^( 4) =       0.000582154616
  error estimate for blocks of size 2^( 5) =       0.000591929791
  error estimate for blocks of size 2^( 6) =       0.000596822502
  error estimate for blocks of size 2^( 7) =       0.000600828765

      target function =                  N/A
              le_mean =     -22.437565991264
             les_mean =     504.004326178495
             stat err =       0.000592933919
             autocorr =       1.255701679787
              std dev =       0.748303979775
             le_variance =       0.559958846148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559961567080
                                         uncertainty =       0.005446748268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559961567080
                                         uncertainty =       0.005446748268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529130818
  error estimate for blocks of size 2^( 2) =       0.000549001748
  error estimate for blocks of size 2^( 3) =       0.000567950652
  error estimate for blocks of size 2^( 4) =       0.000582154616
  error estimate for blocks of size 2^( 5) =       0.000591929791
  error estimate for blocks of size 2^( 6) =       0.000596822502
  error estimate for blocks of size 2^( 7) =       0.000600828765

      target function =                  N/A
              le_mean =     -22.437565991264
             les_mean =     504.004326178495
             stat err =       0.000592933919
             autocorr =       1.255701679787
              std dev =       0.748303979775
             le_variance =       0.559958846148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559961567080
                                         uncertainty =       0.005446748268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559961567080
                                         uncertainty =       0.005446748268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529130818
  error estimate for blocks of size 2^( 2) =       0.000549001748
  error estimate for blocks of size 2^( 3) =       0.000567950652
  error estimate for blocks of size 2^( 4) =       0.000582154616
  error estimate for blocks of size 2^( 5) =       0.000591929791
  error estimate for blocks of size 2^( 6) =       0.000596822502
  error estimate for blocks of size 2^( 7) =       0.000600828765

      target function =                  N/A
              le_mean =     -22.437565991264
             les_mean =     504.004326178495
             stat err =       0.000592933919
             autocorr =       1.255701679787
              std dev =       0.748303979775
             le_variance =       0.559958846148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437565991264        initial  <--
     3.7253e+12     3.7253e+13             0.0000e+00       -22.437565991264
     1.4901e+13     1.4901e+14             0.0000e+00       -22.437565991264
     5.9605e+13     5.9605e+14             0.0000e+00       -22.437565991264

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.2601
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2426e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2436e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.4872
    reference variance = 0.492678
====================================================
  Execution time = 4.5165e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6099e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5595e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560898234963
                                         uncertainty =       0.004500214582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560898234963
                                         uncertainty =       0.004500214582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529618410
  error estimate for blocks of size 2^( 2) =       0.000549814242
  error estimate for blocks of size 2^( 3) =       0.000568279980
  error estimate for blocks of size 2^( 4) =       0.000583716540
  error estimate for blocks of size 2^( 5) =       0.000592861255
  error estimate for blocks of size 2^( 6) =       0.000596823930
  error estimate for blocks of size 2^( 7) =       0.000598055918

      target function =                  N/A
              le_mean =     -22.437743681151
             les_mean =     504.013332541836
             stat err =       0.000592864411
             autocorr =       1.253096781117
              std dev =       0.748993538895
             le_variance =       0.560991321307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243774368115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437743681151       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437743681151       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437743681151       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437743681151       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.505354807743       residual = 2.67e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.432179281908       residual = 3.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.434185990125       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.332138102513       residual = 5.40e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.431231657416       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435593628268       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.567014537859       residual = 9.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -21.841364521817       residual = 1.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.311565299048       residual = 8.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -21.915836104298       residual = 1.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -21.230350921548       residual = 7.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -20.077992855648       residual = 3.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -21.137720193252       residual = 8.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.821540851796       residual = 8.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -20.098466786827       residual = 2.93e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -21.751127129731       residual = 2.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -24.279158340419       residual = 1.72e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -21.288656867279       residual = 6.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.144117947701       residual = 5.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.367763425749       residual = 2.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -21.387516451931       residual = 5.89e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -23.147467370633       residual = 2.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -25.406862973272       residual = 4.62e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -21.712663395538       residual = 2.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -19.509314699011       residual = 4.50e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -24.321474588564       residual = 1.99e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -21.461798232411       residual = 4.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -23.417849032435       residual = 4.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.050121035840       residual = 1.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -23.492606225465       residual = 7.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -19.945506314012       residual = 3.24e+03           smallest_sin_value = 9.99e-01
davidson iteration   35:   krylov dim =  36   energy =     -23.338697643196       residual = 6.00e+02           smallest_sin_value = 9.96e-01
davidson iteration   36:   krylov dim =  37   energy =     -26.973399659707       residual = 1.14e+04           smallest_sin_value = 9.90e-01
davidson iteration   37 stopping due to small subspace S singular value of 9.71e-01
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+13 is 1.584318e-18

solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437743681151       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437743681151       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437743681151       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437743681151       residual = 7.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.214165131988       residual = 3.00e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.364650396147       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.822649938455       residual = 7.10e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -21.480014017420       residual = 5.04e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.677809316871       residual = 3.12e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.906358293448       residual = 1.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.177135672754       residual = 3.80e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -21.282863864549       residual = 7.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -21.698233515040       residual = 2.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -21.092485143667       residual = 9.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -20.937053407866       residual = 1.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -23.428613710973       residual = 5.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.712335459889       residual = 5.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -27.263217101419       residual = 1.22e+04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -27.117044901683       residual = 1.17e+04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.846702941326       residual = 1.65e+04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -21.863330122006       residual = 2.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -23.167834903364       residual = 3.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -29.875786076324       residual = 2.87e+04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -23.902180278071       residual = 1.50e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -26.625318438281       residual = 8.88e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.615917822941       residual = 1.76e+04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -23.015307820064       residual = 3.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -25.319228556488       residual = 3.99e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.837524722412       residual = 1.68e+04           smallest_sin_value = 1.00e+00
davidson iteration   29 stopping due to too large eigenvalue change
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+14 is 3.960795e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+14, overlap shift 5.9605e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437743681151       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437743681151       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437743681151       residual = 5.94e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.463875075617       residual = 3.82e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.441816733800       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.218358622748       residual = 1.46e+04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -21.824230537693       residual = 2.10e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -24.583483090000       residual = 2.36e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.369354524747       residual = 1.95e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -23.775053106657       residual = 9.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -26.100023314660       residual = 7.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   11 stopping due to too large eigenvalue change
davidson solver did not converge after         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+14 is 9.901987e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.638398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0813e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.4831
    reference variance = 0.479696
====================================================
  Execution time = 4.6970e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5542e-01
  Total weights = 2.0000e+06
  Execution time = 4.2954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555461491354
                                         uncertainty =       0.003493620271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555461491354
                                         uncertainty =       0.003493620271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526981697
  error estimate for blocks of size 2^( 2) =       0.000547725488
  error estimate for blocks of size 2^( 3) =       0.000566414959
  error estimate for blocks of size 2^( 4) =       0.000580111250
  error estimate for blocks of size 2^( 5) =       0.000589273363
  error estimate for blocks of size 2^( 6) =       0.000593581435
  error estimate for blocks of size 2^( 7) =       0.000595909437

      target function =                  N/A
              le_mean =     -22.438213625793
             les_mean =     504.028849856839
             stat err =       0.000589718871
             autocorr =       1.252272917064
              std dev =       0.745264662942
             le_variance =       0.555419417830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555461491354
                                         uncertainty =       0.003493620271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555461491354
                                         uncertainty =       0.003493620271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526981697
  error estimate for blocks of size 2^( 2) =       0.000547725488
  error estimate for blocks of size 2^( 3) =       0.000566414959
  error estimate for blocks of size 2^( 4) =       0.000580111250
  error estimate for blocks of size 2^( 5) =       0.000589273363
  error estimate for blocks of size 2^( 6) =       0.000593581435
  error estimate for blocks of size 2^( 7) =       0.000595909437

      target function =                  N/A
              le_mean =     -22.438213625793
             les_mean =     504.028849856839
             stat err =       0.000589718871
             autocorr =       1.252272917064
              std dev =       0.745264662942
             le_variance =       0.555419417830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555461491354
                                         uncertainty =       0.003493620271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555461491354
                                         uncertainty =       0.003493620271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526981697
  error estimate for blocks of size 2^( 2) =       0.000547725488
  error estimate for blocks of size 2^( 3) =       0.000566414959
  error estimate for blocks of size 2^( 4) =       0.000580111250
  error estimate for blocks of size 2^( 5) =       0.000589273363
  error estimate for blocks of size 2^( 6) =       0.000593581435
  error estimate for blocks of size 2^( 7) =       0.000595909437

      target function =                  N/A
              le_mean =     -22.438213625793
             les_mean =     504.028849856839
             stat err =       0.000589718871
             autocorr =       1.252272917064
              std dev =       0.745264662942
             le_variance =       0.555419417830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555461491354
                                         uncertainty =       0.003493620271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555461491354
                                         uncertainty =       0.003493620271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526981697
  error estimate for blocks of size 2^( 2) =       0.000547725488
  error estimate for blocks of size 2^( 3) =       0.000566414959
  error estimate for blocks of size 2^( 4) =       0.000580111250
  error estimate for blocks of size 2^( 5) =       0.000589273363
  error estimate for blocks of size 2^( 6) =       0.000593581435
  error estimate for blocks of size 2^( 7) =       0.000595909437

      target function =                  N/A
              le_mean =     -22.438213625793
             les_mean =     504.028849856839
             stat err =       0.000589718871
             autocorr =       1.252272917064
              std dev =       0.745264662942
             le_variance =       0.555419417830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438213625793        initial  <--
     3.7253e+13     3.7253e+14             1.5843e-18       -22.438213625793
     1.4901e+14     1.4901e+15             3.9608e-19       -22.438213625793
     5.9605e+14     5.9605e+15             9.9020e-20       -22.438213625793

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.5069
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.771887e-01 1 1  ON 0
 uu_1                 1.024378e-01 1 1  ON 1
 uu_2                -1.266906e-02 1 1  ON 2
 uu_3                -8.108008e-02 1 1  ON 3
 uu_4                -1.200765e-01 1 1  ON 4
 uu_5                -1.414121e-01 1 1  ON 5
 uu_6                -1.486704e-01 1 1  ON 6
 uu_7                -1.398380e-01 1 1  ON 7
 uu_8                -1.099909e-01 1 1  ON 8
 uu_9                -3.880750e-02 1 1  ON 9
 ud_0                 4.437213e-01 1 1  ON 10
 ud_1                 1.598326e-01 1 1  ON 11
 ud_2                 1.038082e-02 1 1  ON 12
 ud_3                -7.239685e-02 1 1  ON 13
 ud_4                -1.198735e-01 1 1  ON 14
 ud_5                -1.493309e-01 1 1  ON 15
 ud_6                -1.648424e-01 1 1  ON 16
 ud_7                -1.647988e-01 1 1  ON 17
 ud_8                -1.416315e-01 1 1  ON 18
 ud_9                -8.125248e-02 1 1  ON 19
 eC_0                -5.983428e-01 1 1  ON 20
 eC_1                -4.271921e-01 1 1  ON 21
 eC_2                -1.300874e-01 1 1  ON 22
 eC_3                 7.791651e-02 1 1  ON 23
 eC_4                 2.049978e-01 1 1  ON 24
 eC_5                 3.020758e-01 1 1  ON 25
 eC_6                 2.772269e-01 1 1  ON 26
 eC_7                 2.148890e-01 1 1  ON 27
 eC_8                 6.600203e-02 1 1  ON 28
 eC_9                 1.065118e-02 1 1  ON 29
 eO_0                -1.091197e+00 1 1  ON 30
 eO_1                -7.021213e-01 1 1  ON 31
 eO_2                -2.188593e-01 1 1  ON 32
 eO_3                 9.383763e-02 1 1  ON 33
 eO_4                 3.001281e-01 1 1  ON 34
 eO_5                 4.157562e-01 1 1  ON 35
 eO_6                 4.154236e-01 1 1  ON 36
 eO_7                 3.830050e-01 1 1  ON 37
 eO_8                 2.564936e-01 1 1  ON 38
 eO_9                 1.058920e-01 1 1  ON 39
eH1_0                -1.540833e-01 1 1  ON 40
eH1_1                -5.388543e-02 1 1  ON 41
eH1_2                -3.389457e-02 1 1  ON 42
eH1_3                -3.192417e-02 1 1  ON 43
eH1_4                 6.004298e-03 1 1  ON 44
eH1_5                 1.561575e-02 1 1  ON 45
eH1_6                 4.343737e-02 1 1  ON 46
eH1_7                 4.724991e-02 1 1  ON 47
eH1_8                 5.142855e-02 1 1  ON 48
eH1_9                 7.803433e-02 1 1  ON 49
eH2_0                -1.531186e-01 1 1  ON 50
eH2_1                -5.332954e-02 1 1  ON 51
eH2_2                -3.223585e-02 1 1  ON 52
eH2_3                -3.031815e-02 1 1  ON 53
eH2_4                 7.378566e-03 1 1  ON 54
eH2_5                 1.726846e-02 1 1  ON 55
eH2_6                 4.447938e-02 1 1  ON 56
eH2_7                 4.534540e-02 1 1  ON 57
eH2_8                 4.115294e-02 1 1  ON 58
eH2_9                 7.959143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2733e+02 secs
  Total Execution time = 5.0478e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
