Rank =    0  Free Memory = 77433 MB
Rank =    1  Free Memory = 77433 MB
Rank =    2  Free Memory = 77433 MB
Rank =    3  Free Memory = 77433 MB
Rank =    4  Free Memory = 77432 MB
Rank =    5  Free Memory = 77432 MB
Rank =    6  Free Memory = 77432 MB
Rank =    7  Free Memory = 77432 MB
Rank =    8  Free Memory = 77431 MB
Rank =    9  Free Memory = 77431 MB
Rank =   10  Free Memory = 77431 MB
Rank =   11  Free Memory = 77429 MB
Rank =   12  Free Memory = 77429 MB
Rank =   13  Free Memory = 77429 MB
Rank =   14  Free Memory = 77429 MB
Rank =   15  Free Memory = 77419 MB
Rank =   16  Free Memory = 77418 MB
Rank =   17  Free Memory = 77418 MB
Rank =   18  Free Memory = 77418 MB
Rank =   19  Free Memory = 77418 MB
Rank =   20  Free Memory = 77417 MB
Rank =   21  Free Memory = 77417 MB
Rank =   22  Free Memory = 77417 MB
Rank =   23  Free Memory = 77417 MB
Rank =   24  Free Memory = 77417 MB
Rank =   25  Free Memory = 77417 MB
Rank =   26  Free Memory = 77417 MB
Rank =   27  Free Memory = 77417 MB
Rank =   28  Free Memory = 77417 MB
Rank =   29  Free Memory = 77417 MB
Rank =   30  Free Memory = 77416 MB
Rank =   31  Free Memory = 77416 MB
Rank =   32  Free Memory = 68152 MB
Rank =   33  Free Memory = 68152 MB
Rank =   34  Free Memory = 68152 MB
Rank =   35  Free Memory = 68152 MB
Rank =   36  Free Memory = 68152 MB
Rank =   37  Free Memory = 68152 MB
Rank =   38  Free Memory = 68152 MB
Rank =   39  Free Memory = 68152 MB
Rank =   40  Free Memory = 68152 MB
Rank =   41  Free Memory = 68151 MB
Rank =   42  Free Memory = 68151 MB
Rank =   43  Free Memory = 68151 MB
Rank =   44  Free Memory = 68151 MB
Rank =   45  Free Memory = 68151 MB
Rank =   46  Free Memory = 68151 MB
Rank =   47  Free Memory = 68151 MB
Rank =   48  Free Memory = 68151 MB
Rank =   49  Free Memory = 68151 MB
Rank =   50  Free Memory = 68151 MB
Rank =   51  Free Memory = 68151 MB
Rank =   52  Free Memory = 68151 MB
Rank =   53  Free Memory = 68151 MB
Rank =   54  Free Memory = 68151 MB
Rank =   55  Free Memory = 68151 MB
Rank =   56  Free Memory = 68151 MB
Rank =   57  Free Memory = 68151 MB
Rank =   58  Free Memory = 68151 MB
Rank =   59  Free Memory = 68151 MB
Rank =   60  Free Memory = 68151 MB
Rank =   61  Free Memory = 68151 MB
Rank =   62  Free Memory = 68151 MB
Rank =   63  Free Memory = 68151 MB
Rank =   64  Free Memory = 73812 MB
Rank =   65  Free Memory = 73812 MB
Rank =   66  Free Memory = 73812 MB
Rank =   67  Free Memory = 73812 MB
Rank =   68  Free Memory = 73812 MB
Rank =   69  Free Memory = 73812 MB
Rank =   70  Free Memory = 73812 MB
Rank =   71  Free Memory = 73812 MB
Rank =   72  Free Memory = 73812 MB
Rank =   73  Free Memory = 73812 MB
Rank =   74  Free Memory = 73812 MB
Rank =   75  Free Memory = 73812 MB
Rank =   76  Free Memory = 73812 MB
Rank =   77  Free Memory = 73812 MB
Rank =   78  Free Memory = 73812 MB
Rank =   79  Free Memory = 73812 MB
Rank =   80  Free Memory = 73812 MB
Rank =   81  Free Memory = 73812 MB
Rank =   82  Free Memory = 73812 MB
Rank =   83  Free Memory = 73812 MB
Rank =   84  Free Memory = 73812 MB
Rank =   85  Free Memory = 73812 MB
Rank =   86  Free Memory = 73812 MB
Rank =   87  Free Memory = 73812 MB
Rank =   88  Free Memory = 73812 MB
Rank =   89  Free Memory = 73812 MB
Rank =   90  Free Memory = 73812 MB
Rank =   91  Free Memory = 73812 MB
Rank =   92  Free Memory = 73812 MB
Rank =   93  Free Memory = 73812 MB
Rank =   94  Free Memory = 73812 MB
Rank =   95  Free Memory = 73812 MB
Rank =   96  Free Memory = 74158 MB
Rank =   97  Free Memory = 74158 MB
Rank =   98  Free Memory = 74158 MB
Rank =   99  Free Memory = 74158 MB
Rank =  100  Free Memory = 74158 MB
Rank =  101  Free Memory = 74158 MB
Rank =  102  Free Memory = 74158 MB
Rank =  103  Free Memory = 74158 MB
Rank =  104  Free Memory = 74158 MB
Rank =  105  Free Memory = 74158 MB
Rank =  106  Free Memory = 74158 MB
Rank =  107  Free Memory = 74158 MB
Rank =  108  Free Memory = 74158 MB
Rank =  109  Free Memory = 74158 MB
Rank =  110  Free Memory = 74158 MB
Rank =  111  Free Memory = 74158 MB
Rank =  112  Free Memory = 74158 MB
Rank =  113  Free Memory = 74158 MB
Rank =  114  Free Memory = 74158 MB
Rank =  115  Free Memory = 74158 MB
Rank =  116  Free Memory = 74158 MB
Rank =  117  Free Memory = 74158 MB
Rank =  118  Free Memory = 74158 MB
Rank =  119  Free Memory = 74158 MB
Rank =  120  Free Memory = 74158 MB
Rank =  121  Free Memory = 74158 MB
Rank =  122  Free Memory = 74158 MB
Rank =  123  Free Memory = 74158 MB
Rank =  124  Free Memory = 74158 MB
Rank =  125  Free Memory = 74158 MB
Rank =  126  Free Memory = 74158 MB
Rank =  127  Free Memory = 74158 MB
  Input file(s): opt_form_pi2pistar_gvptt_93dets_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_pi2pistar_gvptt_93dets_run001d.xml

  Project = FORM
  date    = 2023-05-12 08:51:39 PDT
  host    = n0094.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 139

  Range of prime numbers to use as seeds over processors and threads = 811-1723


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.710801e-01    1         1  ON     0
     uu_1                 9.228597e-02    1         1  ON     1
     uu_2                -2.467525e-02    1         1  ON     2
     uu_3                -9.608982e-02    1         1  ON     3
     uu_4                -1.380390e-01    1         1  ON     4
     uu_5                -1.641925e-01    1         1  ON     5
     uu_6                -1.788812e-01    1         1  ON     6
     uu_7                -1.828828e-01    1         1  ON     7
     uu_8                -1.725211e-01    1         1  ON     8
     uu_9                -1.422666e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.715394e-01    1         1  ON     0
     ud_1                 1.867257e-01    1         1  ON     1
     ud_2                 3.590558e-02    1         1  ON     2
     ud_3                -4.932680e-02    1         1  ON     3
     ud_4                -1.008758e-01    1         1  ON     4
     ud_5                -1.360711e-01    1         1  ON     5
     ud_6                -1.597635e-01    1         1  ON     6
     ud_7                -1.711930e-01    1         1  ON     7
     ud_8                -1.711014e-01    1         1  ON     8
     ud_9                -1.441632e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -7.000050e-01    1         1  ON     0
     eC_1                -5.249143e-01    1         1  ON     1
     eC_2                -2.182725e-01    1         1  ON     2
     eC_3                 6.721558e-03    1         1  ON     3
     eC_4                 1.601314e-01    1         1  ON     4
     eC_5                 2.789344e-01    1         1  ON     5
     eC_6                 3.004736e-01    1         1  ON     6
     eC_7                 3.717032e-01    1         1  ON     7
     eC_8                 2.749706e-01    1         1  ON     8
     eC_9                 4.884112e-02    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.244926e+00    1         1  ON     0
     eO_1                -8.506261e-01    1         1  ON     1
     eO_2                -3.568556e-01    1         1  ON     2
     eO_3                -3.121038e-02    1         1  ON     3
     eO_4                 1.967167e-01    1         1  ON     4
     eO_5                 3.456084e-01    1         1  ON     5
     eO_6                 3.953912e-01    1         1  ON     6
     eO_7                 4.454808e-01    1         1  ON     7
     eO_8                 5.413376e-01    1         1  ON     8
     eO_9                 3.982732e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.669014e-01    1         1  ON     0
     eH1_1                -6.420466e-02    1         1  ON     1
     eH1_2                -4.215015e-02    1         1  ON     2
     eH1_3                -3.978239e-02    1         1  ON     3
     eH1_4                -1.637475e-03    1         1  ON     4
     eH1_5                 9.202379e-03    1         1  ON     5
     eH1_6                 4.339434e-02    1         1  ON     6
     eH1_7                 7.166048e-02    1         1  ON     7
     eH1_8                 3.199576e-02    1         1  ON     8
     eH1_9                 6.015175e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.762214e-01    1         1  ON     0
     eH2_1                -7.379531e-02    1         1  ON     1
     eH2_2                -5.367799e-02    1         1  ON     2
     eH2_3                -5.365008e-02    1         1  ON     3
     eH2_4                -1.459218e-02    1         1  ON     4
     eH2_5                -3.263911e-03    1         1  ON     5
     eH2_6                 2.902421e-02    1         1  ON     6
     eH2_7                 5.203835e-02    1         1  ON     7
     eH2_8                 2.658971e-02    1         1  ON     8
     eH2_9                 1.187710e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 93 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.731262e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 23 unique up determinants.
Found 23 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.4775e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  4.0107225728e-02 -5.0659535091e-01 -4.8356690577e-01
    u -2.0203417087e-01 -1.2691590666e+00 -2.1169263951e+00
    u  2.9913287695e-01 -2.3710879234e-01  2.0101719070e+00
    u  4.8474243406e-02 -5.3051852953e-01  9.5378285444e-01
    u -5.5511775119e-01 -9.8683271286e-02  1.4043240644e+00
    u  6.9646297924e-01  2.5004217823e+00 -2.4744046405e+00
    d -1.1004432466e+00 -7.1118992563e-01 -1.4300801983e+00
    d -3.6824818327e-02  7.5687344105e-01 -1.6708867165e+00
    d -9.4375526199e-01  1.5348935511e-01  1.1974289766e+00
    d -8.9321447322e-02 -6.9596903295e-02  1.4810785623e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.4942
    reference variance = 0.467354
====================================================
  Execution time = 4.5055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6055e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4840e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560674310217
                                         uncertainty =       0.004753606853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560674310217
                                         uncertainty =       0.004753606853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529410552
  error estimate for blocks of size 2^( 2) =       0.000549701517
  error estimate for blocks of size 2^( 3) =       0.000568453230
  error estimate for blocks of size 2^( 4) =       0.000583373523
  error estimate for blocks of size 2^( 5) =       0.000591659847
  error estimate for blocks of size 2^( 6) =       0.000595847502
  error estimate for blocks of size 2^( 7) =       0.000598102480

      target function =                  N/A
              le_mean =     -22.437878764343
             les_mean =     504.018954227425
             stat err =       0.000592245838
             autocorr =       1.251465405994
              std dev =       0.748699582177
             le_variance =       0.560551064352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.243787876434e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437878764343       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437888228797       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437894527811       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437896047815       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437899612954       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437900620807       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437900065657       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437900233877       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437901131075       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437901169811       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437901185363       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437901020943       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437900744995       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437901169584       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437901276514       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 2.134529e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437878764343       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437882110709       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437884732796       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437885010546       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437886153802       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437887144437       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437886970957       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437886806451       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437887136331       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437887005502       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437886964315       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437886946501       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437886945932       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 6.626552e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437878764343       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437879697593       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437880488904       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437880545373       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437880840374       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437881230598       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437881170467       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437881103950       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437881160735       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437881139972       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437881124808       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 2.027414e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.352514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0252e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.704174e-01                 1 1 ON  0
uu_1  9.239354e-02                 1 1 ON  1
uu_2  -2.451305e-02                1 1 ON  2
uu_3  -9.587965e-02                1 1 ON  3
uu_4  -1.380245e-01                1 1 ON  4
uu_5  -1.642267e-01                1 1 ON  5
uu_6  -1.788136e-01                1 1 ON  6
uu_7  -1.826619e-01                1 1 ON  7
uu_8  -1.724304e-01                1 1 ON  8
uu_9  -1.422899e-01                1 1 ON  9
ud_0  4.715428e-01                 1 1 ON  10
ud_1  1.868348e-01                 1 1 ON  11
ud_2  3.596478e-02                 1 1 ON  12
ud_3  -4.945331e-02                1 1 ON  13
ud_4  -1.008973e-01                1 1 ON  14
ud_5  -1.361151e-01                1 1 ON  15
ud_6  -1.596274e-01                1 1 ON  16
ud_7  -1.711410e-01                1 1 ON  17
ud_8  -1.708960e-01                1 1 ON  18
ud_9  -1.442392e-01                1 1 ON  19
eC_0  -7.000026e-01                1 1 ON  20
eC_1  -5.247848e-01                1 1 ON  21
eC_2  -2.181286e-01                1 1 ON  22
eC_3  6.901808e-03                 1 1 ON  23
eC_4  1.597264e-01                 1 1 ON  24
eC_5  2.789751e-01                 1 1 ON  25
eC_6  3.004073e-01                 1 1 ON  26
eC_7  3.715440e-01                 1 1 ON  27
eC_8  2.750411e-01                 1 1 ON  28
eC_9  4.889771e-02                 1 1 ON  29
eO_0  -1.244798e+00                1 1 ON  30
eO_1  -8.506425e-01                1 1 ON  31
eO_2  -3.571611e-01                1 1 ON  32
eO_3  -3.139537e-02                1 1 ON  33
eO_4  1.970443e-01                 1 1 ON  34
eO_5  3.455915e-01                 1 1 ON  35
eO_6  3.953818e-01                 1 1 ON  36
eO_7  4.455970e-01                 1 1 ON  37
eO_8  5.411004e-01                 1 1 ON  38
eO_9  3.983610e-01                 1 1 ON  39
eH1_0 -1.665870e-01                1 1 ON  40
eH1_1 -6.402541e-02                1 1 ON  41
eH1_2 -4.220028e-02                1 1 ON  42
eH1_3 -3.995024e-02                1 1 ON  43
eH1_4 -1.607898e-03                1 1 ON  44
eH1_5 9.438515e-03                 1 1 ON  45
eH1_6 4.323353e-02                 1 1 ON  46
eH1_7 7.110510e-02                 1 1 ON  47
eH1_8 3.209569e-02                 1 1 ON  48
eH1_9 6.015541e-02                 1 1 ON  49
eH2_0 -1.761343e-01                1 1 ON  50
eH2_1 -7.389270e-02                1 1 ON  51
eH2_2 -5.379991e-02                1 1 ON  52
eH2_3 -5.337834e-02                1 1 ON  53
eH2_4 -1.458711e-02                1 1 ON  54
eH2_5 -3.244635e-03                1 1 ON  55
eH2_6 2.910966e-02                 1 1 ON  56
eH2_7 5.183670e-02                 1 1 ON  57
eH2_8 2.660220e-02                 1 1 ON  58
eH2_9 1.186570e-01                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.5167
    reference variance = 0.941018
====================================================
  Execution time = 4.3024e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6347e-01
  Total weights = 2.0000e+06
  Execution time = 3.5991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563873430144
                                         uncertainty =       0.003209021518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563873430144
                                         uncertainty =       0.003209021518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530949266
  error estimate for blocks of size 2^( 2) =       0.000550805051
  error estimate for blocks of size 2^( 3) =       0.000569641966
  error estimate for blocks of size 2^( 4) =       0.000583152564
  error estimate for blocks of size 2^( 5) =       0.000594149383
  error estimate for blocks of size 2^( 6) =       0.000599983099
  error estimate for blocks of size 2^( 7) =       0.000602834649

      target function =                  N/A
              le_mean =     -22.437923211450
             les_mean =     504.024212007732
             stat err =       0.000595029924
             autocorr =       1.255947725772
              std dev =       0.750875653285
             le_variance =       0.563814246696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563176248928
                                         uncertainty =       0.003204520164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563176248928
                                         uncertainty =       0.003204520164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530620828
  error estimate for blocks of size 2^( 2) =       0.000550479511
  error estimate for blocks of size 2^( 3) =       0.000569298556
  error estimate for blocks of size 2^( 4) =       0.000582791389
  error estimate for blocks of size 2^( 5) =       0.000593772202
  error estimate for blocks of size 2^( 6) =       0.000599583129
  error estimate for blocks of size 2^( 7) =       0.000602441226

      target function =                  N/A
              le_mean =     -22.437931835159
             les_mean =     504.023901684134
             stat err =       0.000594646987
             autocorr =       1.255884958232
              std dev =       0.750411171598
             le_variance =       0.563116926460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563198538230
                                         uncertainty =       0.003204468758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563198538230
                                         uncertainty =       0.003204468758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530631378
  error estimate for blocks of size 2^( 2) =       0.000550492188
  error estimate for blocks of size 2^( 3) =       0.000569316984
  error estimate for blocks of size 2^( 4) =       0.000582814946
  error estimate for blocks of size 2^( 5) =       0.000593798680
  error estimate for blocks of size 2^( 6) =       0.000599613128
  error estimate for blocks of size 2^( 7) =       0.000602471236

      target function =                  N/A
              le_mean =     -22.437928682547
             les_mean =     504.023782599940
             stat err =       0.000594674497
             autocorr =       1.255951222149
              std dev =       0.750426091253
             le_variance =       0.563139318434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563758018875
                                         uncertainty =       0.003208256174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563758018875
                                         uncertainty =       0.003208256174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530894922
  error estimate for blocks of size 2^( 2) =       0.000550751488
  error estimate for blocks of size 2^( 3) =       0.000569586590
  error estimate for blocks of size 2^( 4) =       0.000583095281
  error estimate for blocks of size 2^( 5) =       0.000594090015
  error estimate for blocks of size 2^( 6) =       0.000599920818
  error estimate for blocks of size 2^( 7) =       0.000602773487

      target function =                  N/A
              le_mean =     -22.437923161966
             les_mean =     504.024094376732
             stat err =       0.000594969900
             autocorr =       1.255951438679
              std dev =       0.750798798795
             le_variance =       0.563698836273


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437923211450        initial
     2.5000e-01     2.5000e+00             2.1345e-03       -22.437931835159  <--
     1.0000e+00     1.0000e+01             6.6266e-04       -22.437928682547
     4.0000e+00     4.0000e+01             2.0274e-04       -22.437923161966

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.1014e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.695807e-01 1 1  ON 0
 uu_1                 9.251520e-02 1 1  ON 1
 uu_2                -2.430939e-02 1 1  ON 2
 uu_3                -9.559756e-02 1 1  ON 3
 uu_4                -1.379958e-01 1 1  ON 4
 uu_5                -1.642708e-01 1 1  ON 5
 uu_6                -1.787204e-01 1 1  ON 6
 uu_7                -1.822928e-01 1 1  ON 7
 uu_8                -1.721701e-01 1 1  ON 8
 uu_9                -1.423256e-01 1 1  ON 9
 ud_0                 4.716477e-01 1 1  ON 10
 ud_1                 1.870348e-01 1 1  ON 11
 ud_2                 3.606734e-02 1 1  ON 12
 ud_3                -4.954872e-02 1 1  ON 13
 ud_4                -1.009536e-01 1 1  ON 14
 ud_5                -1.361371e-01 1 1  ON 15
 ud_6                -1.594155e-01 1 1  ON 16
 ud_7                -1.710042e-01 1 1  ON 17
 ud_8                -1.704268e-01 1 1  ON 18
 ud_9                -1.444335e-01 1 1  ON 19
 eC_0                -6.998436e-01 1 1  ON 20
 eC_1                -5.244352e-01 1 1  ON 21
 eC_2                -2.177779e-01 1 1  ON 22
 eC_3                 7.157257e-03 1 1  ON 23
 eC_4                 1.589084e-01 1 1  ON 24
 eC_5                 2.789581e-01 1 1  ON 25
 eC_6                 3.002026e-01 1 1  ON 26
 eC_7                 3.710816e-01 1 1  ON 27
 eC_8                 2.752453e-01 1 1  ON 28
 eC_9                 4.906161e-02 1 1  ON 29
 eO_0                -1.244594e+00 1 1  ON 30
 eO_1                -8.506797e-01 1 1  ON 31
 eO_2                -3.575827e-01 1 1  ON 32
 eO_3                -3.175456e-02 1 1  ON 33
 eO_4                 1.974796e-01 1 1  ON 34
 eO_5                 3.456042e-01 1 1  ON 35
 eO_6                 3.953497e-01 1 1  ON 36
 eO_7                 4.458844e-01 1 1  ON 37
 eO_8                 5.404308e-01 1 1  ON 38
 eO_9                 3.986196e-01 1 1  ON 39
eH1_0                -1.658174e-01 1 1  ON 40
eH1_1                -6.362515e-02 1 1  ON 41
eH1_2                -4.225855e-02 1 1  ON 42
eH1_3                -4.023943e-02 1 1  ON 43
eH1_4                -1.593613e-03 1 1  ON 44
eH1_5                 9.872812e-03 1 1  ON 45
eH1_6                 4.308044e-02 1 1  ON 46
eH1_7                 6.952596e-02 1 1  ON 47
eH1_8                 3.234326e-02 1 1  ON 48
eH1_9                 6.016174e-02 1 1  ON 49
eH2_0                -1.759354e-01 1 1  ON 50
eH2_1                -7.401465e-02 1 1  ON 51
eH2_2                -5.392323e-02 1 1  ON 52
eH2_3                -5.298229e-02 1 1  ON 53
eH2_4                -1.454935e-02 1 1  ON 54
eH2_5                -3.107628e-03 1 1  ON 55
eH2_6                 2.935551e-02 1 1  ON 56
eH2_7                 5.122198e-02 1 1  ON 57
eH2_8                 2.662167e-02 1 1  ON 58
eH2_9                 1.183258e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2129e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2505e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.4927
    reference variance = 0.825579
====================================================
  Execution time = 4.3775e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7890e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5196e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578958132278
                                         uncertainty =       0.008227299518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578958132278
                                         uncertainty =       0.008227299518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538005173
  error estimate for blocks of size 2^( 2) =       0.000557624091
  error estimate for blocks of size 2^( 3) =       0.000576416680
  error estimate for blocks of size 2^( 4) =       0.000591002704
  error estimate for blocks of size 2^( 5) =       0.000599950634
  error estimate for blocks of size 2^( 6) =       0.000605321577
  error estimate for blocks of size 2^( 7) =       0.000605949842

      target function =                  N/A
              le_mean =     -22.437436866938
             les_mean =     504.017472001054
             stat err =       0.000600556189
             autocorr =       1.246046905677
              std dev =       0.760854212495
             le_variance =       0.578899132671


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243743686694e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437436866938       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437439162405       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437438409104       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437440034084       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437440777494       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437442566964       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437444524885       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437447920685       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437452017025       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437454333717       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437454023833       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437454206957       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437453622878       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437453369813       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437453176340       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437453985497       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437454425501       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.437453934974       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.437454323631       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 5.359668e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437436866938       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437438174956       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437437904226       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437438897946       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437439413343       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437439796030       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437440452045       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437442280102       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437444005750       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437444704084       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437444360762       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437443986439       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437443834566       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437443770791       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437443856132       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 1.796908e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437436866938       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437437347705       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437437294075       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437437690592       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437437953758       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437438011171       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437438183725       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437438758040       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437439074020       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437439293411       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437439250663       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437439154237       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 4.867197e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361560 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8984e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.689179e-01 1 1  ON 0
 uu_1                 9.276163e-02 1 1  ON 1
 uu_2                -2.409549e-02 1 1  ON 2
 uu_3                -9.531096e-02 1 1  ON 3
 uu_4                -1.377976e-01 1 1  ON 4
 uu_5                -1.642374e-01 1 1  ON 5
 uu_6                -1.787548e-01 1 1  ON 6
 uu_7                -1.823298e-01 1 1  ON 7
 uu_8                -1.718954e-01 1 1  ON 8
 uu_9                -1.424173e-01 1 1  ON 9
 ud_0                 4.714312e-01 1 1  ON 10
 ud_1                 1.868619e-01 1 1  ON 11
 ud_2                 3.598664e-02 1 1  ON 12
 ud_3                -4.964983e-02 1 1  ON 13
 ud_4                -1.010608e-01 1 1  ON 14
 ud_5                -1.360537e-01 1 1  ON 15
 ud_6                -1.591991e-01 1 1  ON 16
 ud_7                -1.705144e-01 1 1  ON 17
 ud_8                -1.694292e-01 1 1  ON 18
 ud_9                -1.446701e-01 1 1  ON 19
 eC_0                -6.993690e-01 1 1  ON 20
 eC_1                -5.239079e-01 1 1  ON 21
 eC_2                -2.176394e-01 1 1  ON 22
 eC_3                 7.317724e-03 1 1  ON 23
 eC_4                 1.580256e-01 1 1  ON 24
 eC_5                 2.786861e-01 1 1  ON 25
 eC_6                 3.000344e-01 1 1  ON 26
 eC_7                 3.706215e-01 1 1  ON 27
 eC_8                 2.755105e-01 1 1  ON 28
 eC_9                 4.926069e-02 1 1  ON 29
 eO_0                -1.244446e+00 1 1  ON 30
 eO_1                -8.509250e-01 1 1  ON 31
 eO_2                -3.578108e-01 1 1  ON 32
 eO_3                -3.220997e-02 1 1  ON 33
 eO_4                 1.975505e-01 1 1  ON 34
 eO_5                 3.456970e-01 1 1  ON 35
 eO_6                 3.957051e-01 1 1  ON 36
 eO_7                 4.462674e-01 1 1  ON 37
 eO_8                 5.394949e-01 1 1  ON 38
 eO_9                 3.989299e-01 1 1  ON 39
eH1_0                -1.650311e-01 1 1  ON 40
eH1_1                -6.289846e-02 1 1  ON 41
eH1_2                -4.221013e-02 1 1  ON 42
eH1_3                -4.048664e-02 1 1  ON 43
eH1_4                -1.695046e-03 1 1  ON 44
eH1_5                 9.840451e-03 1 1  ON 45
eH1_6                 4.311336e-02 1 1  ON 46
eH1_7                 6.772905e-02 1 1  ON 47
eH1_8                 3.262985e-02 1 1  ON 48
eH1_9                 6.025688e-02 1 1  ON 49
eH2_0                -1.754233e-01 1 1  ON 50
eH2_1                -7.397362e-02 1 1  ON 51
eH2_2                -5.398102e-02 1 1  ON 52
eH2_3                -5.283202e-02 1 1  ON 53
eH2_4                -1.448848e-02 1 1  ON 54
eH2_5                -2.986862e-03 1 1  ON 55
eH2_6                 2.954174e-02 1 1  ON 56
eH2_7                 5.033639e-02 1 1  ON 57
eH2_8                 2.674926e-02 1 1  ON 58
eH2_9                 1.178772e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.4945
    reference variance = 0.555865
====================================================
  Execution time = 4.5271e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6994e-01
  Total weights = 2.0000e+06
  Execution time = 3.5800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570500321598
                                         uncertainty =       0.008149544951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570500321598
                                         uncertainty =       0.008149544951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534089402
  error estimate for blocks of size 2^( 2) =       0.000553876103
  error estimate for blocks of size 2^( 3) =       0.000571785488
  error estimate for blocks of size 2^( 4) =       0.000584589331
  error estimate for blocks of size 2^( 5) =       0.000591834283
  error estimate for blocks of size 2^( 6) =       0.000595993030
  error estimate for blocks of size 2^( 7) =       0.000596754097

      target function =                  N/A
              le_mean =     -22.437397010944
             les_mean =     504.007287320795
             stat err =       0.000592292685
             autocorr =       1.229829247095
              std dev =       0.755316476261
             le_variance =       0.570502979311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569421883845
                                         uncertainty =       0.008113760947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569421883845
                                         uncertainty =       0.008113760947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533584343
  error estimate for blocks of size 2^( 2) =       0.000553376642
  error estimate for blocks of size 2^( 3) =       0.000571297960
  error estimate for blocks of size 2^( 4) =       0.000584113888
  error estimate for blocks of size 2^( 5) =       0.000591376460
  error estimate for blocks of size 2^( 6) =       0.000595542687
  error estimate for blocks of size 2^( 7) =       0.000596300999

      target function =                  N/A
              le_mean =     -22.437401061813
             les_mean =     504.006390627017
             stat err =       0.000591833509
             autocorr =       1.230248786096
              std dev =       0.754602215143
             le_variance =       0.569424503099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569393735839
                                         uncertainty =       0.008116006646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569393735839
                                         uncertainty =       0.008116006646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533571119
  error estimate for blocks of size 2^( 2) =       0.000553369102
  error estimate for blocks of size 2^( 3) =       0.000571293711
  error estimate for blocks of size 2^( 4) =       0.000584110021
  error estimate for blocks of size 2^( 5) =       0.000591365001
  error estimate for blocks of size 2^( 6) =       0.000595527412
  error estimate for blocks of size 2^( 7) =       0.000596280617

      target function =                  N/A
              le_mean =     -22.437399199939
             les_mean =     504.006278850464
             stat err =       0.000591820763
             autocorr =       1.230256778769
              std dev =       0.754583512764
             le_variance =       0.569396277735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570270964826
                                         uncertainty =       0.008143328108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570270964826
                                         uncertainty =       0.008143328108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533982016
  error estimate for blocks of size 2^( 2) =       0.000553771391
  error estimate for blocks of size 2^( 3) =       0.000571684286
  error estimate for blocks of size 2^( 4) =       0.000584490683
  error estimate for blocks of size 2^( 5) =       0.000591737100
  error estimate for blocks of size 2^( 6) =       0.000595896165
  error estimate for blocks of size 2^( 7) =       0.000596655327

      target function =                  N/A
              le_mean =     -22.437396299288
             les_mean =     504.007025993160
             stat err =       0.000592194819
             autocorr =       1.229917399530
              std dev =       0.755164609199
             le_variance =       0.570273586987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437397010944        initial
     6.2500e-02     6.2500e-01             5.3597e-03       -22.437401061813  <--
     2.5000e-01     2.5000e+00             1.7969e-03       -22.437399199939
     1.0000e+00     1.0000e+01             4.8672e-04       -22.437396299288

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 6.3203e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.686483e-01 1 1  ON 0
 uu_1                 9.296810e-02 1 1  ON 1
 uu_2                -2.387727e-02 1 1  ON 2
 uu_3                -9.501877e-02 1 1  ON 3
 uu_4                -1.375433e-01 1 1  ON 4
 uu_5                -1.640868e-01 1 1  ON 5
 uu_6                -1.786750e-01 1 1  ON 6
 uu_7                -1.823113e-01 1 1  ON 7
 uu_8                -1.715386e-01 1 1  ON 8
 uu_9                -1.425476e-01 1 1  ON 9
 ud_0                 4.711745e-01 1 1  ON 10
 ud_1                 1.866839e-01 1 1  ON 11
 ud_2                 3.588926e-02 1 1  ON 12
 ud_3                -4.967195e-02 1 1  ON 13
 ud_4                -1.009879e-01 1 1  ON 14
 ud_5                -1.358038e-01 1 1  ON 15
 ud_6                -1.587363e-01 1 1  ON 16
 ud_7                -1.697190e-01 1 1  ON 17
 ud_8                -1.678743e-01 1 1  ON 18
 ud_9                -1.448551e-01 1 1  ON 19
 eC_0                -6.984164e-01 1 1  ON 20
 eC_1                -5.229728e-01 1 1  ON 21
 eC_2                -2.172016e-01 1 1  ON 22
 eC_3                 7.223472e-03 1 1  ON 23
 eC_4                 1.565361e-01 1 1  ON 24
 eC_5                 2.782273e-01 1 1  ON 25
 eC_6                 2.997537e-01 1 1  ON 26
 eC_7                 3.692143e-01 1 1  ON 27
 eC_8                 2.762780e-01 1 1  ON 28
 eC_9                 4.984468e-02 1 1  ON 29
 eO_0                -1.244354e+00 1 1  ON 30
 eO_1                -8.511220e-01 1 1  ON 31
 eO_2                -3.581057e-01 1 1  ON 32
 eO_3                -3.261481e-02 1 1  ON 33
 eO_4                 1.972435e-01 1 1  ON 34
 eO_5                 3.457798e-01 1 1  ON 35
 eO_6                 3.962599e-01 1 1  ON 36
 eO_7                 4.469211e-01 1 1  ON 37
 eO_8                 5.369010e-01 1 1  ON 38
 eO_9                 3.998696e-01 1 1  ON 39
eH1_0                -1.638211e-01 1 1  ON 40
eH1_1                -6.208514e-02 1 1  ON 41
eH1_2                -4.202293e-02 1 1  ON 42
eH1_3                -4.064459e-02 1 1  ON 43
eH1_4                -1.796858e-03 1 1  ON 44
eH1_5                 9.931936e-03 1 1  ON 45
eH1_6                 4.325214e-02 1 1  ON 46
eH1_7                 6.416629e-02 1 1  ON 47
eH1_8                 3.322175e-02 1 1  ON 48
eH1_9                 6.045406e-02 1 1  ON 49
eH2_0                -1.747293e-01 1 1  ON 50
eH2_1                -7.374413e-02 1 1  ON 51
eH2_2                -5.384097e-02 1 1  ON 52
eH2_3                -5.268013e-02 1 1  ON 53
eH2_4                -1.434215e-02 1 1  ON 54
eH2_5                -2.568986e-03 1 1  ON 55
eH2_6                 3.009000e-02 1 1  ON 56
eH2_7                 4.851353e-02 1 1  ON 57
eH2_8                 2.700531e-02 1 1  ON 58
eH2_9                 1.165524e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2220e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2500e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.4336
    reference variance = 0.424323
====================================================
  Execution time = 4.3775e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6772e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5164e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567801448419
                                         uncertainty =       0.004848267657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567801448419
                                         uncertainty =       0.004848267657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532784520
  error estimate for blocks of size 2^( 2) =       0.000553102674
  error estimate for blocks of size 2^( 3) =       0.000571273457
  error estimate for blocks of size 2^( 4) =       0.000584634913
  error estimate for blocks of size 2^( 5) =       0.000593690241
  error estimate for blocks of size 2^( 6) =       0.000599695047
  error estimate for blocks of size 2^( 7) =       0.000599275110

      target function =                  N/A
              le_mean =     -22.435589191210
             les_mean =     503.923380762992
             stat err =       0.000594323828
             autocorr =       1.244351536993
              std dev =       0.753471094407
             le_variance =       0.567718690107


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243558919121e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435589191210       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435590443106       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435595546157       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435595247118       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435593051460       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435592181296       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435594737123       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435596403780       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435596397685       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435595083990       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435597042907       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.435597050081       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.435598735003       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.435598975589       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.435599366500       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.435602155498       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.435602037741       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.435602963059       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.435603004798       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.435602058307       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.435602692441       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.435602729372       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.435602989880       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.435603044390       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-02 is 1.108329e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435589191210       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435590279013       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435594967198       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435594587984       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435593551084       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435591906428       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435593307020       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435594292014       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435594583172       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435593610893       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435594592791       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.435594698096       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.435595229683       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.435595097373       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.435595227861       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.435595989339       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.435595856066       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.435596003553       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 3.837175e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435589191210       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435589904850       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435592590759       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435593562917       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435592619060       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435591792692       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435591643225       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435591843748       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435592164577       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435591899404       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.435592127206       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.435592287810       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.435592322664       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 1.286204e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.390530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8972e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.688010e-01 1 1  ON 0
 uu_1                 9.338078e-02 1 1  ON 1
 uu_2                -2.361303e-02 1 1  ON 2
 uu_3                -9.471437e-02 1 1  ON 3
 uu_4                -1.373007e-01 1 1  ON 4
 uu_5                -1.636924e-01 1 1  ON 5
 uu_6                -1.783162e-01 1 1  ON 6
 uu_7                -1.816431e-01 1 1  ON 7
 uu_8                -1.705617e-01 1 1  ON 8
 uu_9                -1.424819e-01 1 1  ON 9
 ud_0                 4.721919e-01 1 1  ON 10
 ud_1                 1.870180e-01 1 1  ON 11
 ud_2                 3.586793e-02 1 1  ON 12
 ud_3                -4.958911e-02 1 1  ON 13
 ud_4                -1.006570e-01 1 1  ON 14
 ud_5                -1.351626e-01 1 1  ON 15
 ud_6                -1.578547e-01 1 1  ON 16
 ud_7                -1.692215e-01 1 1  ON 17
 ud_8                -1.665546e-01 1 1  ON 18
 ud_9                -1.446373e-01 1 1  ON 19
 eC_0                -6.977621e-01 1 1  ON 20
 eC_1                -5.225507e-01 1 1  ON 21
 eC_2                -2.159091e-01 1 1  ON 22
 eC_3                 7.447314e-03 1 1  ON 23
 eC_4                 1.552631e-01 1 1  ON 24
 eC_5                 2.772413e-01 1 1  ON 25
 eC_6                 2.986510e-01 1 1  ON 26
 eC_7                 3.675629e-01 1 1  ON 27
 eC_8                 2.778153e-01 1 1  ON 28
 eC_9                 5.068647e-02 1 1  ON 29
 eO_0                -1.244245e+00 1 1  ON 30
 eO_1                -8.513387e-01 1 1  ON 31
 eO_2                -3.576022e-01 1 1  ON 32
 eO_3                -3.183366e-02 1 1  ON 33
 eO_4                 1.968995e-01 1 1  ON 34
 eO_5                 3.447270e-01 1 1  ON 35
 eO_6                 3.957577e-01 1 1  ON 36
 eO_7                 4.484991e-01 1 1  ON 37
 eO_8                 5.335701e-01 1 1  ON 38
 eO_9                 4.009387e-01 1 1  ON 39
eH1_0                -1.619040e-01 1 1  ON 40
eH1_1                -6.207972e-02 1 1  ON 41
eH1_2                -4.180828e-02 1 1  ON 42
eH1_3                -4.028780e-02 1 1  ON 43
eH1_4                -2.239535e-03 1 1  ON 44
eH1_5                 9.628656e-03 1 1  ON 45
eH1_6                 4.241193e-02 1 1  ON 46
eH1_7                 6.032911e-02 1 1  ON 47
eH1_8                 3.467329e-02 1 1  ON 48
eH1_9                 6.062345e-02 1 1  ON 49
eH2_0                -1.742400e-01 1 1  ON 50
eH2_1                -7.332886e-02 1 1  ON 51
eH2_2                -5.434831e-02 1 1  ON 52
eH2_3                -5.272209e-02 1 1  ON 53
eH2_4                -1.424621e-02 1 1  ON 54
eH2_5                -1.852726e-03 1 1  ON 55
eH2_6                 3.041779e-02 1 1  ON 56
eH2_7                 4.751303e-02 1 1  ON 57
eH2_8                 2.692572e-02 1 1  ON 58
eH2_9                 1.151594e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.4443
    reference variance = 0.353414
====================================================
  Execution time = 4.3514e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2439e+01
  VMC Evar = 5.7158e-01
  Total weights = 2.0000e+06
  Execution time = 3.5795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570474356867
                                         uncertainty =       0.005405499909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570474356867
                                         uncertainty =       0.005405499909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534021143
  error estimate for blocks of size 2^( 2) =       0.000553957801
  error estimate for blocks of size 2^( 3) =       0.000572105771
  error estimate for blocks of size 2^( 4) =       0.000586063360
  error estimate for blocks of size 2^( 5) =       0.000592490171
  error estimate for blocks of size 2^( 6) =       0.000598537302
  error estimate for blocks of size 2^( 7) =       0.000599339816

      target function =                  N/A
              le_mean =     -22.438902524620
             les_mean =     504.074703387620
             stat err =       0.000594107662
             autocorr =       1.237694332795
              std dev =       0.755219943732
             le_variance =       0.570357163410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571593605741
                                         uncertainty =       0.005411932452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571593605741
                                         uncertainty =       0.005411932452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534544853
  error estimate for blocks of size 2^( 2) =       0.000554432823
  error estimate for blocks of size 2^( 3) =       0.000572540527
  error estimate for blocks of size 2^( 4) =       0.000586473852
  error estimate for blocks of size 2^( 5) =       0.000592891935
  error estimate for blocks of size 2^( 6) =       0.000598942076
  error estimate for blocks of size 2^( 7) =       0.000599748579

      target function =                  N/A
              le_mean =     -22.438887898073
             les_mean =     504.075166216251
             stat err =       0.000594514110
             autocorr =       1.236961062892
              std dev =       0.755960580801
             le_variance =       0.571476399724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572982921725
                                         uncertainty =       0.005414210270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572982921725
                                         uncertainty =       0.005414210270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535194189
  error estimate for blocks of size 2^( 2) =       0.000555051385
  error estimate for blocks of size 2^( 3) =       0.000573127767
  error estimate for blocks of size 2^( 4) =       0.000587035079
  error estimate for blocks of size 2^( 5) =       0.000593433060
  error estimate for blocks of size 2^( 6) =       0.000599471446
  error estimate for blocks of size 2^( 7) =       0.000600267806

      target function =                  N/A
              le_mean =     -22.438884658528
             les_mean =     504.076410071671
             stat err =       0.000595051848
             autocorr =       1.236194587100
              std dev =       0.756878880255
             le_variance =       0.572865639376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571425234468
                                         uncertainty =       0.005408845379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571425234468
                                         uncertainty =       0.005408845379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534466085
  error estimate for blocks of size 2^( 2) =       0.000554373099
  error estimate for blocks of size 2^( 3) =       0.000572493867
  error estimate for blocks of size 2^( 4) =       0.000586430976
  error estimate for blocks of size 2^( 5) =       0.000592844999
  error estimate for blocks of size 2^( 6) =       0.000598884390
  error estimate for blocks of size 2^( 7) =       0.000599681405

      target function =                  N/A
              le_mean =     -22.438891229806
             les_mean =     504.075147329237
             stat err =       0.000594460442
             autocorr =       1.237102307461
              std dev =       0.755849185898
             le_variance =       0.571307991823


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438902524620        initial  <--
     1.5625e-02     1.5625e-01             1.1083e-02       -22.438887898073
     6.2500e-02     6.2500e-01             3.8372e-03       -22.438884658528
     2.5000e-01     2.5000e+00             1.2862e-03       -22.438891229806

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4490
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.686483e-01 1 1  ON 0
 uu_1                 9.296810e-02 1 1  ON 1
 uu_2                -2.387727e-02 1 1  ON 2
 uu_3                -9.501877e-02 1 1  ON 3
 uu_4                -1.375433e-01 1 1  ON 4
 uu_5                -1.640868e-01 1 1  ON 5
 uu_6                -1.786750e-01 1 1  ON 6
 uu_7                -1.823113e-01 1 1  ON 7
 uu_8                -1.715386e-01 1 1  ON 8
 uu_9                -1.425476e-01 1 1  ON 9
 ud_0                 4.711745e-01 1 1  ON 10
 ud_1                 1.866839e-01 1 1  ON 11
 ud_2                 3.588926e-02 1 1  ON 12
 ud_3                -4.967195e-02 1 1  ON 13
 ud_4                -1.009879e-01 1 1  ON 14
 ud_5                -1.358038e-01 1 1  ON 15
 ud_6                -1.587363e-01 1 1  ON 16
 ud_7                -1.697190e-01 1 1  ON 17
 ud_8                -1.678743e-01 1 1  ON 18
 ud_9                -1.448551e-01 1 1  ON 19
 eC_0                -6.984164e-01 1 1  ON 20
 eC_1                -5.229728e-01 1 1  ON 21
 eC_2                -2.172016e-01 1 1  ON 22
 eC_3                 7.223472e-03 1 1  ON 23
 eC_4                 1.565361e-01 1 1  ON 24
 eC_5                 2.782273e-01 1 1  ON 25
 eC_6                 2.997537e-01 1 1  ON 26
 eC_7                 3.692143e-01 1 1  ON 27
 eC_8                 2.762780e-01 1 1  ON 28
 eC_9                 4.984468e-02 1 1  ON 29
 eO_0                -1.244354e+00 1 1  ON 30
 eO_1                -8.511220e-01 1 1  ON 31
 eO_2                -3.581057e-01 1 1  ON 32
 eO_3                -3.261481e-02 1 1  ON 33
 eO_4                 1.972435e-01 1 1  ON 34
 eO_5                 3.457798e-01 1 1  ON 35
 eO_6                 3.962599e-01 1 1  ON 36
 eO_7                 4.469211e-01 1 1  ON 37
 eO_8                 5.369010e-01 1 1  ON 38
 eO_9                 3.998696e-01 1 1  ON 39
eH1_0                -1.638211e-01 1 1  ON 40
eH1_1                -6.208514e-02 1 1  ON 41
eH1_2                -4.202293e-02 1 1  ON 42
eH1_3                -4.064459e-02 1 1  ON 43
eH1_4                -1.796858e-03 1 1  ON 44
eH1_5                 9.931936e-03 1 1  ON 45
eH1_6                 4.325214e-02 1 1  ON 46
eH1_7                 6.416629e-02 1 1  ON 47
eH1_8                 3.322175e-02 1 1  ON 48
eH1_9                 6.045406e-02 1 1  ON 49
eH2_0                -1.747293e-01 1 1  ON 50
eH2_1                -7.374413e-02 1 1  ON 51
eH2_2                -5.384097e-02 1 1  ON 52
eH2_3                -5.268013e-02 1 1  ON 53
eH2_4                -1.434215e-02 1 1  ON 54
eH2_5                -2.568986e-03 1 1  ON 55
eH2_6                 3.009000e-02 1 1  ON 56
eH2_7                 4.851353e-02 1 1  ON 57
eH2_8                 2.700531e-02 1 1  ON 58
eH2_9                 1.165524e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2043e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2479e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.3806
    reference variance = 0.571343
====================================================
  Execution time = 4.3696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6871e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5429e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568465857955
                                         uncertainty =       0.004229094519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568465857955
                                         uncertainty =       0.004229094519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533251737
  error estimate for blocks of size 2^( 2) =       0.000552875985
  error estimate for blocks of size 2^( 3) =       0.000571083471
  error estimate for blocks of size 2^( 4) =       0.000583957369
  error estimate for blocks of size 2^( 5) =       0.000593960101
  error estimate for blocks of size 2^( 6) =       0.000600365480
  error estimate for blocks of size 2^( 7) =       0.000603196107

      target function =                  N/A
              le_mean =     -22.437183736837
             les_mean =     503.995928586921
             stat err =       0.000595369764
             autocorr =       1.246547961454
              std dev =       0.754131839059
             le_variance =       0.568714830682


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243718373684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437183736837       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437187030728       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437191183994       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437191201865       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437190369411       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437189741207       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437189898626       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437193969306       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437193686185       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437193558185       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437193858675       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437193512835       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437193540263       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437193485233       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437193428594       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 1.871402e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437183736837       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437185319740       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437186892502       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437187168614       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437186785599       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437186505777       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437186516080       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437187400096       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437187538746       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437187461190       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437187318965       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437187269395       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 5.302101e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437183736837       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437184251139       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437184603226       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437184796662       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437184740454       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437184695136       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437184647637       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437184762379       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437184813431       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437184834004       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437184768031       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 1.367502e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.396250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9134e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.685978e-01 1 1  ON 0
 uu_1                 9.298587e-02 1 1  ON 1
 uu_2                -2.386163e-02 1 1  ON 2
 uu_3                -9.488952e-02 1 1  ON 3
 uu_4                -1.376269e-01 1 1  ON 4
 uu_5                -1.641848e-01 1 1  ON 5
 uu_6                -1.787743e-01 1 1  ON 6
 uu_7                -1.823743e-01 1 1  ON 7
 uu_8                -1.714654e-01 1 1  ON 8
 uu_9                -1.422960e-01 1 1  ON 9
 ud_0                 4.713026e-01 1 1  ON 10
 ud_1                 1.866436e-01 1 1  ON 11
 ud_2                 3.576701e-02 1 1  ON 12
 ud_3                -4.974318e-02 1 1  ON 13
 ud_4                -1.009179e-01 1 1  ON 14
 ud_5                -1.357789e-01 1 1  ON 15
 ud_6                -1.585981e-01 1 1  ON 16
 ud_7                -1.697764e-01 1 1  ON 17
 ud_8                -1.676835e-01 1 1  ON 18
 ud_9                -1.447821e-01 1 1  ON 19
 eC_0                -6.984365e-01 1 1  ON 20
 eC_1                -5.230054e-01 1 1  ON 21
 eC_2                -2.170222e-01 1 1  ON 22
 eC_3                 7.372869e-03 1 1  ON 23
 eC_4                 1.565519e-01 1 1  ON 24
 eC_5                 2.780024e-01 1 1  ON 25
 eC_6                 2.995581e-01 1 1  ON 26
 eC_7                 3.690135e-01 1 1  ON 27
 eC_8                 2.764792e-01 1 1  ON 28
 eC_9                 4.996190e-02 1 1  ON 29
 eO_0                -1.244374e+00 1 1  ON 30
 eO_1                -8.511350e-01 1 1  ON 31
 eO_2                -3.581947e-01 1 1  ON 32
 eO_3                -3.264048e-02 1 1  ON 33
 eO_4                 1.972892e-01 1 1  ON 34
 eO_5                 3.458603e-01 1 1  ON 35
 eO_6                 3.963040e-01 1 1  ON 36
 eO_7                 4.468591e-01 1 1  ON 37
 eO_8                 5.365209e-01 1 1  ON 38
 eO_9                 4.000798e-01 1 1  ON 39
eH1_0                -1.636686e-01 1 1  ON 40
eH1_1                -6.199313e-02 1 1  ON 41
eH1_2                -4.193411e-02 1 1  ON 42
eH1_3                -4.049182e-02 1 1  ON 43
eH1_4                -1.957592e-03 1 1  ON 44
eH1_5                 9.925962e-03 1 1  ON 45
eH1_6                 4.314407e-02 1 1  ON 46
eH1_7                 6.363608e-02 1 1  ON 47
eH1_8                 3.335124e-02 1 1  ON 48
eH1_9                 6.051083e-02 1 1  ON 49
eH2_0                -1.746862e-01 1 1  ON 50
eH2_1                -7.387557e-02 1 1  ON 51
eH2_2                -5.387502e-02 1 1  ON 52
eH2_3                -5.258952e-02 1 1  ON 53
eH2_4                -1.418508e-02 1 1  ON 54
eH2_5                -2.541869e-03 1 1  ON 55
eH2_6                 3.014470e-02 1 1  ON 56
eH2_7                 4.830996e-02 1 1  ON 57
eH2_8                 2.701904e-02 1 1  ON 58
eH2_9                 1.163955e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.422
    reference variance = 0.512498
====================================================
  Execution time = 4.3562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6631e-01
  Total weights = 2.0000e+06
  Execution time = 3.5991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565962213344
                                         uncertainty =       0.006294156759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565962213344
                                         uncertainty =       0.006294156759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532012263
  error estimate for blocks of size 2^( 2) =       0.000551511167
  error estimate for blocks of size 2^( 3) =       0.000570450396
  error estimate for blocks of size 2^( 4) =       0.000584587262
  error estimate for blocks of size 2^( 5) =       0.000593368859
  error estimate for blocks of size 2^( 6) =       0.000598391180
  error estimate for blocks of size 2^( 7) =       0.000601268604

      target function =                  N/A
              le_mean =     -22.437746593393
             les_mean =     504.018546002432
             stat err =       0.000594403976
             autocorr =       1.248303320819
              std dev =       0.752378957819
             le_variance =       0.566074096169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566369762549
                                         uncertainty =       0.006300688967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566369762549
                                         uncertainty =       0.006300688967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532203925
  error estimate for blocks of size 2^( 2) =       0.000551683886
  error estimate for blocks of size 2^( 3) =       0.000570607730
  error estimate for blocks of size 2^( 4) =       0.000584742770
  error estimate for blocks of size 2^( 5) =       0.000593514088
  error estimate for blocks of size 2^( 6) =       0.000598549888
  error estimate for blocks of size 2^( 7) =       0.000601445299

      target function =                  N/A
              le_mean =     -22.437746474897
             les_mean =     504.018948625071
             stat err =       0.000594563011
             autocorr =       1.248071965723
              std dev =       0.752650009353
             le_variance =       0.566482036580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566449021877
                                         uncertainty =       0.006301576018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566449021877
                                         uncertainty =       0.006301576018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532241233
  error estimate for blocks of size 2^( 2) =       0.000551720002
  error estimate for blocks of size 2^( 3) =       0.000570643352
  error estimate for blocks of size 2^( 4) =       0.000584779319
  error estimate for blocks of size 2^( 5) =       0.000593548994
  error estimate for blocks of size 2^( 6) =       0.000598580372
  error estimate for blocks of size 2^( 7) =       0.000601472846

      target function =                  N/A
              le_mean =     -22.437745472851
             les_mean =     504.018983080598
             stat err =       0.000594595383
             autocorr =       1.248032894195
              std dev =       0.752702769658
             le_variance =       0.566561459451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566057873988
                                         uncertainty =       0.006295439498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566057873988
                                         uncertainty =       0.006295439498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532057269
  error estimate for blocks of size 2^( 2) =       0.000551552320
  error estimate for blocks of size 2^( 3) =       0.000570488523
  error estimate for blocks of size 2^( 4) =       0.000584625168
  error estimate for blocks of size 2^( 5) =       0.000593404517
  error estimate for blocks of size 2^( 6) =       0.000598428051
  error estimate for blocks of size 2^( 7) =       0.000601307817

      target function =                  N/A
              le_mean =     -22.437746020870
             les_mean =     504.018616088912
             stat err =       0.000594441388
             autocorr =       1.248249261493
              std dev =       0.752442605730
             le_variance =       0.566169874918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437746593393        initial  <--
     1.5625e-01     1.5625e+00             1.8714e-03       -22.437746474897
     6.2500e-01     6.2500e+00             5.3021e-04       -22.437745472851
     2.5000e+00     2.5000e+01             1.3675e-04       -22.437746020870

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.5454
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.686483e-01 1 1  ON 0
 uu_1                 9.296810e-02 1 1  ON 1
 uu_2                -2.387727e-02 1 1  ON 2
 uu_3                -9.501877e-02 1 1  ON 3
 uu_4                -1.375433e-01 1 1  ON 4
 uu_5                -1.640868e-01 1 1  ON 5
 uu_6                -1.786750e-01 1 1  ON 6
 uu_7                -1.823113e-01 1 1  ON 7
 uu_8                -1.715386e-01 1 1  ON 8
 uu_9                -1.425476e-01 1 1  ON 9
 ud_0                 4.711745e-01 1 1  ON 10
 ud_1                 1.866839e-01 1 1  ON 11
 ud_2                 3.588926e-02 1 1  ON 12
 ud_3                -4.967195e-02 1 1  ON 13
 ud_4                -1.009879e-01 1 1  ON 14
 ud_5                -1.358038e-01 1 1  ON 15
 ud_6                -1.587363e-01 1 1  ON 16
 ud_7                -1.697190e-01 1 1  ON 17
 ud_8                -1.678743e-01 1 1  ON 18
 ud_9                -1.448551e-01 1 1  ON 19
 eC_0                -6.984164e-01 1 1  ON 20
 eC_1                -5.229728e-01 1 1  ON 21
 eC_2                -2.172016e-01 1 1  ON 22
 eC_3                 7.223472e-03 1 1  ON 23
 eC_4                 1.565361e-01 1 1  ON 24
 eC_5                 2.782273e-01 1 1  ON 25
 eC_6                 2.997537e-01 1 1  ON 26
 eC_7                 3.692143e-01 1 1  ON 27
 eC_8                 2.762780e-01 1 1  ON 28
 eC_9                 4.984468e-02 1 1  ON 29
 eO_0                -1.244354e+00 1 1  ON 30
 eO_1                -8.511220e-01 1 1  ON 31
 eO_2                -3.581057e-01 1 1  ON 32
 eO_3                -3.261481e-02 1 1  ON 33
 eO_4                 1.972435e-01 1 1  ON 34
 eO_5                 3.457798e-01 1 1  ON 35
 eO_6                 3.962599e-01 1 1  ON 36
 eO_7                 4.469211e-01 1 1  ON 37
 eO_8                 5.369010e-01 1 1  ON 38
 eO_9                 3.998696e-01 1 1  ON 39
eH1_0                -1.638211e-01 1 1  ON 40
eH1_1                -6.208514e-02 1 1  ON 41
eH1_2                -4.202293e-02 1 1  ON 42
eH1_3                -4.064459e-02 1 1  ON 43
eH1_4                -1.796858e-03 1 1  ON 44
eH1_5                 9.931936e-03 1 1  ON 45
eH1_6                 4.325214e-02 1 1  ON 46
eH1_7                 6.416629e-02 1 1  ON 47
eH1_8                 3.322175e-02 1 1  ON 48
eH1_9                 6.045406e-02 1 1  ON 49
eH2_0                -1.747293e-01 1 1  ON 50
eH2_1                -7.374413e-02 1 1  ON 51
eH2_2                -5.384097e-02 1 1  ON 52
eH2_3                -5.268013e-02 1 1  ON 53
eH2_4                -1.434215e-02 1 1  ON 54
eH2_5                -2.568986e-03 1 1  ON 55
eH2_6                 3.009000e-02 1 1  ON 56
eH2_7                 4.851353e-02 1 1  ON 57
eH2_8                 2.700531e-02 1 1  ON 58
eH2_9                 1.165524e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2071e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2460e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.3815
    reference variance = 0.817968
====================================================
  Execution time = 4.6107e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7361e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5077e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573695814079
                                         uncertainty =       0.007640717218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573695814079
                                         uncertainty =       0.007640717218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535539750
  error estimate for blocks of size 2^( 2) =       0.000555505907
  error estimate for blocks of size 2^( 3) =       0.000573902220
  error estimate for blocks of size 2^( 4) =       0.000587007913
  error estimate for blocks of size 2^( 5) =       0.000595601333
  error estimate for blocks of size 2^( 6) =       0.000601174203
  error estimate for blocks of size 2^( 7) =       0.000603221044

      target function =                  N/A
              le_mean =     -22.437639278627
             les_mean =     504.021261758100
             stat err =       0.000596751123
             autocorr =       1.241661078593
              std dev =       0.757367577289
             le_variance =       0.573605647128


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243763927863e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437639278627       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437639995937       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437640426173       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437641027827       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437641230785       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437641507140       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437641485696       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437641524636       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437641624894       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437641623965       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437641616627       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437641577617       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.719072e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437639278627       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437639480333       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437639582571       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437639751559       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437639786183       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437639881214       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437639895267       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437639908005       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437639935285       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437639934020       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437639932385       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 4.328500e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437639278627       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437639330677       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437639356030       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437639399390       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437639406630       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437639432494       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437639437343       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437639440908       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437639447848       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437639447499       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 1.159841e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.400628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1192e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.686155e-01 1 1  ON 0
 uu_1                 9.297465e-02 1 1  ON 1
 uu_2                -2.388535e-02 1 1  ON 2
 uu_3                -9.500769e-02 1 1  ON 3
 uu_4                -1.375489e-01 1 1  ON 4
 uu_5                -1.640894e-01 1 1  ON 5
 uu_6                -1.786789e-01 1 1  ON 6
 uu_7                -1.822714e-01 1 1  ON 7
 uu_8                -1.715318e-01 1 1  ON 8
 uu_9                -1.425419e-01 1 1  ON 9
 ud_0                 4.712177e-01 1 1  ON 10
 ud_1                 1.866806e-01 1 1  ON 11
 ud_2                 3.587957e-02 1 1  ON 12
 ud_3                -4.967681e-02 1 1  ON 13
 ud_4                -1.009807e-01 1 1  ON 14
 ud_5                -1.357989e-01 1 1  ON 15
 ud_6                -1.587382e-01 1 1  ON 16
 ud_7                -1.697268e-01 1 1  ON 17
 ud_8                -1.678540e-01 1 1  ON 18
 ud_9                -1.448686e-01 1 1  ON 19
 eC_0                -6.983934e-01 1 1  ON 20
 eC_1                -5.229776e-01 1 1  ON 21
 eC_2                -2.171654e-01 1 1  ON 22
 eC_3                 7.219898e-03 1 1  ON 23
 eC_4                 1.565229e-01 1 1  ON 24
 eC_5                 2.782084e-01 1 1  ON 25
 eC_6                 2.997268e-01 1 1  ON 26
 eC_7                 3.691971e-01 1 1  ON 27
 eC_8                 2.762942e-01 1 1  ON 28
 eC_9                 4.985265e-02 1 1  ON 29
 eO_0                -1.244355e+00 1 1  ON 30
 eO_1                -8.511121e-01 1 1  ON 31
 eO_2                -3.581234e-01 1 1  ON 32
 eO_3                -3.260763e-02 1 1  ON 33
 eO_4                 1.972455e-01 1 1  ON 34
 eO_5                 3.457835e-01 1 1  ON 35
 eO_6                 3.962490e-01 1 1  ON 36
 eO_7                 4.469241e-01 1 1  ON 37
 eO_8                 5.368660e-01 1 1  ON 38
 eO_9                 3.998866e-01 1 1  ON 39
eH1_0                -1.637949e-01 1 1  ON 40
eH1_1                -6.207195e-02 1 1  ON 41
eH1_2                -4.202348e-02 1 1  ON 42
eH1_3                -4.063468e-02 1 1  ON 43
eH1_4                -1.819915e-03 1 1  ON 44
eH1_5                 9.939416e-03 1 1  ON 45
eH1_6                 4.324517e-02 1 1  ON 46
eH1_7                 6.412300e-02 1 1  ON 47
eH1_8                 3.323119e-02 1 1  ON 48
eH1_9                 6.045431e-02 1 1  ON 49
eH2_0                -1.747130e-01 1 1  ON 50
eH2_1                -7.373510e-02 1 1  ON 51
eH2_2                -5.382982e-02 1 1  ON 52
eH2_3                -5.266083e-02 1 1  ON 53
eH2_4                -1.434751e-02 1 1  ON 54
eH2_5                -2.564183e-03 1 1  ON 55
eH2_6                 3.007380e-02 1 1  ON 56
eH2_7                 4.847784e-02 1 1  ON 57
eH2_8                 2.700233e-02 1 1  ON 58
eH2_9                 1.165409e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.4809
    reference variance = 0.530253
====================================================
  Execution time = 4.3127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5646e-01
  Total weights = 2.0000e+06
  Execution time = 3.5745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556538740974
                                         uncertainty =       0.003489638772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556538740974
                                         uncertainty =       0.003489638772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527449707
  error estimate for blocks of size 2^( 2) =       0.000547071389
  error estimate for blocks of size 2^( 3) =       0.000565204674
  error estimate for blocks of size 2^( 4) =       0.000578241176
  error estimate for blocks of size 2^( 5) =       0.000586711289
  error estimate for blocks of size 2^( 6) =       0.000591686237
  error estimate for blocks of size 2^( 7) =       0.000594549451

      target function =                  N/A
              le_mean =     -22.437944420679
             les_mean =     504.017755934910
             stat err =       0.000587797039
             autocorr =       1.241917296979
              std dev =       0.745926529642
             le_variance =       0.556406387624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556703744156
                                         uncertainty =       0.003490719139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556703744156
                                         uncertainty =       0.003490719139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527527888
  error estimate for blocks of size 2^( 2) =       0.000547142431
  error estimate for blocks of size 2^( 3) =       0.000565269936
  error estimate for blocks of size 2^( 4) =       0.000578300527
  error estimate for blocks of size 2^( 5) =       0.000586771197
  error estimate for blocks of size 2^( 6) =       0.000591746763
  error estimate for blocks of size 2^( 7) =       0.000594608162

      target function =                  N/A
              le_mean =     -22.437944682240
             les_mean =     504.017932629790
             stat err =       0.000587856662
             autocorr =       1.241801104084
              std dev =       0.746037093451
             le_variance =       0.556571344805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556647660961
                                         uncertainty =       0.003490355503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556647660961
                                         uncertainty =       0.003490355503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527501316
  error estimate for blocks of size 2^( 2) =       0.000547118550
  error estimate for blocks of size 2^( 3) =       0.000565248187
  error estimate for blocks of size 2^( 4) =       0.000578280927
  error estimate for blocks of size 2^( 5) =       0.000586751263
  error estimate for blocks of size 2^( 6) =       0.000591726708
  error estimate for blocks of size 2^( 7) =       0.000594588963

      target function =                  N/A
              le_mean =     -22.437944562849
             les_mean =     504.017871205036
             stat err =       0.000587836965
             autocorr =       1.241842988062
              std dev =       0.745999515960
             le_variance =       0.556515277813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556553425344
                                         uncertainty =       0.003489736712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556553425344
                                         uncertainty =       0.003489736712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527456666
  error estimate for blocks of size 2^( 2) =       0.000547077757
  error estimate for blocks of size 2^( 3) =       0.000565210553
  error estimate for blocks of size 2^( 4) =       0.000578246552
  error estimate for blocks of size 2^( 5) =       0.000586716691
  error estimate for blocks of size 2^( 6) =       0.000591691713
  error estimate for blocks of size 2^( 7) =       0.000594554801

      target function =                  N/A
              le_mean =     -22.437944433984
             les_mean =     504.017771212333
             stat err =       0.000587802439
             autocorr =       1.241907352159
              std dev =       0.745936369924
             le_variance =       0.556421067976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437944420679        initial
     1.5625e+00     1.5625e+01             1.7191e-04       -22.437944682240  <--
     6.2500e+00     6.2500e+01             4.3285e-05       -22.437944562849
     2.5000e+01     2.5000e+02             1.1598e-05       -22.437944433984

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 6.1037e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.685307e-01 1 1  ON 0
 uu_1                 9.298148e-02 1 1  ON 1
 uu_2                -2.390303e-02 1 1  ON 2
 uu_3                -9.498460e-02 1 1  ON 3
 uu_4                -1.375619e-01 1 1  ON 4
 uu_5                -1.640975e-01 1 1  ON 5
 uu_6                -1.786854e-01 1 1  ON 6
 uu_7                -1.821652e-01 1 1  ON 7
 uu_8                -1.715068e-01 1 1  ON 8
 uu_9                -1.425218e-01 1 1  ON 9
 ud_0                 4.713131e-01 1 1  ON 10
 ud_1                 1.866779e-01 1 1  ON 11
 ud_2                 3.586175e-02 1 1  ON 12
 ud_3                -4.968778e-02 1 1  ON 13
 ud_4                -1.009585e-01 1 1  ON 14
 ud_5                -1.357829e-01 1 1  ON 15
 ud_6                -1.587391e-01 1 1  ON 16
 ud_7                -1.697444e-01 1 1  ON 17
 ud_8                -1.677934e-01 1 1  ON 18
 ud_9                -1.449082e-01 1 1  ON 19
 eC_0                -6.983261e-01 1 1  ON 20
 eC_1                -5.229869e-01 1 1  ON 21
 eC_2                -2.170693e-01 1 1  ON 22
 eC_3                 7.215713e-03 1 1  ON 23
 eC_4                 1.564821e-01 1 1  ON 24
 eC_5                 2.781544e-01 1 1  ON 25
 eC_6                 2.996467e-01 1 1  ON 26
 eC_7                 3.691449e-01 1 1  ON 27
 eC_8                 2.763442e-01 1 1  ON 28
 eC_9                 4.987716e-02 1 1  ON 29
 eO_0                -1.244354e+00 1 1  ON 30
 eO_1                -8.510874e-01 1 1  ON 31
 eO_2                -3.581721e-01 1 1  ON 32
 eO_3                -3.258809e-02 1 1  ON 33
 eO_4                 1.972537e-01 1 1  ON 34
 eO_5                 3.457936e-01 1 1  ON 35
 eO_6                 3.962133e-01 1 1  ON 36
 eO_7                 4.469324e-01 1 1  ON 37
 eO_8                 5.367591e-01 1 1  ON 38
 eO_9                 3.999391e-01 1 1  ON 39
eH1_0                -1.637188e-01 1 1  ON 40
eH1_1                -6.203633e-02 1 1  ON 41
eH1_2                -4.202198e-02 1 1  ON 42
eH1_3                -4.060965e-02 1 1  ON 43
eH1_4                -1.881021e-03 1 1  ON 44
eH1_5                 9.956776e-03 1 1  ON 45
eH1_6                 4.322647e-02 1 1  ON 46
eH1_7                 6.399438e-02 1 1  ON 47
eH1_8                 3.326052e-02 1 1  ON 48
eH1_9                 6.045511e-02 1 1  ON 49
eH2_0                -1.746651e-01 1 1  ON 50
eH2_1                -7.370906e-02 1 1  ON 51
eH2_2                -5.379645e-02 1 1  ON 52
eH2_3                -5.260783e-02 1 1  ON 53
eH2_4                -1.436044e-02 1 1  ON 54
eH2_5                -2.550966e-03 1 1  ON 55
eH2_6                 3.002902e-02 1 1  ON 56
eH2_7                 4.837133e-02 1 1  ON 57
eH2_8                 2.699378e-02 1 1  ON 58
eH2_9                 1.165057e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2224e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2454e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4564
    reference variance = 0.346801
====================================================
  Execution time = 4.4050e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6912e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5260e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569083143456
                                         uncertainty =       0.008874833763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569083143456
                                         uncertainty =       0.008874833763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533439851
  error estimate for blocks of size 2^( 2) =       0.000553806344
  error estimate for blocks of size 2^( 3) =       0.000572387500
  error estimate for blocks of size 2^( 4) =       0.000586827342
  error estimate for blocks of size 2^( 5) =       0.000596011748
  error estimate for blocks of size 2^( 6) =       0.000601692810
  error estimate for blocks of size 2^( 7) =       0.000602273292

      target function =                  N/A
              le_mean =     -22.436797423455
             les_mean =     503.978994485762
             stat err =       0.000596701298
             autocorr =       1.251247006937
              std dev =       0.754397871929
             le_variance =       0.569116149172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243679742345e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436797423455       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436796489716       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436797017369       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436798848070       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436798885767       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436798801727       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436799767965       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436799978590       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436800491862       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436800447558       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436800156685       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436800046954       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436799992483       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 1.049014e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436797423455       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436797133394       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436797276364       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436797874386       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436797801542       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436797728415       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436797995848       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436798023845       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436798163893       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436798107452       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436798057099       residual = 7.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 2.727333e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436797423455       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436797346258       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436797382475       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436797542404       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436797515608       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436797493837       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436797553589       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436797565140       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436797590129       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436797576743       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 6.859626e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.405308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9318e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.685075e-01 1 1  ON 0
 uu_1                 9.303565e-02 1 1  ON 1
 uu_2                -2.388726e-02 1 1  ON 2
 uu_3                -9.494903e-02 1 1  ON 3
 uu_4                -1.375781e-01 1 1  ON 4
 uu_5                -1.641169e-01 1 1  ON 5
 uu_6                -1.787274e-01 1 1  ON 6
 uu_7                -1.820917e-01 1 1  ON 7
 uu_8                -1.714810e-01 1 1  ON 8
 uu_9                -1.425044e-01 1 1  ON 9
 ud_0                 4.713121e-01 1 1  ON 10
 ud_1                 1.866590e-01 1 1  ON 11
 ud_2                 3.587438e-02 1 1  ON 12
 ud_3                -4.967176e-02 1 1  ON 13
 ud_4                -1.009418e-01 1 1  ON 14
 ud_5                -1.357817e-01 1 1  ON 15
 ud_6                -1.586592e-01 1 1  ON 16
 ud_7                -1.697738e-01 1 1  ON 17
 ud_8                -1.677042e-01 1 1  ON 18
 ud_9                -1.448742e-01 1 1  ON 19
 eC_0                -6.982916e-01 1 1  ON 20
 eC_1                -5.230767e-01 1 1  ON 21
 eC_2                -2.169472e-01 1 1  ON 22
 eC_3                 7.340581e-03 1 1  ON 23
 eC_4                 1.564064e-01 1 1  ON 24
 eC_5                 2.780827e-01 1 1  ON 25
 eC_6                 2.996117e-01 1 1  ON 26
 eC_7                 3.690632e-01 1 1  ON 27
 eC_8                 2.763863e-01 1 1  ON 28
 eC_9                 4.990442e-02 1 1  ON 29
 eO_0                -1.244324e+00 1 1  ON 30
 eO_1                -8.511143e-01 1 1  ON 31
 eO_2                -3.582257e-01 1 1  ON 32
 eO_3                -3.259044e-02 1 1  ON 33
 eO_4                 1.972582e-01 1 1  ON 34
 eO_5                 3.458403e-01 1 1  ON 35
 eO_6                 3.962273e-01 1 1  ON 36
 eO_7                 4.469316e-01 1 1  ON 37
 eO_8                 5.366227e-01 1 1  ON 38
 eO_9                 4.000020e-01 1 1  ON 39
eH1_0                -1.635385e-01 1 1  ON 40
eH1_1                -6.192167e-02 1 1  ON 41
eH1_2                -4.196333e-02 1 1  ON 42
eH1_3                -4.057706e-02 1 1  ON 43
eH1_4                -1.999465e-03 1 1  ON 44
eH1_5                 9.952421e-03 1 1  ON 45
eH1_6                 4.313821e-02 1 1  ON 46
eH1_7                 6.372165e-02 1 1  ON 47
eH1_8                 3.331654e-02 1 1  ON 48
eH1_9                 6.046256e-02 1 1  ON 49
eH2_0                -1.747185e-01 1 1  ON 50
eH2_1                -7.373407e-02 1 1  ON 51
eH2_2                -5.382097e-02 1 1  ON 52
eH2_3                -5.255754e-02 1 1  ON 53
eH2_4                -1.437565e-02 1 1  ON 54
eH2_5                -2.505310e-03 1 1  ON 55
eH2_6                 3.008946e-02 1 1  ON 56
eH2_7                 4.835696e-02 1 1  ON 57
eH2_8                 2.700507e-02 1 1  ON 58
eH2_9                 1.164320e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4424
    reference variance = 0.390424
====================================================
  Execution time = 4.3902e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5737e-01
  Total weights = 2.0000e+06
  Execution time = 3.5841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557459740825
                                         uncertainty =       0.002648417739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557459740825
                                         uncertainty =       0.002648417739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527927038
  error estimate for blocks of size 2^( 2) =       0.000548063043
  error estimate for blocks of size 2^( 3) =       0.000566269966
  error estimate for blocks of size 2^( 4) =       0.000579122378
  error estimate for blocks of size 2^( 5) =       0.000587322477
  error estimate for blocks of size 2^( 6) =       0.000590631555
  error estimate for blocks of size 2^( 7) =       0.000593667738

      target function =                  N/A
              le_mean =     -22.437502618118
             les_mean =     503.998937374977
             stat err =       0.000587686037
             autocorr =       1.239204363533
              std dev =       0.746601577563
             le_variance =       0.557413915619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557340598309
                                         uncertainty =       0.002647696278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557340598309
                                         uncertainty =       0.002647696278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527870694
  error estimate for blocks of size 2^( 2) =       0.000548008951
  error estimate for blocks of size 2^( 3) =       0.000566217156
  error estimate for blocks of size 2^( 4) =       0.000579071752
  error estimate for blocks of size 2^( 5) =       0.000587267535
  error estimate for blocks of size 2^( 6) =       0.000590580401
  error estimate for blocks of size 2^( 7) =       0.000593616423

      target function =                  N/A
              le_mean =     -22.437503564591
             les_mean =     503.998860871122
             stat err =       0.000587634028
             autocorr =       1.239249547983
              std dev =       0.746521894353
             le_variance =       0.557294938749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557378881919
                                         uncertainty =       0.002647921714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557378881919
                                         uncertainty =       0.002647921714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527888805
  error estimate for blocks of size 2^( 2) =       0.000548026664
  error estimate for blocks of size 2^( 3) =       0.000566234834
  error estimate for blocks of size 2^( 4) =       0.000579089306
  error estimate for blocks of size 2^( 5) =       0.000587287058
  error estimate for blocks of size 2^( 6) =       0.000590598127
  error estimate for blocks of size 2^( 7) =       0.000593633693

      target function =                  N/A
              le_mean =     -22.437503034364
             les_mean =     503.998875318379
             stat err =       0.000587652046
             autocorr =       1.239240510456
              std dev =       0.746547506835
             le_variance =       0.557333179962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557449400696
                                         uncertainty =       0.002648355018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557449400696
                                         uncertainty =       0.002648355018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527922150
  error estimate for blocks of size 2^( 2) =       0.000548058382
  error estimate for blocks of size 2^( 3) =       0.000566265439
  error estimate for blocks of size 2^( 4) =       0.000579118144
  error estimate for blocks of size 2^( 5) =       0.000587317942
  error estimate for blocks of size 2^( 6) =       0.000590627253
  error estimate for blocks of size 2^( 7) =       0.000593663344

      target function =                  N/A
              le_mean =     -22.437502639313
             les_mean =     503.998928003260
             stat err =       0.000587681671
             autocorr =       1.239208898093
              std dev =       0.746594664301
             le_variance =       0.557403592763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437502618118        initial
     3.9062e-01     3.9062e+00             1.0490e-03       -22.437503564591  <--
     1.5625e+00     1.5625e+01             2.7273e-04       -22.437503034364
     6.2500e+00     6.2500e+01             6.8596e-05       -22.437502639313

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 6.1840e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.685007e-01 1 1  ON 0
 uu_1                 9.313742e-02 1 1  ON 1
 uu_2                -2.382983e-02 1 1  ON 2
 uu_3                -9.488831e-02 1 1  ON 3
 uu_4                -1.375973e-01 1 1  ON 4
 uu_5                -1.641526e-01 1 1  ON 5
 uu_6                -1.787973e-01 1 1  ON 6
 uu_7                -1.819606e-01 1 1  ON 7
 uu_8                -1.713991e-01 1 1  ON 8
 uu_9                -1.424480e-01 1 1  ON 9
 ud_0                 4.713073e-01 1 1  ON 10
 ud_1                 1.866390e-01 1 1  ON 11
 ud_2                 3.590368e-02 1 1  ON 12
 ud_3                -4.963272e-02 1 1  ON 13
 ud_4                -1.008921e-01 1 1  ON 14
 ud_5                -1.357482e-01 1 1  ON 15
 ud_6                -1.585040e-01 1 1  ON 16
 ud_7                -1.697805e-01 1 1  ON 17
 ud_8                -1.674831e-01 1 1  ON 18
 ud_9                -1.447809e-01 1 1  ON 19
 eC_0                -6.982293e-01 1 1  ON 20
 eC_1                -5.232167e-01 1 1  ON 21
 eC_2                -2.166693e-01 1 1  ON 22
 eC_3                 7.626481e-03 1 1  ON 23
 eC_4                 1.562608e-01 1 1  ON 24
 eC_5                 2.778879e-01 1 1  ON 25
 eC_6                 2.994988e-01 1 1  ON 26
 eC_7                 3.688167e-01 1 1  ON 27
 eC_8                 2.765099e-01 1 1  ON 28
 eC_9                 4.998495e-02 1 1  ON 29
 eO_0                -1.244283e+00 1 1  ON 30
 eO_1                -8.511603e-01 1 1  ON 31
 eO_2                -3.583365e-01 1 1  ON 32
 eO_3                -3.258498e-02 1 1  ON 33
 eO_4                 1.972637e-01 1 1  ON 34
 eO_5                 3.459350e-01 1 1  ON 35
 eO_6                 3.962777e-01 1 1  ON 36
 eO_7                 4.469256e-01 1 1  ON 37
 eO_8                 5.362213e-01 1 1  ON 38
 eO_9                 4.001877e-01 1 1  ON 39
eH1_0                -1.630438e-01 1 1  ON 40
eH1_1                -6.163110e-02 1 1  ON 41
eH1_2                -4.179435e-02 1 1  ON 42
eH1_3                -4.050673e-02 1 1  ON 43
eH1_4                -2.248149e-03 1 1  ON 44
eH1_5                 9.868886e-03 1 1  ON 45
eH1_6                 4.295247e-02 1 1  ON 46
eH1_7                 6.294537e-02 1 1  ON 47
eH1_8                 3.346636e-02 1 1  ON 48
eH1_9                 6.048170e-02 1 1  ON 49
eH2_0                -1.748502e-01 1 1  ON 50
eH2_1                -7.377947e-02 1 1  ON 51
eH2_2                -5.386373e-02 1 1  ON 52
eH2_3                -5.244510e-02 1 1  ON 53
eH2_4                -1.442685e-02 1 1  ON 54
eH2_5                -2.409812e-03 1 1  ON 55
eH2_6                 3.026943e-02 1 1  ON 56
eH2_7                 4.831602e-02 1 1  ON 57
eH2_8                 2.703384e-02 1 1  ON 58
eH2_9                 1.162136e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2117e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2453e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.4504
    reference variance = 0.376562
====================================================
  Execution time = 4.4561e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6189e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5654e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562024191531
                                         uncertainty =       0.003105066326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562024191531
                                         uncertainty =       0.003105066326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530044381
  error estimate for blocks of size 2^( 2) =       0.000550404356
  error estimate for blocks of size 2^( 3) =       0.000568522164
  error estimate for blocks of size 2^( 4) =       0.000582729968
  error estimate for blocks of size 2^( 5) =       0.000592251184
  error estimate for blocks of size 2^( 6) =       0.000598134187
  error estimate for blocks of size 2^( 7) =       0.000597789453

      target function =                  N/A
              le_mean =     -22.437485998145
             les_mean =     504.002671726943
             stat err =       0.000592726198
             autocorr =       1.250500233497
              std dev =       0.749595951774
             le_variance =       0.561894090915


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243748599815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437485998145       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437485561372       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437485329738       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437485885249       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437486125567       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437487425061       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437488300998       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437486291976       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437486505720       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437487761001       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437488176237       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437488788723       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437489155126       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437488961012       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437489236521       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437489225461       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 2.476683e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437485998145       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437485804038       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437485493366       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437485332191       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437485046855       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437485437764       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437486248558       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437485753468       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437485591932       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437486021544       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437486187380       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437486059358       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 7.881639e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437485998145       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437485937908       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437485809008       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437485637447       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437485480346       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437485540054       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437485809653       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437485816917       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437485738817       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437485768727       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437485814482       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 2.129211e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.411658 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0225e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.685410e-01 1 1  ON 0
 uu_1                 9.316431e-02 1 1  ON 1
 uu_2                -2.373188e-02 1 1  ON 2
 uu_3                -9.484179e-02 1 1  ON 3
 uu_4                -1.374233e-01 1 1  ON 4
 uu_5                -1.640857e-01 1 1  ON 5
 uu_6                -1.787312e-01 1 1  ON 6
 uu_7                -1.817726e-01 1 1  ON 7
 uu_8                -1.713472e-01 1 1  ON 8
 uu_9                -1.425828e-01 1 1  ON 9
 ud_0                 4.715167e-01 1 1  ON 10
 ud_1                 1.869364e-01 1 1  ON 11
 ud_2                 3.602325e-02 1 1  ON 12
 ud_3                -4.941136e-02 1 1  ON 13
 ud_4                -1.006384e-01 1 1  ON 14
 ud_5                -1.354441e-01 1 1  ON 15
 ud_6                -1.583007e-01 1 1  ON 16
 ud_7                -1.699292e-01 1 1  ON 17
 ud_8                -1.674654e-01 1 1  ON 18
 ud_9                -1.451266e-01 1 1  ON 19
 eC_0                -6.980626e-01 1 1  ON 20
 eC_1                -5.231386e-01 1 1  ON 21
 eC_2                -2.165208e-01 1 1  ON 22
 eC_3                 7.544579e-03 1 1  ON 23
 eC_4                 1.564472e-01 1 1  ON 24
 eC_5                 2.777966e-01 1 1  ON 25
 eC_6                 2.993332e-01 1 1  ON 26
 eC_7                 3.684477e-01 1 1  ON 27
 eC_8                 2.765671e-01 1 1  ON 28
 eC_9                 5.006572e-02 1 1  ON 29
 eO_0                -1.244352e+00 1 1  ON 30
 eO_1                -8.511869e-01 1 1  ON 31
 eO_2                -3.582739e-01 1 1  ON 32
 eO_3                -3.248328e-02 1 1  ON 33
 eO_4                 1.972080e-01 1 1  ON 34
 eO_5                 3.459016e-01 1 1  ON 35
 eO_6                 3.963677e-01 1 1  ON 36
 eO_7                 4.470702e-01 1 1  ON 37
 eO_8                 5.356535e-01 1 1  ON 38
 eO_9                 4.003496e-01 1 1  ON 39
eH1_0                -1.627964e-01 1 1  ON 40
eH1_1                -6.148137e-02 1 1  ON 41
eH1_2                -4.182684e-02 1 1  ON 42
eH1_3                -4.032668e-02 1 1  ON 43
eH1_4                -2.162835e-03 1 1  ON 44
eH1_5                 9.982158e-03 1 1  ON 45
eH1_6                 4.275914e-02 1 1  ON 46
eH1_7                 6.215720e-02 1 1  ON 47
eH1_8                 3.361187e-02 1 1  ON 48
eH1_9                 6.050765e-02 1 1  ON 49
eH2_0                -1.747470e-01 1 1  ON 50
eH2_1                -7.364002e-02 1 1  ON 51
eH2_2                -5.375530e-02 1 1  ON 52
eH2_3                -5.242518e-02 1 1  ON 53
eH2_4                -1.432084e-02 1 1  ON 54
eH2_5                -2.457600e-03 1 1  ON 55
eH2_6                 3.031312e-02 1 1  ON 56
eH2_7                 4.807698e-02 1 1  ON 57
eH2_8                 2.703964e-02 1 1  ON 58
eH2_9                 1.158998e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.3853
    reference variance = 0.521601
====================================================
  Execution time = 4.5400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7128e-01
  Total weights = 2.0000e+06
  Execution time = 3.5839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571087451751
                                         uncertainty =       0.004609441902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571087451751
                                         uncertainty =       0.004609441902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534425414
  error estimate for blocks of size 2^( 2) =       0.000553914513
  error estimate for blocks of size 2^( 3) =       0.000572073775
  error estimate for blocks of size 2^( 4) =       0.000585964405
  error estimate for blocks of size 2^( 5) =       0.000594450213
  error estimate for blocks of size 2^( 6) =       0.000599357846
  error estimate for blocks of size 2^( 7) =       0.000603104554

      target function =                  N/A
              le_mean =     -22.436844997893
             les_mean =     503.983234221077
             stat err =       0.000595719254
             autocorr =       1.242536253425
              std dev =       0.755791669195
             le_variance =       0.571221047225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571136273072
                                         uncertainty =       0.004608310078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571136273072
                                         uncertainty =       0.004608310078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534448393
  error estimate for blocks of size 2^( 2) =       0.000553923214
  error estimate for blocks of size 2^( 3) =       0.000572073115
  error estimate for blocks of size 2^( 4) =       0.000585960739
  error estimate for blocks of size 2^( 5) =       0.000594438849
  error estimate for blocks of size 2^( 6) =       0.000599353556
  error estimate for blocks of size 2^( 7) =       0.000603098191

      target function =                  N/A
              le_mean =     -22.436848053777
             les_mean =     503.983420472909
             stat err =       0.000595712834
             autocorr =       1.242402628197
              std dev =       0.755824166251
             le_variance =       0.571270170288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571210784127
                                         uncertainty =       0.004608560053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571210784127
                                         uncertainty =       0.004608560053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534483287
  error estimate for blocks of size 2^( 2) =       0.000553957766
  error estimate for blocks of size 2^( 3) =       0.000572105602
  error estimate for blocks of size 2^( 4) =       0.000585989864
  error estimate for blocks of size 2^( 5) =       0.000594467702
  error estimate for blocks of size 2^( 6) =       0.000599378345
  error estimate for blocks of size 2^( 7) =       0.000603128680

      target function =                  N/A
              le_mean =     -22.436848214725
             les_mean =     503.983502292737
             stat err =       0.000595741148
             autocorr =       1.242358502761
              std dev =       0.755873513091
             le_variance =       0.571344767793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571106686065
                                         uncertainty =       0.004609265761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571106686065
                                         uncertainty =       0.004609265761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534434451
  error estimate for blocks of size 2^( 2) =       0.000553921042
  error estimate for blocks of size 2^( 3) =       0.000572078116
  error estimate for blocks of size 2^( 4) =       0.000585967216
  error estimate for blocks of size 2^( 5) =       0.000594451665
  error estimate for blocks of size 2^( 6) =       0.000599359379
  error estimate for blocks of size 2^( 7) =       0.000603107435

      target function =                  N/A
              le_mean =     -22.436845390332
             les_mean =     503.983271148401
             stat err =       0.000595721424
             autocorr =       1.242503285493
              std dev =       0.755804448500
             le_variance =       0.571240364373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436844997893        initial
     9.7656e-02     9.7656e-01             2.4767e-03       -22.436848053777
     3.9062e-01     3.9062e+00             7.8816e-04       -22.436848214725  <--
     1.5625e+00     1.5625e+01             2.1292e-04       -22.436845390332

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 6.3298e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.685410e-01 1 1  ON 0
 uu_1                 9.316431e-02 1 1  ON 1
 uu_2                -2.373188e-02 1 1  ON 2
 uu_3                -9.484179e-02 1 1  ON 3
 uu_4                -1.374233e-01 1 1  ON 4
 uu_5                -1.640857e-01 1 1  ON 5
 uu_6                -1.787312e-01 1 1  ON 6
 uu_7                -1.817726e-01 1 1  ON 7
 uu_8                -1.713472e-01 1 1  ON 8
 uu_9                -1.425828e-01 1 1  ON 9
 ud_0                 4.715167e-01 1 1  ON 10
 ud_1                 1.869364e-01 1 1  ON 11
 ud_2                 3.602325e-02 1 1  ON 12
 ud_3                -4.941136e-02 1 1  ON 13
 ud_4                -1.006384e-01 1 1  ON 14
 ud_5                -1.354441e-01 1 1  ON 15
 ud_6                -1.583007e-01 1 1  ON 16
 ud_7                -1.699292e-01 1 1  ON 17
 ud_8                -1.674654e-01 1 1  ON 18
 ud_9                -1.451266e-01 1 1  ON 19
 eC_0                -6.980626e-01 1 1  ON 20
 eC_1                -5.231386e-01 1 1  ON 21
 eC_2                -2.165208e-01 1 1  ON 22
 eC_3                 7.544579e-03 1 1  ON 23
 eC_4                 1.564472e-01 1 1  ON 24
 eC_5                 2.777966e-01 1 1  ON 25
 eC_6                 2.993332e-01 1 1  ON 26
 eC_7                 3.684477e-01 1 1  ON 27
 eC_8                 2.765671e-01 1 1  ON 28
 eC_9                 5.006572e-02 1 1  ON 29
 eO_0                -1.244352e+00 1 1  ON 30
 eO_1                -8.511869e-01 1 1  ON 31
 eO_2                -3.582739e-01 1 1  ON 32
 eO_3                -3.248328e-02 1 1  ON 33
 eO_4                 1.972080e-01 1 1  ON 34
 eO_5                 3.459016e-01 1 1  ON 35
 eO_6                 3.963677e-01 1 1  ON 36
 eO_7                 4.470702e-01 1 1  ON 37
 eO_8                 5.356535e-01 1 1  ON 38
 eO_9                 4.003496e-01 1 1  ON 39
eH1_0                -1.627964e-01 1 1  ON 40
eH1_1                -6.148137e-02 1 1  ON 41
eH1_2                -4.182684e-02 1 1  ON 42
eH1_3                -4.032668e-02 1 1  ON 43
eH1_4                -2.162835e-03 1 1  ON 44
eH1_5                 9.982158e-03 1 1  ON 45
eH1_6                 4.275914e-02 1 1  ON 46
eH1_7                 6.215720e-02 1 1  ON 47
eH1_8                 3.361187e-02 1 1  ON 48
eH1_9                 6.050765e-02 1 1  ON 49
eH2_0                -1.747470e-01 1 1  ON 50
eH2_1                -7.364002e-02 1 1  ON 51
eH2_2                -5.375530e-02 1 1  ON 52
eH2_3                -5.242518e-02 1 1  ON 53
eH2_4                -1.432084e-02 1 1  ON 54
eH2_5                -2.457600e-03 1 1  ON 55
eH2_6                 3.031312e-02 1 1  ON 56
eH2_7                 4.807698e-02 1 1  ON 57
eH2_8                 2.703964e-02 1 1  ON 58
eH2_9                 1.158998e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2353e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2448e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.4085
    reference variance = 0.468009
====================================================
  Execution time = 4.4233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6414e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5087e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564178743982
                                         uncertainty =       0.004099903027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564178743982
                                         uncertainty =       0.004099903027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531102517
  error estimate for blocks of size 2^( 2) =       0.000551104218
  error estimate for blocks of size 2^( 3) =       0.000568985169
  error estimate for blocks of size 2^( 4) =       0.000582761495
  error estimate for blocks of size 2^( 5) =       0.000591779557
  error estimate for blocks of size 2^( 6) =       0.000596329314
  error estimate for blocks of size 2^( 7) =       0.000596870489

      target function =                  N/A
              le_mean =     -22.437531649428
             les_mean =     504.006966004314
             stat err =       0.000591935214
             autocorr =       1.242200311402
              std dev =       0.751092382668
             le_variance =       0.564139767301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243753164943e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437531649428       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437536146328       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437536428388       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437539846271       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437538811890       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437538722019       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437539737776       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437539889448       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437539323022       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437539452686       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437540606578       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437541193926       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437540990994       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437540899783       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437541132004       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437540715093       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 1.929939e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437531649428       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437533629597       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437533853623       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437535787529       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437535640612       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437535230939       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437535380249       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437535470172       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437535602519       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437535636396       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437535612098       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437535745552       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437535816983       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 5.213023e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437531649428       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437532260848       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437532365169       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437533030148       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437533074891       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437532914672       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437532951215       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437533001499       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437533043021       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437533021695       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.356775e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.417945 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9330e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.685930e-01 1 1  ON 0
 uu_1                 9.311979e-02 1 1  ON 1
 uu_2                -2.378086e-02 1 1  ON 2
 uu_3                -9.484537e-02 1 1  ON 3
 uu_4                -1.374830e-01 1 1  ON 4
 uu_5                -1.641099e-01 1 1  ON 5
 uu_6                -1.788141e-01 1 1  ON 6
 uu_7                -1.816100e-01 1 1  ON 7
 uu_8                -1.711747e-01 1 1  ON 8
 uu_9                -1.423951e-01 1 1  ON 9
 ud_0                 4.716839e-01 1 1  ON 10
 ud_1                 1.870592e-01 1 1  ON 11
 ud_2                 3.612398e-02 1 1  ON 12
 ud_3                -4.940276e-02 1 1  ON 13
 ud_4                -1.005395e-01 1 1  ON 14
 ud_5                -1.353667e-01 1 1  ON 15
 ud_6                -1.582541e-01 1 1  ON 16
 ud_7                -1.698782e-01 1 1  ON 17
 ud_8                -1.672521e-01 1 1  ON 18
 ud_9                -1.452307e-01 1 1  ON 19
 eC_0                -6.978947e-01 1 1  ON 20
 eC_1                -5.230047e-01 1 1  ON 21
 eC_2                -2.164733e-01 1 1  ON 22
 eC_3                 7.726865e-03 1 1  ON 23
 eC_4                 1.562473e-01 1 1  ON 24
 eC_5                 2.776366e-01 1 1  ON 25
 eC_6                 2.991327e-01 1 1  ON 26
 eC_7                 3.681429e-01 1 1  ON 27
 eC_8                 2.767075e-01 1 1  ON 28
 eC_9                 5.022401e-02 1 1  ON 29
 eO_0                -1.244554e+00 1 1  ON 30
 eO_1                -8.510950e-01 1 1  ON 31
 eO_2                -3.582771e-01 1 1  ON 32
 eO_3                -3.232026e-02 1 1  ON 33
 eO_4                 1.970277e-01 1 1  ON 34
 eO_5                 3.458268e-01 1 1  ON 35
 eO_6                 3.964485e-01 1 1  ON 36
 eO_7                 4.471975e-01 1 1  ON 37
 eO_8                 5.351535e-01 1 1  ON 38
 eO_9                 4.005703e-01 1 1  ON 39
eH1_0                -1.624471e-01 1 1  ON 40
eH1_1                -6.130866e-02 1 1  ON 41
eH1_2                -4.176665e-02 1 1  ON 42
eH1_3                -4.036003e-02 1 1  ON 43
eH1_4                -2.181320e-03 1 1  ON 44
eH1_5                 9.808292e-03 1 1  ON 45
eH1_6                 4.264769e-02 1 1  ON 46
eH1_7                 6.163590e-02 1 1  ON 47
eH1_8                 3.373701e-02 1 1  ON 48
eH1_9                 6.051180e-02 1 1  ON 49
eH2_0                -1.746443e-01 1 1  ON 50
eH2_1                -7.328446e-02 1 1  ON 51
eH2_2                -5.384428e-02 1 1  ON 52
eH2_3                -5.238653e-02 1 1  ON 53
eH2_4                -1.426528e-02 1 1  ON 54
eH2_5                -2.570662e-03 1 1  ON 55
eH2_6                 3.041140e-02 1 1  ON 56
eH2_7                 4.766687e-02 1 1  ON 57
eH2_8                 2.708083e-02 1 1  ON 58
eH2_9                 1.156165e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.4432
    reference variance = 0.425742
====================================================
  Execution time = 4.3434e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6402e-01
  Total weights = 2.0000e+06
  Execution time = 3.5708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563989500811
                                         uncertainty =       0.003842263296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563989500811
                                         uncertainty =       0.003842263296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530973045
  error estimate for blocks of size 2^( 2) =       0.000551153300
  error estimate for blocks of size 2^( 3) =       0.000570234352
  error estimate for blocks of size 2^( 4) =       0.000582754816
  error estimate for blocks of size 2^( 5) =       0.000591315766
  error estimate for blocks of size 2^( 6) =       0.000598670100
  error estimate for blocks of size 2^( 7) =       0.000601694905

      target function =                  N/A
              le_mean =     -22.437264155799
             les_mean =     503.994687263958
             stat err =       0.000593608897
             autocorr =       1.249844126399
              std dev =       0.750909281319
             le_variance =       0.563864748771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564277473240
                                         uncertainty =       0.003845316352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564277473240
                                         uncertainty =       0.003845316352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531108567
  error estimate for blocks of size 2^( 2) =       0.000551280120
  error estimate for blocks of size 2^( 3) =       0.000570347762
  error estimate for blocks of size 2^( 4) =       0.000582860177
  error estimate for blocks of size 2^( 5) =       0.000591415080
  error estimate for blocks of size 2^( 6) =       0.000598774599
  error estimate for blocks of size 2^( 7) =       0.000601791208

      target function =                  N/A
              le_mean =     -22.437267562933
             les_mean =     503.995128028791
             stat err =       0.000593710266
             autocorr =       1.249633050403
              std dev =       0.751100938778
             le_variance =       0.564152620234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564305118430
                                         uncertainty =       0.003845811761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564305118430
                                         uncertainty =       0.003845811761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531121595
  error estimate for blocks of size 2^( 2) =       0.000551294233
  error estimate for blocks of size 2^( 3) =       0.000570362224
  error estimate for blocks of size 2^( 4) =       0.000582874353
  error estimate for blocks of size 2^( 5) =       0.000591430583
  error estimate for blocks of size 2^( 6) =       0.000598788781
  error estimate for blocks of size 2^( 7) =       0.000601805208

      target function =                  N/A
              le_mean =     -22.437268120014
             les_mean =     503.995180705085
             stat err =       0.000593724731
             autocorr =       1.249632636450
              std dev =       0.751119363196
             le_variance =       0.564180297769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564040835285
                                         uncertainty =       0.003842902684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564040835285
                                         uncertainty =       0.003842902684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530997209
  error estimate for blocks of size 2^( 2) =       0.000551176216
  error estimate for blocks of size 2^( 3) =       0.000570255140
  error estimate for blocks of size 2^( 4) =       0.000582774185
  error estimate for blocks of size 2^( 5) =       0.000591334485
  error estimate for blocks of size 2^( 6) =       0.000598689466
  error estimate for blocks of size 2^( 7) =       0.000601712525

      target function =                  N/A
              le_mean =     -22.437264642371
             les_mean =     503.994760422535
             stat err =       0.000593627665
             autocorr =       1.249809402341
              std dev =       0.750943455052
             le_variance =       0.563916072685


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437264155799        initial
     9.7656e-02     9.7656e-01             1.9299e-03       -22.437267562933
     3.9062e-01     3.9062e+00             5.2130e-04       -22.437268120014  <--
     1.5625e+00     1.5625e+01             1.3568e-04       -22.437264642371

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 6.1311e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.685930e-01 1 1  ON 0
 uu_1                 9.311979e-02 1 1  ON 1
 uu_2                -2.378086e-02 1 1  ON 2
 uu_3                -9.484537e-02 1 1  ON 3
 uu_4                -1.374830e-01 1 1  ON 4
 uu_5                -1.641099e-01 1 1  ON 5
 uu_6                -1.788141e-01 1 1  ON 6
 uu_7                -1.816100e-01 1 1  ON 7
 uu_8                -1.711747e-01 1 1  ON 8
 uu_9                -1.423951e-01 1 1  ON 9
 ud_0                 4.716839e-01 1 1  ON 10
 ud_1                 1.870592e-01 1 1  ON 11
 ud_2                 3.612398e-02 1 1  ON 12
 ud_3                -4.940276e-02 1 1  ON 13
 ud_4                -1.005395e-01 1 1  ON 14
 ud_5                -1.353667e-01 1 1  ON 15
 ud_6                -1.582541e-01 1 1  ON 16
 ud_7                -1.698782e-01 1 1  ON 17
 ud_8                -1.672521e-01 1 1  ON 18
 ud_9                -1.452307e-01 1 1  ON 19
 eC_0                -6.978947e-01 1 1  ON 20
 eC_1                -5.230047e-01 1 1  ON 21
 eC_2                -2.164733e-01 1 1  ON 22
 eC_3                 7.726865e-03 1 1  ON 23
 eC_4                 1.562473e-01 1 1  ON 24
 eC_5                 2.776366e-01 1 1  ON 25
 eC_6                 2.991327e-01 1 1  ON 26
 eC_7                 3.681429e-01 1 1  ON 27
 eC_8                 2.767075e-01 1 1  ON 28
 eC_9                 5.022401e-02 1 1  ON 29
 eO_0                -1.244554e+00 1 1  ON 30
 eO_1                -8.510950e-01 1 1  ON 31
 eO_2                -3.582771e-01 1 1  ON 32
 eO_3                -3.232026e-02 1 1  ON 33
 eO_4                 1.970277e-01 1 1  ON 34
 eO_5                 3.458268e-01 1 1  ON 35
 eO_6                 3.964485e-01 1 1  ON 36
 eO_7                 4.471975e-01 1 1  ON 37
 eO_8                 5.351535e-01 1 1  ON 38
 eO_9                 4.005703e-01 1 1  ON 39
eH1_0                -1.624471e-01 1 1  ON 40
eH1_1                -6.130866e-02 1 1  ON 41
eH1_2                -4.176665e-02 1 1  ON 42
eH1_3                -4.036003e-02 1 1  ON 43
eH1_4                -2.181320e-03 1 1  ON 44
eH1_5                 9.808292e-03 1 1  ON 45
eH1_6                 4.264769e-02 1 1  ON 46
eH1_7                 6.163590e-02 1 1  ON 47
eH1_8                 3.373701e-02 1 1  ON 48
eH1_9                 6.051180e-02 1 1  ON 49
eH2_0                -1.746443e-01 1 1  ON 50
eH2_1                -7.328446e-02 1 1  ON 51
eH2_2                -5.384428e-02 1 1  ON 52
eH2_3                -5.238653e-02 1 1  ON 53
eH2_4                -1.426528e-02 1 1  ON 54
eH2_5                -2.570662e-03 1 1  ON 55
eH2_6                 3.041140e-02 1 1  ON 56
eH2_7                 4.766687e-02 1 1  ON 57
eH2_8                 2.708083e-02 1 1  ON 58
eH2_9                 1.156165e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2065e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2445e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.4821
    reference variance = 0.342391
====================================================
  Execution time = 4.3533e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7185e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5087e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571893391731
                                         uncertainty =       0.005329550850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571893391731
                                         uncertainty =       0.005329550850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534717722
  error estimate for blocks of size 2^( 2) =       0.000554694905
  error estimate for blocks of size 2^( 3) =       0.000573281432
  error estimate for blocks of size 2^( 4) =       0.000587089520
  error estimate for blocks of size 2^( 5) =       0.000595382560
  error estimate for blocks of size 2^( 6) =       0.000600291174
  error estimate for blocks of size 2^( 7) =       0.000599175732

      target function =                  N/A
              le_mean =     -22.438071834798
             les_mean =     504.038913462711
             stat err =       0.000595484746
             autocorr =       1.240201139886
              std dev =       0.756205054928
             le_variance =       0.571846085099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243807183480e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438071834798       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438074850647       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438078387568       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438079615109       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438079505018       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438079347605       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438081959372       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438083399699       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438082451110       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438082490303       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.438081686390       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.438081276107       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.438081372337       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.438081652229       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.438081841118       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.438081682846       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 1.976690e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438071834798       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438073270937       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438074908658       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438075844743       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438076383729       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438076186345       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438076583298       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438077223741       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438077223950       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438076906205       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.438076985947       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.438076903315       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.438076762638       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 5.775577e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438071834798       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438072298785       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438072839859       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438073242864       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438073590324       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438073647526       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438073578518       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438073697617       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438073807146       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438073742849       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.438073740469       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.512702e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.424361 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8630e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.686027e-01 1 1  ON 0
 uu_1                 9.301831e-02 1 1  ON 1
 uu_2                -2.378441e-02 1 1  ON 2
 uu_3                -9.485964e-02 1 1  ON 3
 uu_4                -1.373412e-01 1 1  ON 4
 uu_5                -1.641664e-01 1 1  ON 5
 uu_6                -1.787326e-01 1 1  ON 6
 uu_7                -1.815597e-01 1 1  ON 7
 uu_8                -1.712090e-01 1 1  ON 8
 uu_9                -1.421302e-01 1 1  ON 9
 ud_0                 4.717127e-01 1 1  ON 10
 ud_1                 1.870948e-01 1 1  ON 11
 ud_2                 3.605428e-02 1 1  ON 12
 ud_3                -4.945319e-02 1 1  ON 13
 ud_4                -1.005571e-01 1 1  ON 14
 ud_5                -1.353798e-01 1 1  ON 15
 ud_6                -1.582791e-01 1 1  ON 16
 ud_7                -1.696662e-01 1 1  ON 17
 ud_8                -1.668959e-01 1 1  ON 18
 ud_9                -1.449829e-01 1 1  ON 19
 eC_0                -6.975615e-01 1 1  ON 20
 eC_1                -5.231355e-01 1 1  ON 21
 eC_2                -2.163072e-01 1 1  ON 22
 eC_3                 7.765266e-03 1 1  ON 23
 eC_4                 1.562219e-01 1 1  ON 24
 eC_5                 2.774280e-01 1 1  ON 25
 eC_6                 2.988568e-01 1 1  ON 26
 eC_7                 3.678646e-01 1 1  ON 27
 eC_8                 2.769511e-01 1 1  ON 28
 eC_9                 5.035767e-02 1 1  ON 29
 eO_0                -1.244742e+00 1 1  ON 30
 eO_1                -8.510304e-01 1 1  ON 31
 eO_2                -3.583873e-01 1 1  ON 32
 eO_3                -3.212952e-02 1 1  ON 33
 eO_4                 1.970783e-01 1 1  ON 34
 eO_5                 3.458875e-01 1 1  ON 35
 eO_6                 3.964035e-01 1 1  ON 36
 eO_7                 4.471444e-01 1 1  ON 37
 eO_8                 5.346394e-01 1 1  ON 38
 eO_9                 4.008652e-01 1 1  ON 39
eH1_0                -1.624111e-01 1 1  ON 40
eH1_1                -6.125429e-02 1 1  ON 41
eH1_2                -4.161093e-02 1 1  ON 42
eH1_3                -4.022529e-02 1 1  ON 43
eH1_4                -2.408870e-03 1 1  ON 44
eH1_5                 9.776827e-03 1 1  ON 45
eH1_6                 4.267726e-02 1 1  ON 46
eH1_7                 6.111078e-02 1 1  ON 47
eH1_8                 3.395470e-02 1 1  ON 48
eH1_9                 6.049592e-02 1 1  ON 49
eH2_0                -1.743436e-01 1 1  ON 50
eH2_1                -7.313471e-02 1 1  ON 51
eH2_2                -5.394960e-02 1 1  ON 52
eH2_3                -5.203652e-02 1 1  ON 53
eH2_4                -1.441914e-02 1 1  ON 54
eH2_5                -2.442581e-03 1 1  ON 55
eH2_6                 3.032031e-02 1 1  ON 56
eH2_7                 4.708932e-02 1 1  ON 57
eH2_8                 2.708437e-02 1 1  ON 58
eH2_9                 1.154215e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.3634
    reference variance = 0.657643
====================================================
  Execution time = 4.3615e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7333e-01
  Total weights = 2.0000e+06
  Execution time = 3.5841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573342235835
                                         uncertainty =       0.006579704531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573342235835
                                         uncertainty =       0.006579704531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535349463
  error estimate for blocks of size 2^( 2) =       0.000554933081
  error estimate for blocks of size 2^( 3) =       0.000572945313
  error estimate for blocks of size 2^( 4) =       0.000586583113
  error estimate for blocks of size 2^( 5) =       0.000595643147
  error estimate for blocks of size 2^( 6) =       0.000599989260
  error estimate for blocks of size 2^( 7) =       0.000601527733

      target function =                  N/A
              le_mean =     -22.438366445019
             les_mean =     504.053486529854
             stat err =       0.000595935813
             autocorr =       1.239150989708
              std dev =       0.757098471472
             le_variance =       0.573198095505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573511288433
                                         uncertainty =       0.006581519181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573511288433
                                         uncertainty =       0.006581519181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535428401
  error estimate for blocks of size 2^( 2) =       0.000554998923
  error estimate for blocks of size 2^( 3) =       0.000573000688
  error estimate for blocks of size 2^( 4) =       0.000586635134
  error estimate for blocks of size 2^( 5) =       0.000595689160
  error estimate for blocks of size 2^( 6) =       0.000600035037
  error estimate for blocks of size 2^( 7) =       0.000601587806

      target function =                  N/A
              le_mean =     -22.438368359144
             les_mean =     504.053741479507
             stat err =       0.000595986784
             autocorr =       1.238997560412
              std dev =       0.757210106624
             le_variance =       0.573367145573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573606993540
                                         uncertainty =       0.006586285561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573606993540
                                         uncertainty =       0.006586285561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535473081
  error estimate for blocks of size 2^( 2) =       0.000555042817
  error estimate for blocks of size 2^( 3) =       0.000573043913
  error estimate for blocks of size 2^( 4) =       0.000586676326
  error estimate for blocks of size 2^( 5) =       0.000595728989
  error estimate for blocks of size 2^( 6) =       0.000600074670
  error estimate for blocks of size 2^( 7) =       0.000601624406

      target function =                  N/A
              le_mean =     -22.438368488617
             les_mean =     504.053842985674
             stat err =       0.000596026098
             autocorr =       1.238954238613
              std dev =       0.757273293760
             le_variance =       0.573462841442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573387029006
                                         uncertainty =       0.006581661560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573387029006
                                         uncertainty =       0.006581661560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535370380
  error estimate for blocks of size 2^( 2) =       0.000554951493
  error estimate for blocks of size 2^( 3) =       0.000572961811
  error estimate for blocks of size 2^( 4) =       0.000586598502
  error estimate for blocks of size 2^( 5) =       0.000595657053
  error estimate for blocks of size 2^( 6) =       0.000600003345
  error estimate for blocks of size 2^( 7) =       0.000601542941

      target function =                  N/A
              le_mean =     -22.438366542514
             les_mean =     504.053535697855
             stat err =       0.000595950460
             autocorr =       1.239115070016
              std dev =       0.757128052764
             le_variance =       0.573242888282


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438366445019        initial
     9.7656e-02     9.7656e-01             1.9767e-03       -22.438368359144
     3.9062e-01     3.9062e+00             5.7756e-04       -22.438368488617  <--
     1.5625e+00     1.5625e+01             1.5127e-04       -22.438366542514

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 6.1512e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.686027e-01 1 1  ON 0
 uu_1                 9.301831e-02 1 1  ON 1
 uu_2                -2.378441e-02 1 1  ON 2
 uu_3                -9.485964e-02 1 1  ON 3
 uu_4                -1.373412e-01 1 1  ON 4
 uu_5                -1.641664e-01 1 1  ON 5
 uu_6                -1.787326e-01 1 1  ON 6
 uu_7                -1.815597e-01 1 1  ON 7
 uu_8                -1.712090e-01 1 1  ON 8
 uu_9                -1.421302e-01 1 1  ON 9
 ud_0                 4.717127e-01 1 1  ON 10
 ud_1                 1.870948e-01 1 1  ON 11
 ud_2                 3.605428e-02 1 1  ON 12
 ud_3                -4.945319e-02 1 1  ON 13
 ud_4                -1.005571e-01 1 1  ON 14
 ud_5                -1.353798e-01 1 1  ON 15
 ud_6                -1.582791e-01 1 1  ON 16
 ud_7                -1.696662e-01 1 1  ON 17
 ud_8                -1.668959e-01 1 1  ON 18
 ud_9                -1.449829e-01 1 1  ON 19
 eC_0                -6.975615e-01 1 1  ON 20
 eC_1                -5.231355e-01 1 1  ON 21
 eC_2                -2.163072e-01 1 1  ON 22
 eC_3                 7.765266e-03 1 1  ON 23
 eC_4                 1.562219e-01 1 1  ON 24
 eC_5                 2.774280e-01 1 1  ON 25
 eC_6                 2.988568e-01 1 1  ON 26
 eC_7                 3.678646e-01 1 1  ON 27
 eC_8                 2.769511e-01 1 1  ON 28
 eC_9                 5.035767e-02 1 1  ON 29
 eO_0                -1.244742e+00 1 1  ON 30
 eO_1                -8.510304e-01 1 1  ON 31
 eO_2                -3.583873e-01 1 1  ON 32
 eO_3                -3.212952e-02 1 1  ON 33
 eO_4                 1.970783e-01 1 1  ON 34
 eO_5                 3.458875e-01 1 1  ON 35
 eO_6                 3.964035e-01 1 1  ON 36
 eO_7                 4.471444e-01 1 1  ON 37
 eO_8                 5.346394e-01 1 1  ON 38
 eO_9                 4.008652e-01 1 1  ON 39
eH1_0                -1.624111e-01 1 1  ON 40
eH1_1                -6.125429e-02 1 1  ON 41
eH1_2                -4.161093e-02 1 1  ON 42
eH1_3                -4.022529e-02 1 1  ON 43
eH1_4                -2.408870e-03 1 1  ON 44
eH1_5                 9.776827e-03 1 1  ON 45
eH1_6                 4.267726e-02 1 1  ON 46
eH1_7                 6.111078e-02 1 1  ON 47
eH1_8                 3.395470e-02 1 1  ON 48
eH1_9                 6.049592e-02 1 1  ON 49
eH2_0                -1.743436e-01 1 1  ON 50
eH2_1                -7.313471e-02 1 1  ON 51
eH2_2                -5.394960e-02 1 1  ON 52
eH2_3                -5.203652e-02 1 1  ON 53
eH2_4                -1.441914e-02 1 1  ON 54
eH2_5                -2.442581e-03 1 1  ON 55
eH2_6                 3.032031e-02 1 1  ON 56
eH2_7                 4.708932e-02 1 1  ON 57
eH2_8                 2.708437e-02 1 1  ON 58
eH2_9                 1.154215e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2015e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2443e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.3803
    reference variance = 0.345691
====================================================
  Execution time = 4.6201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6300e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5019e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563011945477
                                         uncertainty =       0.005722495941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563011945477
                                         uncertainty =       0.005722495941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530567228
  error estimate for blocks of size 2^( 2) =       0.000550571111
  error estimate for blocks of size 2^( 3) =       0.000568544195
  error estimate for blocks of size 2^( 4) =       0.000581579224
  error estimate for blocks of size 2^( 5) =       0.000588628094
  error estimate for blocks of size 2^( 6) =       0.000594486843
  error estimate for blocks of size 2^( 7) =       0.000597213839

      target function =                  N/A
              le_mean =     -22.437307196334
             les_mean =     503.995757108391
             stat err =       0.000590477000
             autocorr =       1.238583041142
              std dev =       0.750335369843
             le_variance =       0.563003167238


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243730719633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437307196334       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437310297942       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437312744819       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437314744457       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437315072149       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437315622949       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437315372081       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437314726608       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437315227281       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437315226787       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437315789032       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437315367568       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437315486602       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437315013826       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.437315195857       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.437315254073       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.437315409205       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 2.032484e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437307196334       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437308604325       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437309804910       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437311070224       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437311133613       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437311441652       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437311826191       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437311281490       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437311548767       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437311564166       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437311592447       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437311474634       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437311506188       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 5.306544e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437307196334       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437307638517       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437308050673       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437308566024       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437308592611       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437308683573       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437308935407       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437308812212       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437308842993       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437308843245       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437308840304       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.368257e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.431291 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1231e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.685676e-01 1 1  ON 0
 uu_1                 9.290112e-02 1 1  ON 1
 uu_2                -2.392335e-02 1 1  ON 2
 uu_3                -9.494834e-02 1 1  ON 3
 uu_4                -1.374616e-01 1 1  ON 4
 uu_5                -1.640707e-01 1 1  ON 5
 uu_6                -1.785251e-01 1 1  ON 6
 uu_7                -1.814292e-01 1 1  ON 7
 uu_8                -1.709799e-01 1 1  ON 8
 uu_9                -1.421045e-01 1 1  ON 9
 ud_0                 4.716475e-01 1 1  ON 10
 ud_1                 1.873087e-01 1 1  ON 11
 ud_2                 3.628438e-02 1 1  ON 12
 ud_3                -4.922936e-02 1 1  ON 13
 ud_4                -1.004892e-01 1 1  ON 14
 ud_5                -1.353287e-01 1 1  ON 15
 ud_6                -1.582931e-01 1 1  ON 16
 ud_7                -1.697651e-01 1 1  ON 17
 ud_8                -1.669033e-01 1 1  ON 18
 ud_9                -1.449870e-01 1 1  ON 19
 eC_0                -6.977585e-01 1 1  ON 20
 eC_1                -5.228516e-01 1 1  ON 21
 eC_2                -2.161620e-01 1 1  ON 22
 eC_3                 7.860693e-03 1 1  ON 23
 eC_4                 1.559877e-01 1 1  ON 24
 eC_5                 2.775684e-01 1 1  ON 25
 eC_6                 2.987042e-01 1 1  ON 26
 eC_7                 3.675133e-01 1 1  ON 27
 eC_8                 2.771033e-01 1 1  ON 28
 eC_9                 5.047741e-02 1 1  ON 29
 eO_0                -1.244578e+00 1 1  ON 30
 eO_1                -8.512997e-01 1 1  ON 31
 eO_2                -3.586346e-01 1 1  ON 32
 eO_3                -3.186039e-02 1 1  ON 33
 eO_4                 1.973096e-01 1 1  ON 34
 eO_5                 3.457674e-01 1 1  ON 35
 eO_6                 3.963139e-01 1 1  ON 36
 eO_7                 4.471559e-01 1 1  ON 37
 eO_8                 5.341269e-01 1 1  ON 38
 eO_9                 4.011237e-01 1 1  ON 39
eH1_0                -1.622948e-01 1 1  ON 40
eH1_1                -6.148550e-02 1 1  ON 41
eH1_2                -4.156746e-02 1 1  ON 42
eH1_3                -4.012802e-02 1 1  ON 43
eH1_4                -2.339419e-03 1 1  ON 44
eH1_5                 1.003263e-02 1 1  ON 45
eH1_6                 4.263574e-02 1 1  ON 46
eH1_7                 6.058013e-02 1 1  ON 47
eH1_8                 3.409371e-02 1 1  ON 48
eH1_9                 6.048871e-02 1 1  ON 49
eH2_0                -1.738652e-01 1 1  ON 50
eH2_1                -7.331274e-02 1 1  ON 51
eH2_2                -5.367452e-02 1 1  ON 52
eH2_3                -5.223423e-02 1 1  ON 53
eH2_4                -1.442875e-02 1 1  ON 54
eH2_5                -2.543206e-03 1 1  ON 55
eH2_6                 3.040917e-02 1 1  ON 56
eH2_7                 4.697699e-02 1 1  ON 57
eH2_8                 2.704580e-02 1 1  ON 58
eH2_9                 1.151148e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.4025
    reference variance = 0.355708
====================================================
  Execution time = 4.3712e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6277e-01
  Total weights = 2.0000e+06
  Execution time = 3.5718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563281915760
                                         uncertainty =       0.003464810837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563281915760
                                         uncertainty =       0.003464810837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530660881
  error estimate for blocks of size 2^( 2) =       0.000550710501
  error estimate for blocks of size 2^( 3) =       0.000568949360
  error estimate for blocks of size 2^( 4) =       0.000582496078
  error estimate for blocks of size 2^( 5) =       0.000590133827
  error estimate for blocks of size 2^( 6) =       0.000595002080
  error estimate for blocks of size 2^( 7) =       0.000597577586

      target function =                  N/A
              le_mean =     -22.437832833993
             les_mean =     504.019543945179
             stat err =       0.000591302393
             autocorr =       1.241609783243
              std dev =       0.750467814479
             le_variance =       0.563201940569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562575923801
                                         uncertainty =       0.003463809730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562575923801
                                         uncertainty =       0.003463809730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530328281
  error estimate for blocks of size 2^( 2) =       0.000550394537
  error estimate for blocks of size 2^( 3) =       0.000568649708
  error estimate for blocks of size 2^( 4) =       0.000582210251
  error estimate for blocks of size 2^( 5) =       0.000589838590
  error estimate for blocks of size 2^( 6) =       0.000594719911
  error estimate for blocks of size 2^( 7) =       0.000597287304

      target function =                  N/A
              le_mean =     -22.437833221119
             les_mean =     504.018855548925
             stat err =       0.000591014014
             autocorr =       1.241955349622
              std dev =       0.749997447595
             le_variance =       0.562496171399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562422879851
                                         uncertainty =       0.003463457509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562422879851
                                         uncertainty =       0.003463457509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530256150
  error estimate for blocks of size 2^( 2) =       0.000550328680
  error estimate for blocks of size 2^( 3) =       0.000568589580
  error estimate for blocks of size 2^( 4) =       0.000582154661
  error estimate for blocks of size 2^( 5) =       0.000589784500
  error estimate for blocks of size 2^( 6) =       0.000594667334
  error estimate for blocks of size 2^( 7) =       0.000597229276

      target function =                  N/A
              le_mean =     -22.437832411179
             les_mean =     504.018666200205
             stat err =       0.000590958942
             autocorr =       1.242061754555
              std dev =       0.749895438865
             le_variance =       0.562343169230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563110027564
                                         uncertainty =       0.003464539629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563110027564
                                         uncertainty =       0.003464539629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530579921
  error estimate for blocks of size 2^( 2) =       0.000550634034
  error estimate for blocks of size 2^( 3) =       0.000568877202
  error estimate for blocks of size 2^( 4) =       0.000582427533
  error estimate for blocks of size 2^( 5) =       0.000590064211
  error estimate for blocks of size 2^( 6) =       0.000594935355
  error estimate for blocks of size 2^( 7) =       0.000597507147

      target function =                  N/A
              le_mean =     -22.437832141916
             les_mean =     504.019341052316
             stat err =       0.000591233561
             autocorr =       1.241699586059
              std dev =       0.750353320123
             le_variance =       0.563030105019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437832833993        initial
     9.7656e-02     9.7656e-01             2.0325e-03       -22.437833221119  <--
     3.9062e-01     3.9062e+00             5.3065e-04       -22.437832411179
     1.5625e+00     1.5625e+01             1.3683e-04       -22.437832141916

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 6.1594e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.684270e-01 1 1  ON 0
 uu_1                 9.271173e-02 1 1  ON 1
 uu_2                -2.410000e-02 1 1  ON 2
 uu_3                -9.510750e-02 1 1  ON 3
 uu_4                -1.375634e-01 1 1  ON 4
 uu_5                -1.639892e-01 1 1  ON 5
 uu_6                -1.782654e-01 1 1  ON 6
 uu_7                -1.811346e-01 1 1  ON 7
 uu_8                -1.704325e-01 1 1  ON 8
 uu_9                -1.419611e-01 1 1  ON 9
 ud_0                 4.718798e-01 1 1  ON 10
 ud_1                 1.876859e-01 1 1  ON 11
 ud_2                 3.667363e-02 1 1  ON 12
 ud_3                -4.887751e-02 1 1  ON 13
 ud_4                -1.002551e-01 1 1  ON 14
 ud_5                -1.351721e-01 1 1  ON 15
 ud_6                -1.582000e-01 1 1  ON 16
 ud_7                -1.698018e-01 1 1  ON 17
 ud_8                -1.668903e-01 1 1  ON 18
 ud_9                -1.449909e-01 1 1  ON 19
 eC_0                -6.978393e-01 1 1  ON 20
 eC_1                -5.224767e-01 1 1  ON 21
 eC_2                -2.159549e-01 1 1  ON 22
 eC_3                 7.978357e-03 1 1  ON 23
 eC_4                 1.556586e-01 1 1  ON 24
 eC_5                 2.778082e-01 1 1  ON 25
 eC_6                 2.983990e-01 1 1  ON 26
 eC_7                 3.664826e-01 1 1  ON 27
 eC_8                 2.775550e-01 1 1  ON 28
 eC_9                 5.083677e-02 1 1  ON 29
 eO_0                -1.244562e+00 1 1  ON 30
 eO_1                -8.515807e-01 1 1  ON 31
 eO_2                -3.588301e-01 1 1  ON 32
 eO_3                -3.146619e-02 1 1  ON 33
 eO_4                 1.976115e-01 1 1  ON 34
 eO_5                 3.457533e-01 1 1  ON 35
 eO_6                 3.960267e-01 1 1  ON 36
 eO_7                 4.470468e-01 1 1  ON 37
 eO_8                 5.326070e-01 1 1  ON 38
 eO_9                 4.019002e-01 1 1  ON 39
eH1_0                -1.621641e-01 1 1  ON 40
eH1_1                -6.175793e-02 1 1  ON 41
eH1_2                -4.146643e-02 1 1  ON 42
eH1_3                -3.994115e-02 1 1  ON 43
eH1_4                -2.212016e-03 1 1  ON 44
eH1_5                 1.036252e-02 1 1  ON 45
eH1_6                 4.264309e-02 1 1  ON 46
eH1_7                 5.931602e-02 1 1  ON 47
eH1_8                 3.450773e-02 1 1  ON 48
eH1_9                 6.046034e-02 1 1  ON 49
eH2_0                -1.731489e-01 1 1  ON 50
eH2_1                -7.338922e-02 1 1  ON 51
eH2_2                -5.334101e-02 1 1  ON 52
eH2_3                -5.230402e-02 1 1  ON 53
eH2_4                -1.447834e-02 1 1  ON 54
eH2_5                -2.570306e-03 1 1  ON 55
eH2_6                 3.053767e-02 1 1  ON 56
eH2_7                 4.665955e-02 1 1  ON 57
eH2_8                 2.701230e-02 1 1  ON 58
eH2_9                 1.142082e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2283e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2438e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.3773
    reference variance = 0.561885
====================================================
  Execution time = 4.4382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7064e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5012e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570256848246
                                         uncertainty =       0.004657839535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570256848246
                                         uncertainty =       0.004657839535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534154315
  error estimate for blocks of size 2^( 2) =       0.000554336416
  error estimate for blocks of size 2^( 3) =       0.000573013324
  error estimate for blocks of size 2^( 4) =       0.000587531357
  error estimate for blocks of size 2^( 5) =       0.000595056449
  error estimate for blocks of size 2^( 6) =       0.000600809157
  error estimate for blocks of size 2^( 7) =       0.000602178255

      target function =                  N/A
              le_mean =     -22.436829331835
             les_mean =     503.981951845312
             stat err =       0.000596393805
             autocorr =       1.246616194456
              std dev =       0.755408276861
             le_variance =       0.570641664750


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243682933183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436829331835       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436830596747       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436828922431       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436832445031       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436829811809       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436829386237       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436831858823       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436832906230       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436834366011       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436835702504       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436836885672       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436835959593       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436837428213       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436838418663       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436837172735       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436837318382       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.436837382708       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.436837706172       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.436838362794       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.436837837715       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-02 is 7.537486e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436829331835       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436830308087       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436829057554       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436831519309       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436830161880       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436829794071       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436830801472       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436830853456       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436832630558       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436833154305       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436832280852       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436832791777       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436833157652       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.436832846866       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.436832840934       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.436832780693       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 2.071803e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436829331835       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436829842207       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436829213923       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436830329581       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436829963477       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436830314784       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436829743535       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436830006265       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436830739233       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436830716393       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436830559461       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436830633548       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 5.267534e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.440681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9407e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.688683e-01 1 1  ON 0
 uu_1                 9.325734e-02 1 1  ON 1
 uu_2                -2.381733e-02 1 1  ON 2
 uu_3                -9.499999e-02 1 1  ON 3
 uu_4                -1.373262e-01 1 1  ON 4
 uu_5                -1.636262e-01 1 1  ON 5
 uu_6                -1.781887e-01 1 1  ON 6
 uu_7                -1.813470e-01 1 1  ON 7
 uu_8                -1.706136e-01 1 1  ON 8
 uu_9                -1.416511e-01 1 1  ON 9
 ud_0                 4.718422e-01 1 1  ON 10
 ud_1                 1.875752e-01 1 1  ON 11
 ud_2                 3.649865e-02 1 1  ON 12
 ud_3                -4.870194e-02 1 1  ON 13
 ud_4                -1.001209e-01 1 1  ON 14
 ud_5                -1.349341e-01 1 1  ON 15
 ud_6                -1.578151e-01 1 1  ON 16
 ud_7                -1.699133e-01 1 1  ON 17
 ud_8                -1.661871e-01 1 1  ON 18
 ud_9                -1.435625e-01 1 1  ON 19
 eC_0                -6.976820e-01 1 1  ON 20
 eC_1                -5.222564e-01 1 1  ON 21
 eC_2                -2.160241e-01 1 1  ON 22
 eC_3                 8.001808e-03 1 1  ON 23
 eC_4                 1.554263e-01 1 1  ON 24
 eC_5                 2.777108e-01 1 1  ON 25
 eC_6                 2.983302e-01 1 1  ON 26
 eC_7                 3.651871e-01 1 1  ON 27
 eC_8                 2.782973e-01 1 1  ON 28
 eC_9                 5.141006e-02 1 1  ON 29
 eO_0                -1.244410e+00 1 1  ON 30
 eO_1                -8.511646e-01 1 1  ON 31
 eO_2                -3.584785e-01 1 1  ON 32
 eO_3                -3.177075e-02 1 1  ON 33
 eO_4                 1.971051e-01 1 1  ON 34
 eO_5                 3.451890e-01 1 1  ON 35
 eO_6                 3.967108e-01 1 1  ON 36
 eO_7                 4.468086e-01 1 1  ON 37
 eO_8                 5.305352e-01 1 1  ON 38
 eO_9                 4.028694e-01 1 1  ON 39
eH1_0                -1.615167e-01 1 1  ON 40
eH1_1                -6.142251e-02 1 1  ON 41
eH1_2                -4.158140e-02 1 1  ON 42
eH1_3                -4.017256e-02 1 1  ON 43
eH1_4                -2.488198e-03 1 1  ON 44
eH1_5                 9.846225e-03 1 1  ON 45
eH1_6                 4.277995e-02 1 1  ON 46
eH1_7                 5.764362e-02 1 1  ON 47
eH1_8                 3.534683e-02 1 1  ON 48
eH1_9                 6.059449e-02 1 1  ON 49
eH2_0                -1.728330e-01 1 1  ON 50
eH2_1                -7.364041e-02 1 1  ON 51
eH2_2                -5.339903e-02 1 1  ON 52
eH2_3                -5.222462e-02 1 1  ON 53
eH2_4                -1.429936e-02 1 1  ON 54
eH2_5                -2.172931e-03 1 1  ON 55
eH2_6                 3.047094e-02 1 1  ON 56
eH2_7                 4.640555e-02 1 1  ON 57
eH2_8                 2.708860e-02 1 1  ON 58
eH2_9                 1.132596e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.4333
    reference variance = 0.336133
====================================================
  Execution time = 4.3317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6285e-01
  Total weights = 2.0000e+06
  Execution time = 3.5781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562691302436
                                         uncertainty =       0.005231751628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562691302436
                                         uncertainty =       0.005231751628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530341202
  error estimate for blocks of size 2^( 2) =       0.000550796940
  error estimate for blocks of size 2^( 3) =       0.000569242490
  error estimate for blocks of size 2^( 4) =       0.000582380827
  error estimate for blocks of size 2^( 5) =       0.000591386320
  error estimate for blocks of size 2^( 6) =       0.000595802371
  error estimate for blocks of size 2^( 7) =       0.000596399872

      target function =                  N/A
              le_mean =     -22.438106185557
             les_mean =     504.031132493380
             stat err =       0.000591492348
             autocorr =       1.243905890433
              std dev =       0.750015720047
             le_variance =       0.562523580318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562989353717
                                         uncertainty =       0.005236110777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562989353717
                                         uncertainty =       0.005236110777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530481636
  error estimate for blocks of size 2^( 2) =       0.000550922574
  error estimate for blocks of size 2^( 3) =       0.000569359884
  error estimate for blocks of size 2^( 4) =       0.000582506866
  error estimate for blocks of size 2^( 5) =       0.000591514177
  error estimate for blocks of size 2^( 6) =       0.000595928003
  error estimate for blocks of size 2^( 7) =       0.000596514716

      target function =                  N/A
              le_mean =     -22.438103296640
             les_mean =     504.031300802580
             stat err =       0.000591615941
             autocorr =       1.243766986617
              std dev =       0.750214324918
             le_variance =       0.562821533312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563365934328
                                         uncertainty =       0.005235820759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563365934328
                                         uncertainty =       0.005235820759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530658993
  error estimate for blocks of size 2^( 2) =       0.000551092795
  error estimate for blocks of size 2^( 3) =       0.000569522940
  error estimate for blocks of size 2^( 4) =       0.000582670108
  error estimate for blocks of size 2^( 5) =       0.000591671278
  error estimate for blocks of size 2^( 6) =       0.000596076167
  error estimate for blocks of size 2^( 7) =       0.000596660976

      target function =                  N/A
              le_mean =     -22.438103597851
             les_mean =     504.031690719834
             stat err =       0.000591769632
             autocorr =       1.243581614000
              std dev =       0.750465144773
             le_variance =       0.563197933520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562953484431
                                         uncertainty =       0.005231733707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562953484431
                                         uncertainty =       0.005231733707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530464734
  error estimate for blocks of size 2^( 2) =       0.000550911470
  error estimate for blocks of size 2^( 3) =       0.000569349911
  error estimate for blocks of size 2^( 4) =       0.000582488346
  error estimate for blocks of size 2^( 5) =       0.000591490555
  error estimate for blocks of size 2^( 6) =       0.000595902372
  error estimate for blocks of size 2^( 7) =       0.000596497903

      target function =                  N/A
              le_mean =     -22.438103853395
             les_mean =     504.031289923363
             stat err =       0.000591594794
             autocorr =       1.243757329324
              std dev =       0.750190421830
             le_variance =       0.562785669006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438106185557        initial  <--
     2.4414e-02     2.4414e-01             7.5375e-03       -22.438103296640
     9.7656e-02     9.7656e-01             2.0718e-03       -22.438103597851
     3.9062e-01     3.9062e+00             5.2675e-04       -22.438103853395

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2072
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.684270e-01 1 1  ON 0
 uu_1                 9.271173e-02 1 1  ON 1
 uu_2                -2.410000e-02 1 1  ON 2
 uu_3                -9.510750e-02 1 1  ON 3
 uu_4                -1.375634e-01 1 1  ON 4
 uu_5                -1.639892e-01 1 1  ON 5
 uu_6                -1.782654e-01 1 1  ON 6
 uu_7                -1.811346e-01 1 1  ON 7
 uu_8                -1.704325e-01 1 1  ON 8
 uu_9                -1.419611e-01 1 1  ON 9
 ud_0                 4.718798e-01 1 1  ON 10
 ud_1                 1.876859e-01 1 1  ON 11
 ud_2                 3.667363e-02 1 1  ON 12
 ud_3                -4.887751e-02 1 1  ON 13
 ud_4                -1.002551e-01 1 1  ON 14
 ud_5                -1.351721e-01 1 1  ON 15
 ud_6                -1.582000e-01 1 1  ON 16
 ud_7                -1.698018e-01 1 1  ON 17
 ud_8                -1.668903e-01 1 1  ON 18
 ud_9                -1.449909e-01 1 1  ON 19
 eC_0                -6.978393e-01 1 1  ON 20
 eC_1                -5.224767e-01 1 1  ON 21
 eC_2                -2.159549e-01 1 1  ON 22
 eC_3                 7.978357e-03 1 1  ON 23
 eC_4                 1.556586e-01 1 1  ON 24
 eC_5                 2.778082e-01 1 1  ON 25
 eC_6                 2.983990e-01 1 1  ON 26
 eC_7                 3.664826e-01 1 1  ON 27
 eC_8                 2.775550e-01 1 1  ON 28
 eC_9                 5.083677e-02 1 1  ON 29
 eO_0                -1.244562e+00 1 1  ON 30
 eO_1                -8.515807e-01 1 1  ON 31
 eO_2                -3.588301e-01 1 1  ON 32
 eO_3                -3.146619e-02 1 1  ON 33
 eO_4                 1.976115e-01 1 1  ON 34
 eO_5                 3.457533e-01 1 1  ON 35
 eO_6                 3.960267e-01 1 1  ON 36
 eO_7                 4.470468e-01 1 1  ON 37
 eO_8                 5.326070e-01 1 1  ON 38
 eO_9                 4.019002e-01 1 1  ON 39
eH1_0                -1.621641e-01 1 1  ON 40
eH1_1                -6.175793e-02 1 1  ON 41
eH1_2                -4.146643e-02 1 1  ON 42
eH1_3                -3.994115e-02 1 1  ON 43
eH1_4                -2.212016e-03 1 1  ON 44
eH1_5                 1.036252e-02 1 1  ON 45
eH1_6                 4.264309e-02 1 1  ON 46
eH1_7                 5.931602e-02 1 1  ON 47
eH1_8                 3.450773e-02 1 1  ON 48
eH1_9                 6.046034e-02 1 1  ON 49
eH2_0                -1.731489e-01 1 1  ON 50
eH2_1                -7.338922e-02 1 1  ON 51
eH2_2                -5.334101e-02 1 1  ON 52
eH2_3                -5.230402e-02 1 1  ON 53
eH2_4                -1.447834e-02 1 1  ON 54
eH2_5                -2.570306e-03 1 1  ON 55
eH2_6                 3.053767e-02 1 1  ON 56
eH2_7                 4.665955e-02 1 1  ON 57
eH2_8                 2.701230e-02 1 1  ON 58
eH2_9                 1.142082e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2063e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2435e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.5304
    reference variance = 0.752551
====================================================
  Execution time = 4.4504e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6120e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4992e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561280694738
                                         uncertainty =       0.004457778142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561280694738
                                         uncertainty =       0.004457778142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529718534
  error estimate for blocks of size 2^( 2) =       0.000549580049
  error estimate for blocks of size 2^( 3) =       0.000568686540
  error estimate for blocks of size 2^( 4) =       0.000582856415
  error estimate for blocks of size 2^( 5) =       0.000591643318
  error estimate for blocks of size 2^( 6) =       0.000595064103
  error estimate for blocks of size 2^( 7) =       0.000597197182

      target function =                  N/A
              le_mean =     -22.437283324247
             les_mean =     503.992886142144
             stat err =       0.000591690255
             autocorr =       1.247666446622
              std dev =       0.749135134825
             le_variance =       0.561203450230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243728332425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437283324247       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437286657902       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437287502204       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437287458409       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437287418545       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437288310613       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437288278960       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437288740313       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437288662508       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437289120558       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437289148286       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.437289124905       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.437289275452       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.437289168851       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 7.960855e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437283324247       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437284737818       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437285271545       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437285265072       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437285090822       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437285315915       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437285500871       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437285559382       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437285515057       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437285537956       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437285604937       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 1.929636e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437283324247       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437283752099       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437283948401       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437283957765       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437283895229       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437283897084       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437283970076       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437284001538       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437284007461       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437283998388       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 5.362304e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.445675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9505e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.684015e-01 1 1  ON 0
 uu_1                 9.277480e-02 1 1  ON 1
 uu_2                -2.408457e-02 1 1  ON 2
 uu_3                -9.509371e-02 1 1  ON 3
 uu_4                -1.375532e-01 1 1  ON 4
 uu_5                -1.640381e-01 1 1  ON 5
 uu_6                -1.783473e-01 1 1  ON 6
 uu_7                -1.812093e-01 1 1  ON 7
 uu_8                -1.704226e-01 1 1  ON 8
 uu_9                -1.418121e-01 1 1  ON 9
 ud_0                 4.720163e-01 1 1  ON 10
 ud_1                 1.876579e-01 1 1  ON 11
 ud_2                 3.653051e-02 1 1  ON 12
 ud_3                -4.890277e-02 1 1  ON 13
 ud_4                -1.002709e-01 1 1  ON 14
 ud_5                -1.350886e-01 1 1  ON 15
 ud_6                -1.581650e-01 1 1  ON 16
 ud_7                -1.697742e-01 1 1  ON 17
 ud_8                -1.669073e-01 1 1  ON 18
 ud_9                -1.448991e-01 1 1  ON 19
 eC_0                -6.976672e-01 1 1  ON 20
 eC_1                -5.224868e-01 1 1  ON 21
 eC_2                -2.160176e-01 1 1  ON 22
 eC_3                 7.986458e-03 1 1  ON 23
 eC_4                 1.556470e-01 1 1  ON 24
 eC_5                 2.777762e-01 1 1  ON 25
 eC_6                 2.983063e-01 1 1  ON 26
 eC_7                 3.663553e-01 1 1  ON 27
 eC_8                 2.776449e-01 1 1  ON 28
 eC_9                 5.089544e-02 1 1  ON 29
 eO_0                -1.244669e+00 1 1  ON 30
 eO_1                -8.516053e-01 1 1  ON 31
 eO_2                -3.586573e-01 1 1  ON 32
 eO_3                -3.144765e-02 1 1  ON 33
 eO_4                 1.975211e-01 1 1  ON 34
 eO_5                 3.456409e-01 1 1  ON 35
 eO_6                 3.961105e-01 1 1  ON 36
 eO_7                 4.470600e-01 1 1  ON 37
 eO_8                 5.324140e-01 1 1  ON 38
 eO_9                 4.020155e-01 1 1  ON 39
eH1_0                -1.622019e-01 1 1  ON 40
eH1_1                -6.159796e-02 1 1  ON 41
eH1_2                -4.142008e-02 1 1  ON 42
eH1_3                -3.996183e-02 1 1  ON 43
eH1_4                -2.187935e-03 1 1  ON 44
eH1_5                 1.026720e-02 1 1  ON 45
eH1_6                 4.274738e-02 1 1  ON 46
eH1_7                 5.913720e-02 1 1  ON 47
eH1_8                 3.445644e-02 1 1  ON 48
eH1_9                 6.045292e-02 1 1  ON 49
eH2_0                -1.731225e-01 1 1  ON 50
eH2_1                -7.339008e-02 1 1  ON 51
eH2_2                -5.332210e-02 1 1  ON 52
eH2_3                -5.226469e-02 1 1  ON 53
eH2_4                -1.441070e-02 1 1  ON 54
eH2_5                -2.550022e-03 1 1  ON 55
eH2_6                 3.043706e-02 1 1  ON 56
eH2_7                 4.660044e-02 1 1  ON 57
eH2_8                 2.701049e-02 1 1  ON 58
eH2_9                 1.141241e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.5086
    reference variance = 0.713207
====================================================
  Execution time = 4.5546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7189e-01
  Total weights = 2.0000e+06
  Execution time = 3.5796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571598864194
                                         uncertainty =       0.008405614347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571598864194
                                         uncertainty =       0.008405614347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534586309
  error estimate for blocks of size 2^( 2) =       0.000554884463
  error estimate for blocks of size 2^( 3) =       0.000573996350
  error estimate for blocks of size 2^( 4) =       0.000587180194
  error estimate for blocks of size 2^( 5) =       0.000596654216
  error estimate for blocks of size 2^( 6) =       0.000601271168
  error estimate for blocks of size 2^( 7) =       0.000606724276

      target function =                  N/A
              le_mean =     -22.437353947423
             les_mean =     504.006416919168
             stat err =       0.000597957463
             autocorr =       1.251137145063
              std dev =       0.756019208085
             le_variance =       0.571565042993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572267995068
                                         uncertainty =       0.008417025755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572267995068
                                         uncertainty =       0.008417025755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534899156
  error estimate for blocks of size 2^( 2) =       0.000555172122
  error estimate for blocks of size 2^( 3) =       0.000574263175
  error estimate for blocks of size 2^( 4) =       0.000587437324
  error estimate for blocks of size 2^( 5) =       0.000596908199
  error estimate for blocks of size 2^( 6) =       0.000601527224
  error estimate for blocks of size 2^( 7) =       0.000606985455

      target function =                  N/A
              le_mean =     -22.437351215308
             les_mean =     504.006963486225
             stat err =       0.000598214550
             autocorr =       1.250748871481
              std dev =       0.756461640315
             le_variance =       0.572234213268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572252477434
                                         uncertainty =       0.008415818648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572252477434
                                         uncertainty =       0.008415818648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534891895
  error estimate for blocks of size 2^( 2) =       0.000555165628
  error estimate for blocks of size 2^( 3) =       0.000574257573
  error estimate for blocks of size 2^( 4) =       0.000587432263
  error estimate for blocks of size 2^( 5) =       0.000596903761
  error estimate for blocks of size 2^( 6) =       0.000601520508
  error estimate for blocks of size 2^( 7) =       0.000606978553

      target function =                  N/A
              le_mean =     -22.437351196045
             les_mean =     504.006947088047
             stat err =       0.000598208771
             autocorr =       1.250758658121
              std dev =       0.756451372861
             le_variance =       0.572218679503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571707286874
                                         uncertainty =       0.008407271445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571707286874
                                         uncertainty =       0.008407271445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534637011
  error estimate for blocks of size 2^( 2) =       0.000554931031
  error estimate for blocks of size 2^( 3) =       0.000574039589
  error estimate for blocks of size 2^( 4) =       0.000587221945
  error estimate for blocks of size 2^( 5) =       0.000596695571
  error estimate for blocks of size 2^( 6) =       0.000601312265
  error estimate for blocks of size 2^( 7) =       0.000606766194

      target function =                  N/A
              le_mean =     -22.437353361437
             les_mean =     504.006499047017
             stat err =       0.000597998994
             autocorr =       1.251073618602
              std dev =       0.756090911788
             le_variance =       0.571673466888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437353947423        initial  <--
     2.4414e-01     2.4414e+00             7.9609e-04       -22.437351215308
     9.7656e-01     9.7656e+00             1.9296e-04       -22.437351196045
     3.9062e+00     3.9062e+01             5.3623e-05       -22.437353361437

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.4724
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.684270e-01 1 1  ON 0
 uu_1                 9.271173e-02 1 1  ON 1
 uu_2                -2.410000e-02 1 1  ON 2
 uu_3                -9.510750e-02 1 1  ON 3
 uu_4                -1.375634e-01 1 1  ON 4
 uu_5                -1.639892e-01 1 1  ON 5
 uu_6                -1.782654e-01 1 1  ON 6
 uu_7                -1.811346e-01 1 1  ON 7
 uu_8                -1.704325e-01 1 1  ON 8
 uu_9                -1.419611e-01 1 1  ON 9
 ud_0                 4.718798e-01 1 1  ON 10
 ud_1                 1.876859e-01 1 1  ON 11
 ud_2                 3.667363e-02 1 1  ON 12
 ud_3                -4.887751e-02 1 1  ON 13
 ud_4                -1.002551e-01 1 1  ON 14
 ud_5                -1.351721e-01 1 1  ON 15
 ud_6                -1.582000e-01 1 1  ON 16
 ud_7                -1.698018e-01 1 1  ON 17
 ud_8                -1.668903e-01 1 1  ON 18
 ud_9                -1.449909e-01 1 1  ON 19
 eC_0                -6.978393e-01 1 1  ON 20
 eC_1                -5.224767e-01 1 1  ON 21
 eC_2                -2.159549e-01 1 1  ON 22
 eC_3                 7.978357e-03 1 1  ON 23
 eC_4                 1.556586e-01 1 1  ON 24
 eC_5                 2.778082e-01 1 1  ON 25
 eC_6                 2.983990e-01 1 1  ON 26
 eC_7                 3.664826e-01 1 1  ON 27
 eC_8                 2.775550e-01 1 1  ON 28
 eC_9                 5.083677e-02 1 1  ON 29
 eO_0                -1.244562e+00 1 1  ON 30
 eO_1                -8.515807e-01 1 1  ON 31
 eO_2                -3.588301e-01 1 1  ON 32
 eO_3                -3.146619e-02 1 1  ON 33
 eO_4                 1.976115e-01 1 1  ON 34
 eO_5                 3.457533e-01 1 1  ON 35
 eO_6                 3.960267e-01 1 1  ON 36
 eO_7                 4.470468e-01 1 1  ON 37
 eO_8                 5.326070e-01 1 1  ON 38
 eO_9                 4.019002e-01 1 1  ON 39
eH1_0                -1.621641e-01 1 1  ON 40
eH1_1                -6.175793e-02 1 1  ON 41
eH1_2                -4.146643e-02 1 1  ON 42
eH1_3                -3.994115e-02 1 1  ON 43
eH1_4                -2.212016e-03 1 1  ON 44
eH1_5                 1.036252e-02 1 1  ON 45
eH1_6                 4.264309e-02 1 1  ON 46
eH1_7                 5.931602e-02 1 1  ON 47
eH1_8                 3.450773e-02 1 1  ON 48
eH1_9                 6.046034e-02 1 1  ON 49
eH2_0                -1.731489e-01 1 1  ON 50
eH2_1                -7.338922e-02 1 1  ON 51
eH2_2                -5.334101e-02 1 1  ON 52
eH2_3                -5.230402e-02 1 1  ON 53
eH2_4                -1.447834e-02 1 1  ON 54
eH2_5                -2.570306e-03 1 1  ON 55
eH2_6                 3.053767e-02 1 1  ON 56
eH2_7                 4.665955e-02 1 1  ON 57
eH2_8                 2.701230e-02 1 1  ON 58
eH2_9                 1.142082e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2299e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.4966
    reference variance = 0.609999
====================================================
  Execution time = 4.4179e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6673e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5157e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566672712490
                                         uncertainty =       0.004797129736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566672712490
                                         uncertainty =       0.004797129736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532320532
  error estimate for blocks of size 2^( 2) =       0.000552331971
  error estimate for blocks of size 2^( 3) =       0.000570818572
  error estimate for blocks of size 2^( 4) =       0.000584444224
  error estimate for blocks of size 2^( 5) =       0.000592150584
  error estimate for blocks of size 2^( 6) =       0.000595672939
  error estimate for blocks of size 2^( 7) =       0.000597169017

      target function =                  N/A
              le_mean =     -22.437207416650
             les_mean =     503.995006672491
             stat err =       0.000592359191
             autocorr =       1.238294166250
              std dev =       0.752814916207
             le_variance =       0.566730298063


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243720741665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437207416650       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437207478554       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437207508031       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437207347061       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437207189159       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437207220952       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437207154794       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437207141244       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437207162363       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437207110130       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+00 is 7.358584e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437207416650       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437207433512       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437207442498       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437207403708       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437207359746       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437207366487       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437207345519       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437207338833       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437207344060       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437207331782       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 1.860286e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437207416650       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437207420962       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437207423325       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437207413748       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437207402503       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437207404103       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437207398512       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437207396552       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437207397832       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437207394837       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+01 is 4.666913e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.449395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9344e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.684094e-01 1 1  ON 0
 uu_1                 9.271653e-02 1 1  ON 1
 uu_2                -2.409524e-02 1 1  ON 2
 uu_3                -9.510421e-02 1 1  ON 3
 uu_4                -1.375667e-01 1 1  ON 4
 uu_5                -1.639890e-01 1 1  ON 5
 uu_6                -1.782640e-01 1 1  ON 6
 uu_7                -1.811258e-01 1 1  ON 7
 uu_8                -1.704283e-01 1 1  ON 8
 uu_9                -1.419551e-01 1 1  ON 9
 ud_0                 4.718885e-01 1 1  ON 10
 ud_1                 1.876837e-01 1 1  ON 11
 ud_2                 3.667142e-02 1 1  ON 12
 ud_3                -4.887187e-02 1 1  ON 13
 ud_4                -1.002429e-01 1 1  ON 14
 ud_5                -1.351715e-01 1 1  ON 15
 ud_6                -1.581985e-01 1 1  ON 16
 ud_7                -1.697943e-01 1 1  ON 17
 ud_8                -1.668884e-01 1 1  ON 18
 ud_9                -1.449903e-01 1 1  ON 19
 eC_0                -6.978263e-01 1 1  ON 20
 eC_1                -5.224749e-01 1 1  ON 21
 eC_2                -2.159579e-01 1 1  ON 22
 eC_3                 7.981046e-03 1 1  ON 23
 eC_4                 1.556635e-01 1 1  ON 24
 eC_5                 2.778039e-01 1 1  ON 25
 eC_6                 2.983890e-01 1 1  ON 26
 eC_7                 3.664671e-01 1 1  ON 27
 eC_8                 2.775606e-01 1 1  ON 28
 eC_9                 5.084112e-02 1 1  ON 29
 eO_0                -1.244563e+00 1 1  ON 30
 eO_1                -8.515780e-01 1 1  ON 31
 eO_2                -3.588307e-01 1 1  ON 32
 eO_3                -3.147479e-02 1 1  ON 33
 eO_4                 1.976081e-01 1 1  ON 34
 eO_5                 3.457614e-01 1 1  ON 35
 eO_6                 3.960276e-01 1 1  ON 36
 eO_7                 4.470463e-01 1 1  ON 37
 eO_8                 5.325887e-01 1 1  ON 38
 eO_9                 4.019106e-01 1 1  ON 39
eH1_0                -1.621455e-01 1 1  ON 40
eH1_1                -6.174822e-02 1 1  ON 41
eH1_2                -4.147911e-02 1 1  ON 42
eH1_3                -3.992933e-02 1 1  ON 43
eH1_4                -2.216729e-03 1 1  ON 44
eH1_5                 1.035056e-02 1 1  ON 45
eH1_6                 4.264232e-02 1 1  ON 46
eH1_7                 5.930094e-02 1 1  ON 47
eH1_8                 3.451139e-02 1 1  ON 48
eH1_9                 6.045746e-02 1 1  ON 49
eH2_0                -1.731473e-01 1 1  ON 50
eH2_1                -7.339019e-02 1 1  ON 51
eH2_2                -5.333471e-02 1 1  ON 52
eH2_3                -5.230233e-02 1 1  ON 53
eH2_4                -1.446103e-02 1 1  ON 54
eH2_5                -2.562527e-03 1 1  ON 55
eH2_6                 3.053738e-02 1 1  ON 56
eH2_7                 4.664095e-02 1 1  ON 57
eH2_8                 2.700306e-02 1 1  ON 58
eH2_9                 1.141974e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.4973
    reference variance = 0.560968
====================================================
  Execution time = 4.3755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5798e-01
  Total weights = 2.0000e+06
  Execution time = 3.5926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557894016014
                                         uncertainty =       0.003824028121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557894016014
                                         uncertainty =       0.003824028121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528193908
  error estimate for blocks of size 2^( 2) =       0.000548700530
  error estimate for blocks of size 2^( 3) =       0.000566682815
  error estimate for blocks of size 2^( 4) =       0.000579733545
  error estimate for blocks of size 2^( 5) =       0.000588391600
  error estimate for blocks of size 2^( 6) =       0.000590865440
  error estimate for blocks of size 2^( 7) =       0.000591368762

      target function =                  N/A
              le_mean =     -22.437177383265
             les_mean =     503.984906259052
             stat err =       0.000587589837
             autocorr =       1.237547207367
              std dev =       0.746978988951
             le_variance =       0.557977609935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557910041259
                                         uncertainty =       0.003824297539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557910041259
                                         uncertainty =       0.003824297539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528201500
  error estimate for blocks of size 2^( 2) =       0.000548706975
  error estimate for blocks of size 2^( 3) =       0.000566688903
  error estimate for blocks of size 2^( 4) =       0.000579739455
  error estimate for blocks of size 2^( 5) =       0.000588397137
  error estimate for blocks of size 2^( 6) =       0.000590870966
  error estimate for blocks of size 2^( 7) =       0.000591372703

      target function =                  N/A
              le_mean =     -22.437177184305
             les_mean =     503.984913370625
             stat err =       0.000587595065
             autocorr =       1.237533655812
              std dev =       0.746989725326
             le_variance =       0.557993649743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557905560788
                                         uncertainty =       0.003824197300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557905560788
                                         uncertainty =       0.003824197300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528199377
  error estimate for blocks of size 2^( 2) =       0.000548705284
  error estimate for blocks of size 2^( 3) =       0.000566687281
  error estimate for blocks of size 2^( 4) =       0.000579737861
  error estimate for blocks of size 2^( 5) =       0.000588395720
  error estimate for blocks of size 2^( 6) =       0.000590869501
  error estimate for blocks of size 2^( 7) =       0.000591371941

      target function =                  N/A
              le_mean =     -22.437177253942
             les_mean =     503.984912008927
             stat err =       0.000587593756
             autocorr =       1.237538090685
              std dev =       0.746986722167
             le_variance =       0.557989163094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557895588090
                                         uncertainty =       0.003824050565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557895588090
                                         uncertainty =       0.003824050565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528194653
  error estimate for blocks of size 2^( 2) =       0.000548701180
  error estimate for blocks of size 2^( 3) =       0.000566683424
  error estimate for blocks of size 2^( 4) =       0.000579734133
  error estimate for blocks of size 2^( 5) =       0.000588392164
  error estimate for blocks of size 2^( 6) =       0.000590865994
  error estimate for blocks of size 2^( 7) =       0.000591369202

      target function =                  N/A
              le_mean =     -22.437177365244
             les_mean =     503.984907023504
             stat err =       0.000587590373
             autocorr =       1.237545977516
              std dev =       0.746980041966
             le_variance =       0.557979183096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437177383265        initial  <--
     2.4414e+00     2.4414e+01             7.3586e-05       -22.437177184305
     9.7656e+00     9.7656e+01             1.8603e-05       -22.437177253942
     3.9062e+01     3.9062e+02             4.6669e-06       -22.437177365244

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.7131
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.684270e-01 1 1  ON 0
 uu_1                 9.271173e-02 1 1  ON 1
 uu_2                -2.410000e-02 1 1  ON 2
 uu_3                -9.510750e-02 1 1  ON 3
 uu_4                -1.375634e-01 1 1  ON 4
 uu_5                -1.639892e-01 1 1  ON 5
 uu_6                -1.782654e-01 1 1  ON 6
 uu_7                -1.811346e-01 1 1  ON 7
 uu_8                -1.704325e-01 1 1  ON 8
 uu_9                -1.419611e-01 1 1  ON 9
 ud_0                 4.718798e-01 1 1  ON 10
 ud_1                 1.876859e-01 1 1  ON 11
 ud_2                 3.667363e-02 1 1  ON 12
 ud_3                -4.887751e-02 1 1  ON 13
 ud_4                -1.002551e-01 1 1  ON 14
 ud_5                -1.351721e-01 1 1  ON 15
 ud_6                -1.582000e-01 1 1  ON 16
 ud_7                -1.698018e-01 1 1  ON 17
 ud_8                -1.668903e-01 1 1  ON 18
 ud_9                -1.449909e-01 1 1  ON 19
 eC_0                -6.978393e-01 1 1  ON 20
 eC_1                -5.224767e-01 1 1  ON 21
 eC_2                -2.159549e-01 1 1  ON 22
 eC_3                 7.978357e-03 1 1  ON 23
 eC_4                 1.556586e-01 1 1  ON 24
 eC_5                 2.778082e-01 1 1  ON 25
 eC_6                 2.983990e-01 1 1  ON 26
 eC_7                 3.664826e-01 1 1  ON 27
 eC_8                 2.775550e-01 1 1  ON 28
 eC_9                 5.083677e-02 1 1  ON 29
 eO_0                -1.244562e+00 1 1  ON 30
 eO_1                -8.515807e-01 1 1  ON 31
 eO_2                -3.588301e-01 1 1  ON 32
 eO_3                -3.146619e-02 1 1  ON 33
 eO_4                 1.976115e-01 1 1  ON 34
 eO_5                 3.457533e-01 1 1  ON 35
 eO_6                 3.960267e-01 1 1  ON 36
 eO_7                 4.470468e-01 1 1  ON 37
 eO_8                 5.326070e-01 1 1  ON 38
 eO_9                 4.019002e-01 1 1  ON 39
eH1_0                -1.621641e-01 1 1  ON 40
eH1_1                -6.175793e-02 1 1  ON 41
eH1_2                -4.146643e-02 1 1  ON 42
eH1_3                -3.994115e-02 1 1  ON 43
eH1_4                -2.212016e-03 1 1  ON 44
eH1_5                 1.036252e-02 1 1  ON 45
eH1_6                 4.264309e-02 1 1  ON 46
eH1_7                 5.931602e-02 1 1  ON 47
eH1_8                 3.450773e-02 1 1  ON 48
eH1_9                 6.046034e-02 1 1  ON 49
eH2_0                -1.731489e-01 1 1  ON 50
eH2_1                -7.338922e-02 1 1  ON 51
eH2_2                -5.334101e-02 1 1  ON 52
eH2_3                -5.230402e-02 1 1  ON 53
eH2_4                -1.447834e-02 1 1  ON 54
eH2_5                -2.570306e-03 1 1  ON 55
eH2_6                 3.053767e-02 1 1  ON 56
eH2_7                 4.665955e-02 1 1  ON 57
eH2_8                 2.701230e-02 1 1  ON 58
eH2_9                 1.142082e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2107e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2446e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.3982
    reference variance = 0.527016
====================================================
  Execution time = 4.4182e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5985e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4784e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559826610423
                                         uncertainty =       0.003370225600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559826610423
                                         uncertainty =       0.003370225600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529079237
  error estimate for blocks of size 2^( 2) =       0.000549292049
  error estimate for blocks of size 2^( 3) =       0.000567392136
  error estimate for blocks of size 2^( 4) =       0.000581291842
  error estimate for blocks of size 2^( 5) =       0.000589597040
  error estimate for blocks of size 2^( 6) =       0.000594400282
  error estimate for blocks of size 2^( 7) =       0.000600825598

      target function =                  N/A
              le_mean =     -22.436524126585
             les_mean =     503.957464281619
             stat err =       0.000591528691
             autocorr =       1.250000509183
              std dev =       0.748231032982
             le_variance =       0.559849678718


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243652412658e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436524126585       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436524148680       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436524153512       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436524203904       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436524210906       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436524223995       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436524217087       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436524221035       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436524221786       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436524219222       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+01 is 9.261948e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436524126585       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436524132142       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436524133358       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436524146140       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436524147930       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436524151200       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436524149533       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436524150459       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436524150694       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436524150048       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 2.326390e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436524126585       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436524127976       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436524128281       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436524131488       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436524131938       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436524132756       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436524132342       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436524132570       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436524132631       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436524132470       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+02 is 5.822873e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.453106 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8974e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.684270e-01 1 1  ON 0
 uu_1                 9.271115e-02 1 1  ON 1
 uu_2                -2.409893e-02 1 1  ON 2
 uu_3                -9.510748e-02 1 1  ON 3
 uu_4                -1.375632e-01 1 1  ON 4
 uu_5                -1.639889e-01 1 1  ON 5
 uu_6                -1.782664e-01 1 1  ON 6
 uu_7                -1.811349e-01 1 1  ON 7
 uu_8                -1.704323e-01 1 1  ON 8
 uu_9                -1.419595e-01 1 1  ON 9
 ud_0                 4.718818e-01 1 1  ON 10
 ud_1                 1.876852e-01 1 1  ON 11
 ud_2                 3.667336e-02 1 1  ON 12
 ud_3                -4.887748e-02 1 1  ON 13
 ud_4                -1.002558e-01 1 1  ON 14
 ud_5                -1.351715e-01 1 1  ON 15
 ud_6                -1.582003e-01 1 1  ON 16
 ud_7                -1.698015e-01 1 1  ON 17
 ud_8                -1.668894e-01 1 1  ON 18
 ud_9                -1.449898e-01 1 1  ON 19
 eC_0                -6.978385e-01 1 1  ON 20
 eC_1                -5.224770e-01 1 1  ON 21
 eC_2                -2.159554e-01 1 1  ON 22
 eC_3                 7.978235e-03 1 1  ON 23
 eC_4                 1.556588e-01 1 1  ON 24
 eC_5                 2.778078e-01 1 1  ON 25
 eC_6                 2.983987e-01 1 1  ON 26
 eC_7                 3.664816e-01 1 1  ON 27
 eC_8                 2.775560e-01 1 1  ON 28
 eC_9                 5.083739e-02 1 1  ON 29
 eO_0                -1.244562e+00 1 1  ON 30
 eO_1                -8.515795e-01 1 1  ON 31
 eO_2                -3.588307e-01 1 1  ON 32
 eO_3                -3.146651e-02 1 1  ON 33
 eO_4                 1.976117e-01 1 1  ON 34
 eO_5                 3.457538e-01 1 1  ON 35
 eO_6                 3.960260e-01 1 1  ON 36
 eO_7                 4.470460e-01 1 1  ON 37
 eO_8                 5.326051e-01 1 1  ON 38
 eO_9                 4.019015e-01 1 1  ON 39
eH1_0                -1.621642e-01 1 1  ON 40
eH1_1                -6.175816e-02 1 1  ON 41
eH1_2                -4.146713e-02 1 1  ON 42
eH1_3                -3.994155e-02 1 1  ON 43
eH1_4                -2.210919e-03 1 1  ON 44
eH1_5                 1.036048e-02 1 1  ON 45
eH1_6                 4.264541e-02 1 1  ON 46
eH1_7                 5.931465e-02 1 1  ON 47
eH1_8                 3.450807e-02 1 1  ON 48
eH1_9                 6.046069e-02 1 1  ON 49
eH2_0                -1.731487e-01 1 1  ON 50
eH2_1                -7.338872e-02 1 1  ON 51
eH2_2                -5.334071e-02 1 1  ON 52
eH2_3                -5.230452e-02 1 1  ON 53
eH2_4                -1.447756e-02 1 1  ON 54
eH2_5                -2.571654e-03 1 1  ON 55
eH2_6                 3.053791e-02 1 1  ON 56
eH2_7                 4.665936e-02 1 1  ON 57
eH2_8                 2.701255e-02 1 1  ON 58
eH2_9                 1.142072e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.4614
    reference variance = 0.388508
====================================================
  Execution time = 4.3711e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6714e-01
  Total weights = 2.0000e+06
  Execution time = 3.5793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567161854237
                                         uncertainty =       0.006263338939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567161854237
                                         uncertainty =       0.006263338939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532512782
  error estimate for blocks of size 2^( 2) =       0.000552804124
  error estimate for blocks of size 2^( 3) =       0.000570996812
  error estimate for blocks of size 2^( 4) =       0.000584187346
  error estimate for blocks of size 2^( 5) =       0.000591211880
  error estimate for blocks of size 2^( 6) =       0.000595065133
  error estimate for blocks of size 2^( 7) =       0.000597024394

      target function =                  N/A
              le_mean =     -22.437323600866
             les_mean =     504.000629812524
             stat err =       0.000591872188
             autocorr =       1.235366422489
              std dev =       0.753086798528
             le_variance =       0.567139726117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567170849145
                                         uncertainty =       0.006263419511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567170849145
                                         uncertainty =       0.006263419511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532517003
  error estimate for blocks of size 2^( 2) =       0.000552808095
  error estimate for blocks of size 2^( 3) =       0.000571000540
  error estimate for blocks of size 2^( 4) =       0.000584190965
  error estimate for blocks of size 2^( 5) =       0.000591215524
  error estimate for blocks of size 2^( 6) =       0.000595068676
  error estimate for blocks of size 2^( 7) =       0.000597028297

      target function =                  N/A
              le_mean =     -22.437323701025
             les_mean =     504.000643298147
             stat err =       0.000591875865
             autocorr =       1.235362188135
              std dev =       0.753092767965
             le_variance =       0.567148717161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567166429706
                                         uncertainty =       0.006263380366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567166429706
                                         uncertainty =       0.006263380366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532514929
  error estimate for blocks of size 2^( 2) =       0.000552806144
  error estimate for blocks of size 2^( 3) =       0.000570998708
  error estimate for blocks of size 2^( 4) =       0.000584189188
  error estimate for blocks of size 2^( 5) =       0.000591213734
  error estimate for blocks of size 2^( 6) =       0.000595066937
  error estimate for blocks of size 2^( 7) =       0.000597026379

      target function =                  N/A
              le_mean =     -22.437323651614
             les_mean =     504.000636663349
             stat err =       0.000591874060
             autocorr =       1.235364271737
              std dev =       0.753089835035
             le_variance =       0.567144299634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567162428563
                                         uncertainty =       0.006263344154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567162428563
                                         uncertainty =       0.006263344154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532513052
  error estimate for blocks of size 2^( 2) =       0.000552804378
  error estimate for blocks of size 2^( 3) =       0.000570997050
  error estimate for blocks of size 2^( 4) =       0.000584187577
  error estimate for blocks of size 2^( 5) =       0.000591212113
  error estimate for blocks of size 2^( 6) =       0.000595065360
  error estimate for blocks of size 2^( 7) =       0.000597024643

      target function =                  N/A
              le_mean =     -22.437323607222
             les_mean =     504.000630671817
             stat err =       0.000591872423
             autocorr =       1.235366152582
              std dev =       0.753087179680
             le_variance =       0.567140300198


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437323600866        initial
     2.4414e+01     2.4414e+02             9.2619e-06       -22.437323701025  <--
     9.7656e+01     9.7656e+02             2.3264e-06       -22.437323651614
     3.9062e+02     3.9062e+03             5.8229e-07       -22.437323607222

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 6.5121e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.684270e-01 1 1  ON 0
 uu_1                 9.270945e-02 1 1  ON 1
 uu_2                -2.409578e-02 1 1  ON 2
 uu_3                -9.510739e-02 1 1  ON 3
 uu_4                -1.375626e-01 1 1  ON 4
 uu_5                -1.639881e-01 1 1  ON 5
 uu_6                -1.782691e-01 1 1  ON 6
 uu_7                -1.811357e-01 1 1  ON 7
 uu_8                -1.704317e-01 1 1  ON 8
 uu_9                -1.419548e-01 1 1  ON 9
 ud_0                 4.718876e-01 1 1  ON 10
 ud_1                 1.876832e-01 1 1  ON 11
 ud_2                 3.667258e-02 1 1  ON 12
 ud_3                -4.887740e-02 1 1  ON 13
 ud_4                -1.002578e-01 1 1  ON 14
 ud_5                -1.351697e-01 1 1  ON 15
 ud_6                -1.582011e-01 1 1  ON 16
 ud_7                -1.698006e-01 1 1  ON 17
 ud_8                -1.668866e-01 1 1  ON 18
 ud_9                -1.449865e-01 1 1  ON 19
 eC_0                -6.978360e-01 1 1  ON 20
 eC_1                -5.224779e-01 1 1  ON 21
 eC_2                -2.159568e-01 1 1  ON 22
 eC_3                 7.977894e-03 1 1  ON 23
 eC_4                 1.556595e-01 1 1  ON 24
 eC_5                 2.778065e-01 1 1  ON 25
 eC_6                 2.983975e-01 1 1  ON 26
 eC_7                 3.664785e-01 1 1  ON 27
 eC_8                 2.775593e-01 1 1  ON 28
 eC_9                 5.083925e-02 1 1  ON 29
 eO_0                -1.244562e+00 1 1  ON 30
 eO_1                -8.515758e-01 1 1  ON 31
 eO_2                -3.588326e-01 1 1  ON 32
 eO_3                -3.146748e-02 1 1  ON 33
 eO_4                 1.976124e-01 1 1  ON 34
 eO_5                 3.457556e-01 1 1  ON 35
 eO_6                 3.960239e-01 1 1  ON 36
 eO_7                 4.470436e-01 1 1  ON 37
 eO_8                 5.325994e-01 1 1  ON 38
 eO_9                 4.019052e-01 1 1  ON 39
eH1_0                -1.621644e-01 1 1  ON 40
eH1_1                -6.175884e-02 1 1  ON 41
eH1_2                -4.146922e-02 1 1  ON 42
eH1_3                -3.994274e-02 1 1  ON 43
eH1_4                -2.207676e-03 1 1  ON 44
eH1_5                 1.035439e-02 1 1  ON 45
eH1_6                 4.265235e-02 1 1  ON 46
eH1_7                 5.931053e-02 1 1  ON 47
eH1_8                 3.450907e-02 1 1  ON 48
eH1_9                 6.046175e-02 1 1  ON 49
eH2_0                -1.731481e-01 1 1  ON 50
eH2_1                -7.338723e-02 1 1  ON 51
eH2_2                -5.333983e-02 1 1  ON 52
eH2_3                -5.230603e-02 1 1  ON 53
eH2_4                -1.447525e-02 1 1  ON 54
eH2_5                -2.575661e-03 1 1  ON 55
eH2_6                 3.053863e-02 1 1  ON 56
eH2_7                 4.665877e-02 1 1  ON 57
eH2_8                 2.701332e-02 1 1  ON 58
eH2_9                 1.142042e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2410e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2445e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.3915
    reference variance = 0.417111
====================================================
  Execution time = 4.4421e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6564e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4951e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565768584941
                                         uncertainty =       0.005863503999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565768584941
                                         uncertainty =       0.005863503999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531806322
  error estimate for blocks of size 2^( 2) =       0.000551713685
  error estimate for blocks of size 2^( 3) =       0.000569532405
  error estimate for blocks of size 2^( 4) =       0.000583570302
  error estimate for blocks of size 2^( 5) =       0.000593223546
  error estimate for blocks of size 2^( 6) =       0.000597350183
  error estimate for blocks of size 2^( 7) =       0.000598832932

      target function =                  N/A
              le_mean =     -22.437423838781
             les_mean =     504.003624167424
             stat err =       0.000593244241
             autocorr =       1.244400191414
              std dev =       0.752087713724
             le_variance =       0.565635929135


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243742383878e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437423838781       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437423968773       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437424067975       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437424106418       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437424127433       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437424259332       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437424341404       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437424409072       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437424384642       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437424373243       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+00 is 4.982339e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437423838781       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437423871886       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437423898018       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437423908319       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437423913434       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437423947672       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437423969520       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437423987165       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437423981261       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437423978700       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+01 is 1.298849e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437423838781       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437423847096       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437423853717       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437423856339       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437423857611       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437423866253       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437423871801       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437423876267       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437423874811       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437423874190       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 3.282360e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.456795 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9379e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.684160e-01 1 1  ON 0
 uu_1                 9.271167e-02 1 1  ON 1
 uu_2                -2.409672e-02 1 1  ON 2
 uu_3                -9.510712e-02 1 1  ON 3
 uu_4                -1.375627e-01 1 1  ON 4
 uu_5                -1.639858e-01 1 1  ON 5
 uu_6                -1.782698e-01 1 1  ON 6
 uu_7                -1.811364e-01 1 1  ON 7
 uu_8                -1.704260e-01 1 1  ON 8
 uu_9                -1.419478e-01 1 1  ON 9
 ud_0                 4.718935e-01 1 1  ON 10
 ud_1                 1.876808e-01 1 1  ON 11
 ud_2                 3.667343e-02 1 1  ON 12
 ud_3                -4.887762e-02 1 1  ON 13
 ud_4                -1.002562e-01 1 1  ON 14
 ud_5                -1.351700e-01 1 1  ON 15
 ud_6                -1.582011e-01 1 1  ON 16
 ud_7                -1.698016e-01 1 1  ON 17
 ud_8                -1.668837e-01 1 1  ON 18
 ud_9                -1.449849e-01 1 1  ON 19
 eC_0                -6.978314e-01 1 1  ON 20
 eC_1                -5.224795e-01 1 1  ON 21
 eC_2                -2.159546e-01 1 1  ON 22
 eC_3                 7.977387e-03 1 1  ON 23
 eC_4                 1.556564e-01 1 1  ON 24
 eC_5                 2.778033e-01 1 1  ON 25
 eC_6                 2.983974e-01 1 1  ON 26
 eC_7                 3.664749e-01 1 1  ON 27
 eC_8                 2.775623e-01 1 1  ON 28
 eC_9                 5.084126e-02 1 1  ON 29
 eO_0                -1.244575e+00 1 1  ON 30
 eO_1                -8.515655e-01 1 1  ON 31
 eO_2                -3.588286e-01 1 1  ON 32
 eO_3                -3.146499e-02 1 1  ON 33
 eO_4                 1.976029e-01 1 1  ON 34
 eO_5                 3.457529e-01 1 1  ON 35
 eO_6                 3.960296e-01 1 1  ON 36
 eO_7                 4.470440e-01 1 1  ON 37
 eO_8                 5.325918e-01 1 1  ON 38
 eO_9                 4.019103e-01 1 1  ON 39
eH1_0                -1.621610e-01 1 1  ON 40
eH1_1                -6.175442e-02 1 1  ON 41
eH1_2                -4.146977e-02 1 1  ON 42
eH1_3                -3.994359e-02 1 1  ON 43
eH1_4                -2.207786e-03 1 1  ON 44
eH1_5                 1.035154e-02 1 1  ON 45
eH1_6                 4.265487e-02 1 1  ON 46
eH1_7                 5.930048e-02 1 1  ON 47
eH1_8                 3.451096e-02 1 1  ON 48
eH1_9                 6.046191e-02 1 1  ON 49
eH2_0                -1.731496e-01 1 1  ON 50
eH2_1                -7.338380e-02 1 1  ON 51
eH2_2                -5.334064e-02 1 1  ON 52
eH2_3                -5.230341e-02 1 1  ON 53
eH2_4                -1.447698e-02 1 1  ON 54
eH2_5                -2.569715e-03 1 1  ON 55
eH2_6                 3.053320e-02 1 1  ON 56
eH2_7                 4.665444e-02 1 1  ON 57
eH2_8                 2.701676e-02 1 1  ON 58
eH2_9                 1.142000e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.4007
    reference variance = 0.836887
====================================================
  Execution time = 4.3741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6853e-01
  Total weights = 2.0000e+06
  Execution time = 3.6023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568596949936
                                         uncertainty =       0.005629407320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568596949936
                                         uncertainty =       0.005629407320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533161700
  error estimate for blocks of size 2^( 2) =       0.000552985668
  error estimate for blocks of size 2^( 3) =       0.000571041834
  error estimate for blocks of size 2^( 4) =       0.000583518302
  error estimate for blocks of size 2^( 5) =       0.000592073621
  error estimate for blocks of size 2^( 6) =       0.000594718502
  error estimate for blocks of size 2^( 7) =       0.000597128824

      target function =                  N/A
              le_mean =     -22.436773963477
             les_mean =     503.977348400484
             stat err =       0.000591859812
             autocorr =       1.232309555954
              std dev =       0.754004506993
             le_variance =       0.568522796566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568622626194
                                         uncertainty =       0.005630098463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568622626194
                                         uncertainty =       0.005630098463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533173737
  error estimate for blocks of size 2^( 2) =       0.000552996748
  error estimate for blocks of size 2^( 3) =       0.000571052226
  error estimate for blocks of size 2^( 4) =       0.000583527521
  error estimate for blocks of size 2^( 5) =       0.000592082519
  error estimate for blocks of size 2^( 6) =       0.000594726699
  error estimate for blocks of size 2^( 7) =       0.000597138612

      target function =                  N/A
              le_mean =     -22.436774064451
             les_mean =     503.977378603485
             stat err =       0.000591868838
             autocorr =       1.232291494107
              std dev =       0.754021530559
             le_variance =       0.568548468546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568610495381
                                         uncertainty =       0.005629777290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568610495381
                                         uncertainty =       0.005629777290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533168050
  error estimate for blocks of size 2^( 2) =       0.000552991516
  error estimate for blocks of size 2^( 3) =       0.000571047324
  error estimate for blocks of size 2^( 4) =       0.000583523179
  error estimate for blocks of size 2^( 5) =       0.000592078331
  error estimate for blocks of size 2^( 6) =       0.000594722843
  error estimate for blocks of size 2^( 7) =       0.000597134004

      target function =                  N/A
              le_mean =     -22.436774015078
             les_mean =     503.977364259107
             stat err =       0.000591864589
             autocorr =       1.232300092489
              std dev =       0.754013487742
             le_variance =       0.568536339697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568598665206
                                         uncertainty =       0.005629454388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568598665206
                                         uncertainty =       0.005629454388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533162504
  error estimate for blocks of size 2^( 2) =       0.000552986408
  error estimate for blocks of size 2^( 3) =       0.000571042529
  error estimate for blocks of size 2^( 4) =       0.000583518920
  error estimate for blocks of size 2^( 5) =       0.000592074218
  error estimate for blocks of size 2^( 6) =       0.000594719052
  error estimate for blocks of size 2^( 7) =       0.000597129481

      target function =                  N/A
              le_mean =     -22.436773969778
             les_mean =     503.977350398200
             stat err =       0.000591860418
             autocorr =       1.232308358739
              std dev =       0.754005644237
             le_variance =       0.568524511541


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436773963477        initial
     6.1035e+00     6.1035e+01             4.9823e-05       -22.436774064451  <--
     2.4414e+01     2.4414e+02             1.2988e-05       -22.436774015078
     9.7656e+01     9.7656e+02             3.2824e-06       -22.436773969778

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 6.1811e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271760e-02 1 1  ON 1
 uu_2                -2.409964e-02 1 1  ON 2
 uu_3                -9.510676e-02 1 1  ON 3
 uu_4                -1.375631e-01 1 1  ON 4
 uu_5                -1.639796e-01 1 1  ON 5
 uu_6                -1.782716e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719098e-01 1 1  ON 10
 ud_1                 1.876747e-01 1 1  ON 11
 ud_2                 3.667579e-02 1 1  ON 12
 ud_3                -4.887799e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351708e-01 1 1  ON 15
 ud_6                -1.582015e-01 1 1  ON 16
 ud_7                -1.698046e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449802e-01 1 1  ON 19
 eC_0                -6.978179e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975828e-03 1 1  ON 23
 eC_4                 1.556476e-01 1 1  ON 24
 eC_5                 2.777939e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664643e-01 1 1  ON 27
 eC_8                 2.775714e-01 1 1  ON 28
 eC_9                 5.084722e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515368e-01 1 1  ON 31
 eO_2                -3.588167e-01 1 1  ON 32
 eO_3                -3.145788e-02 1 1  ON 33
 eO_4                 1.975750e-01 1 1  ON 34
 eO_5                 3.457449e-01 1 1  ON 35
 eO_6                 3.960465e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325694e-01 1 1  ON 38
 eO_9                 4.019254e-01 1 1  ON 39
eH1_0                -1.621507e-01 1 1  ON 40
eH1_1                -6.174150e-02 1 1  ON 41
eH1_2                -4.147131e-02 1 1  ON 42
eH1_3                -3.994628e-02 1 1  ON 43
eH1_4                -2.207996e-03 1 1  ON 44
eH1_5                 1.034327e-02 1 1  ON 45
eH1_6                 4.266229e-02 1 1  ON 46
eH1_7                 5.927068e-02 1 1  ON 47
eH1_8                 3.451649e-02 1 1  ON 48
eH1_9                 6.046238e-02 1 1  ON 49
eH2_0                -1.731538e-01 1 1  ON 50
eH2_1                -7.337365e-02 1 1  ON 51
eH2_2                -5.334279e-02 1 1  ON 52
eH2_3                -5.229609e-02 1 1  ON 53
eH2_4                -1.448158e-02 1 1  ON 54
eH2_5                -2.552642e-03 1 1  ON 55
eH2_6                 3.051757e-02 1 1  ON 56
eH2_7                 4.664143e-02 1 1  ON 57
eH2_8                 2.702687e-02 1 1  ON 58
eH2_9                 1.141873e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2120e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.4942
    reference variance = 0.418905
====================================================
  Execution time = 4.4028e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5581e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4875e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555656176924
                                         uncertainty =       0.003042997420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555656176924
                                         uncertainty =       0.003042997420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527168280
  error estimate for blocks of size 2^( 2) =       0.000547009090
  error estimate for blocks of size 2^( 3) =       0.000565695996
  error estimate for blocks of size 2^( 4) =       0.000579607255
  error estimate for blocks of size 2^( 5) =       0.000587946176
  error estimate for blocks of size 2^( 6) =       0.000593911440
  error estimate for blocks of size 2^( 7) =       0.000595021741

      target function =                  N/A
              le_mean =     -22.437098538876
             les_mean =     503.979203355562
             stat err =       0.000589121653
             autocorr =       1.248853312856
              std dev =       0.745528530811
             le_variance =       0.555812790253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243709853888e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437098538876       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437098091304       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437099381562       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437099160161       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437099714687       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437099839490       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437100172669       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437099833122       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437099769619       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437099824372       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437099847760       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+00 is 1.498888e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437098538876       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437098415369       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437098761859       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437098695713       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437098850238       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437098891693       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437098996391       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437098921138       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437098893999       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437098908290       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437098915111       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+00 is 4.796830e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437098538876       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437098507177       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437098595492       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437098578056       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437098617518       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437098628891       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437098656767       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437098638781       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437098631434       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437098634955       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437098636821       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+01 is 1.288947e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.461233 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8912e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.683512e-01 1 1  ON 0
 uu_1                 9.271359e-02 1 1  ON 1
 uu_2                -2.408888e-02 1 1  ON 2
 uu_3                -9.507797e-02 1 1  ON 3
 uu_4                -1.375479e-01 1 1  ON 4
 uu_5                -1.639720e-01 1 1  ON 5
 uu_6                -1.782888e-01 1 1  ON 6
 uu_7                -1.811433e-01 1 1  ON 7
 uu_8                -1.704002e-01 1 1  ON 8
 uu_9                -1.419165e-01 1 1  ON 9
 ud_0                 4.719578e-01 1 1  ON 10
 ud_1                 1.876560e-01 1 1  ON 11
 ud_2                 3.667691e-02 1 1  ON 12
 ud_3                -4.887660e-02 1 1  ON 13
 ud_4                -1.002593e-01 1 1  ON 14
 ud_5                -1.351859e-01 1 1  ON 15
 ud_6                -1.581689e-01 1 1  ON 16
 ud_7                -1.697847e-01 1 1  ON 17
 ud_8                -1.668734e-01 1 1  ON 18
 ud_9                -1.449961e-01 1 1  ON 19
 eC_0                -6.977882e-01 1 1  ON 20
 eC_1                -5.225176e-01 1 1  ON 21
 eC_2                -2.159476e-01 1 1  ON 22
 eC_3                 8.009836e-03 1 1  ON 23
 eC_4                 1.556198e-01 1 1  ON 24
 eC_5                 2.778036e-01 1 1  ON 25
 eC_6                 2.983868e-01 1 1  ON 26
 eC_7                 3.664404e-01 1 1  ON 27
 eC_8                 2.775825e-01 1 1  ON 28
 eC_9                 5.085659e-02 1 1  ON 29
 eO_0                -1.244609e+00 1 1  ON 30
 eO_1                -8.515225e-01 1 1  ON 31
 eO_2                -3.588104e-01 1 1  ON 32
 eO_3                -3.147942e-02 1 1  ON 33
 eO_4                 1.975493e-01 1 1  ON 34
 eO_5                 3.457656e-01 1 1  ON 35
 eO_6                 3.960563e-01 1 1  ON 36
 eO_7                 4.470420e-01 1 1  ON 37
 eO_8                 5.325368e-01 1 1  ON 38
 eO_9                 4.019356e-01 1 1  ON 39
eH1_0                -1.621326e-01 1 1  ON 40
eH1_1                -6.172800e-02 1 1  ON 41
eH1_2                -4.146494e-02 1 1  ON 42
eH1_3                -3.994341e-02 1 1  ON 43
eH1_4                -2.206692e-03 1 1  ON 44
eH1_5                 1.030747e-02 1 1  ON 45
eH1_6                 4.264835e-02 1 1  ON 46
eH1_7                 5.925112e-02 1 1  ON 47
eH1_8                 3.453195e-02 1 1  ON 48
eH1_9                 6.046413e-02 1 1  ON 49
eH2_0                -1.731566e-01 1 1  ON 50
eH2_1                -7.336715e-02 1 1  ON 51
eH2_2                -5.335036e-02 1 1  ON 52
eH2_3                -5.228638e-02 1 1  ON 53
eH2_4                -1.447667e-02 1 1  ON 54
eH2_5                -2.559571e-03 1 1  ON 55
eH2_6                 3.053937e-02 1 1  ON 56
eH2_7                 4.663301e-02 1 1  ON 57
eH2_8                 2.701796e-02 1 1  ON 58
eH2_9                 1.141690e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.4087
    reference variance = 0.229318
====================================================
  Execution time = 4.3560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6259e-01
  Total weights = 2.0000e+06
  Execution time = 3.6199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562632549272
                                         uncertainty =       0.004600421308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562632549272
                                         uncertainty =       0.004600421308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530361272
  error estimate for blocks of size 2^( 2) =       0.000550626911
  error estimate for blocks of size 2^( 3) =       0.000568776325
  error estimate for blocks of size 2^( 4) =       0.000582164729
  error estimate for blocks of size 2^( 5) =       0.000588844441
  error estimate for blocks of size 2^( 6) =       0.000592667647
  error estimate for blocks of size 2^( 7) =       0.000596411531

      target function =                  N/A
              le_mean =     -22.437370851580
             les_mean =     503.998176608570
             stat err =       0.000590022087
             autocorr =       1.237635991572
              std dev =       0.750044104376
             le_variance =       0.562566158510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562693866498
                                         uncertainty =       0.004599955801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562693866498
                                         uncertainty =       0.004599955801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530390199
  error estimate for blocks of size 2^( 2) =       0.000550654447
  error estimate for blocks of size 2^( 3) =       0.000568804175
  error estimate for blocks of size 2^( 4) =       0.000582189591
  error estimate for blocks of size 2^( 5) =       0.000588865661
  error estimate for blocks of size 2^( 6) =       0.000592688980
  error estimate for blocks of size 2^( 7) =       0.000596429168

      target function =                  N/A
              le_mean =     -22.437370568596
             les_mean =     503.998225277672
             stat err =       0.000590043350
             autocorr =       1.237590194430
              std dev =       0.750085012832
             le_variance =       0.562627526475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562681025595
                                         uncertainty =       0.004600195975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562681025595
                                         uncertainty =       0.004600195975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530384139
  error estimate for blocks of size 2^( 2) =       0.000550648661
  error estimate for blocks of size 2^( 3) =       0.000568797997
  error estimate for blocks of size 2^( 4) =       0.000582184491
  error estimate for blocks of size 2^( 5) =       0.000588861860
  error estimate for blocks of size 2^( 6) =       0.000592685296
  error estimate for blocks of size 2^( 7) =       0.000596426937

      target function =                  N/A
              le_mean =     -22.437370577981
             les_mean =     503.998212842139
             stat err =       0.000590039646
             autocorr =       1.237602938390
              std dev =       0.750076442638
             le_variance =       0.562614669800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562639355888
                                         uncertainty =       0.004600393573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562639355888
                                         uncertainty =       0.004600393573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530364483
  error estimate for blocks of size 2^( 2) =       0.000550629962
  error estimate for blocks of size 2^( 3) =       0.000568779355
  error estimate for blocks of size 2^( 4) =       0.000582167502
  error estimate for blocks of size 2^( 5) =       0.000588846898
  error estimate for blocks of size 2^( 6) =       0.000592670142
  error estimate for blocks of size 2^( 7) =       0.000596413729

      target function =                  N/A
              le_mean =     -22.437370805712
             les_mean =     503.998181361666
             stat err =       0.000590024568
             autocorr =       1.237631415192
              std dev =       0.750048645041
             le_variance =       0.562572969927


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437370851580        initial  <--
     1.5259e+00     1.5259e+01             1.4989e-04       -22.437370568596
     6.1035e+00     6.1035e+01             4.7968e-05       -22.437370577981
     2.4414e+01     2.4414e+02             1.2889e-05       -22.437370805712

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.6358
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271760e-02 1 1  ON 1
 uu_2                -2.409964e-02 1 1  ON 2
 uu_3                -9.510676e-02 1 1  ON 3
 uu_4                -1.375631e-01 1 1  ON 4
 uu_5                -1.639796e-01 1 1  ON 5
 uu_6                -1.782716e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719098e-01 1 1  ON 10
 ud_1                 1.876747e-01 1 1  ON 11
 ud_2                 3.667579e-02 1 1  ON 12
 ud_3                -4.887799e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351708e-01 1 1  ON 15
 ud_6                -1.582015e-01 1 1  ON 16
 ud_7                -1.698046e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449802e-01 1 1  ON 19
 eC_0                -6.978179e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975828e-03 1 1  ON 23
 eC_4                 1.556476e-01 1 1  ON 24
 eC_5                 2.777939e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664643e-01 1 1  ON 27
 eC_8                 2.775714e-01 1 1  ON 28
 eC_9                 5.084722e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515368e-01 1 1  ON 31
 eO_2                -3.588167e-01 1 1  ON 32
 eO_3                -3.145788e-02 1 1  ON 33
 eO_4                 1.975750e-01 1 1  ON 34
 eO_5                 3.457449e-01 1 1  ON 35
 eO_6                 3.960465e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325694e-01 1 1  ON 38
 eO_9                 4.019254e-01 1 1  ON 39
eH1_0                -1.621507e-01 1 1  ON 40
eH1_1                -6.174150e-02 1 1  ON 41
eH1_2                -4.147131e-02 1 1  ON 42
eH1_3                -3.994628e-02 1 1  ON 43
eH1_4                -2.207996e-03 1 1  ON 44
eH1_5                 1.034327e-02 1 1  ON 45
eH1_6                 4.266229e-02 1 1  ON 46
eH1_7                 5.927068e-02 1 1  ON 47
eH1_8                 3.451649e-02 1 1  ON 48
eH1_9                 6.046238e-02 1 1  ON 49
eH2_0                -1.731538e-01 1 1  ON 50
eH2_1                -7.337365e-02 1 1  ON 51
eH2_2                -5.334279e-02 1 1  ON 52
eH2_3                -5.229609e-02 1 1  ON 53
eH2_4                -1.448158e-02 1 1  ON 54
eH2_5                -2.552642e-03 1 1  ON 55
eH2_6                 3.051757e-02 1 1  ON 56
eH2_7                 4.664143e-02 1 1  ON 57
eH2_8                 2.702687e-02 1 1  ON 58
eH2_9                 1.141873e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2056e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4693
    reference variance = 0.352674
====================================================
  Execution time = 4.3993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 6.3676e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5451e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.636990373391
                                         uncertainty =       0.061604615257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.636990373391
                                         uncertainty =       0.061604615257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000564252646
  error estimate for blocks of size 2^( 2) =       0.000583215059
  error estimate for blocks of size 2^( 3) =       0.000600724676
  error estimate for blocks of size 2^( 4) =       0.000614397335
  error estimate for blocks of size 2^( 5) =       0.000623040377
  error estimate for blocks of size 2^( 6) =       0.000628227298
  error estimate for blocks of size 2^( 7) =       0.000628722200

      target function =                  N/A
              le_mean =     -22.437552622866
             les_mean =     504.080529481619
             stat err =       0.000623596802
             autocorr =       1.221407411929
              std dev =       0.797973744007
             le_variance =       0.636762096125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243755262287e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437552622866       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437552638520       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437552690475       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437552744743       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437552822547       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437552835646       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437552844648       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437552813031       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437552810226       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437552806869       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+01 is 1.609729e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437552622866       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437552626809       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437552639847       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437552653565       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437552673116       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437552676252       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437552678656       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437552670650       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437552670023       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437552669116       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 4.043482e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437552622866       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437552623853       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437552627116       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437552630555       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437552635449       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437552636224       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437552636835       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437552634827       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437552634674       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437552634444       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 1.012077e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.464936 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9452e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.683824e-01 1 1  ON 0
 uu_1                 9.271921e-02 1 1  ON 1
 uu_2                -2.409767e-02 1 1  ON 2
 uu_3                -9.510602e-02 1 1  ON 3
 uu_4                -1.375621e-01 1 1  ON 4
 uu_5                -1.639804e-01 1 1  ON 5
 uu_6                -1.782719e-01 1 1  ON 6
 uu_7                -1.811416e-01 1 1  ON 7
 uu_8                -1.704067e-01 1 1  ON 8
 uu_9                -1.419256e-01 1 1  ON 9
 ud_0                 4.719137e-01 1 1  ON 10
 ud_1                 1.876722e-01 1 1  ON 11
 ud_2                 3.667499e-02 1 1  ON 12
 ud_3                -4.887919e-02 1 1  ON 13
 ud_4                -1.002532e-01 1 1  ON 14
 ud_5                -1.351722e-01 1 1  ON 15
 ud_6                -1.582005e-01 1 1  ON 16
 ud_7                -1.698006e-01 1 1  ON 17
 ud_8                -1.668713e-01 1 1  ON 18
 ud_9                -1.449803e-01 1 1  ON 19
 eC_0                -6.978182e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159476e-01 1 1  ON 22
 eC_3                 7.978466e-03 1 1  ON 23
 eC_4                 1.556470e-01 1 1  ON 24
 eC_5                 2.777914e-01 1 1  ON 25
 eC_6                 2.983964e-01 1 1  ON 26
 eC_7                 3.664628e-01 1 1  ON 27
 eC_8                 2.775729e-01 1 1  ON 28
 eC_9                 5.084799e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515384e-01 1 1  ON 31
 eO_2                -3.588154e-01 1 1  ON 32
 eO_3                -3.145964e-02 1 1  ON 33
 eO_4                 1.975754e-01 1 1  ON 34
 eO_5                 3.457458e-01 1 1  ON 35
 eO_6                 3.960461e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325672e-01 1 1  ON 38
 eO_9                 4.019269e-01 1 1  ON 39
eH1_0                -1.621495e-01 1 1  ON 40
eH1_1                -6.173976e-02 1 1  ON 41
eH1_2                -4.147423e-02 1 1  ON 42
eH1_3                -3.994598e-02 1 1  ON 43
eH1_4                -2.207483e-03 1 1  ON 44
eH1_5                 1.034186e-02 1 1  ON 45
eH1_6                 4.266279e-02 1 1  ON 46
eH1_7                 5.926818e-02 1 1  ON 47
eH1_8                 3.451752e-02 1 1  ON 48
eH1_9                 6.046314e-02 1 1  ON 49
eH2_0                -1.731541e-01 1 1  ON 50
eH2_1                -7.337146e-02 1 1  ON 51
eH2_2                -5.334209e-02 1 1  ON 52
eH2_3                -5.229404e-02 1 1  ON 53
eH2_4                -1.448183e-02 1 1  ON 54
eH2_5                -2.553741e-03 1 1  ON 55
eH2_6                 3.051595e-02 1 1  ON 56
eH2_7                 4.664008e-02 1 1  ON 57
eH2_8                 2.702694e-02 1 1  ON 58
eH2_9                 1.141859e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4468
    reference variance = 0.697353
====================================================
  Execution time = 4.3309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6895e-01
  Total weights = 2.0000e+06
  Execution time = 3.5993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569010920285
                                         uncertainty =       0.007787403309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569010920285
                                         uncertainty =       0.007787403309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533360792
  error estimate for blocks of size 2^( 2) =       0.000553761340
  error estimate for blocks of size 2^( 3) =       0.000572457289
  error estimate for blocks of size 2^( 4) =       0.000586960317
  error estimate for blocks of size 2^( 5) =       0.000596526509
  error estimate for blocks of size 2^( 6) =       0.000600119931
  error estimate for blocks of size 2^( 7) =       0.000601912527

      target function =                  N/A
              le_mean =     -22.437082189888
             les_mean =     503.991604379455
             stat err =       0.000596379821
             autocorr =       1.250269701753
              std dev =       0.754286065203
             le_variance =       0.568947468159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569026660280
                                         uncertainty =       0.007786699827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569026660280
                                         uncertainty =       0.007786699827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533368164
  error estimate for blocks of size 2^( 2) =       0.000553768383
  error estimate for blocks of size 2^( 3) =       0.000572464035
  error estimate for blocks of size 2^( 4) =       0.000586966621
  error estimate for blocks of size 2^( 5) =       0.000596532456
  error estimate for blocks of size 2^( 6) =       0.000600125910
  error estimate for blocks of size 2^( 7) =       0.000601917924

      target function =                  N/A
              le_mean =     -22.437082137970
             les_mean =     503.991617778233
             stat err =       0.000596385728
             autocorr =       1.250259905128
              std dev =       0.754296491256
             le_variance =       0.568963196721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569019041336
                                         uncertainty =       0.007787050290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569019041336
                                         uncertainty =       0.007787050290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533364595
  error estimate for blocks of size 2^( 2) =       0.000553764974
  error estimate for blocks of size 2^( 3) =       0.000572460770
  error estimate for blocks of size 2^( 4) =       0.000586963573
  error estimate for blocks of size 2^( 5) =       0.000596529584
  error estimate for blocks of size 2^( 6) =       0.000600123021
  error estimate for blocks of size 2^( 7) =       0.000601915319

      target function =                  N/A
              le_mean =     -22.437082162653
             les_mean =     503.991611272495
             stat err =       0.000596382874
             autocorr =       1.250264671359
              std dev =       0.754291444562
             le_variance =       0.568955583339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569011943221
                                         uncertainty =       0.007787359140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569011943221
                                         uncertainty =       0.007787359140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533361271
  error estimate for blocks of size 2^( 2) =       0.000553761797
  error estimate for blocks of size 2^( 3) =       0.000572457727
  error estimate for blocks of size 2^( 4) =       0.000586960727
  error estimate for blocks of size 2^( 5) =       0.000596526896
  error estimate for blocks of size 2^( 6) =       0.000600120320
  error estimate for blocks of size 2^( 7) =       0.000601912879

      target function =                  N/A
              le_mean =     -22.437082186407
             les_mean =     503.991605245475
             stat err =       0.000596380206
             autocorr =       1.250269068711
              std dev =       0.754286742795
             le_variance =       0.568948490357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437082189888        initial  <--
     1.5259e+01     1.5259e+02             1.6097e-05       -22.437082137970
     6.1035e+01     6.1035e+02             4.0435e-06       -22.437082162653
     2.4414e+02     2.4414e+03             1.0121e-06       -22.437082186407

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3413
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271760e-02 1 1  ON 1
 uu_2                -2.409964e-02 1 1  ON 2
 uu_3                -9.510676e-02 1 1  ON 3
 uu_4                -1.375631e-01 1 1  ON 4
 uu_5                -1.639796e-01 1 1  ON 5
 uu_6                -1.782716e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719098e-01 1 1  ON 10
 ud_1                 1.876747e-01 1 1  ON 11
 ud_2                 3.667579e-02 1 1  ON 12
 ud_3                -4.887799e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351708e-01 1 1  ON 15
 ud_6                -1.582015e-01 1 1  ON 16
 ud_7                -1.698046e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449802e-01 1 1  ON 19
 eC_0                -6.978179e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975828e-03 1 1  ON 23
 eC_4                 1.556476e-01 1 1  ON 24
 eC_5                 2.777939e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664643e-01 1 1  ON 27
 eC_8                 2.775714e-01 1 1  ON 28
 eC_9                 5.084722e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515368e-01 1 1  ON 31
 eO_2                -3.588167e-01 1 1  ON 32
 eO_3                -3.145788e-02 1 1  ON 33
 eO_4                 1.975750e-01 1 1  ON 34
 eO_5                 3.457449e-01 1 1  ON 35
 eO_6                 3.960465e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325694e-01 1 1  ON 38
 eO_9                 4.019254e-01 1 1  ON 39
eH1_0                -1.621507e-01 1 1  ON 40
eH1_1                -6.174150e-02 1 1  ON 41
eH1_2                -4.147131e-02 1 1  ON 42
eH1_3                -3.994628e-02 1 1  ON 43
eH1_4                -2.207996e-03 1 1  ON 44
eH1_5                 1.034327e-02 1 1  ON 45
eH1_6                 4.266229e-02 1 1  ON 46
eH1_7                 5.927068e-02 1 1  ON 47
eH1_8                 3.451649e-02 1 1  ON 48
eH1_9                 6.046238e-02 1 1  ON 49
eH2_0                -1.731538e-01 1 1  ON 50
eH2_1                -7.337365e-02 1 1  ON 51
eH2_2                -5.334279e-02 1 1  ON 52
eH2_3                -5.229609e-02 1 1  ON 53
eH2_4                -1.448158e-02 1 1  ON 54
eH2_5                -2.552642e-03 1 1  ON 55
eH2_6                 3.051757e-02 1 1  ON 56
eH2_7                 4.664143e-02 1 1  ON 57
eH2_8                 2.702687e-02 1 1  ON 58
eH2_9                 1.141873e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2081e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2443e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.4169
    reference variance = 0.579488
====================================================
  Execution time = 4.4223e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6763e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4867e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567578419588
                                         uncertainty =       0.005590598598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567578419588
                                         uncertainty =       0.005590598598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532742785
  error estimate for blocks of size 2^( 2) =       0.000552464168
  error estimate for blocks of size 2^( 3) =       0.000571218515
  error estimate for blocks of size 2^( 4) =       0.000585183304
  error estimate for blocks of size 2^( 5) =       0.000594559499
  error estimate for blocks of size 2^( 6) =       0.000598961523
  error estimate for blocks of size 2^( 7) =       0.000603406869

      target function =                  N/A
              le_mean =     -22.437026982439
             les_mean =     503.987809277634
             stat err =       0.000595527799
             autocorr =       1.249593977848
              std dev =       0.753412072329
             le_variance =       0.567629750731


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243702698244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437026982439       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437026984091       residual = 9.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437026982284       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437026978650       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437026981013       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437026985118       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437026986713       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437026985172       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437026985087       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437026985027       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.443806e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437026982439       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437026982853       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437026982400       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437026981487       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437026982077       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437026983103       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437026983505       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437026983121       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437026983100       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437026983084       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 3.611860e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437026982439       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437026982543       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437026982430       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437026982201       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437026982349       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437026982603       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437026982709       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437026982611       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437026982611       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437026982599       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+03 is 9.031119e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.468660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9098e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271774e-02 1 1  ON 1
 uu_2                -2.409936e-02 1 1  ON 2
 uu_3                -9.510678e-02 1 1  ON 3
 uu_4                -1.375630e-01 1 1  ON 4
 uu_5                -1.639797e-01 1 1  ON 5
 uu_6                -1.782717e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719100e-01 1 1  ON 10
 ud_1                 1.876746e-01 1 1  ON 11
 ud_2                 3.667572e-02 1 1  ON 12
 ud_3                -4.887793e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351706e-01 1 1  ON 15
 ud_6                -1.582014e-01 1 1  ON 16
 ud_7                -1.698044e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449803e-01 1 1  ON 19
 eC_0                -6.978176e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159482e-01 1 1  ON 22
 eC_3                 7.975826e-03 1 1  ON 23
 eC_4                 1.556474e-01 1 1  ON 24
 eC_5                 2.777942e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664640e-01 1 1  ON 27
 eC_8                 2.775715e-01 1 1  ON 28
 eC_9                 5.084730e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515366e-01 1 1  ON 31
 eO_2                -3.588165e-01 1 1  ON 32
 eO_3                -3.145823e-02 1 1  ON 33
 eO_4                 1.975748e-01 1 1  ON 34
 eO_5                 3.457450e-01 1 1  ON 35
 eO_6                 3.960467e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325690e-01 1 1  ON 38
 eO_9                 4.019255e-01 1 1  ON 39
eH1_0                -1.621508e-01 1 1  ON 40
eH1_1                -6.174152e-02 1 1  ON 41
eH1_2                -4.147124e-02 1 1  ON 42
eH1_3                -3.994624e-02 1 1  ON 43
eH1_4                -2.207848e-03 1 1  ON 44
eH1_5                 1.034308e-02 1 1  ON 45
eH1_6                 4.266242e-02 1 1  ON 46
eH1_7                 5.927049e-02 1 1  ON 47
eH1_8                 3.451652e-02 1 1  ON 48
eH1_9                 6.046240e-02 1 1  ON 49
eH2_0                -1.731539e-01 1 1  ON 50
eH2_1                -7.337356e-02 1 1  ON 51
eH2_2                -5.334284e-02 1 1  ON 52
eH2_3                -5.229578e-02 1 1  ON 53
eH2_4                -1.448168e-02 1 1  ON 54
eH2_5                -2.552440e-03 1 1  ON 55
eH2_6                 3.051750e-02 1 1  ON 56
eH2_7                 4.664130e-02 1 1  ON 57
eH2_8                 2.702688e-02 1 1  ON 58
eH2_9                 1.141871e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.4677
    reference variance = 0.29755
====================================================
  Execution time = 4.3582e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6565e-01
  Total weights = 2.0000e+06
  Execution time = 3.6014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565752962737
                                         uncertainty =       0.003942921405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565752962737
                                         uncertainty =       0.003942921405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531813672
  error estimate for blocks of size 2^( 2) =       0.000552026128
  error estimate for blocks of size 2^( 3) =       0.000570253922
  error estimate for blocks of size 2^( 4) =       0.000585027057
  error estimate for blocks of size 2^( 5) =       0.000593346255
  error estimate for blocks of size 2^( 6) =       0.000597274544
  error estimate for blocks of size 2^( 7) =       0.000597868449

      target function =                  N/A
              le_mean =     -22.437009536925
             les_mean =     503.985048240123
             stat err =       0.000593379076
             autocorr =       1.244931514092
              std dev =       0.752098107218
             le_variance =       0.565651562881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565753876845
                                         uncertainty =       0.003942928287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565753876845
                                         uncertainty =       0.003942928287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531814101
  error estimate for blocks of size 2^( 2) =       0.000552026524
  error estimate for blocks of size 2^( 3) =       0.000570254292
  error estimate for blocks of size 2^( 4) =       0.000585027436
  error estimate for blocks of size 2^( 5) =       0.000593346610
  error estimate for blocks of size 2^( 6) =       0.000597274904
  error estimate for blocks of size 2^( 7) =       0.000597868743

      target function =                  N/A
              le_mean =     -22.437009533836
             les_mean =     503.985049014718
             stat err =       0.000593379423
             autocorr =       1.244930959419
              std dev =       0.752098714317
             le_variance =       0.565652476078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565753421012
                                         uncertainty =       0.003942924845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565753421012
                                         uncertainty =       0.003942924845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531813887
  error estimate for blocks of size 2^( 2) =       0.000552026326
  error estimate for blocks of size 2^( 3) =       0.000570254107
  error estimate for blocks of size 2^( 4) =       0.000585027247
  error estimate for blocks of size 2^( 5) =       0.000593346433
  error estimate for blocks of size 2^( 6) =       0.000597274724
  error estimate for blocks of size 2^( 7) =       0.000597868597

      target function =                  N/A
              le_mean =     -22.437009535372
             les_mean =     503.985048628234
             stat err =       0.000593379250
             autocorr =       1.244931235981
              std dev =       0.752098411579
             le_variance =       0.565652020700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565753020057
                                         uncertainty =       0.003942921835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565753020057
                                         uncertainty =       0.003942921835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531813699
  error estimate for blocks of size 2^( 2) =       0.000552026153
  error estimate for blocks of size 2^( 3) =       0.000570253945
  error estimate for blocks of size 2^( 4) =       0.000585027081
  error estimate for blocks of size 2^( 5) =       0.000593346277
  error estimate for blocks of size 2^( 6) =       0.000597274567
  error estimate for blocks of size 2^( 7) =       0.000597868468

      target function =                  N/A
              le_mean =     -22.437009536730
             les_mean =     503.985048288643
             stat err =       0.000593379098
             autocorr =       1.244931479299
              std dev =       0.752098145287
             le_variance =       0.565651620144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437009536925        initial  <--
     1.5259e+02     1.5259e+03             1.4438e-06       -22.437009533836
     6.1035e+02     6.1035e+03             3.6119e-07       -22.437009535372
     2.4414e+03     2.4414e+04             9.0311e-08       -22.437009536730

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.6325
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271760e-02 1 1  ON 1
 uu_2                -2.409964e-02 1 1  ON 2
 uu_3                -9.510676e-02 1 1  ON 3
 uu_4                -1.375631e-01 1 1  ON 4
 uu_5                -1.639796e-01 1 1  ON 5
 uu_6                -1.782716e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719098e-01 1 1  ON 10
 ud_1                 1.876747e-01 1 1  ON 11
 ud_2                 3.667579e-02 1 1  ON 12
 ud_3                -4.887799e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351708e-01 1 1  ON 15
 ud_6                -1.582015e-01 1 1  ON 16
 ud_7                -1.698046e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449802e-01 1 1  ON 19
 eC_0                -6.978179e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975828e-03 1 1  ON 23
 eC_4                 1.556476e-01 1 1  ON 24
 eC_5                 2.777939e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664643e-01 1 1  ON 27
 eC_8                 2.775714e-01 1 1  ON 28
 eC_9                 5.084722e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515368e-01 1 1  ON 31
 eO_2                -3.588167e-01 1 1  ON 32
 eO_3                -3.145788e-02 1 1  ON 33
 eO_4                 1.975750e-01 1 1  ON 34
 eO_5                 3.457449e-01 1 1  ON 35
 eO_6                 3.960465e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325694e-01 1 1  ON 38
 eO_9                 4.019254e-01 1 1  ON 39
eH1_0                -1.621507e-01 1 1  ON 40
eH1_1                -6.174150e-02 1 1  ON 41
eH1_2                -4.147131e-02 1 1  ON 42
eH1_3                -3.994628e-02 1 1  ON 43
eH1_4                -2.207996e-03 1 1  ON 44
eH1_5                 1.034327e-02 1 1  ON 45
eH1_6                 4.266229e-02 1 1  ON 46
eH1_7                 5.927068e-02 1 1  ON 47
eH1_8                 3.451649e-02 1 1  ON 48
eH1_9                 6.046238e-02 1 1  ON 49
eH2_0                -1.731538e-01 1 1  ON 50
eH2_1                -7.337365e-02 1 1  ON 51
eH2_2                -5.334279e-02 1 1  ON 52
eH2_3                -5.229609e-02 1 1  ON 53
eH2_4                -1.448158e-02 1 1  ON 54
eH2_5                -2.552642e-03 1 1  ON 55
eH2_6                 3.051757e-02 1 1  ON 56
eH2_7                 4.664143e-02 1 1  ON 57
eH2_8                 2.702687e-02 1 1  ON 58
eH2_9                 1.141873e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2074e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2443e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.4626
    reference variance = 0.485054
====================================================
  Execution time = 4.4127e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5972e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4982e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559766251455
                                         uncertainty =       0.003855718138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559766251455
                                         uncertainty =       0.003855718138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529017545
  error estimate for blocks of size 2^( 2) =       0.000548934187
  error estimate for blocks of size 2^( 3) =       0.000566733410
  error estimate for blocks of size 2^( 4) =       0.000579772533
  error estimate for blocks of size 2^( 5) =       0.000588708521
  error estimate for blocks of size 2^( 6) =       0.000593997570
  error estimate for blocks of size 2^( 7) =       0.000597922761

      target function =                  N/A
              le_mean =     -22.436698765632
             les_mean =     503.965170344729
             stat err =       0.000590100347
             autocorr =       1.244261285975
              std dev =       0.748143786244
             le_variance =       0.559719124895


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243669876563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436698765632       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436698765729       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436698765746       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436698765687       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436698765751       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436698765489       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436698765074       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436698764906       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436698765014       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436698765096       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+03 is 1.904781e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436698765632       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436698765656       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436698765660       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436698765645       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436698765663       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436698765590       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436698765492       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436698765451       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436698765476       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436698765499       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+03 is 4.763121e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436698765632       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436698765638       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436698765639       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436698765635       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436698765640       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436698765607       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436698765599       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436698765655       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436698765543       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436698765660       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+04 is 1.190853e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.472331 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9116e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271760e-02 1 1  ON 1
 uu_2                -2.409962e-02 1 1  ON 2
 uu_3                -9.510676e-02 1 1  ON 3
 uu_4                -1.375631e-01 1 1  ON 4
 uu_5                -1.639796e-01 1 1  ON 5
 uu_6                -1.782716e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719099e-01 1 1  ON 10
 ud_1                 1.876747e-01 1 1  ON 11
 ud_2                 3.667578e-02 1 1  ON 12
 ud_3                -4.887800e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351708e-01 1 1  ON 15
 ud_6                -1.582015e-01 1 1  ON 16
 ud_7                -1.698046e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449802e-01 1 1  ON 19
 eC_0                -6.978179e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975816e-03 1 1  ON 23
 eC_4                 1.556475e-01 1 1  ON 24
 eC_5                 2.777939e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664643e-01 1 1  ON 27
 eC_8                 2.775714e-01 1 1  ON 28
 eC_9                 5.084723e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515368e-01 1 1  ON 31
 eO_2                -3.588166e-01 1 1  ON 32
 eO_3                -3.145790e-02 1 1  ON 33
 eO_4                 1.975750e-01 1 1  ON 34
 eO_5                 3.457449e-01 1 1  ON 35
 eO_6                 3.960465e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325693e-01 1 1  ON 38
 eO_9                 4.019254e-01 1 1  ON 39
eH1_0                -1.621507e-01 1 1  ON 40
eH1_1                -6.174152e-02 1 1  ON 41
eH1_2                -4.147132e-02 1 1  ON 42
eH1_3                -3.994629e-02 1 1  ON 43
eH1_4                -2.207971e-03 1 1  ON 44
eH1_5                 1.034327e-02 1 1  ON 45
eH1_6                 4.266230e-02 1 1  ON 46
eH1_7                 5.927065e-02 1 1  ON 47
eH1_8                 3.451651e-02 1 1  ON 48
eH1_9                 6.046238e-02 1 1  ON 49
eH2_0                -1.731538e-01 1 1  ON 50
eH2_1                -7.337366e-02 1 1  ON 51
eH2_2                -5.334279e-02 1 1  ON 52
eH2_3                -5.229608e-02 1 1  ON 53
eH2_4                -1.448158e-02 1 1  ON 54
eH2_5                -2.552653e-03 1 1  ON 55
eH2_6                 3.051756e-02 1 1  ON 56
eH2_7                 4.664143e-02 1 1  ON 57
eH2_8                 2.702688e-02 1 1  ON 58
eH2_9                 1.141873e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.4634
    reference variance = 0.542912
====================================================
  Execution time = 4.3241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7258e-01
  Total weights = 2.0000e+06
  Execution time = 3.5946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572575300279
                                         uncertainty =       0.005337983136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572575300279
                                         uncertainty =       0.005337983136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535061090
  error estimate for blocks of size 2^( 2) =       0.000555125037
  error estimate for blocks of size 2^( 3) =       0.000573729751
  error estimate for blocks of size 2^( 4) =       0.000587531249
  error estimate for blocks of size 2^( 5) =       0.000595532303
  error estimate for blocks of size 2^( 6) =       0.000600008120
  error estimate for blocks of size 2^( 7) =       0.000604109456

      target function =                  N/A
              le_mean =     -22.435789459176
             les_mean =     503.937229110734
             stat err =       0.000596795282
             autocorr =       1.244067721011
              std dev =       0.756690650504
             le_variance =       0.572580740560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572575571986
                                         uncertainty =       0.005337986390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572575571986
                                         uncertainty =       0.005337986390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535061217
  error estimate for blocks of size 2^( 2) =       0.000555125157
  error estimate for blocks of size 2^( 3) =       0.000573729864
  error estimate for blocks of size 2^( 4) =       0.000587531358
  error estimate for blocks of size 2^( 5) =       0.000595532409
  error estimate for blocks of size 2^( 6) =       0.000600008219
  error estimate for blocks of size 2^( 7) =       0.000604109560

      target function =                  N/A
              le_mean =     -22.435789456397
             les_mean =     503.937229257850
             stat err =       0.000596795386
             autocorr =       1.244067565747
              std dev =       0.756690830097
             le_variance =       0.572581012353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572575436164
                                         uncertainty =       0.005337984764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572575436164
                                         uncertainty =       0.005337984764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535061154
  error estimate for blocks of size 2^( 2) =       0.000555125097
  error estimate for blocks of size 2^( 3) =       0.000573729808
  error estimate for blocks of size 2^( 4) =       0.000587531303
  error estimate for blocks of size 2^( 5) =       0.000595532356
  error estimate for blocks of size 2^( 6) =       0.000600008170
  error estimate for blocks of size 2^( 7) =       0.000604109508

      target function =                  N/A
              le_mean =     -22.435789457786
             les_mean =     503.937229184306
             stat err =       0.000596795334
             autocorr =       1.244067643362
              std dev =       0.756690740321
             le_variance =       0.572580876487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572575317266
                                         uncertainty =       0.005337983340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572575317266
                                         uncertainty =       0.005337983340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535061098
  error estimate for blocks of size 2^( 2) =       0.000555125044
  error estimate for blocks of size 2^( 3) =       0.000573729758
  error estimate for blocks of size 2^( 4) =       0.000587531256
  error estimate for blocks of size 2^( 5) =       0.000595532309
  error estimate for blocks of size 2^( 6) =       0.000600008126
  error estimate for blocks of size 2^( 7) =       0.000604109462

      target function =                  N/A
              le_mean =     -22.435789459002
             les_mean =     503.937229119931
             stat err =       0.000596795288
             autocorr =       1.244067711303
              std dev =       0.756690661731
             le_variance =       0.572580757551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435789459176        initial  <--
     1.5259e+03     1.5259e+04             1.9048e-07       -22.435789456397
     6.1035e+03     6.1035e+04             4.7631e-08       -22.435789457786
     2.4414e+04     2.4414e+05             1.1909e-08       -22.435789459002

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4466
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271760e-02 1 1  ON 1
 uu_2                -2.409964e-02 1 1  ON 2
 uu_3                -9.510676e-02 1 1  ON 3
 uu_4                -1.375631e-01 1 1  ON 4
 uu_5                -1.639796e-01 1 1  ON 5
 uu_6                -1.782716e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719098e-01 1 1  ON 10
 ud_1                 1.876747e-01 1 1  ON 11
 ud_2                 3.667579e-02 1 1  ON 12
 ud_3                -4.887799e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351708e-01 1 1  ON 15
 ud_6                -1.582015e-01 1 1  ON 16
 ud_7                -1.698046e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449802e-01 1 1  ON 19
 eC_0                -6.978179e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975828e-03 1 1  ON 23
 eC_4                 1.556476e-01 1 1  ON 24
 eC_5                 2.777939e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664643e-01 1 1  ON 27
 eC_8                 2.775714e-01 1 1  ON 28
 eC_9                 5.084722e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515368e-01 1 1  ON 31
 eO_2                -3.588167e-01 1 1  ON 32
 eO_3                -3.145788e-02 1 1  ON 33
 eO_4                 1.975750e-01 1 1  ON 34
 eO_5                 3.457449e-01 1 1  ON 35
 eO_6                 3.960465e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325694e-01 1 1  ON 38
 eO_9                 4.019254e-01 1 1  ON 39
eH1_0                -1.621507e-01 1 1  ON 40
eH1_1                -6.174150e-02 1 1  ON 41
eH1_2                -4.147131e-02 1 1  ON 42
eH1_3                -3.994628e-02 1 1  ON 43
eH1_4                -2.207996e-03 1 1  ON 44
eH1_5                 1.034327e-02 1 1  ON 45
eH1_6                 4.266229e-02 1 1  ON 46
eH1_7                 5.927068e-02 1 1  ON 47
eH1_8                 3.451649e-02 1 1  ON 48
eH1_9                 6.046238e-02 1 1  ON 49
eH2_0                -1.731538e-01 1 1  ON 50
eH2_1                -7.337365e-02 1 1  ON 51
eH2_2                -5.334279e-02 1 1  ON 52
eH2_3                -5.229609e-02 1 1  ON 53
eH2_4                -1.448158e-02 1 1  ON 54
eH2_5                -2.552642e-03 1 1  ON 55
eH2_6                 3.051757e-02 1 1  ON 56
eH2_7                 4.664143e-02 1 1  ON 57
eH2_8                 2.702687e-02 1 1  ON 58
eH2_9                 1.141873e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2357e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2444e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.3821
    reference variance = 0.683946
====================================================
  Execution time = 4.3977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5700e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4947e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557104564786
                                         uncertainty =       0.003459173250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557104564786
                                         uncertainty =       0.003459173250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527732141
  error estimate for blocks of size 2^( 2) =       0.000547924790
  error estimate for blocks of size 2^( 3) =       0.000567190373
  error estimate for blocks of size 2^( 4) =       0.000581644582
  error estimate for blocks of size 2^( 5) =       0.000590433112
  error estimate for blocks of size 2^( 6) =       0.000594850048
  error estimate for blocks of size 2^( 7) =       0.000597549077

      target function =                  N/A
              le_mean =     -22.436166708424
             les_mean =     503.938578715598
             stat err =       0.000591119205
             autocorr =       1.254651320244
              std dev =       0.746325951520
             le_variance =       0.557002425912


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243616670842e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436166708424       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436166708428       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436166708458       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436166708506       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436166708570       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436166708594       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436166708600       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436166708675       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436166708619       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436166708591       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+04 is 1.797936e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436166708424       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436166708425       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436166708432       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436166708450       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436166708460       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436166708476       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436166708454       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436166708506       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436166708345       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436166708473       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+04 is 4.494958e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436166708424       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436166708424       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436166708426       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436166708429       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436166708332       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436166708252       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436166708537       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436166708529       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436166708137       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436166708025       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+05 is 1.123747e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.476001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8932e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271761e-02 1 1  ON 1
 uu_2                -2.409963e-02 1 1  ON 2
 uu_3                -9.510676e-02 1 1  ON 3
 uu_4                -1.375631e-01 1 1  ON 4
 uu_5                -1.639796e-01 1 1  ON 5
 uu_6                -1.782716e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719098e-01 1 1  ON 10
 ud_1                 1.876747e-01 1 1  ON 11
 ud_2                 3.667579e-02 1 1  ON 12
 ud_3                -4.887799e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351708e-01 1 1  ON 15
 ud_6                -1.582015e-01 1 1  ON 16
 ud_7                -1.698046e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449802e-01 1 1  ON 19
 eC_0                -6.978179e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975827e-03 1 1  ON 23
 eC_4                 1.556476e-01 1 1  ON 24
 eC_5                 2.777939e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664643e-01 1 1  ON 27
 eC_8                 2.775714e-01 1 1  ON 28
 eC_9                 5.084722e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515368e-01 1 1  ON 31
 eO_2                -3.588167e-01 1 1  ON 32
 eO_3                -3.145788e-02 1 1  ON 33
 eO_4                 1.975750e-01 1 1  ON 34
 eO_5                 3.457449e-01 1 1  ON 35
 eO_6                 3.960465e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325694e-01 1 1  ON 38
 eO_9                 4.019254e-01 1 1  ON 39
eH1_0                -1.621507e-01 1 1  ON 40
eH1_1                -6.174150e-02 1 1  ON 41
eH1_2                -4.147131e-02 1 1  ON 42
eH1_3                -3.994628e-02 1 1  ON 43
eH1_4                -2.207997e-03 1 1  ON 44
eH1_5                 1.034327e-02 1 1  ON 45
eH1_6                 4.266229e-02 1 1  ON 46
eH1_7                 5.927068e-02 1 1  ON 47
eH1_8                 3.451649e-02 1 1  ON 48
eH1_9                 6.046238e-02 1 1  ON 49
eH2_0                -1.731538e-01 1 1  ON 50
eH2_1                -7.337365e-02 1 1  ON 51
eH2_2                -5.334279e-02 1 1  ON 52
eH2_3                -5.229609e-02 1 1  ON 53
eH2_4                -1.448158e-02 1 1  ON 54
eH2_5                -2.552643e-03 1 1  ON 55
eH2_6                 3.051757e-02 1 1  ON 56
eH2_7                 4.664143e-02 1 1  ON 57
eH2_8                 2.702687e-02 1 1  ON 58
eH2_9                 1.141873e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5109
    reference variance = 0.524559
====================================================
  Execution time = 4.3887e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7476e-01
  Total weights = 2.0000e+06
  Execution time = 3.5958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574771605046
                                         uncertainty =       0.007803495416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574771605046
                                         uncertainty =       0.007803495416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536077654
  error estimate for blocks of size 2^( 2) =       0.000555931789
  error estimate for blocks of size 2^( 3) =       0.000574209981
  error estimate for blocks of size 2^( 4) =       0.000586827652
  error estimate for blocks of size 2^( 5) =       0.000594984211
  error estimate for blocks of size 2^( 6) =       0.000600348892
  error estimate for blocks of size 2^( 7) =       0.000603683958

      target function =                  N/A
              le_mean =     -22.438036243980
             les_mean =     504.040228701682
             stat err =       0.000596461178
             autocorr =       1.237966677643
              std dev =       0.758128289224
             le_variance =       0.574758502921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574771644179
                                         uncertainty =       0.007803495978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574771644179
                                         uncertainty =       0.007803495978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536077673
  error estimate for blocks of size 2^( 2) =       0.000555931806
  error estimate for blocks of size 2^( 3) =       0.000574209997
  error estimate for blocks of size 2^( 4) =       0.000586827667
  error estimate for blocks of size 2^( 5) =       0.000594984225
  error estimate for blocks of size 2^( 6) =       0.000600348906
  error estimate for blocks of size 2^( 7) =       0.000603683971

      target function =                  N/A
              le_mean =     -22.438036243993
             les_mean =     504.040228741441
             stat err =       0.000596461192
             autocorr =       1.237966652272
              std dev =       0.758128315037
             le_variance =       0.574758542061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574771624613
                                         uncertainty =       0.007803495697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574771624613
                                         uncertainty =       0.007803495697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536077663
  error estimate for blocks of size 2^( 2) =       0.000555931798
  error estimate for blocks of size 2^( 3) =       0.000574209989
  error estimate for blocks of size 2^( 4) =       0.000586827660
  error estimate for blocks of size 2^( 5) =       0.000594984218
  error estimate for blocks of size 2^( 6) =       0.000600348899
  error estimate for blocks of size 2^( 7) =       0.000603683965

      target function =                  N/A
              le_mean =     -22.438036243986
             les_mean =     504.040228721562
             stat err =       0.000596461185
             autocorr =       1.237966664952
              std dev =       0.758128302131
             le_variance =       0.574758522492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574771607492
                                         uncertainty =       0.007803495451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574771607492
                                         uncertainty =       0.007803495451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536077655
  error estimate for blocks of size 2^( 2) =       0.000555931790
  error estimate for blocks of size 2^( 3) =       0.000574209982
  error estimate for blocks of size 2^( 4) =       0.000586827653
  error estimate for blocks of size 2^( 5) =       0.000594984211
  error estimate for blocks of size 2^( 6) =       0.000600348893
  error estimate for blocks of size 2^( 7) =       0.000603683959

      target function =                  N/A
              le_mean =     -22.438036243980
             les_mean =     504.040228704167
             stat err =       0.000596461179
             autocorr =       1.237966676057
              std dev =       0.758128290837
             le_variance =       0.574758505368


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438036243980        initial
     1.5259e+04     1.5259e+05             1.7979e-08       -22.438036243993  <--
     6.1035e+04     6.1035e+05             4.4950e-09       -22.438036243986
     2.4414e+05     2.4414e+06             1.1237e-09       -22.438036243980

*****************************************************************************
Applying the update for shift_i =   1.5259e+04     and shift_s =   1.5259e+05
*****************************************************************************

  Execution time = 6.1908e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271762e-02 1 1  ON 1
 uu_2                -2.409963e-02 1 1  ON 2
 uu_3                -9.510676e-02 1 1  ON 3
 uu_4                -1.375631e-01 1 1  ON 4
 uu_5                -1.639796e-01 1 1  ON 5
 uu_6                -1.782716e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719098e-01 1 1  ON 10
 ud_1                 1.876747e-01 1 1  ON 11
 ud_2                 3.667578e-02 1 1  ON 12
 ud_3                -4.887800e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351708e-01 1 1  ON 15
 ud_6                -1.582015e-01 1 1  ON 16
 ud_7                -1.698046e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449802e-01 1 1  ON 19
 eC_0                -6.978179e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975823e-03 1 1  ON 23
 eC_4                 1.556476e-01 1 1  ON 24
 eC_5                 2.777939e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664643e-01 1 1  ON 27
 eC_8                 2.775714e-01 1 1  ON 28
 eC_9                 5.084723e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515368e-01 1 1  ON 31
 eO_2                -3.588166e-01 1 1  ON 32
 eO_3                -3.145788e-02 1 1  ON 33
 eO_4                 1.975750e-01 1 1  ON 34
 eO_5                 3.457449e-01 1 1  ON 35
 eO_6                 3.960465e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325694e-01 1 1  ON 38
 eO_9                 4.019254e-01 1 1  ON 39
eH1_0                -1.621507e-01 1 1  ON 40
eH1_1                -6.174150e-02 1 1  ON 41
eH1_2                -4.147131e-02 1 1  ON 42
eH1_3                -3.994628e-02 1 1  ON 43
eH1_4                -2.207998e-03 1 1  ON 44
eH1_5                 1.034327e-02 1 1  ON 45
eH1_6                 4.266229e-02 1 1  ON 46
eH1_7                 5.927067e-02 1 1  ON 47
eH1_8                 3.451650e-02 1 1  ON 48
eH1_9                 6.046238e-02 1 1  ON 49
eH2_0                -1.731538e-01 1 1  ON 50
eH2_1                -7.337364e-02 1 1  ON 51
eH2_2                -5.334279e-02 1 1  ON 52
eH2_3                -5.229609e-02 1 1  ON 53
eH2_4                -1.448159e-02 1 1  ON 54
eH2_5                -2.552647e-03 1 1  ON 55
eH2_6                 3.051757e-02 1 1  ON 56
eH2_7                 4.664143e-02 1 1  ON 57
eH2_8                 2.702687e-02 1 1  ON 58
eH2_9                 1.141873e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2085e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2444e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4894
    reference variance = 0.316332
====================================================
  Execution time = 4.4140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5976e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4954e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559799901441
                                         uncertainty =       0.004098177542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559799901441
                                         uncertainty =       0.004098177542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529037875
  error estimate for blocks of size 2^( 2) =       0.000548793543
  error estimate for blocks of size 2^( 3) =       0.000567065597
  error estimate for blocks of size 2^( 4) =       0.000580323184
  error estimate for blocks of size 2^( 5) =       0.000588918197
  error estimate for blocks of size 2^( 6) =       0.000594889053
  error estimate for blocks of size 2^( 7) =       0.000595905296

      target function =                  N/A
              le_mean =     -22.437185004893
             les_mean =     503.987032811165
             stat err =       0.000590008932
             autocorr =       1.243780209140
              std dev =       0.748172538429
             le_variance =       0.559762147259


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243718500489e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437185004893       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437185004917       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437185004920       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437185004942       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437185004808       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437185004797       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437185004791       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437185004757       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437185004773       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437185004747       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+03 is 7.461907e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437185004893       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437185004899       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437185004900       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437185004905       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437185004873       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437185004888       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437185004882       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437185004859       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437185004853       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437185004797       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+04 is 1.865505e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437185004893       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437185004894       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437185004894       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437185004896       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437185004888       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437185004874       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437185004875       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437185004888       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437185004941       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437185004845       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+04 is 4.663782e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.479654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9102e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271762e-02 1 1  ON 1
 uu_2                -2.409963e-02 1 1  ON 2
 uu_3                -9.510676e-02 1 1  ON 3
 uu_4                -1.375631e-01 1 1  ON 4
 uu_5                -1.639796e-01 1 1  ON 5
 uu_6                -1.782716e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719098e-01 1 1  ON 10
 ud_1                 1.876747e-01 1 1  ON 11
 ud_2                 3.667577e-02 1 1  ON 12
 ud_3                -4.887800e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351708e-01 1 1  ON 15
 ud_6                -1.582015e-01 1 1  ON 16
 ud_7                -1.698046e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449802e-01 1 1  ON 19
 eC_0                -6.978179e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975821e-03 1 1  ON 23
 eC_4                 1.556476e-01 1 1  ON 24
 eC_5                 2.777939e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664643e-01 1 1  ON 27
 eC_8                 2.775714e-01 1 1  ON 28
 eC_9                 5.084723e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515368e-01 1 1  ON 31
 eO_2                -3.588166e-01 1 1  ON 32
 eO_3                -3.145788e-02 1 1  ON 33
 eO_4                 1.975750e-01 1 1  ON 34
 eO_5                 3.457449e-01 1 1  ON 35
 eO_6                 3.960465e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325694e-01 1 1  ON 38
 eO_9                 4.019254e-01 1 1  ON 39
eH1_0                -1.621507e-01 1 1  ON 40
eH1_1                -6.174150e-02 1 1  ON 41
eH1_2                -4.147132e-02 1 1  ON 42
eH1_3                -3.994627e-02 1 1  ON 43
eH1_4                -2.207996e-03 1 1  ON 44
eH1_5                 1.034325e-02 1 1  ON 45
eH1_6                 4.266230e-02 1 1  ON 46
eH1_7                 5.927065e-02 1 1  ON 47
eH1_8                 3.451650e-02 1 1  ON 48
eH1_9                 6.046238e-02 1 1  ON 49
eH2_0                -1.731538e-01 1 1  ON 50
eH2_1                -7.337365e-02 1 1  ON 51
eH2_2                -5.334279e-02 1 1  ON 52
eH2_3                -5.229609e-02 1 1  ON 53
eH2_4                -1.448159e-02 1 1  ON 54
eH2_5                -2.552644e-03 1 1  ON 55
eH2_6                 3.051758e-02 1 1  ON 56
eH2_7                 4.664142e-02 1 1  ON 57
eH2_8                 2.702687e-02 1 1  ON 58
eH2_9                 1.141873e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4941
    reference variance = 0.412464
====================================================
  Execution time = 4.3329e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7256e-01
  Total weights = 2.0000e+06
  Execution time = 3.5834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572608254682
                                         uncertainty =       0.006937766735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572608254682
                                         uncertainty =       0.006937766735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535049264
  error estimate for blocks of size 2^( 2) =       0.000554722137
  error estimate for blocks of size 2^( 3) =       0.000572728749
  error estimate for blocks of size 2^( 4) =       0.000585461170
  error estimate for blocks of size 2^( 5) =       0.000593023045
  error estimate for blocks of size 2^( 6) =       0.000597091238
  error estimate for blocks of size 2^( 7) =       0.000593715036

      target function =                  N/A
              le_mean =     -22.437581086229
             les_mean =     504.017600144966
             stat err =       0.000592322622
             autocorr =       1.225544534554
              std dev =       0.756673925909
             le_variance =       0.572555430150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572608363903
                                         uncertainty =       0.006937768126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572608363903
                                         uncertainty =       0.006937768126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535049315
  error estimate for blocks of size 2^( 2) =       0.000554722185
  error estimate for blocks of size 2^( 3) =       0.000572728794
  error estimate for blocks of size 2^( 4) =       0.000585461213
  error estimate for blocks of size 2^( 5) =       0.000593023087
  error estimate for blocks of size 2^( 6) =       0.000597091280
  error estimate for blocks of size 2^( 7) =       0.000593715075

      target function =                  N/A
              le_mean =     -22.437581086618
             les_mean =     504.017600271665
             stat err =       0.000592322664
             autocorr =       1.225544472251
              std dev =       0.756673998076
             le_variance =       0.572555539364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572608309298
                                         uncertainty =       0.006937767431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572608309298
                                         uncertainty =       0.006937767431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535049290
  error estimate for blocks of size 2^( 2) =       0.000554722161
  error estimate for blocks of size 2^( 3) =       0.000572728771
  error estimate for blocks of size 2^( 4) =       0.000585461192
  error estimate for blocks of size 2^( 5) =       0.000593023066
  error estimate for blocks of size 2^( 6) =       0.000597091259
  error estimate for blocks of size 2^( 7) =       0.000593715056

      target function =                  N/A
              le_mean =     -22.437581086424
             les_mean =     504.017600208321
             stat err =       0.000592322643
             autocorr =       1.225544503391
              std dev =       0.756673961995
             le_variance =       0.572555484762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572608261509
                                         uncertainty =       0.006937766822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572608261509
                                         uncertainty =       0.006937766822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535049267
  error estimate for blocks of size 2^( 2) =       0.000554722140
  error estimate for blocks of size 2^( 3) =       0.000572728752
  error estimate for blocks of size 2^( 4) =       0.000585461173
  error estimate for blocks of size 2^( 5) =       0.000593023048
  error estimate for blocks of size 2^( 6) =       0.000597091241
  error estimate for blocks of size 2^( 7) =       0.000593715039

      target function =                  N/A
              le_mean =     -22.437581086253
             les_mean =     504.017600152885
             stat err =       0.000592322625
             autocorr =       1.225544530657
              std dev =       0.756673930420
             le_variance =       0.572555436977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437581086229        initial
     3.8147e+03     3.8147e+04             7.4619e-08       -22.437581086618  <--
     1.5259e+04     1.5259e+05             1.8655e-08       -22.437581086424
     6.1035e+04     6.1035e+05             4.6638e-09       -22.437581086253

*****************************************************************************
Applying the update for shift_i =   3.8147e+03     and shift_s =   3.8147e+04
*****************************************************************************

  Execution time = 6.1288e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271764e-02 1 1  ON 1
 uu_2                -2.409962e-02 1 1  ON 2
 uu_3                -9.510674e-02 1 1  ON 3
 uu_4                -1.375631e-01 1 1  ON 4
 uu_5                -1.639796e-01 1 1  ON 5
 uu_6                -1.782716e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719099e-01 1 1  ON 10
 ud_1                 1.876747e-01 1 1  ON 11
 ud_2                 3.667576e-02 1 1  ON 12
 ud_3                -4.887801e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351708e-01 1 1  ON 15
 ud_6                -1.582015e-01 1 1  ON 16
 ud_7                -1.698046e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449801e-01 1 1  ON 19
 eC_0                -6.978179e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975815e-03 1 1  ON 23
 eC_4                 1.556476e-01 1 1  ON 24
 eC_5                 2.777939e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664642e-01 1 1  ON 27
 eC_8                 2.775715e-01 1 1  ON 28
 eC_9                 5.084724e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515368e-01 1 1  ON 31
 eO_2                -3.588166e-01 1 1  ON 32
 eO_3                -3.145791e-02 1 1  ON 33
 eO_4                 1.975750e-01 1 1  ON 34
 eO_5                 3.457449e-01 1 1  ON 35
 eO_6                 3.960465e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325693e-01 1 1  ON 38
 eO_9                 4.019254e-01 1 1  ON 39
eH1_0                -1.621507e-01 1 1  ON 40
eH1_1                -6.174149e-02 1 1  ON 41
eH1_2                -4.147132e-02 1 1  ON 42
eH1_3                -3.994626e-02 1 1  ON 43
eH1_4                -2.207992e-03 1 1  ON 44
eH1_5                 1.034322e-02 1 1  ON 45
eH1_6                 4.266232e-02 1 1  ON 46
eH1_7                 5.927060e-02 1 1  ON 47
eH1_8                 3.451651e-02 1 1  ON 48
eH1_9                 6.046239e-02 1 1  ON 49
eH2_0                -1.731538e-01 1 1  ON 50
eH2_1                -7.337366e-02 1 1  ON 51
eH2_2                -5.334278e-02 1 1  ON 52
eH2_3                -5.229608e-02 1 1  ON 53
eH2_4                -1.448159e-02 1 1  ON 54
eH2_5                -2.552633e-03 1 1  ON 55
eH2_6                 3.051759e-02 1 1  ON 56
eH2_7                 4.664138e-02 1 1  ON 57
eH2_8                 2.702687e-02 1 1  ON 58
eH2_9                 1.141873e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2040e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2447e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.3905
    reference variance = 0.614748
====================================================
  Execution time = 4.3932e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6931e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5272e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569386331668
                                         uncertainty =       0.006659713866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569386331668
                                         uncertainty =       0.006659713866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533532498
  error estimate for blocks of size 2^( 2) =       0.000553915058
  error estimate for blocks of size 2^( 3) =       0.000572532807
  error estimate for blocks of size 2^( 4) =       0.000586644256
  error estimate for blocks of size 2^( 5) =       0.000594792719
  error estimate for blocks of size 2^( 6) =       0.000598213848
  error estimate for blocks of size 2^( 7) =       0.000596444201

      target function =                  N/A
              le_mean =     -22.436411698911
             les_mean =     503.961883491581
             stat err =       0.000594023756
             autocorr =       1.239612283129
              std dev =       0.754528894881
             le_variance =       0.569313853211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243641169891e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436411698911       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436411699327       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436411699559       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436411699969       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436411700503       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436411700984       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436411701304       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436411701316       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436411701380       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436411701282       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+02 is 3.449747e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436411698911       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436411699015       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436411699073       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436411699176       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436411699309       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436411699428       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436411699510       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436411699513       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436411699528       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436411699497       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+03 is 8.624620e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436411698911       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436411698937       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436411698951       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436411698975       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436411699011       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436411699040       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436411699081       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436411699068       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436411699017       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436411699086       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+04 is 2.156171e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.483363 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9212e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271769e-02 1 1  ON 1
 uu_2                -2.409961e-02 1 1  ON 2
 uu_3                -9.510671e-02 1 1  ON 3
 uu_4                -1.375631e-01 1 1  ON 4
 uu_5                -1.639796e-01 1 1  ON 5
 uu_6                -1.782716e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719099e-01 1 1  ON 10
 ud_1                 1.876746e-01 1 1  ON 11
 ud_2                 3.667572e-02 1 1  ON 12
 ud_3                -4.887803e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351708e-01 1 1  ON 15
 ud_6                -1.582015e-01 1 1  ON 16
 ud_7                -1.698045e-01 1 1  ON 17
 ud_8                -1.668750e-01 1 1  ON 18
 ud_9                -1.449801e-01 1 1  ON 19
 eC_0                -6.978179e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975825e-03 1 1  ON 23
 eC_4                 1.556476e-01 1 1  ON 24
 eC_5                 2.777938e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664642e-01 1 1  ON 27
 eC_8                 2.775715e-01 1 1  ON 28
 eC_9                 5.084725e-02 1 1  ON 29
 eO_0                -1.244611e+00 1 1  ON 30
 eO_1                -8.515368e-01 1 1  ON 31
 eO_2                -3.588166e-01 1 1  ON 32
 eO_3                -3.145793e-02 1 1  ON 33
 eO_4                 1.975749e-01 1 1  ON 34
 eO_5                 3.457449e-01 1 1  ON 35
 eO_6                 3.960465e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325693e-01 1 1  ON 38
 eO_9                 4.019254e-01 1 1  ON 39
eH1_0                -1.621507e-01 1 1  ON 40
eH1_1                -6.174148e-02 1 1  ON 41
eH1_2                -4.147132e-02 1 1  ON 42
eH1_3                -3.994624e-02 1 1  ON 43
eH1_4                -2.207973e-03 1 1  ON 44
eH1_5                 1.034321e-02 1 1  ON 45
eH1_6                 4.266231e-02 1 1  ON 46
eH1_7                 5.927051e-02 1 1  ON 47
eH1_8                 3.451652e-02 1 1  ON 48
eH1_9                 6.046239e-02 1 1  ON 49
eH2_0                -1.731538e-01 1 1  ON 50
eH2_1                -7.337365e-02 1 1  ON 51
eH2_2                -5.334277e-02 1 1  ON 52
eH2_3                -5.229606e-02 1 1  ON 53
eH2_4                -1.448158e-02 1 1  ON 54
eH2_5                -2.552641e-03 1 1  ON 55
eH2_6                 3.051759e-02 1 1  ON 56
eH2_7                 4.664139e-02 1 1  ON 57
eH2_8                 2.702688e-02 1 1  ON 58
eH2_9                 1.141873e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.5007
    reference variance = 0.376299
====================================================
  Execution time = 4.3506e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6145e-01
  Total weights = 2.0000e+06
  Execution time = 3.5862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561454229941
                                         uncertainty =       0.004586176457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561454229941
                                         uncertainty =       0.004586176457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529832741
  error estimate for blocks of size 2^( 2) =       0.000549723771
  error estimate for blocks of size 2^( 3) =       0.000568415465
  error estimate for blocks of size 2^( 4) =       0.000583479042
  error estimate for blocks of size 2^( 5) =       0.000592509107
  error estimate for blocks of size 2^( 6) =       0.000597588251
  error estimate for blocks of size 2^( 7) =       0.000598930256

      target function =                  N/A
              le_mean =     -22.438438538761
             les_mean =     504.044969244690
             stat err =       0.000593126664
             autocorr =       1.253191128453
              std dev =       0.749296648649
             le_variance =       0.561445467677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561454550342
                                         uncertainty =       0.004586178962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561454550342
                                         uncertainty =       0.004586178962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529832893
  error estimate for blocks of size 2^( 2) =       0.000549723913
  error estimate for blocks of size 2^( 3) =       0.000568415599
  error estimate for blocks of size 2^( 4) =       0.000583479172
  error estimate for blocks of size 2^( 5) =       0.000592509233
  error estimate for blocks of size 2^( 6) =       0.000597588368
  error estimate for blocks of size 2^( 7) =       0.000598930367

      target function =                  N/A
              le_mean =     -22.438438540068
             les_mean =     504.044969623711
             stat err =       0.000593126785
             autocorr =       1.253190923389
              std dev =       0.749296862414
             le_variance =       0.561445788024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561454390205
                                         uncertainty =       0.004586177710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561454390205
                                         uncertainty =       0.004586177710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529832817
  error estimate for blocks of size 2^( 2) =       0.000549723842
  error estimate for blocks of size 2^( 3) =       0.000568415532
  error estimate for blocks of size 2^( 4) =       0.000583479107
  error estimate for blocks of size 2^( 5) =       0.000592509170
  error estimate for blocks of size 2^( 6) =       0.000597588309
  error estimate for blocks of size 2^( 7) =       0.000598930311

      target function =                  N/A
              le_mean =     -22.438438539414
             les_mean =     504.044969434263
             stat err =       0.000593126724
             autocorr =       1.253191025890
              std dev =       0.749296755574
             le_variance =       0.561445627914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561454249976
                                         uncertainty =       0.004586176614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561454249976
                                         uncertainty =       0.004586176614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529832751
  error estimate for blocks of size 2^( 2) =       0.000549723780
  error estimate for blocks of size 2^( 3) =       0.000568415473
  error estimate for blocks of size 2^( 4) =       0.000583479051
  error estimate for blocks of size 2^( 5) =       0.000592509115
  error estimate for blocks of size 2^( 6) =       0.000597588258
  error estimate for blocks of size 2^( 7) =       0.000598930263

      target function =                  N/A
              le_mean =     -22.438438538842
             les_mean =     504.044969268388
             stat err =       0.000593126672
             autocorr =       1.253191115626
              std dev =       0.749296662016
             le_variance =       0.561445487709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438438538761        initial
     9.5367e+02     9.5367e+03             3.4497e-07       -22.438438540068  <--
     3.8147e+03     3.8147e+04             8.6246e-08       -22.438438539414
     1.5259e+04     1.5259e+05             2.1562e-08       -22.438438538842

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 6.1439e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.683847e-01 1 1  ON 0
 uu_1                 9.271784e-02 1 1  ON 1
 uu_2                -2.409957e-02 1 1  ON 2
 uu_3                -9.510662e-02 1 1  ON 3
 uu_4                -1.375632e-01 1 1  ON 4
 uu_5                -1.639795e-01 1 1  ON 5
 uu_6                -1.782718e-01 1 1  ON 6
 uu_7                -1.811383e-01 1 1  ON 7
 uu_8                -1.704091e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719100e-01 1 1  ON 10
 ud_1                 1.876745e-01 1 1  ON 11
 ud_2                 3.667563e-02 1 1  ON 12
 ud_3                -4.887806e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351707e-01 1 1  ON 15
 ud_6                -1.582014e-01 1 1  ON 16
 ud_7                -1.698044e-01 1 1  ON 17
 ud_8                -1.668749e-01 1 1  ON 18
 ud_9                -1.449801e-01 1 1  ON 19
 eC_0                -6.978177e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975856e-03 1 1  ON 23
 eC_4                 1.556475e-01 1 1  ON 24
 eC_5                 2.777938e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664641e-01 1 1  ON 27
 eC_8                 2.775715e-01 1 1  ON 28
 eC_9                 5.084729e-02 1 1  ON 29
 eO_0                -1.244612e+00 1 1  ON 30
 eO_1                -8.515366e-01 1 1  ON 31
 eO_2                -3.588165e-01 1 1  ON 32
 eO_3                -3.145798e-02 1 1  ON 33
 eO_4                 1.975749e-01 1 1  ON 34
 eO_5                 3.457450e-01 1 1  ON 35
 eO_6                 3.960464e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325691e-01 1 1  ON 38
 eO_9                 4.019255e-01 1 1  ON 39
eH1_0                -1.621506e-01 1 1  ON 40
eH1_1                -6.174144e-02 1 1  ON 41
eH1_2                -4.147132e-02 1 1  ON 42
eH1_3                -3.994618e-02 1 1  ON 43
eH1_4                -2.207918e-03 1 1  ON 44
eH1_5                 1.034318e-02 1 1  ON 45
eH1_6                 4.266229e-02 1 1  ON 46
eH1_7                 5.927025e-02 1 1  ON 47
eH1_8                 3.451657e-02 1 1  ON 48
eH1_9                 6.046239e-02 1 1  ON 49
eH2_0                -1.731539e-01 1 1  ON 50
eH2_1                -7.337363e-02 1 1  ON 51
eH2_2                -5.334273e-02 1 1  ON 52
eH2_3                -5.229599e-02 1 1  ON 53
eH2_4                -1.448155e-02 1 1  ON 54
eH2_5                -2.552665e-03 1 1  ON 55
eH2_6                 3.051757e-02 1 1  ON 56
eH2_7                 4.664140e-02 1 1  ON 57
eH2_8                 2.702690e-02 1 1  ON 58
eH2_9                 1.141872e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2066e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2447e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.3892
    reference variance = 0.414796
====================================================
  Execution time = 4.4564e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6402e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5124e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564076836760
                                         uncertainty =       0.007804660276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564076836760
                                         uncertainty =       0.007804660276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531048620
  error estimate for blocks of size 2^( 2) =       0.000551054629
  error estimate for blocks of size 2^( 3) =       0.000569764972
  error estimate for blocks of size 2^( 4) =       0.000583898930
  error estimate for blocks of size 2^( 5) =       0.000592483503
  error estimate for blocks of size 2^( 6) =       0.000598135444
  error estimate for blocks of size 2^( 7) =       0.000600790938

      target function =                  N/A
              le_mean =     -22.437215791281
             les_mean =     503.992677455767
             stat err =       0.000593827204
             autocorr =       1.250407613370
              std dev =       0.751016160445
             le_variance =       0.564025273250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243721579128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437215791281       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437215789730       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437215787927       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437215789647       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437215791282       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437215790964       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437215790110       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437215789405       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437215789522       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437215789574       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+02 is 9.352976e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437215791281       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437215790893       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437215790442       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437215790872       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437215791281       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437215791202       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437215790986       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437215790812       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437215790840       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437215790855       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+02 is 2.338613e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437215791281       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437215791184       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437215791072       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437215791179       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437215791285       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437215791259       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437215791214       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437215791176       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437215791159       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437215791190       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+03 is 5.846764e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.487064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9695e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.683847e-01 1 1  ON 0
 uu_1                 9.271787e-02 1 1  ON 1
 uu_2                -2.409957e-02 1 1  ON 2
 uu_3                -9.510656e-02 1 1  ON 3
 uu_4                -1.375632e-01 1 1  ON 4
 uu_5                -1.639794e-01 1 1  ON 5
 uu_6                -1.782719e-01 1 1  ON 6
 uu_7                -1.811382e-01 1 1  ON 7
 uu_8                -1.704090e-01 1 1  ON 8
 uu_9                -1.419271e-01 1 1  ON 9
 ud_0                 4.719102e-01 1 1  ON 10
 ud_1                 1.876746e-01 1 1  ON 11
 ud_2                 3.667558e-02 1 1  ON 12
 ud_3                -4.887803e-02 1 1  ON 13
 ud_4                -1.002517e-01 1 1  ON 14
 ud_5                -1.351707e-01 1 1  ON 15
 ud_6                -1.582013e-01 1 1  ON 16
 ud_7                -1.698043e-01 1 1  ON 17
 ud_8                -1.668747e-01 1 1  ON 18
 ud_9                -1.449801e-01 1 1  ON 19
 eC_0                -6.978176e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159479e-01 1 1  ON 22
 eC_3                 7.975901e-03 1 1  ON 23
 eC_4                 1.556474e-01 1 1  ON 24
 eC_5                 2.777938e-01 1 1  ON 25
 eC_6                 2.983967e-01 1 1  ON 26
 eC_7                 3.664639e-01 1 1  ON 27
 eC_8                 2.775716e-01 1 1  ON 28
 eC_9                 5.084733e-02 1 1  ON 29
 eO_0                -1.244612e+00 1 1  ON 30
 eO_1                -8.515366e-01 1 1  ON 31
 eO_2                -3.588163e-01 1 1  ON 32
 eO_3                -3.145810e-02 1 1  ON 33
 eO_4                 1.975750e-01 1 1  ON 34
 eO_5                 3.457451e-01 1 1  ON 35
 eO_6                 3.960464e-01 1 1  ON 36
 eO_7                 4.470453e-01 1 1  ON 37
 eO_8                 5.325689e-01 1 1  ON 38
 eO_9                 4.019256e-01 1 1  ON 39
eH1_0                -1.621505e-01 1 1  ON 40
eH1_1                -6.174126e-02 1 1  ON 41
eH1_2                -4.147138e-02 1 1  ON 42
eH1_3                -3.994625e-02 1 1  ON 43
eH1_4                -2.207911e-03 1 1  ON 44
eH1_5                 1.034313e-02 1 1  ON 45
eH1_6                 4.266234e-02 1 1  ON 46
eH1_7                 5.927002e-02 1 1  ON 47
eH1_8                 3.451664e-02 1 1  ON 48
eH1_9                 6.046236e-02 1 1  ON 49
eH2_0                -1.731539e-01 1 1  ON 50
eH2_1                -7.337373e-02 1 1  ON 51
eH2_2                -5.334267e-02 1 1  ON 52
eH2_3                -5.229593e-02 1 1  ON 53
eH2_4                -1.448151e-02 1 1  ON 54
eH2_5                -2.552521e-03 1 1  ON 55
eH2_6                 3.051757e-02 1 1  ON 56
eH2_7                 4.664129e-02 1 1  ON 57
eH2_8                 2.702689e-02 1 1  ON 58
eH2_9                 1.141870e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.4587
    reference variance = 0.470497
====================================================
  Execution time = 4.3414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5813e-01
  Total weights = 2.0000e+06
  Execution time = 3.5856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558072111961
                                         uncertainty =       0.003776816931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558072111961
                                         uncertainty =       0.003776816931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528267932
  error estimate for blocks of size 2^( 2) =       0.000548348975
  error estimate for blocks of size 2^( 3) =       0.000566828310
  error estimate for blocks of size 2^( 4) =       0.000582037887
  error estimate for blocks of size 2^( 5) =       0.000591428694
  error estimate for blocks of size 2^( 6) =       0.000597116882
  error estimate for blocks of size 2^( 7) =       0.000600174130

      target function =                  N/A
              le_mean =     -22.436989299009
             les_mean =     503.976622540769
             stat err =       0.000592689398
             autocorr =       1.258768370661
              std dev =       0.747083674020
             le_variance =       0.558134015988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558073511351
                                         uncertainty =       0.003776827312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558073511351
                                         uncertainty =       0.003776827312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528268594
  error estimate for blocks of size 2^( 2) =       0.000548349594
  error estimate for blocks of size 2^( 3) =       0.000566828887
  error estimate for blocks of size 2^( 4) =       0.000582038434
  error estimate for blocks of size 2^( 5) =       0.000591429216
  error estimate for blocks of size 2^( 6) =       0.000597117402
  error estimate for blocks of size 2^( 7) =       0.000600174666

      target function =                  N/A
              le_mean =     -22.436989302089
             les_mean =     503.976624078290
             stat err =       0.000592689930
             autocorr =       1.258767470812
              std dev =       0.747084610529
             le_variance =       0.558135415289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558072812456
                                         uncertainty =       0.003776822129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558072812456
                                         uncertainty =       0.003776822129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528268263
  error estimate for blocks of size 2^( 2) =       0.000548349285
  error estimate for blocks of size 2^( 3) =       0.000566828599
  error estimate for blocks of size 2^( 4) =       0.000582038161
  error estimate for blocks of size 2^( 5) =       0.000591428955
  error estimate for blocks of size 2^( 6) =       0.000597117142
  error estimate for blocks of size 2^( 7) =       0.000600174399

      target function =                  N/A
              le_mean =     -22.436989300552
             les_mean =     503.976623310447
             stat err =       0.000592689664
             autocorr =       1.258767920336
              std dev =       0.747084142810
             le_variance =       0.558134716438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558072199547
                                         uncertainty =       0.003776817581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558072199547
                                         uncertainty =       0.003776817581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528267973
  error estimate for blocks of size 2^( 2) =       0.000548349014
  error estimate for blocks of size 2^( 3) =       0.000566828347
  error estimate for blocks of size 2^( 4) =       0.000582037921
  error estimate for blocks of size 2^( 5) =       0.000591428727
  error estimate for blocks of size 2^( 6) =       0.000597116914
  error estimate for blocks of size 2^( 7) =       0.000600174164

      target function =                  N/A
              le_mean =     -22.436989299202
             les_mean =     503.976622637002
             stat err =       0.000592689432
             autocorr =       1.258768314359
              std dev =       0.747083732635
             le_variance =       0.558134103568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436989299009        initial
     2.3842e+02     2.3842e+03             9.3530e-07       -22.436989302089  <--
     9.5367e+02     9.5367e+03             2.3386e-07       -22.436989300552
     3.8147e+03     3.8147e+04             5.8468e-08       -22.436989299202

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 6.1356e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.683847e-01 1 1  ON 0
 uu_1                 9.271794e-02 1 1  ON 1
 uu_2                -2.409958e-02 1 1  ON 2
 uu_3                -9.510638e-02 1 1  ON 3
 uu_4                -1.375633e-01 1 1  ON 4
 uu_5                -1.639791e-01 1 1  ON 5
 uu_6                -1.782723e-01 1 1  ON 6
 uu_7                -1.811380e-01 1 1  ON 7
 uu_8                -1.704087e-01 1 1  ON 8
 uu_9                -1.419269e-01 1 1  ON 9
 ud_0                 4.719109e-01 1 1  ON 10
 ud_1                 1.876747e-01 1 1  ON 11
 ud_2                 3.667542e-02 1 1  ON 12
 ud_3                -4.887794e-02 1 1  ON 13
 ud_4                -1.002518e-01 1 1  ON 14
 ud_5                -1.351706e-01 1 1  ON 15
 ud_6                -1.582010e-01 1 1  ON 16
 ud_7                -1.698042e-01 1 1  ON 17
 ud_8                -1.668743e-01 1 1  ON 18
 ud_9                -1.449804e-01 1 1  ON 19
 eC_0                -6.978173e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159480e-01 1 1  ON 22
 eC_3                 7.976034e-03 1 1  ON 23
 eC_4                 1.556472e-01 1 1  ON 24
 eC_5                 2.777938e-01 1 1  ON 25
 eC_6                 2.983967e-01 1 1  ON 26
 eC_7                 3.664635e-01 1 1  ON 27
 eC_8                 2.775717e-01 1 1  ON 28
 eC_9                 5.084746e-02 1 1  ON 29
 eO_0                -1.244612e+00 1 1  ON 30
 eO_1                -8.515364e-01 1 1  ON 31
 eO_2                -3.588158e-01 1 1  ON 32
 eO_3                -3.145846e-02 1 1  ON 33
 eO_4                 1.975751e-01 1 1  ON 34
 eO_5                 3.457454e-01 1 1  ON 35
 eO_6                 3.960463e-01 1 1  ON 36
 eO_7                 4.470452e-01 1 1  ON 37
 eO_8                 5.325682e-01 1 1  ON 38
 eO_9                 4.019259e-01 1 1  ON 39
eH1_0                -1.621502e-01 1 1  ON 40
eH1_1                -6.174072e-02 1 1  ON 41
eH1_2                -4.147155e-02 1 1  ON 42
eH1_3                -3.994648e-02 1 1  ON 43
eH1_4                -2.207888e-03 1 1  ON 44
eH1_5                 1.034296e-02 1 1  ON 45
eH1_6                 4.266248e-02 1 1  ON 46
eH1_7                 5.926932e-02 1 1  ON 47
eH1_8                 3.451683e-02 1 1  ON 48
eH1_9                 6.046227e-02 1 1  ON 49
eH2_0                -1.731539e-01 1 1  ON 50
eH2_1                -7.337403e-02 1 1  ON 51
eH2_2                -5.334249e-02 1 1  ON 52
eH2_3                -5.229576e-02 1 1  ON 53
eH2_4                -1.448139e-02 1 1  ON 54
eH2_5                -2.552089e-03 1 1  ON 55
eH2_6                 3.051756e-02 1 1  ON 56
eH2_7                 4.664098e-02 1 1  ON 57
eH2_8                 2.702688e-02 1 1  ON 58
eH2_9                 1.141867e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2106e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2446e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.5078
    reference variance = 0.537517
====================================================
  Execution time = 4.3898e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7201e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5039e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572078741551
                                         uncertainty =       0.005506997267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572078741551
                                         uncertainty =       0.005506997267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534796123
  error estimate for blocks of size 2^( 2) =       0.000554789858
  error estimate for blocks of size 2^( 3) =       0.000573542456
  error estimate for blocks of size 2^( 4) =       0.000587800540
  error estimate for blocks of size 2^( 5) =       0.000595614085
  error estimate for blocks of size 2^( 6) =       0.000599779852
  error estimate for blocks of size 2^( 7) =       0.000602488192

      target function =                  N/A
              le_mean =     -22.438416839750
             les_mean =     504.054563775636
             stat err =       0.000596420667
             autocorr =       1.243737896936
              std dev =       0.756315930848
             le_variance =       0.572013787255


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243841683975e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438416839750       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438416848661       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438416861412       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438416860036       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438416878924       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438416880933       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438416875604       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438416871292       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438416875191       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438416876404       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+01 is 3.616305e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438416839750       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438416841982       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438416845186       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438416844829       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438416849565       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438416850083       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438416848742       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438416847639       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438416848609       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438416848917       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+02 is 9.106519e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438416839750       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438416840309       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438416841110       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438416841020       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438416842205       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438416842336       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438416842000       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438416841723       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438416841963       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438416842039       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+02 is 2.280768e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.490720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8944e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.683848e-01 1 1  ON 0
 uu_1                 9.271797e-02 1 1  ON 1
 uu_2                -2.409935e-02 1 1  ON 2
 uu_3                -9.510596e-02 1 1  ON 3
 uu_4                -1.375634e-01 1 1  ON 4
 uu_5                -1.639786e-01 1 1  ON 5
 uu_6                -1.782727e-01 1 1  ON 6
 uu_7                -1.811384e-01 1 1  ON 7
 uu_8                -1.704089e-01 1 1  ON 8
 uu_9                -1.419267e-01 1 1  ON 9
 ud_0                 4.719118e-01 1 1  ON 10
 ud_1                 1.876743e-01 1 1  ON 11
 ud_2                 3.667500e-02 1 1  ON 12
 ud_3                -4.887820e-02 1 1  ON 13
 ud_4                -1.002519e-01 1 1  ON 14
 ud_5                -1.351705e-01 1 1  ON 15
 ud_6                -1.582005e-01 1 1  ON 16
 ud_7                -1.698041e-01 1 1  ON 17
 ud_8                -1.668736e-01 1 1  ON 18
 ud_9                -1.449803e-01 1 1  ON 19
 eC_0                -6.978167e-01 1 1  ON 20
 eC_1                -5.224843e-01 1 1  ON 21
 eC_2                -2.159482e-01 1 1  ON 22
 eC_3                 7.976076e-03 1 1  ON 23
 eC_4                 1.556468e-01 1 1  ON 24
 eC_5                 2.777934e-01 1 1  ON 25
 eC_6                 2.983968e-01 1 1  ON 26
 eC_7                 3.664631e-01 1 1  ON 27
 eC_8                 2.775721e-01 1 1  ON 28
 eC_9                 5.084766e-02 1 1  ON 29
 eO_0                -1.244613e+00 1 1  ON 30
 eO_1                -8.515357e-01 1 1  ON 31
 eO_2                -3.588150e-01 1 1  ON 32
 eO_3                -3.145882e-02 1 1  ON 33
 eO_4                 1.975753e-01 1 1  ON 34
 eO_5                 3.457451e-01 1 1  ON 35
 eO_6                 3.960463e-01 1 1  ON 36
 eO_7                 4.470448e-01 1 1  ON 37
 eO_8                 5.325673e-01 1 1  ON 38
 eO_9                 4.019264e-01 1 1  ON 39
eH1_0                -1.621499e-01 1 1  ON 40
eH1_1                -6.174070e-02 1 1  ON 41
eH1_2                -4.147197e-02 1 1  ON 42
eH1_3                -3.994607e-02 1 1  ON 43
eH1_4                -2.208205e-03 1 1  ON 44
eH1_5                 1.034250e-02 1 1  ON 45
eH1_6                 4.266256e-02 1 1  ON 46
eH1_7                 5.926863e-02 1 1  ON 47
eH1_8                 3.451721e-02 1 1  ON 48
eH1_9                 6.046253e-02 1 1  ON 49
eH2_0                -1.731545e-01 1 1  ON 50
eH2_1                -7.337403e-02 1 1  ON 51
eH2_2                -5.334177e-02 1 1  ON 52
eH2_3                -5.229554e-02 1 1  ON 53
eH2_4                -1.448112e-02 1 1  ON 54
eH2_5                -2.552191e-03 1 1  ON 55
eH2_6                 3.051695e-02 1 1  ON 56
eH2_7                 4.664094e-02 1 1  ON 57
eH2_8                 2.702728e-02 1 1  ON 58
eH2_9                 1.141862e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.4525
    reference variance = 0.337723
====================================================
  Execution time = 4.3274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6165e-01
  Total weights = 2.0000e+06
  Execution time = 3.7841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561749396721
                                         uncertainty =       0.005132301887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561749396721
                                         uncertainty =       0.005132301887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529929530
  error estimate for blocks of size 2^( 2) =       0.000549815091
  error estimate for blocks of size 2^( 3) =       0.000568363535
  error estimate for blocks of size 2^( 4) =       0.000582249023
  error estimate for blocks of size 2^( 5) =       0.000590841528
  error estimate for blocks of size 2^( 6) =       0.000595820998
  error estimate for blocks of size 2^( 7) =       0.000597923709

      target function =                  N/A
              le_mean =     -22.437455608453
             les_mean =     504.001064513849
             stat err =       0.000591708814
             autocorr =       1.246751317524
              std dev =       0.749433528329
             le_variance =       0.561650613383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561755661583
                                         uncertainty =       0.005132397879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561755661583
                                         uncertainty =       0.005132397879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529932485
  error estimate for blocks of size 2^( 2) =       0.000549817857
  error estimate for blocks of size 2^( 3) =       0.000568366157
  error estimate for blocks of size 2^( 4) =       0.000582251552
  error estimate for blocks of size 2^( 5) =       0.000590843955
  error estimate for blocks of size 2^( 6) =       0.000595823238
  error estimate for blocks of size 2^( 7) =       0.000597925930

      target function =                  N/A
              le_mean =     -22.437455653522
             les_mean =     504.001072799402
             stat err =       0.000591711169
             autocorr =       1.246747336210
              std dev =       0.749437706860
             le_variance =       0.561656876463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561752546910
                                         uncertainty =       0.005132350145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561752546910
                                         uncertainty =       0.005132350145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529931016
  error estimate for blocks of size 2^( 2) =       0.000549816482
  error estimate for blocks of size 2^( 3) =       0.000568364854
  error estimate for blocks of size 2^( 4) =       0.000582250295
  error estimate for blocks of size 2^( 5) =       0.000590842748
  error estimate for blocks of size 2^( 6) =       0.000595822125
  error estimate for blocks of size 2^( 7) =       0.000597924826

      target function =                  N/A
              le_mean =     -22.437455631060
             les_mean =     504.001068677652
             stat err =       0.000591709999
             autocorr =       1.246749316495
              std dev =       0.749435629441
             le_variance =       0.561653762675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561749791036
                                         uncertainty =       0.005132307927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561749791036
                                         uncertainty =       0.005132307927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529929716
  error estimate for blocks of size 2^( 2) =       0.000549815265
  error estimate for blocks of size 2^( 3) =       0.000568363700
  error estimate for blocks of size 2^( 4) =       0.000582249182
  error estimate for blocks of size 2^( 5) =       0.000590841681
  error estimate for blocks of size 2^( 6) =       0.000595821139
  error estimate for blocks of size 2^( 7) =       0.000597923849

      target function =                  N/A
              le_mean =     -22.437455611279
             les_mean =     504.001065034876
             stat err =       0.000591708963
             autocorr =       1.246751067069
              std dev =       0.749433791329
             le_variance =       0.561651007586


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437455608453        initial
     5.9605e+01     5.9605e+02             3.6163e-06       -22.437455653522  <--
     2.3842e+02     2.3842e+03             9.1065e-07       -22.437455631060
     9.5367e+02     9.5367e+03             2.2808e-07       -22.437455611279

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 6.1938e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.683849e-01 1 1  ON 0
 uu_1                 9.271806e-02 1 1  ON 1
 uu_2                -2.409865e-02 1 1  ON 2
 uu_3                -9.510470e-02 1 1  ON 3
 uu_4                -1.375635e-01 1 1  ON 4
 uu_5                -1.639771e-01 1 1  ON 5
 uu_6                -1.782738e-01 1 1  ON 6
 uu_7                -1.811397e-01 1 1  ON 7
 uu_8                -1.704093e-01 1 1  ON 8
 uu_9                -1.419263e-01 1 1  ON 9
 ud_0                 4.719145e-01 1 1  ON 10
 ud_1                 1.876730e-01 1 1  ON 11
 ud_2                 3.667376e-02 1 1  ON 12
 ud_3                -4.887897e-02 1 1  ON 13
 ud_4                -1.002520e-01 1 1  ON 14
 ud_5                -1.351700e-01 1 1  ON 15
 ud_6                -1.581991e-01 1 1  ON 16
 ud_7                -1.698037e-01 1 1  ON 17
 ud_8                -1.668717e-01 1 1  ON 18
 ud_9                -1.449801e-01 1 1  ON 19
 eC_0                -6.978149e-01 1 1  ON 20
 eC_1                -5.224844e-01 1 1  ON 21
 eC_2                -2.159488e-01 1 1  ON 22
 eC_3                 7.976200e-03 1 1  ON 23
 eC_4                 1.556458e-01 1 1  ON 24
 eC_5                 2.777924e-01 1 1  ON 25
 eC_6                 2.983970e-01 1 1  ON 26
 eC_7                 3.664620e-01 1 1  ON 27
 eC_8                 2.775732e-01 1 1  ON 28
 eC_9                 5.084826e-02 1 1  ON 29
 eO_0                -1.244615e+00 1 1  ON 30
 eO_1                -8.515335e-01 1 1  ON 31
 eO_2                -3.588127e-01 1 1  ON 32
 eO_3                -3.145990e-02 1 1  ON 33
 eO_4                 1.975756e-01 1 1  ON 34
 eO_5                 3.457442e-01 1 1  ON 35
 eO_6                 3.960464e-01 1 1  ON 36
 eO_7                 4.470435e-01 1 1  ON 37
 eO_8                 5.325648e-01 1 1  ON 38
 eO_9                 4.019279e-01 1 1  ON 39
eH1_0                -1.621489e-01 1 1  ON 40
eH1_1                -6.174062e-02 1 1  ON 41
eH1_2                -4.147322e-02 1 1  ON 42
eH1_3                -3.994486e-02 1 1  ON 43
eH1_4                -2.209149e-03 1 1  ON 44
eH1_5                 1.034112e-02 1 1  ON 45
eH1_6                 4.266281e-02 1 1  ON 46
eH1_7                 5.926657e-02 1 1  ON 47
eH1_8                 3.451833e-02 1 1  ON 48
eH1_9                 6.046332e-02 1 1  ON 49
eH2_0                -1.731563e-01 1 1  ON 50
eH2_1                -7.337402e-02 1 1  ON 51
eH2_2                -5.333961e-02 1 1  ON 52
eH2_3                -5.229489e-02 1 1  ON 53
eH2_4                -1.448033e-02 1 1  ON 54
eH2_5                -2.552496e-03 1 1  ON 55
eH2_6                 3.051515e-02 1 1  ON 56
eH2_7                 4.664081e-02 1 1  ON 57
eH2_8                 2.702846e-02 1 1  ON 58
eH2_9                 1.141849e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2089e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2447e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.5197
    reference variance = 0.518383
====================================================
  Execution time = 4.4071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4940e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574565872638
                                         uncertainty =       0.007846220944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574565872638
                                         uncertainty =       0.007846220944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535964321
  error estimate for blocks of size 2^( 2) =       0.000556008371
  error estimate for blocks of size 2^( 3) =       0.000574001376
  error estimate for blocks of size 2^( 4) =       0.000588748397
  error estimate for blocks of size 2^( 5) =       0.000597446580
  error estimate for blocks of size 2^( 6) =       0.000604051416
  error estimate for blocks of size 2^( 7) =       0.000607702861

      target function =                  N/A
              le_mean =     -22.436363279357
             les_mean =     503.964912422822
             stat err =       0.000599487314
             autocorr =       1.251089082874
              std dev =       0.757968011725
             le_variance =       0.574515506798


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243636327936e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436363279357       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436363302471       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436363305604       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436363283314       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436363296797       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436363323693       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436363325328       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436363321327       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436363306900       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436363312339       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436363315472       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+01 is 1.783637e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436363279357       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436363285189       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436363286001       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436363280288       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436363283571       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436363290341       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436363290839       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436363289849       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436363286183       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436363287490       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+01 is 4.417472e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436363279357       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436363280819       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436363281023       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436363279586       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436363280401       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436363282095       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436363282226       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436363281980       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436363281060       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436363281383       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+02 is 1.105261e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.494591 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9019e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.683863e-01 1 1  ON 0
 uu_1                 9.271667e-02 1 1  ON 1
 uu_2                -2.409831e-02 1 1  ON 2
 uu_3                -9.510399e-02 1 1  ON 3
 uu_4                -1.375626e-01 1 1  ON 4
 uu_5                -1.639766e-01 1 1  ON 5
 uu_6                -1.782740e-01 1 1  ON 6
 uu_7                -1.811424e-01 1 1  ON 7
 uu_8                -1.704097e-01 1 1  ON 8
 uu_9                -1.419248e-01 1 1  ON 9
 ud_0                 4.719168e-01 1 1  ON 10
 ud_1                 1.876718e-01 1 1  ON 11
 ud_2                 3.667184e-02 1 1  ON 12
 ud_3                -4.888029e-02 1 1  ON 13
 ud_4                -1.002518e-01 1 1  ON 14
 ud_5                -1.351709e-01 1 1  ON 15
 ud_6                -1.581985e-01 1 1  ON 16
 ud_7                -1.698017e-01 1 1  ON 17
 ud_8                -1.668702e-01 1 1  ON 18
 ud_9                -1.449782e-01 1 1  ON 19
 eC_0                -6.978134e-01 1 1  ON 20
 eC_1                -5.224841e-01 1 1  ON 21
 eC_2                -2.159459e-01 1 1  ON 22
 eC_3                 7.972954e-03 1 1  ON 23
 eC_4                 1.556452e-01 1 1  ON 24
 eC_5                 2.777908e-01 1 1  ON 25
 eC_6                 2.983959e-01 1 1  ON 26
 eC_7                 3.664608e-01 1 1  ON 27
 eC_8                 2.775752e-01 1 1  ON 28
 eC_9                 5.084925e-02 1 1  ON 29
 eO_0                -1.244614e+00 1 1  ON 30
 eO_1                -8.515320e-01 1 1  ON 31
 eO_2                -3.588100e-01 1 1  ON 32
 eO_3                -3.146250e-02 1 1  ON 33
 eO_4                 1.975723e-01 1 1  ON 34
 eO_5                 3.457439e-01 1 1  ON 35
 eO_6                 3.960469e-01 1 1  ON 36
 eO_7                 4.470430e-01 1 1  ON 37
 eO_8                 5.325618e-01 1 1  ON 38
 eO_9                 4.019300e-01 1 1  ON 39
eH1_0                -1.621471e-01 1 1  ON 40
eH1_1                -6.173904e-02 1 1  ON 41
eH1_2                -4.147382e-02 1 1  ON 42
eH1_3                -3.994497e-02 1 1  ON 43
eH1_4                -2.207691e-03 1 1  ON 44
eH1_5                 1.033985e-02 1 1  ON 45
eH1_6                 4.266267e-02 1 1  ON 46
eH1_7                 5.926216e-02 1 1  ON 47
eH1_8                 3.451863e-02 1 1  ON 48
eH1_9                 6.046383e-02 1 1  ON 49
eH2_0                -1.731579e-01 1 1  ON 50
eH2_1                -7.337393e-02 1 1  ON 51
eH2_2                -5.334017e-02 1 1  ON 52
eH2_3                -5.229484e-02 1 1  ON 53
eH2_4                -1.447938e-02 1 1  ON 54
eH2_5                -2.550696e-03 1 1  ON 55
eH2_6                 3.051535e-02 1 1  ON 56
eH2_7                 4.663833e-02 1 1  ON 57
eH2_8                 2.702959e-02 1 1  ON 58
eH2_9                 1.141842e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.4402
    reference variance = 0.32429
====================================================
  Execution time = 4.3254e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6516e-01
  Total weights = 2.0000e+06
  Execution time = 3.5828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565030666112
                                         uncertainty =       0.003564049731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565030666112
                                         uncertainty =       0.003564049731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531581835
  error estimate for blocks of size 2^( 2) =       0.000551607185
  error estimate for blocks of size 2^( 3) =       0.000570248460
  error estimate for blocks of size 2^( 4) =       0.000584208920
  error estimate for blocks of size 2^( 5) =       0.000593674490
  error estimate for blocks of size 2^( 6) =       0.000597527126
  error estimate for blocks of size 2^( 7) =       0.000598838537

      target function =                  N/A
              le_mean =     -22.436681846580
             les_mean =     503.969850497628
             stat err =       0.000593562268
             autocorr =       1.246787118693
              std dev =       0.751770241202
             le_variance =       0.565158495558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565049763921
                                         uncertainty =       0.003564136608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565049763921
                                         uncertainty =       0.003564136608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531590830
  error estimate for blocks of size 2^( 2) =       0.000551615558
  error estimate for blocks of size 2^( 3) =       0.000570256456
  error estimate for blocks of size 2^( 4) =       0.000584216795
  error estimate for blocks of size 2^( 5) =       0.000593682374
  error estimate for blocks of size 2^( 6) =       0.000597534811
  error estimate for blocks of size 2^( 7) =       0.000598846625

      target function =                  N/A
              le_mean =     -22.436681889864
             les_mean =     503.969871565295
             stat err =       0.000593570151
             autocorr =       1.246778043723
              std dev =       0.751782961320
             le_variance =       0.565177620932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565040573830
                                         uncertainty =       0.003564095420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565040573830
                                         uncertainty =       0.003564095420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531586502
  error estimate for blocks of size 2^( 2) =       0.000551611532
  error estimate for blocks of size 2^( 3) =       0.000570252609
  error estimate for blocks of size 2^( 4) =       0.000584213005
  error estimate for blocks of size 2^( 5) =       0.000593678580
  error estimate for blocks of size 2^( 6) =       0.000597531115
  error estimate for blocks of size 2^( 7) =       0.000598842725

      target function =                  N/A
              le_mean =     -22.436681869437
             les_mean =     503.969861445107
             stat err =       0.000593566356
             autocorr =       1.246782405112
              std dev =       0.751776840128
             le_variance =       0.565168417353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565031912193
                                         uncertainty =       0.003564055482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565031912193
                                         uncertainty =       0.003564055482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531582422
  error estimate for blocks of size 2^( 2) =       0.000551607732
  error estimate for blocks of size 2^( 3) =       0.000570248981
  error estimate for blocks of size 2^( 4) =       0.000584209434
  error estimate for blocks of size 2^( 5) =       0.000593675004
  error estimate for blocks of size 2^( 6) =       0.000597527627
  error estimate for blocks of size 2^( 7) =       0.000598839063

      target function =                  N/A
              le_mean =     -22.436681849409
             les_mean =     503.969851872420
             stat err =       0.000593562782
             autocorr =       1.246786525627
              std dev =       0.751771071143
             le_variance =       0.565159743407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436681846580        initial
     1.4901e+01     1.4901e+02             1.7836e-05       -22.436681889864  <--
     5.9605e+01     5.9605e+02             4.4175e-06       -22.436681869437
     2.3842e+02     2.3842e+03             1.1053e-06       -22.436681849409

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 6.1175e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.683904e-01 1 1  ON 0
 uu_1                 9.271279e-02 1 1  ON 1
 uu_2                -2.409750e-02 1 1  ON 2
 uu_3                -9.510201e-02 1 1  ON 3
 uu_4                -1.375599e-01 1 1  ON 4
 uu_5                -1.639752e-01 1 1  ON 5
 uu_6                -1.782743e-01 1 1  ON 6
 uu_7                -1.811502e-01 1 1  ON 7
 uu_8                -1.704111e-01 1 1  ON 8
 uu_9                -1.419204e-01 1 1  ON 9
 ud_0                 4.719231e-01 1 1  ON 10
 ud_1                 1.876685e-01 1 1  ON 11
 ud_2                 3.666617e-02 1 1  ON 12
 ud_3                -4.888386e-02 1 1  ON 13
 ud_4                -1.002510e-01 1 1  ON 14
 ud_5                -1.351735e-01 1 1  ON 15
 ud_6                -1.581965e-01 1 1  ON 16
 ud_7                -1.697957e-01 1 1  ON 17
 ud_8                -1.668657e-01 1 1  ON 18
 ud_9                -1.449725e-01 1 1  ON 19
 eC_0                -6.978086e-01 1 1  ON 20
 eC_1                -5.224831e-01 1 1  ON 21
 eC_2                -2.159377e-01 1 1  ON 22
 eC_3                 7.963590e-03 1 1  ON 23
 eC_4                 1.556431e-01 1 1  ON 24
 eC_5                 2.777863e-01 1 1  ON 25
 eC_6                 2.983924e-01 1 1  ON 26
 eC_7                 3.664568e-01 1 1  ON 27
 eC_8                 2.775816e-01 1 1  ON 28
 eC_9                 5.085238e-02 1 1  ON 29
 eO_0                -1.244612e+00 1 1  ON 30
 eO_1                -8.515272e-01 1 1  ON 31
 eO_2                -3.588018e-01 1 1  ON 32
 eO_3                -3.147022e-02 1 1  ON 33
 eO_4                 1.975625e-01 1 1  ON 34
 eO_5                 3.457427e-01 1 1  ON 35
 eO_6                 3.960481e-01 1 1  ON 36
 eO_7                 4.470413e-01 1 1  ON 37
 eO_8                 5.325520e-01 1 1  ON 38
 eO_9                 4.019366e-01 1 1  ON 39
eH1_0                -1.621416e-01 1 1  ON 40
eH1_1                -6.173467e-02 1 1  ON 41
eH1_2                -4.147571e-02 1 1  ON 42
eH1_3                -3.994498e-02 1 1  ON 43
eH1_4                -2.203415e-03 1 1  ON 44
eH1_5                 1.033593e-02 1 1  ON 45
eH1_6                 4.266246e-02 1 1  ON 46
eH1_7                 5.924874e-02 1 1  ON 47
eH1_8                 3.451960e-02 1 1  ON 48
eH1_9                 6.046538e-02 1 1  ON 49
eH2_0                -1.731629e-01 1 1  ON 50
eH2_1                -7.337385e-02 1 1  ON 51
eH2_2                -5.334215e-02 1 1  ON 52
eH2_3                -5.229435e-02 1 1  ON 53
eH2_4                -1.447653e-02 1 1  ON 54
eH2_5                -2.545284e-03 1 1  ON 55
eH2_6                 3.051610e-02 1 1  ON 56
eH2_7                 4.663080e-02 1 1  ON 57
eH2_8                 2.703316e-02 1 1  ON 58
eH2_9                 1.141820e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2020e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2448e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.4222
    reference variance = 0.737959
====================================================
  Execution time = 4.3871e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5948e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4979e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559387313827
                                         uncertainty =       0.003278574696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559387313827
                                         uncertainty =       0.003278574696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528905082
  error estimate for blocks of size 2^( 2) =       0.000548731405
  error estimate for blocks of size 2^( 3) =       0.000566691259
  error estimate for blocks of size 2^( 4) =       0.000580884787
  error estimate for blocks of size 2^( 5) =       0.000589522756
  error estimate for blocks of size 2^( 6) =       0.000593525226
  error estimate for blocks of size 2^( 7) =       0.000595229296

      target function =                  N/A
              le_mean =     -22.436437753030
             les_mean =     503.953219937492
             stat err =       0.000589790516
             autocorr =       1.243483679753
              std dev =       0.747984740262
             le_variance =       0.559481171665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243643775303e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436437753030       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436437820579       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436437959825       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436438084996       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436438191523       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436438071244       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436438140646       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436438131234       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436438121049       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436438142736       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+00 is 6.172461e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436437753030       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436437770685       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436437807286       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436437840065       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436437869866       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436437838411       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436437854087       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436437851834       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436437849181       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436437854683       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+01 is 1.562729e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436437753030       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436437757494       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436437766767       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436437775067       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436437782725       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436437774769       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436437778556       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436437778001       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436437777322       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436437778699       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+01 is 3.918979e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.498241 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8858e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.683905e-01 1 1  ON 0
 uu_1                 9.271773e-02 1 1  ON 1
 uu_2                -2.409711e-02 1 1  ON 2
 uu_3                -9.510133e-02 1 1  ON 3
 uu_4                -1.375614e-01 1 1  ON 4
 uu_5                -1.639718e-01 1 1  ON 5
 uu_6                -1.782774e-01 1 1  ON 6
 uu_7                -1.811440e-01 1 1  ON 7
 uu_8                -1.704116e-01 1 1  ON 8
 uu_9                -1.419211e-01 1 1  ON 9
 ud_0                 4.719295e-01 1 1  ON 10
 ud_1                 1.876719e-01 1 1  ON 11
 ud_2                 3.665919e-02 1 1  ON 12
 ud_3                -4.888463e-02 1 1  ON 13
 ud_4                -1.002479e-01 1 1  ON 14
 ud_5                -1.351741e-01 1 1  ON 15
 ud_6                -1.582018e-01 1 1  ON 16
 ud_7                -1.697811e-01 1 1  ON 17
 ud_8                -1.668625e-01 1 1  ON 18
 ud_9                -1.449720e-01 1 1  ON 19
 eC_0                -6.977989e-01 1 1  ON 20
 eC_1                -5.224819e-01 1 1  ON 21
 eC_2                -2.159396e-01 1 1  ON 22
 eC_3                 7.967799e-03 1 1  ON 23
 eC_4                 1.556432e-01 1 1  ON 24
 eC_5                 2.777777e-01 1 1  ON 25
 eC_6                 2.983843e-01 1 1  ON 26
 eC_7                 3.664493e-01 1 1  ON 27
 eC_8                 2.775884e-01 1 1  ON 28
 eC_9                 5.085654e-02 1 1  ON 29
 eO_0                -1.244618e+00 1 1  ON 30
 eO_1                -8.515333e-01 1 1  ON 31
 eO_2                -3.587919e-01 1 1  ON 32
 eO_3                -3.147168e-02 1 1  ON 33
 eO_4                 1.975719e-01 1 1  ON 34
 eO_5                 3.457406e-01 1 1  ON 35
 eO_6                 3.960477e-01 1 1  ON 36
 eO_7                 4.470417e-01 1 1  ON 37
 eO_8                 5.325364e-01 1 1  ON 38
 eO_9                 4.019418e-01 1 1  ON 39
eH1_0                -1.621440e-01 1 1  ON 40
eH1_1                -6.172977e-02 1 1  ON 41
eH1_2                -4.147187e-02 1 1  ON 42
eH1_3                -3.994685e-02 1 1  ON 43
eH1_4                -2.207829e-03 1 1  ON 44
eH1_5                 1.032719e-02 1 1  ON 45
eH1_6                 4.267320e-02 1 1  ON 46
eH1_7                 5.923327e-02 1 1  ON 47
eH1_8                 3.452596e-02 1 1  ON 48
eH1_9                 6.046804e-02 1 1  ON 49
eH2_0                -1.731582e-01 1 1  ON 50
eH2_1                -7.336437e-02 1 1  ON 51
eH2_2                -5.333786e-02 1 1  ON 52
eH2_3                -5.229026e-02 1 1  ON 53
eH2_4                -1.447547e-02 1 1  ON 54
eH2_5                -2.548049e-03 1 1  ON 55
eH2_6                 3.051081e-02 1 1  ON 56
eH2_7                 4.661989e-02 1 1  ON 57
eH2_8                 2.703054e-02 1 1  ON 58
eH2_9                 1.141757e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.4514
    reference variance = 0.650509
====================================================
  Execution time = 4.3831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6306e-01
  Total weights = 2.0000e+06
  Execution time = 3.5752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563063590144
                                         uncertainty =       0.004815813706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563063590144
                                         uncertainty =       0.004815813706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530585647
  error estimate for blocks of size 2^( 2) =       0.000549960946
  error estimate for blocks of size 2^( 3) =       0.000568364845
  error estimate for blocks of size 2^( 4) =       0.000581399478
  error estimate for blocks of size 2^( 5) =       0.000589928700
  error estimate for blocks of size 2^( 6) =       0.000593754880
  error estimate for blocks of size 2^( 7) =       0.000595425406

      target function =                  N/A
              le_mean =     -22.437824778516
             les_mean =     504.019022767404
             stat err =       0.000590127116
             autocorr =       1.237029756581
              std dev =       0.750361417938
             le_variance =       0.563042257531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563129969588
                                         uncertainty =       0.004816886450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563129969588
                                         uncertainty =       0.004816886450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530616926
  error estimate for blocks of size 2^( 2) =       0.000549989563
  error estimate for blocks of size 2^( 3) =       0.000568390872
  error estimate for blocks of size 2^( 4) =       0.000581424163
  error estimate for blocks of size 2^( 5) =       0.000589952162
  error estimate for blocks of size 2^( 6) =       0.000593777524
  error estimate for blocks of size 2^( 7) =       0.000595447903

      target function =                  N/A
              le_mean =     -22.437824764422
             les_mean =     504.019088520936
             stat err =       0.000590150438
             autocorr =       1.236981685277
              std dev =       0.750405652689
             le_variance =       0.563108643587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563099214479
                                         uncertainty =       0.004816396452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563099214479
                                         uncertainty =       0.004816396452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530602434
  error estimate for blocks of size 2^( 2) =       0.000549976299
  error estimate for blocks of size 2^( 3) =       0.000568378802
  error estimate for blocks of size 2^( 4) =       0.000581412733
  error estimate for blocks of size 2^( 5) =       0.000589941297
  error estimate for blocks of size 2^( 6) =       0.000593767023
  error estimate for blocks of size 2^( 7) =       0.000595437447

      target function =                  N/A
              le_mean =     -22.437824770368
             les_mean =     504.019058029611
             stat err =       0.000590139625
             autocorr =       1.237003924023
              std dev =       0.750385158042
             le_variance =       0.563077885409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563068124327
                                         uncertainty =       0.004815888230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563068124327
                                         uncertainty =       0.004815888230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530587784
  error estimate for blocks of size 2^( 2) =       0.000549962900
  error estimate for blocks of size 2^( 3) =       0.000568366620
  error estimate for blocks of size 2^( 4) =       0.000581401165
  error estimate for blocks of size 2^( 5) =       0.000589930303
  error estimate for blocks of size 2^( 6) =       0.000593756425
  error estimate for blocks of size 2^( 7) =       0.000595426937

      target function =                  N/A
              le_mean =     -22.437824777020
             les_mean =     504.019027234911
             stat err =       0.000590128707
             autocorr =       1.237026464329
              std dev =       0.750364439566
             le_variance =       0.563046792165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437824778516        initial  <--
     3.7253e+00     3.7253e+01             6.1725e-05       -22.437824764422
     1.4901e+01     1.4901e+02             1.5627e-05       -22.437824770368
     5.9605e+01     5.9605e+02             3.9190e-06       -22.437824777020

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.7466
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.683904e-01 1 1  ON 0
 uu_1                 9.271279e-02 1 1  ON 1
 uu_2                -2.409750e-02 1 1  ON 2
 uu_3                -9.510201e-02 1 1  ON 3
 uu_4                -1.375599e-01 1 1  ON 4
 uu_5                -1.639752e-01 1 1  ON 5
 uu_6                -1.782743e-01 1 1  ON 6
 uu_7                -1.811502e-01 1 1  ON 7
 uu_8                -1.704111e-01 1 1  ON 8
 uu_9                -1.419204e-01 1 1  ON 9
 ud_0                 4.719231e-01 1 1  ON 10
 ud_1                 1.876685e-01 1 1  ON 11
 ud_2                 3.666617e-02 1 1  ON 12
 ud_3                -4.888386e-02 1 1  ON 13
 ud_4                -1.002510e-01 1 1  ON 14
 ud_5                -1.351735e-01 1 1  ON 15
 ud_6                -1.581965e-01 1 1  ON 16
 ud_7                -1.697957e-01 1 1  ON 17
 ud_8                -1.668657e-01 1 1  ON 18
 ud_9                -1.449725e-01 1 1  ON 19
 eC_0                -6.978086e-01 1 1  ON 20
 eC_1                -5.224831e-01 1 1  ON 21
 eC_2                -2.159377e-01 1 1  ON 22
 eC_3                 7.963590e-03 1 1  ON 23
 eC_4                 1.556431e-01 1 1  ON 24
 eC_5                 2.777863e-01 1 1  ON 25
 eC_6                 2.983924e-01 1 1  ON 26
 eC_7                 3.664568e-01 1 1  ON 27
 eC_8                 2.775816e-01 1 1  ON 28
 eC_9                 5.085238e-02 1 1  ON 29
 eO_0                -1.244612e+00 1 1  ON 30
 eO_1                -8.515272e-01 1 1  ON 31
 eO_2                -3.588018e-01 1 1  ON 32
 eO_3                -3.147022e-02 1 1  ON 33
 eO_4                 1.975625e-01 1 1  ON 34
 eO_5                 3.457427e-01 1 1  ON 35
 eO_6                 3.960481e-01 1 1  ON 36
 eO_7                 4.470413e-01 1 1  ON 37
 eO_8                 5.325520e-01 1 1  ON 38
 eO_9                 4.019366e-01 1 1  ON 39
eH1_0                -1.621416e-01 1 1  ON 40
eH1_1                -6.173467e-02 1 1  ON 41
eH1_2                -4.147571e-02 1 1  ON 42
eH1_3                -3.994498e-02 1 1  ON 43
eH1_4                -2.203415e-03 1 1  ON 44
eH1_5                 1.033593e-02 1 1  ON 45
eH1_6                 4.266246e-02 1 1  ON 46
eH1_7                 5.924874e-02 1 1  ON 47
eH1_8                 3.451960e-02 1 1  ON 48
eH1_9                 6.046538e-02 1 1  ON 49
eH2_0                -1.731629e-01 1 1  ON 50
eH2_1                -7.337385e-02 1 1  ON 51
eH2_2                -5.334215e-02 1 1  ON 52
eH2_3                -5.229435e-02 1 1  ON 53
eH2_4                -1.447653e-02 1 1  ON 54
eH2_5                -2.545284e-03 1 1  ON 55
eH2_6                 3.051610e-02 1 1  ON 56
eH2_7                 4.663080e-02 1 1  ON 57
eH2_8                 2.703316e-02 1 1  ON 58
eH2_9                 1.141820e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2061e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2448e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.391
    reference variance = 0.533642
====================================================
  Execution time = 4.3676e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6219e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5530e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562347548750
                                         uncertainty =       0.005973552649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562347548750
                                         uncertainty =       0.005973552649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530181861
  error estimate for blocks of size 2^( 2) =       0.000549897958
  error estimate for blocks of size 2^( 3) =       0.000568338592
  error estimate for blocks of size 2^( 4) =       0.000581791444
  error estimate for blocks of size 2^( 5) =       0.000592215559
  error estimate for blocks of size 2^( 6) =       0.000598344790
  error estimate for blocks of size 2^( 7) =       0.000601473702

      target function =                  N/A
              le_mean =     -22.438041587599
             les_mean =     504.027895618086
             stat err =       0.000593456374
             autocorr =       1.252933052525
              std dev =       0.749790378938
             le_variance =       0.562185612348


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243804158760e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438041587599       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438041588866       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438041594745       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438041602144       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438041631641       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438041640420       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438041649635       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438041648278       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438041646935       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438041642858       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+01 is 7.406202e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438041587599       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438041587917       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438041589388       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438041591234       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438041598574       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438041600772       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438041603137       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438041602804       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438041602475       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438041601459       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+02 is 1.853604e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438041587599       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438041587679       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438041588047       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438041588508       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438041590341       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438041590890       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438041591485       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438041591401       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438041591322       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438041591066       residual = 7.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+02 is 4.635299e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.501960 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9214e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.683894e-01 1 1  ON 0
 uu_1                 9.271267e-02 1 1  ON 1
 uu_2                -2.409669e-02 1 1  ON 2
 uu_3                -9.510235e-02 1 1  ON 3
 uu_4                -1.375598e-01 1 1  ON 4
 uu_5                -1.639754e-01 1 1  ON 5
 uu_6                -1.782750e-01 1 1  ON 6
 uu_7                -1.811506e-01 1 1  ON 7
 uu_8                -1.704100e-01 1 1  ON 8
 uu_9                -1.419192e-01 1 1  ON 9
 ud_0                 4.719242e-01 1 1  ON 10
 ud_1                 1.876682e-01 1 1  ON 11
 ud_2                 3.666539e-02 1 1  ON 12
 ud_3                -4.888435e-02 1 1  ON 13
 ud_4                -1.002515e-01 1 1  ON 14
 ud_5                -1.351736e-01 1 1  ON 15
 ud_6                -1.581959e-01 1 1  ON 16
 ud_7                -1.697958e-01 1 1  ON 17
 ud_8                -1.668648e-01 1 1  ON 18
 ud_9                -1.449716e-01 1 1  ON 19
 eC_0                -6.978073e-01 1 1  ON 20
 eC_1                -5.224842e-01 1 1  ON 21
 eC_2                -2.159373e-01 1 1  ON 22
 eC_3                 7.963869e-03 1 1  ON 23
 eC_4                 1.556427e-01 1 1  ON 24
 eC_5                 2.777853e-01 1 1  ON 25
 eC_6                 2.983922e-01 1 1  ON 26
 eC_7                 3.664564e-01 1 1  ON 27
 eC_8                 2.775823e-01 1 1  ON 28
 eC_9                 5.085277e-02 1 1  ON 29
 eO_0                -1.244613e+00 1 1  ON 30
 eO_1                -8.515279e-01 1 1  ON 31
 eO_2                -3.588006e-01 1 1  ON 32
 eO_3                -3.147040e-02 1 1  ON 33
 eO_4                 1.975633e-01 1 1  ON 34
 eO_5                 3.457431e-01 1 1  ON 35
 eO_6                 3.960476e-01 1 1  ON 36
 eO_7                 4.470409e-01 1 1  ON 37
 eO_8                 5.325510e-01 1 1  ON 38
 eO_9                 4.019372e-01 1 1  ON 39
eH1_0                -1.621416e-01 1 1  ON 40
eH1_1                -6.173417e-02 1 1  ON 41
eH1_2                -4.147545e-02 1 1  ON 42
eH1_3                -3.994495e-02 1 1  ON 43
eH1_4                -2.203558e-03 1 1  ON 44
eH1_5                 1.033591e-02 1 1  ON 45
eH1_6                 4.266253e-02 1 1  ON 46
eH1_7                 5.924688e-02 1 1  ON 47
eH1_8                 3.452003e-02 1 1  ON 48
eH1_9                 6.046559e-02 1 1  ON 49
eH2_0                -1.731628e-01 1 1  ON 50
eH2_1                -7.337437e-02 1 1  ON 51
eH2_2                -5.334179e-02 1 1  ON 52
eH2_3                -5.229413e-02 1 1  ON 53
eH2_4                -1.447617e-02 1 1  ON 54
eH2_5                -2.545124e-03 1 1  ON 55
eH2_6                 3.051556e-02 1 1  ON 56
eH2_7                 4.662994e-02 1 1  ON 57
eH2_8                 2.703384e-02 1 1  ON 58
eH2_9                 1.141816e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.4044
    reference variance = 0.328723
====================================================
  Execution time = 4.3504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5936e-01
  Total weights = 2.0000e+06
  Execution time = 3.5643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559428695089
                                         uncertainty =       0.003139798084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559428695089
                                         uncertainty =       0.003139798084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528846503
  error estimate for blocks of size 2^( 2) =       0.000548819706
  error estimate for blocks of size 2^( 3) =       0.000566973085
  error estimate for blocks of size 2^( 4) =       0.000580641985
  error estimate for blocks of size 2^( 5) =       0.000589717925
  error estimate for blocks of size 2^( 6) =       0.000592998681
  error estimate for blocks of size 2^( 7) =       0.000595793161

      target function =                  N/A
              le_mean =     -22.437410222922
             les_mean =     503.996734479414
             stat err =       0.000589787938
             autocorr =       1.243748297884
              std dev =       0.747901896923
             le_variance =       0.559357247420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559435732609
                                         uncertainty =       0.003139829242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559435732609
                                         uncertainty =       0.003139829242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528849829
  error estimate for blocks of size 2^( 2) =       0.000548822754
  error estimate for blocks of size 2^( 3) =       0.000566975895
  error estimate for blocks of size 2^( 4) =       0.000580644615
  error estimate for blocks of size 2^( 5) =       0.000589720404
  error estimate for blocks of size 2^( 6) =       0.000593001080
  error estimate for blocks of size 2^( 7) =       0.000595795408

      target function =                  N/A
              le_mean =     -22.437410239639
             les_mean =     503.996742265980
             stat err =       0.000589790377
             autocorr =       1.243742936344
              std dev =       0.747906600986
             le_variance =       0.559364283799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559432239590
                                         uncertainty =       0.003139813790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559432239590
                                         uncertainty =       0.003139813790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528848178
  error estimate for blocks of size 2^( 2) =       0.000548821241
  error estimate for blocks of size 2^( 3) =       0.000566974500
  error estimate for blocks of size 2^( 4) =       0.000580643310
  error estimate for blocks of size 2^( 5) =       0.000589719173
  error estimate for blocks of size 2^( 6) =       0.000592999889
  error estimate for blocks of size 2^( 7) =       0.000595794292

      target function =                  N/A
              le_mean =     -22.437410231268
             les_mean =     503.996738397897
             stat err =       0.000589789166
             autocorr =       1.243745596258
              std dev =       0.747904266169
             le_variance =       0.559360791353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559429138920
                                         uncertainty =       0.003139800052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559429138920
                                         uncertainty =       0.003139800052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528846713
  error estimate for blocks of size 2^( 2) =       0.000548819898
  error estimate for blocks of size 2^( 3) =       0.000566973263
  error estimate for blocks of size 2^( 4) =       0.000580642151
  error estimate for blocks of size 2^( 5) =       0.000589718082
  error estimate for blocks of size 2^( 6) =       0.000592998832
  error estimate for blocks of size 2^( 7) =       0.000595793303

      target function =                  N/A
              le_mean =     -22.437410223959
             les_mean =     503.996734969732
             stat err =       0.000589788092
             autocorr =       1.243747959520
              std dev =       0.747902193592
             le_variance =       0.559357691180


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437410222922        initial
     3.7253e+01     3.7253e+02             7.4062e-06       -22.437410239639  <--
     1.4901e+02     1.4901e+03             1.8536e-06       -22.437410231268
     5.9605e+02     5.9605e+03             4.6353e-07       -22.437410223959

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 6.1361e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271234e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704067e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666304e-02 1 1  ON 12
 ud_3                -4.888583e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964700e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777824e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085392e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173270e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203981e-03 1 1  ON 44
eH1_5                 1.033584e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924133e-02 1 1  ON 47
eH1_8                 3.452134e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544642e-03 1 1  ON 55
eH2_6                 3.051395e-02 1 1  ON 56
eH2_7                 4.662736e-02 1 1  ON 57
eH2_8                 2.703589e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2058e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2446e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.4622
    reference variance = 0.461648
====================================================
  Execution time = 4.3842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 6.0143e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5135e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.601571319568
                                         uncertainty =       0.045784472272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.601571319568
                                         uncertainty =       0.045784472272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000548376955
  error estimate for blocks of size 2^( 2) =       0.000568167092
  error estimate for blocks of size 2^( 3) =       0.000586143727
  error estimate for blocks of size 2^( 4) =       0.000599437096
  error estimate for blocks of size 2^( 5) =       0.000608298994
  error estimate for blocks of size 2^( 6) =       0.000612428102
  error estimate for blocks of size 2^( 7) =       0.000613466876

      target function =                  N/A
              le_mean =     -22.437367731835
             les_mean =     504.036905001904
             stat err =       0.000608407767
             autocorr =       1.230923627851
              std dev =       0.775522126712
             le_variance =       0.601434569020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243736773184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437367731835       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437367864110       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437367926531       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437367944053       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437367924645       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437367910213       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437367909136       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437367923384       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437367941126       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437367941683       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+00 is 2.342060e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437367731835       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437367765438       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437367781501       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437367786140       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437367781387       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437367777395       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437367776547       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437367779498       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437367784131       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437367784572       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+01 is 5.880953e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437367731835       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437367740270       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437367744315       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437367745492       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437367744312       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437367743289       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437367743038       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437367743734       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437367744904       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437367745033       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+02 is 1.471924e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.505661 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8985e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.683831e-01 1 1  ON 0
 uu_1                 9.271353e-02 1 1  ON 1
 uu_2                -2.409066e-02 1 1  ON 2
 uu_3                -9.510084e-02 1 1  ON 3
 uu_4                -1.375572e-01 1 1  ON 4
 uu_5                -1.639736e-01 1 1  ON 5
 uu_6                -1.782725e-01 1 1  ON 6
 uu_7                -1.811530e-01 1 1  ON 7
 uu_8                -1.704114e-01 1 1  ON 8
 uu_9                -1.419168e-01 1 1  ON 9
 ud_0                 4.719327e-01 1 1  ON 10
 ud_1                 1.876656e-01 1 1  ON 11
 ud_2                 3.666251e-02 1 1  ON 12
 ud_3                -4.888488e-02 1 1  ON 13
 ud_4                -1.002516e-01 1 1  ON 14
 ud_5                -1.351748e-01 1 1  ON 15
 ud_6                -1.581899e-01 1 1  ON 16
 ud_7                -1.697925e-01 1 1  ON 17
 ud_8                -1.668634e-01 1 1  ON 18
 ud_9                -1.449692e-01 1 1  ON 19
 eC_0                -6.978022e-01 1 1  ON 20
 eC_1                -5.224850e-01 1 1  ON 21
 eC_2                -2.159355e-01 1 1  ON 22
 eC_3                 7.966541e-03 1 1  ON 23
 eC_4                 1.556367e-01 1 1  ON 24
 eC_5                 2.777834e-01 1 1  ON 25
 eC_6                 2.983904e-01 1 1  ON 26
 eC_7                 3.664509e-01 1 1  ON 27
 eC_8                 2.775864e-01 1 1  ON 28
 eC_9                 5.085503e-02 1 1  ON 29
 eO_0                -1.244615e+00 1 1  ON 30
 eO_1                -8.515272e-01 1 1  ON 31
 eO_2                -3.587941e-01 1 1  ON 32
 eO_3                -3.147422e-02 1 1  ON 33
 eO_4                 1.975639e-01 1 1  ON 34
 eO_5                 3.457420e-01 1 1  ON 35
 eO_6                 3.960482e-01 1 1  ON 36
 eO_7                 4.470399e-01 1 1  ON 37
 eO_8                 5.325419e-01 1 1  ON 38
 eO_9                 4.019409e-01 1 1  ON 39
eH1_0                -1.621400e-01 1 1  ON 40
eH1_1                -6.173160e-02 1 1  ON 41
eH1_2                -4.147626e-02 1 1  ON 42
eH1_3                -3.994518e-02 1 1  ON 43
eH1_4                -2.201243e-03 1 1  ON 44
eH1_5                 1.033237e-02 1 1  ON 45
eH1_6                 4.266374e-02 1 1  ON 46
eH1_7                 5.923859e-02 1 1  ON 47
eH1_8                 3.452178e-02 1 1  ON 48
eH1_9                 6.046596e-02 1 1  ON 49
eH2_0                -1.731629e-01 1 1  ON 50
eH2_1                -7.337389e-02 1 1  ON 51
eH2_2                -5.334132e-02 1 1  ON 52
eH2_3                -5.229244e-02 1 1  ON 53
eH2_4                -1.447297e-02 1 1  ON 54
eH2_5                -2.542165e-03 1 1  ON 55
eH2_6                 3.051159e-02 1 1  ON 56
eH2_7                 4.662418e-02 1 1  ON 57
eH2_8                 2.703603e-02 1 1  ON 58
eH2_9                 1.141776e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.4558
    reference variance = 0.50455
====================================================
  Execution time = 4.3997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6553e-01
  Total weights = 2.0000e+06
  Execution time = 3.5871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565658931245
                                         uncertainty =       0.005665774189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565658931245
                                         uncertainty =       0.005665774189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531755510
  error estimate for blocks of size 2^( 2) =       0.000551036468
  error estimate for blocks of size 2^( 3) =       0.000569915143
  error estimate for blocks of size 2^( 4) =       0.000584229857
  error estimate for blocks of size 2^( 5) =       0.000594441956
  error estimate for blocks of size 2^( 6) =       0.000597949558
  error estimate for blocks of size 2^( 7) =       0.000599315649

      target function =                  N/A
              le_mean =     -22.436796770945
             les_mean =     503.975376902844
             stat err =       0.000593984255
             autocorr =       1.247745086771
              std dev =       0.752015854166
             le_variance =       0.565527844917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565670265197
                                         uncertainty =       0.005665628117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565670265197
                                         uncertainty =       0.005665628117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531760837
  error estimate for blocks of size 2^( 2) =       0.000551041474
  error estimate for blocks of size 2^( 3) =       0.000569919767
  error estimate for blocks of size 2^( 4) =       0.000584234335
  error estimate for blocks of size 2^( 5) =       0.000594445959
  error estimate for blocks of size 2^( 6) =       0.000597954335
  error estimate for blocks of size 2^( 7) =       0.000599320361

      target function =                  N/A
              le_mean =     -22.436796705296
             les_mean =     503.975385287510
             stat err =       0.000593988747
             autocorr =       1.247738961808
              std dev =       0.752023387615
             le_variance =       0.565539175519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565664963787
                                         uncertainty =       0.005665700823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565664963787
                                         uncertainty =       0.005665700823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531758345
  error estimate for blocks of size 2^( 2) =       0.000551039134
  error estimate for blocks of size 2^( 3) =       0.000569917609
  error estimate for blocks of size 2^( 4) =       0.000584232246
  error estimate for blocks of size 2^( 5) =       0.000594444096
  error estimate for blocks of size 2^( 6) =       0.000597952098
  error estimate for blocks of size 2^( 7) =       0.000599318152

      target function =                  N/A
              le_mean =     -22.436796733817
             les_mean =     503.975381267537
             stat err =       0.000593986648
             autocorr =       1.247741833831
              std dev =       0.752019863885
             le_variance =       0.565533875678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565659696539
                                         uncertainty =       0.005665765005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565659696539
                                         uncertainty =       0.005665765005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531755870
  error estimate for blocks of size 2^( 2) =       0.000551036806
  error estimate for blocks of size 2^( 3) =       0.000569915456
  error estimate for blocks of size 2^( 4) =       0.000584230160
  error estimate for blocks of size 2^( 5) =       0.000594442228
  error estimate for blocks of size 2^( 6) =       0.000597949880
  error estimate for blocks of size 2^( 7) =       0.000599315966

      target function =                  N/A
              le_mean =     -22.436796766087
             les_mean =     503.975377449905
             stat err =       0.000593984558
             autocorr =       1.247744674003
              std dev =       0.752016362844
             le_variance =       0.565528609984


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436796770945        initial  <--
     9.3132e+00     9.3132e+01             2.3421e-05       -22.436796705296
     3.7253e+01     3.7253e+02             5.8810e-06       -22.436796733817
     1.4901e+02     1.4901e+03             1.4719e-06       -22.436796766087

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8884
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271234e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704067e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666304e-02 1 1  ON 12
 ud_3                -4.888583e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964700e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777824e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085392e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173270e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203981e-03 1 1  ON 44
eH1_5                 1.033584e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924133e-02 1 1  ON 47
eH1_8                 3.452134e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544642e-03 1 1  ON 55
eH2_6                 3.051395e-02 1 1  ON 56
eH2_7                 4.662736e-02 1 1  ON 57
eH2_8                 2.703589e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2089e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2446e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.4499
    reference variance = 0.349995
====================================================
  Execution time = 4.3896e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6720e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5163e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567253898460
                                         uncertainty =       0.004971312128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567253898460
                                         uncertainty =       0.004971312128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532541252
  error estimate for blocks of size 2^( 2) =       0.000552049262
  error estimate for blocks of size 2^( 3) =       0.000570063000
  error estimate for blocks of size 2^( 4) =       0.000584202184
  error estimate for blocks of size 2^( 5) =       0.000592658148
  error estimate for blocks of size 2^( 6) =       0.000597690147
  error estimate for blocks of size 2^( 7) =       0.000599170087

      target function =                  N/A
              le_mean =     -22.437187976684
             les_mean =     503.994604386583
             stat err =       0.000593430142
             autocorr =       1.241745781767
              std dev =       0.753127060414
             le_variance =       0.567200369127


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243718797668e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437187976684       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437187967749       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437187980252       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437187982913       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437187985578       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437187985200       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437187986684       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437187984771       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437187982334       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437187983225       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+01 is 2.831086e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437187976684       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437187974445       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437187977576       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437187978240       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437187978894       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437187978790       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437187979158       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437187978691       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437187978081       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437187978301       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+02 is 7.080640e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437187976684       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437187976124       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437187976907       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437187977074       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437187977236       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437187977209       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437187977303       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437187977185       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437187977030       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437187977093       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+03 is 1.770344e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.509354 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9069e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.683861e-01 1 1  ON 0
 uu_1                 9.271251e-02 1 1  ON 1
 uu_2                -2.409416e-02 1 1  ON 2
 uu_3                -9.510326e-02 1 1  ON 3
 uu_4                -1.375595e-01 1 1  ON 4
 uu_5                -1.639756e-01 1 1  ON 5
 uu_6                -1.782772e-01 1 1  ON 6
 uu_7                -1.811521e-01 1 1  ON 7
 uu_8                -1.704065e-01 1 1  ON 8
 uu_9                -1.419154e-01 1 1  ON 9
 ud_0                 4.719280e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666269e-02 1 1  ON 12
 ud_3                -4.888574e-02 1 1  ON 13
 ud_4                -1.002530e-01 1 1  ON 14
 ud_5                -1.351739e-01 1 1  ON 15
 ud_6                -1.581938e-01 1 1  ON 16
 ud_7                -1.697958e-01 1 1  ON 17
 ud_8                -1.668616e-01 1 1  ON 18
 ud_9                -1.449686e-01 1 1  ON 19
 eC_0                -6.978032e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964915e-03 1 1  ON 23
 eC_4                 1.556414e-01 1 1  ON 24
 eC_5                 2.777820e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664548e-01 1 1  ON 27
 eC_8                 2.775848e-01 1 1  ON 28
 eC_9                 5.085403e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515302e-01 1 1  ON 31
 eO_2                -3.587967e-01 1 1  ON 32
 eO_3                -3.147094e-02 1 1  ON 33
 eO_4                 1.975658e-01 1 1  ON 34
 eO_5                 3.457443e-01 1 1  ON 35
 eO_6                 3.960460e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325474e-01 1 1  ON 38
 eO_9                 4.019393e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173252e-02 1 1  ON 41
eH1_2                -4.147470e-02 1 1  ON 42
eH1_3                -3.994447e-02 1 1  ON 43
eH1_4                -2.203738e-03 1 1  ON 44
eH1_5                 1.033553e-02 1 1  ON 45
eH1_6                 4.266256e-02 1 1  ON 46
eH1_7                 5.924062e-02 1 1  ON 47
eH1_8                 3.452148e-02 1 1  ON 48
eH1_9                 6.046628e-02 1 1  ON 49
eH2_0                -1.731628e-01 1 1  ON 50
eH2_1                -7.337595e-02 1 1  ON 51
eH2_2                -5.334048e-02 1 1  ON 52
eH2_3                -5.229357e-02 1 1  ON 53
eH2_4                -1.447504e-02 1 1  ON 54
eH2_5                -2.544305e-03 1 1  ON 55
eH2_6                 3.051402e-02 1 1  ON 56
eH2_7                 4.662697e-02 1 1  ON 57
eH2_8                 2.703599e-02 1 1  ON 58
eH2_9                 1.141800e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.3377
    reference variance = 0.275711
====================================================
  Execution time = 4.3585e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6799e-01
  Total weights = 2.0000e+06
  Execution time = 4.3413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568041057415
                                         uncertainty =       0.004180966303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568041057415
                                         uncertainty =       0.004180966303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532910984
  error estimate for blocks of size 2^( 2) =       0.000553280603
  error estimate for blocks of size 2^( 3) =       0.000571771522
  error estimate for blocks of size 2^( 4) =       0.000586097583
  error estimate for blocks of size 2^( 5) =       0.000594649421
  error estimate for blocks of size 2^( 6) =       0.000599838791
  error estimate for blocks of size 2^( 7) =       0.000603184866

      target function =                  N/A
              le_mean =     -22.437162114957
             les_mean =     503.994231722989
             stat err =       0.000595942665
             autocorr =       1.250545835450
              std dev =       0.753649941366
             le_variance =       0.567988234121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568044381343
                                         uncertainty =       0.004180974782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568044381343
                                         uncertainty =       0.004180974782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532912544
  error estimate for blocks of size 2^( 2) =       0.000553282046
  error estimate for blocks of size 2^( 3) =       0.000571772854
  error estimate for blocks of size 2^( 4) =       0.000586098825
  error estimate for blocks of size 2^( 5) =       0.000594650594
  error estimate for blocks of size 2^( 6) =       0.000599839903
  error estimate for blocks of size 2^( 7) =       0.000603185895

      target function =                  N/A
              le_mean =     -22.437162099400
             les_mean =     503.994234348864
             stat err =       0.000595943804
             autocorr =       1.250543297391
              std dev =       0.753652146608
             le_variance =       0.567991558087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568042725857
                                         uncertainty =       0.004180970556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568042725857
                                         uncertainty =       0.004180970556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532911767
  error estimate for blocks of size 2^( 2) =       0.000553281328
  error estimate for blocks of size 2^( 3) =       0.000571772191
  error estimate for blocks of size 2^( 4) =       0.000586098207
  error estimate for blocks of size 2^( 5) =       0.000594650010
  error estimate for blocks of size 2^( 6) =       0.000599839349
  error estimate for blocks of size 2^( 7) =       0.000603185383

      target function =                  N/A
              le_mean =     -22.437162107110
             les_mean =     503.994233039319
             stat err =       0.000595943237
             autocorr =       1.250544561555
              std dev =       0.753651048286
             le_variance =       0.567989902582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568041266166
                                         uncertainty =       0.004180966835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568041266166
                                         uncertainty =       0.004180966835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532911082
  error estimate for blocks of size 2^( 2) =       0.000553280694
  error estimate for blocks of size 2^( 3) =       0.000571771606
  error estimate for blocks of size 2^( 4) =       0.000586097661
  error estimate for blocks of size 2^( 5) =       0.000594649494
  error estimate for blocks of size 2^( 6) =       0.000599838861
  error estimate for blocks of size 2^( 7) =       0.000603184931

      target function =                  N/A
              le_mean =     -22.437162113973
             les_mean =     503.994231887589
             stat err =       0.000595942737
             autocorr =       1.250545676054
              std dev =       0.753650079861
             le_variance =       0.567988442875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437162114957        initial  <--
     9.3132e+01     9.3132e+02             2.8311e-06       -22.437162099400
     3.7253e+02     3.7253e+03             7.0806e-07       -22.437162107110
     1.4901e+03     1.4901e+04             1.7703e-07       -22.437162113973

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6124
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271234e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704067e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666304e-02 1 1  ON 12
 ud_3                -4.888583e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964700e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777824e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085392e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173270e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203981e-03 1 1  ON 44
eH1_5                 1.033584e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924133e-02 1 1  ON 47
eH1_8                 3.452134e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544642e-03 1 1  ON 55
eH2_6                 3.051395e-02 1 1  ON 56
eH2_7                 4.662736e-02 1 1  ON 57
eH2_8                 2.703589e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2169e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2445e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.445
    reference variance = 0.574075
====================================================
  Execution time = 4.4047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6543e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5103e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565331438143
                                         uncertainty =       0.006045215782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565331438143
                                         uncertainty =       0.006045215782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531708709
  error estimate for blocks of size 2^( 2) =       0.000551623276
  error estimate for blocks of size 2^( 3) =       0.000570374553
  error estimate for blocks of size 2^( 4) =       0.000584762481
  error estimate for blocks of size 2^( 5) =       0.000593043089
  error estimate for blocks of size 2^( 6) =       0.000598927884
  error estimate for blocks of size 2^( 7) =       0.000602003440

      target function =                  N/A
              le_mean =     -22.436757336356
             les_mean =     503.973507790308
             stat err =       0.000594684223
             autocorr =       1.250907758561
              std dev =       0.751949667519
             le_variance =       0.565428302482


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243675733636e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436757336356       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436757336497       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436757335898       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436757337210       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436757336780       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436757336713       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436757336768       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436757336696       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436757336734       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436757336680       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+02 is 3.110737e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436757336356       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436757336392       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436757336242       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436757336570       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436757336462       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436757336444       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436757336460       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436757336448       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436757336450       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436757336423       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+03 is 7.777075e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436757336356       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436757336365       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436757336328       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436757336415       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436757336387       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436757336375       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436757336357       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436757336377       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436757336381       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436757336385       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+04 is 1.944283e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.513045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9158e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271237e-02 1 1  ON 1
 uu_2                -2.409427e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782772e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704067e-01 1 1  ON 8
 uu_9                -1.419155e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666301e-02 1 1  ON 12
 ud_3                -4.888585e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668621e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964704e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085394e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325477e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173265e-02 1 1  ON 41
eH1_2                -4.147462e-02 1 1  ON 42
eH1_3                -3.994489e-02 1 1  ON 43
eH1_4                -2.203977e-03 1 1  ON 44
eH1_5                 1.033581e-02 1 1  ON 45
eH1_6                 4.266271e-02 1 1  ON 46
eH1_7                 5.924125e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337588e-02 1 1  ON 51
eH2_2                -5.334073e-02 1 1  ON 52
eH2_3                -5.229346e-02 1 1  ON 53
eH2_4                -1.447507e-02 1 1  ON 54
eH2_5                -2.544686e-03 1 1  ON 55
eH2_6                 3.051395e-02 1 1  ON 56
eH2_7                 4.662735e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.4138
    reference variance = 0.426095
====================================================
  Execution time = 4.3152e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5917e-01
  Total weights = 2.0000e+06
  Execution time = 3.5565e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559269811199
                                         uncertainty =       0.004985802794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559269811199
                                         uncertainty =       0.004985802794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528756958
  error estimate for blocks of size 2^( 2) =       0.000549015192
  error estimate for blocks of size 2^( 3) =       0.000568215541
  error estimate for blocks of size 2^( 4) =       0.000581843917
  error estimate for blocks of size 2^( 5) =       0.000590150963
  error estimate for blocks of size 2^( 6) =       0.000595292903
  error estimate for blocks of size 2^( 7) =       0.000597003911

      target function =                  N/A
              le_mean =     -22.437056982988
             les_mean =     503.980693619394
             stat err =       0.000591072923
             autocorr =       1.249596901507
              std dev =       0.747775261106
             le_variance =       0.559167841122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559270097535
                                         uncertainty =       0.004985807211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559270097535
                                         uncertainty =       0.004985807211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528757093
  error estimate for blocks of size 2^( 2) =       0.000549015317
  error estimate for blocks of size 2^( 3) =       0.000568215654
  error estimate for blocks of size 2^( 4) =       0.000581844022
  error estimate for blocks of size 2^( 5) =       0.000590151060
  error estimate for blocks of size 2^( 6) =       0.000595293006
  error estimate for blocks of size 2^( 7) =       0.000597004004

      target function =                  N/A
              le_mean =     -22.437056982926
             les_mean =     503.980693902926
             stat err =       0.000591073023
             autocorr =       1.249596682441
              std dev =       0.747775452555
             le_variance =       0.559168127443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559269954415
                                         uncertainty =       0.004985805004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559269954415
                                         uncertainty =       0.004985805004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528757026
  error estimate for blocks of size 2^( 2) =       0.000549015254
  error estimate for blocks of size 2^( 3) =       0.000568215597
  error estimate for blocks of size 2^( 4) =       0.000581843969
  error estimate for blocks of size 2^( 5) =       0.000590151012
  error estimate for blocks of size 2^( 6) =       0.000595292955
  error estimate for blocks of size 2^( 7) =       0.000597003957

      target function =                  N/A
              le_mean =     -22.437056982957
             les_mean =     503.980693761207
             stat err =       0.000591072973
             autocorr =       1.249596791944
              std dev =       0.747775356862
             le_variance =       0.559167984330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559269829103
                                         uncertainty =       0.004985803070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559269829103
                                         uncertainty =       0.004985803070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528756966
  error estimate for blocks of size 2^( 2) =       0.000549015200
  error estimate for blocks of size 2^( 3) =       0.000568215548
  error estimate for blocks of size 2^( 4) =       0.000581843924
  error estimate for blocks of size 2^( 5) =       0.000590150969
  error estimate for blocks of size 2^( 6) =       0.000595292910
  error estimate for blocks of size 2^( 7) =       0.000597003917

      target function =                  N/A
              le_mean =     -22.437056982984
             les_mean =     503.980693637122
             stat err =       0.000591072930
             autocorr =       1.249596887806
              std dev =       0.747775273076
             le_variance =       0.559167859024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437056982988        initial  <--
     9.3132e+02     9.3132e+03             3.1107e-07       -22.437056982926
     3.7253e+03     3.7253e+04             7.7771e-08       -22.437056982957
     1.4901e+04     1.4901e+05             1.9443e-08       -22.437056982984

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9955
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271234e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704067e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666304e-02 1 1  ON 12
 ud_3                -4.888583e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964700e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777824e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085392e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173270e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203981e-03 1 1  ON 44
eH1_5                 1.033584e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924133e-02 1 1  ON 47
eH1_8                 3.452134e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544642e-03 1 1  ON 55
eH2_6                 3.051395e-02 1 1  ON 56
eH2_7                 4.662736e-02 1 1  ON 57
eH2_8                 2.703589e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2016e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2444e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.4274
    reference variance = 0.375424
====================================================
  Execution time = 4.4648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.9491e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5497e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.595039991760
                                         uncertainty =       0.019820904285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.595039991760
                                         uncertainty =       0.019820904285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000545396707
  error estimate for blocks of size 2^( 2) =       0.000564969535
  error estimate for blocks of size 2^( 3) =       0.000582347264
  error estimate for blocks of size 2^( 4) =       0.000595201253
  error estimate for blocks of size 2^( 5) =       0.000604334980
  error estimate for blocks of size 2^( 6) =       0.000609106698
  error estimate for blocks of size 2^( 7) =       0.000613824167

      target function =                  N/A
              le_mean =     -22.437223394383
             les_mean =     504.023908488342
             stat err =       0.000605616775
             autocorr =       1.233021839776
              std dev =       0.771307420137
             le_variance =       0.594915136358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243722339438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437223394383       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437223394401       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437223394410       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437223394471       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437223394543       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437223394545       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437223394562       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437223394608       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437223394604       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437223394614       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+03 is 2.560735e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437223394383       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437223394387       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437223394390       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437223394413       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437223394408       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437223394423       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437223394402       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437223394429       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437223394433       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437223394510       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+04 is 6.401862e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437223394383       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437223394384       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437223394385       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437223394389       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437223394393       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437223394464       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437223394335       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437223394397       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437223393662       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437223394841       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+05 is 1.600470e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.516794 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0152e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271234e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704067e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666304e-02 1 1  ON 12
 ud_3                -4.888583e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964702e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777824e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173269e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203980e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924133e-02 1 1  ON 47
eH1_8                 3.452134e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544639e-03 1 1  ON 55
eH2_6                 3.051395e-02 1 1  ON 56
eH2_7                 4.662736e-02 1 1  ON 57
eH2_8                 2.703589e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.4354
    reference variance = 0.546316
====================================================
  Execution time = 4.3642e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6229e-01
  Total weights = 2.0000e+06
  Execution time = 3.5773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562413685512
                                         uncertainty =       0.003969963292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562413685512
                                         uncertainty =       0.003969963292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530231103
  error estimate for blocks of size 2^( 2) =       0.000550860073
  error estimate for blocks of size 2^( 3) =       0.000569394218
  error estimate for blocks of size 2^( 4) =       0.000583383319
  error estimate for blocks of size 2^( 5) =       0.000592408971
  error estimate for blocks of size 2^( 6) =       0.000597551824
  error estimate for blocks of size 2^( 7) =       0.000598773353

      target function =                  N/A
              le_mean =     -22.438376313953
             les_mean =     504.043021371142
             stat err =       0.000593029367
             autocorr =       1.250898295254
              std dev =       0.749860017432
             le_variance =       0.562290045743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562413712278
                                         uncertainty =       0.003969963449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562413712278
                                         uncertainty =       0.003969963449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530231116
  error estimate for blocks of size 2^( 2) =       0.000550860084
  error estimate for blocks of size 2^( 3) =       0.000569394229
  error estimate for blocks of size 2^( 4) =       0.000583383329
  error estimate for blocks of size 2^( 5) =       0.000592408981
  error estimate for blocks of size 2^( 6) =       0.000597551834
  error estimate for blocks of size 2^( 7) =       0.000598773363

      target function =                  N/A
              le_mean =     -22.438376314009
             les_mean =     504.043021400441
             stat err =       0.000593029377
             autocorr =       1.250898277919
              std dev =       0.749860035268
             le_variance =       0.562290072492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562413698895
                                         uncertainty =       0.003969963371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562413698895
                                         uncertainty =       0.003969963371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530231110
  error estimate for blocks of size 2^( 2) =       0.000550860079
  error estimate for blocks of size 2^( 3) =       0.000569394224
  error estimate for blocks of size 2^( 4) =       0.000583383324
  error estimate for blocks of size 2^( 5) =       0.000592408976
  error estimate for blocks of size 2^( 6) =       0.000597551829
  error estimate for blocks of size 2^( 7) =       0.000598773358

      target function =                  N/A
              le_mean =     -22.438376313981
             les_mean =     504.043021385792
             stat err =       0.000593029372
             autocorr =       1.250898286586
              std dev =       0.749860026350
             le_variance =       0.562290059118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562413687185
                                         uncertainty =       0.003969963302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562413687185
                                         uncertainty =       0.003969963302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530231104
  error estimate for blocks of size 2^( 2) =       0.000550860073
  error estimate for blocks of size 2^( 3) =       0.000569394219
  error estimate for blocks of size 2^( 4) =       0.000583383319
  error estimate for blocks of size 2^( 5) =       0.000592408972
  error estimate for blocks of size 2^( 6) =       0.000597551824
  error estimate for blocks of size 2^( 7) =       0.000598773354

      target function =                  N/A
              le_mean =     -22.438376313956
             les_mean =     504.043021372973
             stat err =       0.000593029367
             autocorr =       1.250898294165
              std dev =       0.749860018546
             le_variance =       0.562290047414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438376313953        initial
     9.3132e+03     9.3132e+04             2.5607e-08       -22.438376314009  <--
     3.7253e+04     3.7253e+05             6.4019e-09       -22.438376313981
     1.4901e+05     1.4901e+06             1.6005e-09       -22.438376313956

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 6.1578e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964708e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173269e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203976e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924131e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447509e-02 1 1  ON 54
eH2_5                -2.544630e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662735e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2174e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2444e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.5202
    reference variance = 0.949488
====================================================
  Execution time = 4.5574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6862e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4826e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568350867107
                                         uncertainty =       0.004180866845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568350867107
                                         uncertainty =       0.004180866845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533209582
  error estimate for blocks of size 2^( 2) =       0.000553500862
  error estimate for blocks of size 2^( 3) =       0.000572731779
  error estimate for blocks of size 2^( 4) =       0.000586785928
  error estimate for blocks of size 2^( 5) =       0.000595825372
  error estimate for blocks of size 2^( 6) =       0.000599789628
  error estimate for blocks of size 2^( 7) =       0.000600478795

      target function =                  N/A
              le_mean =     -22.436441736117
             les_mean =     503.962542411596
             stat err =       0.000595719931
             autocorr =       1.248212045731
              std dev =       0.754072223145
             le_variance =       0.568624917719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243644173612e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436441736117       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436441736181       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436441736580       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436441737035       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436441737051       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436441737437       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436441737494       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436441737544       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436441737479       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436441737455       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+03 is 1.138605e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436441736117       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436441736133       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436441736233       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436441736347       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436441736349       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436441736451       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436441736466       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436441736489       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436441736450       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436441736476       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+03 is 2.846557e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436441736117       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436441736121       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436441736146       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436441736181       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436441736182       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436441736202       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436441736195       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436441736180       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436441736359       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436441736050       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+04 is 7.116418e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.520469 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0407e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271236e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510333e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666302e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964710e-03 1 1  ON 23
 eC_4                 1.556415e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147092e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325477e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173268e-02 1 1  ON 41
eH1_2                -4.147466e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203975e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924128e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337590e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447508e-02 1 1  ON 54
eH2_5                -2.544632e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662733e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.4709
    reference variance = 0.500747
====================================================
  Execution time = 4.3203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6585e-01
  Total weights = 2.0000e+06
  Execution time = 3.5766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565931097870
                                         uncertainty =       0.004952150145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565931097870
                                         uncertainty =       0.004952150145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531907450
  error estimate for blocks of size 2^( 2) =       0.000551866206
  error estimate for blocks of size 2^( 3) =       0.000569560185
  error estimate for blocks of size 2^( 4) =       0.000582446429
  error estimate for blocks of size 2^( 5) =       0.000591535135
  error estimate for blocks of size 2^( 6) =       0.000596829657
  error estimate for blocks of size 2^( 7) =       0.000600408280

      target function =                  N/A
              le_mean =     -22.437399590990
             les_mean =     504.002751193602
             stat err =       0.000592804875
             autocorr =       1.242085199481
              std dev =       0.752230729741
             le_variance =       0.565851070767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565931309479
                                         uncertainty =       0.004952152532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565931309479
                                         uncertainty =       0.004952152532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531907549
  error estimate for blocks of size 2^( 2) =       0.000551866297
  error estimate for blocks of size 2^( 3) =       0.000569560269
  error estimate for blocks of size 2^( 4) =       0.000582446508
  error estimate for blocks of size 2^( 5) =       0.000591535213
  error estimate for blocks of size 2^( 6) =       0.000596829736
  error estimate for blocks of size 2^( 7) =       0.000600408354

      target function =                  N/A
              le_mean =     -22.437399590692
             les_mean =     504.002751391821
             stat err =       0.000592804953
             autocorr =       1.242085059996
              std dev =       0.752230870381
             le_variance =       0.565851282354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565931203691
                                         uncertainty =       0.004952151338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565931203691
                                         uncertainty =       0.004952151338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531907500
  error estimate for blocks of size 2^( 2) =       0.000551866251
  error estimate for blocks of size 2^( 3) =       0.000569560227
  error estimate for blocks of size 2^( 4) =       0.000582446469
  error estimate for blocks of size 2^( 5) =       0.000591535174
  error estimate for blocks of size 2^( 6) =       0.000596829696
  error estimate for blocks of size 2^( 7) =       0.000600408317

      target function =                  N/A
              le_mean =     -22.437399590841
             les_mean =     504.002751292726
             stat err =       0.000592804914
             autocorr =       1.242085129730
              std dev =       0.752230800072
             le_variance =       0.565851176577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565931111098
                                         uncertainty =       0.004952150294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565931111098
                                         uncertainty =       0.004952150294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531907456
  error estimate for blocks of size 2^( 2) =       0.000551866211
  error estimate for blocks of size 2^( 3) =       0.000569560191
  error estimate for blocks of size 2^( 4) =       0.000582446434
  error estimate for blocks of size 2^( 5) =       0.000591535139
  error estimate for blocks of size 2^( 6) =       0.000596829662
  error estimate for blocks of size 2^( 7) =       0.000600408284

      target function =                  N/A
              le_mean =     -22.437399590971
             les_mean =     504.002751205993
             stat err =       0.000592804880
             autocorr =       1.242085190758
              std dev =       0.752230738533
             le_variance =       0.565851083993


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437399590990        initial  <--
     2.3283e+03     2.3283e+04             1.1386e-07       -22.437399590692
     9.3132e+03     9.3132e+04             2.8466e-08       -22.437399590841
     3.7253e+04     3.7253e+05             7.1164e-09       -22.437399590971

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1389
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964708e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173269e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203976e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924131e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447509e-02 1 1  ON 54
eH2_5                -2.544630e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662735e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2155e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2445e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.4358
    reference variance = 0.455043
====================================================
  Execution time = 4.4460e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.9355e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4876e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.593650933286
                                         uncertainty =       0.033113198807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.593650933286
                                         uncertainty =       0.033113198807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000544769444
  error estimate for blocks of size 2^( 2) =       0.000563688351
  error estimate for blocks of size 2^( 3) =       0.000581662042
  error estimate for blocks of size 2^( 4) =       0.000595574696
  error estimate for blocks of size 2^( 5) =       0.000603461582
  error estimate for blocks of size 2^( 6) =       0.000608972414
  error estimate for blocks of size 2^( 7) =       0.000608863664

      target function =                  N/A
              le_mean =     -22.437598728234
             les_mean =     504.039383885882
             stat err =       0.000604218089
             autocorr =       1.230161034367
              std dev =       0.770420335546
             le_variance =       0.593547493422


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243759872823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437598728234       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437598728251       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437598728334       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437598728339       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437598728361       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437598728346       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437598728372       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437598728340       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437598728386       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437598728339       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+04 is 1.268992e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437598728234       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437598728238       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437598728259       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437598728260       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437598728261       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437598728317       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437598728196       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437598728364       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437598728337       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437598727739       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+04 is 3.172485e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437598728234       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437598728235       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437598728240       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437598728093       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437598728129       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437598728236       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437598728294       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437598728373       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437598727858       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437598728362       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+05 is 7.931211e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.524262 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9344e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964706e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173268e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203976e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924130e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447509e-02 1 1  ON 54
eH2_5                -2.544629e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662735e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.4098
    reference variance = 0.372586
====================================================
  Execution time = 4.3540e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6139e-01
  Total weights = 2.0000e+06
  Execution time = 3.5985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561410861062
                                         uncertainty =       0.004509998260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561410861062
                                         uncertainty =       0.004509998260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529808436
  error estimate for blocks of size 2^( 2) =       0.000550182010
  error estimate for blocks of size 2^( 3) =       0.000568825530
  error estimate for blocks of size 2^( 4) =       0.000581967850
  error estimate for blocks of size 2^( 5) =       0.000588877128
  error estimate for blocks of size 2^( 6) =       0.000594456301
  error estimate for blocks of size 2^( 7) =       0.000597120244

      target function =                  N/A
              le_mean =     -22.436393508535
             les_mean =     503.953147347612
             stat err =       0.000590605381
             autocorr =       1.242673564773
              std dev =       0.749262276147
             le_variance =       0.561393958457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561410865212
                                         uncertainty =       0.004509998305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561410865212
                                         uncertainty =       0.004509998305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529808438
  error estimate for blocks of size 2^( 2) =       0.000550182012
  error estimate for blocks of size 2^( 3) =       0.000568825532
  error estimate for blocks of size 2^( 4) =       0.000581967851
  error estimate for blocks of size 2^( 5) =       0.000588877130
  error estimate for blocks of size 2^( 6) =       0.000594456303
  error estimate for blocks of size 2^( 7) =       0.000597120246

      target function =                  N/A
              le_mean =     -22.436393508506
             les_mean =     503.953147350421
             stat err =       0.000590605383
             autocorr =       1.242673563215
              std dev =       0.749262278916
             le_variance =       0.561393962607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561410863137
                                         uncertainty =       0.004509998282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561410863137
                                         uncertainty =       0.004509998282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529808437
  error estimate for blocks of size 2^( 2) =       0.000550182011
  error estimate for blocks of size 2^( 3) =       0.000568825531
  error estimate for blocks of size 2^( 4) =       0.000581967850
  error estimate for blocks of size 2^( 5) =       0.000588877129
  error estimate for blocks of size 2^( 6) =       0.000594456302
  error estimate for blocks of size 2^( 7) =       0.000597120245

      target function =                  N/A
              le_mean =     -22.436393508521
             les_mean =     503.953147349017
             stat err =       0.000590605382
             autocorr =       1.242673563998
              std dev =       0.749262277532
             le_variance =       0.561393960532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561410861321
                                         uncertainty =       0.004509998263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561410861321
                                         uncertainty =       0.004509998263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529808436
  error estimate for blocks of size 2^( 2) =       0.000550182011
  error estimate for blocks of size 2^( 3) =       0.000568825531
  error estimate for blocks of size 2^( 4) =       0.000581967850
  error estimate for blocks of size 2^( 5) =       0.000588877128
  error estimate for blocks of size 2^( 6) =       0.000594456302
  error estimate for blocks of size 2^( 7) =       0.000597120244

      target function =                  N/A
              le_mean =     -22.436393508534
             les_mean =     503.953147347787
             stat err =       0.000590605381
             autocorr =       1.242673564681
              std dev =       0.749262276320
             le_variance =       0.561393958717


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436393508535        initial  <--
     2.3283e+04     2.3283e+05             1.2690e-08       -22.436393508506
     9.3132e+04     9.3132e+05             3.1725e-09       -22.436393508521
     3.7253e+05     3.7253e+06             7.9312e-10       -22.436393508534

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.5281
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964708e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173269e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203976e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924131e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447509e-02 1 1  ON 54
eH2_5                -2.544630e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662735e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2088e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2445e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.3413
    reference variance = 0.445236
====================================================
  Execution time = 4.3969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7877e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5082e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578795470398
                                         uncertainty =       0.010864039627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578795470398
                                         uncertainty =       0.010864039627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537944675
  error estimate for blocks of size 2^( 2) =       0.000557678204
  error estimate for blocks of size 2^( 3) =       0.000575053051
  error estimate for blocks of size 2^( 4) =       0.000588372782
  error estimate for blocks of size 2^( 5) =       0.000598554811
  error estimate for blocks of size 2^( 6) =       0.000603370317
  error estimate for blocks of size 2^( 7) =       0.000602736189

      target function =                  N/A
              le_mean =     -22.438045010218
             les_mean =     504.044632538445
             stat err =       0.000598258525
             autocorr =       1.236808797174
              std dev =       0.760768655535
             le_variance =       0.578768947244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243804501022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438045010218       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438045010223       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438045010225       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438045010375       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438045010105       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438045010408       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438045010195       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438045010067       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438045010351       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438045010711       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+05 is 1.233593e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438045010218       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438045010220       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438045010220       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438045010448       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438045010554       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438045010256       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438045010075       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438045009764       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438045010567       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438045011138       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+05 is 3.083982e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438045010218       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438045010219       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438045010219       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438045010028       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438045008974       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438045009846       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438045010478       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438045010616       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438045010279       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438045010211       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+06 is 7.709970e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.527956 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9059e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964708e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173269e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203976e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924131e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447509e-02 1 1  ON 54
eH2_5                -2.544630e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662735e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.4336
    reference variance = 0.28206
====================================================
  Execution time = 4.4857e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6314e-01
  Total weights = 2.0000e+06
  Execution time = 3.5843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563212045269
                                         uncertainty =       0.003335417584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563212045269
                                         uncertainty =       0.003335417584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530631247
  error estimate for blocks of size 2^( 2) =       0.000551063437
  error estimate for blocks of size 2^( 3) =       0.000569717467
  error estimate for blocks of size 2^( 4) =       0.000583517319
  error estimate for blocks of size 2^( 5) =       0.000590948353
  error estimate for blocks of size 2^( 6) =       0.000594674332
  error estimate for blocks of size 2^( 7) =       0.000597116759

      target function =                  N/A
              le_mean =     -22.437437319515
             les_mean =     504.001732225474
             stat err =       0.000591564191
             autocorr =       1.242848274427
              std dev =       0.750425905668
             le_variance =       0.563139039898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563212045643
                                         uncertainty =       0.003335417587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563212045643
                                         uncertainty =       0.003335417587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530631247
  error estimate for blocks of size 2^( 2) =       0.000551063437
  error estimate for blocks of size 2^( 3) =       0.000569717467
  error estimate for blocks of size 2^( 4) =       0.000583517319
  error estimate for blocks of size 2^( 5) =       0.000590948353
  error estimate for blocks of size 2^( 6) =       0.000594674333
  error estimate for blocks of size 2^( 7) =       0.000597116759

      target function =                  N/A
              le_mean =     -22.437437319518
             les_mean =     504.001732226007
             stat err =       0.000591564191
             autocorr =       1.242848274300
              std dev =       0.750425905918
             le_variance =       0.563139040272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563212045456
                                         uncertainty =       0.003335417585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563212045456
                                         uncertainty =       0.003335417585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530631247
  error estimate for blocks of size 2^( 2) =       0.000551063437
  error estimate for blocks of size 2^( 3) =       0.000569717467
  error estimate for blocks of size 2^( 4) =       0.000583517319
  error estimate for blocks of size 2^( 5) =       0.000590948353
  error estimate for blocks of size 2^( 6) =       0.000594674333
  error estimate for blocks of size 2^( 7) =       0.000597116759

      target function =                  N/A
              le_mean =     -22.437437319516
             les_mean =     504.001732225741
             stat err =       0.000591564191
             autocorr =       1.242848274368
              std dev =       0.750425905793
             le_variance =       0.563139040085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563212045292
                                         uncertainty =       0.003335417584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563212045292
                                         uncertainty =       0.003335417584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530631247
  error estimate for blocks of size 2^( 2) =       0.000551063437
  error estimate for blocks of size 2^( 3) =       0.000569717467
  error estimate for blocks of size 2^( 4) =       0.000583517319
  error estimate for blocks of size 2^( 5) =       0.000590948353
  error estimate for blocks of size 2^( 6) =       0.000594674332
  error estimate for blocks of size 2^( 7) =       0.000597116759

      target function =                  N/A
              le_mean =     -22.437437319515
             les_mean =     504.001732225507
             stat err =       0.000591564191
             autocorr =       1.242848274426
              std dev =       0.750425905684
             le_variance =       0.563139039921


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437437319515        initial
     2.3283e+05     2.3283e+06             1.2336e-09       -22.437437319518  <--
     9.3132e+05     9.3132e+06             3.0840e-10       -22.437437319516
     3.7253e+06     3.7253e+07             7.7100e-11       -22.437437319515

*****************************************************************************
Applying the update for shift_i =   2.3283e+05     and shift_s =   2.3283e+06
*****************************************************************************

  Execution time = 6.2798e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964707e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173268e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203976e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924130e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447509e-02 1 1  ON 54
eH2_5                -2.544630e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662735e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2186e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2443e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.5301
    reference variance = 0.411488
====================================================
  Execution time = 4.3679e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6347e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4996e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563474919914
                                         uncertainty =       0.004025281070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563474919914
                                         uncertainty =       0.004025281070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530787037
  error estimate for blocks of size 2^( 2) =       0.000550730960
  error estimate for blocks of size 2^( 3) =       0.000569240185
  error estimate for blocks of size 2^( 4) =       0.000583013967
  error estimate for blocks of size 2^( 5) =       0.000591984554
  error estimate for blocks of size 2^( 6) =       0.000596090665
  error estimate for blocks of size 2^( 7) =       0.000595964651

      target function =                  N/A
              le_mean =     -22.437601684080
             les_mean =     504.009438808469
             stat err =       0.000591763459
             autocorr =       1.242955765428
              std dev =       0.750646226107
             le_variance =       0.563469756768


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243760168408e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437601684080       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437601684086       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437601684079       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437601684075       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437601684082       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437601684079       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437601684072       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437601684081       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437601683942       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437601683958       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+04 is 3.500085e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437601684080       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437601684082       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437601684080       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437601684081       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437601684202       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437601684058       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437601684057       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437601684107       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437601684059       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437601683920       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+05 is 8.750220e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437601684080       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437601684081       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437601684080       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437601684049       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437601684033       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437601684432       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437601683372       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437601684823       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437601685735       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437601685528       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+05 is 2.187555e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.531668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8685e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964707e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173268e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203975e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924130e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447509e-02 1 1  ON 54
eH2_5                -2.544630e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662735e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.4591
    reference variance = 0.499263
====================================================
  Execution time = 4.3612e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5503e-01
  Total weights = 2.0000e+06
  Execution time = 3.5682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553624886477
                                         uncertainty =       0.002691662720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553624886477
                                         uncertainty =       0.002691662720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526798951
  error estimate for blocks of size 2^( 2) =       0.000546944853
  error estimate for blocks of size 2^( 3) =       0.000566012040
  error estimate for blocks of size 2^( 4) =       0.000579788097
  error estimate for blocks of size 2^( 5) =       0.000588887794
  error estimate for blocks of size 2^( 6) =       0.000594000236
  error estimate for blocks of size 2^( 7) =       0.000595798223

      target function =                  N/A
              le_mean =     -22.437797675075
             les_mean =     504.009798500148
             stat err =       0.000589618587
             autocorr =       1.252715722995
              std dev =       0.745006221498
             le_variance =       0.555034270071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553624889123
                                         uncertainty =       0.002691662733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553624889123
                                         uncertainty =       0.002691662733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526798953
  error estimate for blocks of size 2^( 2) =       0.000546944854
  error estimate for blocks of size 2^( 3) =       0.000566012041
  error estimate for blocks of size 2^( 4) =       0.000579788097
  error estimate for blocks of size 2^( 5) =       0.000588887794
  error estimate for blocks of size 2^( 6) =       0.000594000237
  error estimate for blocks of size 2^( 7) =       0.000595798224

      target function =                  N/A
              le_mean =     -22.437797675095
             les_mean =     504.009798503707
             stat err =       0.000589618588
             autocorr =       1.252715720391
              std dev =       0.745006223285
             le_variance =       0.555034272734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553624887800
                                         uncertainty =       0.002691662726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553624887800
                                         uncertainty =       0.002691662726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526798952
  error estimate for blocks of size 2^( 2) =       0.000546944854
  error estimate for blocks of size 2^( 3) =       0.000566012041
  error estimate for blocks of size 2^( 4) =       0.000579788097
  error estimate for blocks of size 2^( 5) =       0.000588887794
  error estimate for blocks of size 2^( 6) =       0.000594000236
  error estimate for blocks of size 2^( 7) =       0.000595798223

      target function =                  N/A
              le_mean =     -22.437797675085
             les_mean =     504.009798501927
             stat err =       0.000589618588
             autocorr =       1.252715721697
              std dev =       0.745006222392
             le_variance =       0.555034271403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553624886642
                                         uncertainty =       0.002691662721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553624886642
                                         uncertainty =       0.002691662721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526798951
  error estimate for blocks of size 2^( 2) =       0.000546944853
  error estimate for blocks of size 2^( 3) =       0.000566012040
  error estimate for blocks of size 2^( 4) =       0.000579788097
  error estimate for blocks of size 2^( 5) =       0.000588887794
  error estimate for blocks of size 2^( 6) =       0.000594000236
  error estimate for blocks of size 2^( 7) =       0.000595798223

      target function =                  N/A
              le_mean =     -22.437797675076
             les_mean =     504.009798500371
             stat err =       0.000589618587
             autocorr =       1.252715722832
              std dev =       0.745006221610
             le_variance =       0.555034270237


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437797675075        initial
     5.8208e+04     5.8208e+05             3.5001e-09       -22.437797675095  <--
     2.3283e+05     2.3283e+06             8.7502e-10       -22.437797675085
     9.3132e+05     9.3132e+06             2.1876e-10       -22.437797675076

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 6.1509e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964707e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173269e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203973e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924130e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447509e-02 1 1  ON 54
eH2_5                -2.544631e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662735e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2020e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2444e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.3132
    reference variance = 0.544009
====================================================
  Execution time = 4.4092e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5998e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5154e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559984870723
                                         uncertainty =       0.003881974178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559984870723
                                         uncertainty =       0.003881974178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529142889
  error estimate for blocks of size 2^( 2) =       0.000548988959
  error estimate for blocks of size 2^( 3) =       0.000567189542
  error estimate for blocks of size 2^( 4) =       0.000581490281
  error estimate for blocks of size 2^( 5) =       0.000590919025
  error estimate for blocks of size 2^( 6) =       0.000594643528
  error estimate for blocks of size 2^( 7) =       0.000596548423

      target function =                  N/A
              le_mean =     -22.437620180560
             les_mean =     504.006783481929
             stat err =       0.000590900314
             autocorr =       1.247046112230
              std dev =       0.748321050665
             le_variance =       0.559984394868


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243762018056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437620180560       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437620180527       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437620180579       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437620180652       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437620180648       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437620180645       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437620180635       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437620180651       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437620180699       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437620180648       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+04 is 1.525676e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437620180560       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437620180551       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437620180564       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437620180593       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437620180589       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437620180585       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437620180603       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437620180568       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437620180569       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437620180594       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+04 is 3.814204e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437620180560       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437620180558       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437620180561       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437620180387       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437620180577       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437620180633       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437620180423       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437620180554       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437620180083       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437620180724       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+05 is 9.535528e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.535390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9253e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510334e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964708e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325478e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173268e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203973e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266272e-02 1 1  ON 46
eH1_7                 5.924130e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229347e-02 1 1  ON 53
eH2_4                -1.447509e-02 1 1  ON 54
eH2_5                -2.544629e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662735e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.3772
    reference variance = 0.340273
====================================================
  Execution time = 4.3384e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.8116e-01
  Total weights = 2.0000e+06
  Execution time = 3.5746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581261915280
                                         uncertainty =       0.019577570925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581261915280
                                         uncertainty =       0.019577570925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539055564
  error estimate for blocks of size 2^( 2) =       0.000559102590
  error estimate for blocks of size 2^( 3) =       0.000576900390
  error estimate for blocks of size 2^( 4) =       0.000589511908
  error estimate for blocks of size 2^( 5) =       0.000597143702
  error estimate for blocks of size 2^( 6) =       0.000601491033
  error estimate for blocks of size 2^( 7) =       0.000605245560

      target function =                  N/A
              le_mean =     -22.437664860519
             les_mean =     504.029965905331
             stat err =       0.000598348051
             autocorr =       1.232085068327
              std dev =       0.762339689992
             le_variance =       0.581161802936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581261928959
                                         uncertainty =       0.019577570884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581261928959
                                         uncertainty =       0.019577570884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539055571
  error estimate for blocks of size 2^( 2) =       0.000559102596
  error estimate for blocks of size 2^( 3) =       0.000576900396
  error estimate for blocks of size 2^( 4) =       0.000589511914
  error estimate for blocks of size 2^( 5) =       0.000597143708
  error estimate for blocks of size 2^( 6) =       0.000601491038
  error estimate for blocks of size 2^( 7) =       0.000605245565

      target function =                  N/A
              le_mean =     -22.437664860583
             les_mean =     504.029965921892
             stat err =       0.000598348056
             autocorr =       1.232085061018
              std dev =       0.762339698970
             le_variance =       0.581161816626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581261922120
                                         uncertainty =       0.019577570905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581261922120
                                         uncertainty =       0.019577570905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539055568
  error estimate for blocks of size 2^( 2) =       0.000559102593
  error estimate for blocks of size 2^( 3) =       0.000576900393
  error estimate for blocks of size 2^( 4) =       0.000589511911
  error estimate for blocks of size 2^( 5) =       0.000597143705
  error estimate for blocks of size 2^( 6) =       0.000601491035
  error estimate for blocks of size 2^( 7) =       0.000605245562

      target function =                  N/A
              le_mean =     -22.437664860551
             les_mean =     504.029965913612
             stat err =       0.000598348053
             autocorr =       1.232085064670
              std dev =       0.762339694481
             le_variance =       0.581161809781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581261916135
                                         uncertainty =       0.019577570923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581261916135
                                         uncertainty =       0.019577570923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539055565
  error estimate for blocks of size 2^( 2) =       0.000559102591
  error estimate for blocks of size 2^( 3) =       0.000576900391
  error estimate for blocks of size 2^( 4) =       0.000589511909
  error estimate for blocks of size 2^( 5) =       0.000597143703
  error estimate for blocks of size 2^( 6) =       0.000601491033
  error estimate for blocks of size 2^( 7) =       0.000605245560

      target function =                  N/A
              le_mean =     -22.437664860523
             les_mean =     504.029965906366
             stat err =       0.000598348051
             autocorr =       1.232085067869
              std dev =       0.762339690553
             le_variance =       0.581161803792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437664860519        initial
     1.4552e+04     1.4552e+05             1.5257e-08       -22.437664860583  <--
     5.8208e+04     5.8208e+05             3.8142e-09       -22.437664860551
     2.3283e+05     2.3283e+06             9.5355e-10       -22.437664860523

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 6.1274e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510333e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964712e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325477e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173267e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994487e-02 1 1  ON 43
eH1_4                -2.203971e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266273e-02 1 1  ON 46
eH1_7                 5.924129e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229346e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544623e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662734e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2053e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.4974
    reference variance = 0.416614
====================================================
  Execution time = 4.5600e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2439e+01
  VMC Evar = 5.6908e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4973e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569130578730
                                         uncertainty =       0.006627013863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569130578730
                                         uncertainty =       0.006627013863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533421370
  error estimate for blocks of size 2^( 2) =       0.000553613996
  error estimate for blocks of size 2^( 3) =       0.000572416747
  error estimate for blocks of size 2^( 4) =       0.000585886431
  error estimate for blocks of size 2^( 5) =       0.000594278163
  error estimate for blocks of size 2^( 6) =       0.000598525725
  error estimate for blocks of size 2^( 7) =       0.000602244011

      target function =                  N/A
              le_mean =     -22.438607072864
             les_mean =     504.060163802283
             stat err =       0.000595233582
             autocorr =       1.245185428918
              std dev =       0.754371736234
             le_variance =       0.569076716429


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243860707286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438607072864       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438607072985       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438607073156       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438607073172       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438607073253       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438607073329       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438607073320       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438607073396       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438607073420       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438607073377       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+03 is 6.608870e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438607072864       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438607072894       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438607072937       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438607072938       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438607072956       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438607072977       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438607073015       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438607072933       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438607073032       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438607073046       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+04 is 1.652237e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438607072864       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438607072872       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438607072882       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438607072881       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438607072906       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438607072891       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438607072892       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438607072680       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438607073131       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438607073038       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+04 is 4.130606e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.539101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0581e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409429e-02 1 1  ON 2
 uu_3                -9.510333e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697958e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964710e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085394e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147092e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325477e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173266e-02 1 1  ON 41
eH1_2                -4.147469e-02 1 1  ON 42
eH1_3                -3.994487e-02 1 1  ON 43
eH1_4                -2.203973e-03 1 1  ON 44
eH1_5                 1.033582e-02 1 1  ON 45
eH1_6                 4.266273e-02 1 1  ON 46
eH1_7                 5.924128e-02 1 1  ON 47
eH1_8                 3.452136e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334071e-02 1 1  ON 52
eH2_3                -5.229345e-02 1 1  ON 53
eH2_4                -1.447509e-02 1 1  ON 54
eH2_5                -2.544615e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662733e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.4497
    reference variance = 1.51653
====================================================
  Execution time = 4.3136e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6022e-01
  Total weights = 2.0000e+06
  Execution time = 3.5720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559973462564
                                         uncertainty =       0.003860178893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559973462564
                                         uncertainty =       0.003860178893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529255497
  error estimate for blocks of size 2^( 2) =       0.000549669120
  error estimate for blocks of size 2^( 3) =       0.000567891929
  error estimate for blocks of size 2^( 4) =       0.000581838303
  error estimate for blocks of size 2^( 5) =       0.000590420772
  error estimate for blocks of size 2^( 6) =       0.000596152202
  error estimate for blocks of size 2^( 7) =       0.000599316584

      target function =                  N/A
              le_mean =     -22.437718640549
             les_mean =     504.011440274738
             stat err =       0.000591931965
             autocorr =       1.250871885986
              std dev =       0.748480301946
             le_variance =       0.560222762402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559973474404
                                         uncertainty =       0.003860178644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559973474404
                                         uncertainty =       0.003860178644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529255503
  error estimate for blocks of size 2^( 2) =       0.000549669125
  error estimate for blocks of size 2^( 3) =       0.000567891934
  error estimate for blocks of size 2^( 4) =       0.000581838308
  error estimate for blocks of size 2^( 5) =       0.000590420777
  error estimate for blocks of size 2^( 6) =       0.000596152206
  error estimate for blocks of size 2^( 7) =       0.000599316588

      target function =                  N/A
              le_mean =     -22.437718640199
             les_mean =     504.011440270824
             stat err =       0.000591931970
             autocorr =       1.250871878385
              std dev =       0.748480309830
             le_variance =       0.560222774204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559973468485
                                         uncertainty =       0.003860178769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559973468485
                                         uncertainty =       0.003860178769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529255500
  error estimate for blocks of size 2^( 2) =       0.000549669122
  error estimate for blocks of size 2^( 3) =       0.000567891931
  error estimate for blocks of size 2^( 4) =       0.000581838306
  error estimate for blocks of size 2^( 5) =       0.000590420774
  error estimate for blocks of size 2^( 6) =       0.000596152204
  error estimate for blocks of size 2^( 7) =       0.000599316586

      target function =                  N/A
              le_mean =     -22.437718640374
             les_mean =     504.011440272781
             stat err =       0.000591931968
             autocorr =       1.250871882179
              std dev =       0.748480305889
             le_variance =       0.560222768304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559973463304
                                         uncertainty =       0.003860178878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559973463304
                                         uncertainty =       0.003860178878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529255497
  error estimate for blocks of size 2^( 2) =       0.000549669120
  error estimate for blocks of size 2^( 3) =       0.000567891929
  error estimate for blocks of size 2^( 4) =       0.000581838303
  error estimate for blocks of size 2^( 5) =       0.000590420772
  error estimate for blocks of size 2^( 6) =       0.000596152203
  error estimate for blocks of size 2^( 7) =       0.000599316584

      target function =                  N/A
              le_mean =     -22.437718640527
             les_mean =     504.011440274494
             stat err =       0.000591931966
             autocorr =       1.250871885508
              std dev =       0.748480302439
             le_variance =       0.560222763139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437718640549        initial  <--
     3.6380e+03     3.6380e+04             6.6089e-08       -22.437718640199
     1.4552e+04     1.4552e+05             1.6522e-08       -22.437718640374
     5.8208e+04     5.8208e+05             4.1306e-09       -22.437718640527

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0652
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510333e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964712e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325477e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173267e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994487e-02 1 1  ON 43
eH1_4                -2.203971e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266273e-02 1 1  ON 46
eH1_7                 5.924129e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229346e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544623e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662734e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2167e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2443e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.3308
    reference variance = 2.00074
====================================================
  Execution time = 4.3456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2439e+01
  VMC Evar = 5.6049e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5170e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560463692832
                                         uncertainty =       0.003895587976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560463692832
                                         uncertainty =       0.003895587976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529381944
  error estimate for blocks of size 2^( 2) =       0.000549046701
  error estimate for blocks of size 2^( 3) =       0.000568159983
  error estimate for blocks of size 2^( 4) =       0.000582374853
  error estimate for blocks of size 2^( 5) =       0.000591129948
  error estimate for blocks of size 2^( 6) =       0.000594668120
  error estimate for blocks of size 2^( 7) =       0.000595336068

      target function =                  N/A
              le_mean =     -22.438836685308
             les_mean =     504.061881994789
             stat err =       0.000590877247
             autocorr =       1.245822830020
              std dev =       0.748659124776
             le_variance =       0.560490485111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243883668531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438836685308       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438836685300       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438836685275       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438836685293       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438836685279       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438836685285       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438836685248       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438836685325       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438836685219       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438836685271       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+04 is 6.586106e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438836685308       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438836685306       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438836685300       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438836685299       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438836685300       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438836685238       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438836685203       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438836685320       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438836685326       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438836685310       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+05 is 1.646529e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438836685308       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438836685307       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438836685306       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438836685385       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438836685306       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438836685218       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438836685320       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438836685513       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438836685379       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438836685571       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+05 is 4.116319e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.542789 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8634e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409430e-02 1 1  ON 2
 uu_3                -9.510333e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964713e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325477e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173268e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994487e-02 1 1  ON 43
eH1_4                -2.203971e-03 1 1  ON 44
eH1_5                 1.033583e-02 1 1  ON 45
eH1_6                 4.266273e-02 1 1  ON 46
eH1_7                 5.924129e-02 1 1  ON 47
eH1_8                 3.452135e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229346e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544623e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662734e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.4971
    reference variance = 0.360499
====================================================
  Execution time = 4.3418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.8183e-01
  Total weights = 2.0000e+06
  Execution time = 3.5799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581849478716
                                         uncertainty =       0.017050352107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581849478716
                                         uncertainty =       0.017050352107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539367366
  error estimate for blocks of size 2^( 2) =       0.000558901848
  error estimate for blocks of size 2^( 3) =       0.000576851254
  error estimate for blocks of size 2^( 4) =       0.000591466459
  error estimate for blocks of size 2^( 5) =       0.000599847097
  error estimate for blocks of size 2^( 6) =       0.000604688803
  error estimate for blocks of size 2^( 7) =       0.000608117165

      target function =                  N/A
              le_mean =     -22.436666781593
             les_mean =     503.985850288672
             stat err =       0.000601029881
             autocorr =       1.241717481253
              std dev =       0.762780644329
             le_variance =       0.581834311363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581849478378
                                         uncertainty =       0.017050352220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581849478378
                                         uncertainty =       0.017050352220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539367366
  error estimate for blocks of size 2^( 2) =       0.000558901848
  error estimate for blocks of size 2^( 3) =       0.000576851254
  error estimate for blocks of size 2^( 4) =       0.000591466459
  error estimate for blocks of size 2^( 5) =       0.000599847097
  error estimate for blocks of size 2^( 6) =       0.000604688803
  error estimate for blocks of size 2^( 7) =       0.000608117165

      target function =                  N/A
              le_mean =     -22.436666781614
             les_mean =     503.985850289287
             stat err =       0.000601029881
             autocorr =       1.241717481426
              std dev =       0.762780644110
             le_variance =       0.581834311028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581849478547
                                         uncertainty =       0.017050352164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581849478547
                                         uncertainty =       0.017050352164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539367366
  error estimate for blocks of size 2^( 2) =       0.000558901848
  error estimate for blocks of size 2^( 3) =       0.000576851254
  error estimate for blocks of size 2^( 4) =       0.000591466459
  error estimate for blocks of size 2^( 5) =       0.000599847097
  error estimate for blocks of size 2^( 6) =       0.000604688803
  error estimate for blocks of size 2^( 7) =       0.000608117165

      target function =                  N/A
              le_mean =     -22.436666781603
             les_mean =     503.985850288979
             stat err =       0.000601029881
             autocorr =       1.241717481338
              std dev =       0.762780644219
             le_variance =       0.581834311196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581849478695
                                         uncertainty =       0.017050352114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581849478695
                                         uncertainty =       0.017050352114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539367366
  error estimate for blocks of size 2^( 2) =       0.000558901848
  error estimate for blocks of size 2^( 3) =       0.000576851254
  error estimate for blocks of size 2^( 4) =       0.000591466459
  error estimate for blocks of size 2^( 5) =       0.000599847097
  error estimate for blocks of size 2^( 6) =       0.000604688803
  error estimate for blocks of size 2^( 7) =       0.000608117165

      target function =                  N/A
              le_mean =     -22.436666781594
             les_mean =     503.985850288711
             stat err =       0.000601029881
             autocorr =       1.241717481266
              std dev =       0.762780644315
             le_variance =       0.581834311342


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436666781593        initial
     3.6380e+04     3.6380e+05             6.5861e-09       -22.436666781614  <--
     1.4552e+05     1.4552e+06             1.6465e-09       -22.436666781603
     5.8208e+05     5.8208e+06             4.1163e-10       -22.436666781594

*****************************************************************************
Applying the update for shift_i =   3.6380e+04     and shift_s =   3.6380e+05
*****************************************************************************

  Execution time = 6.1341e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409429e-02 1 1  ON 2
 uu_3                -9.510333e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419156e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666303e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964714e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085393e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325477e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173268e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994487e-02 1 1  ON 43
eH1_4                -2.203970e-03 1 1  ON 44
eH1_5                 1.033582e-02 1 1  ON 45
eH1_6                 4.266273e-02 1 1  ON 46
eH1_7                 5.924128e-02 1 1  ON 47
eH1_8                 3.452136e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229346e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544623e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662734e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1998e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.375
    reference variance = 0.560123
====================================================
  Execution time = 4.3683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7281e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5037e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572463298604
                                         uncertainty =       0.007955811824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572463298604
                                         uncertainty =       0.007955811824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535169143
  error estimate for blocks of size 2^( 2) =       0.000554818126
  error estimate for blocks of size 2^( 3) =       0.000573400341
  error estimate for blocks of size 2^( 4) =       0.000586616173
  error estimate for blocks of size 2^( 5) =       0.000595154992
  error estimate for blocks of size 2^( 6) =       0.000600263288
  error estimate for blocks of size 2^( 7) =       0.000602299235

      target function =                  N/A
              le_mean =     -22.436319495375
             les_mean =     503.961244235653
             stat err =       0.000596083422
             autocorr =       1.240600515114
              std dev =       0.756843460369
             le_variance =       0.572812023503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243631949538e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436319495375       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436319495360       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436319495351       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436319495397       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436319495340       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436319495331       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436319495407       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436319495365       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436319495354       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436319495385       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+03 is 2.532958e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436319495375       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436319495371       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436319495369       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436319495376       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436319495356       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436319495329       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436319495328       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436319495324       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436319495381       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436319495355       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+04 is 6.332429e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436319495375       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436319495374       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436319495374       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436319495377       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436319495429       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436319495329       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436319494874       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436319495486       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436319495081       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436319495587       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+05 is 1.583110e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.546444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8728e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409429e-02 1 1  ON 2
 uu_3                -9.510333e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419155e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666302e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697959e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964714e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085394e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325477e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173267e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203969e-03 1 1  ON 44
eH1_5                 1.033582e-02 1 1  ON 45
eH1_6                 4.266273e-02 1 1  ON 46
eH1_7                 5.924128e-02 1 1  ON 47
eH1_8                 3.452136e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337593e-02 1 1  ON 51
eH2_2                -5.334070e-02 1 1  ON 52
eH2_3                -5.229346e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544620e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662734e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.5208
    reference variance = 0.410812
====================================================
  Execution time = 4.5915e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6469e-01
  Total weights = 2.0000e+06
  Execution time = 3.5836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564847139502
                                         uncertainty =       0.003967550246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564847139502
                                         uncertainty =       0.003967550246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531363023
  error estimate for blocks of size 2^( 2) =       0.000551236333
  error estimate for blocks of size 2^( 3) =       0.000569844177
  error estimate for blocks of size 2^( 4) =       0.000584559005
  error estimate for blocks of size 2^( 5) =       0.000592431436
  error estimate for blocks of size 2^( 6) =       0.000599198233
  error estimate for blocks of size 2^( 7) =       0.000598812027

      target function =                  N/A
              le_mean =     -22.437904935325
             les_mean =     504.024270928622
             stat err =       0.000593750175
             autocorr =       1.248604349387
              std dev =       0.751460793581
             le_variance =       0.564693324290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564847162452
                                         uncertainty =       0.003967550362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564847162452
                                         uncertainty =       0.003967550362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531363034
  error estimate for blocks of size 2^( 2) =       0.000551236343
  error estimate for blocks of size 2^( 3) =       0.000569844187
  error estimate for blocks of size 2^( 4) =       0.000584559014
  error estimate for blocks of size 2^( 5) =       0.000592431444
  error estimate for blocks of size 2^( 6) =       0.000599198242
  error estimate for blocks of size 2^( 7) =       0.000598812035

      target function =                  N/A
              le_mean =     -22.437904935383
             les_mean =     504.024270954199
             stat err =       0.000593750184
             autocorr =       1.248604335655
              std dev =       0.751460808857
             le_variance =       0.564693347248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564847150978
                                         uncertainty =       0.003967550304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564847150978
                                         uncertainty =       0.003967550304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531363028
  error estimate for blocks of size 2^( 2) =       0.000551236338
  error estimate for blocks of size 2^( 3) =       0.000569844182
  error estimate for blocks of size 2^( 4) =       0.000584559010
  error estimate for blocks of size 2^( 5) =       0.000592431440
  error estimate for blocks of size 2^( 6) =       0.000599198237
  error estimate for blocks of size 2^( 7) =       0.000598812031

      target function =                  N/A
              le_mean =     -22.437904935354
             les_mean =     504.024270941411
             stat err =       0.000593750179
             autocorr =       1.248604342524
              std dev =       0.751460801219
             le_variance =       0.564693335769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564847140936
                                         uncertainty =       0.003967550254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564847140936
                                         uncertainty =       0.003967550254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531363024
  error estimate for blocks of size 2^( 2) =       0.000551236333
  error estimate for blocks of size 2^( 3) =       0.000569844178
  error estimate for blocks of size 2^( 4) =       0.000584559006
  error estimate for blocks of size 2^( 5) =       0.000592431436
  error estimate for blocks of size 2^( 6) =       0.000599198233
  error estimate for blocks of size 2^( 7) =       0.000598812027

      target function =                  N/A
              le_mean =     -22.437904935329
             les_mean =     504.024270930221
             stat err =       0.000593750176
             autocorr =       1.248604348519
              std dev =       0.751460794536
             le_variance =       0.564693325725


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437904935325        initial
     9.0949e+03     9.0949e+04             2.5330e-08       -22.437904935383  <--
     3.6380e+04     3.6380e+05             6.3324e-09       -22.437904935354
     1.4552e+05     1.4552e+06             1.5831e-09       -22.437904935329

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 6.3884e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409428e-02 1 1  ON 2
 uu_3                -9.510333e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419155e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666302e-02 1 1  ON 12
 ud_3                -4.888583e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697958e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964713e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085394e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325477e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173266e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203967e-03 1 1  ON 44
eH1_5                 1.033581e-02 1 1  ON 45
eH1_6                 4.266273e-02 1 1  ON 46
eH1_7                 5.924126e-02 1 1  ON 47
eH1_8                 3.452136e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337592e-02 1 1  ON 51
eH2_2                -5.334071e-02 1 1  ON 52
eH2_3                -5.229346e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544611e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662733e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2262e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28968 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.3763
    reference variance = 0.437834
====================================================
  Execution time = 4.4041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6689e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5014e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566841570683
                                         uncertainty =       0.004332596699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566841570683
                                         uncertainty =       0.004332596699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532393503
  error estimate for blocks of size 2^( 2) =       0.000552703198
  error estimate for blocks of size 2^( 3) =       0.000571299003
  error estimate for blocks of size 2^( 4) =       0.000584799608
  error estimate for blocks of size 2^( 5) =       0.000592571466
  error estimate for blocks of size 2^( 6) =       0.000595458686
  error estimate for blocks of size 2^( 7) =       0.000596272341

      target function =                  N/A
              le_mean =     -22.437115549563
             les_mean =     503.991039584988
             stat err =       0.000592275525
             autocorr =       1.237605068354
              std dev =       0.752918112409
             le_variance =       0.566885683994


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243711554956e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437115549563       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437115549729       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437115549649       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437115549385       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437115549580       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437115549875       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437115549769       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437115549814       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437115549779       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437115549783       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.2737e+03 is 1.132875e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437115549563       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437115549604       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437115549584       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437115549518       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437115549567       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437115549639       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437115549613       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437115549652       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437115549584       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437115549609       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+03 is 2.832255e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437115549563       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437115549573       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437115549568       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437115549552       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437115549552       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437115549583       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437115549560       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437115549590       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437115549654       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437115549601       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+04 is 7.080681e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.550101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9062e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271236e-02 1 1  ON 1
 uu_2                -2.409427e-02 1 1  ON 2
 uu_3                -9.510332e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811520e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419155e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666301e-02 1 1  ON 12
 ud_3                -4.888582e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697958e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964711e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983915e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085395e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147092e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325477e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173266e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994489e-02 1 1  ON 43
eH1_4                -2.203958e-03 1 1  ON 44
eH1_5                 1.033581e-02 1 1  ON 45
eH1_6                 4.266276e-02 1 1  ON 46
eH1_7                 5.924123e-02 1 1  ON 47
eH1_8                 3.452136e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337592e-02 1 1  ON 51
eH2_2                -5.334069e-02 1 1  ON 52
eH2_3                -5.229344e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544613e-03 1 1  ON 55
eH2_6                 3.051393e-02 1 1  ON 56
eH2_7                 4.662731e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.4833
    reference variance = 0.598374
====================================================
  Execution time = 4.3250e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6993e-01
  Total weights = 2.0000e+06
  Execution time = 3.5860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570062192192
                                         uncertainty =       0.005825304503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570062192192
                                         uncertainty =       0.005825304503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533820404
  error estimate for blocks of size 2^( 2) =       0.000554039718
  error estimate for blocks of size 2^( 3) =       0.000572752954
  error estimate for blocks of size 2^( 4) =       0.000586130769
  error estimate for blocks of size 2^( 5) =       0.000595136885
  error estimate for blocks of size 2^( 6) =       0.000600462207
  error estimate for blocks of size 2^( 7) =       0.000600828814

      target function =                  N/A
              le_mean =     -22.437113366083
             les_mean =     503.993984364021
             stat err =       0.000595639669
             autocorr =       1.245021606502
              std dev =       0.754936054596
             le_variance =       0.569928446529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570062286411
                                         uncertainty =       0.005825306454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570062286411
                                         uncertainty =       0.005825306454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533820448
  error estimate for blocks of size 2^( 2) =       0.000554039759
  error estimate for blocks of size 2^( 3) =       0.000572752992
  error estimate for blocks of size 2^( 4) =       0.000586130806
  error estimate for blocks of size 2^( 5) =       0.000595136922
  error estimate for blocks of size 2^( 6) =       0.000600462247
  error estimate for blocks of size 2^( 7) =       0.000600828854

      target function =                  N/A
              le_mean =     -22.437113365262
             les_mean =     503.993984421358
             stat err =       0.000595639707
             autocorr =       1.245021561705
              std dev =       0.754936116956
             le_variance =       0.569928540684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570062239310
                                         uncertainty =       0.005825305479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570062239310
                                         uncertainty =       0.005825305479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533820426
  error estimate for blocks of size 2^( 2) =       0.000554039739
  error estimate for blocks of size 2^( 3) =       0.000572752973
  error estimate for blocks of size 2^( 4) =       0.000586130788
  error estimate for blocks of size 2^( 5) =       0.000595136903
  error estimate for blocks of size 2^( 6) =       0.000600462227
  error estimate for blocks of size 2^( 7) =       0.000600828834

      target function =                  N/A
              le_mean =     -22.437113365673
             les_mean =     503.993984392696
             stat err =       0.000595639688
             autocorr =       1.245021584102
              std dev =       0.754936085782
             le_variance =       0.569928493615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570062198082
                                         uncertainty =       0.005825304625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570062198082
                                         uncertainty =       0.005825304625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533820406
  error estimate for blocks of size 2^( 2) =       0.000554039721
  error estimate for blocks of size 2^( 3) =       0.000572752957
  error estimate for blocks of size 2^( 4) =       0.000586130771
  error estimate for blocks of size 2^( 5) =       0.000595136887
  error estimate for blocks of size 2^( 6) =       0.000600462210
  error estimate for blocks of size 2^( 7) =       0.000600828817

      target function =                  N/A
              le_mean =     -22.437113366032
             les_mean =     503.993984367606
             stat err =       0.000595639671
             autocorr =       1.245021603705
              std dev =       0.754936058494
             le_variance =       0.569928452415


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437113366083        initial  <--
     2.2737e+03     2.2737e+04             1.1329e-07       -22.437113365262
     9.0949e+03     9.0949e+04             2.8323e-08       -22.437113365673
     3.6380e+04     3.6380e+05             7.0807e-09       -22.437113366032

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2515
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.683864e-01 1 1  ON 0
 uu_1                 9.271235e-02 1 1  ON 1
 uu_2                -2.409428e-02 1 1  ON 2
 uu_3                -9.510333e-02 1 1  ON 3
 uu_4                -1.375596e-01 1 1  ON 4
 uu_5                -1.639758e-01 1 1  ON 5
 uu_6                -1.782771e-01 1 1  ON 6
 uu_7                -1.811519e-01 1 1  ON 7
 uu_8                -1.704066e-01 1 1  ON 8
 uu_9                -1.419155e-01 1 1  ON 9
 ud_0                 4.719275e-01 1 1  ON 10
 ud_1                 1.876672e-01 1 1  ON 11
 ud_2                 3.666302e-02 1 1  ON 12
 ud_3                -4.888583e-02 1 1  ON 13
 ud_4                -1.002529e-01 1 1  ON 14
 ud_5                -1.351738e-01 1 1  ON 15
 ud_6                -1.581942e-01 1 1  ON 16
 ud_7                -1.697958e-01 1 1  ON 17
 ud_8                -1.668620e-01 1 1  ON 18
 ud_9                -1.449688e-01 1 1  ON 19
 eC_0                -6.978034e-01 1 1  ON 20
 eC_1                -5.224875e-01 1 1  ON 21
 eC_2                -2.159361e-01 1 1  ON 22
 eC_3                 7.964713e-03 1 1  ON 23
 eC_4                 1.556416e-01 1 1  ON 24
 eC_5                 2.777823e-01 1 1  ON 25
 eC_6                 2.983916e-01 1 1  ON 26
 eC_7                 3.664550e-01 1 1  ON 27
 eC_8                 2.775846e-01 1 1  ON 28
 eC_9                 5.085394e-02 1 1  ON 29
 eO_0                -1.244616e+00 1 1  ON 30
 eO_1                -8.515301e-01 1 1  ON 31
 eO_2                -3.587971e-01 1 1  ON 32
 eO_3                -3.147091e-02 1 1  ON 33
 eO_4                 1.975657e-01 1 1  ON 34
 eO_5                 3.457445e-01 1 1  ON 35
 eO_6                 3.960462e-01 1 1  ON 36
 eO_7                 4.470394e-01 1 1  ON 37
 eO_8                 5.325477e-01 1 1  ON 38
 eO_9                 4.019391e-01 1 1  ON 39
eH1_0                -1.621417e-01 1 1  ON 40
eH1_1                -6.173266e-02 1 1  ON 41
eH1_2                -4.147468e-02 1 1  ON 42
eH1_3                -3.994488e-02 1 1  ON 43
eH1_4                -2.203967e-03 1 1  ON 44
eH1_5                 1.033581e-02 1 1  ON 45
eH1_6                 4.266273e-02 1 1  ON 46
eH1_7                 5.924126e-02 1 1  ON 47
eH1_8                 3.452136e-02 1 1  ON 48
eH1_9                 6.046623e-02 1 1  ON 49
eH2_0                -1.731626e-01 1 1  ON 50
eH2_1                -7.337592e-02 1 1  ON 51
eH2_2                -5.334071e-02 1 1  ON 52
eH2_3                -5.229346e-02 1 1  ON 53
eH2_4                -1.447510e-02 1 1  ON 54
eH2_5                -2.544611e-03 1 1  ON 55
eH2_6                 3.051394e-02 1 1  ON 56
eH2_7                 4.662733e-02 1 1  ON 57
eH2_8                 2.703590e-02 1 1  ON 58
eH2_9                 1.141802e-01 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2032e+02 secs
  Total Execution time = 4.8506e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
