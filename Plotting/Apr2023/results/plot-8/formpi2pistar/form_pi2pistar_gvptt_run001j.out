Rank =    0  Free Memory = 83378 MB
Rank =    1  Free Memory = 83378 MB
Rank =    2  Free Memory = 83378 MB
Rank =    3  Free Memory = 83378 MB
Rank =    4  Free Memory = 83378 MB
Rank =    5  Free Memory = 83378 MB
Rank =    6  Free Memory = 83378 MB
Rank =    7  Free Memory = 83377 MB
Rank =    8  Free Memory = 83377 MB
Rank =    9  Free Memory = 83377 MB
Rank =   10  Free Memory = 83377 MB
Rank =   11  Free Memory = 83377 MB
Rank =   12  Free Memory = 83377 MB
Rank =   13  Free Memory = 83377 MB
Rank =   14  Free Memory = 83377 MB
Rank =   15  Free Memory = 83363 MB
Rank =   16  Free Memory = 83363 MB
Rank =   17  Free Memory = 83363 MB
Rank =   18  Free Memory = 83363 MB
Rank =   19  Free Memory = 83363 MB
Rank =   20  Free Memory = 83363 MB
Rank =   21  Free Memory = 83363 MB
Rank =   22  Free Memory = 83363 MB
Rank =   23  Free Memory = 83363 MB
Rank =   24  Free Memory = 83363 MB
Rank =   25  Free Memory = 83363 MB
Rank =   26  Free Memory = 83363 MB
Rank =   27  Free Memory = 83363 MB
Rank =   28  Free Memory = 83363 MB
Rank =   29  Free Memory = 83363 MB
Rank =   30  Free Memory = 83363 MB
Rank =   31  Free Memory = 83363 MB
Rank =   32  Free Memory = 88416 MB
Rank =   33  Free Memory = 88416 MB
Rank =   34  Free Memory = 88416 MB
Rank =   35  Free Memory = 88416 MB
Rank =   36  Free Memory = 88416 MB
Rank =   37  Free Memory = 88416 MB
Rank =   38  Free Memory = 88416 MB
Rank =   39  Free Memory = 88416 MB
Rank =   40  Free Memory = 88416 MB
Rank =   41  Free Memory = 88416 MB
Rank =   42  Free Memory = 88416 MB
Rank =   43  Free Memory = 88416 MB
Rank =   44  Free Memory = 88416 MB
Rank =   45  Free Memory = 88416 MB
Rank =   46  Free Memory = 88416 MB
Rank =   47  Free Memory = 88416 MB
Rank =   48  Free Memory = 88416 MB
Rank =   49  Free Memory = 88416 MB
Rank =   50  Free Memory = 88416 MB
Rank =   51  Free Memory = 88416 MB
Rank =   52  Free Memory = 88416 MB
Rank =   53  Free Memory = 88416 MB
Rank =   54  Free Memory = 88416 MB
Rank =   55  Free Memory = 88416 MB
Rank =   56  Free Memory = 88416 MB
Rank =   57  Free Memory = 88416 MB
Rank =   58  Free Memory = 88416 MB
Rank =   59  Free Memory = 88416 MB
Rank =   60  Free Memory = 88416 MB
Rank =   61  Free Memory = 88416 MB
Rank =   62  Free Memory = 88416 MB
Rank =   63  Free Memory = 88416 MB
Rank =   64  Free Memory = 88014 MB
Rank =   65  Free Memory = 88014 MB
Rank =   66  Free Memory = 88014 MB
Rank =   67  Free Memory = 88014 MB
Rank =   68  Free Memory = 88014 MB
Rank =   69  Free Memory = 88014 MB
Rank =   70  Free Memory = 88014 MB
Rank =   71  Free Memory = 88014 MB
Rank =   72  Free Memory = 88014 MB
Rank =   73  Free Memory = 88014 MB
Rank =   74  Free Memory = 88014 MB
Rank =   75  Free Memory = 88014 MB
Rank =   76  Free Memory = 88014 MB
Rank =   77  Free Memory = 88014 MB
Rank =   78  Free Memory = 88014 MB
Rank =   79  Free Memory = 88014 MB
Rank =   80  Free Memory = 88014 MB
Rank =   81  Free Memory = 88014 MB
Rank =   82  Free Memory = 88014 MB
Rank =   83  Free Memory = 88014 MB
Rank =   84  Free Memory = 88014 MB
Rank =   85  Free Memory = 88014 MB
Rank =   86  Free Memory = 88014 MB
Rank =   87  Free Memory = 88014 MB
Rank =   88  Free Memory = 88014 MB
Rank =   89  Free Memory = 88014 MB
Rank =   90  Free Memory = 88014 MB
Rank =   91  Free Memory = 88014 MB
Rank =   92  Free Memory = 88014 MB
Rank =   93  Free Memory = 88014 MB
Rank =   94  Free Memory = 88014 MB
Rank =   95  Free Memory = 88014 MB
Rank =   96  Free Memory = 88515 MB
Rank =   97  Free Memory = 88515 MB
Rank =   98  Free Memory = 88515 MB
Rank =   99  Free Memory = 88515 MB
Rank =  100  Free Memory = 88515 MB
Rank =  101  Free Memory = 88515 MB
Rank =  102  Free Memory = 88515 MB
Rank =  103  Free Memory = 88515 MB
Rank =  104  Free Memory = 88515 MB
Rank =  105  Free Memory = 88515 MB
Rank =  106  Free Memory = 88515 MB
Rank =  107  Free Memory = 88515 MB
Rank =  108  Free Memory = 88515 MB
Rank =  109  Free Memory = 88515 MB
Rank =  110  Free Memory = 88515 MB
Rank =  111  Free Memory = 88515 MB
Rank =  112  Free Memory = 88515 MB
Rank =  113  Free Memory = 88515 MB
Rank =  114  Free Memory = 88515 MB
Rank =  115  Free Memory = 88515 MB
Rank =  116  Free Memory = 88515 MB
Rank =  117  Free Memory = 88515 MB
Rank =  118  Free Memory = 88515 MB
Rank =  119  Free Memory = 88515 MB
Rank =  120  Free Memory = 88515 MB
Rank =  121  Free Memory = 88515 MB
Rank =  122  Free Memory = 88515 MB
Rank =  123  Free Memory = 88515 MB
Rank =  124  Free Memory = 88515 MB
Rank =  125  Free Memory = 88515 MB
Rank =  126  Free Memory = 88515 MB
Rank =  127  Free Memory = 88515 MB
  Input file(s): opt_form_pi2pistar_gvptt_run001j.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_pi2pistar_gvptt_run001j.xml

  Project = FORM
  date    = 2023-03-31 09:33:25 PDT
  host    = n0080.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 853

  Range of prime numbers to use as seeds over processors and threads = 6619-7753


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.641307e-01    1         1  ON     0
     uu_1                 8.852838e-02    1         1  ON     1
     uu_2                -2.782806e-02    1         1  ON     2
     uu_3                -9.841896e-02    1         1  ON     3
     uu_4                -1.404265e-01    1         1  ON     4
     uu_5                -1.663363e-01    1         1  ON     5
     uu_6                -1.800050e-01    1         1  ON     6
     uu_7                -1.821306e-01    1         1  ON     7
     uu_8                -1.681300e-01    1         1  ON     8
     uu_9                -1.354449e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.672512e-01    1         1  ON     0
     ud_1                 1.828483e-01    1         1  ON     1
     ud_2                 3.200608e-02    1         1  ON     2
     ud_3                -5.294830e-02    1         1  ON     3
     ud_4                -1.035054e-01    1         1  ON     4
     ud_5                -1.373827e-01    1         1  ON     5
     ud_6                -1.589786e-01    1         1  ON     6
     ud_7                -1.687585e-01    1         1  ON     7
     ud_8                -1.625727e-01    1         1  ON     8
     ud_9                -1.388620e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -6.945148e-01    1         1  ON     0
     eC_1                -5.200213e-01    1         1  ON     1
     eC_2                -2.124615e-01    1         1  ON     2
     eC_3                 1.211201e-02    1         1  ON     3
     eC_4                 1.597209e-01    1         1  ON     4
     eC_5                 2.842268e-01    1         1  ON     5
     eC_6                 2.996270e-01    1         1  ON     6
     eC_7                 3.355164e-01    1         1  ON     7
     eC_8                 2.666390e-01    1         1  ON     8
     eC_9                 6.868577e-02    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.227559e+00    1         1  ON     0
     eO_1                -8.348162e-01    1         1  ON     1
     eO_2                -3.452085e-01    1         1  ON     2
     eO_3                -2.201407e-02    1         1  ON     3
     eO_4                 2.025339e-01    1         1  ON     4
     eO_5                 3.449468e-01    1         1  ON     5
     eO_6                 3.881449e-01    1         1  ON     6
     eO_7                 4.283244e-01    1         1  ON     7
     eO_8                 4.829838e-01    1         1  ON     8
     eO_9                 4.033818e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.610007e-01    1         1  ON     0
     eH1_1                -6.110892e-02    1         1  ON     1
     eH1_2                -4.182482e-02    1         1  ON     2
     eH1_3                -4.203415e-02    1         1  ON     3
     eH1_4                -6.073995e-03    1         1  ON     4
     eH1_5                 4.174791e-03    1         1  ON     5
     eH1_6                 3.504566e-02    1         1  ON     6
     eH1_7                 4.294977e-02    1         1  ON     7
     eH1_8                 3.258417e-02    1         1  ON     8
     eH1_9                 7.840532e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.675308e-01    1         1  ON     0
     eH2_1                -6.710286e-02    1         1  ON     1
     eH2_2                -4.841738e-02    1         1  ON     2
     eH2_3                -4.863750e-02    1         1  ON     3
     eH2_4                -1.300092e-02    1         1  ON     4
     eH2_5                -2.779187e-03    1         1  ON     5
     eH2_6                 2.824435e-02    1         1  ON     6
     eH2_7                 3.894044e-02    1         1  ON     7
     eH2_8                 2.793149e-02    1         1  ON     8
     eH2_9                 9.287848e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 140 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 7.847221e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 28 unique up determinants.
Found 28 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.8259e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  4.0107225728e-02 -5.0659535091e-01 -4.8356690577e-01
    u -2.0203417087e-01 -1.2691590666e+00 -2.1169263951e+00
    u  2.9913287695e-01 -2.3710879234e-01  2.0101719070e+00
    u  4.8474243406e-02 -5.3051852953e-01  9.5378285444e-01
    u -5.5511775119e-01 -9.8683271286e-02  1.4043240644e+00
    u  6.9646297924e-01  2.5004217823e+00 -2.4744046405e+00
    d -1.1004432466e+00 -7.1118992563e-01 -1.4300801983e+00
    d -3.6824818327e-02  7.5687344105e-01 -1.6708867165e+00
    d -9.4375526199e-01  1.5348935511e-01  1.1974289766e+00
    d -8.9321447322e-02 -6.9596903295e-02  1.4810785623e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.3517
    reference variance = 0.547119
====================================================
  Execution time = 4.6146e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5814e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4906e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558255108883
                                         uncertainty =       0.004415149139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558255108883
                                         uncertainty =       0.004415149139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528271345
  error estimate for blocks of size 2^( 2) =       0.000548451382
  error estimate for blocks of size 2^( 3) =       0.000567068287
  error estimate for blocks of size 2^( 4) =       0.000581159867
  error estimate for blocks of size 2^( 5) =       0.000589469793
  error estimate for blocks of size 2^( 6) =       0.000595036183
  error estimate for blocks of size 2^( 7) =       0.000599193309

      target function =                  N/A
              le_mean =     -22.436544412642
             les_mean =     503.956666130036
             stat err =       0.000591214788
             autocorr =       1.252496348199
              std dev =       0.747088501206
             le_variance =       0.558141228635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.243654441264e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436544412642       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436545974566       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436547160156       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436547593022       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436548410325       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436548137602       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436548414527       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436547915973       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436547437230       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436547412321       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.436547640988       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.436547667392       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.436547738161       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 5.618873e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436544412642       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436545014480       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436545356147       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436545594420       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436546019797       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436545932685       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436545912943       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436545902231       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436545787414       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436545804758       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.022872e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436544412642       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436544586648       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436544679888       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436544754799       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436544893146       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436544878895       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436544858127       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436544870308       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436544852285       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436544857614       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 5.655004e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1248e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.641390e-01                 1 1 ON  0
uu_1  8.863539e-02                 1 1 ON  1
uu_2  -2.781795e-02                1 1 ON  2
uu_3  -9.844698e-02                1 1 ON  3
uu_4  -1.404096e-01                1 1 ON  4
uu_5  -1.663190e-01                1 1 ON  5
uu_6  -1.800531e-01                1 1 ON  6
uu_7  -1.820396e-01                1 1 ON  7
uu_8  -1.681446e-01                1 1 ON  8
uu_9  -1.354427e-01                1 1 ON  9
ud_0  4.672773e-01                 1 1 ON  10
ud_1  1.829100e-01                 1 1 ON  11
ud_2  3.204201e-02                 1 1 ON  12
ud_3  -5.287885e-02                1 1 ON  13
ud_4  -1.034190e-01                1 1 ON  14
ud_5  -1.373323e-01                1 1 ON  15
ud_6  -1.589028e-01                1 1 ON  16
ud_7  -1.687907e-01                1 1 ON  17
ud_8  -1.626724e-01                1 1 ON  18
ud_9  -1.389092e-01                1 1 ON  19
eC_0  -6.944510e-01                1 1 ON  20
eC_1  -5.201332e-01                1 1 ON  21
eC_2  -2.125481e-01                1 1 ON  22
eC_3  1.215390e-02                 1 1 ON  23
eC_4  1.598725e-01                 1 1 ON  24
eC_5  2.841820e-01                 1 1 ON  25
eC_6  2.995842e-01                 1 1 ON  26
eC_7  3.354564e-01                 1 1 ON  27
eC_8  2.666879e-01                 1 1 ON  28
eC_9  6.872119e-02                 1 1 ON  29
eO_0  -1.227620e+00                1 1 ON  30
eO_1  -8.348857e-01                1 1 ON  31
eO_2  -3.451595e-01                1 1 ON  32
eO_3  -2.191418e-02                1 1 ON  33
eO_4  2.024794e-01                 1 1 ON  34
eO_5  3.449740e-01                 1 1 ON  35
eO_6  3.880472e-01                 1 1 ON  36
eO_7  4.283275e-01                 1 1 ON  37
eO_8  4.829252e-01                 1 1 ON  38
eO_9  4.034593e-01                 1 1 ON  39
eH1_0 -1.609859e-01                1 1 ON  40
eH1_1 -6.106218e-02                1 1 ON  41
eH1_2 -4.192970e-02                1 1 ON  42
eH1_3 -4.199646e-02                1 1 ON  43
eH1_4 -6.054519e-03                1 1 ON  44
eH1_5 4.097995e-03                 1 1 ON  45
eH1_6 3.505997e-02                 1 1 ON  46
eH1_7 4.296959e-02                 1 1 ON  47
eH1_8 3.258612e-02                 1 1 ON  48
eH1_9 7.839062e-02                 1 1 ON  49
eH2_0 -1.675431e-01                1 1 ON  50
eH2_1 -6.718285e-02                1 1 ON  51
eH2_2 -4.850739e-02                1 1 ON  52
eH2_3 -4.843521e-02                1 1 ON  53
eH2_4 -1.288147e-02                1 1 ON  54
eH2_5 -2.822145e-03                1 1 ON  55
eH2_6 2.823620e-02                 1 1 ON  56
eH2_7 3.890640e-02                 1 1 ON  57
eH2_8 2.789816e-02                 1 1 ON  58
eH2_9 9.281010e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.4445
    reference variance = 0.552159
====================================================
  Execution time = 4.6367e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.8266e-01
  Total weights = 2.0000e+06
  Execution time = 3.8770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582591481648
                                         uncertainty =       0.019429072765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582591481648
                                         uncertainty =       0.019429072765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539734859
  error estimate for blocks of size 2^( 2) =       0.000559431401
  error estimate for blocks of size 2^( 3) =       0.000577490730
  error estimate for blocks of size 2^( 4) =       0.000591117428
  error estimate for blocks of size 2^( 5) =       0.000601063608
  error estimate for blocks of size 2^( 6) =       0.000607934851
  error estimate for blocks of size 2^( 7) =       0.000612124374

      target function =                  N/A
              le_mean =     -22.436544481422
             les_mean =     503.981155411220
             stat err =       0.000603060065
             autocorr =       1.248418526225
              std dev =       0.763300357456
             le_variance =       0.582627435693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582733759918
                                         uncertainty =       0.019430477648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582733759918
                                         uncertainty =       0.019430477648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539800705
  error estimate for blocks of size 2^( 2) =       0.000559492644
  error estimate for blocks of size 2^( 3) =       0.000577548700
  error estimate for blocks of size 2^( 4) =       0.000591173207
  error estimate for blocks of size 2^( 5) =       0.000601117057
  error estimate for blocks of size 2^( 6) =       0.000607990584
  error estimate for blocks of size 2^( 7) =       0.000612198373

      target function =                  N/A
              le_mean =     -22.436543318807
             les_mean =     503.981245407661
             stat err =       0.000603119805
             autocorr =       1.248361267606
              std dev =       0.763393478057
             le_variance =       0.582769602340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582665906060
                                         uncertainty =       0.019426858564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582665906060
                                         uncertainty =       0.019426858564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539769291
  error estimate for blocks of size 2^( 2) =       0.000559462658
  error estimate for blocks of size 2^( 3) =       0.000577520178
  error estimate for blocks of size 2^( 4) =       0.000591145400
  error estimate for blocks of size 2^( 5) =       0.000601089872
  error estimate for blocks of size 2^( 6) =       0.000607961883
  error estimate for blocks of size 2^( 7) =       0.000612165595

      target function =                  N/A
              le_mean =     -22.436543918701
             les_mean =     503.981204499915
             stat err =       0.000603090687
             autocorr =       1.248386027422
              std dev =       0.763349052186
             le_variance =       0.582701775473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582601791360
                                         uncertainty =       0.019428410700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582601791360
                                         uncertainty =       0.019428410700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539739628
  error estimate for blocks of size 2^( 2) =       0.000559435608
  error estimate for blocks of size 2^( 3) =       0.000577494592
  error estimate for blocks of size 2^( 4) =       0.000591121001
  error estimate for blocks of size 2^( 5) =       0.000601066949
  error estimate for blocks of size 2^( 6) =       0.000607938254
  error estimate for blocks of size 2^( 7) =       0.000612129877

      target function =                  N/A
              le_mean =     -22.436544356882
             les_mean =     503.981160119629
             stat err =       0.000603064020
             autocorr =       1.248412837838
              std dev =       0.763307102417
             le_variance =       0.582637732601


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436544481422        initial  <--
     2.5000e-01     2.5000e+00             5.6189e-04       -22.436543318807
     1.0000e+00     1.0000e+01             2.0229e-04       -22.436543918701
     4.0000e+00     4.0000e+01             5.6550e-05       -22.436544356882

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.5654
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.641307e-01 1 1  ON 0
 uu_1                 8.852838e-02 1 1  ON 1
 uu_2                -2.782806e-02 1 1  ON 2
 uu_3                -9.841896e-02 1 1  ON 3
 uu_4                -1.404265e-01 1 1  ON 4
 uu_5                -1.663363e-01 1 1  ON 5
 uu_6                -1.800050e-01 1 1  ON 6
 uu_7                -1.821306e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354449e-01 1 1  ON 9
 ud_0                 4.672512e-01 1 1  ON 10
 ud_1                 1.828483e-01 1 1  ON 11
 ud_2                 3.200608e-02 1 1  ON 12
 ud_3                -5.294830e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373827e-01 1 1  ON 15
 ud_6                -1.589786e-01 1 1  ON 16
 ud_7                -1.687585e-01 1 1  ON 17
 ud_8                -1.625727e-01 1 1  ON 18
 ud_9                -1.388620e-01 1 1  ON 19
 eC_0                -6.945148e-01 1 1  ON 20
 eC_1                -5.200213e-01 1 1  ON 21
 eC_2                -2.124615e-01 1 1  ON 22
 eC_3                 1.211201e-02 1 1  ON 23
 eC_4                 1.597209e-01 1 1  ON 24
 eC_5                 2.842268e-01 1 1  ON 25
 eC_6                 2.996270e-01 1 1  ON 26
 eC_7                 3.355164e-01 1 1  ON 27
 eC_8                 2.666390e-01 1 1  ON 28
 eC_9                 6.868577e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348162e-01 1 1  ON 31
 eO_2                -3.452085e-01 1 1  ON 32
 eO_3                -2.201407e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449468e-01 1 1  ON 35
 eO_6                 3.881449e-01 1 1  ON 36
 eO_7                 4.283244e-01 1 1  ON 37
 eO_8                 4.829838e-01 1 1  ON 38
 eO_9                 4.033818e-01 1 1  ON 39
eH1_0                -1.610007e-01 1 1  ON 40
eH1_1                -6.110892e-02 1 1  ON 41
eH1_2                -4.182482e-02 1 1  ON 42
eH1_3                -4.203415e-02 1 1  ON 43
eH1_4                -6.073995e-03 1 1  ON 44
eH1_5                 4.174791e-03 1 1  ON 45
eH1_6                 3.504566e-02 1 1  ON 46
eH1_7                 4.294977e-02 1 1  ON 47
eH1_8                 3.258417e-02 1 1  ON 48
eH1_9                 7.840532e-02 1 1  ON 49
eH2_0                -1.675308e-01 1 1  ON 50
eH2_1                -6.710286e-02 1 1  ON 51
eH2_2                -4.841738e-02 1 1  ON 52
eH2_3                -4.863750e-02 1 1  ON 53
eH2_4                -1.300092e-02 1 1  ON 54
eH2_5                -2.779187e-03 1 1  ON 55
eH2_6                 2.824435e-02 1 1  ON 56
eH2_7                 3.894044e-02 1 1  ON 57
eH2_8                 2.793149e-02 1 1  ON 58
eH2_9                 9.287848e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3082e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2398e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.3771
    reference variance = 0.398069
====================================================
  Execution time = 4.5324e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7005e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5023e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570122887326
                                         uncertainty =       0.008272877844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570122887326
                                         uncertainty =       0.008272877844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533878810
  error estimate for blocks of size 2^( 2) =       0.000553923094
  error estimate for blocks of size 2^( 3) =       0.000572001767
  error estimate for blocks of size 2^( 4) =       0.000585674750
  error estimate for blocks of size 2^( 5) =       0.000593717848
  error estimate for blocks of size 2^( 6) =       0.000598079669
  error estimate for blocks of size 2^( 7) =       0.000600001040

      target function =                  N/A
              le_mean =     -22.437598348026
             les_mean =     504.015872510586
             stat err =       0.000594368327
             autocorr =       1.239441257832
              std dev =       0.755018654269
             le_variance =       0.570053168294


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243759834803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437598348026       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437598750473       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437599105969       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437599322393       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437599392559       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437599483536       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437599403239       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437599487149       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437599484050       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437599452379       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.437599431982       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 9.245670e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437598348026       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437598457474       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437598556657       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437598616913       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437598631651       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437598673922       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437598656128       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437598669394       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437598668542       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437598661593       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 2.432030e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437598348026       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437598376002       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437598401553       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437598417038       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437598420552       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437598431497       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437598428112       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437598431259       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437598430970       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437598429299       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 6.165314e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0355e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.641310e-01 1 1  ON 0
 uu_1                 8.853588e-02 1 1  ON 1
 uu_2                -2.782961e-02 1 1  ON 2
 uu_3                -9.841832e-02 1 1  ON 3
 uu_4                -1.404331e-01 1 1  ON 4
 uu_5                -1.663371e-01 1 1  ON 5
 uu_6                -1.800058e-01 1 1  ON 6
 uu_7                -1.821216e-01 1 1  ON 7
 uu_8                -1.681230e-01 1 1  ON 8
 uu_9                -1.354455e-01 1 1  ON 9
 ud_0                 4.672564e-01 1 1  ON 10
 ud_1                 1.828395e-01 1 1  ON 11
 ud_2                 3.201637e-02 1 1  ON 12
 ud_3                -5.294302e-02 1 1  ON 13
 ud_4                -1.034970e-01 1 1  ON 14
 ud_5                -1.373812e-01 1 1  ON 15
 ud_6                -1.589762e-01 1 1  ON 16
 ud_7                -1.687591e-01 1 1  ON 17
 ud_8                -1.625631e-01 1 1  ON 18
 ud_9                -1.388684e-01 1 1  ON 19
 eC_0                -6.945278e-01 1 1  ON 20
 eC_1                -5.200254e-01 1 1  ON 21
 eC_2                -2.124518e-01 1 1  ON 22
 eC_3                 1.210084e-02 1 1  ON 23
 eC_4                 1.597348e-01 1 1  ON 24
 eC_5                 2.842174e-01 1 1  ON 25
 eC_6                 2.996302e-01 1 1  ON 26
 eC_7                 3.355142e-01 1 1  ON 27
 eC_8                 2.666477e-01 1 1  ON 28
 eC_9                 6.868976e-02 1 1  ON 29
 eO_0                -1.227549e+00 1 1  ON 30
 eO_1                -8.348256e-01 1 1  ON 31
 eO_2                -3.452044e-01 1 1  ON 32
 eO_3                -2.202295e-02 1 1  ON 33
 eO_4                 2.025239e-01 1 1  ON 34
 eO_5                 3.449533e-01 1 1  ON 35
 eO_6                 3.881476e-01 1 1  ON 36
 eO_7                 4.283225e-01 1 1  ON 37
 eO_8                 4.829728e-01 1 1  ON 38
 eO_9                 4.033883e-01 1 1  ON 39
eH1_0                -1.610120e-01 1 1  ON 40
eH1_1                -6.109785e-02 1 1  ON 41
eH1_2                -4.182760e-02 1 1  ON 42
eH1_3                -4.202656e-02 1 1  ON 43
eH1_4                -6.078984e-03 1 1  ON 44
eH1_5                 4.184842e-03 1 1  ON 45
eH1_6                 3.503695e-02 1 1  ON 46
eH1_7                 4.293920e-02 1 1  ON 47
eH1_8                 3.258315e-02 1 1  ON 48
eH1_9                 7.840975e-02 1 1  ON 49
eH2_0                -1.675318e-01 1 1  ON 50
eH2_1                -6.710144e-02 1 1  ON 51
eH2_2                -4.844170e-02 1 1  ON 52
eH2_3                -4.863705e-02 1 1  ON 53
eH2_4                -1.299746e-02 1 1  ON 54
eH2_5                -2.780878e-03 1 1  ON 55
eH2_6                 2.823878e-02 1 1  ON 56
eH2_7                 3.895617e-02 1 1  ON 57
eH2_8                 2.794401e-02 1 1  ON 58
eH2_9                 9.287388e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.3569
    reference variance = 0.588803
====================================================
  Execution time = 4.4973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5847e-01
  Total weights = 2.0000e+06
  Execution time = 3.8639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558421000548
                                         uncertainty =       0.003735913156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558421000548
                                         uncertainty =       0.003735913156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528427329
  error estimate for blocks of size 2^( 2) =       0.000549261439
  error estimate for blocks of size 2^( 3) =       0.000567770400
  error estimate for blocks of size 2^( 4) =       0.000581318484
  error estimate for blocks of size 2^( 5) =       0.000590624416
  error estimate for blocks of size 2^( 6) =       0.000596534067
  error estimate for blocks of size 2^( 7) =       0.000600198568

      target function =                  N/A
              le_mean =     -22.436960821369
             les_mean =     503.975681505327
             stat err =       0.000592168884
             autocorr =       1.255800423057
              std dev =       0.747309095967
             le_variance =       0.558470884916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558406867532
                                         uncertainty =       0.003735952987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558406867532
                                         uncertainty =       0.003735952987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528420636
  error estimate for blocks of size 2^( 2) =       0.000549256215
  error estimate for blocks of size 2^( 3) =       0.000567766606
  error estimate for blocks of size 2^( 4) =       0.000581315862
  error estimate for blocks of size 2^( 5) =       0.000590621960
  error estimate for blocks of size 2^( 6) =       0.000596532039
  error estimate for blocks of size 2^( 7) =       0.000600193428

      target function =                  N/A
              le_mean =     -22.436959795553
             les_mean =     503.975621324772
             stat err =       0.000592165822
             autocorr =       1.255819253160
              std dev =       0.747299629820
             le_variance =       0.558456736729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558414525250
                                         uncertainty =       0.003735933167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558414525250
                                         uncertainty =       0.003735933167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528424262
  error estimate for blocks of size 2^( 2) =       0.000549259177
  error estimate for blocks of size 2^( 3) =       0.000567768933
  error estimate for blocks of size 2^( 4) =       0.000581317636
  error estimate for blocks of size 2^( 5) =       0.000590623573
  error estimate for blocks of size 2^( 6) =       0.000596533364
  error estimate for blocks of size 2^( 7) =       0.000600196172

      target function =                  N/A
              le_mean =     -22.436960241255
             les_mean =     503.975648989907
             stat err =       0.000592167686
             autocorr =       1.255809923914
              std dev =       0.747304758110
             le_variance =       0.558464401494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558420264581
                                         uncertainty =       0.003735916433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558420264581
                                         uncertainty =       0.003735916433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528426981
  error estimate for blocks of size 2^( 2) =       0.000549261191
  error estimate for blocks of size 2^( 3) =       0.000567770252
  error estimate for blocks of size 2^( 4) =       0.000581318414
  error estimate for blocks of size 2^( 5) =       0.000590624343
  error estimate for blocks of size 2^( 6) =       0.000596534009
  error estimate for blocks of size 2^( 7) =       0.000600198294

      target function =                  N/A
              le_mean =     -22.436960745716
             les_mean =     503.975677373468
             stat err =       0.000592168765
             autocorr =       1.255801575483
              std dev =       0.747308602859
             le_variance =       0.558470147906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436960821369        initial  <--
     2.5000e+00     2.5000e+01             9.2457e-05       -22.436959795553
     1.0000e+01     1.0000e+02             2.4320e-05       -22.436960241255
     4.0000e+01     4.0000e+02             6.1653e-06       -22.436960745716

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2866
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.641307e-01 1 1  ON 0
 uu_1                 8.852838e-02 1 1  ON 1
 uu_2                -2.782806e-02 1 1  ON 2
 uu_3                -9.841896e-02 1 1  ON 3
 uu_4                -1.404265e-01 1 1  ON 4
 uu_5                -1.663363e-01 1 1  ON 5
 uu_6                -1.800050e-01 1 1  ON 6
 uu_7                -1.821306e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354449e-01 1 1  ON 9
 ud_0                 4.672512e-01 1 1  ON 10
 ud_1                 1.828483e-01 1 1  ON 11
 ud_2                 3.200608e-02 1 1  ON 12
 ud_3                -5.294830e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373827e-01 1 1  ON 15
 ud_6                -1.589786e-01 1 1  ON 16
 ud_7                -1.687585e-01 1 1  ON 17
 ud_8                -1.625727e-01 1 1  ON 18
 ud_9                -1.388620e-01 1 1  ON 19
 eC_0                -6.945148e-01 1 1  ON 20
 eC_1                -5.200213e-01 1 1  ON 21
 eC_2                -2.124615e-01 1 1  ON 22
 eC_3                 1.211201e-02 1 1  ON 23
 eC_4                 1.597209e-01 1 1  ON 24
 eC_5                 2.842268e-01 1 1  ON 25
 eC_6                 2.996270e-01 1 1  ON 26
 eC_7                 3.355164e-01 1 1  ON 27
 eC_8                 2.666390e-01 1 1  ON 28
 eC_9                 6.868577e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348162e-01 1 1  ON 31
 eO_2                -3.452085e-01 1 1  ON 32
 eO_3                -2.201407e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449468e-01 1 1  ON 35
 eO_6                 3.881449e-01 1 1  ON 36
 eO_7                 4.283244e-01 1 1  ON 37
 eO_8                 4.829838e-01 1 1  ON 38
 eO_9                 4.033818e-01 1 1  ON 39
eH1_0                -1.610007e-01 1 1  ON 40
eH1_1                -6.110892e-02 1 1  ON 41
eH1_2                -4.182482e-02 1 1  ON 42
eH1_3                -4.203415e-02 1 1  ON 43
eH1_4                -6.073995e-03 1 1  ON 44
eH1_5                 4.174791e-03 1 1  ON 45
eH1_6                 3.504566e-02 1 1  ON 46
eH1_7                 4.294977e-02 1 1  ON 47
eH1_8                 3.258417e-02 1 1  ON 48
eH1_9                 7.840532e-02 1 1  ON 49
eH2_0                -1.675308e-01 1 1  ON 50
eH2_1                -6.710286e-02 1 1  ON 51
eH2_2                -4.841738e-02 1 1  ON 52
eH2_3                -4.863750e-02 1 1  ON 53
eH2_4                -1.300092e-02 1 1  ON 54
eH2_5                -2.779187e-03 1 1  ON 55
eH2_6                 2.824435e-02 1 1  ON 56
eH2_7                 3.894044e-02 1 1  ON 57
eH2_8                 2.793149e-02 1 1  ON 58
eH2_9                 9.287848e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2465e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2383e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.3658
    reference variance = 0.438302
====================================================
  Execution time = 4.5435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6744e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5102e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567588228507
                                         uncertainty =       0.006580294176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567588228507
                                         uncertainty =       0.006580294176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532652415
  error estimate for blocks of size 2^( 2) =       0.000552663661
  error estimate for blocks of size 2^( 3) =       0.000570464971
  error estimate for blocks of size 2^( 4) =       0.000584752013
  error estimate for blocks of size 2^( 5) =       0.000593660618
  error estimate for blocks of size 2^( 6) =       0.000598771431
  error estimate for blocks of size 2^( 7) =       0.000601949606

      target function =                  N/A
              le_mean =     -22.436913338655
             les_mean =     503.982517073321
             stat err =       0.000594783417
             autocorr =       1.246895053864
              std dev =       0.753284269539
             le_variance =       0.567437190735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243691333865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436913338655       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436913371902       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436913358688       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436913366664       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436913370357       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436913396261       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436913391285       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436913394336       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436913396920       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436913394040       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 7.407448e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436913338655       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436913346997       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436913343681       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436913345733       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436913346662       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436913353164       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436913351899       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436913352682       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436913353269       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436913352575       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 1.857116e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436913338655       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436913340742       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436913339912       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436913340429       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436913340662       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436913342289       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436913341971       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436913342169       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436913342312       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436913342139       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+02 is 4.646090e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199332 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0548e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.641306e-01 1 1  ON 0
 uu_1                 8.852948e-02 1 1  ON 1
 uu_2                -2.782796e-02 1 1  ON 2
 uu_3                -9.841839e-02 1 1  ON 3
 uu_4                -1.404267e-01 1 1  ON 4
 uu_5                -1.663357e-01 1 1  ON 5
 uu_6                -1.800048e-01 1 1  ON 6
 uu_7                -1.821291e-01 1 1  ON 7
 uu_8                -1.681305e-01 1 1  ON 8
 uu_9                -1.354457e-01 1 1  ON 9
 ud_0                 4.672520e-01 1 1  ON 10
 ud_1                 1.828487e-01 1 1  ON 11
 ud_2                 3.200739e-02 1 1  ON 12
 ud_3                -5.294740e-02 1 1  ON 13
 ud_4                -1.035050e-01 1 1  ON 14
 ud_5                -1.373821e-01 1 1  ON 15
 ud_6                -1.589783e-01 1 1  ON 16
 ud_7                -1.687572e-01 1 1  ON 17
 ud_8                -1.625739e-01 1 1  ON 18
 ud_9                -1.388636e-01 1 1  ON 19
 eC_0                -6.945160e-01 1 1  ON 20
 eC_1                -5.200215e-01 1 1  ON 21
 eC_2                -2.124606e-01 1 1  ON 22
 eC_3                 1.211283e-02 1 1  ON 23
 eC_4                 1.597198e-01 1 1  ON 24
 eC_5                 2.842275e-01 1 1  ON 25
 eC_6                 2.996276e-01 1 1  ON 26
 eC_7                 3.355154e-01 1 1  ON 27
 eC_8                 2.666392e-01 1 1  ON 28
 eC_9                 6.868614e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452081e-01 1 1  ON 32
 eO_3                -2.201295e-02 1 1  ON 33
 eO_4                 2.025346e-01 1 1  ON 34
 eO_5                 3.449469e-01 1 1  ON 35
 eO_6                 3.881435e-01 1 1  ON 36
 eO_7                 4.283240e-01 1 1  ON 37
 eO_8                 4.829829e-01 1 1  ON 38
 eO_9                 4.033825e-01 1 1  ON 39
eH1_0                -1.610012e-01 1 1  ON 40
eH1_1                -6.110766e-02 1 1  ON 41
eH1_2                -4.182553e-02 1 1  ON 42
eH1_3                -4.203384e-02 1 1  ON 43
eH1_4                -6.074477e-03 1 1  ON 44
eH1_5                 4.175019e-03 1 1  ON 45
eH1_6                 3.504446e-02 1 1  ON 46
eH1_7                 4.295162e-02 1 1  ON 47
eH1_8                 3.258370e-02 1 1  ON 48
eH1_9                 7.840456e-02 1 1  ON 49
eH2_0                -1.675303e-01 1 1  ON 50
eH2_1                -6.710298e-02 1 1  ON 51
eH2_2                -4.841816e-02 1 1  ON 52
eH2_3                -4.863927e-02 1 1  ON 53
eH2_4                -1.299951e-02 1 1  ON 54
eH2_5                -2.778153e-03 1 1  ON 55
eH2_6                 2.824371e-02 1 1  ON 56
eH2_7                 3.894069e-02 1 1  ON 57
eH2_8                 2.793166e-02 1 1  ON 58
eH2_9                 9.287781e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.3781
    reference variance = 0.317152
====================================================
  Execution time = 4.5124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2439e+01
  VMC Evar = 6.3145e-01
  Total weights = 2.0000e+06
  Execution time = 3.8654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.631529618575
                                         uncertainty =       0.069953741295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.631529618575
                                         uncertainty =       0.069953741295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000561894113
  error estimate for blocks of size 2^( 2) =       0.000581193175
  error estimate for blocks of size 2^( 3) =       0.000599116695
  error estimate for blocks of size 2^( 4) =       0.000612246353
  error estimate for blocks of size 2^( 5) =       0.000621045449
  error estimate for blocks of size 2^( 6) =       0.000626269450
  error estimate for blocks of size 2^( 7) =       0.000630004157

      target function =                  N/A
              le_mean =     -22.438553120917
             les_mean =     504.120115833010
             stat err =       0.000622391352
             autocorr =       1.226925337601
              std dev =       0.794638275280
             le_variance =       0.631449988540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.631526392251
                                         uncertainty =       0.069953800031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.631526392251
                                         uncertainty =       0.069953800031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000561892679
  error estimate for blocks of size 2^( 2) =       0.000581191907
  error estimate for blocks of size 2^( 3) =       0.000599115578
  error estimate for blocks of size 2^( 4) =       0.000612245210
  error estimate for blocks of size 2^( 5) =       0.000621044156
  error estimate for blocks of size 2^( 6) =       0.000626268170
  error estimate for blocks of size 2^( 7) =       0.000630002743

      target function =                  N/A
              le_mean =     -22.438553101672
             les_mean =     504.120111745418
             stat err =       0.000622390070
             autocorr =       1.226926546065
              std dev =       0.794636246704
             le_variance =       0.631446764575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.631527994831
                                         uncertainty =       0.069953771353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.631527994831
                                         uncertainty =       0.069953771353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000561893391
  error estimate for blocks of size 2^( 2) =       0.000581192537
  error estimate for blocks of size 2^( 3) =       0.000599116133
  error estimate for blocks of size 2^( 4) =       0.000612245779
  error estimate for blocks of size 2^( 5) =       0.000621044799
  error estimate for blocks of size 2^( 6) =       0.000626268807
  error estimate for blocks of size 2^( 7) =       0.000630003445

      target function =                  N/A
              le_mean =     -22.438553111167
             les_mean =     504.120113772935
             stat err =       0.000622390707
             autocorr =       1.226925948430
              std dev =       0.794637254356
             le_variance =       0.631448366010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.631529415237
                                         uncertainty =       0.069953745077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.631529415237
                                         uncertainty =       0.069953745077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000561894023
  error estimate for blocks of size 2^( 2) =       0.000581193095
  error estimate for blocks of size 2^( 3) =       0.000599116625
  error estimate for blocks of size 2^( 4) =       0.000612246281
  error estimate for blocks of size 2^( 5) =       0.000621045367
  error estimate for blocks of size 2^( 6) =       0.000626269370
  error estimate for blocks of size 2^( 7) =       0.000630004068

      target function =                  N/A
              le_mean =     -22.438553119685
             les_mean =     504.120115574576
             stat err =       0.000622391271
             autocorr =       1.226925414139
              std dev =       0.794638147432
             le_variance =       0.631449785355


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.438553120917        initial  <--
     2.5000e+01     2.5000e+02             7.4074e-06       -22.438553101672
     1.0000e+02     1.0000e+03             1.8571e-06       -22.438553111167
     4.0000e+02     4.0000e+03             4.6461e-07       -22.438553119685

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.2886
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.641307e-01 1 1  ON 0
 uu_1                 8.852838e-02 1 1  ON 1
 uu_2                -2.782806e-02 1 1  ON 2
 uu_3                -9.841896e-02 1 1  ON 3
 uu_4                -1.404265e-01 1 1  ON 4
 uu_5                -1.663363e-01 1 1  ON 5
 uu_6                -1.800050e-01 1 1  ON 6
 uu_7                -1.821306e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354449e-01 1 1  ON 9
 ud_0                 4.672512e-01 1 1  ON 10
 ud_1                 1.828483e-01 1 1  ON 11
 ud_2                 3.200608e-02 1 1  ON 12
 ud_3                -5.294830e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373827e-01 1 1  ON 15
 ud_6                -1.589786e-01 1 1  ON 16
 ud_7                -1.687585e-01 1 1  ON 17
 ud_8                -1.625727e-01 1 1  ON 18
 ud_9                -1.388620e-01 1 1  ON 19
 eC_0                -6.945148e-01 1 1  ON 20
 eC_1                -5.200213e-01 1 1  ON 21
 eC_2                -2.124615e-01 1 1  ON 22
 eC_3                 1.211201e-02 1 1  ON 23
 eC_4                 1.597209e-01 1 1  ON 24
 eC_5                 2.842268e-01 1 1  ON 25
 eC_6                 2.996270e-01 1 1  ON 26
 eC_7                 3.355164e-01 1 1  ON 27
 eC_8                 2.666390e-01 1 1  ON 28
 eC_9                 6.868577e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348162e-01 1 1  ON 31
 eO_2                -3.452085e-01 1 1  ON 32
 eO_3                -2.201407e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449468e-01 1 1  ON 35
 eO_6                 3.881449e-01 1 1  ON 36
 eO_7                 4.283244e-01 1 1  ON 37
 eO_8                 4.829838e-01 1 1  ON 38
 eO_9                 4.033818e-01 1 1  ON 39
eH1_0                -1.610007e-01 1 1  ON 40
eH1_1                -6.110892e-02 1 1  ON 41
eH1_2                -4.182482e-02 1 1  ON 42
eH1_3                -4.203415e-02 1 1  ON 43
eH1_4                -6.073995e-03 1 1  ON 44
eH1_5                 4.174791e-03 1 1  ON 45
eH1_6                 3.504566e-02 1 1  ON 46
eH1_7                 4.294977e-02 1 1  ON 47
eH1_8                 3.258417e-02 1 1  ON 48
eH1_9                 7.840532e-02 1 1  ON 49
eH2_0                -1.675308e-01 1 1  ON 50
eH2_1                -6.710286e-02 1 1  ON 51
eH2_2                -4.841738e-02 1 1  ON 52
eH2_3                -4.863750e-02 1 1  ON 53
eH2_4                -1.300092e-02 1 1  ON 54
eH2_5                -2.779187e-03 1 1  ON 55
eH2_6                 2.824435e-02 1 1  ON 56
eH2_7                 3.894044e-02 1 1  ON 57
eH2_8                 2.793149e-02 1 1  ON 58
eH2_9                 9.287848e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2784e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2379e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4002
    reference variance = 1.01906
====================================================
  Execution time = 4.6731e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5782e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5455e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557735353438
                                         uncertainty =       0.003852343482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557735353438
                                         uncertainty =       0.003852343482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528121160
  error estimate for blocks of size 2^( 2) =       0.000548259432
  error estimate for blocks of size 2^( 3) =       0.000565952128
  error estimate for blocks of size 2^( 4) =       0.000578843066
  error estimate for blocks of size 2^( 5) =       0.000587496418
  error estimate for blocks of size 2^( 6) =       0.000592973686
  error estimate for blocks of size 2^( 7) =       0.000595242330

      target function =                  N/A
              le_mean =     -22.436498184886
             les_mean =     503.954274441725
             stat err =       0.000588638875
             autocorr =       1.242312180490
              std dev =       0.746876107682
             le_variance =       0.557823920227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243649818489e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436498184886       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436498185525       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436498186733       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436498188611       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436498191406       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436498194524       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436498196356       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436498195937       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436498195501       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436498195509       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 1.065448e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436498184886       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436498185046       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436498185348       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436498185818       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436498186517       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436498187298       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436498187758       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436498187651       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436498187539       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436498187547       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+03 is 2.665695e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436498184886       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436498184926       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436498185002       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436498185118       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436498185295       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436498185489       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436498185606       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436498185582       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436498185554       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436498185555       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+03 is 6.665536e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202982 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2194e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.641307e-01 1 1  ON 0
 uu_1                 8.852849e-02 1 1  ON 1
 uu_2                -2.782808e-02 1 1  ON 2
 uu_3                -9.841889e-02 1 1  ON 3
 uu_4                -1.404266e-01 1 1  ON 4
 uu_5                -1.663363e-01 1 1  ON 5
 uu_6                -1.800052e-01 1 1  ON 6
 uu_7                -1.821303e-01 1 1  ON 7
 uu_8                -1.681299e-01 1 1  ON 8
 uu_9                -1.354450e-01 1 1  ON 9
 ud_0                 4.672514e-01 1 1  ON 10
 ud_1                 1.828483e-01 1 1  ON 11
 ud_2                 3.200611e-02 1 1  ON 12
 ud_3                -5.294834e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373827e-01 1 1  ON 15
 ud_6                -1.589787e-01 1 1  ON 16
 ud_7                -1.687584e-01 1 1  ON 17
 ud_8                -1.625727e-01 1 1  ON 18
 ud_9                -1.388620e-01 1 1  ON 19
 eC_0                -6.945149e-01 1 1  ON 20
 eC_1                -5.200214e-01 1 1  ON 21
 eC_2                -2.124614e-01 1 1  ON 22
 eC_3                 1.211204e-02 1 1  ON 23
 eC_4                 1.597210e-01 1 1  ON 24
 eC_5                 2.842268e-01 1 1  ON 25
 eC_6                 2.996270e-01 1 1  ON 26
 eC_7                 3.355164e-01 1 1  ON 27
 eC_8                 2.666390e-01 1 1  ON 28
 eC_9                 6.868581e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348164e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201398e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449469e-01 1 1  ON 35
 eO_6                 3.881448e-01 1 1  ON 36
 eO_7                 4.283243e-01 1 1  ON 37
 eO_8                 4.829837e-01 1 1  ON 38
 eO_9                 4.033819e-01 1 1  ON 39
eH1_0                -1.610006e-01 1 1  ON 40
eH1_1                -6.110889e-02 1 1  ON 41
eH1_2                -4.182491e-02 1 1  ON 42
eH1_3                -4.203413e-02 1 1  ON 43
eH1_4                -6.074110e-03 1 1  ON 44
eH1_5                 4.174751e-03 1 1  ON 45
eH1_6                 3.504568e-02 1 1  ON 46
eH1_7                 4.294983e-02 1 1  ON 47
eH1_8                 3.258421e-02 1 1  ON 48
eH1_9                 7.840530e-02 1 1  ON 49
eH2_0                -1.675308e-01 1 1  ON 50
eH2_1                -6.710298e-02 1 1  ON 51
eH2_2                -4.841737e-02 1 1  ON 52
eH2_3                -4.863750e-02 1 1  ON 53
eH2_4                -1.300093e-02 1 1  ON 54
eH2_5                -2.779082e-03 1 1  ON 55
eH2_6                 2.824430e-02 1 1  ON 56
eH2_7                 3.894045e-02 1 1  ON 57
eH2_8                 2.793153e-02 1 1  ON 58
eH2_9                 9.287844e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4531
    reference variance = 0.602589
====================================================
  Execution time = 4.4095e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6167e-01
  Total weights = 2.0000e+06
  Execution time = 3.8868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561647027207
                                         uncertainty =       0.004911316630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561647027207
                                         uncertainty =       0.004911316630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529939210
  error estimate for blocks of size 2^( 2) =       0.000550139072
  error estimate for blocks of size 2^( 3) =       0.000569122098
  error estimate for blocks of size 2^( 4) =       0.000582224678
  error estimate for blocks of size 2^( 5) =       0.000590321471
  error estimate for blocks of size 2^( 6) =       0.000595604835
  error estimate for blocks of size 2^( 7) =       0.000599228000

      target function =                  N/A
              le_mean =     -22.436976244559
             les_mean =     503.979573850559
             stat err =       0.000591844746
             autocorr =       1.247278640815
              std dev =       0.749447217937
             le_variance =       0.561671132474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561648011326
                                         uncertainty =       0.004911333424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561648011326
                                         uncertainty =       0.004911333424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529939674
  error estimate for blocks of size 2^( 2) =       0.000550139512
  error estimate for blocks of size 2^( 3) =       0.000569122512
  error estimate for blocks of size 2^( 4) =       0.000582225072
  error estimate for blocks of size 2^( 5) =       0.000590321857
  error estimate for blocks of size 2^( 6) =       0.000595605204
  error estimate for blocks of size 2^( 7) =       0.000599228334

      target function =                  N/A
              le_mean =     -22.436976247696
             les_mean =     503.979574975303
             stat err =       0.000591845117
             autocorr =       1.247278018067
              std dev =       0.749447874407
             le_variance =       0.561672116453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561647520025
                                         uncertainty =       0.004911325036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561647520025
                                         uncertainty =       0.004911325036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529939442
  error estimate for blocks of size 2^( 2) =       0.000550139292
  error estimate for blocks of size 2^( 3) =       0.000569122305
  error estimate for blocks of size 2^( 4) =       0.000582224875
  error estimate for blocks of size 2^( 5) =       0.000590321664
  error estimate for blocks of size 2^( 6) =       0.000595605020
  error estimate for blocks of size 2^( 7) =       0.000599228167

      target function =                  N/A
              le_mean =     -22.436976246130
             les_mean =     503.979574413805
             stat err =       0.000591844932
             autocorr =       1.247278329001
              std dev =       0.749447546678
             le_variance =       0.561671625222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561647088832
                                         uncertainty =       0.004911317681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561647088832
                                         uncertainty =       0.004911317681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529939239
  error estimate for blocks of size 2^( 2) =       0.000550139100
  error estimate for blocks of size 2^( 3) =       0.000569122124
  error estimate for blocks of size 2^( 4) =       0.000582224703
  error estimate for blocks of size 2^( 5) =       0.000590321495
  error estimate for blocks of size 2^( 6) =       0.000595604858
  error estimate for blocks of size 2^( 7) =       0.000599228021

      target function =                  N/A
              le_mean =     -22.436976244756
             les_mean =     503.979573920987
             stat err =       0.000591844769
             autocorr =       1.247278601817
              std dev =       0.749447259045
             le_variance =       0.561671194090


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436976244559        initial
     2.5000e+02     2.5000e+03             1.0654e-06       -22.436976247696  <--
     1.0000e+03     1.0000e+04             2.6657e-07       -22.436976246130
     4.0000e+03     4.0000e+04             6.6655e-08       -22.436976244756

*****************************************************************************
Applying the update for shift_i =   2.5000e+02     and shift_s =   2.5000e+03
*****************************************************************************

  Execution time = 6.3562e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.641306e-01 1 1  ON 0
 uu_1                 8.852884e-02 1 1  ON 1
 uu_2                -2.782815e-02 1 1  ON 2
 uu_3                -9.841868e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663363e-01 1 1  ON 5
 uu_6                -1.800056e-01 1 1  ON 6
 uu_7                -1.821296e-01 1 1  ON 7
 uu_8                -1.681298e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672521e-01 1 1  ON 10
 ud_1                 1.828483e-01 1 1  ON 11
 ud_2                 3.200621e-02 1 1  ON 12
 ud_3                -5.294845e-02 1 1  ON 13
 ud_4                -1.035053e-01 1 1  ON 14
 ud_5                -1.373824e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687583e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388620e-01 1 1  ON 19
 eC_0                -6.945151e-01 1 1  ON 20
 eC_1                -5.200219e-01 1 1  ON 21
 eC_2                -2.124613e-01 1 1  ON 22
 eC_3                 1.211211e-02 1 1  ON 23
 eC_4                 1.597213e-01 1 1  ON 24
 eC_5                 2.842268e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355161e-01 1 1  ON 27
 eC_8                 2.666392e-01 1 1  ON 28
 eC_9                 6.868594e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348170e-01 1 1  ON 31
 eO_2                -3.452083e-01 1 1  ON 32
 eO_3                -2.201369e-02 1 1  ON 33
 eO_4                 2.025338e-01 1 1  ON 34
 eO_5                 3.449471e-01 1 1  ON 35
 eO_6                 3.881447e-01 1 1  ON 36
 eO_7                 4.283243e-01 1 1  ON 37
 eO_8                 4.829833e-01 1 1  ON 38
 eO_9                 4.033821e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110879e-02 1 1  ON 41
eH1_2                -4.182515e-02 1 1  ON 42
eH1_3                -4.203409e-02 1 1  ON 43
eH1_4                -6.074456e-03 1 1  ON 44
eH1_5                 4.174631e-03 1 1  ON 45
eH1_6                 3.504574e-02 1 1  ON 46
eH1_7                 4.295000e-02 1 1  ON 47
eH1_8                 3.258433e-02 1 1  ON 48
eH1_9                 7.840524e-02 1 1  ON 49
eH2_0                -1.675308e-01 1 1  ON 50
eH2_1                -6.710333e-02 1 1  ON 51
eH2_2                -4.841735e-02 1 1  ON 52
eH2_3                -4.863750e-02 1 1  ON 53
eH2_4                -1.300096e-02 1 1  ON 54
eH2_5                -2.778767e-03 1 1  ON 55
eH2_6                 2.824414e-02 1 1  ON 56
eH2_7                 3.894049e-02 1 1  ON 57
eH2_8                 2.793166e-02 1 1  ON 58
eH2_9                 9.287833e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2576e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2391e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.4811
    reference variance = 0.628686
====================================================
  Execution time = 4.4716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7608e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5325e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575474241771
                                         uncertainty =       0.007343020860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575474241771
                                         uncertainty =       0.007343020860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536693991
  error estimate for blocks of size 2^( 2) =       0.000556141417
  error estimate for blocks of size 2^( 3) =       0.000575210304
  error estimate for blocks of size 2^( 4) =       0.000589471882
  error estimate for blocks of size 2^( 5) =       0.000596803370
  error estimate for blocks of size 2^( 6) =       0.000600039197
  error estimate for blocks of size 2^( 7) =       0.000599665295

      target function =                  N/A
              le_mean =     -22.437335291404
             les_mean =     504.010095570396
             stat err =       0.000596494936
             autocorr =       1.235264774779
              std dev =       0.758999920658
             le_variance =       0.576080879559


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243733529140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437335291404       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437335294922       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437335299999       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437335296239       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437335288150       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437335291809       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437335293716       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437335298744       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437335299002       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437335298303       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+01 is 3.480122e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437335291404       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437335292285       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437335293562       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437335292618       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437335290576       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437335291487       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437335291968       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437335293221       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437335293283       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437335293110       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 8.715560e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437335291404       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437335291624       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437335291944       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437335291708       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437335291196       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437335291423       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437335291543       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437335291863       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437335291875       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437335291828       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+03 is 2.179845e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0049e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.641300e-01 1 1  ON 0
 uu_1                 8.852938e-02 1 1  ON 1
 uu_2                -2.782789e-02 1 1  ON 2
 uu_3                -9.841831e-02 1 1  ON 3
 uu_4                -1.404273e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800054e-01 1 1  ON 6
 uu_7                -1.821287e-01 1 1  ON 7
 uu_8                -1.681295e-01 1 1  ON 8
 uu_9                -1.354456e-01 1 1  ON 9
 ud_0                 4.672524e-01 1 1  ON 10
 ud_1                 1.828483e-01 1 1  ON 11
 ud_2                 3.200691e-02 1 1  ON 12
 ud_3                -5.294821e-02 1 1  ON 13
 ud_4                -1.035049e-01 1 1  ON 14
 ud_5                -1.373821e-01 1 1  ON 15
 ud_6                -1.589786e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625733e-01 1 1  ON 18
 ud_9                -1.388625e-01 1 1  ON 19
 eC_0                -6.945156e-01 1 1  ON 20
 eC_1                -5.200225e-01 1 1  ON 21
 eC_2                -2.124609e-01 1 1  ON 22
 eC_3                 1.211253e-02 1 1  ON 23
 eC_4                 1.597216e-01 1 1  ON 24
 eC_5                 2.842263e-01 1 1  ON 25
 eC_6                 2.996274e-01 1 1  ON 26
 eC_7                 3.355159e-01 1 1  ON 27
 eC_8                 2.666394e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348172e-01 1 1  ON 31
 eO_2                -3.452089e-01 1 1  ON 32
 eO_3                -2.201322e-02 1 1  ON 33
 eO_4                 2.025338e-01 1 1  ON 34
 eO_5                 3.449480e-01 1 1  ON 35
 eO_6                 3.881443e-01 1 1  ON 36
 eO_7                 4.283240e-01 1 1  ON 37
 eO_8                 4.829829e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610001e-01 1 1  ON 40
eH1_1                -6.110868e-02 1 1  ON 41
eH1_2                -4.182564e-02 1 1  ON 42
eH1_3                -4.203381e-02 1 1  ON 43
eH1_4                -6.074771e-03 1 1  ON 44
eH1_5                 4.174437e-03 1 1  ON 45
eH1_6                 3.504542e-02 1 1  ON 46
eH1_7                 4.295011e-02 1 1  ON 47
eH1_8                 3.258464e-02 1 1  ON 48
eH1_9                 7.840520e-02 1 1  ON 49
eH2_0                -1.675312e-01 1 1  ON 50
eH2_1                -6.710358e-02 1 1  ON 51
eH2_2                -4.841733e-02 1 1  ON 52
eH2_3                -4.863736e-02 1 1  ON 53
eH2_4                -1.300088e-02 1 1  ON 54
eH2_5                -2.779174e-03 1 1  ON 55
eH2_6                 2.824446e-02 1 1  ON 56
eH2_7                 3.894065e-02 1 1  ON 57
eH2_8                 2.793192e-02 1 1  ON 58
eH2_9                 9.287819e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.4039
    reference variance = 0.51071
====================================================
  Execution time = 4.4289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7602e-01
  Total weights = 2.0000e+06
  Execution time = 3.8467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576180513842
                                         uncertainty =       0.010577681615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576180513842
                                         uncertainty =       0.010577681615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536668217
  error estimate for blocks of size 2^( 2) =       0.000556571688
  error estimate for blocks of size 2^( 3) =       0.000574367680
  error estimate for blocks of size 2^( 4) =       0.000587535712
  error estimate for blocks of size 2^( 5) =       0.000596881100
  error estimate for blocks of size 2^( 6) =       0.000602061314
  error estimate for blocks of size 2^( 7) =       0.000603147525

      target function =                  N/A
              le_mean =     -22.436493660239
             les_mean =     503.972273027385
             stat err =       0.000597406413
             autocorr =       1.239161777944
              std dev =       0.758963470441
             le_variance =       0.576025549464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576178069274
                                         uncertainty =       0.010577706521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576178069274
                                         uncertainty =       0.010577706521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536667079
  error estimate for blocks of size 2^( 2) =       0.000556570635
  error estimate for blocks of size 2^( 3) =       0.000574366704
  error estimate for blocks of size 2^( 4) =       0.000587534834
  error estimate for blocks of size 2^( 5) =       0.000596880279
  error estimate for blocks of size 2^( 6) =       0.000602060581
  error estimate for blocks of size 2^( 7) =       0.000603146686

      target function =                  N/A
              le_mean =     -22.436493640216
             les_mean =     503.972269687775
             stat err =       0.000597405595
             autocorr =       1.239163635327
              std dev =       0.758961862253
             le_variance =       0.576023108355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576179288003
                                         uncertainty =       0.010577694386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576179288003
                                         uncertainty =       0.010577694386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536667646
  error estimate for blocks of size 2^( 2) =       0.000556571160
  error estimate for blocks of size 2^( 3) =       0.000574367191
  error estimate for blocks of size 2^( 4) =       0.000587535272
  error estimate for blocks of size 2^( 5) =       0.000596880688
  error estimate for blocks of size 2^( 6) =       0.000602060947
  error estimate for blocks of size 2^( 7) =       0.000603147104

      target function =                  N/A
              le_mean =     -22.436493650178
             les_mean =     503.972271351816
             stat err =       0.000597406003
             autocorr =       1.239162711000
              std dev =       0.758962664010
             le_variance =       0.576024325362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576180360487
                                         uncertainty =       0.010577683222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576180360487
                                         uncertainty =       0.010577683222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536668145
  error estimate for blocks of size 2^( 2) =       0.000556571622
  error estimate for blocks of size 2^( 3) =       0.000574367619
  error estimate for blocks of size 2^( 4) =       0.000587535657
  error estimate for blocks of size 2^( 5) =       0.000596881048
  error estimate for blocks of size 2^( 6) =       0.000602061268
  error estimate for blocks of size 2^( 7) =       0.000603147472

      target function =                  N/A
              le_mean =     -22.436493658978
             les_mean =     503.972272817674
             stat err =       0.000597406361
             autocorr =       1.239161894715
              std dev =       0.758963369556
             le_variance =       0.576025396327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436493660239        initial  <--
     6.2500e+01     6.2500e+02             3.4801e-06       -22.436493640216
     2.5000e+02     2.5000e+03             8.7156e-07       -22.436493650178
     1.0000e+03     1.0000e+04             2.1798e-07       -22.436493658978

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.5496
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.641306e-01 1 1  ON 0
 uu_1                 8.852884e-02 1 1  ON 1
 uu_2                -2.782815e-02 1 1  ON 2
 uu_3                -9.841868e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663363e-01 1 1  ON 5
 uu_6                -1.800056e-01 1 1  ON 6
 uu_7                -1.821296e-01 1 1  ON 7
 uu_8                -1.681298e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672521e-01 1 1  ON 10
 ud_1                 1.828483e-01 1 1  ON 11
 ud_2                 3.200621e-02 1 1  ON 12
 ud_3                -5.294845e-02 1 1  ON 13
 ud_4                -1.035053e-01 1 1  ON 14
 ud_5                -1.373824e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687583e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388620e-01 1 1  ON 19
 eC_0                -6.945151e-01 1 1  ON 20
 eC_1                -5.200219e-01 1 1  ON 21
 eC_2                -2.124613e-01 1 1  ON 22
 eC_3                 1.211211e-02 1 1  ON 23
 eC_4                 1.597213e-01 1 1  ON 24
 eC_5                 2.842268e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355161e-01 1 1  ON 27
 eC_8                 2.666392e-01 1 1  ON 28
 eC_9                 6.868594e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348170e-01 1 1  ON 31
 eO_2                -3.452083e-01 1 1  ON 32
 eO_3                -2.201369e-02 1 1  ON 33
 eO_4                 2.025338e-01 1 1  ON 34
 eO_5                 3.449471e-01 1 1  ON 35
 eO_6                 3.881447e-01 1 1  ON 36
 eO_7                 4.283243e-01 1 1  ON 37
 eO_8                 4.829833e-01 1 1  ON 38
 eO_9                 4.033821e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110879e-02 1 1  ON 41
eH1_2                -4.182515e-02 1 1  ON 42
eH1_3                -4.203409e-02 1 1  ON 43
eH1_4                -6.074456e-03 1 1  ON 44
eH1_5                 4.174631e-03 1 1  ON 45
eH1_6                 3.504574e-02 1 1  ON 46
eH1_7                 4.295000e-02 1 1  ON 47
eH1_8                 3.258433e-02 1 1  ON 48
eH1_9                 7.840524e-02 1 1  ON 49
eH2_0                -1.675308e-01 1 1  ON 50
eH2_1                -6.710333e-02 1 1  ON 51
eH2_2                -4.841735e-02 1 1  ON 52
eH2_3                -4.863750e-02 1 1  ON 53
eH2_4                -1.300096e-02 1 1  ON 54
eH2_5                -2.778767e-03 1 1  ON 55
eH2_6                 2.824414e-02 1 1  ON 56
eH2_7                 3.894049e-02 1 1  ON 57
eH2_8                 2.793166e-02 1 1  ON 58
eH2_9                 9.287833e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2360e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2401e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4166
    reference variance = 0.395718
====================================================
  Execution time = 4.7006e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.9053e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5352e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.590223982755
                                         uncertainty =       0.023235374315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.590223982755
                                         uncertainty =       0.023235374315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543382859
  error estimate for blocks of size 2^( 2) =       0.000562879288
  error estimate for blocks of size 2^( 3) =       0.000582032512
  error estimate for blocks of size 2^( 4) =       0.000595591804
  error estimate for blocks of size 2^( 5) =       0.000603985968
  error estimate for blocks of size 2^( 6) =       0.000608800506
  error estimate for blocks of size 2^( 7) =       0.000608914349

      target function =                  N/A
              le_mean =     -22.437136509938
             les_mean =     504.015624332824
             stat err =       0.000604323157
             autocorr =       1.236877255729
              std dev =       0.768459408488
             le_variance =       0.590529862494


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243713650994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437136509938       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437136510491       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437136511308       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437136513128       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437136513720       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437136513074       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437136513477       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437136513371       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437136513107       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437136513085       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+02 is 3.236596e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437136509938       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437136510076       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437136510281       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437136510736       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437136510886       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437136510725       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437136510825       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437136510794       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437136510722       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437136510725       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 8.093114e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437136509938       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437136509973       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437136510024       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437136510139       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437136510172       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437136510134       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437136510159       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437136510150       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437136510135       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437136510141       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+04 is 2.023380e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2365e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.641305e-01 1 1  ON 0
 uu_1                 8.852889e-02 1 1  ON 1
 uu_2                -2.782812e-02 1 1  ON 2
 uu_3                -9.841866e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663363e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821296e-01 1 1  ON 7
 uu_8                -1.681298e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672522e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200621e-02 1 1  ON 12
 ud_3                -5.294845e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373824e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687583e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388620e-01 1 1  ON 19
 eC_0                -6.945151e-01 1 1  ON 20
 eC_1                -5.200220e-01 1 1  ON 21
 eC_2                -2.124612e-01 1 1  ON 22
 eC_3                 1.211211e-02 1 1  ON 23
 eC_4                 1.597213e-01 1 1  ON 24
 eC_5                 2.842268e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355161e-01 1 1  ON 27
 eC_8                 2.666392e-01 1 1  ON 28
 eC_9                 6.868596e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348171e-01 1 1  ON 31
 eO_2                -3.452083e-01 1 1  ON 32
 eO_3                -2.201364e-02 1 1  ON 33
 eO_4                 2.025338e-01 1 1  ON 34
 eO_5                 3.449472e-01 1 1  ON 35
 eO_6                 3.881447e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829833e-01 1 1  ON 38
 eO_9                 4.033822e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110871e-02 1 1  ON 41
eH1_2                -4.182521e-02 1 1  ON 42
eH1_3                -4.203411e-02 1 1  ON 43
eH1_4                -6.074427e-03 1 1  ON 44
eH1_5                 4.174605e-03 1 1  ON 45
eH1_6                 3.504571e-02 1 1  ON 46
eH1_7                 4.295003e-02 1 1  ON 47
eH1_8                 3.258431e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675308e-01 1 1  ON 50
eH2_1                -6.710336e-02 1 1  ON 51
eH2_2                -4.841741e-02 1 1  ON 52
eH2_3                -4.863750e-02 1 1  ON 53
eH2_4                -1.300094e-02 1 1  ON 54
eH2_5                -2.778745e-03 1 1  ON 55
eH2_6                 2.824415e-02 1 1  ON 56
eH2_7                 3.894051e-02 1 1  ON 57
eH2_8                 2.793166e-02 1 1  ON 58
eH2_9                 9.287831e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4577
    reference variance = 0.54132
====================================================
  Execution time = 4.6067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5807e-01
  Total weights = 2.0000e+06
  Execution time = 3.8708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558051138915
                                         uncertainty =       0.003533955567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558051138915
                                         uncertainty =       0.003533955567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528237809
  error estimate for blocks of size 2^( 2) =       0.000548386853
  error estimate for blocks of size 2^( 3) =       0.000566633631
  error estimate for blocks of size 2^( 4) =       0.000579781515
  error estimate for blocks of size 2^( 5) =       0.000586697615
  error estimate for blocks of size 2^( 6) =       0.000591603150
  error estimate for blocks of size 2^( 7) =       0.000593465198

      target function =                  N/A
              le_mean =     -22.436987452367
             les_mean =     503.976476023311
             stat err =       0.000587886869
             autocorr =       1.238592812330
              std dev =       0.747041072960
             le_variance =       0.558070364690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558051298088
                                         uncertainty =       0.003533958087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558051298088
                                         uncertainty =       0.003533958087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528237884
  error estimate for blocks of size 2^( 2) =       0.000548386923
  error estimate for blocks of size 2^( 3) =       0.000566633698
  error estimate for blocks of size 2^( 4) =       0.000579781584
  error estimate for blocks of size 2^( 5) =       0.000586697681
  error estimate for blocks of size 2^( 6) =       0.000591603212
  error estimate for blocks of size 2^( 7) =       0.000593465264

      target function =                  N/A
              le_mean =     -22.436987456908
             les_mean =     503.976476386125
             stat err =       0.000587886935
             autocorr =       1.238592736467
              std dev =       0.747041179392
             le_variance =       0.558070523708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558051218587
                                         uncertainty =       0.003533956828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558051218587
                                         uncertainty =       0.003533956828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528237846
  error estimate for blocks of size 2^( 2) =       0.000548386888
  error estimate for blocks of size 2^( 3) =       0.000566633665
  error estimate for blocks of size 2^( 4) =       0.000579781549
  error estimate for blocks of size 2^( 5) =       0.000586697648
  error estimate for blocks of size 2^( 6) =       0.000591603181
  error estimate for blocks of size 2^( 7) =       0.000593465231

      target function =                  N/A
              le_mean =     -22.436987454639
             les_mean =     503.976476204870
             stat err =       0.000587886902
             autocorr =       1.238592774361
              std dev =       0.747041126233
             le_variance =       0.558070444284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558051148877
                                         uncertainty =       0.003533955725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558051148877
                                         uncertainty =       0.003533955725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528237813
  error estimate for blocks of size 2^( 2) =       0.000548386857
  error estimate for blocks of size 2^( 3) =       0.000566633635
  error estimate for blocks of size 2^( 4) =       0.000579781519
  error estimate for blocks of size 2^( 5) =       0.000586697619
  error estimate for blocks of size 2^( 6) =       0.000591603153
  error estimate for blocks of size 2^( 7) =       0.000593465202

      target function =                  N/A
              le_mean =     -22.436987452651
             les_mean =     503.976476046010
             stat err =       0.000587886874
             autocorr =       1.238592807588
              std dev =       0.747041079621
             le_variance =       0.558070374641


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436987452367        initial
     6.2500e+02     6.2500e+03             3.2366e-07       -22.436987456908  <--
     2.5000e+03     2.5000e+04             8.0931e-08       -22.436987454639
     1.0000e+04     1.0000e+05             2.0234e-08       -22.436987452651

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 6.5463e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.641303e-01 1 1  ON 0
 uu_1                 8.852906e-02 1 1  ON 1
 uu_2                -2.782804e-02 1 1  ON 2
 uu_3                -9.841861e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800058e-01 1 1  ON 6
 uu_7                -1.821296e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828481e-01 1 1  ON 11
 ud_2                 3.200619e-02 1 1  ON 12
 ud_3                -5.294846e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373824e-01 1 1  ON 15
 ud_6                -1.589790e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625728e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200221e-01 1 1  ON 21
 eC_2                -2.124612e-01 1 1  ON 22
 eC_3                 1.211211e-02 1 1  ON 23
 eC_4                 1.597213e-01 1 1  ON 24
 eC_5                 2.842268e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868601e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201349e-02 1 1  ON 33
 eO_4                 2.025338e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182536e-02 1 1  ON 42
eH1_3                -4.203419e-02 1 1  ON 43
eH1_4                -6.074340e-03 1 1  ON 44
eH1_5                 4.174527e-03 1 1  ON 45
eH1_6                 3.504563e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258426e-02 1 1  ON 48
eH1_9                 7.840522e-02 1 1  ON 49
eH2_0                -1.675308e-01 1 1  ON 50
eH2_1                -6.710346e-02 1 1  ON 51
eH2_2                -4.841759e-02 1 1  ON 52
eH2_3                -4.863750e-02 1 1  ON 53
eH2_4                -1.300088e-02 1 1  ON 54
eH2_5                -2.778681e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894056e-02 1 1  ON 57
eH2_8                 2.793167e-02 1 1  ON 58
eH2_9                 9.287826e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2784e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2407e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.3864
    reference variance = 0.478944
====================================================
  Execution time = 4.5096e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5765e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5306e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557815993718
                                         uncertainty =       0.004094960959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557815993718
                                         uncertainty =       0.004094960959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528036608
  error estimate for blocks of size 2^( 2) =       0.000548335306
  error estimate for blocks of size 2^( 3) =       0.000567264631
  error estimate for blocks of size 2^( 4) =       0.000580988951
  error estimate for blocks of size 2^( 5) =       0.000588759601
  error estimate for blocks of size 2^( 6) =       0.000592493069
  error estimate for blocks of size 2^( 7) =       0.000597065290

      target function =                  N/A
              le_mean =     -22.436872507153
             les_mean =     503.970892942795
             stat err =       0.000589826728
             autocorr =       1.247730616091
              std dev =       0.746756532877
             le_variance =       0.557645319395


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243687250715e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436872507153       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436872511249       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436872510408       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436872508566       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436872510972       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436872516574       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436872517470       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436872515912       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436872514357       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436872514411       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 1.166403e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436872507153       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436872508178       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436872507967       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436872507505       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436872508105       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436872509509       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436872509735       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436872509346       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436872508955       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436872508967       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+02 is 2.921852e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436872507153       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436872507409       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436872507356       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436872507240       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436872507390       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436872507740       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436872507798       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436872507701       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436872507599       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436872507606       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 7.308294e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0409e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.641301e-01 1 1  ON 0
 uu_1                 8.852921e-02 1 1  ON 1
 uu_2                -2.782799e-02 1 1  ON 2
 uu_3                -9.841861e-02 1 1  ON 3
 uu_4                -1.404269e-01 1 1  ON 4
 uu_5                -1.663361e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681298e-01 1 1  ON 8
 uu_9                -1.354452e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828483e-01 1 1  ON 11
 ud_2                 3.200622e-02 1 1  ON 12
 ud_3                -5.294836e-02 1 1  ON 13
 ud_4                -1.035055e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589788e-01 1 1  ON 16
 ud_7                -1.687580e-01 1 1  ON 17
 ud_8                -1.625726e-01 1 1  ON 18
 ud_9                -1.388618e-01 1 1  ON 19
 eC_0                -6.945151e-01 1 1  ON 20
 eC_1                -5.200223e-01 1 1  ON 21
 eC_2                -2.124612e-01 1 1  ON 22
 eC_3                 1.211208e-02 1 1  ON 23
 eC_4                 1.597214e-01 1 1  ON 24
 eC_5                 2.842269e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666394e-01 1 1  ON 28
 eC_9                 6.868608e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348175e-01 1 1  ON 31
 eO_2                -3.452082e-01 1 1  ON 32
 eO_3                -2.201356e-02 1 1  ON 33
 eO_4                 2.025340e-01 1 1  ON 34
 eO_5                 3.449472e-01 1 1  ON 35
 eO_6                 3.881445e-01 1 1  ON 36
 eO_7                 4.283243e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033824e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182526e-02 1 1  ON 42
eH1_3                -4.203432e-02 1 1  ON 43
eH1_4                -6.074158e-03 1 1  ON 44
eH1_5                 4.174480e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295008e-02 1 1  ON 47
eH1_8                 3.258422e-02 1 1  ON 48
eH1_9                 7.840517e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710369e-02 1 1  ON 51
eH2_2                -4.841745e-02 1 1  ON 52
eH2_3                -4.863766e-02 1 1  ON 53
eH2_4                -1.300072e-02 1 1  ON 54
eH2_5                -2.778800e-03 1 1  ON 55
eH2_6                 2.824428e-02 1 1  ON 56
eH2_7                 3.894063e-02 1 1  ON 57
eH2_8                 2.793167e-02 1 1  ON 58
eH2_9                 9.287817e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.4542
    reference variance = 0.375234
====================================================
  Execution time = 4.5070e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7796e-01
  Total weights = 2.0000e+06
  Execution time = 3.8563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578072225556
                                         uncertainty =       0.009713873490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578072225556
                                         uncertainty =       0.009713873490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537568584
  error estimate for blocks of size 2^( 2) =       0.000558343772
  error estimate for blocks of size 2^( 3) =       0.000576637086
  error estimate for blocks of size 2^( 4) =       0.000590190925
  error estimate for blocks of size 2^( 5) =       0.000598542153
  error estimate for blocks of size 2^( 6) =       0.000602889213
  error estimate for blocks of size 2^( 7) =       0.000607819547

      target function =                  N/A
              le_mean =     -22.437740605771
             les_mean =     504.030163168268
             stat err =       0.000599860459
             autocorr =       1.245181646796
              std dev =       0.760236782438
             le_variance =       0.577959965372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578071676556
                                         uncertainty =       0.009713863364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578071676556
                                         uncertainty =       0.009713863364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537568329
  error estimate for blocks of size 2^( 2) =       0.000558343525
  error estimate for blocks of size 2^( 3) =       0.000576636834
  error estimate for blocks of size 2^( 4) =       0.000590190644
  error estimate for blocks of size 2^( 5) =       0.000598541888
  error estimate for blocks of size 2^( 6) =       0.000602888885
  error estimate for blocks of size 2^( 7) =       0.000607819204

      target function =                  N/A
              le_mean =     -22.437740596429
             les_mean =     504.030162199313
             stat err =       0.000599860155
             autocorr =       1.245181568422
              std dev =       0.760236420902
             le_variance =       0.577959415666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578071950172
                                         uncertainty =       0.009713868400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578071950172
                                         uncertainty =       0.009713868400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537568456
  error estimate for blocks of size 2^( 2) =       0.000558343648
  error estimate for blocks of size 2^( 3) =       0.000576636960
  error estimate for blocks of size 2^( 4) =       0.000590190784
  error estimate for blocks of size 2^( 5) =       0.000598542020
  error estimate for blocks of size 2^( 6) =       0.000602889048
  error estimate for blocks of size 2^( 7) =       0.000607819375

      target function =                  N/A
              le_mean =     -22.437740601077
             les_mean =     504.030162681894
             stat err =       0.000599860307
             autocorr =       1.245181607667
              std dev =       0.760236601088
             le_variance =       0.577959689634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578072191103
                                         uncertainty =       0.009713872853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578072191103
                                         uncertainty =       0.009713872853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537568568
  error estimate for blocks of size 2^( 2) =       0.000558343757
  error estimate for blocks of size 2^( 3) =       0.000576637071
  error estimate for blocks of size 2^( 4) =       0.000590190907
  error estimate for blocks of size 2^( 5) =       0.000598542137
  error estimate for blocks of size 2^( 6) =       0.000602889192
  error estimate for blocks of size 2^( 7) =       0.000607819525

      target function =                  N/A
              le_mean =     -22.437740605184
             les_mean =     504.030163107396
             stat err =       0.000599860440
             autocorr =       1.245181641903
              std dev =       0.760236759749
             le_variance =       0.577959930874


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437740605771        initial  <--
     1.5625e+02     1.5625e+03             1.1664e-06       -22.437740596429
     6.2500e+02     6.2500e+03             2.9219e-07       -22.437740601077
     2.5000e+03     2.5000e+04             7.3083e-08       -22.437740605184

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3640
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.641303e-01 1 1  ON 0
 uu_1                 8.852906e-02 1 1  ON 1
 uu_2                -2.782804e-02 1 1  ON 2
 uu_3                -9.841861e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800058e-01 1 1  ON 6
 uu_7                -1.821296e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828481e-01 1 1  ON 11
 ud_2                 3.200619e-02 1 1  ON 12
 ud_3                -5.294846e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373824e-01 1 1  ON 15
 ud_6                -1.589790e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625728e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200221e-01 1 1  ON 21
 eC_2                -2.124612e-01 1 1  ON 22
 eC_3                 1.211211e-02 1 1  ON 23
 eC_4                 1.597213e-01 1 1  ON 24
 eC_5                 2.842268e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868601e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201349e-02 1 1  ON 33
 eO_4                 2.025338e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182536e-02 1 1  ON 42
eH1_3                -4.203419e-02 1 1  ON 43
eH1_4                -6.074340e-03 1 1  ON 44
eH1_5                 4.174527e-03 1 1  ON 45
eH1_6                 3.504563e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258426e-02 1 1  ON 48
eH1_9                 7.840522e-02 1 1  ON 49
eH2_0                -1.675308e-01 1 1  ON 50
eH2_1                -6.710346e-02 1 1  ON 51
eH2_2                -4.841759e-02 1 1  ON 52
eH2_3                -4.863750e-02 1 1  ON 53
eH2_4                -1.300088e-02 1 1  ON 54
eH2_5                -2.778681e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894056e-02 1 1  ON 57
eH2_8                 2.793167e-02 1 1  ON 58
eH2_9                 9.287826e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2478e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2409e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.363
    reference variance = 0.629672
====================================================
  Execution time = 4.5256e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6602e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5331e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565887012853
                                         uncertainty =       0.003868424930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565887012853
                                         uncertainty =       0.003868424930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531985354
  error estimate for blocks of size 2^( 2) =       0.000551786868
  error estimate for blocks of size 2^( 3) =       0.000570420304
  error estimate for blocks of size 2^( 4) =       0.000584475602
  error estimate for blocks of size 2^( 5) =       0.000592899029
  error estimate for blocks of size 2^( 6) =       0.000597905034
  error estimate for blocks of size 2^( 7) =       0.000599506887

      target function =                  N/A
              le_mean =     -22.438078350300
             les_mean =     504.033376605755
             stat err =       0.000593696638
             autocorr =       1.245460122442
              std dev =       0.752340903154
             le_variance =       0.566016834559


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243807835030e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438078350300       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438078351304       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438078351656       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438078351719       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438078351717       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438078351741       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438078351698       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438078351484       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438078351571       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438078351570       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+03 is 1.689252e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438078350300       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438078350551       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438078350639       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438078350654       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438078350654       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438078350659       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438078350645       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438078350589       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438078350611       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438078350605       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+03 is 4.223469e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438078350300       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438078350363       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438078350385       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438078350383       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438078350399       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438078350390       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438078350387       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438078350419       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438078350375       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438078350392       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 1.055888e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217722 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0594e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.641303e-01 1 1  ON 0
 uu_1                 8.852906e-02 1 1  ON 1
 uu_2                -2.782803e-02 1 1  ON 2
 uu_3                -9.841861e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821295e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828481e-01 1 1  ON 11
 ud_2                 3.200621e-02 1 1  ON 12
 ud_3                -5.294844e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373824e-01 1 1  ON 15
 ud_6                -1.589790e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625728e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200221e-01 1 1  ON 21
 eC_2                -2.124612e-01 1 1  ON 22
 eC_3                 1.211211e-02 1 1  ON 23
 eC_4                 1.597214e-01 1 1  ON 24
 eC_5                 2.842268e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868602e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201350e-02 1 1  ON 33
 eO_4                 2.025338e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182537e-02 1 1  ON 42
eH1_3                -4.203418e-02 1 1  ON 43
eH1_4                -6.074323e-03 1 1  ON 44
eH1_5                 4.174516e-03 1 1  ON 45
eH1_6                 3.504563e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258426e-02 1 1  ON 48
eH1_9                 7.840522e-02 1 1  ON 49
eH2_0                -1.675308e-01 1 1  ON 50
eH2_1                -6.710346e-02 1 1  ON 51
eH2_2                -4.841760e-02 1 1  ON 52
eH2_3                -4.863749e-02 1 1  ON 53
eH2_4                -1.300086e-02 1 1  ON 54
eH2_5                -2.778699e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894054e-02 1 1  ON 57
eH2_8                 2.793166e-02 1 1  ON 58
eH2_9                 9.287825e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.2797
    reference variance = 0.375047
====================================================
  Execution time = 4.6726e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6500e-01
  Total weights = 2.0000e+06
  Execution time = 3.8592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565028124803
                                         uncertainty =       0.004317385463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565028124803
                                         uncertainty =       0.004317385463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531509771
  error estimate for blocks of size 2^( 2) =       0.000550976927
  error estimate for blocks of size 2^( 3) =       0.000569367110
  error estimate for blocks of size 2^( 4) =       0.000583813365
  error estimate for blocks of size 2^( 5) =       0.000592922188
  error estimate for blocks of size 2^( 6) =       0.000600643666
  error estimate for blocks of size 2^( 7) =       0.000604827586

      target function =                  N/A
              le_mean =     -22.437377402750
             les_mean =     504.000909704862
             stat err =       0.000595551701
             autocorr =       1.255499179806
              std dev =       0.751668327088
             le_variance =       0.565005273948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565027990637
                                         uncertainty =       0.004317383855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565027990637
                                         uncertainty =       0.004317383855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531509708
  error estimate for blocks of size 2^( 2) =       0.000550976869
  error estimate for blocks of size 2^( 3) =       0.000569367055
  error estimate for blocks of size 2^( 4) =       0.000583813314
  error estimate for blocks of size 2^( 5) =       0.000592922137
  error estimate for blocks of size 2^( 6) =       0.000600643616
  error estimate for blocks of size 2^( 7) =       0.000604827531

      target function =                  N/A
              le_mean =     -22.437377403615
             les_mean =     504.000909609554
             stat err =       0.000595551649
             autocorr =       1.255499258216
              std dev =       0.751668237862
             le_variance =       0.565005139811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565028057706
                                         uncertainty =       0.004317384659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565028057706
                                         uncertainty =       0.004317384659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531509740
  error estimate for blocks of size 2^( 2) =       0.000550976898
  error estimate for blocks of size 2^( 3) =       0.000569367083
  error estimate for blocks of size 2^( 4) =       0.000583813340
  error estimate for blocks of size 2^( 5) =       0.000592922162
  error estimate for blocks of size 2^( 6) =       0.000600643641
  error estimate for blocks of size 2^( 7) =       0.000604827559

      target function =                  N/A
              le_mean =     -22.437377403182
             les_mean =     504.000909657197
             stat err =       0.000595551675
             autocorr =       1.255499219019
              std dev =       0.751668282466
             le_variance =       0.565005206865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565028116415
                                         uncertainty =       0.004317385363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565028116415
                                         uncertainty =       0.004317385363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531509767
  error estimate for blocks of size 2^( 2) =       0.000550976923
  error estimate for blocks of size 2^( 3) =       0.000569367107
  error estimate for blocks of size 2^( 4) =       0.000583813362
  error estimate for blocks of size 2^( 5) =       0.000592922184
  error estimate for blocks of size 2^( 6) =       0.000600643663
  error estimate for blocks of size 2^( 7) =       0.000604827583

      target function =                  N/A
              le_mean =     -22.437377402804
             les_mean =     504.000909698903
             stat err =       0.000595551698
             autocorr =       1.255499184709
              std dev =       0.751668321510
             le_variance =       0.565005265562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437377402750        initial
     1.5625e+03     1.5625e+04             1.6893e-07       -22.437377403615  <--
     6.2500e+03     6.2500e+04             4.2235e-08       -22.437377403182
     2.5000e+04     2.5000e+05             1.0559e-08       -22.437377402804

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 6.6050e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852907e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200628e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211213e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996270e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868603e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201354e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182541e-02 1 1  ON 42
eH1_3                -4.203417e-02 1 1  ON 43
eH1_4                -6.074272e-03 1 1  ON 44
eH1_5                 4.174483e-03 1 1  ON 45
eH1_6                 3.504561e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258426e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710343e-02 1 1  ON 51
eH2_2                -4.841762e-02 1 1  ON 52
eH2_3                -4.863744e-02 1 1  ON 53
eH2_4                -1.300079e-02 1 1  ON 54
eH2_5                -2.778754e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793162e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2665e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2398e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.5912
    reference variance = 0.59745
====================================================
  Execution time = 4.7006e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7649e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5527e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576580480233
                                         uncertainty =       0.014312932694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576580480233
                                         uncertainty =       0.014312932694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536882690
  error estimate for blocks of size 2^( 2) =       0.000556716510
  error estimate for blocks of size 2^( 3) =       0.000575516995
  error estimate for blocks of size 2^( 4) =       0.000589473525
  error estimate for blocks of size 2^( 5) =       0.000599891640
  error estimate for blocks of size 2^( 6) =       0.000605523755
  error estimate for blocks of size 2^( 7) =       0.000610051916

      target function =                  N/A
              le_mean =     -22.436045117408
             les_mean =     503.952606267739
             stat err =       0.000601235209
             autocorr =       1.254093760740
              std dev =       0.759266781588
             le_variance =       0.576486045623


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243604511741e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436045117408       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436045118801       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436045120698       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436045120887       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436045121037       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436045119869       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436045120928       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436045121095       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436045121574       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+02 is 6.404732e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436045117408       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436045117756       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436045118231       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436045118278       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436045118316       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436045118022       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436045118289       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436045118333       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436045118450       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+03 is 1.602189e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436045117408       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436045117495       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436045117614       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436045117625       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436045117635       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436045117561       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436045117634       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436045117638       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436045117671       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+03 is 4.006103e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2540e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852914e-02 1 1  ON 1
 uu_2                -2.782807e-02 1 1  ON 2
 uu_3                -9.841862e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800056e-01 1 1  ON 6
 uu_7                -1.821293e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828483e-01 1 1  ON 11
 ud_2                 3.200637e-02 1 1  ON 12
 ud_3                -5.294835e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589790e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388620e-01 1 1  ON 19
 eC_0                -6.945153e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211209e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666394e-01 1 1  ON 28
 eC_9                 6.868605e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348175e-01 1 1  ON 31
 eO_2                -3.452083e-01 1 1  ON 32
 eO_3                -2.201349e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449472e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110853e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203415e-02 1 1  ON 43
eH1_4                -6.074285e-03 1 1  ON 44
eH1_5                 4.174484e-03 1 1  ON 45
eH1_6                 3.504554e-02 1 1  ON 46
eH1_7                 4.295014e-02 1 1  ON 47
eH1_8                 3.258428e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710351e-02 1 1  ON 51
eH2_2                -4.841765e-02 1 1  ON 52
eH2_3                -4.863747e-02 1 1  ON 53
eH2_4                -1.300077e-02 1 1  ON 54
eH2_5                -2.778643e-03 1 1  ON 55
eH2_6                 2.824417e-02 1 1  ON 56
eH2_7                 3.894041e-02 1 1  ON 57
eH2_8                 2.793166e-02 1 1  ON 58
eH2_9                 9.287822e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.5021
    reference variance = 0.533424
====================================================
  Execution time = 4.3917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5566e-01
  Total weights = 2.0000e+06
  Execution time = 3.8520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555470703063
                                         uncertainty =       0.003417940178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555470703063
                                         uncertainty =       0.003417940178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527096840
  error estimate for blocks of size 2^( 2) =       0.000547700728
  error estimate for blocks of size 2^( 3) =       0.000565886049
  error estimate for blocks of size 2^( 4) =       0.000578868879
  error estimate for blocks of size 2^( 5) =       0.000586590672
  error estimate for blocks of size 2^( 6) =       0.000591720952
  error estimate for blocks of size 2^( 7) =       0.000596639324

      target function =                  N/A
              le_mean =     -22.436134863426
             les_mean =     503.935809490129
             stat err =       0.000588454957
             autocorr =       1.246366091749
              std dev =       0.745427500250
             le_variance =       0.555662158130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555470555243
                                         uncertainty =       0.003417939546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555470555243
                                         uncertainty =       0.003417939546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527096770
  error estimate for blocks of size 2^( 2) =       0.000547700668
  error estimate for blocks of size 2^( 3) =       0.000565885996
  error estimate for blocks of size 2^( 4) =       0.000578868818
  error estimate for blocks of size 2^( 5) =       0.000586590603
  error estimate for blocks of size 2^( 6) =       0.000591720885
  error estimate for blocks of size 2^( 7) =       0.000596639253

      target function =                  N/A
              le_mean =     -22.436134859715
             les_mean =     503.935809175714
             stat err =       0.000588454890
             autocorr =       1.246366140292
              std dev =       0.745427401057
             le_variance =       0.555662010247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555470629082
                                         uncertainty =       0.003417939862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555470629082
                                         uncertainty =       0.003417939862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527096805
  error estimate for blocks of size 2^( 2) =       0.000547700698
  error estimate for blocks of size 2^( 3) =       0.000565886023
  error estimate for blocks of size 2^( 4) =       0.000578868848
  error estimate for blocks of size 2^( 5) =       0.000586590638
  error estimate for blocks of size 2^( 6) =       0.000591720919
  error estimate for blocks of size 2^( 7) =       0.000596639289

      target function =                  N/A
              le_mean =     -22.436134861568
             les_mean =     503.935809332761
             stat err =       0.000588454923
             autocorr =       1.246366116065
              std dev =       0.745427450606
             le_variance =       0.555662084117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555470693813
                                         uncertainty =       0.003417940139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555470693813
                                         uncertainty =       0.003417940139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527096836
  error estimate for blocks of size 2^( 2) =       0.000547700725
  error estimate for blocks of size 2^( 3) =       0.000565886046
  error estimate for blocks of size 2^( 4) =       0.000578868875
  error estimate for blocks of size 2^( 5) =       0.000586590668
  error estimate for blocks of size 2^( 6) =       0.000591720948
  error estimate for blocks of size 2^( 7) =       0.000596639320

      target function =                  N/A
              le_mean =     -22.436134863193
             les_mean =     503.935809470450
             stat err =       0.000588454953
             autocorr =       1.246366094783
              std dev =       0.745427494043
             le_variance =       0.555662148875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436134863426        initial  <--
     3.9062e+02     3.9062e+03             6.4047e-07       -22.436134859715
     1.5625e+03     1.5625e+04             1.6022e-07       -22.436134861568
     6.2500e+03     6.2500e+04             4.0061e-08       -22.436134863193

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.2054
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852907e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200628e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211213e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996270e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868603e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201354e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182541e-02 1 1  ON 42
eH1_3                -4.203417e-02 1 1  ON 43
eH1_4                -6.074272e-03 1 1  ON 44
eH1_5                 4.174483e-03 1 1  ON 45
eH1_6                 3.504561e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258426e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710343e-02 1 1  ON 51
eH2_2                -4.841762e-02 1 1  ON 52
eH2_3                -4.863744e-02 1 1  ON 53
eH2_4                -1.300079e-02 1 1  ON 54
eH2_5                -2.778754e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793162e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2575e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2415e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.3855
    reference variance = 0.419321
====================================================
  Execution time = 4.5077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6547e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4939e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565519488924
                                         uncertainty =       0.005585588040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565519488924
                                         uncertainty =       0.005585588040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531729094
  error estimate for blocks of size 2^( 2) =       0.000551680736
  error estimate for blocks of size 2^( 3) =       0.000570009848
  error estimate for blocks of size 2^( 4) =       0.000583470032
  error estimate for blocks of size 2^( 5) =       0.000592368641
  error estimate for blocks of size 2^( 6) =       0.000597139961
  error estimate for blocks of size 2^( 7) =       0.000601027260

      target function =                  N/A
              le_mean =     -22.437119497446
             les_mean =     503.989802718523
             stat err =       0.000593501474
             autocorr =       1.245841391754
              std dev =       0.751978496088
             le_variance =       0.565471658579


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243711949745e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437119497446       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437119498054       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437119498128       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437119498287       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437119498298       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437119498342       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437119498476       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437119498546       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437119498557       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437119498543       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+03 is 6.789720e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437119497446       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437119497598       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437119497617       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437119497656       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437119497658       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437119497670       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437119497684       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437119497725       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437119497720       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437119497708       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+04 is 1.697550e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437119497446       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437119497484       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437119497489       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437119497509       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437119497476       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437119497498       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437119497508       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437119497551       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437119497651       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437119497455       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+04 is 4.243952e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0027e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852908e-02 1 1  ON 1
 uu_2                -2.782803e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200629e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211213e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868603e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201353e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203418e-02 1 1  ON 43
eH1_4                -6.074265e-03 1 1  ON 44
eH1_5                 4.174474e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841762e-02 1 1  ON 52
eH2_3                -4.863744e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778749e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793162e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.4276
    reference variance = 0.779202
====================================================
  Execution time = 4.4365e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5844e-01
  Total weights = 2.0000e+06
  Execution time = 3.8470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558362214324
                                         uncertainty =       0.003193209167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558362214324
                                         uncertainty =       0.003193209167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528414040
  error estimate for blocks of size 2^( 2) =       0.000548295095
  error estimate for blocks of size 2^( 3) =       0.000567150542
  error estimate for blocks of size 2^( 4) =       0.000580058955
  error estimate for blocks of size 2^( 5) =       0.000588149497
  error estimate for blocks of size 2^( 6) =       0.000594088155
  error estimate for blocks of size 2^( 7) =       0.000597443012

      target function =                  N/A
              le_mean =     -22.437217636946
             les_mean =     503.987177803865
             stat err =       0.000589934905
             autocorr =       1.246405879884
              std dev =       0.747290301971
             le_variance =       0.558442795420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558362270133
                                         uncertainty =       0.003193209584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558362270133
                                         uncertainty =       0.003193209584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528414066
  error estimate for blocks of size 2^( 2) =       0.000548295120
  error estimate for blocks of size 2^( 3) =       0.000567150565
  error estimate for blocks of size 2^( 4) =       0.000580058978
  error estimate for blocks of size 2^( 5) =       0.000588149519
  error estimate for blocks of size 2^( 6) =       0.000594088177
  error estimate for blocks of size 2^( 7) =       0.000597443033

      target function =                  N/A
              le_mean =     -22.437217636635
             les_mean =     503.987177845730
             stat err =       0.000589934927
             autocorr =       1.246405848072
              std dev =       0.747290339313
             le_variance =       0.558442851231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558362242232
                                         uncertainty =       0.003193209376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558362242232
                                         uncertainty =       0.003193209376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528414053
  error estimate for blocks of size 2^( 2) =       0.000548295107
  error estimate for blocks of size 2^( 3) =       0.000567150554
  error estimate for blocks of size 2^( 4) =       0.000580058967
  error estimate for blocks of size 2^( 5) =       0.000588149508
  error estimate for blocks of size 2^( 6) =       0.000594088166
  error estimate for blocks of size 2^( 7) =       0.000597443023

      target function =                  N/A
              le_mean =     -22.437217636790
             les_mean =     503.987177824800
             stat err =       0.000589934916
             autocorr =       1.246405863981
              std dev =       0.747290320645
             le_variance =       0.558442823329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558362217813
                                         uncertainty =       0.003193209194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558362217813
                                         uncertainty =       0.003193209194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528414042
  error estimate for blocks of size 2^( 2) =       0.000548295096
  error estimate for blocks of size 2^( 3) =       0.000567150543
  error estimate for blocks of size 2^( 4) =       0.000580058957
  error estimate for blocks of size 2^( 5) =       0.000588149498
  error estimate for blocks of size 2^( 6) =       0.000594088156
  error estimate for blocks of size 2^( 7) =       0.000597443014

      target function =                  N/A
              le_mean =     -22.437217636926
             les_mean =     503.987177806482
             stat err =       0.000589934906
             autocorr =       1.246405877904
              std dev =       0.747290304305
             le_variance =       0.558442798909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437217636946        initial  <--
     3.9062e+03     3.9062e+04             6.7897e-08       -22.437217636635
     1.5625e+04     1.5625e+05             1.6976e-08       -22.437217636790
     6.2500e+04     6.2500e+05             4.2440e-09       -22.437217636926

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6475
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852907e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200628e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211213e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996270e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868603e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201354e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182541e-02 1 1  ON 42
eH1_3                -4.203417e-02 1 1  ON 43
eH1_4                -6.074272e-03 1 1  ON 44
eH1_5                 4.174483e-03 1 1  ON 45
eH1_6                 3.504561e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258426e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710343e-02 1 1  ON 51
eH2_2                -4.841762e-02 1 1  ON 52
eH2_3                -4.863744e-02 1 1  ON 53
eH2_4                -1.300079e-02 1 1  ON 54
eH2_5                -2.778754e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793162e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2368e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2414e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.3643
    reference variance = 0.554222
====================================================
  Execution time = 4.7081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.9836e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5429e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.598459592246
                                         uncertainty =       0.025802011850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.598459592246
                                         uncertainty =       0.025802011850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000546971347
  error estimate for blocks of size 2^( 2) =       0.000566353922
  error estimate for blocks of size 2^( 3) =       0.000584428862
  error estimate for blocks of size 2^( 4) =       0.000597646126
  error estimate for blocks of size 2^( 5) =       0.000606016487
  error estimate for blocks of size 2^( 6) =       0.000612067886
  error estimate for blocks of size 2^( 7) =       0.000613079135

      target function =                  N/A
              le_mean =     -22.436581796380
             les_mean =     503.998557716151
             stat err =       0.000607202408
             autocorr =       1.232360635213
              std dev =       0.773534297671
             le_variance =       0.598355309674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243658179638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436581796380       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436581796382       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436581796379       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436581796374       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436581796390       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436581796389       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436581796364       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436581796260       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436581796423       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+04 is 4.762106e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436581796380       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436581796381       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436581796380       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436581796340       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436581796381       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436581796225       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436581796398       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436581796364       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436581796565       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+05 is 1.190536e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436581796380       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436581796380       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436581796380       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436581796469       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436581796472       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436581796316       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436581796277       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436581795884       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436581794740       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+05 is 2.976348e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227475 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2517e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852907e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200628e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211213e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996270e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868603e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201353e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182541e-02 1 1  ON 42
eH1_3                -4.203417e-02 1 1  ON 43
eH1_4                -6.074272e-03 1 1  ON 44
eH1_5                 4.174483e-03 1 1  ON 45
eH1_6                 3.504561e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258426e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841762e-02 1 1  ON 52
eH2_3                -4.863744e-02 1 1  ON 53
eH2_4                -1.300079e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793162e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.471
    reference variance = 0.514595
====================================================
  Execution time = 4.4147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6856e-01
  Total weights = 2.0000e+06
  Execution time = 3.8565e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568613119823
                                         uncertainty =       0.005680470990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568613119823
                                         uncertainty =       0.005680470990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533177344
  error estimate for blocks of size 2^( 2) =       0.000552834322
  error estimate for blocks of size 2^( 3) =       0.000571505879
  error estimate for blocks of size 2^( 4) =       0.000585785582
  error estimate for blocks of size 2^( 5) =       0.000594176729
  error estimate for blocks of size 2^( 6) =       0.000599114447
  error estimate for blocks of size 2^( 7) =       0.000601691557

      target function =                  N/A
              le_mean =     -22.437718281811
             les_mean =     504.019757571019
             stat err =       0.000595192079
             autocorr =       1.246151689308
              std dev =       0.754026631732
             le_variance =       0.568556161360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568613124200
                                         uncertainty =       0.005680471048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568613124200
                                         uncertainty =       0.005680471048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533177347
  error estimate for blocks of size 2^( 2) =       0.000552834324
  error estimate for blocks of size 2^( 3) =       0.000571505880
  error estimate for blocks of size 2^( 4) =       0.000585785584
  error estimate for blocks of size 2^( 5) =       0.000594176730
  error estimate for blocks of size 2^( 6) =       0.000599114449
  error estimate for blocks of size 2^( 7) =       0.000601691559

      target function =                  N/A
              le_mean =     -22.437718281841
             les_mean =     504.019757576733
             stat err =       0.000595192080
             autocorr =       1.246151686955
              std dev =       0.754026634633
             le_variance =       0.568556165736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568613122011
                                         uncertainty =       0.005680471019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568613122011
                                         uncertainty =       0.005680471019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533177346
  error estimate for blocks of size 2^( 2) =       0.000552834323
  error estimate for blocks of size 2^( 3) =       0.000571505880
  error estimate for blocks of size 2^( 4) =       0.000585785583
  error estimate for blocks of size 2^( 5) =       0.000594176729
  error estimate for blocks of size 2^( 6) =       0.000599114448
  error estimate for blocks of size 2^( 7) =       0.000601691558

      target function =                  N/A
              le_mean =     -22.437718281826
             les_mean =     504.019757573876
             stat err =       0.000595192080
             autocorr =       1.246151688135
              std dev =       0.754026633182
             le_variance =       0.568556163548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568613120096
                                         uncertainty =       0.005680470994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568613120096
                                         uncertainty =       0.005680470994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533177345
  error estimate for blocks of size 2^( 2) =       0.000552834322
  error estimate for blocks of size 2^( 3) =       0.000571505879
  error estimate for blocks of size 2^( 4) =       0.000585785582
  error estimate for blocks of size 2^( 5) =       0.000594176729
  error estimate for blocks of size 2^( 6) =       0.000599114447
  error estimate for blocks of size 2^( 7) =       0.000601691557

      target function =                  N/A
              le_mean =     -22.437718281813
             les_mean =     504.019757571376
             stat err =       0.000595192079
             autocorr =       1.246151689163
              std dev =       0.754026631913
             le_variance =       0.568556161633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437718281811        initial
     3.9062e+04     3.9062e+05             4.7621e-09       -22.437718281841  <--
     1.5625e+05     1.5625e+06             1.1905e-09       -22.437718281826
     6.2500e+05     6.2500e+06             2.9763e-10       -22.437718281813

*****************************************************************************
Applying the update for shift_i =   3.9062e+04     and shift_s =   3.9062e+05
*****************************************************************************

  Execution time = 6.3465e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852908e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200628e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211213e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996270e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868603e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201353e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182541e-02 1 1  ON 42
eH1_3                -4.203417e-02 1 1  ON 43
eH1_4                -6.074270e-03 1 1  ON 44
eH1_5                 4.174485e-03 1 1  ON 45
eH1_6                 3.504561e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258426e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841762e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300079e-02 1 1  ON 54
eH2_5                -2.778750e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793162e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2599e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2414e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.4772
    reference variance = 0.521797
====================================================
  Execution time = 4.4753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6055e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5086e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560549696865
                                         uncertainty =       0.003573772096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560549696865
                                         uncertainty =       0.003573772096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529410367
  error estimate for blocks of size 2^( 2) =       0.000549343953
  error estimate for blocks of size 2^( 3) =       0.000568339707
  error estimate for blocks of size 2^( 4) =       0.000582294220
  error estimate for blocks of size 2^( 5) =       0.000592673672
  error estimate for blocks of size 2^( 6) =       0.000595929115
  error estimate for blocks of size 2^( 7) =       0.000598592155

      target function =                  N/A
              le_mean =     -22.437545180449
             les_mean =     504.003984117077
             stat err =       0.000592372290
             autocorr =       1.252000747153
              std dev =       0.748699320603
             le_variance =       0.560550672672


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243754518045e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437545180449       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437545180564       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437545180587       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437545180581       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437545180599       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437545180595       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437545180614       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437545180603       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437545180602       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437545180622       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+03 is 2.341527e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437545180449       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437545180477       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437545180483       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437545180483       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437545180484       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437545180447       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437545180490       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437545180492       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437545180501       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437545180539       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+04 is 5.853944e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437545180449       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437545180456       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437545180457       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437545180457       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437545180547       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437545180451       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437545180433       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437545180567       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437545180369       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437545180271       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+05 is 1.463494e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231046 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9846e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852908e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200629e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211214e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996270e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868603e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201353e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182541e-02 1 1  ON 42
eH1_3                -4.203417e-02 1 1  ON 43
eH1_4                -6.074273e-03 1 1  ON 44
eH1_5                 4.174482e-03 1 1  ON 45
eH1_6                 3.504561e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258426e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841762e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300079e-02 1 1  ON 54
eH2_5                -2.778751e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793162e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.4823
    reference variance = 1.14932
====================================================
  Execution time = 4.4554e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6190e-01
  Total weights = 2.0000e+06
  Execution time = 3.8392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561875333939
                                         uncertainty =       0.003584226853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561875333939
                                         uncertainty =       0.003584226853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530049113
  error estimate for blocks of size 2^( 2) =       0.000550204986
  error estimate for blocks of size 2^( 3) =       0.000568325080
  error estimate for blocks of size 2^( 4) =       0.000582651208
  error estimate for blocks of size 2^( 5) =       0.000590594715
  error estimate for blocks of size 2^( 6) =       0.000595384316
  error estimate for blocks of size 2^( 7) =       0.000596945253

      target function =                  N/A
              le_mean =     -22.436722746391
             les_mean =     503.968431441814
             stat err =       0.000591393873
             autocorr =       1.244862594053
              std dev =       0.749602644290
             le_variance =       0.561904124327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561875316366
                                         uncertainty =       0.003584226756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561875316366
                                         uncertainty =       0.003584226756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530049105
  error estimate for blocks of size 2^( 2) =       0.000550204979
  error estimate for blocks of size 2^( 3) =       0.000568325073
  error estimate for blocks of size 2^( 4) =       0.000582651202
  error estimate for blocks of size 2^( 5) =       0.000590594708
  error estimate for blocks of size 2^( 6) =       0.000595384310
  error estimate for blocks of size 2^( 7) =       0.000596945246

      target function =                  N/A
              le_mean =     -22.436722746429
             les_mean =     503.968431425923
             stat err =       0.000591393867
             autocorr =       1.244862606119
              std dev =       0.749602632555
             le_variance =       0.561904106733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561875325152
                                         uncertainty =       0.003584226804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561875325152
                                         uncertainty =       0.003584226804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530049109
  error estimate for blocks of size 2^( 2) =       0.000550204982
  error estimate for blocks of size 2^( 3) =       0.000568325076
  error estimate for blocks of size 2^( 4) =       0.000582651205
  error estimate for blocks of size 2^( 5) =       0.000590594711
  error estimate for blocks of size 2^( 6) =       0.000595384313
  error estimate for blocks of size 2^( 7) =       0.000596945249

      target function =                  N/A
              le_mean =     -22.436722746410
             les_mean =     503.968431433869
             stat err =       0.000591393870
             autocorr =       1.244862600088
              std dev =       0.749602638422
             le_variance =       0.561904115530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561875332840
                                         uncertainty =       0.003584226847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561875332840
                                         uncertainty =       0.003584226847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530049112
  error estimate for blocks of size 2^( 2) =       0.000550204986
  error estimate for blocks of size 2^( 3) =       0.000568325079
  error estimate for blocks of size 2^( 4) =       0.000582651208
  error estimate for blocks of size 2^( 5) =       0.000590594714
  error estimate for blocks of size 2^( 6) =       0.000595384316
  error estimate for blocks of size 2^( 7) =       0.000596945252

      target function =                  N/A
              le_mean =     -22.436722746394
             les_mean =     503.968431440821
             stat err =       0.000591393873
             autocorr =       1.244862594809
              std dev =       0.749602643557
             le_variance =       0.561904123227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436722746391        initial
     9.7656e+03     9.7656e+04             2.3415e-08       -22.436722746429  <--
     3.9062e+04     3.9062e+05             5.8539e-09       -22.436722746410
     1.5625e+05     1.5625e+06             1.4635e-09       -22.436722746394

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 6.3790e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852908e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200630e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201353e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182541e-02 1 1  ON 42
eH1_3                -4.203417e-02 1 1  ON 43
eH1_4                -6.074284e-03 1 1  ON 44
eH1_5                 4.174474e-03 1 1  ON 45
eH1_6                 3.504561e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300079e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2364e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2420e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.5568
    reference variance = 0.518607
====================================================
  Execution time = 4.5240e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6037e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5108e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560401417460
                                         uncertainty =       0.004189975361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560401417460
                                         uncertainty =       0.004189975361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529323072
  error estimate for blocks of size 2^( 2) =       0.000549818323
  error estimate for blocks of size 2^( 3) =       0.000568608544
  error estimate for blocks of size 2^( 4) =       0.000583094760
  error estimate for blocks of size 2^( 5) =       0.000590393964
  error estimate for blocks of size 2^( 6) =       0.000594198871
  error estimate for blocks of size 2^( 7) =       0.000596440383

      target function =                  N/A
              le_mean =     -22.437505323949
             les_mean =     504.002010712141
             stat err =       0.000591031995
             autocorr =       1.246752746807
              std dev =       0.748575867941
             le_variance =       0.560365830063


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243750532395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437505323949       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437505324014       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437505324348       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437505324427       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437505324591       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437505324814       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437505324648       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437505324633       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437505324634       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437505324587       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+03 is 9.588620e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437505323949       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437505323966       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437505324049       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437505324069       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437505324111       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437505324162       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437505324130       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437505324128       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437505324115       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437505324110       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+03 is 2.397289e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437505323949       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437505323954       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437505323974       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437505323979       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437505323990       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437505323988       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437505323997       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437505324036       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437505324031       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437505323997       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+04 is 5.993308e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234573 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0355e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852908e-02 1 1  ON 1
 uu_2                -2.782801e-02 1 1  ON 2
 uu_3                -9.841861e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945153e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996270e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203417e-02 1 1  ON 43
eH1_4                -6.074284e-03 1 1  ON 44
eH1_5                 4.174480e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710345e-02 1 1  ON 51
eH2_2                -4.841762e-02 1 1  ON 52
eH2_3                -4.863744e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778743e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793162e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.4692
    reference variance = 0.480183
====================================================
  Execution time = 4.7734e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6518e-01
  Total weights = 2.0000e+06
  Execution time = 4.0360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565321202647
                                         uncertainty =       0.004328133155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565321202647
                                         uncertainty =       0.004328133155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531593988
  error estimate for blocks of size 2^( 2) =       0.000552166990
  error estimate for blocks of size 2^( 3) =       0.000570227343
  error estimate for blocks of size 2^( 4) =       0.000583252292
  error estimate for blocks of size 2^( 5) =       0.000593070997
  error estimate for blocks of size 2^( 6) =       0.000599734268
  error estimate for blocks of size 2^( 7) =       0.000602734693

      target function =                  N/A
              le_mean =     -22.435596446292
             les_mean =     503.921171953988
             stat err =       0.000594698063
             autocorr =       1.251505972505
              std dev =       0.751787427213
             le_variance =       0.565184335716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565321120287
                                         uncertainty =       0.004328132732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565321120287
                                         uncertainty =       0.004328132732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531593949
  error estimate for blocks of size 2^( 2) =       0.000552166954
  error estimate for blocks of size 2^( 3) =       0.000570227310
  error estimate for blocks of size 2^( 4) =       0.000583252262
  error estimate for blocks of size 2^( 5) =       0.000593070968
  error estimate for blocks of size 2^( 6) =       0.000599734237
  error estimate for blocks of size 2^( 7) =       0.000602734658

      target function =                  N/A
              le_mean =     -22.435596445856
             les_mean =     503.921171852093
             stat err =       0.000594698031
             autocorr =       1.251506022548
              std dev =       0.751787372466
             le_variance =       0.565184253399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565321161463
                                         uncertainty =       0.004328132944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565321161463
                                         uncertainty =       0.004328132944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531593968
  error estimate for blocks of size 2^( 2) =       0.000552166972
  error estimate for blocks of size 2^( 3) =       0.000570227327
  error estimate for blocks of size 2^( 4) =       0.000583252277
  error estimate for blocks of size 2^( 5) =       0.000593070983
  error estimate for blocks of size 2^( 6) =       0.000599734253
  error estimate for blocks of size 2^( 7) =       0.000602734676

      target function =                  N/A
              le_mean =     -22.435596446074
             les_mean =     503.921171903033
             stat err =       0.000594698047
             autocorr =       1.251505997531
              std dev =       0.751787399837
             le_variance =       0.565184294554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565321197499
                                         uncertainty =       0.004328133129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565321197499
                                         uncertainty =       0.004328133129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531593985
  error estimate for blocks of size 2^( 2) =       0.000552166988
  error estimate for blocks of size 2^( 3) =       0.000570227341
  error estimate for blocks of size 2^( 4) =       0.000583252290
  error estimate for blocks of size 2^( 5) =       0.000593070995
  error estimate for blocks of size 2^( 6) =       0.000599734266
  error estimate for blocks of size 2^( 7) =       0.000602734691

      target function =                  N/A
              le_mean =     -22.435596446265
             les_mean =     503.921171947618
             stat err =       0.000594698061
             autocorr =       1.251505975633
              std dev =       0.751787423791
             le_variance =       0.565184330571


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435596446292        initial  <--
     2.4414e+03     2.4414e+04             9.5886e-08       -22.435596445856
     9.7656e+03     9.7656e+04             2.3973e-08       -22.435596446074
     3.9062e+04     3.9062e+05             5.9933e-09       -22.435596446265

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.2891
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852908e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200630e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201353e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182541e-02 1 1  ON 42
eH1_3                -4.203417e-02 1 1  ON 43
eH1_4                -6.074284e-03 1 1  ON 44
eH1_5                 4.174474e-03 1 1  ON 45
eH1_6                 3.504561e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300079e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2765e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2427e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.4187
    reference variance = 0.436692
====================================================
  Execution time = 4.4952e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7420e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5126e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574309325561
                                         uncertainty =       0.006741090329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574309325561
                                         uncertainty =       0.006741090329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535818268
  error estimate for blocks of size 2^( 2) =       0.000555463992
  error estimate for blocks of size 2^( 3) =       0.000574123886
  error estimate for blocks of size 2^( 4) =       0.000586511488
  error estimate for blocks of size 2^( 5) =       0.000595119498
  error estimate for blocks of size 2^( 6) =       0.000600244087
  error estimate for blocks of size 2^( 7) =       0.000604403365

      target function =                  N/A
              le_mean =     -22.437283643309
             les_mean =     504.005899435546
             stat err =       0.000596569610
             autocorr =       1.239616131827
              std dev =       0.757761461385
             le_variance =       0.574202432361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243728364331e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437283643309       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437283643293       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437283643290       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437283643268       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437283643312       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437283643317       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437283643276       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437283643212       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437283643231       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437283643306       residual = 1.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+04 is 8.053600e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437283643309       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437283643305       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437283643304       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437283643302       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437283643311       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437283643279       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437283643309       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437283643016       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437283643223       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437283643774       residual = 1.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+04 is 2.013420e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437283643309       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437283643308       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437283643307       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437283643308       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437283643359       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437283643269       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437283643420       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437283642949       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437283643317       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437283642719       residual = 1.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+05 is 5.033563e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0086e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852908e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200630e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829832e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182541e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074285e-03 1 1  ON 44
eH1_5                 4.174475e-03 1 1  ON 45
eH1_6                 3.504561e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300079e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.3289
    reference variance = 0.857883
====================================================
  Execution time = 4.4212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6355e-01
  Total weights = 2.0000e+06
  Execution time = 3.8382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563547653690
                                         uncertainty =       0.003767024838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563547653690
                                         uncertainty =       0.003767024838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530825354
  error estimate for blocks of size 2^( 2) =       0.000550854877
  error estimate for blocks of size 2^( 3) =       0.000569011567
  error estimate for blocks of size 2^( 4) =       0.000582781208
  error estimate for blocks of size 2^( 5) =       0.000591772258
  error estimate for blocks of size 2^( 6) =       0.000597102681
  error estimate for blocks of size 2^( 7) =       0.000600287407

      target function =                  N/A
              le_mean =     -22.436576569073
             les_mean =     503.963518971194
             stat err =       0.000592985888
             autocorr =       1.247916136492
              std dev =       0.750700414998
             le_variance =       0.563551113078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563547643809
                                         uncertainty =       0.003767024757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563547643809
                                         uncertainty =       0.003767024757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530825349
  error estimate for blocks of size 2^( 2) =       0.000550854872
  error estimate for blocks of size 2^( 3) =       0.000569011563
  error estimate for blocks of size 2^( 4) =       0.000582781204
  error estimate for blocks of size 2^( 5) =       0.000591772254
  error estimate for blocks of size 2^( 6) =       0.000597102677
  error estimate for blocks of size 2^( 7) =       0.000600287403

      target function =                  N/A
              le_mean =     -22.436576569089
             les_mean =     503.963518962008
             stat err =       0.000592985885
             autocorr =       1.247916141857
              std dev =       0.750700408418
             le_variance =       0.563551103199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563547648750
                                         uncertainty =       0.003767024797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563547648750
                                         uncertainty =       0.003767024797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530825352
  error estimate for blocks of size 2^( 2) =       0.000550854875
  error estimate for blocks of size 2^( 3) =       0.000569011565
  error estimate for blocks of size 2^( 4) =       0.000582781206
  error estimate for blocks of size 2^( 5) =       0.000591772256
  error estimate for blocks of size 2^( 6) =       0.000597102679
  error estimate for blocks of size 2^( 7) =       0.000600287405

      target function =                  N/A
              le_mean =     -22.436576569081
             les_mean =     503.963518966600
             stat err =       0.000592985886
             autocorr =       1.247916139176
              std dev =       0.750700411708
             le_variance =       0.563551108139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563547653073
                                         uncertainty =       0.003767024832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563547653073
                                         uncertainty =       0.003767024832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530825354
  error estimate for blocks of size 2^( 2) =       0.000550854877
  error estimate for blocks of size 2^( 3) =       0.000569011567
  error estimate for blocks of size 2^( 4) =       0.000582781208
  error estimate for blocks of size 2^( 5) =       0.000591772257
  error estimate for blocks of size 2^( 6) =       0.000597102680
  error estimate for blocks of size 2^( 7) =       0.000600287407

      target function =                  N/A
              le_mean =     -22.436576569074
             les_mean =     503.963518970619
             stat err =       0.000592985888
             autocorr =       1.247916136824
              std dev =       0.750700414586
             le_variance =       0.563551112460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436576569073        initial
     2.4414e+04     2.4414e+05             8.0536e-09       -22.436576569089  <--
     9.7656e+04     9.7656e+05             2.0134e-09       -22.436576569081
     3.9062e+05     3.9062e+06             5.0336e-10       -22.436576569074

*****************************************************************************
Applying the update for shift_i =   2.4414e+04     and shift_s =   2.4414e+05
*****************************************************************************

  Execution time = 6.3439e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200630e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074285e-03 1 1  ON 44
eH1_5                 4.174478e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2353e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2423e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.472
    reference variance = 0.525688
====================================================
  Execution time = 4.4665e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5752e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4963e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557475697230
                                         uncertainty =       0.004235223464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557475697230
                                         uncertainty =       0.004235223464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527977610
  error estimate for blocks of size 2^( 2) =       0.000548199824
  error estimate for blocks of size 2^( 3) =       0.000566494739
  error estimate for blocks of size 2^( 4) =       0.000580436462
  error estimate for blocks of size 2^( 5) =       0.000589539191
  error estimate for blocks of size 2^( 6) =       0.000593457307
  error estimate for blocks of size 2^( 7) =       0.000599136230

      target function =                  N/A
              le_mean =     -22.436521672926
             les_mean =     503.955025214224
             stat err =       0.000590642298
             autocorr =       1.251463185160
              std dev =       0.746673096684
             le_variance =       0.557520713312


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243652167293e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436521672926       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436521673038       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436521673027       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436521673019       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436521673143       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436521673207       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436521673158       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436521673156       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436521673168       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436521673149       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+03 is 3.764209e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436521672926       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436521672954       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436521672951       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436521672949       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436521672981       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436521673007       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436521672982       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436521672951       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436521672957       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436521672931       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+04 is 9.410706e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436521672926       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436521672933       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436521672932       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436521672930       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436521672880       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436521672905       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436521672932       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436521673038       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436521672920       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436521673137       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+04 is 2.352688e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9635e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211214e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074279e-03 1 1  ON 44
eH1_5                 4.174473e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710345e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778751e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.3947
    reference variance = 0.381969
====================================================
  Execution time = 4.4767e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6533e-01
  Total weights = 2.0000e+06
  Execution time = 3.8491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565379632647
                                         uncertainty =       0.004285036115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565379632647
                                         uncertainty =       0.004285036115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531661685
  error estimate for blocks of size 2^( 2) =       0.000551187199
  error estimate for blocks of size 2^( 3) =       0.000569148814
  error estimate for blocks of size 2^( 4) =       0.000582599799
  error estimate for blocks of size 2^( 5) =       0.000590709092
  error estimate for blocks of size 2^( 6) =       0.000596841093
  error estimate for blocks of size 2^( 7) =       0.000598320386

      target function =                  N/A
              le_mean =     -22.437408932954
             les_mean =     504.002647636908
             stat err =       0.000592117592
             autocorr =       1.240352716789
              std dev =       0.751883165764
             le_variance =       0.565328294960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565379651240
                                         uncertainty =       0.004285036329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565379651240
                                         uncertainty =       0.004285036329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531661694
  error estimate for blocks of size 2^( 2) =       0.000551187207
  error estimate for blocks of size 2^( 3) =       0.000569148823
  error estimate for blocks of size 2^( 4) =       0.000582599807
  error estimate for blocks of size 2^( 5) =       0.000590709100
  error estimate for blocks of size 2^( 6) =       0.000596841100
  error estimate for blocks of size 2^( 7) =       0.000598320392

      target function =                  N/A
              le_mean =     -22.437408932602
             les_mean =     504.002647639691
             stat err =       0.000592117600
             autocorr =       1.240352707852
              std dev =       0.751883178124
             le_variance =       0.565328313546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565379641944
                                         uncertainty =       0.004285036222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565379641944
                                         uncertainty =       0.004285036222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531661690
  error estimate for blocks of size 2^( 2) =       0.000551187203
  error estimate for blocks of size 2^( 3) =       0.000569148818
  error estimate for blocks of size 2^( 4) =       0.000582599803
  error estimate for blocks of size 2^( 5) =       0.000590709096
  error estimate for blocks of size 2^( 6) =       0.000596841097
  error estimate for blocks of size 2^( 7) =       0.000598320389

      target function =                  N/A
              le_mean =     -22.437408932778
             les_mean =     504.002647638300
             stat err =       0.000592117596
             autocorr =       1.240352712328
              std dev =       0.751883171944
             le_variance =       0.565328304253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565379633809
                                         uncertainty =       0.004285036128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565379633809
                                         uncertainty =       0.004285036128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531661686
  error estimate for blocks of size 2^( 2) =       0.000551187199
  error estimate for blocks of size 2^( 3) =       0.000569148814
  error estimate for blocks of size 2^( 4) =       0.000582599799
  error estimate for blocks of size 2^( 5) =       0.000590709093
  error estimate for blocks of size 2^( 6) =       0.000596841093
  error estimate for blocks of size 2^( 7) =       0.000598320386

      target function =                  N/A
              le_mean =     -22.437408932932
             les_mean =     504.002647637082
             stat err =       0.000592117593
             autocorr =       1.240352716239
              std dev =       0.751883166537
             le_variance =       0.565328296122


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437408932954        initial  <--
     6.1035e+03     6.1035e+04             3.7642e-08       -22.437408932602
     2.4414e+04     2.4414e+05             9.4107e-09       -22.437408932778
     9.7656e+04     9.7656e+05             2.3527e-09       -22.437408932932

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.8043
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200630e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074285e-03 1 1  ON 44
eH1_5                 4.174478e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2745e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2424e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.3398
    reference variance = 0.488672
====================================================
  Execution time = 4.6576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6360e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5068e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563597465058
                                         uncertainty =       0.005382326226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563597465058
                                         uncertainty =       0.005382326226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530846506
  error estimate for blocks of size 2^( 2) =       0.000550897548
  error estimate for blocks of size 2^( 3) =       0.000570313458
  error estimate for blocks of size 2^( 4) =       0.000584339320
  error estimate for blocks of size 2^( 5) =       0.000592758999
  error estimate for blocks of size 2^( 6) =       0.000598336085
  error estimate for blocks of size 2^( 7) =       0.000597996346

      target function =                  N/A
              le_mean =     -22.436739215803
             les_mean =     503.970862381114
             stat err =       0.000593357687
             autocorr =       1.249381931514
              std dev =       0.750730327725
             le_variance =       0.563596024967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243673921580e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436739215803       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436739215794       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436739215795       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436739215794       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436739215790       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436739215786       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436739215806       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436739215812       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436739216000       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436739215868       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+04 is 4.184811e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436739215803       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436739215801       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436739215801       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436739215776       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436739215797       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436739215736       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436739215950       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436739216128       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436739214954       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436739214072       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+05 is 1.046204e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436739215803       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436739215802       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436739215802       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436739215801       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436739214444       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436739215802       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436739215781       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436739216099       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436739215137       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436739217020       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+05 is 2.615507e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245310 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1652e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200630e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074284e-03 1 1  ON 44
eH1_5                 4.174478e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824419e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.3956
    reference variance = 0.403259
====================================================
  Execution time = 4.4249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6130e-01
  Total weights = 2.0000e+06
  Execution time = 3.8580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561331013491
                                         uncertainty =       0.003953856433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561331013491
                                         uncertainty =       0.003953856433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529762409
  error estimate for blocks of size 2^( 2) =       0.000549776758
  error estimate for blocks of size 2^( 3) =       0.000568181100
  error estimate for blocks of size 2^( 4) =       0.000581896145
  error estimate for blocks of size 2^( 5) =       0.000590012183
  error estimate for blocks of size 2^( 6) =       0.000595448116
  error estimate for blocks of size 2^( 7) =       0.000599201944

      target function =                  N/A
              le_mean =     -22.436438717412
             les_mean =     503.955078459475
             stat err =       0.000591639597
             autocorr =       1.247246197295
              std dev =       0.749197183623
             le_variance =       0.561296419949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561331015820
                                         uncertainty =       0.003953856451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561331015820
                                         uncertainty =       0.003953856451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529762410
  error estimate for blocks of size 2^( 2) =       0.000549776759
  error estimate for blocks of size 2^( 3) =       0.000568181101
  error estimate for blocks of size 2^( 4) =       0.000581896145
  error estimate for blocks of size 2^( 5) =       0.000590012184
  error estimate for blocks of size 2^( 6) =       0.000595448117
  error estimate for blocks of size 2^( 7) =       0.000599201945

      target function =                  N/A
              le_mean =     -22.436438717415
             les_mean =     503.955078461964
             stat err =       0.000591639598
             autocorr =       1.247246195764
              std dev =       0.749197185177
             le_variance =       0.561296422278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561331014656
                                         uncertainty =       0.003953856442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561331014656
                                         uncertainty =       0.003953856442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529762410
  error estimate for blocks of size 2^( 2) =       0.000549776758
  error estimate for blocks of size 2^( 3) =       0.000568181101
  error estimate for blocks of size 2^( 4) =       0.000581896145
  error estimate for blocks of size 2^( 5) =       0.000590012183
  error estimate for blocks of size 2^( 6) =       0.000595448117
  error estimate for blocks of size 2^( 7) =       0.000599201944

      target function =                  N/A
              le_mean =     -22.436438717414
             les_mean =     503.955078460720
             stat err =       0.000591639597
             autocorr =       1.247246196533
              std dev =       0.749197184400
             le_variance =       0.561296421113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561331013637
                                         uncertainty =       0.003953856435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561331013637
                                         uncertainty =       0.003953856435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529762409
  error estimate for blocks of size 2^( 2) =       0.000549776758
  error estimate for blocks of size 2^( 3) =       0.000568181100
  error estimate for blocks of size 2^( 4) =       0.000581896145
  error estimate for blocks of size 2^( 5) =       0.000590012183
  error estimate for blocks of size 2^( 6) =       0.000595448116
  error estimate for blocks of size 2^( 7) =       0.000599201944

      target function =                  N/A
              le_mean =     -22.436438717412
             les_mean =     503.955078459630
             stat err =       0.000591639597
             autocorr =       1.247246197198
              std dev =       0.749197183720
             le_variance =       0.561296420094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436438717412        initial
     6.1035e+04     6.1035e+05             4.1848e-09       -22.436438717415  <--
     2.4414e+05     2.4414e+06             1.0462e-09       -22.436438717414
     9.7656e+05     9.7656e+06             2.6155e-10       -22.436438717412

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 6.3579e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200630e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074283e-03 1 1  ON 44
eH1_5                 4.174478e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2524e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2420e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.3766
    reference variance = 0.557916
====================================================
  Execution time = 4.5143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7491e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5377e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574977583902
                                         uncertainty =       0.006173027164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574977583902
                                         uncertainty =       0.006173027164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536147612
  error estimate for blocks of size 2^( 2) =       0.000556001182
  error estimate for blocks of size 2^( 3) =       0.000574828055
  error estimate for blocks of size 2^( 4) =       0.000588837119
  error estimate for blocks of size 2^( 5) =       0.000599404325
  error estimate for blocks of size 2^( 6) =       0.000603407836
  error estimate for blocks of size 2^( 7) =       0.000605071533

      target function =                  N/A
              le_mean =     -22.438172507595
             les_mean =     504.046493717839
             stat err =       0.000599180203
             autocorr =       1.248953182308
              std dev =       0.758227224993
             le_variance =       0.574908524721


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243817250759e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438172507595       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438172507656       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438172507712       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438172507672       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438172507730       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438172507718       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438172507752       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438172507774       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438172507746       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438172507753       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+04 is 1.413536e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438172507595       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438172507610       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438172507624       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438172507643       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438172507641       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438172507683       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438172507587       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438172507583       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438172507745       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438172507689       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+04 is 3.533907e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438172507595       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438172507598       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438172507602       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438172507599       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438172507492       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438172507612       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438172507603       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438172507656       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438172507406       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438172506857       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+05 is 8.834813e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0527e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841859e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182541e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074282e-03 1 1  ON 44
eH1_5                 4.174475e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.5253
    reference variance = 0.626736
====================================================
  Execution time = 4.4210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5842e-01
  Total weights = 2.0000e+06
  Execution time = 3.8420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558453984589
                                         uncertainty =       0.003403184779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558453984589
                                         uncertainty =       0.003403184779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528405059
  error estimate for blocks of size 2^( 2) =       0.000548175739
  error estimate for blocks of size 2^( 3) =       0.000566489346
  error estimate for blocks of size 2^( 4) =       0.000579768185
  error estimate for blocks of size 2^( 5) =       0.000587762973
  error estimate for blocks of size 2^( 6) =       0.000590979377
  error estimate for blocks of size 2^( 7) =       0.000594095356

      target function =                  N/A
              le_mean =     -22.437049590429
             les_mean =     503.979617856038
             stat err =       0.000588151473
             autocorr =       1.238923367607
              std dev =       0.747277600280
             le_variance =       0.558423811881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558453975630
                                         uncertainty =       0.003403184777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558453975630
                                         uncertainty =       0.003403184777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528405054
  error estimate for blocks of size 2^( 2) =       0.000548175735
  error estimate for blocks of size 2^( 3) =       0.000566489342
  error estimate for blocks of size 2^( 4) =       0.000579768181
  error estimate for blocks of size 2^( 5) =       0.000587762969
  error estimate for blocks of size 2^( 6) =       0.000590979373
  error estimate for blocks of size 2^( 7) =       0.000594095352

      target function =                  N/A
              le_mean =     -22.437049590314
             les_mean =     503.979617841902
             stat err =       0.000588151469
             autocorr =       1.238923371952
              std dev =       0.747277594277
             le_variance =       0.558423802909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558453980109
                                         uncertainty =       0.003403184778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558453980109
                                         uncertainty =       0.003403184778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528405056
  error estimate for blocks of size 2^( 2) =       0.000548175737
  error estimate for blocks of size 2^( 3) =       0.000566489344
  error estimate for blocks of size 2^( 4) =       0.000579768183
  error estimate for blocks of size 2^( 5) =       0.000587762971
  error estimate for blocks of size 2^( 6) =       0.000590979375
  error estimate for blocks of size 2^( 7) =       0.000594095354

      target function =                  N/A
              le_mean =     -22.437049590371
             les_mean =     503.979617848970
             stat err =       0.000588151471
             autocorr =       1.238923369781
              std dev =       0.747277597279
             le_variance =       0.558423807394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558453984029
                                         uncertainty =       0.003403184779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558453984029
                                         uncertainty =       0.003403184779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528405058
  error estimate for blocks of size 2^( 2) =       0.000548175739
  error estimate for blocks of size 2^( 3) =       0.000566489346
  error estimate for blocks of size 2^( 4) =       0.000579768185
  error estimate for blocks of size 2^( 5) =       0.000587762973
  error estimate for blocks of size 2^( 6) =       0.000590979377
  error estimate for blocks of size 2^( 7) =       0.000594095356

      target function =                  N/A
              le_mean =     -22.437049590422
             les_mean =     503.979617855155
             stat err =       0.000588151472
             autocorr =       1.238923367880
              std dev =       0.747277599905
             le_variance =       0.558423811320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437049590429        initial  <--
     1.5259e+04     1.5259e+05             1.4135e-08       -22.437049590314
     6.1035e+04     6.1035e+05             3.5339e-09       -22.437049590371
     2.4414e+05     2.4414e+06             8.8348e-10       -22.437049590422

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.4780
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200630e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074283e-03 1 1  ON 44
eH1_5                 4.174478e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2401e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2422e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.4153
    reference variance = 0.486153
====================================================
  Execution time = 4.6473e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6689e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5281e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566879927022
                                         uncertainty =       0.004748581611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566879927022
                                         uncertainty =       0.004748581611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532397372
  error estimate for blocks of size 2^( 2) =       0.000552516151
  error estimate for blocks of size 2^( 3) =       0.000570771325
  error estimate for blocks of size 2^( 4) =       0.000583684246
  error estimate for blocks of size 2^( 5) =       0.000593247724
  error estimate for blocks of size 2^( 6) =       0.000599711874
  error estimate for blocks of size 2^( 7) =       0.000606313139

      target function =                  N/A
              le_mean =     -22.437160033484
             les_mean =     503.993044009052
             stat err =       0.000595739246
             autocorr =       1.252104612942
              std dev =       0.752923584643
             le_variance =       0.566893924312


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243716003348e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437160033484       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437160033489       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437160033491       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437160033490       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437160033337       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437160033486       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437160033478       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437160033335       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437160033776       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437160033734       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+05 is 1.274805e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437160033484       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437160033486       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437160033486       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437160033439       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437160033065       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437160033468       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437160034058       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437160033573       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437160032949       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437160035170       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+05 is 3.187012e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437160033484       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437160033485       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437160033485       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437160033430       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437160032769       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437160033575       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437160033270       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437160033657       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437160033661       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437160035501       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+06 is 7.967534e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1762e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200630e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074283e-03 1 1  ON 44
eH1_5                 4.174478e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6233
    reference variance = 1.72366
====================================================
  Execution time = 4.6397e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5919e-01
  Total weights = 2.0000e+06
  Execution time = 3.8703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558934793825
                                         uncertainty =       0.004293070562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558934793825
                                         uncertainty =       0.004293070562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528765404
  error estimate for blocks of size 2^( 2) =       0.000548969691
  error estimate for blocks of size 2^( 3) =       0.000566919473
  error estimate for blocks of size 2^( 4) =       0.000580983128
  error estimate for blocks of size 2^( 5) =       0.000590985230
  error estimate for blocks of size 2^( 6) =       0.000597371909
  error estimate for blocks of size 2^( 7) =       0.000599532843

      target function =                  N/A
              le_mean =     -22.437730639649
             les_mean =     504.010941681964
             stat err =       0.000592218278
             autocorr =       1.254404344465
              std dev =       0.747787205091
             le_variance =       0.559185704098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558934793969
                                         uncertainty =       0.004293070560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558934793969
                                         uncertainty =       0.004293070560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528765404
  error estimate for blocks of size 2^( 2) =       0.000548969691
  error estimate for blocks of size 2^( 3) =       0.000566919473
  error estimate for blocks of size 2^( 4) =       0.000580983128
  error estimate for blocks of size 2^( 5) =       0.000590985230
  error estimate for blocks of size 2^( 6) =       0.000597371909
  error estimate for blocks of size 2^( 7) =       0.000599532843

      target function =                  N/A
              le_mean =     -22.437730639661
             les_mean =     504.010941682627
             stat err =       0.000592218278
             autocorr =       1.254404344276
              std dev =       0.747787205188
             le_variance =       0.559185704243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558934793897
                                         uncertainty =       0.004293070561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558934793897
                                         uncertainty =       0.004293070561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528765404
  error estimate for blocks of size 2^( 2) =       0.000548969691
  error estimate for blocks of size 2^( 3) =       0.000566919473
  error estimate for blocks of size 2^( 4) =       0.000580983128
  error estimate for blocks of size 2^( 5) =       0.000590985230
  error estimate for blocks of size 2^( 6) =       0.000597371909
  error estimate for blocks of size 2^( 7) =       0.000599532843

      target function =                  N/A
              le_mean =     -22.437730639655
             les_mean =     504.010941682296
             stat err =       0.000592218278
             autocorr =       1.254404344374
              std dev =       0.747787205140
             le_variance =       0.559185704171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558934793834
                                         uncertainty =       0.004293070562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558934793834
                                         uncertainty =       0.004293070562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528765404
  error estimate for blocks of size 2^( 2) =       0.000548969691
  error estimate for blocks of size 2^( 3) =       0.000566919473
  error estimate for blocks of size 2^( 4) =       0.000580983128
  error estimate for blocks of size 2^( 5) =       0.000590985230
  error estimate for blocks of size 2^( 6) =       0.000597371909
  error estimate for blocks of size 2^( 7) =       0.000599532843

      target function =                  N/A
              le_mean =     -22.437730639650
             les_mean =     504.010941682006
             stat err =       0.000592218278
             autocorr =       1.254404344446
              std dev =       0.747787205098
             le_variance =       0.559185704108


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437730639649        initial
     1.5259e+05     1.5259e+06             1.2748e-09       -22.437730639661  <--
     6.1035e+05     6.1035e+06             3.1870e-10       -22.437730639655
     2.4414e+06     2.4414e+07             7.9675e-11       -22.437730639650

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 6.5761e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200630e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074283e-03 1 1  ON 44
eH1_5                 4.174477e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2753e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2427e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6443
    reference variance = 0.682559
====================================================
  Execution time = 4.4982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6603e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5180e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566050558345
                                         uncertainty =       0.005799165555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566050558345
                                         uncertainty =       0.005799165555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531993872
  error estimate for blocks of size 2^( 2) =       0.000551862336
  error estimate for blocks of size 2^( 3) =       0.000569916325
  error estimate for blocks of size 2^( 4) =       0.000582813566
  error estimate for blocks of size 2^( 5) =       0.000590835561
  error estimate for blocks of size 2^( 6) =       0.000595394115
  error estimate for blocks of size 2^( 7) =       0.000600664023

      target function =                  N/A
              le_mean =     -22.435872374884
             les_mean =     503.934403898892
             stat err =       0.000592426816
             autocorr =       1.240098430744
              std dev =       0.752352948982
             le_variance =       0.566034959843


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243587237488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435872374884       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435872374894       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435872374938       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435872374952       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435872374952       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435872374978       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435872374806       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435872374899       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435872374981       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435872374817       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+04 is 3.979905e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435872374884       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435872374886       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435872374897       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435872374901       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435872374904       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435872374988       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435872374910       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435872374781       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435872374762       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435872375652       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+05 is 9.949883e-10

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435872374884       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435872374884       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435872374887       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435872374888       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435872374904       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435872374863       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435872375706       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435872373765       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435872375187       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435872375288       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+05 is 2.487479e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0170e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074283e-03 1 1  ON 44
eH1_5                 4.174477e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894047e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.4333
    reference variance = 0.308083
====================================================
  Execution time = 4.4984e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6395e-01
  Total weights = 2.0000e+06
  Execution time = 3.8393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564093243182
                                         uncertainty =       0.004186330292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564093243182
                                         uncertainty =       0.004186330292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531014429
  error estimate for blocks of size 2^( 2) =       0.000551144905
  error estimate for blocks of size 2^( 3) =       0.000569754097
  error estimate for blocks of size 2^( 4) =       0.000584401135
  error estimate for blocks of size 2^( 5) =       0.000592432534
  error estimate for blocks of size 2^( 6) =       0.000595578168
  error estimate for blocks of size 2^( 7) =       0.000599647540

      target function =                  N/A
              le_mean =     -22.435984551921
             les_mean =     503.937355178719
             stat err =       0.000593014844
             autocorr =       1.247149411709
              std dev =       0.750967806677
             le_variance =       0.563952646665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564093242231
                                         uncertainty =       0.004186330239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564093242231
                                         uncertainty =       0.004186330239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531014428
  error estimate for blocks of size 2^( 2) =       0.000551144905
  error estimate for blocks of size 2^( 3) =       0.000569754096
  error estimate for blocks of size 2^( 4) =       0.000584401135
  error estimate for blocks of size 2^( 5) =       0.000592432534
  error estimate for blocks of size 2^( 6) =       0.000595578168
  error estimate for blocks of size 2^( 7) =       0.000599647540

      target function =                  N/A
              le_mean =     -22.435984551955
             les_mean =     503.937355179311
             stat err =       0.000593014844
             autocorr =       1.247149412790
              std dev =       0.750967806044
             le_variance =       0.563952645714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564093242706
                                         uncertainty =       0.004186330265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564093242706
                                         uncertainty =       0.004186330265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531014428
  error estimate for blocks of size 2^( 2) =       0.000551144905
  error estimate for blocks of size 2^( 3) =       0.000569754096
  error estimate for blocks of size 2^( 4) =       0.000584401135
  error estimate for blocks of size 2^( 5) =       0.000592432534
  error estimate for blocks of size 2^( 6) =       0.000595578168
  error estimate for blocks of size 2^( 7) =       0.000599647540

      target function =                  N/A
              le_mean =     -22.435984551938
             les_mean =     503.937355179015
             stat err =       0.000593014844
             autocorr =       1.247149412251
              std dev =       0.750967806360
             le_variance =       0.563952646189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564093243122
                                         uncertainty =       0.004186330288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564093243122
                                         uncertainty =       0.004186330288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531014429
  error estimate for blocks of size 2^( 2) =       0.000551144905
  error estimate for blocks of size 2^( 3) =       0.000569754097
  error estimate for blocks of size 2^( 4) =       0.000584401135
  error estimate for blocks of size 2^( 5) =       0.000592432534
  error estimate for blocks of size 2^( 6) =       0.000595578168
  error estimate for blocks of size 2^( 7) =       0.000599647540

      target function =                  N/A
              le_mean =     -22.435984551923
             les_mean =     503.937355178756
             stat err =       0.000593014844
             autocorr =       1.247149411777
              std dev =       0.750967806637
             le_variance =       0.563952646605


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435984551921        initial
     3.8147e+04     3.8147e+05             3.9799e-09       -22.435984551955  <--
     1.5259e+05     1.5259e+06             9.9499e-10       -22.435984551938
     6.1035e+05     6.1035e+06             2.4875e-10       -22.435984551923

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 6.4232e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074281e-03 1 1  ON 44
eH1_5                 4.174474e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2441e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2433e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.452
    reference variance = 1.43909
====================================================
  Execution time = 4.4857e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6087e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5258e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560924652306
                                         uncertainty =       0.007132694967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560924652306
                                         uncertainty =       0.007132694967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529559742
  error estimate for blocks of size 2^( 2) =       0.000549767462
  error estimate for blocks of size 2^( 3) =       0.000568333866
  error estimate for blocks of size 2^( 4) =       0.000581725205
  error estimate for blocks of size 2^( 5) =       0.000591065005
  error estimate for blocks of size 2^( 6) =       0.000594596955
  error estimate for blocks of size 2^( 7) =       0.000598336768

      target function =                  N/A
              le_mean =     -22.436559066033
             les_mean =     503.960049483080
             stat err =       0.000591430983
             autocorr =       1.247320962258
              std dev =       0.748910568724
             le_variance =       0.560867039946


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243655906603e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436559066033       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436559065972       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436559065997       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436559066032       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436559065971       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436559065939       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436559065888       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436559065888       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436559065873       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436559065889       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+03 is 2.873900e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436559066033       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436559066018       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436559066024       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436559066032       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436559066017       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436559065980       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436559065990       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436559065913       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436559065940       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436559065954       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+04 is 7.184959e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436559066033       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436559066029       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436559066030       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436559066033       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436559065952       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436559066031       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436559066059       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436559066093       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436559066167       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436559066191       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+05 is 1.796251e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259498 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0123e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074279e-03 1 1  ON 44
eH1_5                 4.174470e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5149
    reference variance = 0.634801
====================================================
  Execution time = 4.5813e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7035e-01
  Total weights = 2.0000e+06
  Execution time = 3.8424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570369188857
                                         uncertainty =       0.005662037865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570369188857
                                         uncertainty =       0.005662037865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534015935
  error estimate for blocks of size 2^( 2) =       0.000553970662
  error estimate for blocks of size 2^( 3) =       0.000571797854
  error estimate for blocks of size 2^( 4) =       0.000585337890
  error estimate for blocks of size 2^( 5) =       0.000595114146
  error estimate for blocks of size 2^( 6) =       0.000601541962
  error estimate for blocks of size 2^( 7) =       0.000605582019

      target function =                  N/A
              le_mean =     -22.437385291234
             les_mean =     504.006604460689
             stat err =       0.000596894004
             autocorr =       1.249355402393
              std dev =       0.755212578400
             le_variance =       0.570346038574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570369183936
                                         uncertainty =       0.005662037831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570369183936
                                         uncertainty =       0.005662037831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534015933
  error estimate for blocks of size 2^( 2) =       0.000553970660
  error estimate for blocks of size 2^( 3) =       0.000571797853
  error estimate for blocks of size 2^( 4) =       0.000585337888
  error estimate for blocks of size 2^( 5) =       0.000595114144
  error estimate for blocks of size 2^( 6) =       0.000601541960
  error estimate for blocks of size 2^( 7) =       0.000605582016

      target function =                  N/A
              le_mean =     -22.437385291063
             les_mean =     504.006604448088
             stat err =       0.000596894002
             autocorr =       1.249355403104
              std dev =       0.755212575147
             le_variance =       0.570346033660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570369186396
                                         uncertainty =       0.005662037848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570369186396
                                         uncertainty =       0.005662037848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534015934
  error estimate for blocks of size 2^( 2) =       0.000553970661
  error estimate for blocks of size 2^( 3) =       0.000571797853
  error estimate for blocks of size 2^( 4) =       0.000585337889
  error estimate for blocks of size 2^( 5) =       0.000595114145
  error estimate for blocks of size 2^( 6) =       0.000601541961
  error estimate for blocks of size 2^( 7) =       0.000605582017

      target function =                  N/A
              le_mean =     -22.437385291148
             les_mean =     504.006604454388
             stat err =       0.000596894003
             autocorr =       1.249355402743
              std dev =       0.755212576774
             le_variance =       0.570346036117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570369188550
                                         uncertainty =       0.005662037863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570369188550
                                         uncertainty =       0.005662037863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534015935
  error estimate for blocks of size 2^( 2) =       0.000553970661
  error estimate for blocks of size 2^( 3) =       0.000571797854
  error estimate for blocks of size 2^( 4) =       0.000585337890
  error estimate for blocks of size 2^( 5) =       0.000595114146
  error estimate for blocks of size 2^( 6) =       0.000601541962
  error estimate for blocks of size 2^( 7) =       0.000605582019

      target function =                  N/A
              le_mean =     -22.437385291223
             les_mean =     504.006604459901
             stat err =       0.000596894004
             autocorr =       1.249355402426
              std dev =       0.755212578197
             le_variance =       0.570346038267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437385291234        initial  <--
     9.5367e+03     9.5367e+04             2.8739e-08       -22.437385291063
     3.8147e+04     3.8147e+05             7.1850e-09       -22.437385291148
     1.5259e+05     1.5259e+06             1.7963e-09       -22.437385291223

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.7196
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074281e-03 1 1  ON 44
eH1_5                 4.174474e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2885e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2436e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.3984
    reference variance = 0.484474
====================================================
  Execution time = 4.5184e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5888e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5693e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558864450153
                                         uncertainty =       0.003733485418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558864450153
                                         uncertainty =       0.003733485418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528620098
  error estimate for blocks of size 2^( 2) =       0.000548733382
  error estimate for blocks of size 2^( 3) =       0.000567668930
  error estimate for blocks of size 2^( 4) =       0.000581466601
  error estimate for blocks of size 2^( 5) =       0.000590525857
  error estimate for blocks of size 2^( 6) =       0.000595136793
  error estimate for blocks of size 2^( 7) =       0.000596766299

      target function =                  N/A
              le_mean =     -22.437175843049
             les_mean =     503.985737948001
             stat err =       0.000590973888
             autocorr =       1.249825101137
              std dev =       0.747581711608
             le_variance =       0.558878415530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243717584305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437175843049       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437175843051       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437175843056       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437175843058       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437175843061       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437175843060       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437175843056       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437175843013       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437175842868       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+04 is 1.984286e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437175843049       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437175843050       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437175843051       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437175843017       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437175843155       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437175843141       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437175843300       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437175843122       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437175843062       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+05 is 4.960731e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437175843049       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437175843049       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437175843050       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437175843091       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437175842910       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437175843135       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437175843275       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437175843688       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437175844542       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+06 is 1.240185e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262576 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0884e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348173e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074281e-03 1 1  ON 44
eH1_5                 4.174474e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4509
    reference variance = 0.456957
====================================================
  Execution time = 4.4236e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7827e-01
  Total weights = 2.0000e+06
  Execution time = 3.8555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578434971872
                                         uncertainty =       0.015594858517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578434971872
                                         uncertainty =       0.015594858517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537712803
  error estimate for blocks of size 2^( 2) =       0.000557253833
  error estimate for blocks of size 2^( 3) =       0.000574645139
  error estimate for blocks of size 2^( 4) =       0.000587795377
  error estimate for blocks of size 2^( 5) =       0.000595903043
  error estimate for blocks of size 2^( 6) =       0.000600177768
  error estimate for blocks of size 2^( 7) =       0.000601482710

      target function =                  N/A
              le_mean =     -22.435918783738
             les_mean =     503.948721497319
             stat err =       0.000596339724
             autocorr =       1.229947933245
              std dev =       0.760440737965
             le_variance =       0.578270115957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578434970640
                                         uncertainty =       0.015594858440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578434970640
                                         uncertainty =       0.015594858440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537712802
  error estimate for blocks of size 2^( 2) =       0.000557253833
  error estimate for blocks of size 2^( 3) =       0.000574645139
  error estimate for blocks of size 2^( 4) =       0.000587795377
  error estimate for blocks of size 2^( 5) =       0.000595903042
  error estimate for blocks of size 2^( 6) =       0.000600177768
  error estimate for blocks of size 2^( 7) =       0.000601482709

      target function =                  N/A
              le_mean =     -22.435918783746
             les_mean =     503.948721496450
             stat err =       0.000596339724
             autocorr =       1.229947933875
              std dev =       0.760440737155
             le_variance =       0.578270114724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578434971256
                                         uncertainty =       0.015594858478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578434971256
                                         uncertainty =       0.015594858478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537712802
  error estimate for blocks of size 2^( 2) =       0.000557253833
  error estimate for blocks of size 2^( 3) =       0.000574645139
  error estimate for blocks of size 2^( 4) =       0.000587795377
  error estimate for blocks of size 2^( 5) =       0.000595903042
  error estimate for blocks of size 2^( 6) =       0.000600177768
  error estimate for blocks of size 2^( 7) =       0.000601482710

      target function =                  N/A
              le_mean =     -22.435918783742
             les_mean =     503.948721496885
             stat err =       0.000596339724
             autocorr =       1.229947933562
              std dev =       0.760440737560
             le_variance =       0.578270115341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578434971795
                                         uncertainty =       0.015594858512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578434971795
                                         uncertainty =       0.015594858512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537712802
  error estimate for blocks of size 2^( 2) =       0.000557253833
  error estimate for blocks of size 2^( 3) =       0.000574645139
  error estimate for blocks of size 2^( 4) =       0.000587795377
  error estimate for blocks of size 2^( 5) =       0.000595903043
  error estimate for blocks of size 2^( 6) =       0.000600177768
  error estimate for blocks of size 2^( 7) =       0.000601482710

      target function =                  N/A
              le_mean =     -22.435918783739
             les_mean =     503.948721497264
             stat err =       0.000596339724
             autocorr =       1.229947933283
              std dev =       0.760440737914
             le_variance =       0.578270115880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435918783738        initial
     9.5367e+04     9.5367e+05             1.9843e-09       -22.435918783746  <--
     3.8147e+05     3.8147e+06             4.9607e-10       -22.435918783742
     1.5259e+06     1.5259e+07             1.2402e-10       -22.435918783739

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 6.3549e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074281e-03 1 1  ON 44
eH1_5                 4.174473e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2444e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2435e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.5281
    reference variance = 0.372289
====================================================
  Execution time = 4.5448e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6666e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5051e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566700685786
                                         uncertainty =       0.006602500544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566700685786
                                         uncertainty =       0.006602500544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532287111
  error estimate for blocks of size 2^( 2) =       0.000551976440
  error estimate for blocks of size 2^( 3) =       0.000570777683
  error estimate for blocks of size 2^( 4) =       0.000585102928
  error estimate for blocks of size 2^( 5) =       0.000592680087
  error estimate for blocks of size 2^( 6) =       0.000597776308
  error estimate for blocks of size 2^( 7) =       0.000599910236

      target function =                  N/A
              le_mean =     -22.436417205294
             les_mean =     503.959475863914
             stat err =       0.000593867390
             autocorr =       1.244764104322
              std dev =       0.752767651548
             le_variance =       0.566659137217


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243641720529e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436417205294       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436417205310       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436417205347       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436417205379       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436417205357       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436417205381       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436417205354       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436417205448       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436417205451       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+04 is 8.133334e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436417205294       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436417205298       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436417205308       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436417205315       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436417205307       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436417205286       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436417205314       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436417205226       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436417205332       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+04 is 2.033341e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436417205294       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436417205295       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436417205298       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436417205300       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436417205285       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436417205440       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436417205161       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436417205289       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436417205527       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+05 is 5.083356e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0506e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074280e-03 1 1  ON 44
eH1_5                 4.174473e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.5116
    reference variance = 0.648078
====================================================
  Execution time = 4.4457e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7153e-01
  Total weights = 2.0000e+06
  Execution time = 3.8502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571391815170
                                         uncertainty =       0.007171783470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571391815170
                                         uncertainty =       0.007171783470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534569929
  error estimate for blocks of size 2^( 2) =       0.000555097743
  error estimate for blocks of size 2^( 3) =       0.000573208948
  error estimate for blocks of size 2^( 4) =       0.000588684205
  error estimate for blocks of size 2^( 5) =       0.000597673531
  error estimate for blocks of size 2^( 6) =       0.000601808304
  error estimate for blocks of size 2^( 7) =       0.000603261515

      target function =                  N/A
              le_mean =     -22.437546443496
             les_mean =     504.015020135223
             stat err =       0.000597856889
             autocorr =       1.250792954643
              std dev =       0.755996042953
             le_variance =       0.571530016961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571391808011
                                         uncertainty =       0.007171783357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571391808011
                                         uncertainty =       0.007171783357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534569925
  error estimate for blocks of size 2^( 2) =       0.000555097740
  error estimate for blocks of size 2^( 3) =       0.000573208946
  error estimate for blocks of size 2^( 4) =       0.000588684202
  error estimate for blocks of size 2^( 5) =       0.000597673529
  error estimate for blocks of size 2^( 6) =       0.000601808301
  error estimate for blocks of size 2^( 7) =       0.000603261512

      target function =                  N/A
              le_mean =     -22.437546443359
             les_mean =     504.015020121916
             stat err =       0.000597856886
             autocorr =       1.250792959640
              std dev =       0.755996038219
             le_variance =       0.571530009802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571391811590
                                         uncertainty =       0.007171783413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571391811590
                                         uncertainty =       0.007171783413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534569927
  error estimate for blocks of size 2^( 2) =       0.000555097741
  error estimate for blocks of size 2^( 3) =       0.000573208947
  error estimate for blocks of size 2^( 4) =       0.000588684203
  error estimate for blocks of size 2^( 5) =       0.000597673530
  error estimate for blocks of size 2^( 6) =       0.000601808303
  error estimate for blocks of size 2^( 7) =       0.000603261514

      target function =                  N/A
              le_mean =     -22.437546443427
             les_mean =     504.015020128569
             stat err =       0.000597856887
             autocorr =       1.250792957141
              std dev =       0.755996040586
             le_variance =       0.571530013382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571391814723
                                         uncertainty =       0.007171783463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571391814723
                                         uncertainty =       0.007171783463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534569928
  error estimate for blocks of size 2^( 2) =       0.000555097743
  error estimate for blocks of size 2^( 3) =       0.000573208948
  error estimate for blocks of size 2^( 4) =       0.000588684205
  error estimate for blocks of size 2^( 5) =       0.000597673531
  error estimate for blocks of size 2^( 6) =       0.000601808304
  error estimate for blocks of size 2^( 7) =       0.000603261515

      target function =                  N/A
              le_mean =     -22.437546443487
             les_mean =     504.015020134391
             stat err =       0.000597856888
             autocorr =       1.250792954955
              std dev =       0.755996042657
             le_variance =       0.571530016513


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437546443496        initial  <--
     2.3842e+04     2.3842e+05             8.1333e-09       -22.437546443359
     9.5367e+04     9.5367e+05             2.0333e-09       -22.437546443427
     3.8147e+05     3.8147e+06             5.0834e-10       -22.437546443487

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.7545
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074281e-03 1 1  ON 44
eH1_5                 4.174473e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2427e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.4204
    reference variance = 0.780834
====================================================
  Execution time = 4.7009e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7157e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5352e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571558130384
                                         uncertainty =       0.008354715341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571558130384
                                         uncertainty =       0.008354715341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534586547
  error estimate for blocks of size 2^( 2) =       0.000554450622
  error estimate for blocks of size 2^( 3) =       0.000572842342
  error estimate for blocks of size 2^( 4) =       0.000586427137
  error estimate for blocks of size 2^( 5) =       0.000594824197
  error estimate for blocks of size 2^( 6) =       0.000600840677
  error estimate for blocks of size 2^( 7) =       0.000603434678

      target function =                  N/A
              le_mean =     -22.437440123075
             les_mean =     504.010284542235
             stat err =       0.000596381672
             autocorr =       1.244550508752
              std dev =       0.756019544342
             le_variance =       0.571565551427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243744012308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437440123075       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437440123080       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437440123079       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437440123203       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437440123065       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437440123109       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437440123226       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437440123095       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437440122748       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437440123456       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+05 is 7.954888e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437440123075       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437440123076       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437440123076       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437440123076       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437440121918       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437440123461       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437440123381       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437440122484       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437440122182       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437440122701       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+05 is 1.988724e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437440123075       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437440123076       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437440123076       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437440122813       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437440124643       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437440122713       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437440121315       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437440123909       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437440122799       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437440133060       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+06 is 4.971844e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269226 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2369e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074280e-03 1 1  ON 44
eH1_5                 4.174473e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.4787
    reference variance = 0.324032
====================================================
  Execution time = 4.4227e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 6.0614e-01
  Total weights = 2.0000e+06
  Execution time = 3.8574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606328842429
                                         uncertainty =       0.025152713289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606328842429
                                         uncertainty =       0.025152713289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000550517021
  error estimate for blocks of size 2^( 2) =       0.000570294492
  error estimate for blocks of size 2^( 3) =       0.000587971518
  error estimate for blocks of size 2^( 4) =       0.000602155551
  error estimate for blocks of size 2^( 5) =       0.000611078928
  error estimate for blocks of size 2^( 6) =       0.000616658833
  error estimate for blocks of size 2^( 7) =       0.000620680203

      target function =                  N/A
              le_mean =     -22.437252153980
             les_mean =     504.036421897993
             stat err =       0.000612643379
             autocorr =       1.238437194457
              std dev =       0.778548636757
             le_variance =       0.606137979796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606328842923
                                         uncertainty =       0.025152713310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606328842923
                                         uncertainty =       0.025152713310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000550517021
  error estimate for blocks of size 2^( 2) =       0.000570294492
  error estimate for blocks of size 2^( 3) =       0.000587971518
  error estimate for blocks of size 2^( 4) =       0.000602155552
  error estimate for blocks of size 2^( 5) =       0.000611078928
  error estimate for blocks of size 2^( 6) =       0.000616658833
  error estimate for blocks of size 2^( 7) =       0.000620680204

      target function =                  N/A
              le_mean =     -22.437252153980
             les_mean =     504.036421898510
             stat err =       0.000612643379
             autocorr =       1.238437194242
              std dev =       0.778548637074
             le_variance =       0.606137980290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606328842676
                                         uncertainty =       0.025152713300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606328842676
                                         uncertainty =       0.025152713300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000550517021
  error estimate for blocks of size 2^( 2) =       0.000570294492
  error estimate for blocks of size 2^( 3) =       0.000587971518
  error estimate for blocks of size 2^( 4) =       0.000602155551
  error estimate for blocks of size 2^( 5) =       0.000611078928
  error estimate for blocks of size 2^( 6) =       0.000616658833
  error estimate for blocks of size 2^( 7) =       0.000620680204

      target function =                  N/A
              le_mean =     -22.437252153980
             les_mean =     504.036421898252
             stat err =       0.000612643379
             autocorr =       1.238437194351
              std dev =       0.778548636915
             le_variance =       0.606137980043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606328842460
                                         uncertainty =       0.025152713290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606328842460
                                         uncertainty =       0.025152713290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000550517021
  error estimate for blocks of size 2^( 2) =       0.000570294492
  error estimate for blocks of size 2^( 3) =       0.000587971518
  error estimate for blocks of size 2^( 4) =       0.000602155551
  error estimate for blocks of size 2^( 5) =       0.000611078928
  error estimate for blocks of size 2^( 6) =       0.000616658833
  error estimate for blocks of size 2^( 7) =       0.000620680204

      target function =                  N/A
              le_mean =     -22.437252153980
             les_mean =     504.036421898026
             stat err =       0.000612643379
             autocorr =       1.238437194444
              std dev =       0.778548636777
             le_variance =       0.606137979827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437252153980        initial
     2.3842e+05     2.3842e+06             7.9549e-10       -22.437252153980  <--
     9.5367e+05     9.5367e+06             1.9887e-10       -22.437252153980
     3.8147e+06     3.8147e+07             4.9718e-11       -22.437252153980

*****************************************************************************
Applying the update for shift_i =   2.3842e+05     and shift_s =   2.3842e+06
*****************************************************************************

  Execution time = 6.3534e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074280e-03 1 1  ON 44
eH1_5                 4.174473e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2591e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.389
    reference variance = 0.491112
====================================================
  Execution time = 4.5096e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6185e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5119e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561986330717
                                         uncertainty =       0.003712123560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561986330717
                                         uncertainty =       0.003712123560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530022798
  error estimate for blocks of size 2^( 2) =       0.000550416931
  error estimate for blocks of size 2^( 3) =       0.000569605657
  error estimate for blocks of size 2^( 4) =       0.000582748240
  error estimate for blocks of size 2^( 5) =       0.000589611083
  error estimate for blocks of size 2^( 6) =       0.000593699146
  error estimate for blocks of size 2^( 7) =       0.000594208876

      target function =                  N/A
              le_mean =     -22.437960127525
             les_mean =     504.023902737295
             stat err =       0.000590066836
             autocorr =       1.239405192489
              std dev =       0.749565429966
             le_variance =       0.561848333799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243796012753e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437960127525       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437960127524       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437960127542       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437960127546       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437960127550       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437960127553       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437960127597       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437960127577       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437960127497       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437960127591       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+04 is 3.502192e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437960127525       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437960127525       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437960127529       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437960127444       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437960127466       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437960127533       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437960127595       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437960127855       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437960127518       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437960127912       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+05 is 8.755493e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437960127525       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437960127525       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437960127526       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437960127527       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437960128195       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437960127522       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437960127921       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437960127857       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437960128099       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437960129798       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+05 is 2.188868e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0222e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074279e-03 1 1  ON 44
eH1_5                 4.174474e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.4698
    reference variance = 0.441881
====================================================
  Execution time = 4.4975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6329e-01
  Total weights = 2.0000e+06
  Execution time = 3.8595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563336513649
                                         uncertainty =       0.004528831242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563336513649
                                         uncertainty =       0.004528831242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530701828
  error estimate for blocks of size 2^( 2) =       0.000550985596
  error estimate for blocks of size 2^( 3) =       0.000569677409
  error estimate for blocks of size 2^( 4) =       0.000583287223
  error estimate for blocks of size 2^( 5) =       0.000593577014
  error estimate for blocks of size 2^( 6) =       0.000600181507
  error estimate for blocks of size 2^( 7) =       0.000604087432

      target function =                  N/A
              le_mean =     -22.436719265490
             les_mean =     503.969659977933
             stat err =       0.000595283294
             autocorr =       1.258189979617
              std dev =       0.750525723200
             le_variance =       0.563288861184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563336509257
                                         uncertainty =       0.004528831175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563336509257
                                         uncertainty =       0.004528831175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530701826
  error estimate for blocks of size 2^( 2) =       0.000550985594
  error estimate for blocks of size 2^( 3) =       0.000569677407
  error estimate for blocks of size 2^( 4) =       0.000583287221
  error estimate for blocks of size 2^( 5) =       0.000593577013
  error estimate for blocks of size 2^( 6) =       0.000600181506
  error estimate for blocks of size 2^( 7) =       0.000604087431

      target function =                  N/A
              le_mean =     -22.436719265504
             les_mean =     503.969659974199
             stat err =       0.000595283293
             autocorr =       1.258189982741
              std dev =       0.750525720273
             le_variance =       0.563288856792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563336511453
                                         uncertainty =       0.004528831209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563336511453
                                         uncertainty =       0.004528831209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530701827
  error estimate for blocks of size 2^( 2) =       0.000550985595
  error estimate for blocks of size 2^( 3) =       0.000569677408
  error estimate for blocks of size 2^( 4) =       0.000583287222
  error estimate for blocks of size 2^( 5) =       0.000593577013
  error estimate for blocks of size 2^( 6) =       0.000600181507
  error estimate for blocks of size 2^( 7) =       0.000604087432

      target function =                  N/A
              le_mean =     -22.436719265497
             les_mean =     503.969659976066
             stat err =       0.000595283293
             autocorr =       1.258189981181
              std dev =       0.750525721736
             le_variance =       0.563288858988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563336513375
                                         uncertainty =       0.004528831238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563336513375
                                         uncertainty =       0.004528831238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530701828
  error estimate for blocks of size 2^( 2) =       0.000550985596
  error estimate for blocks of size 2^( 3) =       0.000569677409
  error estimate for blocks of size 2^( 4) =       0.000583287223
  error estimate for blocks of size 2^( 5) =       0.000593577014
  error estimate for blocks of size 2^( 6) =       0.000600181507
  error estimate for blocks of size 2^( 7) =       0.000604087432

      target function =                  N/A
              le_mean =     -22.436719265491
             les_mean =     503.969659977700
             stat err =       0.000595283294
             autocorr =       1.258189979812
              std dev =       0.750525723017
             le_variance =       0.563288860910


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436719265490        initial
     5.9605e+04     5.9605e+05             3.5022e-09       -22.436719265504  <--
     2.3842e+05     2.3842e+06             8.7555e-10       -22.436719265497
     9.5367e+05     9.5367e+06             2.1889e-10       -22.436719265491

*****************************************************************************
Applying the update for shift_i =   5.9605e+04     and shift_s =   5.9605e+05
*****************************************************************************

  Execution time = 6.4302e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074278e-03 1 1  ON 44
eH1_5                 4.174475e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2453e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.3499
    reference variance = 0.489526
====================================================
  Execution time = 4.5513e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5809e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5510e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557527802339
                                         uncertainty =       0.004003200716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557527802339
                                         uncertainty =       0.004003200716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528244901
  error estimate for blocks of size 2^( 2) =       0.000547852770
  error estimate for blocks of size 2^( 3) =       0.000566049332
  error estimate for blocks of size 2^( 4) =       0.000579719052
  error estimate for blocks of size 2^( 5) =       0.000588648862
  error estimate for blocks of size 2^( 6) =       0.000592612239
  error estimate for blocks of size 2^( 7) =       0.000595493700

      target function =                  N/A
              le_mean =     -22.437919787079
             les_mean =     504.018329442686
             stat err =       0.000589118463
             autocorr =       1.243754430715
              std dev =       0.747051102901
             le_variance =       0.558085350345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243791978708e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437919787079       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437919787069       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437919787065       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437919787073       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437919787123       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437919787122       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437919787138       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437919787113       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437919787135       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+04 is 1.159210e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437919787079       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437919787076       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437919787075       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437919787066       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437919787096       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437919787050       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437919787106       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437919786969       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437919787216       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+04 is 2.898071e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437919787079       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437919787078       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437919787078       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437919787079       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437919787210       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437919787113       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437919787066       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437919787063       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437919787242       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+05 is 7.245209e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1030e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852910e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200632e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074278e-03 1 1  ON 44
eH1_5                 4.174474e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778751e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.4178
    reference variance = 0.341732
====================================================
  Execution time = 4.6248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7002e-01
  Total weights = 2.0000e+06
  Execution time = 3.8552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570093364464
                                         uncertainty =       0.006867800420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570093364464
                                         uncertainty =       0.006867800420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533862595
  error estimate for blocks of size 2^( 2) =       0.000554078689
  error estimate for blocks of size 2^( 3) =       0.000572829105
  error estimate for blocks of size 2^( 4) =       0.000586100608
  error estimate for blocks of size 2^( 5) =       0.000595176785
  error estimate for blocks of size 2^( 6) =       0.000600620589
  error estimate for blocks of size 2^( 7) =       0.000602546889

      target function =                  N/A
              le_mean =     -22.436727389898
             les_mean =     503.976754224256
             stat err =       0.000596111218
             autocorr =       1.246796580981
              std dev =       0.754995722280
             le_variance =       0.570018540661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570093363618
                                         uncertainty =       0.006867800283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570093363618
                                         uncertainty =       0.006867800283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533862595
  error estimate for blocks of size 2^( 2) =       0.000554078689
  error estimate for blocks of size 2^( 3) =       0.000572829105
  error estimate for blocks of size 2^( 4) =       0.000586100608
  error estimate for blocks of size 2^( 5) =       0.000595176785
  error estimate for blocks of size 2^( 6) =       0.000600620589
  error estimate for blocks of size 2^( 7) =       0.000602546888

      target function =                  N/A
              le_mean =     -22.436727389853
             les_mean =     503.976754221384
             stat err =       0.000596111217
             autocorr =       1.246796581522
              std dev =       0.754995721718
             le_variance =       0.570018539813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570093364041
                                         uncertainty =       0.006867800351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570093364041
                                         uncertainty =       0.006867800351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533862595
  error estimate for blocks of size 2^( 2) =       0.000554078689
  error estimate for blocks of size 2^( 3) =       0.000572829105
  error estimate for blocks of size 2^( 4) =       0.000586100608
  error estimate for blocks of size 2^( 5) =       0.000595176785
  error estimate for blocks of size 2^( 6) =       0.000600620589
  error estimate for blocks of size 2^( 7) =       0.000602546888

      target function =                  N/A
              le_mean =     -22.436727389876
             les_mean =     503.976754222820
             stat err =       0.000596111217
             autocorr =       1.246796581256
              std dev =       0.754995721999
             le_variance =       0.570018540237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570093364411
                                         uncertainty =       0.006867800412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570093364411
                                         uncertainty =       0.006867800412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533862595
  error estimate for blocks of size 2^( 2) =       0.000554078689
  error estimate for blocks of size 2^( 3) =       0.000572829105
  error estimate for blocks of size 2^( 4) =       0.000586100608
  error estimate for blocks of size 2^( 5) =       0.000595176785
  error estimate for blocks of size 2^( 6) =       0.000600620589
  error estimate for blocks of size 2^( 7) =       0.000602546889

      target function =                  N/A
              le_mean =     -22.436727389895
             les_mean =     503.976754224076
             stat err =       0.000596111218
             autocorr =       1.246796581018
              std dev =       0.754995722245
             le_variance =       0.570018540608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436727389898        initial  <--
     1.4901e+04     1.4901e+05             1.1592e-08       -22.436727389853
     5.9605e+04     5.9605e+05             2.8981e-09       -22.436727389876
     2.3842e+05     2.3842e+06             7.2452e-10       -22.436727389895

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.5622
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074278e-03 1 1  ON 44
eH1_5                 4.174475e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2660e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2437e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.5495
    reference variance = 0.797412
====================================================
  Execution time = 4.4848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6144e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5164e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561421401127
                                         uncertainty =       0.004146498627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561421401127
                                         uncertainty =       0.004146498627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529829102
  error estimate for blocks of size 2^( 2) =       0.000549742826
  error estimate for blocks of size 2^( 3) =       0.000567795985
  error estimate for blocks of size 2^( 4) =       0.000581923253
  error estimate for blocks of size 2^( 5) =       0.000590330435
  error estimate for blocks of size 2^( 6) =       0.000592681868
  error estimate for blocks of size 2^( 7) =       0.000596678985

      target function =                  N/A
              le_mean =     -22.436718841087
             les_mean =     503.967789826871
             stat err =       0.000590403635
             autocorr =       1.241727869173
              std dev =       0.749291501095
             le_variance =       0.561437753612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243671884109e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436718841087       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436718841088       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436718841088       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436718841089       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436718840947       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436718840976       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436718841135       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436718841088       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436718841015       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436718841404       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+05 is 1.280715e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436718841087       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436718841087       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436718841087       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436718841153       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436718841137       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436718841420       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436718840664       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436718842938       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436718840830       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436718840230       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+05 is 3.201816e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436718841087       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436718841087       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436718841087       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436718841467       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436718841387       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436718840059       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436718840623       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436718840153       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436718841039       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436718837520       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+06 is 8.004410e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0019e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074278e-03 1 1  ON 44
eH1_5                 4.174474e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.4894
    reference variance = 0.575427
====================================================
  Execution time = 4.4351e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5730e-01
  Total weights = 2.0000e+06
  Execution time = 3.8432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557459888465
                                         uncertainty =       0.003255659563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557459888465
                                         uncertainty =       0.003255659563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527873810
  error estimate for blocks of size 2^( 2) =       0.000548241943
  error estimate for blocks of size 2^( 3) =       0.000567313978
  error estimate for blocks of size 2^( 4) =       0.000580285968
  error estimate for blocks of size 2^( 5) =       0.000590393909
  error estimate for blocks of size 2^( 6) =       0.000594163022
  error estimate for blocks of size 2^( 7) =       0.000597231154

      target function =                  N/A
              le_mean =     -22.436862200852
             les_mean =     503.970086659057
             stat err =       0.000590518513
             autocorr =       1.251430701149
              std dev =       0.746526300727
             le_variance =       0.557301517678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557459888623
                                         uncertainty =       0.003255659565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557459888623
                                         uncertainty =       0.003255659565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527873810
  error estimate for blocks of size 2^( 2) =       0.000548241943
  error estimate for blocks of size 2^( 3) =       0.000567313978
  error estimate for blocks of size 2^( 4) =       0.000580285968
  error estimate for blocks of size 2^( 5) =       0.000590393910
  error estimate for blocks of size 2^( 6) =       0.000594163022
  error estimate for blocks of size 2^( 7) =       0.000597231154

      target function =                  N/A
              le_mean =     -22.436862200854
             les_mean =     503.970086659295
             stat err =       0.000590518513
             autocorr =       1.251430701138
              std dev =       0.746526300833
             le_variance =       0.557301517836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557459888544
                                         uncertainty =       0.003255659564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557459888544
                                         uncertainty =       0.003255659564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527873810
  error estimate for blocks of size 2^( 2) =       0.000548241943
  error estimate for blocks of size 2^( 3) =       0.000567313978
  error estimate for blocks of size 2^( 4) =       0.000580285968
  error estimate for blocks of size 2^( 5) =       0.000590393909
  error estimate for blocks of size 2^( 6) =       0.000594163022
  error estimate for blocks of size 2^( 7) =       0.000597231154

      target function =                  N/A
              le_mean =     -22.436862200853
             les_mean =     503.970086659176
             stat err =       0.000590518513
             autocorr =       1.251430701143
              std dev =       0.746526300780
             le_variance =       0.557301517757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557459888475
                                         uncertainty =       0.003255659564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557459888475
                                         uncertainty =       0.003255659564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527873810
  error estimate for blocks of size 2^( 2) =       0.000548241943
  error estimate for blocks of size 2^( 3) =       0.000567313978
  error estimate for blocks of size 2^( 4) =       0.000580285968
  error estimate for blocks of size 2^( 5) =       0.000590393909
  error estimate for blocks of size 2^( 6) =       0.000594163022
  error estimate for blocks of size 2^( 7) =       0.000597231154

      target function =                  N/A
              le_mean =     -22.436862200852
             les_mean =     503.970086659072
             stat err =       0.000590518513
             autocorr =       1.251430701151
              std dev =       0.746526300734
             le_variance =       0.557301517688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436862200852        initial
     1.4901e+05     1.4901e+06             1.2807e-09       -22.436862200854  <--
     5.9605e+05     5.9605e+06             3.2018e-10       -22.436862200853
     2.3842e+06     2.3842e+07             8.0044e-11       -22.436862200852

*****************************************************************************
Applying the update for shift_i =   1.4901e+05     and shift_s =   1.4901e+06
*****************************************************************************

  Execution time = 6.3618e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110848e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074278e-03 1 1  ON 44
eH1_5                 4.174474e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778753e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2364e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.4397
    reference variance = 0.877884
====================================================
  Execution time = 4.4537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7888e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5452e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578917047016
                                         uncertainty =       0.010345757955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578917047016
                                         uncertainty =       0.010345757955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537995168
  error estimate for blocks of size 2^( 2) =       0.000558252709
  error estimate for blocks of size 2^( 3) =       0.000575987335
  error estimate for blocks of size 2^( 4) =       0.000589698152
  error estimate for blocks of size 2^( 5) =       0.000598311488
  error estimate for blocks of size 2^( 6) =       0.000602916269
  error estimate for blocks of size 2^( 7) =       0.000605367695

      target function =                  N/A
              le_mean =     -22.435640306603
             les_mean =     503.936833280371
             stat err =       0.000599073401
             autocorr =       1.239947575855
              std dev =       0.760840063703
             le_variance =       0.578877602535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243564030660e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435640306603       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435640306612       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435640306603       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435640306640       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435640306656       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435640306657       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435640306688       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435640306696       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435640306615       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435640306730       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+04 is 6.584353e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435640306603       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435640306605       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435640306603       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435640306611       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435640306618       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435640306470       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435640306716       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435640306681       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435640306244       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435640306455       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+05 is 1.646100e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435640306603       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435640306604       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435640306603       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435640306610       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435640306366       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435640306616       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435640306239       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435640306641       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435640306249       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435640308324       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+05 is 4.115266e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9997e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852909e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200631e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074277e-03 1 1  ON 44
eH1_5                 4.174474e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710344e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287821e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.4533
    reference variance = 0.464602
====================================================
  Execution time = 4.4426e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6375e-01
  Total weights = 2.0000e+06
  Execution time = 4.1650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563875455577
                                         uncertainty =       0.003857628665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563875455577
                                         uncertainty =       0.003857628665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530921263
  error estimate for blocks of size 2^( 2) =       0.000550779566
  error estimate for blocks of size 2^( 3) =       0.000569286166
  error estimate for blocks of size 2^( 4) =       0.000582626193
  error estimate for blocks of size 2^( 5) =       0.000591503996
  error estimate for blocks of size 2^( 6) =       0.000595720368
  error estimate for blocks of size 2^( 7) =       0.000599041487

      target function =                  N/A
              le_mean =     -22.437069678570
             les_mean =     503.985850255162
             stat err =       0.000592223011
             autocorr =       1.244257642864
              std dev =       0.750836051380
             le_variance =       0.563754776052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563875453936
                                         uncertainty =       0.003857628618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563875453936
                                         uncertainty =       0.003857628618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530921263
  error estimate for blocks of size 2^( 2) =       0.000550779566
  error estimate for blocks of size 2^( 3) =       0.000569286165
  error estimate for blocks of size 2^( 4) =       0.000582626192
  error estimate for blocks of size 2^( 5) =       0.000591503995
  error estimate for blocks of size 2^( 6) =       0.000595720367
  error estimate for blocks of size 2^( 7) =       0.000599041486

      target function =                  N/A
              le_mean =     -22.437069678585
             les_mean =     503.985850254212
             stat err =       0.000592223010
             autocorr =       1.244257643839
              std dev =       0.750836050289
             le_variance =       0.563754774413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563875454756
                                         uncertainty =       0.003857628642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563875454756
                                         uncertainty =       0.003857628642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530921263
  error estimate for blocks of size 2^( 2) =       0.000550779566
  error estimate for blocks of size 2^( 3) =       0.000569286166
  error estimate for blocks of size 2^( 4) =       0.000582626192
  error estimate for blocks of size 2^( 5) =       0.000591503996
  error estimate for blocks of size 2^( 6) =       0.000595720367
  error estimate for blocks of size 2^( 7) =       0.000599041486

      target function =                  N/A
              le_mean =     -22.437069678577
             les_mean =     503.985850254687
             stat err =       0.000592223010
             autocorr =       1.244257643352
              std dev =       0.750836050834
             le_variance =       0.563754775232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563875455475
                                         uncertainty =       0.003857628663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563875455475
                                         uncertainty =       0.003857628663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530921263
  error estimate for blocks of size 2^( 2) =       0.000550779566
  error estimate for blocks of size 2^( 3) =       0.000569286166
  error estimate for blocks of size 2^( 4) =       0.000582626192
  error estimate for blocks of size 2^( 5) =       0.000591503996
  error estimate for blocks of size 2^( 6) =       0.000595720368
  error estimate for blocks of size 2^( 7) =       0.000599041487

      target function =                  N/A
              le_mean =     -22.437069678571
             les_mean =     503.985850255103
             stat err =       0.000592223011
             autocorr =       1.244257642924
              std dev =       0.750836051312
             le_variance =       0.563754775949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437069678570        initial
     3.7253e+04     3.7253e+05             6.5844e-09       -22.437069678585  <--
     1.4901e+05     1.4901e+06             1.6461e-09       -22.437069678577
     5.9605e+05     5.9605e+06             4.1153e-10       -22.437069678571

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 6.4239e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852910e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841859e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200632e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201352e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182542e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074274e-03 1 1  ON 44
eH1_5                 4.174473e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710345e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300078e-02 1 1  ON 54
eH2_5                -2.778749e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287820e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2424e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.3827
    reference variance = 0.308872
====================================================
  Execution time = 4.6694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6190e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5279e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561897728390
                                         uncertainty =       0.003708982366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561897728390
                                         uncertainty =       0.003708982366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530046452
  error estimate for blocks of size 2^( 2) =       0.000550079572
  error estimate for blocks of size 2^( 3) =       0.000569209214
  error estimate for blocks of size 2^( 4) =       0.000582351776
  error estimate for blocks of size 2^( 5) =       0.000590978667
  error estimate for blocks of size 2^( 6) =       0.000597599970
  error estimate for blocks of size 2^( 7) =       0.000598198032

      target function =                  N/A
              le_mean =     -22.436474004900
             les_mean =     503.957263973966
             stat err =       0.000592282111
             autocorr =       1.248617357813
              std dev =       0.749598880984
             le_variance =       0.561898482373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243647400490e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436474004900       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436474004918       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436474004893       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436474004960       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436474004984       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436474004999       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436474004972       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436474004952       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436474004983       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436474004981       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+03 is 2.340205e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436474004900       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436474004904       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436474004898       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436474004914       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436474004920       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436474004944       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436474004902       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436474004885       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436474004898       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436474004911       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+04 is 5.850569e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436474004900       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436474004901       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436474004899       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436474004903       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436474004836       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436474004807       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436474004765       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436474004893       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436474004311       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436474005216       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+05 is 1.462645e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286747 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1981e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852910e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200632e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201351e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182543e-02 1 1  ON 42
eH1_3                -4.203416e-02 1 1  ON 43
eH1_4                -6.074273e-03 1 1  ON 44
eH1_5                 4.174469e-03 1 1  ON 45
eH1_6                 3.504560e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710345e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300077e-02 1 1  ON 54
eH2_5                -2.778752e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287820e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.5772
    reference variance = 0.707736
====================================================
  Execution time = 4.3787e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.7239e-01
  Total weights = 2.0000e+06
  Execution time = 3.8566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572482241325
                                         uncertainty =       0.009399628818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572482241325
                                         uncertainty =       0.009399628818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534973221
  error estimate for blocks of size 2^( 2) =       0.000555345747
  error estimate for blocks of size 2^( 3) =       0.000573791328
  error estimate for blocks of size 2^( 4) =       0.000587926196
  error estimate for blocks of size 2^( 5) =       0.000597134714
  error estimate for blocks of size 2^( 6) =       0.000601702767
  error estimate for blocks of size 2^( 7) =       0.000604096954

      target function =                  N/A
              le_mean =     -22.436769361416
             les_mean =     503.981011784689
             stat err =       0.000597715158
             autocorr =       1.248315759169
              std dev =       0.756566384077
             le_variance =       0.572392693515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572482214220
                                         uncertainty =       0.009399627760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572482214220
                                         uncertainty =       0.009399627760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534973208
  error estimate for blocks of size 2^( 2) =       0.000555345735
  error estimate for blocks of size 2^( 3) =       0.000573791317
  error estimate for blocks of size 2^( 4) =       0.000587926185
  error estimate for blocks of size 2^( 5) =       0.000597134703
  error estimate for blocks of size 2^( 6) =       0.000601702757
  error estimate for blocks of size 2^( 7) =       0.000604096944

      target function =                  N/A
              le_mean =     -22.436769361441
             les_mean =     503.981011758695
             stat err =       0.000597715147
             autocorr =       1.248315773765
              std dev =       0.756566366167
             le_variance =       0.572392666415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572482227772
                                         uncertainty =       0.009399628289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572482227772
                                         uncertainty =       0.009399628289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534973214
  error estimate for blocks of size 2^( 2) =       0.000555345741
  error estimate for blocks of size 2^( 3) =       0.000573791323
  error estimate for blocks of size 2^( 4) =       0.000587926190
  error estimate for blocks of size 2^( 5) =       0.000597134708
  error estimate for blocks of size 2^( 6) =       0.000601702762
  error estimate for blocks of size 2^( 7) =       0.000604096949

      target function =                  N/A
              le_mean =     -22.436769361428
             les_mean =     503.981011771691
             stat err =       0.000597715152
             autocorr =       1.248315766472
              std dev =       0.756566375121
             le_variance =       0.572392679964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572482239631
                                         uncertainty =       0.009399628752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572482239631
                                         uncertainty =       0.009399628752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534973220
  error estimate for blocks of size 2^( 2) =       0.000555345746
  error estimate for blocks of size 2^( 3) =       0.000573791328
  error estimate for blocks of size 2^( 4) =       0.000587926195
  error estimate for blocks of size 2^( 5) =       0.000597134713
  error estimate for blocks of size 2^( 6) =       0.000601702766
  error estimate for blocks of size 2^( 7) =       0.000604096954

      target function =                  N/A
              le_mean =     -22.436769361417
             les_mean =     503.981011783064
             stat err =       0.000597715157
             autocorr =       1.248315760083
              std dev =       0.756566382958
             le_variance =       0.572392691821


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436769361416        initial
     9.3132e+03     9.3132e+04             2.3402e-08       -22.436769361441  <--
     3.7253e+04     3.7253e+05             5.8506e-09       -22.436769361428
     1.4901e+05     1.4901e+06             1.4626e-09       -22.436769361417

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 6.3126e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852910e-02 1 1  ON 1
 uu_2                -2.782802e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800056e-01 1 1  ON 6
 uu_7                -1.821294e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200634e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035054e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945152e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211215e-02 1 1  ON 23
 eC_4                 1.597215e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868604e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201350e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182543e-02 1 1  ON 42
eH1_3                -4.203415e-02 1 1  ON 43
eH1_4                -6.074268e-03 1 1  ON 44
eH1_5                 4.174458e-03 1 1  ON 45
eH1_6                 3.504559e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710346e-02 1 1  ON 51
eH2_2                -4.841763e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.300076e-02 1 1  ON 54
eH2_5                -2.778762e-03 1 1  ON 55
eH2_6                 2.824420e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793163e-02 1 1  ON 58
eH2_9                 9.287820e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2512e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.3878
    reference variance = 0.737326
====================================================
  Execution time = 4.4876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6221e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5220e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562141026851
                                         uncertainty =       0.005181290416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562141026851
                                         uncertainty =       0.005181290416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530194425
  error estimate for blocks of size 2^( 2) =       0.000550273505
  error estimate for blocks of size 2^( 3) =       0.000568846999
  error estimate for blocks of size 2^( 4) =       0.000583240391
  error estimate for blocks of size 2^( 5) =       0.000591339913
  error estimate for blocks of size 2^( 6) =       0.000596680083
  error estimate for blocks of size 2^( 7) =       0.000597853547

      target function =                  N/A
              le_mean =     -22.436257198095
             les_mean =     503.947849034333
             stat err =       0.000592278484
             autocorr =       1.247905211234
              std dev =       0.749808146375
             le_variance =       0.562212256370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243625719809e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436257198095       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436257198117       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436257198307       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436257198196       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436257198372       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436257198411       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436257198393       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436257198365       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436257198328       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436257198347       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+03 is 9.046640e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436257198095       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436257198101       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436257198148       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436257198119       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436257198157       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436257198175       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436257198166       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436257198177       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436257198154       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436257198175       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+03 is 2.261912e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436257198095       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436257198096       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436257198108       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436257198107       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436257198111       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436257198087       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436257198118       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436257198112       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436257198102       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436257198155       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+04 is 5.654937e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290335 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0104e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852912e-02 1 1  ON 1
 uu_2                -2.782803e-02 1 1  ON 2
 uu_3                -9.841860e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800056e-01 1 1  ON 6
 uu_7                -1.821293e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200635e-02 1 1  ON 12
 ud_3                -5.294838e-02 1 1  ON 13
 ud_4                -1.035053e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945153e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211214e-02 1 1  ON 23
 eC_4                 1.597216e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666393e-01 1 1  ON 28
 eC_9                 6.868605e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348174e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201351e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033823e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110847e-02 1 1  ON 41
eH1_2                -4.182545e-02 1 1  ON 42
eH1_3                -4.203414e-02 1 1  ON 43
eH1_4                -6.074249e-03 1 1  ON 44
eH1_5                 4.174443e-03 1 1  ON 45
eH1_6                 3.504559e-02 1 1  ON 46
eH1_7                 4.295010e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840523e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710349e-02 1 1  ON 51
eH2_2                -4.841764e-02 1 1  ON 52
eH2_3                -4.863744e-02 1 1  ON 53
eH2_4                -1.300076e-02 1 1  ON 54
eH2_5                -2.778750e-03 1 1  ON 55
eH2_6                 2.824421e-02 1 1  ON 56
eH2_7                 3.894046e-02 1 1  ON 57
eH2_8                 2.793164e-02 1 1  ON 58
eH2_9                 9.287820e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.3986
    reference variance = 0.581873
====================================================
  Execution time = 4.4128e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.7942e-01
  Total weights = 2.0000e+06
  Execution time = 3.8539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579420200393
                                         uncertainty =       0.016412205721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579420200393
                                         uncertainty =       0.016412205721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538245905
  error estimate for blocks of size 2^( 2) =       0.000558121876
  error estimate for blocks of size 2^( 3) =       0.000576486835
  error estimate for blocks of size 2^( 4) =       0.000589585343
  error estimate for blocks of size 2^( 5) =       0.000597875744
  error estimate for blocks of size 2^( 6) =       0.000600989819
  error estimate for blocks of size 2^( 7) =       0.000603128586

      target function =                  N/A
              le_mean =     -22.437633853843
             les_mean =     504.026829977507
             stat err =       0.000597894873
             autocorr =       1.233923370131
              std dev =       0.761194658485
             le_variance =       0.579417308105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579420207780
                                         uncertainty =       0.016412205801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579420207780
                                         uncertainty =       0.016412205801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538245908
  error estimate for blocks of size 2^( 2) =       0.000558121880
  error estimate for blocks of size 2^( 3) =       0.000576486840
  error estimate for blocks of size 2^( 4) =       0.000589585348
  error estimate for blocks of size 2^( 5) =       0.000597875750
  error estimate for blocks of size 2^( 6) =       0.000600989826
  error estimate for blocks of size 2^( 7) =       0.000603128597

      target function =                  N/A
              le_mean =     -22.437633853967
             les_mean =     504.026829990444
             stat err =       0.000597894880
             autocorr =       1.233923385214
              std dev =       0.761194663313
             le_variance =       0.579417315457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579420204087
                                         uncertainty =       0.016412205761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579420204087
                                         uncertainty =       0.016412205761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538245907
  error estimate for blocks of size 2^( 2) =       0.000558121878
  error estimate for blocks of size 2^( 3) =       0.000576486838
  error estimate for blocks of size 2^( 4) =       0.000589585345
  error estimate for blocks of size 2^( 5) =       0.000597875747
  error estimate for blocks of size 2^( 6) =       0.000600989822
  error estimate for blocks of size 2^( 7) =       0.000603128591

      target function =                  N/A
              le_mean =     -22.437633853905
             les_mean =     504.026829983975
             stat err =       0.000597894876
             autocorr =       1.233923377671
              std dev =       0.761194660899
             le_variance =       0.579417311782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579420200855
                                         uncertainty =       0.016412205726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579420200855
                                         uncertainty =       0.016412205726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538245905
  error estimate for blocks of size 2^( 2) =       0.000558121876
  error estimate for blocks of size 2^( 3) =       0.000576486836
  error estimate for blocks of size 2^( 4) =       0.000589585343
  error estimate for blocks of size 2^( 5) =       0.000597875744
  error estimate for blocks of size 2^( 6) =       0.000600989819
  error estimate for blocks of size 2^( 7) =       0.000603128586

      target function =                  N/A
              le_mean =     -22.437633853851
             les_mean =     504.026829978316
             stat err =       0.000597894873
             autocorr =       1.233923371069
              std dev =       0.761194658786
             le_variance =       0.579417308565


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437633853843        initial
     2.3283e+03     2.3283e+04             9.0466e-08       -22.437633853967  <--
     9.3132e+03     9.3132e+04             2.2619e-08       -22.437633853905
     3.7253e+04     3.7253e+05             5.6549e-09       -22.437633853851

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 6.3467e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.641302e-01 1 1  ON 0
 uu_1                 8.852918e-02 1 1  ON 1
 uu_2                -2.782805e-02 1 1  ON 2
 uu_3                -9.841859e-02 1 1  ON 3
 uu_4                -1.404271e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800056e-01 1 1  ON 6
 uu_7                -1.821293e-01 1 1  ON 7
 uu_8                -1.681298e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672523e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200637e-02 1 1  ON 12
 ud_3                -5.294836e-02 1 1  ON 13
 ud_4                -1.035053e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625729e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945153e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124612e-01 1 1  ON 22
 eC_3                 1.211212e-02 1 1  ON 23
 eC_4                 1.597216e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666394e-01 1 1  ON 28
 eC_9                 6.868606e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348175e-01 1 1  ON 31
 eO_2                -3.452084e-01 1 1  ON 32
 eO_3                -2.201353e-02 1 1  ON 33
 eO_4                 2.025339e-01 1 1  ON 34
 eO_5                 3.449474e-01 1 1  ON 35
 eO_6                 3.881445e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033824e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110850e-02 1 1  ON 41
eH1_2                -4.182549e-02 1 1  ON 42
eH1_3                -4.203410e-02 1 1  ON 43
eH1_4                -6.074193e-03 1 1  ON 44
eH1_5                 4.174398e-03 1 1  ON 45
eH1_6                 3.504559e-02 1 1  ON 46
eH1_7                 4.295009e-02 1 1  ON 47
eH1_8                 3.258427e-02 1 1  ON 48
eH1_9                 7.840522e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710355e-02 1 1  ON 51
eH2_2                -4.841766e-02 1 1  ON 52
eH2_3                -4.863745e-02 1 1  ON 53
eH2_4                -1.300073e-02 1 1  ON 54
eH2_5                -2.778714e-03 1 1  ON 55
eH2_6                 2.824422e-02 1 1  ON 56
eH2_7                 3.894045e-02 1 1  ON 57
eH2_8                 2.793165e-02 1 1  ON 58
eH2_9                 9.287819e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2358e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2440e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.4204
    reference variance = 0.555631
====================================================
  Execution time = 4.6749e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.5392e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5173e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553687081369
                                         uncertainty =       0.003318473020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553687081369
                                         uncertainty =       0.003318473020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526268765
  error estimate for blocks of size 2^( 2) =       0.000546298610
  error estimate for blocks of size 2^( 3) =       0.000564706598
  error estimate for blocks of size 2^( 4) =       0.000578392493
  error estimate for blocks of size 2^( 5) =       0.000586666660
  error estimate for blocks of size 2^( 6) =       0.000591931058
  error estimate for blocks of size 2^( 7) =       0.000596329514

      target function =                  N/A
              le_mean =     -22.436398644517
             les_mean =     503.945901485483
             stat err =       0.000588329931
             autocorr =       1.249760221985
              std dev =       0.744256425395
             le_variance =       0.553917626742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243639864452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436398644517       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436398645497       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436398646607       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436398645663       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436398645619       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436398645980       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436398645427       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436398645693       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436398645680       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436398645710       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+02 is 4.570145e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436398644517       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436398644762       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436398645040       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436398644803       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436398644793       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436398644884       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436398644743       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436398644810       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436398644807       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436398644812       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+03 is 1.143266e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436398644517       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436398644579       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436398644648       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436398644588       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436398644588       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436398644609       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436398644579       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436398644567       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436398644631       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436398644559       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+03 is 2.858621e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1930e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.641303e-01 1 1  ON 0
 uu_1                 8.852917e-02 1 1  ON 1
 uu_2                -2.782809e-02 1 1  ON 2
 uu_3                -9.841864e-02 1 1  ON 3
 uu_4                -1.404271e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800056e-01 1 1  ON 6
 uu_7                -1.821292e-01 1 1  ON 7
 uu_8                -1.681298e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672524e-01 1 1  ON 10
 ud_1                 1.828483e-01 1 1  ON 11
 ud_2                 3.200642e-02 1 1  ON 12
 ud_3                -5.294837e-02 1 1  ON 13
 ud_4                -1.035053e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589789e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625730e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945153e-01 1 1  ON 20
 eC_1                -5.200222e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211207e-02 1 1  ON 23
 eC_4                 1.597216e-01 1 1  ON 24
 eC_5                 2.842267e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355160e-01 1 1  ON 27
 eC_8                 2.666394e-01 1 1  ON 28
 eC_9                 6.868607e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348176e-01 1 1  ON 31
 eO_2                -3.452083e-01 1 1  ON 32
 eO_3                -2.201344e-02 1 1  ON 33
 eO_4                 2.025338e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881445e-01 1 1  ON 36
 eO_7                 4.283242e-01 1 1  ON 37
 eO_8                 4.829831e-01 1 1  ON 38
 eO_9                 4.033824e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110850e-02 1 1  ON 41
eH1_2                -4.182549e-02 1 1  ON 42
eH1_3                -4.203409e-02 1 1  ON 43
eH1_4                -6.074141e-03 1 1  ON 44
eH1_5                 4.174326e-03 1 1  ON 45
eH1_6                 3.504555e-02 1 1  ON 46
eH1_7                 4.295014e-02 1 1  ON 47
eH1_8                 3.258430e-02 1 1  ON 48
eH1_9                 7.840522e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710357e-02 1 1  ON 51
eH2_2                -4.841767e-02 1 1  ON 52
eH2_3                -4.863747e-02 1 1  ON 53
eH2_4                -1.300066e-02 1 1  ON 54
eH2_5                -2.778701e-03 1 1  ON 55
eH2_6                 2.824425e-02 1 1  ON 56
eH2_7                 3.894040e-02 1 1  ON 57
eH2_8                 2.793162e-02 1 1  ON 58
eH2_9                 9.287817e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.4147
    reference variance = 0.539722
====================================================
  Execution time = 4.6138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6101e-01
  Total weights = 2.0000e+06
  Execution time = 3.8366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560985370086
                                         uncertainty =       0.003692187607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560985370086
                                         uncertainty =       0.003692187607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529626998
  error estimate for blocks of size 2^( 2) =       0.000549710192
  error estimate for blocks of size 2^( 3) =       0.000567907592
  error estimate for blocks of size 2^( 4) =       0.000581780145
  error estimate for blocks of size 2^( 5) =       0.000589138136
  error estimate for blocks of size 2^( 6) =       0.000595280211
  error estimate for blocks of size 2^( 7) =       0.000596280748

      target function =                  N/A
              le_mean =     -22.437529383762
             les_mean =     504.003734079990
             stat err =       0.000590619810
             autocorr =       1.243585899483
              std dev =       0.749005683085
             le_variance =       0.561009513294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560985860699
                                         uncertainty =       0.003692194153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560985860699
                                         uncertainty =       0.003692194153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529627230
  error estimate for blocks of size 2^( 2) =       0.000549710415
  error estimate for blocks of size 2^( 3) =       0.000567907804
  error estimate for blocks of size 2^( 4) =       0.000581780353
  error estimate for blocks of size 2^( 5) =       0.000589138344
  error estimate for blocks of size 2^( 6) =       0.000595280413
  error estimate for blocks of size 2^( 7) =       0.000596280954

      target function =                  N/A
              le_mean =     -22.437529385007
             les_mean =     504.003734627215
             stat err =       0.000590620016
             autocorr =       1.243585677419
              std dev =       0.749006011097
             le_variance =       0.561010004659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560985615500
                                         uncertainty =       0.003692190882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560985615500
                                         uncertainty =       0.003692190882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529627114
  error estimate for blocks of size 2^( 2) =       0.000549710303
  error estimate for blocks of size 2^( 3) =       0.000567907698
  error estimate for blocks of size 2^( 4) =       0.000581780249
  error estimate for blocks of size 2^( 5) =       0.000589138240
  error estimate for blocks of size 2^( 6) =       0.000595280312
  error estimate for blocks of size 2^( 7) =       0.000596280851

      target function =                  N/A
              le_mean =     -22.437529384384
             les_mean =     504.003734353690
             stat err =       0.000590619913
             autocorr =       1.243585788406
              std dev =       0.749005847163
             le_variance =       0.561009759084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560985400766
                                         uncertainty =       0.003692188017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560985400766
                                         uncertainty =       0.003692188017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529627012
  error estimate for blocks of size 2^( 2) =       0.000549710206
  error estimate for blocks of size 2^( 3) =       0.000567907605
  error estimate for blocks of size 2^( 4) =       0.000581780158
  error estimate for blocks of size 2^( 5) =       0.000589138149
  error estimate for blocks of size 2^( 6) =       0.000595280224
  error estimate for blocks of size 2^( 7) =       0.000596280761

      target function =                  N/A
              le_mean =     -22.437529383840
             les_mean =     504.003734114203
             stat err =       0.000590619823
             autocorr =       1.243585885594
              std dev =       0.749005703597
             le_variance =       0.561009544021


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437529383762        initial
     5.8208e+02     5.8208e+03             4.5701e-07       -22.437529385007  <--
     2.3283e+03     2.3283e+04             1.1433e-07       -22.437529384384
     9.3132e+03     9.3132e+04             2.8586e-08       -22.437529383840

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 6.5371e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.641306e-01 1 1  ON 0
 uu_1                 8.852912e-02 1 1  ON 1
 uu_2                -2.782823e-02 1 1  ON 2
 uu_3                -9.841880e-02 1 1  ON 3
 uu_4                -1.404271e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800057e-01 1 1  ON 6
 uu_7                -1.821290e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354450e-01 1 1  ON 9
 ud_0                 4.672527e-01 1 1  ON 10
 ud_1                 1.828484e-01 1 1  ON 11
 ud_2                 3.200655e-02 1 1  ON 12
 ud_3                -5.294839e-02 1 1  ON 13
 ud_4                -1.035053e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589790e-01 1 1  ON 16
 ud_7                -1.687581e-01 1 1  ON 17
 ud_8                -1.625732e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945155e-01 1 1  ON 20
 eC_1                -5.200220e-01 1 1  ON 21
 eC_2                -2.124610e-01 1 1  ON 22
 eC_3                 1.211191e-02 1 1  ON 23
 eC_4                 1.597217e-01 1 1  ON 24
 eC_5                 2.842266e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355159e-01 1 1  ON 27
 eC_8                 2.666395e-01 1 1  ON 28
 eC_9                 6.868611e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348179e-01 1 1  ON 31
 eO_2                -3.452082e-01 1 1  ON 32
 eO_3                -2.201319e-02 1 1  ON 33
 eO_4                 2.025336e-01 1 1  ON 34
 eO_5                 3.449473e-01 1 1  ON 35
 eO_6                 3.881443e-01 1 1  ON 36
 eO_7                 4.283241e-01 1 1  ON 37
 eO_8                 4.829830e-01 1 1  ON 38
 eO_9                 4.033826e-01 1 1  ON 39
eH1_0                -1.610006e-01 1 1  ON 40
eH1_1                -6.110850e-02 1 1  ON 41
eH1_2                -4.182551e-02 1 1  ON 42
eH1_3                -4.203406e-02 1 1  ON 43
eH1_4                -6.073984e-03 1 1  ON 44
eH1_5                 4.174109e-03 1 1  ON 45
eH1_6                 3.504540e-02 1 1  ON 46
eH1_7                 4.295030e-02 1 1  ON 47
eH1_8                 3.258438e-02 1 1  ON 48
eH1_9                 7.840521e-02 1 1  ON 49
eH2_0                -1.675307e-01 1 1  ON 50
eH2_1                -6.710361e-02 1 1  ON 51
eH2_2                -4.841768e-02 1 1  ON 52
eH2_3                -4.863753e-02 1 1  ON 53
eH2_4                -1.300043e-02 1 1  ON 54
eH2_5                -2.778661e-03 1 1  ON 55
eH2_6                 2.824435e-02 1 1  ON 56
eH2_7                 3.894026e-02 1 1  ON 57
eH2_8                 2.793156e-02 1 1  ON 58
eH2_9                 9.287811e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2731e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.3628
    reference variance = 0.495697
====================================================
  Execution time = 4.5190e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6224e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5140e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562347475102
                                         uncertainty =       0.003895618028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562347475102
                                         uncertainty =       0.003895618028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530209950
  error estimate for blocks of size 2^( 2) =       0.000550499625
  error estimate for blocks of size 2^( 3) =       0.000569648453
  error estimate for blocks of size 2^( 4) =       0.000583409248
  error estimate for blocks of size 2^( 5) =       0.000592891474
  error estimate for blocks of size 2^( 6) =       0.000599312063
  error estimate for blocks of size 2^( 7) =       0.000601615253

      target function =                  N/A
              le_mean =     -22.436812626814
             les_mean =     503.972805751594
             stat err =       0.000594307010
             autocorr =       1.256394304134
              std dev =       0.749830102054
             le_variance =       0.562245181947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243681262681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436812626814       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436812628319       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436812632833       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436812632849       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436812633496       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436812633462       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436812632848       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436812632760       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436812632330       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436812632234       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+02 is 1.038174e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436812626814       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436812627191       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436812628322       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436812628326       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436812628488       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436812628482       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436812628326       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436812628306       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436812628197       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436812628173       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+02 is 2.596542e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436812626814       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436812626908       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436812627191       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436812627192       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436812627233       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436812627230       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436812627190       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436812627189       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436812627154       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436812627154       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+03 is 6.492044e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0338e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.641305e-01 1 1  ON 0
 uu_1                 8.852923e-02 1 1  ON 1
 uu_2                -2.782825e-02 1 1  ON 2
 uu_3                -9.841882e-02 1 1  ON 3
 uu_4                -1.404271e-01 1 1  ON 4
 uu_5                -1.663363e-01 1 1  ON 5
 uu_6                -1.800056e-01 1 1  ON 6
 uu_7                -1.821287e-01 1 1  ON 7
 uu_8                -1.681295e-01 1 1  ON 8
 uu_9                -1.354450e-01 1 1  ON 9
 ud_0                 4.672528e-01 1 1  ON 10
 ud_1                 1.828482e-01 1 1  ON 11
 ud_2                 3.200681e-02 1 1  ON 12
 ud_3                -5.294834e-02 1 1  ON 13
 ud_4                -1.035051e-01 1 1  ON 14
 ud_5                -1.373822e-01 1 1  ON 15
 ud_6                -1.589790e-01 1 1  ON 16
 ud_7                -1.687582e-01 1 1  ON 17
 ud_8                -1.625731e-01 1 1  ON 18
 ud_9                -1.388618e-01 1 1  ON 19
 eC_0                -6.945155e-01 1 1  ON 20
 eC_1                -5.200220e-01 1 1  ON 21
 eC_2                -2.124611e-01 1 1  ON 22
 eC_3                 1.211184e-02 1 1  ON 23
 eC_4                 1.597217e-01 1 1  ON 24
 eC_5                 2.842266e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355159e-01 1 1  ON 27
 eC_8                 2.666396e-01 1 1  ON 28
 eC_9                 6.868616e-02 1 1  ON 29
 eO_0                -1.227559e+00 1 1  ON 30
 eO_1                -8.348181e-01 1 1  ON 31
 eO_2                -3.452082e-01 1 1  ON 32
 eO_3                -2.201336e-02 1 1  ON 33
 eO_4                 2.025337e-01 1 1  ON 34
 eO_5                 3.449472e-01 1 1  ON 35
 eO_6                 3.881444e-01 1 1  ON 36
 eO_7                 4.283241e-01 1 1  ON 37
 eO_8                 4.829829e-01 1 1  ON 38
 eO_9                 4.033827e-01 1 1  ON 39
eH1_0                -1.610006e-01 1 1  ON 40
eH1_1                -6.110838e-02 1 1  ON 41
eH1_2                -4.182570e-02 1 1  ON 42
eH1_3                -4.203408e-02 1 1  ON 43
eH1_4                -6.073841e-03 1 1  ON 44
eH1_5                 4.173936e-03 1 1  ON 45
eH1_6                 3.504540e-02 1 1  ON 46
eH1_7                 4.295021e-02 1 1  ON 47
eH1_8                 3.258445e-02 1 1  ON 48
eH1_9                 7.840522e-02 1 1  ON 49
eH2_0                -1.675306e-01 1 1  ON 50
eH2_1                -6.710361e-02 1 1  ON 51
eH2_2                -4.841777e-02 1 1  ON 52
eH2_3                -4.863767e-02 1 1  ON 53
eH2_4                -1.300018e-02 1 1  ON 54
eH2_5                -2.778627e-03 1 1  ON 55
eH2_6                 2.824429e-02 1 1  ON 56
eH2_7                 3.894016e-02 1 1  ON 57
eH2_8                 2.793153e-02 1 1  ON 58
eH2_9                 9.287801e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.3084
    reference variance = 0.377464
====================================================
  Execution time = 4.4527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6557e-01
  Total weights = 2.0000e+06
  Execution time = 3.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565612615817
                                         uncertainty =       0.006238444164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565612615817
                                         uncertainty =       0.006238444164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531776956
  error estimate for blocks of size 2^( 2) =       0.000551166073
  error estimate for blocks of size 2^( 3) =       0.000570013103
  error estimate for blocks of size 2^( 4) =       0.000584428278
  error estimate for blocks of size 2^( 5) =       0.000593446589
  error estimate for blocks of size 2^( 6) =       0.000598556093
  error estimate for blocks of size 2^( 7) =       0.000601220147

      target function =                  N/A
              le_mean =     -22.437928357758
             les_mean =     504.026202166441
             stat err =       0.000594412777
             autocorr =       1.249445290610
              std dev =       0.752046182995
             le_variance =       0.565573461358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565611821721
                                         uncertainty =       0.006238452333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565611821721
                                         uncertainty =       0.006238452333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531776583
  error estimate for blocks of size 2^( 2) =       0.000551165736
  error estimate for blocks of size 2^( 3) =       0.000570012787
  error estimate for blocks of size 2^( 4) =       0.000584428005
  error estimate for blocks of size 2^( 5) =       0.000593446304
  error estimate for blocks of size 2^( 6) =       0.000598555791
  error estimate for blocks of size 2^( 7) =       0.000601219856

      target function =                  N/A
              le_mean =     -22.437928373956
             les_mean =     504.026202099645
             stat err =       0.000594412489
             autocorr =       1.249445834626
              std dev =       0.752045655308
             le_variance =       0.565572667667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565612218892
                                         uncertainty =       0.006238448276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565612218892
                                         uncertainty =       0.006238448276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531776769
  error estimate for blocks of size 2^( 2) =       0.000551165905
  error estimate for blocks of size 2^( 3) =       0.000570012945
  error estimate for blocks of size 2^( 4) =       0.000584428141
  error estimate for blocks of size 2^( 5) =       0.000593446446
  error estimate for blocks of size 2^( 6) =       0.000598555942
  error estimate for blocks of size 2^( 7) =       0.000601220001

      target function =                  N/A
              le_mean =     -22.437928365888
             les_mean =     504.026202134561
             stat err =       0.000594412633
             autocorr =       1.249445562581
              std dev =       0.752045919234
             le_variance =       0.565573064637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565612566202
                                         uncertainty =       0.006238444679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565612566202
                                         uncertainty =       0.006238444679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531776932
  error estimate for blocks of size 2^( 2) =       0.000551166052
  error estimate for blocks of size 2^( 3) =       0.000570013083
  error estimate for blocks of size 2^( 4) =       0.000584428260
  error estimate for blocks of size 2^( 5) =       0.000593446571
  error estimate for blocks of size 2^( 6) =       0.000598556074
  error estimate for blocks of size 2^( 7) =       0.000601220128

      target function =                  N/A
              le_mean =     -22.437928358775
             les_mean =     504.026202162486
             stat err =       0.000594412759
             autocorr =       1.249445324603
              std dev =       0.752046150026
             le_variance =       0.565573411769


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437928357758        initial
     1.4552e+02     1.4552e+03             1.0382e-06       -22.437928373956  <--
     5.8208e+02     5.8208e+03             2.5965e-07       -22.437928365888
     2.3283e+03     2.3283e+04             6.4920e-08       -22.437928358775

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 6.3929e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.641303e-01 1 1  ON 0
 uu_1                 8.852958e-02 1 1  ON 1
 uu_2                -2.782832e-02 1 1  ON 2
 uu_3                -9.841889e-02 1 1  ON 3
 uu_4                -1.404270e-01 1 1  ON 4
 uu_5                -1.663369e-01 1 1  ON 5
 uu_6                -1.800054e-01 1 1  ON 6
 uu_7                -1.821279e-01 1 1  ON 7
 uu_8                -1.681289e-01 1 1  ON 8
 uu_9                -1.354451e-01 1 1  ON 9
 ud_0                 4.672530e-01 1 1  ON 10
 ud_1                 1.828477e-01 1 1  ON 11
 ud_2                 3.200758e-02 1 1  ON 12
 ud_3                -5.294819e-02 1 1  ON 13
 ud_4                -1.035045e-01 1 1  ON 14
 ud_5                -1.373820e-01 1 1  ON 15
 ud_6                -1.589790e-01 1 1  ON 16
 ud_7                -1.687585e-01 1 1  ON 17
 ud_8                -1.625730e-01 1 1  ON 18
 ud_9                -1.388615e-01 1 1  ON 19
 eC_0                -6.945154e-01 1 1  ON 20
 eC_1                -5.200219e-01 1 1  ON 21
 eC_2                -2.124612e-01 1 1  ON 22
 eC_3                 1.211165e-02 1 1  ON 23
 eC_4                 1.597217e-01 1 1  ON 24
 eC_5                 2.842263e-01 1 1  ON 25
 eC_6                 2.996273e-01 1 1  ON 26
 eC_7                 3.355157e-01 1 1  ON 27
 eC_8                 2.666399e-01 1 1  ON 28
 eC_9                 6.868630e-02 1 1  ON 29
 eO_0                -1.227558e+00 1 1  ON 30
 eO_1                -8.348184e-01 1 1  ON 31
 eO_2                -3.452083e-01 1 1  ON 32
 eO_3                -2.201390e-02 1 1  ON 33
 eO_4                 2.025338e-01 1 1  ON 34
 eO_5                 3.449466e-01 1 1  ON 35
 eO_6                 3.881447e-01 1 1  ON 36
 eO_7                 4.283240e-01 1 1  ON 37
 eO_8                 4.829827e-01 1 1  ON 38
 eO_9                 4.033831e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110803e-02 1 1  ON 41
eH1_2                -4.182625e-02 1 1  ON 42
eH1_3                -4.203413e-02 1 1  ON 43
eH1_4                -6.073412e-03 1 1  ON 44
eH1_5                 4.173419e-03 1 1  ON 45
eH1_6                 3.504541e-02 1 1  ON 46
eH1_7                 4.294995e-02 1 1  ON 47
eH1_8                 3.258467e-02 1 1  ON 48
eH1_9                 7.840525e-02 1 1  ON 49
eH2_0                -1.675301e-01 1 1  ON 50
eH2_1                -6.710359e-02 1 1  ON 51
eH2_2                -4.841804e-02 1 1  ON 52
eH2_3                -4.863810e-02 1 1  ON 53
eH2_4                -1.299940e-02 1 1  ON 54
eH2_5                -2.778526e-03 1 1  ON 55
eH2_6                 2.824410e-02 1 1  ON 56
eH2_7                 3.893986e-02 1 1  ON 57
eH2_8                 2.793147e-02 1 1  ON 58
eH2_9                 9.287771e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2427e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2436e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.5443
    reference variance = 0.543889
====================================================
  Execution time = 4.4730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6305e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5217e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563033489759
                                         uncertainty =       0.004883997359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563033489759
                                         uncertainty =       0.004883997359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530588855
  error estimate for blocks of size 2^( 2) =       0.000550329029
  error estimate for blocks of size 2^( 3) =       0.000568958806
  error estimate for blocks of size 2^( 4) =       0.000582811197
  error estimate for blocks of size 2^( 5) =       0.000591848727
  error estimate for blocks of size 2^( 6) =       0.000595887003
  error estimate for blocks of size 2^( 7) =       0.000598037897

      target function =                  N/A
              le_mean =     -22.436324036051
             les_mean =     503.951685035060
             stat err =       0.000592146206
             autocorr =       1.245494044244
              std dev =       0.750365954655
             le_variance =       0.563049065905


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243632403605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436324036051       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436324039945       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436324025828       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436324016300       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436324018625       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436324022532       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436324025602       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436324022101       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436324022134       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436324021205       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+01 is 5.831381e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436324036051       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436324037028       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436324033470       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436324031072       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436324031625       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436324032603       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436324033374       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436324032492       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436324032494       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436324032258       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+02 is 1.462311e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436324036051       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436324036296       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436324035404       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436324034804       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436324034940       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436324035185       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436324035377       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436324035160       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436324035156       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436324035097       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+02 is 3.658587e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9956e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.641305e-01 1 1  ON 0
 uu_1                 8.853010e-02 1 1  ON 1
 uu_2                -2.782844e-02 1 1  ON 2
 uu_3                -9.841911e-02 1 1  ON 3
 uu_4                -1.404268e-01 1 1  ON 4
 uu_5                -1.663362e-01 1 1  ON 5
 uu_6                -1.800052e-01 1 1  ON 6
 uu_7                -1.821265e-01 1 1  ON 7
 uu_8                -1.681292e-01 1 1  ON 8
 uu_9                -1.354460e-01 1 1  ON 9
 ud_0                 4.672541e-01 1 1  ON 10
 ud_1                 1.828481e-01 1 1  ON 11
 ud_2                 3.200768e-02 1 1  ON 12
 ud_3                -5.294739e-02 1 1  ON 13
 ud_4                -1.035045e-01 1 1  ON 14
 ud_5                -1.373820e-01 1 1  ON 15
 ud_6                -1.589791e-01 1 1  ON 16
 ud_7                -1.687585e-01 1 1  ON 17
 ud_8                -1.625726e-01 1 1  ON 18
 ud_9                -1.388619e-01 1 1  ON 19
 eC_0                -6.945151e-01 1 1  ON 20
 eC_1                -5.200226e-01 1 1  ON 21
 eC_2                -2.124603e-01 1 1  ON 22
 eC_3                 1.211111e-02 1 1  ON 23
 eC_4                 1.597218e-01 1 1  ON 24
 eC_5                 2.842268e-01 1 1  ON 25
 eC_6                 2.996271e-01 1 1  ON 26
 eC_7                 3.355148e-01 1 1  ON 27
 eC_8                 2.666401e-01 1 1  ON 28
 eC_9                 6.868650e-02 1 1  ON 29
 eO_0                -1.227558e+00 1 1  ON 30
 eO_1                -8.348196e-01 1 1  ON 31
 eO_2                -3.452082e-01 1 1  ON 32
 eO_3                -2.201349e-02 1 1  ON 33
 eO_4                 2.025336e-01 1 1  ON 34
 eO_5                 3.449461e-01 1 1  ON 35
 eO_6                 3.881446e-01 1 1  ON 36
 eO_7                 4.283246e-01 1 1  ON 37
 eO_8                 4.829822e-01 1 1  ON 38
 eO_9                 4.033836e-01 1 1  ON 39
eH1_0                -1.610005e-01 1 1  ON 40
eH1_1                -6.110836e-02 1 1  ON 41
eH1_2                -4.182603e-02 1 1  ON 42
eH1_3                -4.203442e-02 1 1  ON 43
eH1_4                -6.072939e-03 1 1  ON 44
eH1_5                 4.174010e-03 1 1  ON 45
eH1_6                 3.504508e-02 1 1  ON 46
eH1_7                 4.294994e-02 1 1  ON 47
eH1_8                 3.258435e-02 1 1  ON 48
eH1_9                 7.840492e-02 1 1  ON 49
eH2_0                -1.675295e-01 1 1  ON 50
eH2_1                -6.710345e-02 1 1  ON 51
eH2_2                -4.841752e-02 1 1  ON 52
eH2_3                -4.863781e-02 1 1  ON 53
eH2_4                -1.299861e-02 1 1  ON 54
eH2_5                -2.778749e-03 1 1  ON 55
eH2_6                 2.824346e-02 1 1  ON 56
eH2_7                 3.893887e-02 1 1  ON 57
eH2_8                 2.793142e-02 1 1  ON 58
eH2_9                 9.287723e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.4625
    reference variance = 0.58807
====================================================
  Execution time = 4.5789e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6518e-01
  Total weights = 2.0000e+06
  Execution time = 3.8429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565318178013
                                         uncertainty =       0.004709465913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565318178013
                                         uncertainty =       0.004709465913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531591246
  error estimate for blocks of size 2^( 2) =       0.000551843642
  error estimate for blocks of size 2^( 3) =       0.000570655192
  error estimate for blocks of size 2^( 4) =       0.000585080663
  error estimate for blocks of size 2^( 5) =       0.000595172695
  error estimate for blocks of size 2^( 6) =       0.000601460420
  error estimate for blocks of size 2^( 7) =       0.000601430214

      target function =                  N/A
              le_mean =     -22.436641330264
             les_mean =     503.968052406167
             stat err =       0.000595785998
             autocorr =       1.256102105356
              std dev =       0.751783549872
             le_variance =       0.565178505858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565322347422
                                         uncertainty =       0.004709498226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565322347422
                                         uncertainty =       0.004709498226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531593207
  error estimate for blocks of size 2^( 2) =       0.000551845443
  error estimate for blocks of size 2^( 3) =       0.000570656944
  error estimate for blocks of size 2^( 4) =       0.000585082373
  error estimate for blocks of size 2^( 5) =       0.000595174354
  error estimate for blocks of size 2^( 6) =       0.000601462286
  error estimate for blocks of size 2^( 7) =       0.000601431947

      target function =                  N/A
              le_mean =     -22.436641345808
             les_mean =     503.968057273108
             stat err =       0.000595787740
             autocorr =       1.256100183638
              std dev =       0.751786322872
             le_variance =       0.565182675257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565320286561
                                         uncertainty =       0.004709482259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565320286561
                                         uncertainty =       0.004709482259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531592238
  error estimate for blocks of size 2^( 2) =       0.000551844553
  error estimate for blocks of size 2^( 3) =       0.000570656078
  error estimate for blocks of size 2^( 4) =       0.000585081527
  error estimate for blocks of size 2^( 5) =       0.000595173534
  error estimate for blocks of size 2^( 6) =       0.000601461363
  error estimate for blocks of size 2^( 7) =       0.000601431091

      target function =                  N/A
              le_mean =     -22.436641338001
             les_mean =     503.968054861913
             stat err =       0.000595786879
             autocorr =       1.256101132742
              std dev =       0.751784952226
             le_variance =       0.565180614394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565318442301
                                         uncertainty =       0.004709467963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565318442301
                                         uncertainty =       0.004709467963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531591370
  error estimate for blocks of size 2^( 2) =       0.000551843756
  error estimate for blocks of size 2^( 3) =       0.000570655303
  error estimate for blocks of size 2^( 4) =       0.000585080771
  error estimate for blocks of size 2^( 5) =       0.000595172801
  error estimate for blocks of size 2^( 6) =       0.000601460538
  error estimate for blocks of size 2^( 7) =       0.000601430324

      target function =                  N/A
              le_mean =     -22.436641331225
             les_mean =     503.968052713586
             stat err =       0.000595786108
             autocorr =       1.256101983401
              std dev =       0.751783725645
             le_variance =       0.565178770144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436641330264        initial
     3.6380e+01     3.6380e+02             5.8314e-06       -22.436641345808  <--
     1.4552e+02     1.4552e+03             1.4623e-06       -22.436641338001
     5.8208e+02     5.8208e+03             3.6586e-07       -22.436641331225

*****************************************************************************
Applying the update for shift_i =   3.6380e+01     and shift_s =   3.6380e+02
*****************************************************************************

  Execution time = 6.8558e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.641313e-01 1 1  ON 0
 uu_1                 8.853163e-02 1 1  ON 1
 uu_2                -2.782878e-02 1 1  ON 2
 uu_3                -9.841979e-02 1 1  ON 3
 uu_4                -1.404263e-01 1 1  ON 4
 uu_5                -1.663344e-01 1 1  ON 5
 uu_6                -1.800045e-01 1 1  ON 6
 uu_7                -1.821221e-01 1 1  ON 7
 uu_8                -1.681301e-01 1 1  ON 8
 uu_9                -1.354486e-01 1 1  ON 9
 ud_0                 4.672571e-01 1 1  ON 10
 ud_1                 1.828494e-01 1 1  ON 11
 ud_2                 3.200799e-02 1 1  ON 12
 ud_3                -5.294502e-02 1 1  ON 13
 ud_4                -1.035043e-01 1 1  ON 14
 ud_5                -1.373822e-01 1 1  ON 15
 ud_6                -1.589796e-01 1 1  ON 16
 ud_7                -1.687587e-01 1 1  ON 17
 ud_8                -1.625716e-01 1 1  ON 18
 ud_9                -1.388630e-01 1 1  ON 19
 eC_0                -6.945140e-01 1 1  ON 20
 eC_1                -5.200246e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.210952e-02 1 1  ON 23
 eC_4                 1.597221e-01 1 1  ON 24
 eC_5                 2.842280e-01 1 1  ON 25
 eC_6                 2.996265e-01 1 1  ON 26
 eC_7                 3.355122e-01 1 1  ON 27
 eC_8                 2.666409e-01 1 1  ON 28
 eC_9                 6.868709e-02 1 1  ON 29
 eO_0                -1.227557e+00 1 1  ON 30
 eO_1                -8.348232e-01 1 1  ON 31
 eO_2                -3.452079e-01 1 1  ON 32
 eO_3                -2.201224e-02 1 1  ON 33
 eO_4                 2.025331e-01 1 1  ON 34
 eO_5                 3.449446e-01 1 1  ON 35
 eO_6                 3.881443e-01 1 1  ON 36
 eO_7                 4.283266e-01 1 1  ON 37
 eO_8                 4.829808e-01 1 1  ON 38
 eO_9                 4.033849e-01 1 1  ON 39
eH1_0                -1.610004e-01 1 1  ON 40
eH1_1                -6.110937e-02 1 1  ON 41
eH1_2                -4.182540e-02 1 1  ON 42
eH1_3                -4.203527e-02 1 1  ON 43
eH1_4                -6.071532e-03 1 1  ON 44
eH1_5                 4.175783e-03 1 1  ON 45
eH1_6                 3.504408e-02 1 1  ON 46
eH1_7                 4.294992e-02 1 1  ON 47
eH1_8                 3.258336e-02 1 1  ON 48
eH1_9                 7.840393e-02 1 1  ON 49
eH2_0                -1.675279e-01 1 1  ON 50
eH2_1                -6.710300e-02 1 1  ON 51
eH2_2                -4.841598e-02 1 1  ON 52
eH2_3                -4.863694e-02 1 1  ON 53
eH2_4                -1.299625e-02 1 1  ON 54
eH2_5                -2.779405e-03 1 1  ON 55
eH2_6                 2.824155e-02 1 1  ON 56
eH2_7                 3.893592e-02 1 1  ON 57
eH2_8                 2.793128e-02 1 1  ON 58
eH2_9                 9.287579e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2893e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2438e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.4323
    reference variance = 0.626289
====================================================
  Execution time = 4.5652e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6070e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5236e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560661688294
                                         uncertainty =       0.004601307305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560661688294
                                         uncertainty =       0.004601307305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529478800
  error estimate for blocks of size 2^( 2) =       0.000549859253
  error estimate for blocks of size 2^( 3) =       0.000568350679
  error estimate for blocks of size 2^( 4) =       0.000581558271
  error estimate for blocks of size 2^( 5) =       0.000589609411
  error estimate for blocks of size 2^( 6) =       0.000597106765
  error estimate for blocks of size 2^( 7) =       0.000599054170

      target function =                  N/A
              le_mean =     -22.436458693067
             les_mean =     503.955374004296
             stat err =       0.000591832154
             autocorr =       1.249395570644
              std dev =       0.748796099724
             le_variance =       0.560695598962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243645869307e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436458693067       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436458691172       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436458579252       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436458557235       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436458601883       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436458601698       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436458579742       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436458578743       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436458585608       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436458592420       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+00 is 3.498138e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436458693067       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436458692587       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436458663735       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436458657814       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436458669231       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436458669533       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436458664122       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436458663470       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436458665190       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436458666876       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+01 is 9.080614e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436458693067       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436458692946       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436458685677       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436458684169       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436458687039       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436458687137       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436458685792       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436458685603       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436458686033       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436458686452       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+02 is 2.292303e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304785 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0896e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.641328e-01 1 1  ON 0
 uu_1                 8.853165e-02 1 1  ON 1
 uu_2                -2.783190e-02 1 1  ON 2
 uu_3                -9.842032e-02 1 1  ON 3
 uu_4                -1.404271e-01 1 1  ON 4
 uu_5                -1.663356e-01 1 1  ON 5
 uu_6                -1.800040e-01 1 1  ON 6
 uu_7                -1.821172e-01 1 1  ON 7
 uu_8                -1.681303e-01 1 1  ON 8
 uu_9                -1.354471e-01 1 1  ON 9
 ud_0                 4.672662e-01 1 1  ON 10
 ud_1                 1.828489e-01 1 1  ON 11
 ud_2                 3.200997e-02 1 1  ON 12
 ud_3                -5.294536e-02 1 1  ON 13
 ud_4                -1.035039e-01 1 1  ON 14
 ud_5                -1.373851e-01 1 1  ON 15
 ud_6                -1.589818e-01 1 1  ON 16
 ud_7                -1.687608e-01 1 1  ON 17
 ud_8                -1.625707e-01 1 1  ON 18
 ud_9                -1.388614e-01 1 1  ON 19
 eC_0                -6.945173e-01 1 1  ON 20
 eC_1                -5.200232e-01 1 1  ON 21
 eC_2                -2.124598e-01 1 1  ON 22
 eC_3                 1.210993e-02 1 1  ON 23
 eC_4                 1.597245e-01 1 1  ON 24
 eC_5                 2.842256e-01 1 1  ON 25
 eC_6                 2.996280e-01 1 1  ON 26
 eC_7                 3.355114e-01 1 1  ON 27
 eC_8                 2.666431e-01 1 1  ON 28
 eC_9                 6.868811e-02 1 1  ON 29
 eO_0                -1.227553e+00 1 1  ON 30
 eO_1                -8.348303e-01 1 1  ON 31
 eO_2                -3.452066e-01 1 1  ON 32
 eO_3                -2.201158e-02 1 1  ON 33
 eO_4                 2.025331e-01 1 1  ON 34
 eO_5                 3.449446e-01 1 1  ON 35
 eO_6                 3.881432e-01 1 1  ON 36
 eO_7                 4.283262e-01 1 1  ON 37
 eO_8                 4.829785e-01 1 1  ON 38
 eO_9                 4.033872e-01 1 1  ON 39
eH1_0                -1.610027e-01 1 1  ON 40
eH1_1                -6.110782e-02 1 1  ON 41
eH1_2                -4.183053e-02 1 1  ON 42
eH1_3                -4.203585e-02 1 1  ON 43
eH1_4                -6.067215e-03 1 1  ON 44
eH1_5                 4.175636e-03 1 1  ON 45
eH1_6                 3.504384e-02 1 1  ON 46
eH1_7                 4.295128e-02 1 1  ON 47
eH1_8                 3.258348e-02 1 1  ON 48
eH1_9                 7.840356e-02 1 1  ON 49
eH2_0                -1.675271e-01 1 1  ON 50
eH2_1                -6.710780e-02 1 1  ON 51
eH2_2                -4.841474e-02 1 1  ON 52
eH2_3                -4.863650e-02 1 1  ON 53
eH2_4                -1.299328e-02 1 1  ON 54
eH2_5                -2.779693e-03 1 1  ON 55
eH2_6                 2.824031e-02 1 1  ON 56
eH2_7                 3.893483e-02 1 1  ON 57
eH2_8                 2.793184e-02 1 1  ON 58
eH2_9                 9.287553e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.4995
    reference variance = 0.499822
====================================================
  Execution time = 4.4489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.6168e-01
  Total weights = 2.0000e+06
  Execution time = 3.8627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561704212103
                                         uncertainty =       0.004343197810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561704212103
                                         uncertainty =       0.004343197810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529939495
  error estimate for blocks of size 2^( 2) =       0.000549971422
  error estimate for blocks of size 2^( 3) =       0.000568513003
  error estimate for blocks of size 2^( 4) =       0.000582409842
  error estimate for blocks of size 2^( 5) =       0.000591955708
  error estimate for blocks of size 2^( 6) =       0.000596556937
  error estimate for blocks of size 2^( 7) =       0.000599271057

      target function =                  N/A
              le_mean =     -22.437799996125
             les_mean =     504.016540121889
             stat err =       0.000592548386
             autocorr =       1.250244820196
              std dev =       0.749447621007
             le_variance =       0.561671736633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561737445950
                                         uncertainty =       0.004343573503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561737445950
                                         uncertainty =       0.004343573503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529955175
  error estimate for blocks of size 2^( 2) =       0.000549986601
  error estimate for blocks of size 2^( 3) =       0.000568527803
  error estimate for blocks of size 2^( 4) =       0.000582424788
  error estimate for blocks of size 2^( 5) =       0.000591970368
  error estimate for blocks of size 2^( 6) =       0.000596570858
  error estimate for blocks of size 2^( 7) =       0.000599284751

      target function =                  N/A
              le_mean =     -22.437799988546
             les_mean =     504.016573020870
             stat err =       0.000592562691
             autocorr =       1.250231200876
              std dev =       0.749469796421
             le_variance =       0.561704975748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561721598109
                                         uncertainty =       0.004343394133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561721598109
                                         uncertainty =       0.004343394133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529947698
  error estimate for blocks of size 2^( 2) =       0.000549979360
  error estimate for blocks of size 2^( 3) =       0.000568520742
  error estimate for blocks of size 2^( 4) =       0.000582417658
  error estimate for blocks of size 2^( 5) =       0.000591963375
  error estimate for blocks of size 2^( 6) =       0.000596564220
  error estimate for blocks of size 2^( 7) =       0.000599278225

      target function =                  N/A
              le_mean =     -22.437799991783
             les_mean =     504.016557315683
             stat err =       0.000592555869
             autocorr =       1.250237693667
              std dev =       0.749459221901
             le_variance =       0.561689125292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561706409754
                                         uncertainty =       0.004343222630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561706409754
                                         uncertainty =       0.004343222630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529940532
  error estimate for blocks of size 2^( 2) =       0.000549972425
  error estimate for blocks of size 2^( 3) =       0.000568513981
  error estimate for blocks of size 2^( 4) =       0.000582410830
  error estimate for blocks of size 2^( 5) =       0.000591956677
  error estimate for blocks of size 2^( 6) =       0.000596557857
  error estimate for blocks of size 2^( 7) =       0.000599271963

      target function =                  N/A
              le_mean =     -22.437799995454
             les_mean =     504.016542289758
             stat err =       0.000592549332
             autocorr =       1.250243919045
              std dev =       0.749449087408
             le_variance =       0.561673934617


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437799996125        initial  <--
     9.0949e+00     9.0949e+01             3.4981e-05       -22.437799988546
     3.6380e+01     3.6380e+02             9.0806e-06       -22.437799991783
     1.4552e+02     1.4552e+03             2.2923e-06       -22.437799995454

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8297
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.641313e-01 1 1  ON 0
 uu_1                 8.853163e-02 1 1  ON 1
 uu_2                -2.782878e-02 1 1  ON 2
 uu_3                -9.841979e-02 1 1  ON 3
 uu_4                -1.404263e-01 1 1  ON 4
 uu_5                -1.663344e-01 1 1  ON 5
 uu_6                -1.800045e-01 1 1  ON 6
 uu_7                -1.821221e-01 1 1  ON 7
 uu_8                -1.681301e-01 1 1  ON 8
 uu_9                -1.354486e-01 1 1  ON 9
 ud_0                 4.672571e-01 1 1  ON 10
 ud_1                 1.828494e-01 1 1  ON 11
 ud_2                 3.200799e-02 1 1  ON 12
 ud_3                -5.294502e-02 1 1  ON 13
 ud_4                -1.035043e-01 1 1  ON 14
 ud_5                -1.373822e-01 1 1  ON 15
 ud_6                -1.589796e-01 1 1  ON 16
 ud_7                -1.687587e-01 1 1  ON 17
 ud_8                -1.625716e-01 1 1  ON 18
 ud_9                -1.388630e-01 1 1  ON 19
 eC_0                -6.945140e-01 1 1  ON 20
 eC_1                -5.200246e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.210952e-02 1 1  ON 23
 eC_4                 1.597221e-01 1 1  ON 24
 eC_5                 2.842280e-01 1 1  ON 25
 eC_6                 2.996265e-01 1 1  ON 26
 eC_7                 3.355122e-01 1 1  ON 27
 eC_8                 2.666409e-01 1 1  ON 28
 eC_9                 6.868709e-02 1 1  ON 29
 eO_0                -1.227557e+00 1 1  ON 30
 eO_1                -8.348232e-01 1 1  ON 31
 eO_2                -3.452079e-01 1 1  ON 32
 eO_3                -2.201224e-02 1 1  ON 33
 eO_4                 2.025331e-01 1 1  ON 34
 eO_5                 3.449446e-01 1 1  ON 35
 eO_6                 3.881443e-01 1 1  ON 36
 eO_7                 4.283266e-01 1 1  ON 37
 eO_8                 4.829808e-01 1 1  ON 38
 eO_9                 4.033849e-01 1 1  ON 39
eH1_0                -1.610004e-01 1 1  ON 40
eH1_1                -6.110937e-02 1 1  ON 41
eH1_2                -4.182540e-02 1 1  ON 42
eH1_3                -4.203527e-02 1 1  ON 43
eH1_4                -6.071532e-03 1 1  ON 44
eH1_5                 4.175783e-03 1 1  ON 45
eH1_6                 3.504408e-02 1 1  ON 46
eH1_7                 4.294992e-02 1 1  ON 47
eH1_8                 3.258336e-02 1 1  ON 48
eH1_9                 7.840393e-02 1 1  ON 49
eH2_0                -1.675279e-01 1 1  ON 50
eH2_1                -6.710300e-02 1 1  ON 51
eH2_2                -4.841598e-02 1 1  ON 52
eH2_3                -4.863694e-02 1 1  ON 53
eH2_4                -1.299625e-02 1 1  ON 54
eH2_5                -2.779405e-03 1 1  ON 55
eH2_6                 2.824155e-02 1 1  ON 56
eH2_7                 3.893592e-02 1 1  ON 57
eH2_8                 2.793128e-02 1 1  ON 58
eH2_9                 9.287579e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2473e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.4515
    reference variance = 0.310457
====================================================
  Execution time = 4.4954e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6744e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5183e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567477831313
                                         uncertainty =       0.004892365472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567477831313
                                         uncertainty =       0.004892365472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532652985
  error estimate for blocks of size 2^( 2) =       0.000552459750
  error estimate for blocks of size 2^( 3) =       0.000570750661
  error estimate for blocks of size 2^( 4) =       0.000584146449
  error estimate for blocks of size 2^( 5) =       0.000593961932
  error estimate for blocks of size 2^( 6) =       0.000599900313
  error estimate for blocks of size 2^( 7) =       0.000601591929

      target function =                  N/A
              le_mean =     -22.437175436776
             les_mean =     503.994279700862
             stat err =       0.000594900156
             autocorr =       1.247381892577
              std dev =       0.753285074808
             le_variance =       0.567438403929


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243717543678e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437175436776       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437175443951       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437175451675       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437175459478       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437175464476       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437175467082       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437175466296       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437175464312       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437175465300       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437175464264       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+01 is 2.684826e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437175436776       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437175438571       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437175440508       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437175442463       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437175443716       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437175444374       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437175444180       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437175443681       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437175443929       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437175443668       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+02 is 6.731686e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437175436776       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437175437225       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437175437709       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437175438198       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437175438511       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437175438677       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437175438632       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437175438506       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437175438570       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437175438504       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+03 is 1.684153e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308348 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0144e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.641313e-01 1 1  ON 0
 uu_1                 8.853156e-02 1 1  ON 1
 uu_2                -2.782872e-02 1 1  ON 2
 uu_3                -9.841963e-02 1 1  ON 3
 uu_4                -1.404263e-01 1 1  ON 4
 uu_5                -1.663343e-01 1 1  ON 5
 uu_6                -1.800045e-01 1 1  ON 6
 uu_7                -1.821217e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354488e-01 1 1  ON 9
 ud_0                 4.672575e-01 1 1  ON 10
 ud_1                 1.828494e-01 1 1  ON 11
 ud_2                 3.200826e-02 1 1  ON 12
 ud_3                -5.294492e-02 1 1  ON 13
 ud_4                -1.035044e-01 1 1  ON 14
 ud_5                -1.373823e-01 1 1  ON 15
 ud_6                -1.589796e-01 1 1  ON 16
 ud_7                -1.687587e-01 1 1  ON 17
 ud_8                -1.625717e-01 1 1  ON 18
 ud_9                -1.388629e-01 1 1  ON 19
 eC_0                -6.945144e-01 1 1  ON 20
 eC_1                -5.200246e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.210965e-02 1 1  ON 23
 eC_4                 1.597222e-01 1 1  ON 24
 eC_5                 2.842280e-01 1 1  ON 25
 eC_6                 2.996264e-01 1 1  ON 26
 eC_7                 3.355122e-01 1 1  ON 27
 eC_8                 2.666411e-01 1 1  ON 28
 eC_9                 6.868717e-02 1 1  ON 29
 eO_0                -1.227556e+00 1 1  ON 30
 eO_1                -8.348235e-01 1 1  ON 31
 eO_2                -3.452081e-01 1 1  ON 32
 eO_3                -2.201213e-02 1 1  ON 33
 eO_4                 2.025330e-01 1 1  ON 34
 eO_5                 3.449447e-01 1 1  ON 35
 eO_6                 3.881438e-01 1 1  ON 36
 eO_7                 4.283265e-01 1 1  ON 37
 eO_8                 4.829807e-01 1 1  ON 38
 eO_9                 4.033852e-01 1 1  ON 39
eH1_0                -1.610007e-01 1 1  ON 40
eH1_1                -6.110927e-02 1 1  ON 41
eH1_2                -4.182576e-02 1 1  ON 42
eH1_3                -4.203548e-02 1 1  ON 43
eH1_4                -6.071288e-03 1 1  ON 44
eH1_5                 4.175669e-03 1 1  ON 45
eH1_6                 3.504437e-02 1 1  ON 46
eH1_7                 4.295012e-02 1 1  ON 47
eH1_8                 3.258338e-02 1 1  ON 48
eH1_9                 7.840391e-02 1 1  ON 49
eH2_0                -1.675280e-01 1 1  ON 50
eH2_1                -6.710310e-02 1 1  ON 51
eH2_2                -4.841610e-02 1 1  ON 52
eH2_3                -4.863707e-02 1 1  ON 53
eH2_4                -1.299570e-02 1 1  ON 54
eH2_5                -2.779561e-03 1 1  ON 55
eH2_6                 2.824173e-02 1 1  ON 56
eH2_7                 3.893575e-02 1 1  ON 57
eH2_8                 2.793137e-02 1 1  ON 58
eH2_9                 9.287569e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.4443
    reference variance = 0.527806
====================================================
  Execution time = 4.4773e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6003e-01
  Total weights = 2.0000e+06
  Execution time = 3.8650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560178227262
                                         uncertainty =       0.004809465208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560178227262
                                         uncertainty =       0.004809465208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529165436
  error estimate for blocks of size 2^( 2) =       0.000548854084
  error estimate for blocks of size 2^( 3) =       0.000567945129
  error estimate for blocks of size 2^( 4) =       0.000581545278
  error estimate for blocks of size 2^( 5) =       0.000590729227
  error estimate for blocks of size 2^( 6) =       0.000597406946
  error estimate for blocks of size 2^( 7) =       0.000601959187

      target function =                  N/A
              le_mean =     -22.436655935560
             les_mean =     503.963561407659
             stat err =       0.000592910160
             autocorr =       1.255436774836
              std dev =       0.748352936102
             le_variance =       0.560032116973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560177712318
                                         uncertainty =       0.004809474713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560177712318
                                         uncertainty =       0.004809474713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529165192
  error estimate for blocks of size 2^( 2) =       0.000548853896
  error estimate for blocks of size 2^( 3) =       0.000567944989
  error estimate for blocks of size 2^( 4) =       0.000581545135
  error estimate for blocks of size 2^( 5) =       0.000590729121
  error estimate for blocks of size 2^( 6) =       0.000597406836
  error estimate for blocks of size 2^( 7) =       0.000601959077

      target function =                  N/A
              le_mean =     -22.436655937940
             les_mean =     503.963560999101
             stat err =       0.000592910042
             autocorr =       1.255437433536
              std dev =       0.748352591780
             le_variance =       0.560031601623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560177970759
                                         uncertainty =       0.004809470008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560177970759
                                         uncertainty =       0.004809470008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529165315
  error estimate for blocks of size 2^( 2) =       0.000548853990
  error estimate for blocks of size 2^( 3) =       0.000567945059
  error estimate for blocks of size 2^( 4) =       0.000581545207
  error estimate for blocks of size 2^( 5) =       0.000590729175
  error estimate for blocks of size 2^( 6) =       0.000597406892
  error estimate for blocks of size 2^( 7) =       0.000601959133

      target function =                  N/A
              le_mean =     -22.436655936748
             les_mean =     503.963561204247
             stat err =       0.000592910101
             autocorr =       1.255437104208
              std dev =       0.748352764587
             le_variance =       0.560031860265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560178195224
                                         uncertainty =       0.004809465809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560178195224
                                         uncertainty =       0.004809465809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529165421
  error estimate for blocks of size 2^( 2) =       0.000548854072
  error estimate for blocks of size 2^( 3) =       0.000567945120
  error estimate for blocks of size 2^( 4) =       0.000581545269
  error estimate for blocks of size 2^( 5) =       0.000590729221
  error estimate for blocks of size 2^( 6) =       0.000597406939
  error estimate for blocks of size 2^( 7) =       0.000601959180

      target function =                  N/A
              le_mean =     -22.436655935708
             les_mean =     503.963561382221
             stat err =       0.000592910152
             autocorr =       1.255436816004
              std dev =       0.748352914680
             le_variance =       0.560032084910


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436655935560        initial
     9.0949e+01     9.0949e+02             2.6848e-06       -22.436655937940  <--
     3.6380e+02     3.6380e+03             6.7317e-07       -22.436655936748
     1.4552e+03     1.4552e+04             1.6842e-07       -22.436655935708

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 6.4143e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.641310e-01 1 1  ON 0
 uu_1                 8.853137e-02 1 1  ON 1
 uu_2                -2.782852e-02 1 1  ON 2
 uu_3                -9.841916e-02 1 1  ON 3
 uu_4                -1.404264e-01 1 1  ON 4
 uu_5                -1.663339e-01 1 1  ON 5
 uu_6                -1.800046e-01 1 1  ON 6
 uu_7                -1.821206e-01 1 1  ON 7
 uu_8                -1.681296e-01 1 1  ON 8
 uu_9                -1.354494e-01 1 1  ON 9
 ud_0                 4.672586e-01 1 1  ON 10
 ud_1                 1.828495e-01 1 1  ON 11
 ud_2                 3.200907e-02 1 1  ON 12
 ud_3                -5.294462e-02 1 1  ON 13
 ud_4                -1.035046e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589794e-01 1 1  ON 16
 ud_7                -1.687587e-01 1 1  ON 17
 ud_8                -1.625721e-01 1 1  ON 18
 ud_9                -1.388625e-01 1 1  ON 19
 eC_0                -6.945157e-01 1 1  ON 20
 eC_1                -5.200247e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.211002e-02 1 1  ON 23
 eC_4                 1.597225e-01 1 1  ON 24
 eC_5                 2.842281e-01 1 1  ON 25
 eC_6                 2.996263e-01 1 1  ON 26
 eC_7                 3.355121e-01 1 1  ON 27
 eC_8                 2.666417e-01 1 1  ON 28
 eC_9                 6.868740e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348245e-01 1 1  ON 31
 eO_2                -3.452087e-01 1 1  ON 32
 eO_3                -2.201177e-02 1 1  ON 33
 eO_4                 2.025325e-01 1 1  ON 34
 eO_5                 3.449451e-01 1 1  ON 35
 eO_6                 3.881422e-01 1 1  ON 36
 eO_7                 4.283264e-01 1 1  ON 37
 eO_8                 4.829802e-01 1 1  ON 38
 eO_9                 4.033860e-01 1 1  ON 39
eH1_0                -1.610015e-01 1 1  ON 40
eH1_1                -6.110898e-02 1 1  ON 41
eH1_2                -4.182686e-02 1 1  ON 42
eH1_3                -4.203608e-02 1 1  ON 43
eH1_4                -6.070562e-03 1 1  ON 44
eH1_5                 4.175329e-03 1 1  ON 45
eH1_6                 3.504524e-02 1 1  ON 46
eH1_7                 4.295072e-02 1 1  ON 47
eH1_8                 3.258344e-02 1 1  ON 48
eH1_9                 7.840382e-02 1 1  ON 49
eH2_0                -1.675285e-01 1 1  ON 50
eH2_1                -6.710342e-02 1 1  ON 51
eH2_2                -4.841645e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.299407e-02 1 1  ON 54
eH2_5                -2.780027e-03 1 1  ON 55
eH2_6                 2.824228e-02 1 1  ON 56
eH2_7                 3.893526e-02 1 1  ON 57
eH2_8                 2.793164e-02 1 1  ON 58
eH2_9                 9.287541e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2448e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2439e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.4374
    reference variance = 0.410531
====================================================
  Execution time = 4.9036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6200e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5097e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562077839021
                                         uncertainty =       0.004496100746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562077839021
                                         uncertainty =       0.004496100746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530094666
  error estimate for blocks of size 2^( 2) =       0.000550211076
  error estimate for blocks of size 2^( 3) =       0.000568213332
  error estimate for blocks of size 2^( 4) =       0.000582197532
  error estimate for blocks of size 2^( 5) =       0.000590532628
  error estimate for blocks of size 2^( 6) =       0.000594262548
  error estimate for blocks of size 2^( 7) =       0.000598161649

      target function =                  N/A
              le_mean =     -22.436059881985
             les_mean =     503.938783456494
             stat err =       0.000591288589
             autocorr =       1.244205531740
              std dev =       0.749667065764
             le_variance =       0.562000709491


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243605988198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436059881985       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436059903391       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436059950205       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436059947493       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436059957201       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436059984029       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436059973779       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436059972358       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436059963106       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436059968438       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.2737e+01 is 7.461509e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436059881985       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436059887365       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436059899182       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436059898542       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436059901018       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436059907825       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436059905289       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436059904925       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436059902565       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436059903875       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+01 is 1.883316e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436059881985       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436059883332       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436059886293       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436059886135       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436059886758       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436059888466       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436059887833       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436059887741       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436059887150       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436059887475       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+02 is 4.719683e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311895 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4140e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.641315e-01 1 1  ON 0
 uu_1                 8.853083e-02 1 1  ON 1
 uu_2                -2.782936e-02 1 1  ON 2
 uu_3                -9.842008e-02 1 1  ON 3
 uu_4                -1.404265e-01 1 1  ON 4
 uu_5                -1.663336e-01 1 1  ON 5
 uu_6                -1.800050e-01 1 1  ON 6
 uu_7                -1.821192e-01 1 1  ON 7
 uu_8                -1.681293e-01 1 1  ON 8
 uu_9                -1.354487e-01 1 1  ON 9
 ud_0                 4.672605e-01 1 1  ON 10
 ud_1                 1.828501e-01 1 1  ON 11
 ud_2                 3.200960e-02 1 1  ON 12
 ud_3                -5.294467e-02 1 1  ON 13
 ud_4                -1.035040e-01 1 1  ON 14
 ud_5                -1.373831e-01 1 1  ON 15
 ud_6                -1.589785e-01 1 1  ON 16
 ud_7                -1.687592e-01 1 1  ON 17
 ud_8                -1.625733e-01 1 1  ON 18
 ud_9                -1.388626e-01 1 1  ON 19
 eC_0                -6.945155e-01 1 1  ON 20
 eC_1                -5.200255e-01 1 1  ON 21
 eC_2                -2.124563e-01 1 1  ON 22
 eC_3                 1.211073e-02 1 1  ON 23
 eC_4                 1.597216e-01 1 1  ON 24
 eC_5                 2.842277e-01 1 1  ON 25
 eC_6                 2.996260e-01 1 1  ON 26
 eC_7                 3.355115e-01 1 1  ON 27
 eC_8                 2.666424e-01 1 1  ON 28
 eC_9                 6.868783e-02 1 1  ON 29
 eO_0                -1.227556e+00 1 1  ON 30
 eO_1                -8.348255e-01 1 1  ON 31
 eO_2                -3.452092e-01 1 1  ON 32
 eO_3                -2.201067e-02 1 1  ON 33
 eO_4                 2.025311e-01 1 1  ON 34
 eO_5                 3.449468e-01 1 1  ON 35
 eO_6                 3.881423e-01 1 1  ON 36
 eO_7                 4.283264e-01 1 1  ON 37
 eO_8                 4.829794e-01 1 1  ON 38
 eO_9                 4.033869e-01 1 1  ON 39
eH1_0                -1.610011e-01 1 1  ON 40
eH1_1                -6.110850e-02 1 1  ON 41
eH1_2                -4.182724e-02 1 1  ON 42
eH1_3                -4.203648e-02 1 1  ON 43
eH1_4                -6.070051e-03 1 1  ON 44
eH1_5                 4.175677e-03 1 1  ON 45
eH1_6                 3.504543e-02 1 1  ON 46
eH1_7                 4.294940e-02 1 1  ON 47
eH1_8                 3.258308e-02 1 1  ON 48
eH1_9                 7.840375e-02 1 1  ON 49
eH2_0                -1.675274e-01 1 1  ON 50
eH2_1                -6.710224e-02 1 1  ON 51
eH2_2                -4.841684e-02 1 1  ON 52
eH2_3                -4.863732e-02 1 1  ON 53
eH2_4                -1.299352e-02 1 1  ON 54
eH2_5                -2.781002e-03 1 1  ON 55
eH2_6                 2.824176e-02 1 1  ON 56
eH2_7                 3.893477e-02 1 1  ON 57
eH2_8                 2.793083e-02 1 1  ON 58
eH2_9                 9.287506e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.6033
    reference variance = 0.68279
====================================================
  Execution time = 4.5484e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.7770e-01
  Total weights = 2.0000e+06
  Execution time = 3.8409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577675183852
                                         uncertainty =       0.018853895429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577675183852
                                         uncertainty =       0.018853895429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537444687
  error estimate for blocks of size 2^( 2) =       0.000557413231
  error estimate for blocks of size 2^( 3) =       0.000575232750
  error estimate for blocks of size 2^( 4) =       0.000589602981
  error estimate for blocks of size 2^( 5) =       0.000598356738
  error estimate for blocks of size 2^( 6) =       0.000603130911
  error estimate for blocks of size 2^( 7) =       0.000608247928

      target function =                  N/A
              le_mean =     -22.435915528476
             les_mean =     503.947998894404
             stat err =       0.000599834640
             autocorr =       1.245648578576
              std dev =       0.760061564822
             le_variance =       0.577693582319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577684154474
                                         uncertainty =       0.018854633586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577684154474
                                         uncertainty =       0.018854633586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537448859
  error estimate for blocks of size 2^( 2) =       0.000557417146
  error estimate for blocks of size 2^( 3) =       0.000575236401
  error estimate for blocks of size 2^( 4) =       0.000589606398
  error estimate for blocks of size 2^( 5) =       0.000598360143
  error estimate for blocks of size 2^( 6) =       0.000603134383
  error estimate for blocks of size 2^( 7) =       0.000608251563

      target function =                  N/A
              le_mean =     -22.435915472185
             les_mean =     503.948005337347
             stat err =       0.000599838122
             autocorr =       1.245643701753
              std dev =       0.760067464883
             le_variance =       0.577702551174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577679715287
                                         uncertainty =       0.018854266766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577679715287
                                         uncertainty =       0.018854266766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537446794
  error estimate for blocks of size 2^( 2) =       0.000557415209
  error estimate for blocks of size 2^( 3) =       0.000575234594
  error estimate for blocks of size 2^( 4) =       0.000589604707
  error estimate for blocks of size 2^( 5) =       0.000598358459
  error estimate for blocks of size 2^( 6) =       0.000603132666
  error estimate for blocks of size 2^( 7) =       0.000608249766

      target function =                  N/A
              le_mean =     -22.435915499581
             les_mean =     503.948002128380
             stat err =       0.000599836399
             autocorr =       1.245646118717
              std dev =       0.760064545210
             le_variance =       0.577698112885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577675751681
                                         uncertainty =       0.018853941915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577675751681
                                         uncertainty =       0.018853941915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537444951
  error estimate for blocks of size 2^( 2) =       0.000557413479
  error estimate for blocks of size 2^( 3) =       0.000575232981
  error estimate for blocks of size 2^( 4) =       0.000589603197
  error estimate for blocks of size 2^( 5) =       0.000598356953
  error estimate for blocks of size 2^( 6) =       0.000603131131
  error estimate for blocks of size 2^( 7) =       0.000608248159

      target function =                  N/A
              le_mean =     -22.435915524831
             les_mean =     503.947999298555
             stat err =       0.000599834860
             autocorr =       1.245648270404
              std dev =       0.760061938292
             le_variance =       0.577694150041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.435915528476        initial  <--
     2.2737e+01     2.2737e+02             7.4615e-06       -22.435915472185
     9.0949e+01     9.0949e+02             1.8833e-06       -22.435915499581
     3.6380e+02     3.6380e+03             4.7197e-07       -22.435915524831

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.7349
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.641310e-01 1 1  ON 0
 uu_1                 8.853137e-02 1 1  ON 1
 uu_2                -2.782852e-02 1 1  ON 2
 uu_3                -9.841916e-02 1 1  ON 3
 uu_4                -1.404264e-01 1 1  ON 4
 uu_5                -1.663339e-01 1 1  ON 5
 uu_6                -1.800046e-01 1 1  ON 6
 uu_7                -1.821206e-01 1 1  ON 7
 uu_8                -1.681296e-01 1 1  ON 8
 uu_9                -1.354494e-01 1 1  ON 9
 ud_0                 4.672586e-01 1 1  ON 10
 ud_1                 1.828495e-01 1 1  ON 11
 ud_2                 3.200907e-02 1 1  ON 12
 ud_3                -5.294462e-02 1 1  ON 13
 ud_4                -1.035046e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589794e-01 1 1  ON 16
 ud_7                -1.687587e-01 1 1  ON 17
 ud_8                -1.625721e-01 1 1  ON 18
 ud_9                -1.388625e-01 1 1  ON 19
 eC_0                -6.945157e-01 1 1  ON 20
 eC_1                -5.200247e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.211002e-02 1 1  ON 23
 eC_4                 1.597225e-01 1 1  ON 24
 eC_5                 2.842281e-01 1 1  ON 25
 eC_6                 2.996263e-01 1 1  ON 26
 eC_7                 3.355121e-01 1 1  ON 27
 eC_8                 2.666417e-01 1 1  ON 28
 eC_9                 6.868740e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348245e-01 1 1  ON 31
 eO_2                -3.452087e-01 1 1  ON 32
 eO_3                -2.201177e-02 1 1  ON 33
 eO_4                 2.025325e-01 1 1  ON 34
 eO_5                 3.449451e-01 1 1  ON 35
 eO_6                 3.881422e-01 1 1  ON 36
 eO_7                 4.283264e-01 1 1  ON 37
 eO_8                 4.829802e-01 1 1  ON 38
 eO_9                 4.033860e-01 1 1  ON 39
eH1_0                -1.610015e-01 1 1  ON 40
eH1_1                -6.110898e-02 1 1  ON 41
eH1_2                -4.182686e-02 1 1  ON 42
eH1_3                -4.203608e-02 1 1  ON 43
eH1_4                -6.070562e-03 1 1  ON 44
eH1_5                 4.175329e-03 1 1  ON 45
eH1_6                 3.504524e-02 1 1  ON 46
eH1_7                 4.295072e-02 1 1  ON 47
eH1_8                 3.258344e-02 1 1  ON 48
eH1_9                 7.840382e-02 1 1  ON 49
eH2_0                -1.675285e-01 1 1  ON 50
eH2_1                -6.710342e-02 1 1  ON 51
eH2_2                -4.841645e-02 1 1  ON 52
eH2_3                -4.863743e-02 1 1  ON 53
eH2_4                -1.299407e-02 1 1  ON 54
eH2_5                -2.780027e-03 1 1  ON 55
eH2_6                 2.824228e-02 1 1  ON 56
eH2_7                 3.893526e-02 1 1  ON 57
eH2_8                 2.793164e-02 1 1  ON 58
eH2_9                 9.287541e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2888e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.4508
    reference variance = 0.545107
====================================================
  Execution time = 4.5571e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5991e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5030e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559915851020
                                         uncertainty =       0.003916652419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559915851020
                                         uncertainty =       0.003916652419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529108013
  error estimate for blocks of size 2^( 2) =       0.000549525563
  error estimate for blocks of size 2^( 3) =       0.000568610759
  error estimate for blocks of size 2^( 4) =       0.000582551958
  error estimate for blocks of size 2^( 5) =       0.000591893780
  error estimate for blocks of size 2^( 6) =       0.000596736131
  error estimate for blocks of size 2^( 7) =       0.000595789196

      target function =                  N/A
              le_mean =     -22.438096286624
             les_mean =     504.028075267325
             stat err =       0.000591742766
             autocorr =       1.250769369122
              std dev =       0.748271728358
             le_variance =       0.559910579460


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243809628662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438096286624       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438096286799       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438096287786       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438096287320       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438096288248       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438096289334       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438096289367       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438096290193       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438096290777       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438096290654       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.2737e+02 is 7.499657e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438096286624       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438096286668       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438096286915       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438096286799       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438096287031       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438096287303       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438096287312       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438096287514       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438096287663       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438096287635       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+02 is 1.876162e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.438096286624       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.438096286635       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.438096286697       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.438096286668       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.438096286726       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.438096286794       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.438096286803       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.438096286843       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.438096286875       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.438096286864       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+03 is 4.691187e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315512 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0609e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.641310e-01 1 1  ON 0
 uu_1                 8.853137e-02 1 1  ON 1
 uu_2                -2.782842e-02 1 1  ON 2
 uu_3                -9.841915e-02 1 1  ON 3
 uu_4                -1.404263e-01 1 1  ON 4
 uu_5                -1.663339e-01 1 1  ON 5
 uu_6                -1.800046e-01 1 1  ON 6
 uu_7                -1.821204e-01 1 1  ON 7
 uu_8                -1.681297e-01 1 1  ON 8
 uu_9                -1.354495e-01 1 1  ON 9
 ud_0                 4.672587e-01 1 1  ON 10
 ud_1                 1.828495e-01 1 1  ON 11
 ud_2                 3.200917e-02 1 1  ON 12
 ud_3                -5.294454e-02 1 1  ON 13
 ud_4                -1.035047e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589793e-01 1 1  ON 16
 ud_7                -1.687586e-01 1 1  ON 17
 ud_8                -1.625722e-01 1 1  ON 18
 ud_9                -1.388625e-01 1 1  ON 19
 eC_0                -6.945158e-01 1 1  ON 20
 eC_1                -5.200248e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.211008e-02 1 1  ON 23
 eC_4                 1.597227e-01 1 1  ON 24
 eC_5                 2.842281e-01 1 1  ON 25
 eC_6                 2.996264e-01 1 1  ON 26
 eC_7                 3.355120e-01 1 1  ON 27
 eC_8                 2.666417e-01 1 1  ON 28
 eC_9                 6.868745e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348246e-01 1 1  ON 31
 eO_2                -3.452087e-01 1 1  ON 32
 eO_3                -2.201179e-02 1 1  ON 33
 eO_4                 2.025325e-01 1 1  ON 34
 eO_5                 3.449451e-01 1 1  ON 35
 eO_6                 3.881422e-01 1 1  ON 36
 eO_7                 4.283264e-01 1 1  ON 37
 eO_8                 4.829801e-01 1 1  ON 38
 eO_9                 4.033860e-01 1 1  ON 39
eH1_0                -1.610015e-01 1 1  ON 40
eH1_1                -6.110902e-02 1 1  ON 41
eH1_2                -4.182692e-02 1 1  ON 42
eH1_3                -4.203593e-02 1 1  ON 43
eH1_4                -6.070584e-03 1 1  ON 44
eH1_5                 4.175363e-03 1 1  ON 45
eH1_6                 3.504513e-02 1 1  ON 46
eH1_7                 4.295072e-02 1 1  ON 47
eH1_8                 3.258345e-02 1 1  ON 48
eH1_9                 7.840377e-02 1 1  ON 49
eH2_0                -1.675284e-01 1 1  ON 50
eH2_1                -6.710350e-02 1 1  ON 51
eH2_2                -4.841664e-02 1 1  ON 52
eH2_3                -4.863737e-02 1 1  ON 53
eH2_4                -1.299392e-02 1 1  ON 54
eH2_5                -2.780128e-03 1 1  ON 55
eH2_6                 2.824228e-02 1 1  ON 56
eH2_7                 3.893536e-02 1 1  ON 57
eH2_8                 2.793166e-02 1 1  ON 58
eH2_9                 9.287536e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.428
    reference variance = 0.622963
====================================================
  Execution time = 4.5315e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5537e-01
  Total weights = 2.0000e+06
  Execution time = 3.8498e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555132879702
                                         uncertainty =       0.003188838988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555132879702
                                         uncertainty =       0.003188838988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526956561
  error estimate for blocks of size 2^( 2) =       0.000546943134
  error estimate for blocks of size 2^( 3) =       0.000565726822
  error estimate for blocks of size 2^( 4) =       0.000580278342
  error estimate for blocks of size 2^( 5) =       0.000586829854
  error estimate for blocks of size 2^( 6) =       0.000591296271
  error estimate for blocks of size 2^( 7) =       0.000593868559

      target function =                  N/A
              le_mean =     -22.436978632087
             les_mean =     503.973376292536
             stat err =       0.000588068256
             autocorr =       1.245391341634
              std dev =       0.745229114761
             le_variance =       0.555366433488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555132456680
                                         uncertainty =       0.003188838677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555132456680
                                         uncertainty =       0.003188838677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526956360
  error estimate for blocks of size 2^( 2) =       0.000546942962
  error estimate for blocks of size 2^( 3) =       0.000565726673
  error estimate for blocks of size 2^( 4) =       0.000580278203
  error estimate for blocks of size 2^( 5) =       0.000586829726
  error estimate for blocks of size 2^( 6) =       0.000591296155
  error estimate for blocks of size 2^( 7) =       0.000593868443

      target function =                  N/A
              le_mean =     -22.436978637165
             les_mean =     503.973376098584
             stat err =       0.000588068132
             autocorr =       1.245391760052
              std dev =       0.745228831758
             le_variance =       0.555366011683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555132668056
                                         uncertainty =       0.003188838833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555132668056
                                         uncertainty =       0.003188838833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526956460
  error estimate for blocks of size 2^( 2) =       0.000546943048
  error estimate for blocks of size 2^( 3) =       0.000565726747
  error estimate for blocks of size 2^( 4) =       0.000580278272
  error estimate for blocks of size 2^( 5) =       0.000586829790
  error estimate for blocks of size 2^( 6) =       0.000591296213
  error estimate for blocks of size 2^( 7) =       0.000593868501

      target function =                  N/A
              le_mean =     -22.436978634630
             les_mean =     503.973376195626
             stat err =       0.000588068194
             autocorr =       1.245391551053
              std dev =       0.745228973170
             le_variance =       0.555366222452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555132853241
                                         uncertainty =       0.003188838968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.555132853241
                                         uncertainty =       0.003188838968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526956548
  error estimate for blocks of size 2^( 2) =       0.000546943123
  error estimate for blocks of size 2^( 3) =       0.000565726812
  error estimate for blocks of size 2^( 4) =       0.000580278333
  error estimate for blocks of size 2^( 5) =       0.000586829846
  error estimate for blocks of size 2^( 6) =       0.000591296263
  error estimate for blocks of size 2^( 7) =       0.000593868551

      target function =                  N/A
              le_mean =     -22.436978632405
             les_mean =     503.973376280420
             stat err =       0.000588068248
             autocorr =       1.245391367818
              std dev =       0.745229097059
             le_variance =       0.555366407104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436978632087        initial
     2.2737e+02     2.2737e+03             7.4997e-07       -22.436978637165  <--
     9.0949e+02     9.0949e+03             1.8762e-07       -22.436978634630
     3.6380e+03     3.6380e+04             4.6912e-08       -22.436978632405

*****************************************************************************
Applying the update for shift_i =   2.2737e+02     and shift_s =   2.2737e+03
*****************************************************************************

  Execution time = 6.4568e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.641312e-01 1 1  ON 0
 uu_1                 8.853138e-02 1 1  ON 1
 uu_2                -2.782811e-02 1 1  ON 2
 uu_3                -9.841910e-02 1 1  ON 3
 uu_4                -1.404261e-01 1 1  ON 4
 uu_5                -1.663338e-01 1 1  ON 5
 uu_6                -1.800045e-01 1 1  ON 6
 uu_7                -1.821200e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354499e-01 1 1  ON 9
 ud_0                 4.672589e-01 1 1  ON 10
 ud_1                 1.828495e-01 1 1  ON 11
 ud_2                 3.200950e-02 1 1  ON 12
 ud_3                -5.294428e-02 1 1  ON 13
 ud_4                -1.035047e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589791e-01 1 1  ON 16
 ud_7                -1.687584e-01 1 1  ON 17
 ud_8                -1.625722e-01 1 1  ON 18
 ud_9                -1.388626e-01 1 1  ON 19
 eC_0                -6.945162e-01 1 1  ON 20
 eC_1                -5.200250e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.211027e-02 1 1  ON 23
 eC_4                 1.597231e-01 1 1  ON 24
 eC_5                 2.842280e-01 1 1  ON 25
 eC_6                 2.996265e-01 1 1  ON 26
 eC_7                 3.355116e-01 1 1  ON 27
 eC_8                 2.666418e-01 1 1  ON 28
 eC_9                 6.868760e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348251e-01 1 1  ON 31
 eO_2                -3.452088e-01 1 1  ON 32
 eO_3                -2.201183e-02 1 1  ON 33
 eO_4                 2.025324e-01 1 1  ON 34
 eO_5                 3.449453e-01 1 1  ON 35
 eO_6                 3.881423e-01 1 1  ON 36
 eO_7                 4.283266e-01 1 1  ON 37
 eO_8                 4.829798e-01 1 1  ON 38
 eO_9                 4.033861e-01 1 1  ON 39
eH1_0                -1.610014e-01 1 1  ON 40
eH1_1                -6.110913e-02 1 1  ON 41
eH1_2                -4.182707e-02 1 1  ON 42
eH1_3                -4.203546e-02 1 1  ON 43
eH1_4                -6.070652e-03 1 1  ON 44
eH1_5                 4.175465e-03 1 1  ON 45
eH1_6                 3.504477e-02 1 1  ON 46
eH1_7                 4.295074e-02 1 1  ON 47
eH1_8                 3.258349e-02 1 1  ON 48
eH1_9                 7.840362e-02 1 1  ON 49
eH2_0                -1.675283e-01 1 1  ON 50
eH2_1                -6.710372e-02 1 1  ON 51
eH2_2                -4.841720e-02 1 1  ON 52
eH2_3                -4.863719e-02 1 1  ON 53
eH2_4                -1.299348e-02 1 1  ON 54
eH2_5                -2.780431e-03 1 1  ON 55
eH2_6                 2.824225e-02 1 1  ON 56
eH2_7                 3.893565e-02 1 1  ON 57
eH2_8                 2.793169e-02 1 1  ON 58
eH2_9                 9.287520e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2522e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2441e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.4264
    reference variance = 0.512517
====================================================
  Execution time = 4.4842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6087e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5360e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560932099888
                                         uncertainty =       0.003897137317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560932099888
                                         uncertainty =       0.003897137317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529560818
  error estimate for blocks of size 2^( 2) =       0.000549353113
  error estimate for blocks of size 2^( 3) =       0.000567871701
  error estimate for blocks of size 2^( 4) =       0.000581277603
  error estimate for blocks of size 2^( 5) =       0.000589464790
  error estimate for blocks of size 2^( 6) =       0.000595378869
  error estimate for blocks of size 2^( 7) =       0.000594624942

      target function =                  N/A
              le_mean =     -22.435944719158
             les_mean =     503.932484481291
             stat err =       0.000590186551
             autocorr =       1.242072446939
              std dev =       0.748912091383
             le_variance =       0.560869320620


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243594471916e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435944719158       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435944735099       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435944743393       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435944740578       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435944733486       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435944732657       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435944732864       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435944736170       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435944737717       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.6843e+01 is 3.285888e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435944719158       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435944723152       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435944725229       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435944724523       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435944722730       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435944722499       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435944722553       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435944723388       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435944723771       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.2737e+02 is 8.231675e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435944719158       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435944720157       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435944720676       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435944720500       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435944720050       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435944719992       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435944720004       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435944720214       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435944720311       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+02 is 2.058983e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318590 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0208e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.641315e-01 1 1  ON 0
 uu_1                 8.853168e-02 1 1  ON 1
 uu_2                -2.782860e-02 1 1  ON 2
 uu_3                -9.841918e-02 1 1  ON 3
 uu_4                -1.404263e-01 1 1  ON 4
 uu_5                -1.663337e-01 1 1  ON 5
 uu_6                -1.800043e-01 1 1  ON 6
 uu_7                -1.821194e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354499e-01 1 1  ON 9
 ud_0                 4.672588e-01 1 1  ON 10
 ud_1                 1.828499e-01 1 1  ON 11
 ud_2                 3.200959e-02 1 1  ON 12
 ud_3                -5.294399e-02 1 1  ON 13
 ud_4                -1.035044e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589791e-01 1 1  ON 16
 ud_7                -1.687590e-01 1 1  ON 17
 ud_8                -1.625717e-01 1 1  ON 18
 ud_9                -1.388622e-01 1 1  ON 19
 eC_0                -6.945157e-01 1 1  ON 20
 eC_1                -5.200251e-01 1 1  ON 21
 eC_2                -2.124578e-01 1 1  ON 22
 eC_3                 1.210973e-02 1 1  ON 23
 eC_4                 1.597235e-01 1 1  ON 24
 eC_5                 2.842274e-01 1 1  ON 25
 eC_6                 2.996266e-01 1 1  ON 26
 eC_7                 3.355117e-01 1 1  ON 27
 eC_8                 2.666421e-01 1 1  ON 28
 eC_9                 6.868780e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348253e-01 1 1  ON 31
 eO_2                -3.452081e-01 1 1  ON 32
 eO_3                -2.201220e-02 1 1  ON 33
 eO_4                 2.025317e-01 1 1  ON 34
 eO_5                 3.449453e-01 1 1  ON 35
 eO_6                 3.881420e-01 1 1  ON 36
 eO_7                 4.283267e-01 1 1  ON 37
 eO_8                 4.829795e-01 1 1  ON 38
 eO_9                 4.033865e-01 1 1  ON 39
eH1_0                -1.610017e-01 1 1  ON 40
eH1_1                -6.110902e-02 1 1  ON 41
eH1_2                -4.182731e-02 1 1  ON 42
eH1_3                -4.203503e-02 1 1  ON 43
eH1_4                -6.070606e-03 1 1  ON 44
eH1_5                 4.175327e-03 1 1  ON 45
eH1_6                 3.504460e-02 1 1  ON 46
eH1_7                 4.295053e-02 1 1  ON 47
eH1_8                 3.258369e-02 1 1  ON 48
eH1_9                 7.840358e-02 1 1  ON 49
eH2_0                -1.675278e-01 1 1  ON 50
eH2_1                -6.710415e-02 1 1  ON 51
eH2_2                -4.841803e-02 1 1  ON 52
eH2_3                -4.863698e-02 1 1  ON 53
eH2_4                -1.299292e-02 1 1  ON 54
eH2_5                -2.780629e-03 1 1  ON 55
eH2_6                 2.824232e-02 1 1  ON 56
eH2_7                 3.893550e-02 1 1  ON 57
eH2_8                 2.793179e-02 1 1  ON 58
eH2_9                 9.287512e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.5313
    reference variance = 0.615083
====================================================
  Execution time = 4.6743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5781e-01
  Total weights = 2.0000e+06
  Execution time = 3.8384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557670525909
                                         uncertainty =       0.003226032695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557670525909
                                         uncertainty =       0.003226032695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528116622
  error estimate for blocks of size 2^( 2) =       0.000548092561
  error estimate for blocks of size 2^( 3) =       0.000566824521
  error estimate for blocks of size 2^( 4) =       0.000580797374
  error estimate for blocks of size 2^( 5) =       0.000589062268
  error estimate for blocks of size 2^( 6) =       0.000594349126
  error estimate for blocks of size 2^( 7) =       0.000596404967

      target function =                  N/A
              le_mean =     -22.437231782983
             les_mean =     503.987184136813
             stat err =       0.000590153434
             autocorr =       1.248734766521
              std dev =       0.746869689061
             le_variance =       0.557814332437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557671708786
                                         uncertainty =       0.003226042705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557671708786
                                         uncertainty =       0.003226042705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528117182
  error estimate for blocks of size 2^( 2) =       0.000548093142
  error estimate for blocks of size 2^( 3) =       0.000566825060
  error estimate for blocks of size 2^( 4) =       0.000580797929
  error estimate for blocks of size 2^( 5) =       0.000589062821
  error estimate for blocks of size 2^( 6) =       0.000594349652
  error estimate for blocks of size 2^( 7) =       0.000596405503

      target function =                  N/A
              le_mean =     -22.437231771370
             les_mean =     503.987184798475
             stat err =       0.000590153976
             autocorr =       1.248734415843
              std dev =       0.746870480864
             le_variance =       0.557815515186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557671118910
                                         uncertainty =       0.003226037738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557671118910
                                         uncertainty =       0.003226037738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528116902
  error estimate for blocks of size 2^( 2) =       0.000548092853
  error estimate for blocks of size 2^( 3) =       0.000566824791
  error estimate for blocks of size 2^( 4) =       0.000580797652
  error estimate for blocks of size 2^( 5) =       0.000589062545
  error estimate for blocks of size 2^( 6) =       0.000594349389
  error estimate for blocks of size 2^( 7) =       0.000596405236

      target function =                  N/A
              le_mean =     -22.437231777156
             les_mean =     503.987184468295
             stat err =       0.000590153706
             autocorr =       1.248734590479
              std dev =       0.746870086007
             le_variance =       0.557814925372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557670600072
                                         uncertainty =       0.003226033326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557670600072
                                         uncertainty =       0.003226033326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528116657
  error estimate for blocks of size 2^( 2) =       0.000548092598
  error estimate for blocks of size 2^( 3) =       0.000566824554
  error estimate for blocks of size 2^( 4) =       0.000580797408
  error estimate for blocks of size 2^( 5) =       0.000589062302
  error estimate for blocks of size 2^( 6) =       0.000594349159
  error estimate for blocks of size 2^( 7) =       0.000596405001

      target function =                  N/A
              le_mean =     -22.437231782252
             les_mean =     503.987184178186
             stat err =       0.000590153468
             autocorr =       1.248734744495
              std dev =       0.746869738704
             le_variance =       0.557814406592


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437231782983        initial  <--
     5.6843e+01     5.6843e+02             3.2859e-06       -22.437231771370
     2.2737e+02     2.2737e+03             8.2317e-07       -22.437231777156
     9.0949e+02     9.0949e+03             2.0590e-07       -22.437231782252

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.9889
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.641312e-01 1 1  ON 0
 uu_1                 8.853138e-02 1 1  ON 1
 uu_2                -2.782811e-02 1 1  ON 2
 uu_3                -9.841910e-02 1 1  ON 3
 uu_4                -1.404261e-01 1 1  ON 4
 uu_5                -1.663338e-01 1 1  ON 5
 uu_6                -1.800045e-01 1 1  ON 6
 uu_7                -1.821200e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354499e-01 1 1  ON 9
 ud_0                 4.672589e-01 1 1  ON 10
 ud_1                 1.828495e-01 1 1  ON 11
 ud_2                 3.200950e-02 1 1  ON 12
 ud_3                -5.294428e-02 1 1  ON 13
 ud_4                -1.035047e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589791e-01 1 1  ON 16
 ud_7                -1.687584e-01 1 1  ON 17
 ud_8                -1.625722e-01 1 1  ON 18
 ud_9                -1.388626e-01 1 1  ON 19
 eC_0                -6.945162e-01 1 1  ON 20
 eC_1                -5.200250e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.211027e-02 1 1  ON 23
 eC_4                 1.597231e-01 1 1  ON 24
 eC_5                 2.842280e-01 1 1  ON 25
 eC_6                 2.996265e-01 1 1  ON 26
 eC_7                 3.355116e-01 1 1  ON 27
 eC_8                 2.666418e-01 1 1  ON 28
 eC_9                 6.868760e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348251e-01 1 1  ON 31
 eO_2                -3.452088e-01 1 1  ON 32
 eO_3                -2.201183e-02 1 1  ON 33
 eO_4                 2.025324e-01 1 1  ON 34
 eO_5                 3.449453e-01 1 1  ON 35
 eO_6                 3.881423e-01 1 1  ON 36
 eO_7                 4.283266e-01 1 1  ON 37
 eO_8                 4.829798e-01 1 1  ON 38
 eO_9                 4.033861e-01 1 1  ON 39
eH1_0                -1.610014e-01 1 1  ON 40
eH1_1                -6.110913e-02 1 1  ON 41
eH1_2                -4.182707e-02 1 1  ON 42
eH1_3                -4.203546e-02 1 1  ON 43
eH1_4                -6.070652e-03 1 1  ON 44
eH1_5                 4.175465e-03 1 1  ON 45
eH1_6                 3.504477e-02 1 1  ON 46
eH1_7                 4.295074e-02 1 1  ON 47
eH1_8                 3.258349e-02 1 1  ON 48
eH1_9                 7.840362e-02 1 1  ON 49
eH2_0                -1.675283e-01 1 1  ON 50
eH2_1                -6.710372e-02 1 1  ON 51
eH2_2                -4.841720e-02 1 1  ON 52
eH2_3                -4.863719e-02 1 1  ON 53
eH2_4                -1.299348e-02 1 1  ON 54
eH2_5                -2.780431e-03 1 1  ON 55
eH2_6                 2.824225e-02 1 1  ON 56
eH2_7                 3.893565e-02 1 1  ON 57
eH2_8                 2.793169e-02 1 1  ON 58
eH2_9                 9.287520e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2620e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.4088
    reference variance = 0.45025
====================================================
  Execution time = 4.5172e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6142e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5261e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561509213208
                                         uncertainty =       0.003882271784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561509213208
                                         uncertainty =       0.003882271784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529820018
  error estimate for blocks of size 2^( 2) =       0.000550545452
  error estimate for blocks of size 2^( 3) =       0.000569159232
  error estimate for blocks of size 2^( 4) =       0.000584319563
  error estimate for blocks of size 2^( 5) =       0.000593617645
  error estimate for blocks of size 2^( 6) =       0.000597635104
  error estimate for blocks of size 2^( 7) =       0.000601184319

      target function =                  N/A
              le_mean =     -22.436588003056
             les_mean =     503.961899441967
             stat err =       0.000594189158
             autocorr =       1.257745345819
              std dev =       0.749278655640
             le_variance =       0.561418503798


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243658800306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436588003056       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436588003871       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436588003463       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436588004066       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436588004892       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436588004695       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436588005050       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436588004834       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436588004746       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436588004777       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.6843e+02 is 2.995838e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436588003056       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436588003260       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436588003158       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436588003309       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436588003515       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436588003466       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436588003557       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436588003502       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436588003481       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436588003492       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.2737e+03 is 7.490128e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.436588003056       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.436588003107       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.436588003081       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.436588003115       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.436588003165       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.436588003160       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.436588003179       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.436588003150       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.436588003166       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.436588003145       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+03 is 1.872565e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.322171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0440e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.641312e-01 1 1  ON 0
 uu_1                 8.853140e-02 1 1  ON 1
 uu_2                -2.782814e-02 1 1  ON 2
 uu_3                -9.841909e-02 1 1  ON 3
 uu_4                -1.404261e-01 1 1  ON 4
 uu_5                -1.663338e-01 1 1  ON 5
 uu_6                -1.800045e-01 1 1  ON 6
 uu_7                -1.821199e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354499e-01 1 1  ON 9
 ud_0                 4.672590e-01 1 1  ON 10
 ud_1                 1.828495e-01 1 1  ON 11
 ud_2                 3.200952e-02 1 1  ON 12
 ud_3                -5.294426e-02 1 1  ON 13
 ud_4                -1.035047e-01 1 1  ON 14
 ud_5                -1.373827e-01 1 1  ON 15
 ud_6                -1.589792e-01 1 1  ON 16
 ud_7                -1.687584e-01 1 1  ON 17
 ud_8                -1.625722e-01 1 1  ON 18
 ud_9                -1.388626e-01 1 1  ON 19
 eC_0                -6.945162e-01 1 1  ON 20
 eC_1                -5.200250e-01 1 1  ON 21
 eC_2                -2.124575e-01 1 1  ON 22
 eC_3                 1.211030e-02 1 1  ON 23
 eC_4                 1.597231e-01 1 1  ON 24
 eC_5                 2.842280e-01 1 1  ON 25
 eC_6                 2.996265e-01 1 1  ON 26
 eC_7                 3.355116e-01 1 1  ON 27
 eC_8                 2.666418e-01 1 1  ON 28
 eC_9                 6.868761e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348252e-01 1 1  ON 31
 eO_2                -3.452088e-01 1 1  ON 32
 eO_3                -2.201185e-02 1 1  ON 33
 eO_4                 2.025324e-01 1 1  ON 34
 eO_5                 3.449453e-01 1 1  ON 35
 eO_6                 3.881422e-01 1 1  ON 36
 eO_7                 4.283266e-01 1 1  ON 37
 eO_8                 4.829798e-01 1 1  ON 38
 eO_9                 4.033861e-01 1 1  ON 39
eH1_0                -1.610014e-01 1 1  ON 40
eH1_1                -6.110906e-02 1 1  ON 41
eH1_2                -4.182708e-02 1 1  ON 42
eH1_3                -4.203543e-02 1 1  ON 43
eH1_4                -6.070664e-03 1 1  ON 44
eH1_5                 4.175470e-03 1 1  ON 45
eH1_6                 3.504473e-02 1 1  ON 46
eH1_7                 4.295068e-02 1 1  ON 47
eH1_8                 3.258349e-02 1 1  ON 48
eH1_9                 7.840361e-02 1 1  ON 49
eH2_0                -1.675283e-01 1 1  ON 50
eH2_1                -6.710372e-02 1 1  ON 51
eH2_2                -4.841721e-02 1 1  ON 52
eH2_3                -4.863721e-02 1 1  ON 53
eH2_4                -1.299346e-02 1 1  ON 54
eH2_5                -2.780436e-03 1 1  ON 55
eH2_6                 2.824223e-02 1 1  ON 56
eH2_7                 3.893568e-02 1 1  ON 57
eH2_8                 2.793173e-02 1 1  ON 58
eH2_9                 9.287519e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.3628
    reference variance = 0.444328
====================================================
  Execution time = 4.5117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2438e+01
  VMC Evar = 5.5960e-01
  Total weights = 2.0000e+06
  Execution time = 3.8425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559639445399
                                         uncertainty =       0.003875222048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559639445399
                                         uncertainty =       0.003875222048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528962880
  error estimate for blocks of size 2^( 2) =       0.000549306918
  error estimate for blocks of size 2^( 3) =       0.000567508439
  error estimate for blocks of size 2^( 4) =       0.000581368576
  error estimate for blocks of size 2^( 5) =       0.000590540150
  error estimate for blocks of size 2^( 6) =       0.000594755960
  error estimate for blocks of size 2^( 7) =       0.000601105066

      target function =                  N/A
              le_mean =     -22.437836661705
             les_mean =     504.016117234611
             stat err =       0.000591942438
             autocorr =       1.252300519786
              std dev =       0.748066479030
             le_variance =       0.559603457048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559639607407
                                         uncertainty =       0.003875223828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559639607407
                                         uncertainty =       0.003875223828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528962957
  error estimate for blocks of size 2^( 2) =       0.000549306991
  error estimate for blocks of size 2^( 3) =       0.000567508511
  error estimate for blocks of size 2^( 4) =       0.000581368644
  error estimate for blocks of size 2^( 5) =       0.000590540213
  error estimate for blocks of size 2^( 6) =       0.000594756022
  error estimate for blocks of size 2^( 7) =       0.000601105132

      target function =                  N/A
              le_mean =     -22.437836660604
             les_mean =     504.016117347161
             stat err =       0.000591942503
             autocorr =       1.252300431309
              std dev =       0.748066587302
             le_variance =       0.559603619038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559639526495
                                         uncertainty =       0.003875222939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559639526495
                                         uncertainty =       0.003875222939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528962918
  error estimate for blocks of size 2^( 2) =       0.000549306954
  error estimate for blocks of size 2^( 3) =       0.000567508475
  error estimate for blocks of size 2^( 4) =       0.000581368610
  error estimate for blocks of size 2^( 5) =       0.000590540182
  error estimate for blocks of size 2^( 6) =       0.000594755991
  error estimate for blocks of size 2^( 7) =       0.000601105099

      target function =                  N/A
              le_mean =     -22.437836661154
             les_mean =     504.016117290953
             stat err =       0.000591942471
             autocorr =       1.252300475504
              std dev =       0.748066533227
             le_variance =       0.559603538134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559639455539
                                         uncertainty =       0.003875222159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559639455539
                                         uncertainty =       0.003875222159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528962885
  error estimate for blocks of size 2^( 2) =       0.000549306923
  error estimate for blocks of size 2^( 3) =       0.000567508444
  error estimate for blocks of size 2^( 4) =       0.000581368580
  error estimate for blocks of size 2^( 5) =       0.000590540154
  error estimate for blocks of size 2^( 6) =       0.000594755964
  error estimate for blocks of size 2^( 7) =       0.000601105071

      target function =                  N/A
              le_mean =     -22.437836661636
             les_mean =     504.016117241655
             stat err =       0.000591942442
             autocorr =       1.252300514254
              std dev =       0.748066485806
             le_variance =       0.559603467186


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.437836661705        initial  <--
     5.6843e+02     5.6843e+03             2.9958e-07       -22.437836660604
     2.2737e+03     2.2737e+04             7.4901e-08       -22.437836661154
     9.0949e+03     9.0949e+04             1.8726e-08       -22.437836661636

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3682
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.641312e-01 1 1  ON 0
 uu_1                 8.853138e-02 1 1  ON 1
 uu_2                -2.782811e-02 1 1  ON 2
 uu_3                -9.841910e-02 1 1  ON 3
 uu_4                -1.404261e-01 1 1  ON 4
 uu_5                -1.663338e-01 1 1  ON 5
 uu_6                -1.800045e-01 1 1  ON 6
 uu_7                -1.821200e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354499e-01 1 1  ON 9
 ud_0                 4.672589e-01 1 1  ON 10
 ud_1                 1.828495e-01 1 1  ON 11
 ud_2                 3.200950e-02 1 1  ON 12
 ud_3                -5.294428e-02 1 1  ON 13
 ud_4                -1.035047e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589791e-01 1 1  ON 16
 ud_7                -1.687584e-01 1 1  ON 17
 ud_8                -1.625722e-01 1 1  ON 18
 ud_9                -1.388626e-01 1 1  ON 19
 eC_0                -6.945162e-01 1 1  ON 20
 eC_1                -5.200250e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.211027e-02 1 1  ON 23
 eC_4                 1.597231e-01 1 1  ON 24
 eC_5                 2.842280e-01 1 1  ON 25
 eC_6                 2.996265e-01 1 1  ON 26
 eC_7                 3.355116e-01 1 1  ON 27
 eC_8                 2.666418e-01 1 1  ON 28
 eC_9                 6.868760e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348251e-01 1 1  ON 31
 eO_2                -3.452088e-01 1 1  ON 32
 eO_3                -2.201183e-02 1 1  ON 33
 eO_4                 2.025324e-01 1 1  ON 34
 eO_5                 3.449453e-01 1 1  ON 35
 eO_6                 3.881423e-01 1 1  ON 36
 eO_7                 4.283266e-01 1 1  ON 37
 eO_8                 4.829798e-01 1 1  ON 38
 eO_9                 4.033861e-01 1 1  ON 39
eH1_0                -1.610014e-01 1 1  ON 40
eH1_1                -6.110913e-02 1 1  ON 41
eH1_2                -4.182707e-02 1 1  ON 42
eH1_3                -4.203546e-02 1 1  ON 43
eH1_4                -6.070652e-03 1 1  ON 44
eH1_5                 4.175465e-03 1 1  ON 45
eH1_6                 3.504477e-02 1 1  ON 46
eH1_7                 4.295074e-02 1 1  ON 47
eH1_8                 3.258349e-02 1 1  ON 48
eH1_9                 7.840362e-02 1 1  ON 49
eH2_0                -1.675283e-01 1 1  ON 50
eH2_1                -6.710372e-02 1 1  ON 51
eH2_2                -4.841720e-02 1 1  ON 52
eH2_3                -4.863719e-02 1 1  ON 53
eH2_4                -1.299348e-02 1 1  ON 54
eH2_5                -2.780431e-03 1 1  ON 55
eH2_6                 2.824225e-02 1 1  ON 56
eH2_7                 3.893565e-02 1 1  ON 57
eH2_8                 2.793169e-02 1 1  ON 58
eH2_9                 9.287520e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2481e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2441e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.4366
    reference variance = 0.272299
====================================================
  Execution time = 4.5588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5981e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5068e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559806609433
                                         uncertainty =       0.003734368863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559806609433
                                         uncertainty =       0.003734368863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529060025
  error estimate for blocks of size 2^( 2) =       0.000549272252
  error estimate for blocks of size 2^( 3) =       0.000567532732
  error estimate for blocks of size 2^( 4) =       0.000581526599
  error estimate for blocks of size 2^( 5) =       0.000591168321
  error estimate for blocks of size 2^( 6) =       0.000595754054
  error estimate for blocks of size 2^( 7) =       0.000598874100

      target function =                  N/A
              le_mean =     -22.437448643651
             les_mean =     503.998910376285
             stat err =       0.000591830768
             autocorr =       1.251368399086
              std dev =       0.748203862406
             le_variance =       0.559809019720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243744864365e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437448643651       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437448643838       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437448644042       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437448644105       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437448644172       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437448644217       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437448644215       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437448644297       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437448644332       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437448644318       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.6843e+03 is 4.267984e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437448643651       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437448643698       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437448643749       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437448643764       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437448643772       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437448643782       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437448643812       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437448643804       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437448643840       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437448643793       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.2737e+04 is 1.067040e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.437448643651       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.437448643663       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.437448643675       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.437448643654       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.437448643695       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.437448643731       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.437448643652       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.437448643634       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.437448643731       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.437448643769       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+04 is 2.667628e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.325771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0663e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.641312e-01 1 1  ON 0
 uu_1                 8.853138e-02 1 1  ON 1
 uu_2                -2.782811e-02 1 1  ON 2
 uu_3                -9.841909e-02 1 1  ON 3
 uu_4                -1.404261e-01 1 1  ON 4
 uu_5                -1.663338e-01 1 1  ON 5
 uu_6                -1.800045e-01 1 1  ON 6
 uu_7                -1.821200e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354499e-01 1 1  ON 9
 ud_0                 4.672589e-01 1 1  ON 10
 ud_1                 1.828495e-01 1 1  ON 11
 ud_2                 3.200951e-02 1 1  ON 12
 ud_3                -5.294428e-02 1 1  ON 13
 ud_4                -1.035047e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589791e-01 1 1  ON 16
 ud_7                -1.687584e-01 1 1  ON 17
 ud_8                -1.625722e-01 1 1  ON 18
 ud_9                -1.388626e-01 1 1  ON 19
 eC_0                -6.945162e-01 1 1  ON 20
 eC_1                -5.200250e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.211027e-02 1 1  ON 23
 eC_4                 1.597231e-01 1 1  ON 24
 eC_5                 2.842280e-01 1 1  ON 25
 eC_6                 2.996265e-01 1 1  ON 26
 eC_7                 3.355116e-01 1 1  ON 27
 eC_8                 2.666418e-01 1 1  ON 28
 eC_9                 6.868760e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348251e-01 1 1  ON 31
 eO_2                -3.452088e-01 1 1  ON 32
 eO_3                -2.201183e-02 1 1  ON 33
 eO_4                 2.025324e-01 1 1  ON 34
 eO_5                 3.449453e-01 1 1  ON 35
 eO_6                 3.881422e-01 1 1  ON 36
 eO_7                 4.283266e-01 1 1  ON 37
 eO_8                 4.829798e-01 1 1  ON 38
 eO_9                 4.033861e-01 1 1  ON 39
eH1_0                -1.610014e-01 1 1  ON 40
eH1_1                -6.110913e-02 1 1  ON 41
eH1_2                -4.182708e-02 1 1  ON 42
eH1_3                -4.203546e-02 1 1  ON 43
eH1_4                -6.070654e-03 1 1  ON 44
eH1_5                 4.175459e-03 1 1  ON 45
eH1_6                 3.504478e-02 1 1  ON 46
eH1_7                 4.295075e-02 1 1  ON 47
eH1_8                 3.258349e-02 1 1  ON 48
eH1_9                 7.840362e-02 1 1  ON 49
eH2_0                -1.675283e-01 1 1  ON 50
eH2_1                -6.710372e-02 1 1  ON 51
eH2_2                -4.841721e-02 1 1  ON 52
eH2_3                -4.863719e-02 1 1  ON 53
eH2_4                -1.299348e-02 1 1  ON 54
eH2_5                -2.780427e-03 1 1  ON 55
eH2_6                 2.824225e-02 1 1  ON 56
eH2_7                 3.893565e-02 1 1  ON 57
eH2_8                 2.793170e-02 1 1  ON 58
eH2_9                 9.287520e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.5024
    reference variance = 0.454971
====================================================
  Execution time = 4.6100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.6064e-01
  Total weights = 2.0000e+06
  Execution time = 3.8432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560617404202
                                         uncertainty =       0.004696871358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560617404202
                                         uncertainty =       0.004696871358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529454091
  error estimate for blocks of size 2^( 2) =       0.000549580447
  error estimate for blocks of size 2^( 3) =       0.000567884659
  error estimate for blocks of size 2^( 4) =       0.000582189730
  error estimate for blocks of size 2^( 5) =       0.000591459495
  error estimate for blocks of size 2^( 6) =       0.000596783531
  error estimate for blocks of size 2^( 7) =       0.000603158747

      target function =                  N/A
              le_mean =     -22.436599514855
             les_mean =     503.961640778160
             stat err =       0.000593397876
             autocorr =       1.256132228363
              std dev =       0.748761155841
             le_variance =       0.560643268497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560617374691
                                         uncertainty =       0.004696871120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560617374691
                                         uncertainty =       0.004696871120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529454077
  error estimate for blocks of size 2^( 2) =       0.000549580434
  error estimate for blocks of size 2^( 3) =       0.000567884648
  error estimate for blocks of size 2^( 4) =       0.000582189719
  error estimate for blocks of size 2^( 5) =       0.000591459484
  error estimate for blocks of size 2^( 6) =       0.000596783520
  error estimate for blocks of size 2^( 7) =       0.000603158735

      target function =                  N/A
              le_mean =     -22.436599515175
             les_mean =     503.961640762971
             stat err =       0.000593397865
             autocorr =       1.256132246741
              std dev =       0.748761136120
             le_variance =       0.560643238963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560617389446
                                         uncertainty =       0.004696871239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560617389446
                                         uncertainty =       0.004696871239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529454084
  error estimate for blocks of size 2^( 2) =       0.000549580440
  error estimate for blocks of size 2^( 3) =       0.000567884653
  error estimate for blocks of size 2^( 4) =       0.000582189725
  error estimate for blocks of size 2^( 5) =       0.000591459490
  error estimate for blocks of size 2^( 6) =       0.000596783525
  error estimate for blocks of size 2^( 7) =       0.000603158741

      target function =                  N/A
              le_mean =     -22.436599515015
             les_mean =     503.961640770565
             stat err =       0.000593397870
             autocorr =       1.256132237546
              std dev =       0.748761145980
             le_variance =       0.560643253730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560617402358
                                         uncertainty =       0.004696871343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560617402358
                                         uncertainty =       0.004696871343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529454090
  error estimate for blocks of size 2^( 2) =       0.000549580446
  error estimate for blocks of size 2^( 3) =       0.000567884659
  error estimate for blocks of size 2^( 4) =       0.000582189729
  error estimate for blocks of size 2^( 5) =       0.000591459494
  error estimate for blocks of size 2^( 6) =       0.000596783530
  error estimate for blocks of size 2^( 7) =       0.000603158746

      target function =                  N/A
              le_mean =     -22.436599514875
             les_mean =     503.961640777210
             stat err =       0.000593397875
             autocorr =       1.256132229509
              std dev =       0.748761154609
             le_variance =       0.560643266651


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436599514855        initial
     5.6843e+03     5.6843e+04             4.2680e-08       -22.436599515175  <--
     2.2737e+04     2.2737e+05             1.0670e-08       -22.436599515015
     9.0949e+04     9.0949e+05             2.6676e-09       -22.436599514875

*****************************************************************************
Applying the update for shift_i =   5.6843e+03     and shift_s =   5.6843e+04
*****************************************************************************

  Execution time = 6.5391e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.641311e-01 1 1  ON 0
 uu_1                 8.853139e-02 1 1  ON 1
 uu_2                -2.782811e-02 1 1  ON 2
 uu_3                -9.841908e-02 1 1  ON 3
 uu_4                -1.404261e-01 1 1  ON 4
 uu_5                -1.663337e-01 1 1  ON 5
 uu_6                -1.800045e-01 1 1  ON 6
 uu_7                -1.821200e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354499e-01 1 1  ON 9
 ud_0                 4.672589e-01 1 1  ON 10
 ud_1                 1.828495e-01 1 1  ON 11
 ud_2                 3.200952e-02 1 1  ON 12
 ud_3                -5.294427e-02 1 1  ON 13
 ud_4                -1.035046e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589791e-01 1 1  ON 16
 ud_7                -1.687584e-01 1 1  ON 17
 ud_8                -1.625722e-01 1 1  ON 18
 ud_9                -1.388626e-01 1 1  ON 19
 eC_0                -6.945162e-01 1 1  ON 20
 eC_1                -5.200250e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.211028e-02 1 1  ON 23
 eC_4                 1.597231e-01 1 1  ON 24
 eC_5                 2.842280e-01 1 1  ON 25
 eC_6                 2.996265e-01 1 1  ON 26
 eC_7                 3.355116e-01 1 1  ON 27
 eC_8                 2.666418e-01 1 1  ON 28
 eC_9                 6.868761e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348251e-01 1 1  ON 31
 eO_2                -3.452088e-01 1 1  ON 32
 eO_3                -2.201183e-02 1 1  ON 33
 eO_4                 2.025324e-01 1 1  ON 34
 eO_5                 3.449453e-01 1 1  ON 35
 eO_6                 3.881422e-01 1 1  ON 36
 eO_7                 4.283266e-01 1 1  ON 37
 eO_8                 4.829798e-01 1 1  ON 38
 eO_9                 4.033861e-01 1 1  ON 39
eH1_0                -1.610014e-01 1 1  ON 40
eH1_1                -6.110913e-02 1 1  ON 41
eH1_2                -4.182710e-02 1 1  ON 42
eH1_3                -4.203546e-02 1 1  ON 43
eH1_4                -6.070660e-03 1 1  ON 44
eH1_5                 4.175443e-03 1 1  ON 45
eH1_6                 3.504479e-02 1 1  ON 46
eH1_7                 4.295076e-02 1 1  ON 47
eH1_8                 3.258350e-02 1 1  ON 48
eH1_9                 7.840362e-02 1 1  ON 49
eH2_0                -1.675283e-01 1 1  ON 50
eH2_1                -6.710373e-02 1 1  ON 51
eH2_2                -4.841724e-02 1 1  ON 52
eH2_3                -4.863718e-02 1 1  ON 53
eH2_4                -1.299347e-02 1 1  ON 54
eH2_5                -2.780416e-03 1 1  ON 55
eH2_6                 2.824226e-02 1 1  ON 56
eH2_7                 3.893564e-02 1 1  ON 57
eH2_8                 2.793170e-02 1 1  ON 58
eH2_9                 9.287520e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2606e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2442e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.4516
    reference variance = 0.56486
====================================================
  Execution time = 4.7707e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2436e+01
  VMC Evar = 5.6383e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4957e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563467427742
                                         uncertainty =       0.003271066692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563467427742
                                         uncertainty =       0.003271066692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530959101
  error estimate for blocks of size 2^( 2) =       0.000550733703
  error estimate for blocks of size 2^( 3) =       0.000568766100
  error estimate for blocks of size 2^( 4) =       0.000583383210
  error estimate for blocks of size 2^( 5) =       0.000594026831
  error estimate for blocks of size 2^( 6) =       0.000599884987
  error estimate for blocks of size 2^( 7) =       0.000601324348

      target function =                  N/A
              le_mean =     -22.435795261346
             les_mean =     503.928743860697
             stat err =       0.000594654844
             autocorr =       1.254318370592
              std dev =       0.750889561515
             le_variance =       0.563835133592


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.243579526135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435795261346       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435795262062       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435795263464       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435795263872       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435795263959       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435795264023       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435795263920       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435795263988       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435795263991       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435795264045       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4211e+03 is 1.358639e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435795261346       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435795261525       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435795261875       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435795261978       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435795261999       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435795262014       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435795261993       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435795261997       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435795261999       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435795262015       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.6843e+03 is 3.397057e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.435795261346       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.435795261390       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.435795261478       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.435795261507       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.435795261501       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.435795261519       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.435795261502       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.435795261515       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.435795261524       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.435795261482       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.2737e+04 is 8.492931e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329314 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2671e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.641311e-01 1 1  ON 0
 uu_1                 8.853143e-02 1 1  ON 1
 uu_2                -2.782814e-02 1 1  ON 2
 uu_3                -9.841907e-02 1 1  ON 3
 uu_4                -1.404261e-01 1 1  ON 4
 uu_5                -1.663337e-01 1 1  ON 5
 uu_6                -1.800045e-01 1 1  ON 6
 uu_7                -1.821200e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354499e-01 1 1  ON 9
 ud_0                 4.672589e-01 1 1  ON 10
 ud_1                 1.828495e-01 1 1  ON 11
 ud_2                 3.200954e-02 1 1  ON 12
 ud_3                -5.294426e-02 1 1  ON 13
 ud_4                -1.035046e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589791e-01 1 1  ON 16
 ud_7                -1.687584e-01 1 1  ON 17
 ud_8                -1.625722e-01 1 1  ON 18
 ud_9                -1.388626e-01 1 1  ON 19
 eC_0                -6.945162e-01 1 1  ON 20
 eC_1                -5.200250e-01 1 1  ON 21
 eC_2                -2.124575e-01 1 1  ON 22
 eC_3                 1.211029e-02 1 1  ON 23
 eC_4                 1.597231e-01 1 1  ON 24
 eC_5                 2.842280e-01 1 1  ON 25
 eC_6                 2.996265e-01 1 1  ON 26
 eC_7                 3.355116e-01 1 1  ON 27
 eC_8                 2.666418e-01 1 1  ON 28
 eC_9                 6.868761e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348251e-01 1 1  ON 31
 eO_2                -3.452088e-01 1 1  ON 32
 eO_3                -2.201184e-02 1 1  ON 33
 eO_4                 2.025324e-01 1 1  ON 34
 eO_5                 3.449453e-01 1 1  ON 35
 eO_6                 3.881422e-01 1 1  ON 36
 eO_7                 4.283266e-01 1 1  ON 37
 eO_8                 4.829797e-01 1 1  ON 38
 eO_9                 4.033861e-01 1 1  ON 39
eH1_0                -1.610014e-01 1 1  ON 40
eH1_1                -6.110911e-02 1 1  ON 41
eH1_2                -4.182710e-02 1 1  ON 42
eH1_3                -4.203545e-02 1 1  ON 43
eH1_4                -6.070657e-03 1 1  ON 44
eH1_5                 4.175429e-03 1 1  ON 45
eH1_6                 3.504479e-02 1 1  ON 46
eH1_7                 4.295076e-02 1 1  ON 47
eH1_8                 3.258349e-02 1 1  ON 48
eH1_9                 7.840361e-02 1 1  ON 49
eH2_0                -1.675283e-01 1 1  ON 50
eH2_1                -6.710375e-02 1 1  ON 51
eH2_2                -4.841725e-02 1 1  ON 52
eH2_3                -4.863720e-02 1 1  ON 53
eH2_4                -1.299343e-02 1 1  ON 54
eH2_5                -2.780408e-03 1 1  ON 55
eH2_6                 2.824228e-02 1 1  ON 56
eH2_7                 3.893566e-02 1 1  ON 57
eH2_8                 2.793170e-02 1 1  ON 58
eH2_9                 9.287519e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.4768
    reference variance = 0.342763
====================================================
  Execution time = 4.4597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2437e+01
  VMC Evar = 5.5683e-01
  Total weights = 2.0000e+06
  Execution time = 3.8551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556944412254
                                         uncertainty =       0.003117289765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556944412254
                                         uncertainty =       0.003117289765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527651721
  error estimate for blocks of size 2^( 2) =       0.000547973343
  error estimate for blocks of size 2^( 3) =       0.000566804289
  error estimate for blocks of size 2^( 4) =       0.000580855920
  error estimate for blocks of size 2^( 5) =       0.000589828807
  error estimate for blocks of size 2^( 6) =       0.000594329564
  error estimate for blocks of size 2^( 7) =       0.000600481843

      target function =                  N/A
              le_mean =     -22.436937585963
             les_mean =     503.973000635690
             stat err =       0.000591374033
             autocorr =       1.256116105767
              std dev =       0.746212220292
             le_variance =       0.556832677712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556944398849
                                         uncertainty =       0.003117290165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556944398849
                                         uncertainty =       0.003117290165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527651715
  error estimate for blocks of size 2^( 2) =       0.000547973339
  error estimate for blocks of size 2^( 3) =       0.000566804287
  error estimate for blocks of size 2^( 4) =       0.000580855919
  error estimate for blocks of size 2^( 5) =       0.000589828804
  error estimate for blocks of size 2^( 6) =       0.000594329562
  error estimate for blocks of size 2^( 7) =       0.000600481836

      target function =                  N/A
              le_mean =     -22.436937585651
             les_mean =     503.973000608291
             stat err =       0.000591374030
             autocorr =       1.256116122437
              std dev =       0.746212211317
             le_variance =       0.556832664319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556944405553
                                         uncertainty =       0.003117289965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556944405553
                                         uncertainty =       0.003117289965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527651718
  error estimate for blocks of size 2^( 2) =       0.000547973341
  error estimate for blocks of size 2^( 3) =       0.000566804288
  error estimate for blocks of size 2^( 4) =       0.000580855919
  error estimate for blocks of size 2^( 5) =       0.000589828805
  error estimate for blocks of size 2^( 6) =       0.000594329563
  error estimate for blocks of size 2^( 7) =       0.000600481840

      target function =                  N/A
              le_mean =     -22.436937585807
             les_mean =     503.973000621983
             stat err =       0.000591374032
             autocorr =       1.256116114109
              std dev =       0.746212215806
             le_variance =       0.556832671017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556944411416
                                         uncertainty =       0.003117289790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.556944411416
                                         uncertainty =       0.003117289790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000527651721
  error estimate for blocks of size 2^( 2) =       0.000547973343
  error estimate for blocks of size 2^( 3) =       0.000566804289
  error estimate for blocks of size 2^( 4) =       0.000580855920
  error estimate for blocks of size 2^( 5) =       0.000589828807
  error estimate for blocks of size 2^( 6) =       0.000594329563
  error estimate for blocks of size 2^( 7) =       0.000600481842

      target function =                  N/A
              le_mean =     -22.436937585943
             les_mean =     503.973000633976
             stat err =       0.000591374033
             autocorr =       1.256116106812
              std dev =       0.746212219731
             le_variance =       0.556832676876


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.436937585963        initial  <--
     1.4211e+03     1.4211e+04             1.3586e-07       -22.436937585651
     5.6843e+03     5.6843e+04             3.3971e-08       -22.436937585807
     2.2737e+04     2.2737e+05             8.4929e-09       -22.436937585943

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9311
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.641311e-01 1 1  ON 0
 uu_1                 8.853139e-02 1 1  ON 1
 uu_2                -2.782811e-02 1 1  ON 2
 uu_3                -9.841908e-02 1 1  ON 3
 uu_4                -1.404261e-01 1 1  ON 4
 uu_5                -1.663337e-01 1 1  ON 5
 uu_6                -1.800045e-01 1 1  ON 6
 uu_7                -1.821200e-01 1 1  ON 7
 uu_8                -1.681300e-01 1 1  ON 8
 uu_9                -1.354499e-01 1 1  ON 9
 ud_0                 4.672589e-01 1 1  ON 10
 ud_1                 1.828495e-01 1 1  ON 11
 ud_2                 3.200952e-02 1 1  ON 12
 ud_3                -5.294427e-02 1 1  ON 13
 ud_4                -1.035046e-01 1 1  ON 14
 ud_5                -1.373826e-01 1 1  ON 15
 ud_6                -1.589791e-01 1 1  ON 16
 ud_7                -1.687584e-01 1 1  ON 17
 ud_8                -1.625722e-01 1 1  ON 18
 ud_9                -1.388626e-01 1 1  ON 19
 eC_0                -6.945162e-01 1 1  ON 20
 eC_1                -5.200250e-01 1 1  ON 21
 eC_2                -2.124574e-01 1 1  ON 22
 eC_3                 1.211028e-02 1 1  ON 23
 eC_4                 1.597231e-01 1 1  ON 24
 eC_5                 2.842280e-01 1 1  ON 25
 eC_6                 2.996265e-01 1 1  ON 26
 eC_7                 3.355116e-01 1 1  ON 27
 eC_8                 2.666418e-01 1 1  ON 28
 eC_9                 6.868761e-02 1 1  ON 29
 eO_0                -1.227554e+00 1 1  ON 30
 eO_1                -8.348251e-01 1 1  ON 31
 eO_2                -3.452088e-01 1 1  ON 32
 eO_3                -2.201183e-02 1 1  ON 33
 eO_4                 2.025324e-01 1 1  ON 34
 eO_5                 3.449453e-01 1 1  ON 35
 eO_6                 3.881422e-01 1 1  ON 36
 eO_7                 4.283266e-01 1 1  ON 37
 eO_8                 4.829798e-01 1 1  ON 38
 eO_9                 4.033861e-01 1 1  ON 39
eH1_0                -1.610014e-01 1 1  ON 40
eH1_1                -6.110913e-02 1 1  ON 41
eH1_2                -4.182710e-02 1 1  ON 42
eH1_3                -4.203546e-02 1 1  ON 43
eH1_4                -6.070660e-03 1 1  ON 44
eH1_5                 4.175443e-03 1 1  ON 45
eH1_6                 3.504479e-02 1 1  ON 46
eH1_7                 4.295076e-02 1 1  ON 47
eH1_8                 3.258350e-02 1 1  ON 48
eH1_9                 7.840362e-02 1 1  ON 49
eH2_0                -1.675283e-01 1 1  ON 50
eH2_1                -6.710373e-02 1 1  ON 51
eH2_2                -4.841724e-02 1 1  ON 52
eH2_3                -4.863718e-02 1 1  ON 53
eH2_4                -1.299347e-02 1 1  ON 54
eH2_5                -2.780416e-03 1 1  ON 55
eH2_6                 2.824226e-02 1 1  ON 56
eH2_7                 3.893564e-02 1 1  ON 57
eH2_8                 2.793170e-02 1 1  ON 58
eH2_9                 9.287520e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2661e+02 secs
  Total Execution time = 5.0299e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
