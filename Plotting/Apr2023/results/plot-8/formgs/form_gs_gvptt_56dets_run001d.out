Rank =    0  Free Memory = 82327 MB
Rank =    1  Free Memory = 82326 MB
Rank =    2  Free Memory = 82326 MB
Rank =    3  Free Memory = 82326 MB
Rank =    4  Free Memory = 82326 MB
Rank =    5  Free Memory = 82325 MB
Rank =    6  Free Memory = 82325 MB
Rank =    7  Free Memory = 82325 MB
Rank =    8  Free Memory = 82325 MB
Rank =    9  Free Memory = 82324 MB
Rank =   10  Free Memory = 82324 MB
Rank =   11  Free Memory = 82324 MB
Rank =   12  Free Memory = 82324 MB
Rank =   13  Free Memory = 82324 MB
Rank =   14  Free Memory = 82323 MB
Rank =   15  Free Memory = 82312 MB
Rank =   16  Free Memory = 82312 MB
Rank =   17  Free Memory = 82311 MB
Rank =   18  Free Memory = 82311 MB
Rank =   19  Free Memory = 82311 MB
Rank =   20  Free Memory = 82311 MB
Rank =   21  Free Memory = 82311 MB
Rank =   22  Free Memory = 82311 MB
Rank =   23  Free Memory = 82311 MB
Rank =   24  Free Memory = 82311 MB
Rank =   25  Free Memory = 82311 MB
Rank =   26  Free Memory = 82311 MB
Rank =   27  Free Memory = 82311 MB
Rank =   28  Free Memory = 82311 MB
Rank =   29  Free Memory = 82311 MB
Rank =   30  Free Memory = 82311 MB
Rank =   31  Free Memory = 82311 MB
Rank =   32  Free Memory = 63593 MB
Rank =   33  Free Memory = 63593 MB
Rank =   34  Free Memory = 63593 MB
Rank =   35  Free Memory = 63593 MB
Rank =   36  Free Memory = 63593 MB
Rank =   37  Free Memory = 63593 MB
Rank =   38  Free Memory = 63593 MB
Rank =   39  Free Memory = 63593 MB
Rank =   40  Free Memory = 63593 MB
Rank =   41  Free Memory = 63593 MB
Rank =   42  Free Memory = 63592 MB
Rank =   43  Free Memory = 63592 MB
Rank =   44  Free Memory = 63592 MB
Rank =   45  Free Memory = 63592 MB
Rank =   46  Free Memory = 63592 MB
Rank =   47  Free Memory = 63592 MB
Rank =   48  Free Memory = 63592 MB
Rank =   49  Free Memory = 63592 MB
Rank =   50  Free Memory = 63592 MB
Rank =   51  Free Memory = 63592 MB
Rank =   52  Free Memory = 63592 MB
Rank =   53  Free Memory = 63592 MB
Rank =   54  Free Memory = 63592 MB
Rank =   55  Free Memory = 63592 MB
Rank =   56  Free Memory = 63592 MB
Rank =   57  Free Memory = 63592 MB
Rank =   58  Free Memory = 63592 MB
Rank =   59  Free Memory = 63592 MB
Rank =   60  Free Memory = 63592 MB
Rank =   61  Free Memory = 63592 MB
Rank =   62  Free Memory = 63592 MB
Rank =   63  Free Memory = 63592 MB
Rank =   64  Free Memory = 69743 MB
Rank =   65  Free Memory = 69743 MB
Rank =   66  Free Memory = 69743 MB
Rank =   67  Free Memory = 69743 MB
Rank =   68  Free Memory = 69743 MB
Rank =   69  Free Memory = 69743 MB
Rank =   70  Free Memory = 69743 MB
Rank =   71  Free Memory = 69743 MB
Rank =   72  Free Memory = 69743 MB
Rank =   73  Free Memory = 69743 MB
Rank =   74  Free Memory = 69743 MB
Rank =   75  Free Memory = 69743 MB
Rank =   76  Free Memory = 69743 MB
Rank =   77  Free Memory = 69743 MB
Rank =   78  Free Memory = 69743 MB
Rank =   79  Free Memory = 69743 MB
Rank =   80  Free Memory = 69743 MB
Rank =   81  Free Memory = 69743 MB
Rank =   82  Free Memory = 69743 MB
Rank =   83  Free Memory = 69743 MB
Rank =   84  Free Memory = 69743 MB
Rank =   85  Free Memory = 69743 MB
Rank =   86  Free Memory = 69743 MB
Rank =   87  Free Memory = 69743 MB
Rank =   88  Free Memory = 69743 MB
Rank =   89  Free Memory = 69743 MB
Rank =   90  Free Memory = 69743 MB
Rank =   91  Free Memory = 69743 MB
Rank =   92  Free Memory = 69743 MB
Rank =   93  Free Memory = 69743 MB
Rank =   94  Free Memory = 69743 MB
Rank =   95  Free Memory = 69743 MB
Rank =   96  Free Memory = 78488 MB
Rank =   97  Free Memory = 78488 MB
Rank =   98  Free Memory = 78488 MB
Rank =   99  Free Memory = 78488 MB
Rank =  100  Free Memory = 78488 MB
Rank =  101  Free Memory = 78488 MB
Rank =  102  Free Memory = 78488 MB
Rank =  103  Free Memory = 78488 MB
Rank =  104  Free Memory = 78488 MB
Rank =  105  Free Memory = 78488 MB
Rank =  106  Free Memory = 78488 MB
Rank =  107  Free Memory = 78488 MB
Rank =  108  Free Memory = 78488 MB
Rank =  109  Free Memory = 78488 MB
Rank =  110  Free Memory = 78488 MB
Rank =  111  Free Memory = 78488 MB
Rank =  112  Free Memory = 78488 MB
Rank =  113  Free Memory = 78488 MB
Rank =  114  Free Memory = 78488 MB
Rank =  115  Free Memory = 78488 MB
Rank =  116  Free Memory = 78488 MB
Rank =  117  Free Memory = 78488 MB
Rank =  118  Free Memory = 78488 MB
Rank =  119  Free Memory = 78488 MB
Rank =  120  Free Memory = 78488 MB
Rank =  121  Free Memory = 78488 MB
Rank =  122  Free Memory = 78488 MB
Rank =  123  Free Memory = 78488 MB
Rank =  124  Free Memory = 78488 MB
Rank =  125  Free Memory = 78488 MB
Rank =  126  Free Memory = 78488 MB
Rank =  127  Free Memory = 78488 MB
  Input file(s): opt_form_gs_gvptt_56dets_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_gvptt_56dets_run001d.xml

  Project = FORM
  date    = 2023-05-11 16:46:09 PDT
  host    = n0051.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 577

  Range of prime numbers to use as seeds over processors and threads = 4229-5347


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.647775e-01    1         1  ON     0
     uu_1                 9.131457e-02    1         1  ON     1
     uu_2                -2.007045e-02    1         1  ON     2
     uu_3                -8.559828e-02    1         1  ON     3
     uu_4                -1.234742e-01    1         1  ON     4
     uu_5                -1.468897e-01    1         1  ON     5
     uu_6                -1.603713e-01    1         1  ON     6
     uu_7                -1.639777e-01    1         1  ON     7
     uu_8                -1.558185e-01    1         1  ON     8
     uu_9                -1.287766e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.335986e-01    1         1  ON     0
     ud_1                 1.516426e-01    1         1  ON     1
     ud_2                 6.781226e-03    1         1  ON     2
     ud_3                -7.255384e-02    1         1  ON     3
     ud_4                -1.194310e-01    1         1  ON     4
     ud_5                -1.492436e-01    1         1  ON     5
     ud_6                -1.674546e-01    1         1  ON     6
     ud_7                -1.744869e-01    1         1  ON     7
     ud_8                -1.672796e-01    1         1  ON     8
     ud_9                -1.450225e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.733110e-01    1         1  ON     0
     eC_1                -4.184996e-01    1         1  ON     1
     eC_2                -1.684537e-01    1         1  ON     2
     eC_3                -2.153720e-02    1         1  ON     3
     eC_4                 2.632439e-02    1         1  ON     4
     eC_5                 1.119585e-01    1         1  ON     5
     eC_6                 2.332408e-01    1         1  ON     6
     eC_7                 4.131176e-01    1         1  ON     7
     eC_8                 3.086063e-01    1         1  ON     8
     eC_9                 7.877674e-02    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.253382e+00    1         1  ON     0
     eO_1                -8.763884e-01    1         1  ON     1
     eO_2                -3.993848e-01    1         1  ON     2
     eO_3                -5.614569e-02    1         1  ON     3
     eO_4                 1.730407e-01    1         1  ON     4
     eO_5                 3.602050e-01    1         1  ON     5
     eO_6                 4.597099e-01    1         1  ON     6
     eO_7                 5.336117e-01    1         1  ON     7
     eO_8                 5.153076e-01    1         1  ON     8
     eO_9                 3.597590e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.854043e-01    1         1  ON     0
     eH1_1                -9.781112e-02    1         1  ON     1
     eH1_2                -6.577509e-02    1         1  ON     2
     eH1_3                -5.168591e-02    1         1  ON     3
     eH1_4                 8.899887e-03    1         1  ON     4
     eH1_5                 6.649234e-02    1         1  ON     5
     eH1_6                 1.249239e-01    1         1  ON     6
     eH1_7                 1.031074e-01    1         1  ON     7
     eH1_8                 6.305314e-03    1         1  ON     8
     eH1_9                -2.072239e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.875449e-01    1         1  ON     0
     eH2_1                -1.003198e-01    1         1  ON     1
     eH2_2                -6.808965e-02    1         1  ON     2
     eH2_3                -5.385225e-02    1         1  ON     3
     eH2_4                 6.381937e-03    1         1  ON     4
     eH2_5                 6.393666e-02    1         1  ON     5
     eH2_6                 1.208492e-01    1         1  ON     6
     eH2_7                 9.955381e-02    1         1  ON     7
     eH2_8                 1.029859e-02    1         1  ON     8
     eH2_9                -4.917430e-03    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 56 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.713687e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.2722e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8352
    reference variance = 0.466595
====================================================
  Execution time = 7.8832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0028e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6637e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499911380458
                                         uncertainty =       0.003560554389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499911380458
                                         uncertainty =       0.003560554389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500141654
  error estimate for blocks of size 2^( 2) =       0.000518311639
  error estimate for blocks of size 2^( 3) =       0.000533964439
  error estimate for blocks of size 2^( 4) =       0.000543960207
  error estimate for blocks of size 2^( 5) =       0.000550690639
  error estimate for blocks of size 2^( 6) =       0.000553086653
  error estimate for blocks of size 2^( 7) =       0.000556357333

      target function =                  N/A
              le_mean =     -22.826179895269
             les_mean =     521.534771710040
             stat err =       0.000551023708
             autocorr =       1.213820637393
              std dev =       0.707307110808
             le_variance =       0.500283349000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.282617989527e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826179895269       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826182757743       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826182795570       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826184022677       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826184936702       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826184906447       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826185676422       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826186250012       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826186149273       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826185561150       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826185332950       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826185108887       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826185279490       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 8.874914e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826179895269       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826180943399       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826180994280       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826181361993       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826181901130       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826181854374       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826182151508       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826182384840       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826182159077       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826182066002       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826182014321       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.620623e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826179895269       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826180191740       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826180212451       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826180307037       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826180493368       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826180476746       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826180566924       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826180621792       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826180553867       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826180540099       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 6.740287e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.007923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0548e+02
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.648217e-01                 1 1 ON  0
uu_1  9.120941e-02                 1 1 ON  1
uu_2  -2.011566e-02                1 1 ON  2
uu_3  -8.559887e-02                1 1 ON  3
uu_4  -1.234302e-01                1 1 ON  4
uu_5  -1.468125e-01                1 1 ON  5
uu_6  -1.603347e-01                1 1 ON  6
uu_7  -1.639742e-01                1 1 ON  7
uu_8  -1.557503e-01                1 1 ON  8
uu_9  -1.287622e-01                1 1 ON  9
ud_0  4.336944e-01                 1 1 ON  10
ud_1  1.518417e-01                 1 1 ON  11
ud_2  6.807077e-03                 1 1 ON  12
ud_3  -7.256417e-02                1 1 ON  13
ud_4  -1.194574e-01                1 1 ON  14
ud_5  -1.491768e-01                1 1 ON  15
ud_6  -1.674746e-01                1 1 ON  16
ud_7  -1.744539e-01                1 1 ON  17
ud_8  -1.673081e-01                1 1 ON  18
ud_9  -1.450813e-01                1 1 ON  19
eC_0  -5.732987e-01                1 1 ON  20
eC_1  -4.184823e-01                1 1 ON  21
eC_2  -1.684352e-01                1 1 ON  22
eC_3  -2.158790e-02                1 1 ON  23
eC_4  2.637161e-02                 1 1 ON  24
eC_5  1.119421e-01                 1 1 ON  25
eC_6  2.331447e-01                 1 1 ON  26
eC_7  4.130597e-01                 1 1 ON  27
eC_8  3.086867e-01                 1 1 ON  28
eC_9  7.881779e-02                 1 1 ON  29
eO_0  -1.253644e+00                1 1 ON  30
eO_1  -8.766030e-01                1 1 ON  31
eO_2  -3.992749e-01                1 1 ON  32
eO_3  -5.602438e-02                1 1 ON  33
eO_4  1.731073e-01                 1 1 ON  34
eO_5  3.603224e-01                 1 1 ON  35
eO_6  4.596326e-01                 1 1 ON  36
eO_7  5.336745e-01                 1 1 ON  37
eO_8  5.152470e-01                 1 1 ON  38
eO_9  3.598140e-01                 1 1 ON  39
eH1_0 -1.853975e-01                1 1 ON  40
eH1_1 -9.789313e-02                1 1 ON  41
eH1_2 -6.584300e-02                1 1 ON  42
eH1_3 -5.153223e-02                1 1 ON  43
eH1_4 8.973389e-03                 1 1 ON  44
eH1_5 6.651963e-02                 1 1 ON  45
eH1_6 1.248058e-01                 1 1 ON  46
eH1_7 1.030759e-01                 1 1 ON  47
eH1_8 6.339639e-03                 1 1 ON  48
eH1_9 -2.074131e-02                1 1 ON  49
eH2_0 -1.874719e-01                1 1 ON  50
eH2_1 -1.003467e-01                1 1 ON  51
eH2_2 -6.813411e-02                1 1 ON  52
eH2_3 -5.372589e-02                1 1 ON  53
eH2_4 6.458753e-03                 1 1 ON  54
eH2_5 6.378464e-02                 1 1 ON  55
eH2_6 1.209221e-01                 1 1 ON  56
eH2_7 9.954057e-02                 1 1 ON  57
eH2_8 1.023614e-02                 1 1 ON  58
eH2_9 -4.997794e-03                1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8707
    reference variance = 0.72744
====================================================
  Execution time = 7.6066e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0345e-01
  Total weights = 2.0000e+06
  Execution time = 6.3100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503414193740
                                         uncertainty =       0.005540328624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503414193740
                                         uncertainty =       0.005540328624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501660191
  error estimate for blocks of size 2^( 2) =       0.000519413241
  error estimate for blocks of size 2^( 3) =       0.000535072550
  error estimate for blocks of size 2^( 4) =       0.000546448392
  error estimate for blocks of size 2^( 5) =       0.000552605993
  error estimate for blocks of size 2^( 6) =       0.000556249251
  error estimate for blocks of size 2^( 7) =       0.000558816762

      target function =                  N/A
              le_mean =     -22.825055956037
             les_mean =     521.486505038132
             stat err =       0.000553530099
             autocorr =       1.217483840649
              std dev =       0.709454645193
             le_variance =       0.503325893585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503812476199
                                         uncertainty =       0.005540062077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503812476199
                                         uncertainty =       0.005540062077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501858597
  error estimate for blocks of size 2^( 2) =       0.000519594919
  error estimate for blocks of size 2^( 3) =       0.000535232152
  error estimate for blocks of size 2^( 4) =       0.000546593066
  error estimate for blocks of size 2^( 5) =       0.000552741221
  error estimate for blocks of size 2^( 6) =       0.000556368012
  error estimate for blocks of size 2^( 7) =       0.000558918029

      target function =                  N/A
              le_mean =     -22.825059202605
             les_mean =     521.487051453621
             stat err =       0.000553655082
             autocorr =       1.217070805780
              std dev =       0.709735234464
             le_variance =       0.503724103040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503670941156
                                         uncertainty =       0.005539115613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503670941156
                                         uncertainty =       0.005539115613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501788125
  error estimate for blocks of size 2^( 2) =       0.000519528924
  error estimate for blocks of size 2^( 3) =       0.000535171874
  error estimate for blocks of size 2^( 4) =       0.000546536648
  error estimate for blocks of size 2^( 5) =       0.000552687510
  error estimate for blocks of size 2^( 6) =       0.000556314994
  error estimate for blocks of size 2^( 7) =       0.000558866032

      target function =                  N/A
              le_mean =     -22.825058063965
             les_mean =     521.486858017150
             stat err =       0.000553601296
             autocorr =       1.217176158352
              std dev =       0.709635572378
             le_variance =       0.503582645584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503441967116
                                         uncertainty =       0.005540090029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503441967116
                                         uncertainty =       0.005540090029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501674036
  error estimate for blocks of size 2^( 2) =       0.000519425421
  error estimate for blocks of size 2^( 3) =       0.000535082493
  error estimate for blocks of size 2^( 4) =       0.000546456830
  error estimate for blocks of size 2^( 5) =       0.000552613568
  error estimate for blocks of size 2^( 6) =       0.000556254097
  error estimate for blocks of size 2^( 7) =       0.000558818703

      target function =                  N/A
              le_mean =     -22.825056061539
             les_mean =     521.486537638358
             stat err =       0.000553535800
             autocorr =       1.217441712619
              std dev =       0.709474226200
             le_variance =       0.503353677643


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825055956037        initial
     2.5000e-01     2.5000e+00             8.8749e-04       -22.825059202605  <--
     1.0000e+00     1.0000e+01             2.6206e-04       -22.825058063965
     4.0000e+00     4.0000e+01             6.7403e-05       -22.825056061539

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.0769e+02
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.648373e-01 1 1  ON 0
 uu_1                 9.108393e-02 1 1  ON 1
 uu_2                -2.018946e-02 1 1  ON 2
 uu_3                -8.560820e-02 1 1  ON 3
 uu_4                -1.233547e-01 1 1  ON 4
 uu_5                -1.466967e-01 1 1  ON 5
 uu_6                -1.602177e-01 1 1  ON 6
 uu_7                -1.639123e-01 1 1  ON 7
 uu_8                -1.555785e-01 1 1  ON 8
 uu_9                -1.287237e-01 1 1  ON 9
 ud_0                 4.339916e-01 1 1  ON 10
 ud_1                 1.521723e-01 1 1  ON 11
 ud_2                 6.939051e-03 1 1  ON 12
 ud_3                -7.253614e-02 1 1  ON 13
 ud_4                -1.194524e-01 1 1  ON 14
 ud_5                -1.490812e-01 1 1  ON 15
 ud_6                -1.674372e-01 1 1  ON 16
 ud_7                -1.743835e-01 1 1  ON 17
 ud_8                -1.673650e-01 1 1  ON 18
 ud_9                -1.452391e-01 1 1  ON 19
 eC_0                -5.732521e-01 1 1  ON 20
 eC_1                -4.184668e-01 1 1  ON 21
 eC_2                -1.684396e-01 1 1  ON 22
 eC_3                -2.164441e-02 1 1  ON 23
 eC_4                 2.646737e-02 1 1  ON 24
 eC_5                 1.119165e-01 1 1  ON 25
 eC_6                 2.328847e-01 1 1  ON 26
 eC_7                 4.128962e-01 1 1  ON 27
 eC_8                 3.089117e-01 1 1  ON 28
 eC_9                 7.893299e-02 1 1  ON 29
 eO_0                -1.254270e+00 1 1  ON 30
 eO_1                -8.770726e-01 1 1  ON 31
 eO_2                -3.991872e-01 1 1  ON 32
 eO_3                -5.576480e-02 1 1  ON 33
 eO_4                 1.733389e-01 1 1  ON 34
 eO_5                 3.606485e-01 1 1  ON 35
 eO_6                 4.594495e-01 1 1  ON 36
 eO_7                 5.338359e-01 1 1  ON 37
 eO_8                 5.150752e-01 1 1  ON 38
 eO_9                 3.599678e-01 1 1  ON 39
eH1_0                -1.854067e-01 1 1  ON 40
eH1_1                -9.807052e-02 1 1  ON 41
eH1_2                -6.594607e-02 1 1  ON 42
eH1_3                -5.127742e-02 1 1  ON 43
eH1_4                 9.165574e-03 1 1  ON 44
eH1_5                 6.659299e-02 1 1  ON 45
eH1_6                 1.245600e-01 1 1  ON 46
eH1_7                 1.029894e-01 1 1  ON 47
eH1_8                 6.430914e-03 1 1  ON 48
eH1_9                -2.079470e-02 1 1  ON 49
eH2_0                -1.873006e-01 1 1  ON 50
eH2_1                -1.004258e-01 1 1  ON 51
eH2_2                -6.817697e-02 1 1  ON 52
eH2_3                -5.350064e-02 1 1  ON 53
eH2_4                 6.625831e-03 1 1  ON 54
eH2_5                 6.360072e-02 1 1  ON 55
eH2_6                 1.209755e-01 1 1  ON 56
eH2_7                 9.953409e-02 1 1  ON 57
eH2_8                 1.007267e-02 1 1  ON 58
eH2_9                -5.223595e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1317e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2853e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7342
    reference variance = 0.346663
====================================================
  Execution time = 8.1453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0482e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6845e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504898413499
                                         uncertainty =       0.005151571758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504898413499
                                         uncertainty =       0.005151571758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502402611
  error estimate for blocks of size 2^( 2) =       0.000520430740
  error estimate for blocks of size 2^( 3) =       0.000535816349
  error estimate for blocks of size 2^( 4) =       0.000546146923
  error estimate for blocks of size 2^( 5) =       0.000552677381
  error estimate for blocks of size 2^( 6) =       0.000555155946
  error estimate for blocks of size 2^( 7) =       0.000556225669

      target function =                  N/A
              le_mean =     -22.826004017631
             les_mean =     521.531275927856
             stat err =       0.000552551480
             autocorr =       1.209599828708
              std dev =       0.710504586432
             le_variance =       0.504816767341


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282600401763e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826004017631       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826006239039       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826007824385       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826007165239       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826008022135       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826006477784       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826008580731       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826008921831       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826010117986       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826009802196       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826009073329       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826008550877       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826007795566       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.826008400856       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.826008589111       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.826008939110       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.826008922209       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.826009164918       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 2.315891e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826004017631       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826005453922       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826006494228       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826006282239       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826006931854       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826005752137       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826006637584       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826006885041       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826007154147       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826006882166       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826006652643       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826006616353       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826006584428       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 9.508354e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826004017631       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826004612682       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826005065825       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826005035798       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826005411507       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826005014160       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826005218033       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826005237634       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826005256794       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826005179754       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826005134630       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 3.071279e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015144 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0831e+02
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.650811e-01 1 1  ON 0
 uu_1                 9.098306e-02 1 1  ON 1
 uu_2                -2.012386e-02 1 1  ON 2
 uu_3                -8.558990e-02 1 1  ON 3
 uu_4                -1.232803e-01 1 1  ON 4
 uu_5                -1.465458e-01 1 1  ON 5
 uu_6                -1.600916e-01 1 1  ON 6
 uu_7                -1.638954e-01 1 1  ON 7
 uu_8                -1.554848e-01 1 1  ON 8
 uu_9                -1.288763e-01 1 1  ON 9
 ud_0                 4.346292e-01 1 1  ON 10
 ud_1                 1.525745e-01 1 1  ON 11
 ud_2                 7.056622e-03 1 1  ON 12
 ud_3                -7.254848e-02 1 1  ON 13
 ud_4                -1.195287e-01 1 1  ON 14
 ud_5                -1.493518e-01 1 1  ON 15
 ud_6                -1.672220e-01 1 1  ON 16
 ud_7                -1.745588e-01 1 1  ON 17
 ud_8                -1.671187e-01 1 1  ON 18
 ud_9                -1.451388e-01 1 1  ON 19
 eC_0                -5.732812e-01 1 1  ON 20
 eC_1                -4.187278e-01 1 1  ON 21
 eC_2                -1.685781e-01 1 1  ON 22
 eC_3                -2.141419e-02 1 1  ON 23
 eC_4                 2.672249e-02 1 1  ON 24
 eC_5                 1.117451e-01 1 1  ON 25
 eC_6                 2.328950e-01 1 1  ON 26
 eC_7                 4.125852e-01 1 1  ON 27
 eC_8                 3.091479e-01 1 1  ON 28
 eC_9                 7.909899e-02 1 1  ON 29
 eO_0                -1.255221e+00 1 1  ON 30
 eO_1                -8.775033e-01 1 1  ON 31
 eO_2                -3.990213e-01 1 1  ON 32
 eO_3                -5.538248e-02 1 1  ON 33
 eO_4                 1.739231e-01 1 1  ON 34
 eO_5                 3.609315e-01 1 1  ON 35
 eO_6                 4.593549e-01 1 1  ON 36
 eO_7                 5.334230e-01 1 1  ON 37
 eO_8                 5.149869e-01 1 1  ON 38
 eO_9                 3.602657e-01 1 1  ON 39
eH1_0                -1.855868e-01 1 1  ON 40
eH1_1                -9.799836e-02 1 1  ON 41
eH1_2                -6.589938e-02 1 1  ON 42
eH1_3                -5.133975e-02 1 1  ON 43
eH1_4                 9.251554e-03 1 1  ON 44
eH1_5                 6.658681e-02 1 1  ON 45
eH1_6                 1.244549e-01 1 1  ON 46
eH1_7                 1.031668e-01 1 1  ON 47
eH1_8                 6.638584e-03 1 1  ON 48
eH1_9                -2.108002e-02 1 1  ON 49
eH2_0                -1.873894e-01 1 1  ON 50
eH2_1                -1.004850e-01 1 1  ON 51
eH2_2                -6.833898e-02 1 1  ON 52
eH2_3                -5.338609e-02 1 1  ON 53
eH2_4                 6.616485e-03 1 1  ON 54
eH2_5                 6.356266e-02 1 1  ON 55
eH2_6                 1.211316e-01 1 1  ON 56
eH2_7                 9.989470e-02 1 1  ON 57
eH2_8                 1.002121e-02 1 1  ON 58
eH2_9                -5.559290e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8435
    reference variance = 0.663884
====================================================
  Execution time = 7.6600e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0747e-01
  Total weights = 2.0000e+06
  Execution time = 6.3106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506790186257
                                         uncertainty =       0.004500700364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506790186257
                                         uncertainty =       0.004500700364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503370348
  error estimate for blocks of size 2^( 2) =       0.000521354228
  error estimate for blocks of size 2^( 3) =       0.000536756172
  error estimate for blocks of size 2^( 4) =       0.000548066429
  error estimate for blocks of size 2^( 5) =       0.000555193882
  error estimate for blocks of size 2^( 6) =       0.000558174660
  error estimate for blocks of size 2^( 7) =       0.000561766664

      target function =                  N/A
              le_mean =     -22.824751435295
             les_mean =     521.476041244500
             stat err =       0.000555800409
             autocorr =       1.219164940641
              std dev =       0.711873173327
             le_variance =       0.506763414903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508098878859
                                         uncertainty =       0.004509961123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508098878859
                                         uncertainty =       0.004509961123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504019694
  error estimate for blocks of size 2^( 2) =       0.000521967244
  error estimate for blocks of size 2^( 3) =       0.000537322564
  error estimate for blocks of size 2^( 4) =       0.000548591658
  error estimate for blocks of size 2^( 5) =       0.000555705026
  error estimate for blocks of size 2^( 6) =       0.000558673510
  error estimate for blocks of size 2^( 7) =       0.000562261724

      target function =                  N/A
              le_mean =     -22.824752268757
             les_mean =     521.477387580526
             stat err =       0.000556307979
             autocorr =       1.218247602806
              std dev =       0.712791487332
             le_variance =       0.508071704413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508215048573
                                         uncertainty =       0.004509949209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508215048573
                                         uncertainty =       0.004509949209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504077285
  error estimate for blocks of size 2^( 2) =       0.000522019830
  error estimate for blocks of size 2^( 3) =       0.000537372993
  error estimate for blocks of size 2^( 4) =       0.000548639554
  error estimate for blocks of size 2^( 5) =       0.000555752809
  error estimate for blocks of size 2^( 6) =       0.000558716121
  error estimate for blocks of size 2^( 7) =       0.000562302877

      target function =                  N/A
              le_mean =     -22.824753274440
             les_mean =     521.477549603295
             stat err =       0.000556352840
             autocorr =       1.218165691955
              std dev =       0.712872932815
             le_variance =       0.508187818340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507054453364
                                         uncertainty =       0.004502309140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507054453364
                                         uncertainty =       0.004502309140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503501540
  error estimate for blocks of size 2^( 2) =       0.000521477132
  error estimate for blocks of size 2^( 3) =       0.000536870002
  error estimate for blocks of size 2^( 4) =       0.000548171768
  error estimate for blocks of size 2^( 5) =       0.000555296302
  error estimate for blocks of size 2^( 6) =       0.000558273177
  error estimate for blocks of size 2^( 7) =       0.000561864131

      target function =                  N/A
              le_mean =     -22.824751264722
             les_mean =     521.476297644341
             stat err =       0.000555901344
             autocorr =       1.218972315858
              std dev =       0.712058706432
             le_variance =       0.507027601406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824751435295        initial
     6.2500e-02     6.2500e-01             2.3159e-03       -22.824752268757
     2.5000e-01     2.5000e+00             9.5084e-04       -22.824753274440  <--
     1.0000e+00     1.0000e+01             3.0713e-04       -22.824751264722

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.0816e+02
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.650811e-01 1 1  ON 0
 uu_1                 9.098306e-02 1 1  ON 1
 uu_2                -2.012386e-02 1 1  ON 2
 uu_3                -8.558990e-02 1 1  ON 3
 uu_4                -1.232803e-01 1 1  ON 4
 uu_5                -1.465458e-01 1 1  ON 5
 uu_6                -1.600916e-01 1 1  ON 6
 uu_7                -1.638954e-01 1 1  ON 7
 uu_8                -1.554848e-01 1 1  ON 8
 uu_9                -1.288763e-01 1 1  ON 9
 ud_0                 4.346292e-01 1 1  ON 10
 ud_1                 1.525745e-01 1 1  ON 11
 ud_2                 7.056622e-03 1 1  ON 12
 ud_3                -7.254848e-02 1 1  ON 13
 ud_4                -1.195287e-01 1 1  ON 14
 ud_5                -1.493518e-01 1 1  ON 15
 ud_6                -1.672220e-01 1 1  ON 16
 ud_7                -1.745588e-01 1 1  ON 17
 ud_8                -1.671187e-01 1 1  ON 18
 ud_9                -1.451388e-01 1 1  ON 19
 eC_0                -5.732812e-01 1 1  ON 20
 eC_1                -4.187278e-01 1 1  ON 21
 eC_2                -1.685781e-01 1 1  ON 22
 eC_3                -2.141419e-02 1 1  ON 23
 eC_4                 2.672249e-02 1 1  ON 24
 eC_5                 1.117451e-01 1 1  ON 25
 eC_6                 2.328950e-01 1 1  ON 26
 eC_7                 4.125852e-01 1 1  ON 27
 eC_8                 3.091479e-01 1 1  ON 28
 eC_9                 7.909899e-02 1 1  ON 29
 eO_0                -1.255221e+00 1 1  ON 30
 eO_1                -8.775033e-01 1 1  ON 31
 eO_2                -3.990213e-01 1 1  ON 32
 eO_3                -5.538248e-02 1 1  ON 33
 eO_4                 1.739231e-01 1 1  ON 34
 eO_5                 3.609315e-01 1 1  ON 35
 eO_6                 4.593549e-01 1 1  ON 36
 eO_7                 5.334230e-01 1 1  ON 37
 eO_8                 5.149869e-01 1 1  ON 38
 eO_9                 3.602657e-01 1 1  ON 39
eH1_0                -1.855868e-01 1 1  ON 40
eH1_1                -9.799836e-02 1 1  ON 41
eH1_2                -6.589938e-02 1 1  ON 42
eH1_3                -5.133975e-02 1 1  ON 43
eH1_4                 9.251554e-03 1 1  ON 44
eH1_5                 6.658681e-02 1 1  ON 45
eH1_6                 1.244549e-01 1 1  ON 46
eH1_7                 1.031668e-01 1 1  ON 47
eH1_8                 6.638584e-03 1 1  ON 48
eH1_9                -2.108002e-02 1 1  ON 49
eH2_0                -1.873894e-01 1 1  ON 50
eH2_1                -1.004850e-01 1 1  ON 51
eH2_2                -6.833898e-02 1 1  ON 52
eH2_3                -5.338609e-02 1 1  ON 53
eH2_4                 6.616485e-03 1 1  ON 54
eH2_5                 6.356266e-02 1 1  ON 55
eH2_6                 1.211316e-01 1 1  ON 56
eH2_7                 9.989470e-02 1 1  ON 57
eH2_8                 1.002121e-02 1 1  ON 58
eH2_9                -5.559290e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1647e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8024
    reference variance = 0.318589
====================================================
  Execution time = 7.9437e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0295e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6876e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502985560068
                                         uncertainty =       0.004140419790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502985560068
                                         uncertainty =       0.004140419790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501470693
  error estimate for blocks of size 2^( 2) =       0.000518938136
  error estimate for blocks of size 2^( 3) =       0.000534363905
  error estimate for blocks of size 2^( 4) =       0.000544219923
  error estimate for blocks of size 2^( 5) =       0.000550726465
  error estimate for blocks of size 2^( 6) =       0.000553769205
  error estimate for blocks of size 2^( 7) =       0.000552690500

      target function =                  N/A
              le_mean =     -22.825177414814
             les_mean =     521.491669477590
             stat err =       0.000550351523
             autocorr =       1.204451266148
              std dev =       0.709186654795
             le_variance =       0.502945711340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282517741481e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825177414814       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825175450564       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825175614878       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825176063144       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825176311865       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825175822150       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825175557176       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825177139357       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825178102580       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825177430199       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825178578958       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825178425987       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825177801428       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825178279390       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825178850248       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825178789083       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825178379440       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825178277410       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 1.448054e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825177414814       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825176014943       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825176052334       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825176477273       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825176627176       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825176564671       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825175986932       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825176719205       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825177181603       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825176962944       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825177132899       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825177023836       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825176934690       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 5.478072e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825177414814       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825176763500       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825176714650       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825176803675       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825176959013       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825177080096       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825176787512       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825176976714       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825177048229       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825177068159       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825177040238       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 1.893491e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0633e+02
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.649419e-01 1 1  ON 0
 uu_1                 9.100616e-02 1 1  ON 1
 uu_2                -2.025629e-02 1 1  ON 2
 uu_3                -8.573864e-02 1 1  ON 3
 uu_4                -1.234770e-01 1 1  ON 4
 uu_5                -1.464695e-01 1 1  ON 5
 uu_6                -1.599004e-01 1 1  ON 6
 uu_7                -1.633476e-01 1 1  ON 7
 uu_8                -1.550853e-01 1 1  ON 8
 uu_9                -1.288477e-01 1 1  ON 9
 ud_0                 4.347929e-01 1 1  ON 10
 ud_1                 1.528642e-01 1 1  ON 11
 ud_2                 7.580677e-03 1 1  ON 12
 ud_3                -7.223418e-02 1 1  ON 13
 ud_4                -1.192519e-01 1 1  ON 14
 ud_5                -1.490256e-01 1 1  ON 15
 ud_6                -1.674270e-01 1 1  ON 16
 ud_7                -1.747935e-01 1 1  ON 17
 ud_8                -1.676332e-01 1 1  ON 18
 ud_9                -1.450886e-01 1 1  ON 19
 eC_0                -5.734346e-01 1 1  ON 20
 eC_1                -4.186582e-01 1 1  ON 21
 eC_2                -1.688386e-01 1 1  ON 22
 eC_3                -2.161502e-02 1 1  ON 23
 eC_4                 2.688641e-02 1 1  ON 24
 eC_5                 1.119102e-01 1 1  ON 25
 eC_6                 2.328607e-01 1 1  ON 26
 eC_7                 4.123507e-01 1 1  ON 27
 eC_8                 3.094712e-01 1 1  ON 28
 eC_9                 7.925539e-02 1 1  ON 29
 eO_0                -1.255542e+00 1 1  ON 30
 eO_1                -8.780082e-01 1 1  ON 31
 eO_2                -3.992010e-01 1 1  ON 32
 eO_3                -5.521298e-02 1 1  ON 33
 eO_4                 1.742587e-01 1 1  ON 34
 eO_5                 3.611108e-01 1 1  ON 35
 eO_6                 4.593909e-01 1 1  ON 36
 eO_7                 5.334471e-01 1 1  ON 37
 eO_8                 5.147225e-01 1 1  ON 38
 eO_9                 3.605089e-01 1 1  ON 39
eH1_0                -1.854014e-01 1 1  ON 40
eH1_1                -9.831633e-02 1 1  ON 41
eH1_2                -6.626959e-02 1 1  ON 42
eH1_3                -5.109344e-02 1 1  ON 43
eH1_4                 9.560458e-03 1 1  ON 44
eH1_5                 6.653956e-02 1 1  ON 45
eH1_6                 1.242247e-01 1 1  ON 46
eH1_7                 1.031115e-01 1 1  ON 47
eH1_8                 6.938987e-03 1 1  ON 48
eH1_9                -2.122856e-02 1 1  ON 49
eH2_0                -1.877954e-01 1 1  ON 50
eH2_1                -1.005503e-01 1 1  ON 51
eH2_2                -6.838483e-02 1 1  ON 52
eH2_3                -5.356175e-02 1 1  ON 53
eH2_4                 6.798757e-03 1 1  ON 54
eH2_5                 6.378212e-02 1 1  ON 55
eH2_6                 1.211564e-01 1 1  ON 56
eH2_7                 1.003069e-01 1 1  ON 57
eH2_8                 1.005322e-02 1 1  ON 58
eH2_9                -5.798323e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7587
    reference variance = 0.36562
====================================================
  Execution time = 7.8138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0971e-01
  Total weights = 2.0000e+06
  Execution time = 6.3033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510191972611
                                         uncertainty =       0.007126487412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510191972611
                                         uncertainty =       0.007126487412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505008070
  error estimate for blocks of size 2^( 2) =       0.000522609612
  error estimate for blocks of size 2^( 3) =       0.000536856381
  error estimate for blocks of size 2^( 4) =       0.000547074956
  error estimate for blocks of size 2^( 5) =       0.000554767352
  error estimate for blocks of size 2^( 6) =       0.000558006402
  error estimate for blocks of size 2^( 7) =       0.000558120058

      target function =                  N/A
              le_mean =     -22.825868627400
             les_mean =     521.530344642549
             stat err =       0.000554492192
             autocorr =       1.205574999252
              std dev =       0.714189262212
             le_variance =       0.510066302259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509813481098
                                         uncertainty =       0.007101156739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509813481098
                                         uncertainty =       0.007101156739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504820788
  error estimate for blocks of size 2^( 2) =       0.000522434636
  error estimate for blocks of size 2^( 3) =       0.000536693096
  error estimate for blocks of size 2^( 4) =       0.000546914339
  error estimate for blocks of size 2^( 5) =       0.000554616750
  error estimate for blocks of size 2^( 6) =       0.000557861383
  error estimate for blocks of size 2^( 7) =       0.000557959559

      target function =                  N/A
              le_mean =     -22.825862097867
             les_mean =     521.529668311675
             stat err =       0.000554338008
             autocorr =       1.205798815649
              std dev =       0.713924404724
             le_variance =       0.509688055661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509489808324
                                         uncertainty =       0.007092657815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509489808324
                                         uncertainty =       0.007092657815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504660512
  error estimate for blocks of size 2^( 2) =       0.000522284953
  error estimate for blocks of size 2^( 3) =       0.000536554476
  error estimate for blocks of size 2^( 4) =       0.000546781933
  error estimate for blocks of size 2^( 5) =       0.000554488084
  error estimate for blocks of size 2^( 6) =       0.000557733183
  error estimate for blocks of size 2^( 7) =       0.000557832022

      target function =                  N/A
              le_mean =     -22.825861615332
             les_mean =     521.529322691588
             stat err =       0.000554208805
             autocorr =       1.206002466103
              std dev =       0.713697739946
             le_variance =       0.509364464004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510008797958
                                         uncertainty =       0.007119183144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510008797958
                                         uncertainty =       0.007119183144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504917410
  error estimate for blocks of size 2^( 2) =       0.000522524800
  error estimate for blocks of size 2^( 3) =       0.000536777196
  error estimate for blocks of size 2^( 4) =       0.000546997933
  error estimate for blocks of size 2^( 5) =       0.000554692978
  error estimate for blocks of size 2^( 6) =       0.000557933375
  error estimate for blocks of size 2^( 7) =       0.000558043552

      target function =                  N/A
              le_mean =     -22.825866371880
             les_mean =     521.530058553952
             stat err =       0.000554416960
             autocorr =       1.205680736056
              std dev =       0.714061049195
             le_variance =       0.509883181977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825868627400        initial  <--
     6.2500e-02     6.2500e-01             1.4481e-03       -22.825862097867
     2.5000e-01     2.5000e+00             5.4781e-04       -22.825861615332
     1.0000e+00     1.0000e+01             1.8935e-04       -22.825866371880

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 109.6914
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.650811e-01 1 1  ON 0
 uu_1                 9.098306e-02 1 1  ON 1
 uu_2                -2.012386e-02 1 1  ON 2
 uu_3                -8.558990e-02 1 1  ON 3
 uu_4                -1.232803e-01 1 1  ON 4
 uu_5                -1.465458e-01 1 1  ON 5
 uu_6                -1.600916e-01 1 1  ON 6
 uu_7                -1.638954e-01 1 1  ON 7
 uu_8                -1.554848e-01 1 1  ON 8
 uu_9                -1.288763e-01 1 1  ON 9
 ud_0                 4.346292e-01 1 1  ON 10
 ud_1                 1.525745e-01 1 1  ON 11
 ud_2                 7.056622e-03 1 1  ON 12
 ud_3                -7.254848e-02 1 1  ON 13
 ud_4                -1.195287e-01 1 1  ON 14
 ud_5                -1.493518e-01 1 1  ON 15
 ud_6                -1.672220e-01 1 1  ON 16
 ud_7                -1.745588e-01 1 1  ON 17
 ud_8                -1.671187e-01 1 1  ON 18
 ud_9                -1.451388e-01 1 1  ON 19
 eC_0                -5.732812e-01 1 1  ON 20
 eC_1                -4.187278e-01 1 1  ON 21
 eC_2                -1.685781e-01 1 1  ON 22
 eC_3                -2.141419e-02 1 1  ON 23
 eC_4                 2.672249e-02 1 1  ON 24
 eC_5                 1.117451e-01 1 1  ON 25
 eC_6                 2.328950e-01 1 1  ON 26
 eC_7                 4.125852e-01 1 1  ON 27
 eC_8                 3.091479e-01 1 1  ON 28
 eC_9                 7.909899e-02 1 1  ON 29
 eO_0                -1.255221e+00 1 1  ON 30
 eO_1                -8.775033e-01 1 1  ON 31
 eO_2                -3.990213e-01 1 1  ON 32
 eO_3                -5.538248e-02 1 1  ON 33
 eO_4                 1.739231e-01 1 1  ON 34
 eO_5                 3.609315e-01 1 1  ON 35
 eO_6                 4.593549e-01 1 1  ON 36
 eO_7                 5.334230e-01 1 1  ON 37
 eO_8                 5.149869e-01 1 1  ON 38
 eO_9                 3.602657e-01 1 1  ON 39
eH1_0                -1.855868e-01 1 1  ON 40
eH1_1                -9.799836e-02 1 1  ON 41
eH1_2                -6.589938e-02 1 1  ON 42
eH1_3                -5.133975e-02 1 1  ON 43
eH1_4                 9.251554e-03 1 1  ON 44
eH1_5                 6.658681e-02 1 1  ON 45
eH1_6                 1.244549e-01 1 1  ON 46
eH1_7                 1.031668e-01 1 1  ON 47
eH1_8                 6.638584e-03 1 1  ON 48
eH1_9                -2.108002e-02 1 1  ON 49
eH2_0                -1.873894e-01 1 1  ON 50
eH2_1                -1.004850e-01 1 1  ON 51
eH2_2                -6.833898e-02 1 1  ON 52
eH2_3                -5.338609e-02 1 1  ON 53
eH2_4                 6.616485e-03 1 1  ON 54
eH2_5                 6.356266e-02 1 1  ON 55
eH2_6                 1.211316e-01 1 1  ON 56
eH2_7                 9.989470e-02 1 1  ON 57
eH2_8                 1.002121e-02 1 1  ON 58
eH2_9                -5.559290e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1602e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7363
    reference variance = 0.295866
====================================================
  Execution time = 7.8046e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0519e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6618e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505206097030
                                         uncertainty =       0.004246277414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505206097030
                                         uncertainty =       0.004246277414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502589975
  error estimate for blocks of size 2^( 2) =       0.000520228278
  error estimate for blocks of size 2^( 3) =       0.000535146156
  error estimate for blocks of size 2^( 4) =       0.000546200648
  error estimate for blocks of size 2^( 5) =       0.000552555712
  error estimate for blocks of size 2^( 6) =       0.000553445207
  error estimate for blocks of size 2^( 7) =       0.000556874959

      target function =                  N/A
              le_mean =     -22.825477104784
             les_mean =     521.507598174355
             stat err =       0.000552269132
             autocorr =       1.207463178896
              std dev =       0.710769558944
             le_variance =       0.505193365921


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282547710478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825477104784       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825477594542       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825478467576       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825479257894       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825479312286       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825479428153       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825479403902       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825479079571       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825479218405       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825479368666       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825479304804       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 2.681691e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825477104784       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825477247463       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825477535461       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825477806306       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825477866586       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825477918699       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825477901026       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825477807195       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825477800183       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825477835110       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 7.804405e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825477104784       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825477141992       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825477220380       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825477295804       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825477317069       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825477332713       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825477328630       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825477307443       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825477299320       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825477306695       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 2.035530e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026437 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0467e+02
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.650328e-01 1 1  ON 0
 uu_1                 9.100499e-02 1 1  ON 1
 uu_2                -2.015012e-02 1 1  ON 2
 uu_3                -8.559974e-02 1 1  ON 3
 uu_4                -1.233320e-01 1 1  ON 4
 uu_5                -1.465473e-01 1 1  ON 5
 uu_6                -1.600727e-01 1 1  ON 6
 uu_7                -1.638174e-01 1 1  ON 7
 uu_8                -1.554284e-01 1 1  ON 8
 uu_9                -1.288755e-01 1 1  ON 9
 ud_0                 4.346503e-01 1 1  ON 10
 ud_1                 1.526215e-01 1 1  ON 11
 ud_2                 7.099391e-03 1 1  ON 12
 ud_3                -7.253948e-02 1 1  ON 13
 ud_4                -1.194903e-01 1 1  ON 14
 ud_5                -1.493559e-01 1 1  ON 15
 ud_6                -1.672646e-01 1 1  ON 16
 ud_7                -1.745642e-01 1 1  ON 17
 ud_8                -1.671392e-01 1 1  ON 18
 ud_9                -1.451371e-01 1 1  ON 19
 eC_0                -5.732669e-01 1 1  ON 20
 eC_1                -4.187600e-01 1 1  ON 21
 eC_2                -1.685796e-01 1 1  ON 22
 eC_3                -2.139536e-02 1 1  ON 23
 eC_4                 2.669580e-02 1 1  ON 24
 eC_5                 1.117749e-01 1 1  ON 25
 eC_6                 2.328803e-01 1 1  ON 26
 eC_7                 4.125521e-01 1 1  ON 27
 eC_8                 3.091789e-01 1 1  ON 28
 eC_9                 7.911236e-02 1 1  ON 29
 eO_0                -1.255255e+00 1 1  ON 30
 eO_1                -8.775508e-01 1 1  ON 31
 eO_2                -3.990580e-01 1 1  ON 32
 eO_3                -5.535330e-02 1 1  ON 33
 eO_4                 1.739837e-01 1 1  ON 34
 eO_5                 3.609056e-01 1 1  ON 35
 eO_6                 4.593409e-01 1 1  ON 36
 eO_7                 5.334384e-01 1 1  ON 37
 eO_8                 5.149773e-01 1 1  ON 38
 eO_9                 3.602935e-01 1 1  ON 39
eH1_0                -1.855685e-01 1 1  ON 40
eH1_1                -9.803810e-02 1 1  ON 41
eH1_2                -6.589466e-02 1 1  ON 42
eH1_3                -5.129223e-02 1 1  ON 43
eH1_4                 9.221991e-03 1 1  ON 44
eH1_5                 6.663556e-02 1 1  ON 45
eH1_6                 1.244240e-01 1 1  ON 46
eH1_7                 1.031529e-01 1 1  ON 47
eH1_8                 6.640496e-03 1 1  ON 48
eH1_9                -2.109517e-02 1 1  ON 49
eH2_0                -1.874338e-01 1 1  ON 50
eH2_1                -1.004951e-01 1 1  ON 51
eH2_2                -6.832080e-02 1 1  ON 52
eH2_3                -5.339597e-02 1 1  ON 53
eH2_4                 6.622372e-03 1 1  ON 54
eH2_5                 6.360833e-02 1 1  ON 55
eH2_6                 1.211529e-01 1 1  ON 56
eH2_7                 9.991216e-02 1 1  ON 57
eH2_8                 1.001751e-02 1 1  ON 58
eH2_9                -5.602228e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.9324
    reference variance = 0.973876
====================================================
  Execution time = 7.8078e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0746e-01
  Total weights = 2.0000e+06
  Execution time = 6.6225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507502441363
                                         uncertainty =       0.003662626779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507502441363
                                         uncertainty =       0.003662626779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503721115
  error estimate for blocks of size 2^( 2) =       0.000521023618
  error estimate for blocks of size 2^( 3) =       0.000536835090
  error estimate for blocks of size 2^( 4) =       0.000547961070
  error estimate for blocks of size 2^( 5) =       0.000554334778
  error estimate for blocks of size 2^( 6) =       0.000557476301
  error estimate for blocks of size 2^( 7) =       0.000556934360

      target function =                  N/A
              le_mean =     -22.825283882130
             les_mean =     521.501053969766
             stat err =       0.000554176627
             autocorr =       1.210364277875
              std dev =       0.712369232692
             le_variance =       0.507469923685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507498440270
                                         uncertainty =       0.003662979033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507498440270
                                         uncertainty =       0.003662979033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503719067
  error estimate for blocks of size 2^( 2) =       0.000521020383
  error estimate for blocks of size 2^( 3) =       0.000536830341
  error estimate for blocks of size 2^( 4) =       0.000547957872
  error estimate for blocks of size 2^( 5) =       0.000554330656
  error estimate for blocks of size 2^( 6) =       0.000557471118
  error estimate for blocks of size 2^( 7) =       0.000556926921

      target function =                  N/A
              le_mean =     -22.825285550472
             les_mean =     521.501126004355
             stat err =       0.000554171642
             autocorr =       1.210352342686
              std dev =       0.712366336588
             le_variance =       0.507465797504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507478164315
                                         uncertainty =       0.003662434264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507478164315
                                         uncertainty =       0.003662434264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503709021
  error estimate for blocks of size 2^( 2) =       0.000521011236
  error estimate for blocks of size 2^( 3) =       0.000536822284
  error estimate for blocks of size 2^( 4) =       0.000547950076
  error estimate for blocks of size 2^( 5) =       0.000554323619
  error estimate for blocks of size 2^( 6) =       0.000557464481
  error estimate for blocks of size 2^( 7) =       0.000556921379

      target function =                  N/A
              le_mean =     -22.825285038751
             les_mean =     521.501082402678
             stat err =       0.000554164889
             autocorr =       1.210371124550
              std dev =       0.712352129328
             le_variance =       0.507445556158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507498369375
                                         uncertainty =       0.003662581932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507498369375
                                         uncertainty =       0.003662581932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503719088
  error estimate for blocks of size 2^( 2) =       0.000521021558
  error estimate for blocks of size 2^( 3) =       0.000536832984
  error estimate for blocks of size 2^( 4) =       0.000547959236
  error estimate for blocks of size 2^( 5) =       0.000554332940
  error estimate for blocks of size 2^( 6) =       0.000557474374
  error estimate for blocks of size 2^( 7) =       0.000556932290

      target function =                  N/A
              le_mean =     -22.825284027482
             les_mean =     521.501056520449
             stat err =       0.000554174710
             autocorr =       1.210365646281
              std dev =       0.712366365692
             le_variance =       0.507465838969


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825283882130        initial
     6.2500e-01     6.2500e+00             2.6817e-04       -22.825285550472  <--
     2.5000e+00     2.5000e+01             7.8044e-05       -22.825285038751
     1.0000e+01     1.0000e+02             2.0355e-05       -22.825284027482

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 1.1001e+02
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.649262e-01 1 1  ON 0
 uu_1                 9.102835e-02 1 1  ON 1
 uu_2                -2.020057e-02 1 1  ON 2
 uu_3                -8.565120e-02 1 1  ON 3
 uu_4                -1.234357e-01 1 1  ON 4
 uu_5                -1.465653e-01 1 1  ON 5
 uu_6                -1.600215e-01 1 1  ON 6
 uu_7                -1.636272e-01 1 1  ON 7
 uu_8                -1.552609e-01 1 1  ON 8
 uu_9                -1.288667e-01 1 1  ON 9
 ud_0                 4.347437e-01 1 1  ON 10
 ud_1                 1.527416e-01 1 1  ON 11
 ud_2                 7.203474e-03 1 1  ON 12
 ud_3                -7.248936e-02 1 1  ON 13
 ud_4                -1.194161e-01 1 1  ON 14
 ud_5                -1.493546e-01 1 1  ON 15
 ud_6                -1.673571e-01 1 1  ON 16
 ud_7                -1.746068e-01 1 1  ON 17
 ud_8                -1.671996e-01 1 1  ON 18
 ud_9                -1.451290e-01 1 1  ON 19
 eC_0                -5.732371e-01 1 1  ON 20
 eC_1                -4.188293e-01 1 1  ON 21
 eC_2                -1.685820e-01 1 1  ON 22
 eC_3                -2.136371e-02 1 1  ON 23
 eC_4                 2.663851e-02 1 1  ON 24
 eC_5                 1.118465e-01 1 1  ON 25
 eC_6                 2.328373e-01 1 1  ON 26
 eC_7                 4.124573e-01 1 1  ON 27
 eC_8                 3.092707e-01 1 1  ON 28
 eC_9                 7.915177e-02 1 1  ON 29
 eO_0                -1.255355e+00 1 1  ON 30
 eO_1                -8.776785e-01 1 1  ON 31
 eO_2                -3.991493e-01 1 1  ON 32
 eO_3                -5.528596e-02 1 1  ON 33
 eO_4                 1.741332e-01 1 1  ON 34
 eO_5                 3.608541e-01 1 1  ON 35
 eO_6                 4.592927e-01 1 1  ON 36
 eO_7                 5.334801e-01 1 1  ON 37
 eO_8                 5.149510e-01 1 1  ON 38
 eO_9                 3.603757e-01 1 1  ON 39
eH1_0                -1.855297e-01 1 1  ON 40
eH1_1                -9.813334e-02 1 1  ON 41
eH1_2                -6.587208e-02 1 1  ON 42
eH1_3                -5.118294e-02 1 1  ON 43
eH1_4                 9.174240e-03 1 1  ON 44
eH1_5                 6.673816e-02 1 1  ON 45
eH1_6                 1.243577e-01 1 1  ON 46
eH1_7                 1.031036e-01 1 1  ON 47
eH1_8                 6.645994e-03 1 1  ON 48
eH1_9                -2.113897e-02 1 1  ON 49
eH2_0                -1.875591e-01 1 1  ON 50
eH2_1                -1.005222e-01 1 1  ON 51
eH2_2                -6.828667e-02 1 1  ON 52
eH2_3                -5.341239e-02 1 1  ON 53
eH2_4                 6.645870e-03 1 1  ON 54
eH2_5                 6.373395e-02 1 1  ON 55
eH2_6                 1.212211e-01 1 1  ON 56
eH2_7                 9.995666e-02 1 1  ON 57
eH2_8                 1.000866e-02 1 1  ON 58
eH2_9                -5.727632e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1469e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.9004
    reference variance = 0.343199
====================================================
  Execution time = 7.8425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0590e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6455e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506024133746
                                         uncertainty =       0.003739071891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506024133746
                                         uncertainty =       0.003739071891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502939503
  error estimate for blocks of size 2^( 2) =       0.000520494079
  error estimate for blocks of size 2^( 3) =       0.000536017617
  error estimate for blocks of size 2^( 4) =       0.000547567798
  error estimate for blocks of size 2^( 5) =       0.000553116241
  error estimate for blocks of size 2^( 6) =       0.000554766005
  error estimate for blocks of size 2^( 7) =       0.000557598014

      target function =                  N/A
              le_mean =     -22.824930279468
             les_mean =     521.483338296108
             stat err =       0.000553262015
             autocorr =       1.210124940333
              std dev =       0.711263865592
             le_variance =       0.505896286497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282493027947e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824930279468       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824931917555       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824932877304       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824934529009       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824935658525       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824935452090       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824936179120       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824936959065       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824936308136       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824936133487       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824936258406       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824936413257       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824936531243       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824936595342       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 6.206221e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824930279468       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824931086345       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824931422054       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824932082273       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824932770559       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824932885163       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824933053573       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824933339392       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824933192178       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824933188670       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824933194347       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824933219694       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 2.065305e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824930279468       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824930545789       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824930644734       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824930851159       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824931075023       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824931167449       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824931232452       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824931303769       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824931279943       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824931286618       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 6.661798e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0489e+02
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.651328e-01 1 1  ON 0
 uu_1                 9.100016e-02 1 1  ON 1
 uu_2                -2.022616e-02 1 1  ON 2
 uu_3                -8.563318e-02 1 1  ON 3
 uu_4                -1.234567e-01 1 1  ON 4
 uu_5                -1.465024e-01 1 1  ON 5
 uu_6                -1.600934e-01 1 1  ON 6
 uu_7                -1.636623e-01 1 1  ON 7
 uu_8                -1.551605e-01 1 1  ON 8
 uu_9                -1.287890e-01 1 1  ON 9
 ud_0                 4.349329e-01 1 1  ON 10
 ud_1                 1.528275e-01 1 1  ON 11
 ud_2                 7.232854e-03 1 1  ON 12
 ud_3                -7.243926e-02 1 1  ON 13
 ud_4                -1.194078e-01 1 1  ON 14
 ud_5                -1.492639e-01 1 1  ON 15
 ud_6                -1.674406e-01 1 1  ON 16
 ud_7                -1.746425e-01 1 1  ON 17
 ud_8                -1.672151e-01 1 1  ON 18
 ud_9                -1.450189e-01 1 1  ON 19
 eC_0                -5.733301e-01 1 1  ON 20
 eC_1                -4.188842e-01 1 1  ON 21
 eC_2                -1.686088e-01 1 1  ON 22
 eC_3                -2.150067e-02 1 1  ON 23
 eC_4                 2.681932e-02 1 1  ON 24
 eC_5                 1.120163e-01 1 1  ON 25
 eC_6                 2.327762e-01 1 1  ON 26
 eC_7                 4.122995e-01 1 1  ON 27
 eC_8                 3.093688e-01 1 1  ON 28
 eC_9                 7.921872e-02 1 1  ON 29
 eO_0                -1.255481e+00 1 1  ON 30
 eO_1                -8.777045e-01 1 1  ON 31
 eO_2                -3.993284e-01 1 1  ON 32
 eO_3                -5.520159e-02 1 1  ON 33
 eO_4                 1.740116e-01 1 1  ON 34
 eO_5                 3.609893e-01 1 1  ON 35
 eO_6                 4.593403e-01 1 1  ON 36
 eO_7                 5.334762e-01 1 1  ON 37
 eO_8                 5.149119e-01 1 1  ON 38
 eO_9                 3.604940e-01 1 1  ON 39
eH1_0                -1.855616e-01 1 1  ON 40
eH1_1                -9.829678e-02 1 1  ON 41
eH1_2                -6.579737e-02 1 1  ON 42
eH1_3                -5.106072e-02 1 1  ON 43
eH1_4                 9.283645e-03 1 1  ON 44
eH1_5                 6.667377e-02 1 1  ON 45
eH1_6                 1.242946e-01 1 1  ON 46
eH1_7                 1.031712e-01 1 1  ON 47
eH1_8                 6.652052e-03 1 1  ON 48
eH1_9                -2.124397e-02 1 1  ON 49
eH2_0                -1.877366e-01 1 1  ON 50
eH2_1                -1.006650e-01 1 1  ON 51
eH2_2                -6.837513e-02 1 1  ON 52
eH2_3                -5.337770e-02 1 1  ON 53
eH2_4                 6.816394e-03 1 1  ON 54
eH2_5                 6.377830e-02 1 1  ON 55
eH2_6                 1.214242e-01 1 1  ON 56
eH2_7                 1.000412e-01 1 1  ON 57
eH2_8                 9.981659e-03 1 1  ON 58
eH2_9                -5.857655e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8521
    reference variance = 0.275566
====================================================
  Execution time = 7.7618e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0566e-01
  Total weights = 2.0000e+06
  Execution time = 6.2799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504377788395
                                         uncertainty =       0.003753957893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504377788395
                                         uncertainty =       0.003753957893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502688598
  error estimate for blocks of size 2^( 2) =       0.000520555906
  error estimate for blocks of size 2^( 3) =       0.000535860549
  error estimate for blocks of size 2^( 4) =       0.000546517245
  error estimate for blocks of size 2^( 5) =       0.000552621130
  error estimate for blocks of size 2^( 6) =       0.000555830123
  error estimate for blocks of size 2^( 7) =       0.000560692080

      target function =                  N/A
              le_mean =     -22.825057789615
             les_mean =     521.488654500129
             stat err =       0.000553915145
             autocorr =       1.214194912956
              std dev =       0.710909033259
             le_variance =       0.505391653569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504908266510
                                         uncertainty =       0.003757937193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504908266510
                                         uncertainty =       0.003757937193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502952439
  error estimate for blocks of size 2^( 2) =       0.000520806301
  error estimate for blocks of size 2^( 3) =       0.000536097756
  error estimate for blocks of size 2^( 4) =       0.000546744684
  error estimate for blocks of size 2^( 5) =       0.000552846551
  error estimate for blocks of size 2^( 6) =       0.000556049853
  error estimate for blocks of size 2^( 7) =       0.000560909956

      target function =                  N/A
              le_mean =     -22.825058730158
             les_mean =     521.489228093909
             stat err =       0.000554137761
             autocorr =       1.213896485294
              std dev =       0.711282160410
             le_variance =       0.505922311718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504913272783
                                         uncertainty =       0.003757914479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504913272783
                                         uncertainty =       0.003757914479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502954787
  error estimate for blocks of size 2^( 2) =       0.000520808636
  error estimate for blocks of size 2^( 3) =       0.000536100215
  error estimate for blocks of size 2^( 4) =       0.000546747853
  error estimate for blocks of size 2^( 5) =       0.000552850324
  error estimate for blocks of size 2^( 6) =       0.000556053995
  error estimate for blocks of size 2^( 7) =       0.000560914904

      target function =                  N/A
              le_mean =     -22.825058754152
             les_mean =     521.489233912129
             stat err =       0.000554141769
             autocorr =       1.213902713342
              std dev =       0.711285480396
             le_variance =       0.505927034622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504473579241
                                         uncertainty =       0.003754672405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504473579241
                                         uncertainty =       0.003754672405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502736210
  error estimate for blocks of size 2^( 2) =       0.000520601013
  error estimate for blocks of size 2^( 3) =       0.000535903213
  error estimate for blocks of size 2^( 4) =       0.000546558428
  error estimate for blocks of size 2^( 5) =       0.000552662087
  error estimate for blocks of size 2^( 6) =       0.000555870195
  error estimate for blocks of size 2^( 7) =       0.000560732319

      target function =                  N/A
              le_mean =     -22.825057865423
             les_mean =     521.488753700000
             stat err =       0.000553955757
             autocorr =       1.214142964907
              std dev =       0.710976365867
             le_variance =       0.505487392822


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825057789615        initial
     1.5625e-01     1.5625e+00             6.2062e-04       -22.825058730158
     6.2500e-01     6.2500e+00             2.0653e-04       -22.825058754152  <--
     2.5000e+00     2.5000e+01             6.6618e-05       -22.825057865423

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 1.0910e+02
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.651328e-01 1 1  ON 0
 uu_1                 9.100016e-02 1 1  ON 1
 uu_2                -2.022616e-02 1 1  ON 2
 uu_3                -8.563318e-02 1 1  ON 3
 uu_4                -1.234567e-01 1 1  ON 4
 uu_5                -1.465024e-01 1 1  ON 5
 uu_6                -1.600934e-01 1 1  ON 6
 uu_7                -1.636623e-01 1 1  ON 7
 uu_8                -1.551605e-01 1 1  ON 8
 uu_9                -1.287890e-01 1 1  ON 9
 ud_0                 4.349329e-01 1 1  ON 10
 ud_1                 1.528275e-01 1 1  ON 11
 ud_2                 7.232854e-03 1 1  ON 12
 ud_3                -7.243926e-02 1 1  ON 13
 ud_4                -1.194078e-01 1 1  ON 14
 ud_5                -1.492639e-01 1 1  ON 15
 ud_6                -1.674406e-01 1 1  ON 16
 ud_7                -1.746425e-01 1 1  ON 17
 ud_8                -1.672151e-01 1 1  ON 18
 ud_9                -1.450189e-01 1 1  ON 19
 eC_0                -5.733301e-01 1 1  ON 20
 eC_1                -4.188842e-01 1 1  ON 21
 eC_2                -1.686088e-01 1 1  ON 22
 eC_3                -2.150067e-02 1 1  ON 23
 eC_4                 2.681932e-02 1 1  ON 24
 eC_5                 1.120163e-01 1 1  ON 25
 eC_6                 2.327762e-01 1 1  ON 26
 eC_7                 4.122995e-01 1 1  ON 27
 eC_8                 3.093688e-01 1 1  ON 28
 eC_9                 7.921872e-02 1 1  ON 29
 eO_0                -1.255481e+00 1 1  ON 30
 eO_1                -8.777045e-01 1 1  ON 31
 eO_2                -3.993284e-01 1 1  ON 32
 eO_3                -5.520159e-02 1 1  ON 33
 eO_4                 1.740116e-01 1 1  ON 34
 eO_5                 3.609893e-01 1 1  ON 35
 eO_6                 4.593403e-01 1 1  ON 36
 eO_7                 5.334762e-01 1 1  ON 37
 eO_8                 5.149119e-01 1 1  ON 38
 eO_9                 3.604940e-01 1 1  ON 39
eH1_0                -1.855616e-01 1 1  ON 40
eH1_1                -9.829678e-02 1 1  ON 41
eH1_2                -6.579737e-02 1 1  ON 42
eH1_3                -5.106072e-02 1 1  ON 43
eH1_4                 9.283645e-03 1 1  ON 44
eH1_5                 6.667377e-02 1 1  ON 45
eH1_6                 1.242946e-01 1 1  ON 46
eH1_7                 1.031712e-01 1 1  ON 47
eH1_8                 6.652052e-03 1 1  ON 48
eH1_9                -2.124397e-02 1 1  ON 49
eH2_0                -1.877366e-01 1 1  ON 50
eH2_1                -1.006650e-01 1 1  ON 51
eH2_2                -6.837513e-02 1 1  ON 52
eH2_3                -5.337770e-02 1 1  ON 53
eH2_4                 6.816394e-03 1 1  ON 54
eH2_5                 6.377830e-02 1 1  ON 55
eH2_6                 1.214242e-01 1 1  ON 56
eH2_7                 1.000412e-01 1 1  ON 57
eH2_8                 9.981659e-03 1 1  ON 58
eH2_9                -5.857655e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1400e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7534
    reference variance = 0.447772
====================================================
  Execution time = 8.1224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0203e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6189e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502009488775
                                         uncertainty =       0.003708083360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502009488775
                                         uncertainty =       0.003708083360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501015738
  error estimate for blocks of size 2^( 2) =       0.000519059104
  error estimate for blocks of size 2^( 3) =       0.000534835015
  error estimate for blocks of size 2^( 4) =       0.000545133015
  error estimate for blocks of size 2^( 5) =       0.000553040776
  error estimate for blocks of size 2^( 6) =       0.000555565049
  error estimate for blocks of size 2^( 7) =       0.000558407884

      target function =                  N/A
              le_mean =     -22.823826464573
             les_mean =     521.429087773939
             stat err =       0.000553036681
             autocorr =       1.218442776336
              std dev =       0.708543252050
             le_variance =       0.502033540026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282382646457e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.823826464573       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.823826765564       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.823825730799       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.823825930717       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.823827506703       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.823827419982       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.823827598902       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.823827528694       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.823828155430       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.823828144306       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.823828181825       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.823828225696       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.823828215907       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.823828122928       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 1.207905e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.823826464573       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.823826593146       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.823826026511       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.823825959229       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.823826668006       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.823826776530       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.823826787849       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.823826792810       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.823826947360       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.823826962376       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.823826945720       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 3.913117e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.823826464573       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.823826503637       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.823826306730       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.823826261693       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.823826458702       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.823826528872       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.823826539096       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.823826557868       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.823826582320       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.823826579293       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 1.071659e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0742e+02
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.650111e-01 1 1  ON 0
 uu_1                 9.107958e-02 1 1  ON 1
 uu_2                -2.027111e-02 1 1  ON 2
 uu_3                -8.577566e-02 1 1  ON 3
 uu_4                -1.234609e-01 1 1  ON 4
 uu_5                -1.465150e-01 1 1  ON 5
 uu_6                -1.599969e-01 1 1  ON 6
 uu_7                -1.636348e-01 1 1  ON 7
 uu_8                -1.550439e-01 1 1  ON 8
 uu_9                -1.286664e-01 1 1  ON 9
 ud_0                 4.351298e-01 1 1  ON 10
 ud_1                 1.529680e-01 1 1  ON 11
 ud_2                 7.278688e-03 1 1  ON 12
 ud_3                -7.243265e-02 1 1  ON 13
 ud_4                -1.194188e-01 1 1  ON 14
 ud_5                -1.492743e-01 1 1  ON 15
 ud_6                -1.675682e-01 1 1  ON 16
 ud_7                -1.746260e-01 1 1  ON 17
 ud_8                -1.672696e-01 1 1  ON 18
 ud_9                -1.449238e-01 1 1  ON 19
 eC_0                -5.735672e-01 1 1  ON 20
 eC_1                -4.188308e-01 1 1  ON 21
 eC_2                -1.686442e-01 1 1  ON 22
 eC_3                -2.147284e-02 1 1  ON 23
 eC_4                 2.688117e-02 1 1  ON 24
 eC_5                 1.119984e-01 1 1  ON 25
 eC_6                 2.327240e-01 1 1  ON 26
 eC_7                 4.122444e-01 1 1  ON 27
 eC_8                 3.095313e-01 1 1  ON 28
 eC_9                 7.930047e-02 1 1  ON 29
 eO_0                -1.255872e+00 1 1  ON 30
 eO_1                -8.779361e-01 1 1  ON 31
 eO_2                -3.993031e-01 1 1  ON 32
 eO_3                -5.503591e-02 1 1  ON 33
 eO_4                 1.742518e-01 1 1  ON 34
 eO_5                 3.611671e-01 1 1  ON 35
 eO_6                 4.592503e-01 1 1  ON 36
 eO_7                 5.333789e-01 1 1  ON 37
 eO_8                 5.148350e-01 1 1  ON 38
 eO_9                 3.606142e-01 1 1  ON 39
eH1_0                -1.856632e-01 1 1  ON 40
eH1_1                -9.848857e-02 1 1  ON 41
eH1_2                -6.578459e-02 1 1  ON 42
eH1_3                -5.111878e-02 1 1  ON 43
eH1_4                 9.342846e-03 1 1  ON 44
eH1_5                 6.663897e-02 1 1  ON 45
eH1_6                 1.244016e-01 1 1  ON 46
eH1_7                 1.032876e-01 1 1  ON 47
eH1_8                 6.751637e-03 1 1  ON 48
eH1_9                -2.127669e-02 1 1  ON 49
eH2_0                -1.877121e-01 1 1  ON 50
eH2_1                -1.006305e-01 1 1  ON 51
eH2_2                -6.851515e-02 1 1  ON 52
eH2_3                -5.341554e-02 1 1  ON 53
eH2_4                 6.904345e-03 1 1  ON 54
eH2_5                 6.378937e-02 1 1  ON 55
eH2_6                 1.214189e-01 1 1  ON 56
eH2_7                 1.000202e-01 1 1  ON 57
eH2_8                 1.001990e-02 1 1  ON 58
eH2_9                -5.904096e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8441
    reference variance = 0.598816
====================================================
  Execution time = 7.7428e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0802e-01
  Total weights = 2.0000e+06
  Execution time = 6.2713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507806249299
                                         uncertainty =       0.004369948960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507806249299
                                         uncertainty =       0.004369948960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503863198
  error estimate for blocks of size 2^( 2) =       0.000521301522
  error estimate for blocks of size 2^( 3) =       0.000537372484
  error estimate for blocks of size 2^( 4) =       0.000549002715
  error estimate for blocks of size 2^( 5) =       0.000556035994
  error estimate for blocks of size 2^( 6) =       0.000559222702
  error estimate for blocks of size 2^( 7) =       0.000562064505

      target function =                  N/A
              le_mean =     -22.825373776753
             les_mean =     521.505444039088
             stat err =       0.000556581479
             autocorr =       1.220203379476
              std dev =       0.712570168105
             le_variance =       0.507756244473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508473941879
                                         uncertainty =       0.004377684481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508473941879
                                         uncertainty =       0.004377684481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504194346
  error estimate for blocks of size 2^( 2) =       0.000521613353
  error estimate for blocks of size 2^( 3) =       0.000537660666
  error estimate for blocks of size 2^( 4) =       0.000549270830
  error estimate for blocks of size 2^( 5) =       0.000556295636
  error estimate for blocks of size 2^( 6) =       0.000559477001
  error estimate for blocks of size 2^( 7) =       0.000562306974

      target function =                  N/A
              le_mean =     -22.825377750560
             les_mean =     521.506293077661
             stat err =       0.000556837610
             autocorr =       1.219722907777
              std dev =       0.713038481525
             le_variance =       0.508423876136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508342540907
                                         uncertainty =       0.004377409388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508342540907
                                         uncertainty =       0.004377409388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504129184
  error estimate for blocks of size 2^( 2) =       0.000521550511
  error estimate for blocks of size 2^( 3) =       0.000537602405
  error estimate for blocks of size 2^( 4) =       0.000549217206
  error estimate for blocks of size 2^( 5) =       0.000556242745
  error estimate for blocks of size 2^( 6) =       0.000559425917
  error estimate for blocks of size 2^( 7) =       0.000562256581

      target function =                  N/A
              le_mean =     -22.825377418154
             les_mean =     521.506146494528
             stat err =       0.000556785612
             autocorr =       1.219810395286
              std dev =       0.712946328633
             le_variance =       0.508292467511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507886943525
                                         uncertainty =       0.004371204862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507886943525
                                         uncertainty =       0.004371204862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503903227
  error estimate for blocks of size 2^( 2) =       0.000521338841
  error estimate for blocks of size 2^( 3) =       0.000537406961
  error estimate for blocks of size 2^( 4) =       0.000549034799
  error estimate for blocks of size 2^( 5) =       0.000556066813
  error estimate for blocks of size 2^( 6) =       0.000559253030
  error estimate for blocks of size 2^( 7) =       0.000562092539

      target function =                  N/A
              le_mean =     -22.825374270167
             les_mean =     521.505547243923
             stat err =       0.000556611795
             autocorr =       1.220142433979
              std dev =       0.712626777933
             le_variance =       0.507836924627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825373776753        initial
     1.5625e-01     1.5625e+00             1.2079e-03       -22.825377750560  <--
     6.2500e-01     6.2500e+00             3.9131e-04       -22.825377418154
     2.5000e+00     2.5000e+01             1.0717e-04       -22.825374270167

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 1.0888e+02
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.649690e-01 1 1  ON 0
 uu_1                 9.110170e-02 1 1  ON 1
 uu_2                -2.038506e-02 1 1  ON 2
 uu_3                -8.597655e-02 1 1  ON 3
 uu_4                -1.235739e-01 1 1  ON 4
 uu_5                -1.465616e-01 1 1  ON 5
 uu_6                -1.598953e-01 1 1  ON 6
 uu_7                -1.635178e-01 1 1  ON 7
 uu_8                -1.547626e-01 1 1  ON 8
 uu_9                -1.283254e-01 1 1  ON 9
 ud_0                 4.355277e-01 1 1  ON 10
 ud_1                 1.532832e-01 1 1  ON 11
 ud_2                 7.474094e-03 1 1  ON 12
 ud_3                -7.234458e-02 1 1  ON 13
 ud_4                -1.194133e-01 1 1  ON 14
 ud_5                -1.493183e-01 1 1  ON 15
 ud_6                -1.677450e-01 1 1  ON 16
 ud_7                -1.746229e-01 1 1  ON 17
 ud_8                -1.674065e-01 1 1  ON 18
 ud_9                -1.446757e-01 1 1  ON 19
 eC_0                -5.739911e-01 1 1  ON 20
 eC_1                -4.188442e-01 1 1  ON 21
 eC_2                -1.687762e-01 1 1  ON 22
 eC_3                -2.145616e-02 1 1  ON 23
 eC_4                 2.702897e-02 1 1  ON 24
 eC_5                 1.119779e-01 1 1  ON 25
 eC_6                 2.325589e-01 1 1  ON 26
 eC_7                 4.120762e-01 1 1  ON 27
 eC_8                 3.100152e-01 1 1  ON 28
 eC_9                 7.954475e-02 1 1  ON 29
 eO_0                -1.256689e+00 1 1  ON 30
 eO_1                -8.784901e-01 1 1  ON 31
 eO_2                -3.994433e-01 1 1  ON 32
 eO_3                -5.477521e-02 1 1  ON 33
 eO_4                 1.747822e-01 1 1  ON 34
 eO_5                 3.617043e-01 1 1  ON 35
 eO_6                 4.591258e-01 1 1  ON 36
 eO_7                 5.331005e-01 1 1  ON 37
 eO_8                 5.145932e-01 1 1  ON 38
 eO_9                 3.609688e-01 1 1  ON 39
eH1_0                -1.859633e-01 1 1  ON 40
eH1_1                -9.887487e-02 1 1  ON 41
eH1_2                -6.586555e-02 1 1  ON 42
eH1_3                -5.123772e-02 1 1  ON 43
eH1_4                 9.466787e-03 1 1  ON 44
eH1_5                 6.666171e-02 1 1  ON 45
eH1_6                 1.245558e-01 1 1  ON 46
eH1_7                 1.036006e-01 1 1  ON 47
eH1_8                 7.048846e-03 1 1  ON 48
eH1_9                -2.137299e-02 1 1  ON 49
eH2_0                -1.877102e-01 1 1  ON 50
eH2_1                -1.006977e-01 1 1  ON 51
eH2_2                -6.874914e-02 1 1  ON 52
eH2_3                -5.346083e-02 1 1  ON 53
eH2_4                 7.069680e-03 1 1  ON 54
eH2_5                 6.386217e-02 1 1  ON 55
eH2_6                 1.214408e-01 1 1  ON 56
eH2_7                 9.997477e-02 1 1  ON 57
eH2_8                 1.012716e-02 1 1  ON 58
eH2_9                -6.043501e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1631e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.798
    reference variance = 0.456513
====================================================
  Execution time = 7.8415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0927e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7129e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509326129012
                                         uncertainty =       0.003722343023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509326129012
                                         uncertainty =       0.003722343023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504613004
  error estimate for blocks of size 2^( 2) =       0.000522866855
  error estimate for blocks of size 2^( 3) =       0.000537971062
  error estimate for blocks of size 2^( 4) =       0.000548450592
  error estimate for blocks of size 2^( 5) =       0.000554879798
  error estimate for blocks of size 2^( 6) =       0.000558254811
  error estimate for blocks of size 2^( 7) =       0.000562426697

      target function =                  N/A
              le_mean =     -22.825576068656
             les_mean =     521.516191179718
             stat err =       0.000556002974
             autocorr =       1.214052179370
              std dev =       0.713630554528
             le_variance =       0.509268568356


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282557606866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825576068656       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825579414903       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825579820441       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825581060299       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825582459804       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825582851376       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825584181171       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825583507557       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825582842135       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825583593848       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825584907138       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825585547077       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825584946382       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825584502904       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825585204309       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825585757192       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825585492726       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825585557580       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.825585531919       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 2.274859e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825576068656       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825578296698       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825578652761       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825579123650       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825580314632       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825580451823       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825581244136       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825580961633       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825580531116       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825580802918       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825581224525       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825581234942       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825581004668       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825581044356       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 6.773277e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825576068656       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825577022168       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825577271291       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825577331436       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825577926849       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825577953882       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825578228891       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825578110908       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825577974780       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825578075554       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825578132012       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 1.973336e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0556e+02
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.651730e-01 1 1  ON 0
 uu_1                 9.094775e-02 1 1  ON 1
 uu_2                -2.036492e-02 1 1  ON 2
 uu_3                -8.598032e-02 1 1  ON 3
 uu_4                -1.235514e-01 1 1  ON 4
 uu_5                -1.465070e-01 1 1  ON 5
 uu_6                -1.597517e-01 1 1  ON 6
 uu_7                -1.633321e-01 1 1  ON 7
 uu_8                -1.543237e-01 1 1  ON 8
 uu_9                -1.282033e-01 1 1  ON 9
 ud_0                 4.358198e-01 1 1  ON 10
 ud_1                 1.534867e-01 1 1  ON 11
 ud_2                 7.874161e-03 1 1  ON 12
 ud_3                -7.208055e-02 1 1  ON 13
 ud_4                -1.192574e-01 1 1  ON 14
 ud_5                -1.492493e-01 1 1  ON 15
 ud_6                -1.677987e-01 1 1  ON 16
 ud_7                -1.750311e-01 1 1  ON 17
 ud_8                -1.672070e-01 1 1  ON 18
 ud_9                -1.440884e-01 1 1  ON 19
 eC_0                -5.739789e-01 1 1  ON 20
 eC_1                -4.191977e-01 1 1  ON 21
 eC_2                -1.692916e-01 1 1  ON 22
 eC_3                -2.135674e-02 1 1  ON 23
 eC_4                 2.705745e-02 1 1  ON 24
 eC_5                 1.124509e-01 1 1  ON 25
 eC_6                 2.323276e-01 1 1  ON 26
 eC_7                 4.118257e-01 1 1  ON 27
 eC_8                 3.105038e-01 1 1  ON 28
 eC_9                 7.976142e-02 1 1  ON 29
 eO_0                -1.257366e+00 1 1  ON 30
 eO_1                -8.790378e-01 1 1  ON 31
 eO_2                -3.998851e-01 1 1  ON 32
 eO_3                -5.495154e-02 1 1  ON 33
 eO_4                 1.751504e-01 1 1  ON 34
 eO_5                 3.621129e-01 1 1  ON 35
 eO_6                 4.595728e-01 1 1  ON 36
 eO_7                 5.330986e-01 1 1  ON 37
 eO_8                 5.144368e-01 1 1  ON 38
 eO_9                 3.613591e-01 1 1  ON 39
eH1_0                -1.860189e-01 1 1  ON 40
eH1_1                -9.880839e-02 1 1  ON 41
eH1_2                -6.612135e-02 1 1  ON 42
eH1_3                -5.096407e-02 1 1  ON 43
eH1_4                 9.770524e-03 1 1  ON 44
eH1_5                 6.639991e-02 1 1  ON 45
eH1_6                 1.242648e-01 1 1  ON 46
eH1_7                 1.034345e-01 1 1  ON 47
eH1_8                 7.539502e-03 1 1  ON 48
eH1_9                -2.161817e-02 1 1  ON 49
eH2_0                -1.883585e-01 1 1  ON 50
eH2_1                -1.008323e-01 1 1  ON 51
eH2_2                -6.889207e-02 1 1  ON 52
eH2_3                -5.329179e-02 1 1  ON 53
eH2_4                 7.291347e-03 1 1  ON 54
eH2_5                 6.388813e-02 1 1  ON 55
eH2_6                 1.216968e-01 1 1  ON 56
eH2_7                 1.003840e-01 1 1  ON 57
eH2_8                 1.005868e-02 1 1  ON 58
eH2_9                -6.372148e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8707
    reference variance = 0.251687
====================================================
  Execution time = 7.8556e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0833e-01
  Total weights = 2.0000e+06
  Execution time = 6.2916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508490609929
                                         uncertainty =       0.003421884435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508490609929
                                         uncertainty =       0.003421884435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504216036
  error estimate for blocks of size 2^( 2) =       0.000521938433
  error estimate for blocks of size 2^( 3) =       0.000537268449
  error estimate for blocks of size 2^( 4) =       0.000548270508
  error estimate for blocks of size 2^( 5) =       0.000555599909
  error estimate for blocks of size 2^( 6) =       0.000558842949
  error estimate for blocks of size 2^( 7) =       0.000561414831

      target function =                  N/A
              le_mean =     -22.825493856665
             les_mean =     521.511637167435
             stat err =       0.000556032049
             autocorr =       1.216091750616
              std dev =       0.713069155856
             le_variance =       0.508467621033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508510143652
                                         uncertainty =       0.003425534998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508510143652
                                         uncertainty =       0.003425534998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504225728
  error estimate for blocks of size 2^( 2) =       0.000521956222
  error estimate for blocks of size 2^( 3) =       0.000537292308
  error estimate for blocks of size 2^( 4) =       0.000548294455
  error estimate for blocks of size 2^( 5) =       0.000555626475
  error estimate for blocks of size 2^( 6) =       0.000558863547
  error estimate for blocks of size 2^( 7) =       0.000561431767

      target function =                  N/A
              le_mean =     -22.825492314850
             les_mean =     521.511586331519
             stat err =       0.000556054061
             autocorr =       1.216141277433
              std dev =       0.713082863673
             le_variance =       0.508487170464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508231547178
                                         uncertainty =       0.003423766008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508231547178
                                         uncertainty =       0.003423766008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504087598
  error estimate for blocks of size 2^( 2) =       0.000521828716
  error estimate for blocks of size 2^( 3) =       0.000537176940
  error estimate for blocks of size 2^( 4) =       0.000548188354
  error estimate for blocks of size 2^( 5) =       0.000555524312
  error estimate for blocks of size 2^( 6) =       0.000558761985
  error estimate for blocks of size 2^( 7) =       0.000561329239

      target function =                  N/A
              le_mean =     -22.825494386393
             les_mean =     521.511402342689
             stat err =       0.000555950972
             autocorr =       1.216356730469
              std dev =       0.712887518144
             le_variance =       0.508208613525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508411578720
                                         uncertainty =       0.003422191312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508411578720
                                         uncertainty =       0.003422191312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504176862
  error estimate for blocks of size 2^( 2) =       0.000521904263
  error estimate for blocks of size 2^( 3) =       0.000537239503
  error estimate for blocks of size 2^( 4) =       0.000548244594
  error estimate for blocks of size 2^( 5) =       0.000555575438
  error estimate for blocks of size 2^( 6) =       0.000558817497
  error estimate for blocks of size 2^( 7) =       0.000561386839

      target function =                  N/A
              le_mean =     -22.825493827912
             les_mean =     521.511556850418
             stat err =       0.000556006092
             autocorr =       1.216167176534
              std dev =       0.713013756208
             le_variance =       0.508388616542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825493856665        initial
     3.9062e-02     3.9062e-01             2.2749e-03       -22.825492314850
     1.5625e-01     1.5625e+00             6.7733e-04       -22.825494386393  <--
     6.2500e-01     6.2500e+00             1.9733e-04       -22.825493827912

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 1.1010e+02
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.651730e-01 1 1  ON 0
 uu_1                 9.094775e-02 1 1  ON 1
 uu_2                -2.036492e-02 1 1  ON 2
 uu_3                -8.598032e-02 1 1  ON 3
 uu_4                -1.235514e-01 1 1  ON 4
 uu_5                -1.465070e-01 1 1  ON 5
 uu_6                -1.597517e-01 1 1  ON 6
 uu_7                -1.633321e-01 1 1  ON 7
 uu_8                -1.543237e-01 1 1  ON 8
 uu_9                -1.282033e-01 1 1  ON 9
 ud_0                 4.358198e-01 1 1  ON 10
 ud_1                 1.534867e-01 1 1  ON 11
 ud_2                 7.874161e-03 1 1  ON 12
 ud_3                -7.208055e-02 1 1  ON 13
 ud_4                -1.192574e-01 1 1  ON 14
 ud_5                -1.492493e-01 1 1  ON 15
 ud_6                -1.677987e-01 1 1  ON 16
 ud_7                -1.750311e-01 1 1  ON 17
 ud_8                -1.672070e-01 1 1  ON 18
 ud_9                -1.440884e-01 1 1  ON 19
 eC_0                -5.739789e-01 1 1  ON 20
 eC_1                -4.191977e-01 1 1  ON 21
 eC_2                -1.692916e-01 1 1  ON 22
 eC_3                -2.135674e-02 1 1  ON 23
 eC_4                 2.705745e-02 1 1  ON 24
 eC_5                 1.124509e-01 1 1  ON 25
 eC_6                 2.323276e-01 1 1  ON 26
 eC_7                 4.118257e-01 1 1  ON 27
 eC_8                 3.105038e-01 1 1  ON 28
 eC_9                 7.976142e-02 1 1  ON 29
 eO_0                -1.257366e+00 1 1  ON 30
 eO_1                -8.790378e-01 1 1  ON 31
 eO_2                -3.998851e-01 1 1  ON 32
 eO_3                -5.495154e-02 1 1  ON 33
 eO_4                 1.751504e-01 1 1  ON 34
 eO_5                 3.621129e-01 1 1  ON 35
 eO_6                 4.595728e-01 1 1  ON 36
 eO_7                 5.330986e-01 1 1  ON 37
 eO_8                 5.144368e-01 1 1  ON 38
 eO_9                 3.613591e-01 1 1  ON 39
eH1_0                -1.860189e-01 1 1  ON 40
eH1_1                -9.880839e-02 1 1  ON 41
eH1_2                -6.612135e-02 1 1  ON 42
eH1_3                -5.096407e-02 1 1  ON 43
eH1_4                 9.770524e-03 1 1  ON 44
eH1_5                 6.639991e-02 1 1  ON 45
eH1_6                 1.242648e-01 1 1  ON 46
eH1_7                 1.034345e-01 1 1  ON 47
eH1_8                 7.539502e-03 1 1  ON 48
eH1_9                -2.161817e-02 1 1  ON 49
eH2_0                -1.883585e-01 1 1  ON 50
eH2_1                -1.008323e-01 1 1  ON 51
eH2_2                -6.889207e-02 1 1  ON 52
eH2_3                -5.329179e-02 1 1  ON 53
eH2_4                 7.291347e-03 1 1  ON 54
eH2_5                 6.388813e-02 1 1  ON 55
eH2_6                 1.216968e-01 1 1  ON 56
eH2_7                 1.003840e-01 1 1  ON 57
eH2_8                 1.005868e-02 1 1  ON 58
eH2_9                -6.372148e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1566e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8059
    reference variance = 0.290022
====================================================
  Execution time = 7.8465e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0413e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7153e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504148442963
                                         uncertainty =       0.003489845615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504148442963
                                         uncertainty =       0.003489845615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502059267
  error estimate for blocks of size 2^( 2) =       0.000519644609
  error estimate for blocks of size 2^( 3) =       0.000534867755
  error estimate for blocks of size 2^( 4) =       0.000545449028
  error estimate for blocks of size 2^( 5) =       0.000553373574
  error estimate for blocks of size 2^( 6) =       0.000556357016
  error estimate for blocks of size 2^( 7) =       0.000559447644

      target function =                  N/A
              le_mean =     -22.825560412041
             les_mean =     521.510334887806
             stat err =       0.000553656816
             autocorr =       1.216105701893
              std dev =       0.710019025196
             le_variance =       0.504127016140


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282556041204e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825560412041       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825560907819       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825562489589       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825563208194       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825565150060       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825566776782       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825566606524       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825566768030       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825566490305       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825566941485       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825567686949       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825567326225       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825566461101       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825566354734       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825566833406       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825566958771       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825567318379       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825567669298       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.825567569817       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 2.111952e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825560412041       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825560749662       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825561778920       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825562146993       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825563250913       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825564411180       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825564425960       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825564195057       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825564100436       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825564388593       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825564417651       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825564273583       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825564148027       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825564183534       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 6.645764e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825560412041       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825560560379       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825561000469       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825561172378       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825561552875       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825562098676       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825562146477       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825561994468       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825561954773       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825562007029       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825561974342       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 2.034575e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0563e+02
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.650219e-01 1 1  ON 0
 uu_1                 9.103894e-02 1 1  ON 1
 uu_2                -2.037142e-02 1 1  ON 2
 uu_3                -8.588599e-02 1 1  ON 3
 uu_4                -1.236230e-01 1 1  ON 4
 uu_5                -1.466186e-01 1 1  ON 5
 uu_6                -1.600179e-01 1 1  ON 6
 uu_7                -1.632904e-01 1 1  ON 7
 uu_8                -1.536591e-01 1 1  ON 8
 uu_9                -1.278856e-01 1 1  ON 9
 ud_0                 4.359164e-01 1 1  ON 10
 ud_1                 1.535410e-01 1 1  ON 11
 ud_2                 8.041419e-03 1 1  ON 12
 ud_3                -7.199805e-02 1 1  ON 13
 ud_4                -1.191825e-01 1 1  ON 14
 ud_5                -1.492102e-01 1 1  ON 15
 ud_6                -1.673521e-01 1 1  ON 16
 ud_7                -1.747562e-01 1 1  ON 17
 ud_8                -1.671982e-01 1 1  ON 18
 ud_9                -1.439559e-01 1 1  ON 19
 eC_0                -5.740686e-01 1 1  ON 20
 eC_1                -4.187813e-01 1 1  ON 21
 eC_2                -1.694047e-01 1 1  ON 22
 eC_3                -2.160815e-02 1 1  ON 23
 eC_4                 2.708499e-02 1 1  ON 24
 eC_5                 1.125344e-01 1 1  ON 25
 eC_6                 2.319013e-01 1 1  ON 26
 eC_7                 4.113381e-01 1 1  ON 27
 eC_8                 3.110172e-01 1 1  ON 28
 eC_9                 8.005539e-02 1 1  ON 29
 eO_0                -1.257543e+00 1 1  ON 30
 eO_1                -8.792972e-01 1 1  ON 31
 eO_2                -4.001558e-01 1 1  ON 32
 eO_3                -5.495516e-02 1 1  ON 33
 eO_4                 1.752630e-01 1 1  ON 34
 eO_5                 3.622209e-01 1 1  ON 35
 eO_6                 4.595270e-01 1 1  ON 36
 eO_7                 5.327980e-01 1 1  ON 37
 eO_8                 5.142080e-01 1 1  ON 38
 eO_9                 3.618870e-01 1 1  ON 39
eH1_0                -1.857567e-01 1 1  ON 40
eH1_1                -9.860192e-02 1 1  ON 41
eH1_2                -6.657588e-02 1 1  ON 42
eH1_3                -5.116603e-02 1 1  ON 43
eH1_4                 9.776658e-03 1 1  ON 44
eH1_5                 6.626960e-02 1 1  ON 45
eH1_6                 1.242203e-01 1 1  ON 46
eH1_7                 1.036140e-01 1 1  ON 47
eH1_8                 7.856291e-03 1 1  ON 48
eH1_9                -2.195292e-02 1 1  ON 49
eH2_0                -1.884867e-01 1 1  ON 50
eH2_1                -1.012686e-01 1 1  ON 51
eH2_2                -6.876911e-02 1 1  ON 52
eH2_3                -5.320259e-02 1 1  ON 53
eH2_4                 7.596699e-03 1 1  ON 54
eH2_5                 6.439980e-02 1 1  ON 55
eH2_6                 1.220590e-01 1 1  ON 56
eH2_7                 1.002640e-01 1 1  ON 57
eH2_8                 9.757760e-03 1 1  ON 58
eH2_9                -6.907707e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7638
    reference variance = 0.479982
====================================================
  Execution time = 7.7096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0873e-01
  Total weights = 2.0000e+06
  Execution time = 6.2706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508859770422
                                         uncertainty =       0.005308393204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508859770422
                                         uncertainty =       0.005308393204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504380834
  error estimate for blocks of size 2^( 2) =       0.000522673523
  error estimate for blocks of size 2^( 3) =       0.000538348656
  error estimate for blocks of size 2^( 4) =       0.000549105539
  error estimate for blocks of size 2^( 5) =       0.000556778847
  error estimate for blocks of size 2^( 6) =       0.000560161331
  error estimate for blocks of size 2^( 7) =       0.000562394076

      target function =                  N/A
              le_mean =     -22.826165575926
             les_mean =     521.542634695676
             stat err =       0.000557109948
             autocorr =       1.220013615771
              std dev =       0.713302215409
             le_variance =       0.508800050507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508781852829
                                         uncertainty =       0.005305887841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508781852829
                                         uncertainty =       0.005305887841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504342216
  error estimate for blocks of size 2^( 2) =       0.000522637890
  error estimate for blocks of size 2^( 3) =       0.000538309487
  error estimate for blocks of size 2^( 4) =       0.000549065062
  error estimate for blocks of size 2^( 5) =       0.000556736588
  error estimate for blocks of size 2^( 6) =       0.000560103464
  error estimate for blocks of size 2^( 7) =       0.000562337521

      target function =                  N/A
              le_mean =     -22.826167903925
             les_mean =     521.542663066299
             stat err =       0.000557060659
             autocorr =       1.219984552984
              std dev =       0.713247602524
             le_variance =       0.508722142507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508721816306
                                         uncertainty =       0.005304054070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508721816306
                                         uncertainty =       0.005304054070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504312408
  error estimate for blocks of size 2^( 2) =       0.000522611231
  error estimate for blocks of size 2^( 3) =       0.000538283605
  error estimate for blocks of size 2^( 4) =       0.000549043104
  error estimate for blocks of size 2^( 5) =       0.000556714952
  error estimate for blocks of size 2^( 6) =       0.000560075212
  error estimate for blocks of size 2^( 7) =       0.000562306026

      target function =                  N/A
              le_mean =     -22.826169648535
             les_mean =     521.542682579464
             stat err =       0.000557034823
             autocorr =       1.220015602929
              std dev =       0.713205447338
             le_variance =       0.508662010113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508816298048
                                         uncertainty =       0.005307258815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508816298048
                                         uncertainty =       0.005307258815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504359265
  error estimate for blocks of size 2^( 2) =       0.000522653480
  error estimate for blocks of size 2^( 3) =       0.000538328013
  error estimate for blocks of size 2^( 4) =       0.000549085856
  error estimate for blocks of size 2^( 5) =       0.000556759029
  error estimate for blocks of size 2^( 6) =       0.000560136666
  error estimate for blocks of size 2^( 7) =       0.000562368385

      target function =                  N/A
              le_mean =     -22.826165998771
             les_mean =     521.542610484526
             stat err =       0.000557087484
             autocorr =       1.220019568926
              std dev =       0.713271712230
             le_variance =       0.508756535467


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826165575926        initial
     3.9062e-02     3.9062e-01             2.1120e-03       -22.826167903925
     1.5625e-01     1.5625e+00             6.6458e-04       -22.826169648535  <--
     6.2500e-01     6.2500e+00             2.0346e-04       -22.826165998771

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 1.0856e+02
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.650219e-01 1 1  ON 0
 uu_1                 9.103894e-02 1 1  ON 1
 uu_2                -2.037142e-02 1 1  ON 2
 uu_3                -8.588599e-02 1 1  ON 3
 uu_4                -1.236230e-01 1 1  ON 4
 uu_5                -1.466186e-01 1 1  ON 5
 uu_6                -1.600179e-01 1 1  ON 6
 uu_7                -1.632904e-01 1 1  ON 7
 uu_8                -1.536591e-01 1 1  ON 8
 uu_9                -1.278856e-01 1 1  ON 9
 ud_0                 4.359164e-01 1 1  ON 10
 ud_1                 1.535410e-01 1 1  ON 11
 ud_2                 8.041419e-03 1 1  ON 12
 ud_3                -7.199805e-02 1 1  ON 13
 ud_4                -1.191825e-01 1 1  ON 14
 ud_5                -1.492102e-01 1 1  ON 15
 ud_6                -1.673521e-01 1 1  ON 16
 ud_7                -1.747562e-01 1 1  ON 17
 ud_8                -1.671982e-01 1 1  ON 18
 ud_9                -1.439559e-01 1 1  ON 19
 eC_0                -5.740686e-01 1 1  ON 20
 eC_1                -4.187813e-01 1 1  ON 21
 eC_2                -1.694047e-01 1 1  ON 22
 eC_3                -2.160815e-02 1 1  ON 23
 eC_4                 2.708499e-02 1 1  ON 24
 eC_5                 1.125344e-01 1 1  ON 25
 eC_6                 2.319013e-01 1 1  ON 26
 eC_7                 4.113381e-01 1 1  ON 27
 eC_8                 3.110172e-01 1 1  ON 28
 eC_9                 8.005539e-02 1 1  ON 29
 eO_0                -1.257543e+00 1 1  ON 30
 eO_1                -8.792972e-01 1 1  ON 31
 eO_2                -4.001558e-01 1 1  ON 32
 eO_3                -5.495516e-02 1 1  ON 33
 eO_4                 1.752630e-01 1 1  ON 34
 eO_5                 3.622209e-01 1 1  ON 35
 eO_6                 4.595270e-01 1 1  ON 36
 eO_7                 5.327980e-01 1 1  ON 37
 eO_8                 5.142080e-01 1 1  ON 38
 eO_9                 3.618870e-01 1 1  ON 39
eH1_0                -1.857567e-01 1 1  ON 40
eH1_1                -9.860192e-02 1 1  ON 41
eH1_2                -6.657588e-02 1 1  ON 42
eH1_3                -5.116603e-02 1 1  ON 43
eH1_4                 9.776658e-03 1 1  ON 44
eH1_5                 6.626960e-02 1 1  ON 45
eH1_6                 1.242203e-01 1 1  ON 46
eH1_7                 1.036140e-01 1 1  ON 47
eH1_8                 7.856291e-03 1 1  ON 48
eH1_9                -2.195292e-02 1 1  ON 49
eH2_0                -1.884867e-01 1 1  ON 50
eH2_1                -1.012686e-01 1 1  ON 51
eH2_2                -6.876911e-02 1 1  ON 52
eH2_3                -5.320259e-02 1 1  ON 53
eH2_4                 7.596699e-03 1 1  ON 54
eH2_5                 6.439980e-02 1 1  ON 55
eH2_6                 1.220590e-01 1 1  ON 56
eH2_7                 1.002640e-01 1 1  ON 57
eH2_8                 9.757760e-03 1 1  ON 58
eH2_9                -6.907707e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1420e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.9591
    reference variance = 0.506736
====================================================
  Execution time = 7.9910e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0576e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6854e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505841501538
                                         uncertainty =       0.005156794618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505841501538
                                         uncertainty =       0.005156794618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502870475
  error estimate for blocks of size 2^( 2) =       0.000520542532
  error estimate for blocks of size 2^( 3) =       0.000536449124
  error estimate for blocks of size 2^( 4) =       0.000547060089
  error estimate for blocks of size 2^( 5) =       0.000553840804
  error estimate for blocks of size 2^( 6) =       0.000556946604
  error estimate for blocks of size 2^( 7) =       0.000558817741

      target function =                  N/A
              le_mean =     -22.825377966154
             les_mean =     521.503636474566
             stat err =       0.000554166310
             autocorr =       1.214417349546
              std dev =       0.711166246160
             le_variance =       0.505757429677


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282537796615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825377966154       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825379880095       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825376421825       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825378702794       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825378886815       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825379863335       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825380476086       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825382384015       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825382648837       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825382269927       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825382202747       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825384064345       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825384661898       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825384225516       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825383887049       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825383893648       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825383805504       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825383633326       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.825383861974       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 2.055217e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825377966154       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825379115529       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825376419422       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825378010241       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825378196509       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825378653192       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825378980996       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825379804434       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825380019361       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825379569906       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825379324776       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825379735901       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825379814038       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825379694224       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 8.169904e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825377966154       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825378408580       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825376999007       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825377741141       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825377887527       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825377975685       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825378085202       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825378307913       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825378320860       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825378208669       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825378119967       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 2.744372e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060969 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0678e+02
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.650016e-01 1 1  ON 0
 uu_1                 9.125717e-02 1 1  ON 1
 uu_2                -2.021718e-02 1 1  ON 2
 uu_3                -8.586198e-02 1 1  ON 3
 uu_4                -1.235926e-01 1 1  ON 4
 uu_5                -1.465160e-01 1 1  ON 5
 uu_6                -1.599817e-01 1 1  ON 6
 uu_7                -1.633402e-01 1 1  ON 7
 uu_8                -1.533077e-01 1 1  ON 8
 uu_9                -1.278532e-01 1 1  ON 9
 ud_0                 4.361470e-01 1 1  ON 10
 ud_1                 1.538946e-01 1 1  ON 11
 ud_2                 8.255523e-03 1 1  ON 12
 ud_3                -7.174567e-02 1 1  ON 13
 ud_4                -1.189004e-01 1 1  ON 14
 ud_5                -1.490274e-01 1 1  ON 15
 ud_6                -1.673552e-01 1 1  ON 16
 ud_7                -1.747028e-01 1 1  ON 17
 ud_8                -1.673517e-01 1 1  ON 18
 ud_9                -1.440447e-01 1 1  ON 19
 eC_0                -5.739210e-01 1 1  ON 20
 eC_1                -4.189373e-01 1 1  ON 21
 eC_2                -1.693921e-01 1 1  ON 22
 eC_3                -2.203904e-02 1 1  ON 23
 eC_4                 2.681535e-02 1 1  ON 24
 eC_5                 1.130195e-01 1 1  ON 25
 eC_6                 2.317817e-01 1 1  ON 26
 eC_7                 4.108628e-01 1 1  ON 27
 eC_8                 3.115428e-01 1 1  ON 28
 eC_9                 8.032386e-02 1 1  ON 29
 eO_0                -1.257987e+00 1 1  ON 30
 eO_1                -8.799289e-01 1 1  ON 31
 eO_2                -4.004032e-01 1 1  ON 32
 eO_3                -5.490910e-02 1 1  ON 33
 eO_4                 1.753422e-01 1 1  ON 34
 eO_5                 3.625367e-01 1 1  ON 35
 eO_6                 4.596949e-01 1 1  ON 36
 eO_7                 5.329567e-01 1 1  ON 37
 eO_8                 5.138844e-01 1 1  ON 38
 eO_9                 3.622790e-01 1 1  ON 39
eH1_0                -1.863755e-01 1 1  ON 40
eH1_1                -9.899274e-02 1 1  ON 41
eH1_2                -6.610002e-02 1 1  ON 42
eH1_3                -5.105405e-02 1 1  ON 43
eH1_4                 9.864334e-03 1 1  ON 44
eH1_5                 6.700590e-02 1 1  ON 45
eH1_6                 1.240888e-01 1 1  ON 46
eH1_7                 1.032592e-01 1 1  ON 47
eH1_8                 8.080108e-03 1 1  ON 48
eH1_9                -2.217460e-02 1 1  ON 49
eH2_0                -1.893036e-01 1 1  ON 50
eH2_1                -1.013449e-01 1 1  ON 51
eH2_2                -6.871832e-02 1 1  ON 52
eH2_3                -5.322142e-02 1 1  ON 53
eH2_4                 7.880048e-03 1 1  ON 54
eH2_5                 6.506140e-02 1 1  ON 55
eH2_6                 1.222787e-01 1 1  ON 56
eH2_7                 1.003758e-01 1 1  ON 57
eH2_8                 9.516655e-03 1 1  ON 58
eH2_9                -7.302163e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7955
    reference variance = 0.369778
====================================================
  Execution time = 7.6787e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0024e-01
  Total weights = 2.0000e+06
  Execution time = 6.2797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500394707539
                                         uncertainty =       0.004364133870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500394707539
                                         uncertainty =       0.004364133870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500158466
  error estimate for blocks of size 2^( 2) =       0.000517762199
  error estimate for blocks of size 2^( 3) =       0.000534154749
  error estimate for blocks of size 2^( 4) =       0.000544922114
  error estimate for blocks of size 2^( 5) =       0.000551321167
  error estimate for blocks of size 2^( 6) =       0.000553680064
  error estimate for blocks of size 2^( 7) =       0.000554001819

      target function =                  N/A
              le_mean =     -22.825205788386
             les_mean =     521.490336013720
             stat err =       0.000550981291
             autocorr =       1.213552184825
              std dev =       0.707330885593
             le_variance =       0.500316981714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500427619710
                                         uncertainty =       0.004349860259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500427619710
                                         uncertainty =       0.004349860259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500174950
  error estimate for blocks of size 2^( 2) =       0.000517774392
  error estimate for blocks of size 2^( 3) =       0.000534164838
  error estimate for blocks of size 2^( 4) =       0.000544929417
  error estimate for blocks of size 2^( 5) =       0.000551330169
  error estimate for blocks of size 2^( 6) =       0.000553681291
  error estimate for blocks of size 2^( 7) =       0.000553980744

      target function =                  N/A
              le_mean =     -22.825206124879
             les_mean =     521.490384354187
             stat err =       0.000550980405
             autocorr =       1.213468293468
              std dev =       0.707354197813
             le_variance =       0.500349961163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500253292893
                                         uncertainty =       0.004344050070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500253292893
                                         uncertainty =       0.004344050070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500087851
  error estimate for blocks of size 2^( 2) =       0.000517690045
  error estimate for blocks of size 2^( 3) =       0.000534086294
  error estimate for blocks of size 2^( 4) =       0.000544856692
  error estimate for blocks of size 2^( 5) =       0.000551261285
  error estimate for blocks of size 2^( 6) =       0.000553609977
  error estimate for blocks of size 2^( 7) =       0.000553912259

      target function =                  N/A
              le_mean =     -22.825207965210
             les_mean =     521.490294121492
             stat err =       0.000550910053
             autocorr =       1.213581054786
              std dev =       0.707231020589
             le_variance =       0.500175716483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500349625397
                                         uncertainty =       0.004359402685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500349625397
                                         uncertainty =       0.004359402685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500135948
  error estimate for blocks of size 2^( 2) =       0.000517738974
  error estimate for blocks of size 2^( 3) =       0.000534132371
  error estimate for blocks of size 2^( 4) =       0.000544900397
  error estimate for blocks of size 2^( 5) =       0.000551300857
  error estimate for blocks of size 2^( 6) =       0.000553656674
  error estimate for blocks of size 2^( 7) =       0.000553974516

      target function =                  N/A
              le_mean =     -22.825205701748
             les_mean =     521.490287010563
             stat err =       0.000550958111
             autocorr =       1.213559344949
              std dev =       0.707299041123
             le_variance =       0.500271933574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825205788386        initial
     3.9062e-02     3.9062e-01             2.0552e-03       -22.825206124879
     1.5625e-01     1.5625e+00             8.1699e-04       -22.825207965210  <--
     6.2500e-01     6.2500e+00             2.7444e-04       -22.825205701748

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 1.0829e+02
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.650016e-01 1 1  ON 0
 uu_1                 9.125717e-02 1 1  ON 1
 uu_2                -2.021718e-02 1 1  ON 2
 uu_3                -8.586198e-02 1 1  ON 3
 uu_4                -1.235926e-01 1 1  ON 4
 uu_5                -1.465160e-01 1 1  ON 5
 uu_6                -1.599817e-01 1 1  ON 6
 uu_7                -1.633402e-01 1 1  ON 7
 uu_8                -1.533077e-01 1 1  ON 8
 uu_9                -1.278532e-01 1 1  ON 9
 ud_0                 4.361470e-01 1 1  ON 10
 ud_1                 1.538946e-01 1 1  ON 11
 ud_2                 8.255523e-03 1 1  ON 12
 ud_3                -7.174567e-02 1 1  ON 13
 ud_4                -1.189004e-01 1 1  ON 14
 ud_5                -1.490274e-01 1 1  ON 15
 ud_6                -1.673552e-01 1 1  ON 16
 ud_7                -1.747028e-01 1 1  ON 17
 ud_8                -1.673517e-01 1 1  ON 18
 ud_9                -1.440447e-01 1 1  ON 19
 eC_0                -5.739210e-01 1 1  ON 20
 eC_1                -4.189373e-01 1 1  ON 21
 eC_2                -1.693921e-01 1 1  ON 22
 eC_3                -2.203904e-02 1 1  ON 23
 eC_4                 2.681535e-02 1 1  ON 24
 eC_5                 1.130195e-01 1 1  ON 25
 eC_6                 2.317817e-01 1 1  ON 26
 eC_7                 4.108628e-01 1 1  ON 27
 eC_8                 3.115428e-01 1 1  ON 28
 eC_9                 8.032386e-02 1 1  ON 29
 eO_0                -1.257987e+00 1 1  ON 30
 eO_1                -8.799289e-01 1 1  ON 31
 eO_2                -4.004032e-01 1 1  ON 32
 eO_3                -5.490910e-02 1 1  ON 33
 eO_4                 1.753422e-01 1 1  ON 34
 eO_5                 3.625367e-01 1 1  ON 35
 eO_6                 4.596949e-01 1 1  ON 36
 eO_7                 5.329567e-01 1 1  ON 37
 eO_8                 5.138844e-01 1 1  ON 38
 eO_9                 3.622790e-01 1 1  ON 39
eH1_0                -1.863755e-01 1 1  ON 40
eH1_1                -9.899274e-02 1 1  ON 41
eH1_2                -6.610002e-02 1 1  ON 42
eH1_3                -5.105405e-02 1 1  ON 43
eH1_4                 9.864334e-03 1 1  ON 44
eH1_5                 6.700590e-02 1 1  ON 45
eH1_6                 1.240888e-01 1 1  ON 46
eH1_7                 1.032592e-01 1 1  ON 47
eH1_8                 8.080108e-03 1 1  ON 48
eH1_9                -2.217460e-02 1 1  ON 49
eH2_0                -1.893036e-01 1 1  ON 50
eH2_1                -1.013449e-01 1 1  ON 51
eH2_2                -6.871832e-02 1 1  ON 52
eH2_3                -5.322142e-02 1 1  ON 53
eH2_4                 7.880048e-03 1 1  ON 54
eH2_5                 6.506140e-02 1 1  ON 55
eH2_6                 1.222787e-01 1 1  ON 56
eH2_7                 1.003758e-01 1 1  ON 57
eH2_8                 9.516655e-03 1 1  ON 58
eH2_9                -7.302163e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1508e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8188
    reference variance = 0.421687
====================================================
  Execution time = 7.8354e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9940e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6755e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499450073254
                                         uncertainty =       0.004825935077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499450073254
                                         uncertainty =       0.004825935077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499701425
  error estimate for blocks of size 2^( 2) =       0.000517660176
  error estimate for blocks of size 2^( 3) =       0.000533630509
  error estimate for blocks of size 2^( 4) =       0.000544462304
  error estimate for blocks of size 2^( 5) =       0.000551249770
  error estimate for blocks of size 2^( 6) =       0.000553920168
  error estimate for blocks of size 2^( 7) =       0.000556182243

      target function =                  N/A
              le_mean =     -22.824638081231
             les_mean =     521.463506317991
             stat err =       0.000551453621
             autocorr =       1.217858438882
              std dev =       0.706684532514
             le_variance =       0.499403028495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282463808123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824638081231       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824637291332       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824637236360       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824636271711       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824638132168       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824640751084       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824640460398       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824640237550       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824641377371       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824639975280       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824640546385       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824640693925       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824640634437       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824640162763       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.824639690259       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.824639628080       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.824639947186       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.824639904211       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.824640428196       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 2.406895e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824638081231       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824637491404       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824636664960       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824635782959       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824636845301       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824638641528       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824638721330       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824638664421       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824638559789       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824638128733       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824638552569       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824638531401       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824638393628       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824638254117       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 7.896585e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824638081231       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824637788244       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824636996810       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824636802608       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824636759237       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824637579301       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824637705107       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824637670354       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824637506404       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824637539430       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824637647322       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 2.553461e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0512e+02
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.654133e-01 1 1  ON 0
 uu_1                 9.137315e-02 1 1  ON 1
 uu_2                -2.013976e-02 1 1  ON 2
 uu_3                -8.569940e-02 1 1  ON 3
 uu_4                -1.234345e-01 1 1  ON 4
 uu_5                -1.466072e-01 1 1  ON 5
 uu_6                -1.599809e-01 1 1  ON 6
 uu_7                -1.633172e-01 1 1  ON 7
 uu_8                -1.533773e-01 1 1  ON 8
 uu_9                -1.277193e-01 1 1  ON 9
 ud_0                 4.365639e-01 1 1  ON 10
 ud_1                 1.541144e-01 1 1  ON 11
 ud_2                 8.415280e-03 1 1  ON 12
 ud_3                -7.155766e-02 1 1  ON 13
 ud_4                -1.188117e-01 1 1  ON 14
 ud_5                -1.489407e-01 1 1  ON 15
 ud_6                -1.674968e-01 1 1  ON 16
 ud_7                -1.744796e-01 1 1  ON 17
 ud_8                -1.671584e-01 1 1  ON 18
 ud_9                -1.438935e-01 1 1  ON 19
 eC_0                -5.742456e-01 1 1  ON 20
 eC_1                -4.188229e-01 1 1  ON 21
 eC_2                -1.695491e-01 1 1  ON 22
 eC_3                -2.191898e-02 1 1  ON 23
 eC_4                 2.750819e-02 1 1  ON 24
 eC_5                 1.131724e-01 1 1  ON 25
 eC_6                 2.309921e-01 1 1  ON 26
 eC_7                 4.102214e-01 1 1  ON 27
 eC_8                 3.121133e-01 1 1  ON 28
 eC_9                 8.058130e-02 1 1  ON 29
 eO_0                -1.258431e+00 1 1  ON 30
 eO_1                -8.804057e-01 1 1  ON 31
 eO_2                -4.009783e-01 1 1  ON 32
 eO_3                -5.495181e-02 1 1  ON 33
 eO_4                 1.754493e-01 1 1  ON 34
 eO_5                 3.629716e-01 1 1  ON 35
 eO_6                 4.599532e-01 1 1  ON 36
 eO_7                 5.330494e-01 1 1  ON 37
 eO_8                 5.135496e-01 1 1  ON 38
 eO_9                 3.627611e-01 1 1  ON 39
eH1_0                -1.863890e-01 1 1  ON 40
eH1_1                -9.918202e-02 1 1  ON 41
eH1_2                -6.639329e-02 1 1  ON 42
eH1_3                -5.108893e-02 1 1  ON 43
eH1_4                 1.028376e-02 1 1  ON 44
eH1_5                 6.706128e-02 1 1  ON 45
eH1_6                 1.246010e-01 1 1  ON 46
eH1_7                 1.031050e-01 1 1  ON 47
eH1_8                 7.892208e-03 1 1  ON 48
eH1_9                -2.248040e-02 1 1  ON 49
eH2_0                -1.887379e-01 1 1  ON 50
eH2_1                -1.012610e-01 1 1  ON 51
eH2_2                -6.860333e-02 1 1  ON 52
eH2_3                -5.313091e-02 1 1  ON 53
eH2_4                 7.921960e-03 1 1  ON 54
eH2_5                 6.481763e-02 1 1  ON 55
eH2_6                 1.222223e-01 1 1  ON 56
eH2_7                 1.005692e-01 1 1  ON 57
eH2_8                 9.192613e-03 1 1  ON 58
eH2_9                -7.934165e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7504
    reference variance = 0.495943
====================================================
  Execution time = 7.7681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1096e-01
  Total weights = 2.0000e+06
  Execution time = 6.2773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510602757714
                                         uncertainty =       0.004720056699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510602757714
                                         uncertainty =       0.004720056699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505248449
  error estimate for blocks of size 2^( 2) =       0.000522694625
  error estimate for blocks of size 2^( 3) =       0.000537816224
  error estimate for blocks of size 2^( 4) =       0.000549106995
  error estimate for blocks of size 2^( 5) =       0.000555466086
  error estimate for blocks of size 2^( 6) =       0.000558014047
  error estimate for blocks of size 2^( 7) =       0.000561859191

      target function =                  N/A
              le_mean =     -22.826063393547
             les_mean =     521.539721780489
             stat err =       0.000556111580
             autocorr =       1.211473446136
              std dev =       0.714529208310
             le_variance =       0.510551989528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511197253002
                                         uncertainty =       0.004723336967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511197253002
                                         uncertainty =       0.004723336967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505542507
  error estimate for blocks of size 2^( 2) =       0.000522973861
  error estimate for blocks of size 2^( 3) =       0.000538078124
  error estimate for blocks of size 2^( 4) =       0.000549352424
  error estimate for blocks of size 2^( 5) =       0.000555706773
  error estimate for blocks of size 2^( 6) =       0.000558255028
  error estimate for blocks of size 2^( 7) =       0.000562093878

      target function =                  N/A
              le_mean =     -22.826065686107
             les_mean =     521.540420903557
             stat err =       0.000556352026
             autocorr =       1.211111120792
              std dev =       0.714945069670
             le_variance =       0.511146452646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511427981123
                                         uncertainty =       0.004723114464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511427981123
                                         uncertainty =       0.004723114464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505656648
  error estimate for blocks of size 2^( 2) =       0.000523081433
  error estimate for blocks of size 2^( 3) =       0.000538182242
  error estimate for blocks of size 2^( 4) =       0.000549453699
  error estimate for blocks of size 2^( 5) =       0.000555812035
  error estimate for blocks of size 2^( 6) =       0.000558354318
  error estimate for blocks of size 2^( 7) =       0.000562197916

      target function =                  N/A
              le_mean =     -22.826068551538
             les_mean =     521.540782554209
             stat err =       0.000556454492
             autocorr =       1.211010374412
              std dev =       0.715106488829
             le_variance =       0.511377290365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510799323835
                                         uncertainty =       0.004720196006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510799323835
                                         uncertainty =       0.004720196006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505345719
  error estimate for blocks of size 2^( 2) =       0.000522786266
  error estimate for blocks of size 2^( 3) =       0.000537903148
  error estimate for blocks of size 2^( 4) =       0.000549189249
  error estimate for blocks of size 2^( 5) =       0.000555548994
  error estimate for blocks of size 2^( 6) =       0.000558094103
  error estimate for blocks of size 2^( 7) =       0.000561940144

      target function =                  N/A
              le_mean =     -22.826064065522
             les_mean =     521.539949058630
             stat err =       0.000556193122
             autocorr =       1.211362282605
              std dev =       0.714666768968
             le_variance =       0.510748590667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826063393547        initial
     3.9062e-02     3.9062e-01             2.4069e-03       -22.826065686107
     1.5625e-01     1.5625e+00             7.8966e-04       -22.826068551538  <--
     6.2500e-01     6.2500e+00             2.5535e-04       -22.826064065522

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 1.0911e+02
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.654133e-01 1 1  ON 0
 uu_1                 9.137315e-02 1 1  ON 1
 uu_2                -2.013976e-02 1 1  ON 2
 uu_3                -8.569940e-02 1 1  ON 3
 uu_4                -1.234345e-01 1 1  ON 4
 uu_5                -1.466072e-01 1 1  ON 5
 uu_6                -1.599809e-01 1 1  ON 6
 uu_7                -1.633172e-01 1 1  ON 7
 uu_8                -1.533773e-01 1 1  ON 8
 uu_9                -1.277193e-01 1 1  ON 9
 ud_0                 4.365639e-01 1 1  ON 10
 ud_1                 1.541144e-01 1 1  ON 11
 ud_2                 8.415280e-03 1 1  ON 12
 ud_3                -7.155766e-02 1 1  ON 13
 ud_4                -1.188117e-01 1 1  ON 14
 ud_5                -1.489407e-01 1 1  ON 15
 ud_6                -1.674968e-01 1 1  ON 16
 ud_7                -1.744796e-01 1 1  ON 17
 ud_8                -1.671584e-01 1 1  ON 18
 ud_9                -1.438935e-01 1 1  ON 19
 eC_0                -5.742456e-01 1 1  ON 20
 eC_1                -4.188229e-01 1 1  ON 21
 eC_2                -1.695491e-01 1 1  ON 22
 eC_3                -2.191898e-02 1 1  ON 23
 eC_4                 2.750819e-02 1 1  ON 24
 eC_5                 1.131724e-01 1 1  ON 25
 eC_6                 2.309921e-01 1 1  ON 26
 eC_7                 4.102214e-01 1 1  ON 27
 eC_8                 3.121133e-01 1 1  ON 28
 eC_9                 8.058130e-02 1 1  ON 29
 eO_0                -1.258431e+00 1 1  ON 30
 eO_1                -8.804057e-01 1 1  ON 31
 eO_2                -4.009783e-01 1 1  ON 32
 eO_3                -5.495181e-02 1 1  ON 33
 eO_4                 1.754493e-01 1 1  ON 34
 eO_5                 3.629716e-01 1 1  ON 35
 eO_6                 4.599532e-01 1 1  ON 36
 eO_7                 5.330494e-01 1 1  ON 37
 eO_8                 5.135496e-01 1 1  ON 38
 eO_9                 3.627611e-01 1 1  ON 39
eH1_0                -1.863890e-01 1 1  ON 40
eH1_1                -9.918202e-02 1 1  ON 41
eH1_2                -6.639329e-02 1 1  ON 42
eH1_3                -5.108893e-02 1 1  ON 43
eH1_4                 1.028376e-02 1 1  ON 44
eH1_5                 6.706128e-02 1 1  ON 45
eH1_6                 1.246010e-01 1 1  ON 46
eH1_7                 1.031050e-01 1 1  ON 47
eH1_8                 7.892208e-03 1 1  ON 48
eH1_9                -2.248040e-02 1 1  ON 49
eH2_0                -1.887379e-01 1 1  ON 50
eH2_1                -1.012610e-01 1 1  ON 51
eH2_2                -6.860333e-02 1 1  ON 52
eH2_3                -5.313091e-02 1 1  ON 53
eH2_4                 7.921960e-03 1 1  ON 54
eH2_5                 6.481763e-02 1 1  ON 55
eH2_6                 1.222223e-01 1 1  ON 56
eH2_7                 1.005692e-01 1 1  ON 57
eH2_8                 9.192613e-03 1 1  ON 58
eH2_9                -7.934165e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1424e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7264
    reference variance = 0.680939
====================================================
  Execution time = 8.2013e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1220e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6599e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512170573547
                                         uncertainty =       0.009956707864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512170573547
                                         uncertainty =       0.009956707864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506061399
  error estimate for blocks of size 2^( 2) =       0.000523657470
  error estimate for blocks of size 2^( 3) =       0.000539348764
  error estimate for blocks of size 2^( 4) =       0.000550555789
  error estimate for blocks of size 2^( 5) =       0.000557089635
  error estimate for blocks of size 2^( 6) =       0.000559924584
  error estimate for blocks of size 2^( 7) =       0.000562138969

      target function =                  N/A
              le_mean =     -22.824958240847
             les_mean =     521.490914719987
             stat err =       0.000557427244
             autocorr =       1.213304918021
              std dev =       0.715678894256
             le_variance =       0.512196279684


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282495824085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824958240847       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824962809948       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824964598678       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824965123376       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824964318574       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824961238241       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824960705333       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824961706269       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824962442545       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824962918797       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824963269734       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824963386139       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824964575441       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824963947755       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.824964778135       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.824964522488       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.824964429228       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.824964350061       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.824964362522       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 2.635807e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824958240847       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824961758124       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824962946342       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824963438895       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824963112756       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824961410149       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824960512649       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824961155178       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824961672998       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824961903709       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824961964406       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824962133050       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824961984441       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824961957448       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 7.307701e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824958240847       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824960071984       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824960618343       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824960908362       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824960929597       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824960408499       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824959857476       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824960038314       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824960360691       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824960356807       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824960352975       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 2.960451e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076684 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0862e+02
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.656425e-01 1 1  ON 0
 uu_1                 9.155251e-02 1 1  ON 1
 uu_2                -1.981614e-02 1 1  ON 2
 uu_3                -8.553019e-02 1 1  ON 3
 uu_4                -1.233591e-01 1 1  ON 4
 uu_5                -1.465020e-01 1 1  ON 5
 uu_6                -1.599818e-01 1 1  ON 6
 uu_7                -1.633328e-01 1 1  ON 7
 uu_8                -1.535801e-01 1 1  ON 8
 uu_9                -1.277818e-01 1 1  ON 9
 ud_0                 4.365972e-01 1 1  ON 10
 ud_1                 1.543608e-01 1 1  ON 11
 ud_2                 8.418729e-03 1 1  ON 12
 ud_3                -7.151834e-02 1 1  ON 13
 ud_4                -1.187235e-01 1 1  ON 14
 ud_5                -1.487753e-01 1 1  ON 15
 ud_6                -1.673768e-01 1 1  ON 16
 ud_7                -1.742165e-01 1 1  ON 17
 ud_8                -1.668433e-01 1 1  ON 18
 ud_9                -1.435705e-01 1 1  ON 19
 eC_0                -5.742600e-01 1 1  ON 20
 eC_1                -4.192062e-01 1 1  ON 21
 eC_2                -1.693584e-01 1 1  ON 22
 eC_3                -2.194808e-02 1 1  ON 23
 eC_4                 2.724521e-02 1 1  ON 24
 eC_5                 1.135097e-01 1 1  ON 25
 eC_6                 2.308011e-01 1 1  ON 26
 eC_7                 4.096310e-01 1 1  ON 27
 eC_8                 3.127634e-01 1 1  ON 28
 eC_9                 8.084619e-02 1 1  ON 29
 eO_0                -1.258828e+00 1 1  ON 30
 eO_1                -8.808447e-01 1 1  ON 31
 eO_2                -4.010222e-01 1 1  ON 32
 eO_3                -5.519890e-02 1 1  ON 33
 eO_4                 1.756423e-01 1 1  ON 34
 eO_5                 3.633002e-01 1 1  ON 35
 eO_6                 4.597887e-01 1 1  ON 36
 eO_7                 5.331416e-01 1 1  ON 37
 eO_8                 5.132844e-01 1 1  ON 38
 eO_9                 3.632001e-01 1 1  ON 39
eH1_0                -1.869089e-01 1 1  ON 40
eH1_1                -9.942747e-02 1 1  ON 41
eH1_2                -6.648163e-02 1 1  ON 42
eH1_3                -5.035816e-02 1 1  ON 43
eH1_4                 1.047146e-02 1 1  ON 44
eH1_5                 6.768531e-02 1 1  ON 45
eH1_6                 1.246361e-01 1 1  ON 46
eH1_7                 1.024627e-01 1 1  ON 47
eH1_8                 7.985066e-03 1 1  ON 48
eH1_9                -2.279300e-02 1 1  ON 49
eH2_0                -1.890676e-01 1 1  ON 50
eH2_1                -1.011831e-01 1 1  ON 51
eH2_2                -6.854196e-02 1 1  ON 52
eH2_3                -5.310876e-02 1 1  ON 53
eH2_4                 7.317274e-03 1 1  ON 54
eH2_5                 6.468187e-02 1 1  ON 55
eH2_6                 1.225358e-01 1 1  ON 56
eH2_7                 1.010193e-01 1 1  ON 57
eH2_8                 9.319220e-03 1 1  ON 58
eH2_9                -8.160428e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7956
    reference variance = 0.338075
====================================================
  Execution time = 7.9832e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0205e-01
  Total weights = 2.0000e+06
  Execution time = 6.2645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502021177445
                                         uncertainty =       0.002987578697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502021177445
                                         uncertainty =       0.002987578697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500988071
  error estimate for blocks of size 2^( 2) =       0.000518907974
  error estimate for blocks of size 2^( 3) =       0.000534578164
  error estimate for blocks of size 2^( 4) =       0.000546414312
  error estimate for blocks of size 2^( 5) =       0.000553546950
  error estimate for blocks of size 2^( 6) =       0.000556929390
  error estimate for blocks of size 2^( 7) =       0.000558727702

      target function =                  N/A
              le_mean =     -22.825951775134
             les_mean =     521.526052285223
             stat err =       0.000553904588
             autocorr =       1.222405104429
              std dev =       0.708504125239
             le_variance =       0.501978095480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502193919150
                                         uncertainty =       0.002990345126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502193919150
                                         uncertainty =       0.002990345126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501074230
  error estimate for blocks of size 2^( 2) =       0.000518990613
  error estimate for blocks of size 2^( 3) =       0.000534646901
  error estimate for blocks of size 2^( 4) =       0.000546474633
  error estimate for blocks of size 2^( 5) =       0.000553598268
  error estimate for blocks of size 2^( 6) =       0.000556982122
  error estimate for blocks of size 2^( 7) =       0.000558804284

      target function =                  N/A
              le_mean =     -22.825953454750
             les_mean =     521.526301634366
             stat err =       0.000553964827
             autocorr =       1.222250564612
              std dev =       0.708625971188
             le_variance =       0.502150767042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502175244738
                                         uncertainty =       0.002990550470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502175244738
                                         uncertainty =       0.002990550470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501064904
  error estimate for blocks of size 2^( 2) =       0.000518982693
  error estimate for blocks of size 2^( 3) =       0.000534636437
  error estimate for blocks of size 2^( 4) =       0.000546464014
  error estimate for blocks of size 2^( 5) =       0.000553585177
  error estimate for blocks of size 2^( 6) =       0.000556965640
  error estimate for blocks of size 2^( 7) =       0.000558795503

      target function =                  N/A
              le_mean =     -22.825954215570
             les_mean =     521.526317676761
             stat err =       0.000553952583
             autocorr =       1.222242031320
              std dev =       0.708612783226
             le_variance =       0.502132076552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502008281321
                                         uncertainty =       0.002988086731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502008281321
                                         uncertainty =       0.002988086731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500981625
  error estimate for blocks of size 2^( 2) =       0.000518901902
  error estimate for blocks of size 2^( 3) =       0.000534568454
  error estimate for blocks of size 2^( 4) =       0.000546403167
  error estimate for blocks of size 2^( 5) =       0.000553533229
  error estimate for blocks of size 2^( 6) =       0.000556914179
  error estimate for blocks of size 2^( 7) =       0.000558719647

      target function =                  N/A
              le_mean =     -22.825950904231
             les_mean =     521.525999609436
             stat err =       0.000553892556
             autocorr =       1.222383450534
              std dev =       0.708495009197
             le_variance =       0.501965178057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825951775134        initial
     3.9062e-02     3.9062e-01             2.6358e-03       -22.825953454750
     1.5625e-01     1.5625e+00             7.3077e-04       -22.825954215570  <--
     6.2500e-01     6.2500e+00             2.9605e-04       -22.825950904231

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 1.1119e+02
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.656425e-01 1 1  ON 0
 uu_1                 9.155251e-02 1 1  ON 1
 uu_2                -1.981614e-02 1 1  ON 2
 uu_3                -8.553019e-02 1 1  ON 3
 uu_4                -1.233591e-01 1 1  ON 4
 uu_5                -1.465020e-01 1 1  ON 5
 uu_6                -1.599818e-01 1 1  ON 6
 uu_7                -1.633328e-01 1 1  ON 7
 uu_8                -1.535801e-01 1 1  ON 8
 uu_9                -1.277818e-01 1 1  ON 9
 ud_0                 4.365972e-01 1 1  ON 10
 ud_1                 1.543608e-01 1 1  ON 11
 ud_2                 8.418729e-03 1 1  ON 12
 ud_3                -7.151834e-02 1 1  ON 13
 ud_4                -1.187235e-01 1 1  ON 14
 ud_5                -1.487753e-01 1 1  ON 15
 ud_6                -1.673768e-01 1 1  ON 16
 ud_7                -1.742165e-01 1 1  ON 17
 ud_8                -1.668433e-01 1 1  ON 18
 ud_9                -1.435705e-01 1 1  ON 19
 eC_0                -5.742600e-01 1 1  ON 20
 eC_1                -4.192062e-01 1 1  ON 21
 eC_2                -1.693584e-01 1 1  ON 22
 eC_3                -2.194808e-02 1 1  ON 23
 eC_4                 2.724521e-02 1 1  ON 24
 eC_5                 1.135097e-01 1 1  ON 25
 eC_6                 2.308011e-01 1 1  ON 26
 eC_7                 4.096310e-01 1 1  ON 27
 eC_8                 3.127634e-01 1 1  ON 28
 eC_9                 8.084619e-02 1 1  ON 29
 eO_0                -1.258828e+00 1 1  ON 30
 eO_1                -8.808447e-01 1 1  ON 31
 eO_2                -4.010222e-01 1 1  ON 32
 eO_3                -5.519890e-02 1 1  ON 33
 eO_4                 1.756423e-01 1 1  ON 34
 eO_5                 3.633002e-01 1 1  ON 35
 eO_6                 4.597887e-01 1 1  ON 36
 eO_7                 5.331416e-01 1 1  ON 37
 eO_8                 5.132844e-01 1 1  ON 38
 eO_9                 3.632001e-01 1 1  ON 39
eH1_0                -1.869089e-01 1 1  ON 40
eH1_1                -9.942747e-02 1 1  ON 41
eH1_2                -6.648163e-02 1 1  ON 42
eH1_3                -5.035816e-02 1 1  ON 43
eH1_4                 1.047146e-02 1 1  ON 44
eH1_5                 6.768531e-02 1 1  ON 45
eH1_6                 1.246361e-01 1 1  ON 46
eH1_7                 1.024627e-01 1 1  ON 47
eH1_8                 7.985066e-03 1 1  ON 48
eH1_9                -2.279300e-02 1 1  ON 49
eH2_0                -1.890676e-01 1 1  ON 50
eH2_1                -1.011831e-01 1 1  ON 51
eH2_2                -6.854196e-02 1 1  ON 52
eH2_3                -5.310876e-02 1 1  ON 53
eH2_4                 7.317274e-03 1 1  ON 54
eH2_5                 6.468187e-02 1 1  ON 55
eH2_6                 1.225358e-01 1 1  ON 56
eH2_7                 1.010193e-01 1 1  ON 57
eH2_8                 9.319220e-03 1 1  ON 58
eH2_9                -8.160428e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1982e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8387
    reference variance = 0.267064
====================================================
  Execution time = 7.8335e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0167e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6538e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501759022328
                                         uncertainty =       0.003476913084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501759022328
                                         uncertainty =       0.003476913084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500832129
  error estimate for blocks of size 2^( 2) =       0.000518281022
  error estimate for blocks of size 2^( 3) =       0.000533806264
  error estimate for blocks of size 2^( 4) =       0.000544471291
  error estimate for blocks of size 2^( 5) =       0.000550126406
  error estimate for blocks of size 2^( 6) =       0.000552633220
  error estimate for blocks of size 2^( 7) =       0.000555436224

      target function =                  N/A
              le_mean =     -22.825223836563
             les_mean =     521.492508581816
             stat err =       0.000550666785
             autocorr =       1.208908411287
              std dev =       0.708283589697
             le_variance =       0.501665643434


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282522383656e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825223836563       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825223873961       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825227445980       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825230195496       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825230487411       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825229832096       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825229318955       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825229183651       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825230271687       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825230822370       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825231012192       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825232570181       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825232996863       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825232628795       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825232783679       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825232850855       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825232795942       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825232493086       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.825232429329       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 2.118266e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825223836563       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825223863295       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825225808109       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825228008656       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825228706702       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825228435549       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825228001094       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825227622358       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825228136850       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825228394693       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825228376045       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825228724057       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825228896091       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825228748418       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 7.055565e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825223836563       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825223849050       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825224578992       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825225570511       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825226158548       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825226226584       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825226068051       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825225792333       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825225908024       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825226005565       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825225974772       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825225985302       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 2.728385e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084783 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0489e+02
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.653966e-01 1 1  ON 0
 uu_1                 9.168459e-02 1 1  ON 1
 uu_2                -1.960203e-02 1 1  ON 2
 uu_3                -8.528191e-02 1 1  ON 3
 uu_4                -1.233127e-01 1 1  ON 4
 uu_5                -1.464506e-01 1 1  ON 5
 uu_6                -1.601298e-01 1 1  ON 6
 uu_7                -1.632930e-01 1 1  ON 7
 uu_8                -1.537482e-01 1 1  ON 8
 uu_9                -1.274359e-01 1 1  ON 9
 ud_0                 4.366427e-01 1 1  ON 10
 ud_1                 1.543840e-01 1 1  ON 11
 ud_2                 8.674187e-03 1 1  ON 12
 ud_3                -7.138101e-02 1 1  ON 13
 ud_4                -1.186813e-01 1 1  ON 14
 ud_5                -1.487546e-01 1 1  ON 15
 ud_6                -1.668564e-01 1 1  ON 16
 ud_7                -1.740093e-01 1 1  ON 17
 ud_8                -1.668025e-01 1 1  ON 18
 ud_9                -1.433171e-01 1 1  ON 19
 eC_0                -5.739165e-01 1 1  ON 20
 eC_1                -4.195775e-01 1 1  ON 21
 eC_2                -1.693163e-01 1 1  ON 22
 eC_3                -2.232973e-02 1 1  ON 23
 eC_4                 2.739240e-02 1 1  ON 24
 eC_5                 1.133461e-01 1 1  ON 25
 eC_6                 2.306476e-01 1 1  ON 26
 eC_7                 4.092032e-01 1 1  ON 27
 eC_8                 3.132968e-01 1 1  ON 28
 eC_9                 8.121278e-02 1 1  ON 29
 eO_0                -1.259504e+00 1 1  ON 30
 eO_1                -8.812485e-01 1 1  ON 31
 eO_2                -4.017278e-01 1 1  ON 32
 eO_3                -5.505655e-02 1 1  ON 33
 eO_4                 1.757693e-01 1 1  ON 34
 eO_5                 3.636881e-01 1 1  ON 35
 eO_6                 4.603122e-01 1 1  ON 36
 eO_7                 5.332253e-01 1 1  ON 37
 eO_8                 5.129077e-01 1 1  ON 38
 eO_9                 3.635414e-01 1 1  ON 39
eH1_0                -1.868181e-01 1 1  ON 40
eH1_1                -9.966340e-02 1 1  ON 41
eH1_2                -6.676495e-02 1 1  ON 42
eH1_3                -5.056999e-02 1 1  ON 43
eH1_4                 1.035800e-02 1 1  ON 44
eH1_5                 6.746190e-02 1 1  ON 45
eH1_6                 1.249110e-01 1 1  ON 46
eH1_7                 1.028829e-01 1 1  ON 47
eH1_8                 8.380886e-03 1 1  ON 48
eH1_9                -2.304808e-02 1 1  ON 49
eH2_0                -1.888866e-01 1 1  ON 50
eH2_1                -1.011655e-01 1 1  ON 51
eH2_2                -6.850856e-02 1 1  ON 52
eH2_3                -5.286163e-02 1 1  ON 53
eH2_4                 7.559424e-03 1 1  ON 54
eH2_5                 6.491660e-02 1 1  ON 55
eH2_6                 1.220320e-01 1 1  ON 56
eH2_7                 1.005144e-01 1 1  ON 57
eH2_8                 9.382199e-03 1 1  ON 58
eH2_9                -8.468871e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8187
    reference variance = 0.325168
====================================================
  Execution time = 7.7183e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0641e-01
  Total weights = 2.0000e+06
  Execution time = 6.2864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506870233471
                                         uncertainty =       0.004193669862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506870233471
                                         uncertainty =       0.004193669862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503371782
  error estimate for blocks of size 2^( 2) =       0.000520819044
  error estimate for blocks of size 2^( 3) =       0.000536536218
  error estimate for blocks of size 2^( 4) =       0.000547091453
  error estimate for blocks of size 2^( 5) =       0.000554746340
  error estimate for blocks of size 2^( 6) =       0.000557075407
  error estimate for blocks of size 2^( 7) =       0.000558360036

      target function =                  N/A
              le_mean =     -22.825502068062
             les_mean =     521.510310706571
             stat err =       0.000554318309
             autocorr =       1.212664643654
              std dev =       0.711875200323
             le_variance =       0.506766300834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506482765774
                                         uncertainty =       0.004178372463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506482765774
                                         uncertainty =       0.004178372463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503179549
  error estimate for blocks of size 2^( 2) =       0.000520644396
  error estimate for blocks of size 2^( 3) =       0.000536375292
  error estimate for blocks of size 2^( 4) =       0.000546942800
  error estimate for blocks of size 2^( 5) =       0.000554590017
  error estimate for blocks of size 2^( 6) =       0.000556922584
  error estimate for blocks of size 2^( 7) =       0.000558220593

      target function =                  N/A
              le_mean =     -22.825503865786
             les_mean =     521.510005791533
             stat err =       0.000554168998
             autocorr =       1.212937685581
              std dev =       0.711603342954
             le_variance =       0.506379317703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506180114873
                                         uncertainty =       0.004169498069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506180114873
                                         uncertainty =       0.004169498069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503029254
  error estimate for blocks of size 2^( 2) =       0.000520506418
  error estimate for blocks of size 2^( 3) =       0.000536249825
  error estimate for blocks of size 2^( 4) =       0.000546828817
  error estimate for blocks of size 2^( 5) =       0.000554477522
  error estimate for blocks of size 2^( 6) =       0.000556810989
  error estimate for blocks of size 2^( 7) =       0.000558121526

      target function =                  N/A
              le_mean =     -22.825504824012
             les_mean =     521.509747078783
             stat err =       0.000554059714
             autocorr =       1.213183964693
              std dev =       0.711390793326
             le_variance =       0.506076860829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506674498158
                                         uncertainty =       0.004187405802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506674498158
                                         uncertainty =       0.004187405802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503274640
  error estimate for blocks of size 2^( 2) =       0.000520729688
  error estimate for blocks of size 2^( 3) =       0.000536454118
  error estimate for blocks of size 2^( 4) =       0.000547015899
  error estimate for blocks of size 2^( 5) =       0.000554669435
  error estimate for blocks of size 2^( 6) =       0.000556999220
  error estimate for blocks of size 2^( 7) =       0.000558290841

      target function =                  N/A
              le_mean =     -22.825501546268
             les_mean =     521.510091312264
             stat err =       0.000554243849
             autocorr =       1.212806928400
              std dev =       0.711737821726
             le_variance =       0.506570726876


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825502068062        initial
     3.9062e-02     3.9062e-01             2.1183e-03       -22.825503865786
     1.5625e-01     1.5625e+00             7.0556e-04       -22.825504824012  <--
     6.2500e-01     6.2500e+00             2.7284e-04       -22.825501546268

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 1.0872e+02
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.653966e-01 1 1  ON 0
 uu_1                 9.168459e-02 1 1  ON 1
 uu_2                -1.960203e-02 1 1  ON 2
 uu_3                -8.528191e-02 1 1  ON 3
 uu_4                -1.233127e-01 1 1  ON 4
 uu_5                -1.464506e-01 1 1  ON 5
 uu_6                -1.601298e-01 1 1  ON 6
 uu_7                -1.632930e-01 1 1  ON 7
 uu_8                -1.537482e-01 1 1  ON 8
 uu_9                -1.274359e-01 1 1  ON 9
 ud_0                 4.366427e-01 1 1  ON 10
 ud_1                 1.543840e-01 1 1  ON 11
 ud_2                 8.674187e-03 1 1  ON 12
 ud_3                -7.138101e-02 1 1  ON 13
 ud_4                -1.186813e-01 1 1  ON 14
 ud_5                -1.487546e-01 1 1  ON 15
 ud_6                -1.668564e-01 1 1  ON 16
 ud_7                -1.740093e-01 1 1  ON 17
 ud_8                -1.668025e-01 1 1  ON 18
 ud_9                -1.433171e-01 1 1  ON 19
 eC_0                -5.739165e-01 1 1  ON 20
 eC_1                -4.195775e-01 1 1  ON 21
 eC_2                -1.693163e-01 1 1  ON 22
 eC_3                -2.232973e-02 1 1  ON 23
 eC_4                 2.739240e-02 1 1  ON 24
 eC_5                 1.133461e-01 1 1  ON 25
 eC_6                 2.306476e-01 1 1  ON 26
 eC_7                 4.092032e-01 1 1  ON 27
 eC_8                 3.132968e-01 1 1  ON 28
 eC_9                 8.121278e-02 1 1  ON 29
 eO_0                -1.259504e+00 1 1  ON 30
 eO_1                -8.812485e-01 1 1  ON 31
 eO_2                -4.017278e-01 1 1  ON 32
 eO_3                -5.505655e-02 1 1  ON 33
 eO_4                 1.757693e-01 1 1  ON 34
 eO_5                 3.636881e-01 1 1  ON 35
 eO_6                 4.603122e-01 1 1  ON 36
 eO_7                 5.332253e-01 1 1  ON 37
 eO_8                 5.129077e-01 1 1  ON 38
 eO_9                 3.635414e-01 1 1  ON 39
eH1_0                -1.868181e-01 1 1  ON 40
eH1_1                -9.966340e-02 1 1  ON 41
eH1_2                -6.676495e-02 1 1  ON 42
eH1_3                -5.056999e-02 1 1  ON 43
eH1_4                 1.035800e-02 1 1  ON 44
eH1_5                 6.746190e-02 1 1  ON 45
eH1_6                 1.249110e-01 1 1  ON 46
eH1_7                 1.028829e-01 1 1  ON 47
eH1_8                 8.380886e-03 1 1  ON 48
eH1_9                -2.304808e-02 1 1  ON 49
eH2_0                -1.888866e-01 1 1  ON 50
eH2_1                -1.011655e-01 1 1  ON 51
eH2_2                -6.850856e-02 1 1  ON 52
eH2_3                -5.286163e-02 1 1  ON 53
eH2_4                 7.559424e-03 1 1  ON 54
eH2_5                 6.491660e-02 1 1  ON 55
eH2_6                 1.220320e-01 1 1  ON 56
eH2_7                 1.005144e-01 1 1  ON 57
eH2_8                 9.382199e-03 1 1  ON 58
eH2_9                -8.468871e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1361e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8868
    reference variance = 0.542947
====================================================
  Execution time = 8.0662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9844e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6768e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498371485644
                                         uncertainty =       0.002862419204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498371485644
                                         uncertainty =       0.002862419204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499217433
  error estimate for blocks of size 2^( 2) =       0.000516969524
  error estimate for blocks of size 2^( 3) =       0.000532625611
  error estimate for blocks of size 2^( 4) =       0.000543878263
  error estimate for blocks of size 2^( 5) =       0.000551131210
  error estimate for blocks of size 2^( 6) =       0.000556002358
  error estimate for blocks of size 2^( 7) =       0.000557918086

      target function =                  N/A
              le_mean =     -22.825478338714
             les_mean =     521.500897233342
             stat err =       0.000552232479
             autocorr =       1.223670260445
              std dev =       0.706000064757
             le_variance =       0.498436091437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282547833871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825478338714       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825482978408       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825484332203       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825483325130       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825483025686       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825482841044       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825483235996       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825482616976       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825482342929       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825483232374       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825483303831       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825483900870       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825483803138       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825484071586       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825483632714       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825484477112       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825484270572       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825484152975       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.825484293735       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 2.603536e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825478338714       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825481751571       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825482569905       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825481983719       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825481753869       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825481277866       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825481441479       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825481219991       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825481076564       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825481524752       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825481502944       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825481688557       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825481716728       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825481584799       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 6.711629e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825478338714       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825479997302       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825480372255       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825480208936       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825480231885       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825479920348       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825479787610       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825479828232       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825479745100       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825479852549       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825479842730       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 2.931219e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0744e+02
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.659932e-01 1 1  ON 0
 uu_1                 9.172120e-02 1 1  ON 1
 uu_2                -1.978609e-02 1 1  ON 2
 uu_3                -8.550698e-02 1 1  ON 3
 uu_4                -1.233198e-01 1 1  ON 4
 uu_5                -1.465166e-01 1 1  ON 5
 uu_6                -1.600002e-01 1 1  ON 6
 uu_7                -1.631327e-01 1 1  ON 7
 uu_8                -1.535688e-01 1 1  ON 8
 uu_9                -1.274850e-01 1 1  ON 9
 ud_0                 4.369522e-01 1 1  ON 10
 ud_1                 1.545044e-01 1 1  ON 11
 ud_2                 8.882962e-03 1 1  ON 12
 ud_3                -7.110622e-02 1 1  ON 13
 ud_4                -1.185001e-01 1 1  ON 14
 ud_5                -1.485054e-01 1 1  ON 15
 ud_6                -1.672588e-01 1 1  ON 16
 ud_7                -1.740689e-01 1 1  ON 17
 ud_8                -1.666201e-01 1 1  ON 18
 ud_9                -1.432850e-01 1 1  ON 19
 eC_0                -5.744065e-01 1 1  ON 20
 eC_1                -4.195521e-01 1 1  ON 21
 eC_2                -1.690946e-01 1 1  ON 22
 eC_3                -2.205171e-02 1 1  ON 23
 eC_4                 2.727186e-02 1 1  ON 24
 eC_5                 1.133233e-01 1 1  ON 25
 eC_6                 2.304821e-01 1 1  ON 26
 eC_7                 4.085320e-01 1 1  ON 27
 eC_8                 3.138301e-01 1 1  ON 28
 eC_9                 8.156643e-02 1 1  ON 29
 eO_0                -1.260009e+00 1 1  ON 30
 eO_1                -8.815226e-01 1 1  ON 31
 eO_2                -4.016746e-01 1 1  ON 32
 eO_3                -5.520918e-02 1 1  ON 33
 eO_4                 1.755713e-01 1 1  ON 34
 eO_5                 3.634831e-01 1 1  ON 35
 eO_6                 4.603614e-01 1 1  ON 36
 eO_7                 5.335164e-01 1 1  ON 37
 eO_8                 5.128024e-01 1 1  ON 38
 eO_9                 3.640176e-01 1 1  ON 39
eH1_0                -1.874872e-01 1 1  ON 40
eH1_1                -9.967065e-02 1 1  ON 41
eH1_2                -6.637621e-02 1 1  ON 42
eH1_3                -5.047230e-02 1 1  ON 43
eH1_4                 1.039909e-02 1 1  ON 44
eH1_5                 6.760809e-02 1 1  ON 45
eH1_6                 1.248266e-01 1 1  ON 46
eH1_7                 1.027812e-01 1 1  ON 47
eH1_8                 8.581731e-03 1 1  ON 48
eH1_9                -2.331286e-02 1 1  ON 49
eH2_0                -1.887276e-01 1 1  ON 50
eH2_1                -1.011425e-01 1 1  ON 51
eH2_2                -6.851703e-02 1 1  ON 52
eH2_3                -5.292299e-02 1 1  ON 53
eH2_4                 7.709560e-03 1 1  ON 54
eH2_5                 6.480384e-02 1 1  ON 55
eH2_6                 1.225209e-01 1 1  ON 56
eH2_7                 1.004467e-01 1 1  ON 57
eH2_8                 9.111892e-03 1 1  ON 58
eH2_9                -8.968725e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8149
    reference variance = 1.23822
====================================================
  Execution time = 7.6183e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0844e-01
  Total weights = 2.0000e+06
  Execution time = 6.2815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507955929116
                                         uncertainty =       0.006435669718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507955929116
                                         uncertainty =       0.006435669718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504015811
  error estimate for blocks of size 2^( 2) =       0.000521656156
  error estimate for blocks of size 2^( 3) =       0.000537482341
  error estimate for blocks of size 2^( 4) =       0.000548651028
  error estimate for blocks of size 2^( 5) =       0.000554578658
  error estimate for blocks of size 2^( 6) =       0.000555176181
  error estimate for blocks of size 2^( 7) =       0.000554862998

      target function =                  N/A
              le_mean =     -22.826107309516
             les_mean =     521.539238527413
             stat err =       0.000553317216
             autocorr =       1.205202559622
              std dev =       0.712785995856
             le_variance =       0.508063875888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508534304719
                                         uncertainty =       0.006446646076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508534304719
                                         uncertainty =       0.006446646076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504302438
  error estimate for blocks of size 2^( 2) =       0.000521930728
  error estimate for blocks of size 2^( 3) =       0.000537748737
  error estimate for blocks of size 2^( 4) =       0.000548917992
  error estimate for blocks of size 2^( 5) =       0.000554831906
  error estimate for blocks of size 2^( 6) =       0.000555458954
  error estimate for blocks of size 2^( 7) =       0.000555138106

      target function =                  N/A
              le_mean =     -22.826101291556
             les_mean =     521.539541815209
             stat err =       0.000553586740
             autocorr =       1.205006037374
              std dev =       0.713191346816
             le_variance =       0.508641897173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508724199007
                                         uncertainty =       0.006449104228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508724199007
                                         uncertainty =       0.006449104228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504396469
  error estimate for blocks of size 2^( 2) =       0.000522022245
  error estimate for blocks of size 2^( 3) =       0.000537840305
  error estimate for blocks of size 2^( 4) =       0.000549013667
  error estimate for blocks of size 2^( 5) =       0.000554924173
  error estimate for blocks of size 2^( 6) =       0.000555564494
  error estimate for blocks of size 2^( 7) =       0.000555240742

      target function =                  N/A
              le_mean =     -22.826100922026
             les_mean =     521.539714644041
             stat err =       0.000553685769
             autocorr =       1.204987792588
              std dev =       0.713324327306
             le_variance =       0.508831595926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508150627003
                                         uncertainty =       0.006438908937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508150627003
                                         uncertainty =       0.006438908937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504112312
  error estimate for blocks of size 2^( 2) =       0.000521748562
  error estimate for blocks of size 2^( 3) =       0.000537572461
  error estimate for blocks of size 2^( 4) =       0.000548742301
  error estimate for blocks of size 2^( 5) =       0.000554665684
  error estimate for blocks of size 2^( 6) =       0.000555273616
  error estimate for blocks of size 2^( 7) =       0.000554957528

      target function =                  N/A
              le_mean =     -22.826104847451
             les_mean =     521.539320698274
             stat err =       0.000553409782
             autocorr =       1.205144309816
              std dev =       0.712922468154
             le_variance =       0.508258445598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826107309516        initial  <--
     3.9062e-02     3.9062e-01             2.6035e-03       -22.826101291556
     1.5625e-01     1.5625e+00             6.7116e-04       -22.826100922026
     6.2500e-01     6.2500e+00             2.9312e-04       -22.826104847451

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 107.6727
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.653966e-01 1 1  ON 0
 uu_1                 9.168459e-02 1 1  ON 1
 uu_2                -1.960203e-02 1 1  ON 2
 uu_3                -8.528191e-02 1 1  ON 3
 uu_4                -1.233127e-01 1 1  ON 4
 uu_5                -1.464506e-01 1 1  ON 5
 uu_6                -1.601298e-01 1 1  ON 6
 uu_7                -1.632930e-01 1 1  ON 7
 uu_8                -1.537482e-01 1 1  ON 8
 uu_9                -1.274359e-01 1 1  ON 9
 ud_0                 4.366427e-01 1 1  ON 10
 ud_1                 1.543840e-01 1 1  ON 11
 ud_2                 8.674187e-03 1 1  ON 12
 ud_3                -7.138101e-02 1 1  ON 13
 ud_4                -1.186813e-01 1 1  ON 14
 ud_5                -1.487546e-01 1 1  ON 15
 ud_6                -1.668564e-01 1 1  ON 16
 ud_7                -1.740093e-01 1 1  ON 17
 ud_8                -1.668025e-01 1 1  ON 18
 ud_9                -1.433171e-01 1 1  ON 19
 eC_0                -5.739165e-01 1 1  ON 20
 eC_1                -4.195775e-01 1 1  ON 21
 eC_2                -1.693163e-01 1 1  ON 22
 eC_3                -2.232973e-02 1 1  ON 23
 eC_4                 2.739240e-02 1 1  ON 24
 eC_5                 1.133461e-01 1 1  ON 25
 eC_6                 2.306476e-01 1 1  ON 26
 eC_7                 4.092032e-01 1 1  ON 27
 eC_8                 3.132968e-01 1 1  ON 28
 eC_9                 8.121278e-02 1 1  ON 29
 eO_0                -1.259504e+00 1 1  ON 30
 eO_1                -8.812485e-01 1 1  ON 31
 eO_2                -4.017278e-01 1 1  ON 32
 eO_3                -5.505655e-02 1 1  ON 33
 eO_4                 1.757693e-01 1 1  ON 34
 eO_5                 3.636881e-01 1 1  ON 35
 eO_6                 4.603122e-01 1 1  ON 36
 eO_7                 5.332253e-01 1 1  ON 37
 eO_8                 5.129077e-01 1 1  ON 38
 eO_9                 3.635414e-01 1 1  ON 39
eH1_0                -1.868181e-01 1 1  ON 40
eH1_1                -9.966340e-02 1 1  ON 41
eH1_2                -6.676495e-02 1 1  ON 42
eH1_3                -5.056999e-02 1 1  ON 43
eH1_4                 1.035800e-02 1 1  ON 44
eH1_5                 6.746190e-02 1 1  ON 45
eH1_6                 1.249110e-01 1 1  ON 46
eH1_7                 1.028829e-01 1 1  ON 47
eH1_8                 8.380886e-03 1 1  ON 48
eH1_9                -2.304808e-02 1 1  ON 49
eH2_0                -1.888866e-01 1 1  ON 50
eH2_1                -1.011655e-01 1 1  ON 51
eH2_2                -6.850856e-02 1 1  ON 52
eH2_3                -5.286163e-02 1 1  ON 53
eH2_4                 7.559424e-03 1 1  ON 54
eH2_5                 6.491660e-02 1 1  ON 55
eH2_6                 1.220320e-01 1 1  ON 56
eH2_7                 1.005144e-01 1 1  ON 57
eH2_8                 9.382199e-03 1 1  ON 58
eH2_9                -8.468871e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1512e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8016
    reference variance = 0.264255
====================================================
  Execution time = 7.9211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9949e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6004e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499368288999
                                         uncertainty =       0.003319799833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499368288999
                                         uncertainty =       0.003319799833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499746603
  error estimate for blocks of size 2^( 2) =       0.000517686249
  error estimate for blocks of size 2^( 3) =       0.000533615633
  error estimate for blocks of size 2^( 4) =       0.000544085194
  error estimate for blocks of size 2^( 5) =       0.000550179946
  error estimate for blocks of size 2^( 6) =       0.000553018810
  error estimate for blocks of size 2^( 7) =       0.000555253034

      target function =                  N/A
              le_mean =     -22.824779502381
             les_mean =     521.470052417929
             stat err =       0.000550634246
             autocorr =       1.214022495889
              std dev =       0.706748424371
             le_variance =       0.499493335352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282477950238e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824779502381       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824779769892       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824779259767       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824778720613       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824778750756       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824778968738       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824779535438       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824779053060       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824779057070       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824779321621       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824779338921       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824779296814       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 2.648905e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824779502381       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824779588950       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824779398661       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824779180246       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824779164676       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824779069936       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824779299582       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824779236371       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824779255098       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824779264151       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 9.355030e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824779502381       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824779525743       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824779470921       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824779406545       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824779397608       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824779363138       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824779415136       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824779403067       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824779413374       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824779412245       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 2.716800e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0522e+02
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.654144e-01 1 1  ON 0
 uu_1                 9.166849e-02 1 1  ON 1
 uu_2                -1.962468e-02 1 1  ON 2
 uu_3                -8.528422e-02 1 1  ON 3
 uu_4                -1.232809e-01 1 1  ON 4
 uu_5                -1.464933e-01 1 1  ON 5
 uu_6                -1.600839e-01 1 1  ON 6
 uu_7                -1.633142e-01 1 1  ON 7
 uu_8                -1.536825e-01 1 1  ON 8
 uu_9                -1.274104e-01 1 1  ON 9
 ud_0                 4.367362e-01 1 1  ON 10
 ud_1                 1.544008e-01 1 1  ON 11
 ud_2                 8.686392e-03 1 1  ON 12
 ud_3                -7.138832e-02 1 1  ON 13
 ud_4                -1.186471e-01 1 1  ON 14
 ud_5                -1.487724e-01 1 1  ON 15
 ud_6                -1.668866e-01 1 1  ON 16
 ud_7                -1.740187e-01 1 1  ON 17
 ud_8                -1.667939e-01 1 1  ON 18
 ud_9                -1.433063e-01 1 1  ON 19
 eC_0                -5.739560e-01 1 1  ON 20
 eC_1                -4.195225e-01 1 1  ON 21
 eC_2                -1.694073e-01 1 1  ON 22
 eC_3                -2.227866e-02 1 1  ON 23
 eC_4                 2.734221e-02 1 1  ON 24
 eC_5                 1.133371e-01 1 1  ON 25
 eC_6                 2.306810e-01 1 1  ON 26
 eC_7                 4.091709e-01 1 1  ON 27
 eC_8                 3.133481e-01 1 1  ON 28
 eC_9                 8.123994e-02 1 1  ON 29
 eO_0                -1.259551e+00 1 1  ON 30
 eO_1                -8.813039e-01 1 1  ON 31
 eO_2                -4.016791e-01 1 1  ON 32
 eO_3                -5.512098e-02 1 1  ON 33
 eO_4                 1.757605e-01 1 1  ON 34
 eO_5                 3.636852e-01 1 1  ON 35
 eO_6                 4.603503e-01 1 1  ON 36
 eO_7                 5.332259e-01 1 1  ON 37
 eO_8                 5.129044e-01 1 1  ON 38
 eO_9                 3.635859e-01 1 1  ON 39
eH1_0                -1.868494e-01 1 1  ON 40
eH1_1                -9.972654e-02 1 1  ON 41
eH1_2                -6.674340e-02 1 1  ON 42
eH1_3                -5.054290e-02 1 1  ON 43
eH1_4                 1.039284e-02 1 1  ON 44
eH1_5                 6.742910e-02 1 1  ON 45
eH1_6                 1.248922e-01 1 1  ON 46
eH1_7                 1.028933e-01 1 1  ON 47
eH1_8                 8.435405e-03 1 1  ON 48
eH1_9                -2.306584e-02 1 1  ON 49
eH2_0                -1.888654e-01 1 1  ON 50
eH2_1                -1.012234e-01 1 1  ON 51
eH2_2                -6.851822e-02 1 1  ON 52
eH2_3                -5.287914e-02 1 1  ON 53
eH2_4                 7.625470e-03 1 1  ON 54
eH2_5                 6.489091e-02 1 1  ON 55
eH2_6                 1.220388e-01 1 1  ON 56
eH2_7                 1.005446e-01 1 1  ON 57
eH2_8                 9.396596e-03 1 1  ON 58
eH2_9                -8.506934e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.765
    reference variance = 0.541047
====================================================
  Execution time = 7.8367e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0605e-01
  Total weights = 2.0000e+06
  Execution time = 6.2683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506084352791
                                         uncertainty =       0.004631224389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506084352791
                                         uncertainty =       0.004631224389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502969739
  error estimate for blocks of size 2^( 2) =       0.000520355562
  error estimate for blocks of size 2^( 3) =       0.000536168000
  error estimate for blocks of size 2^( 4) =       0.000547815656
  error estimate for blocks of size 2^( 5) =       0.000554649606
  error estimate for blocks of size 2^( 6) =       0.000558679472
  error estimate for blocks of size 2^( 7) =       0.000559880972

      target function =                  N/A
              le_mean =     -22.825282513585
             les_mean =     521.499478688528
             stat err =       0.000555256427
             autocorr =       1.218718699428
              std dev =       0.711306626251
             le_variance =       0.505957116548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506301757209
                                         uncertainty =       0.004630070984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506301757209
                                         uncertainty =       0.004630070984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503077714
  error estimate for blocks of size 2^( 2) =       0.000520457196
  error estimate for blocks of size 2^( 3) =       0.000536265246
  error estimate for blocks of size 2^( 4) =       0.000547911666
  error estimate for blocks of size 2^( 5) =       0.000554742774
  error estimate for blocks of size 2^( 6) =       0.000558771312
  error estimate for blocks of size 2^( 7) =       0.000559973980

      target function =                  N/A
              le_mean =     -22.825284826540
             les_mean =     521.499801532415
             stat err =       0.000555349933
             autocorr =       1.218605938492
              std dev =       0.711459326177
             le_variance =       0.506174372804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506272995556
                                         uncertainty =       0.004630536039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506272995556
                                         uncertainty =       0.004630536039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503063434
  error estimate for blocks of size 2^( 2) =       0.000520444212
  error estimate for blocks of size 2^( 3) =       0.000536252881
  error estimate for blocks of size 2^( 4) =       0.000547899637
  error estimate for blocks of size 2^( 5) =       0.000554731174
  error estimate for blocks of size 2^( 6) =       0.000558760849
  error estimate for blocks of size 2^( 7) =       0.000559962489

      target function =                  N/A
              le_mean =     -22.825284147109
             les_mean =     521.499741781107
             stat err =       0.000555338537
             autocorr =       1.218625105959
              std dev =       0.711439131553
             le_variance =       0.506145637905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506112295849
                                         uncertainty =       0.004631124488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506112295849
                                         uncertainty =       0.004631124488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502983619
  error estimate for blocks of size 2^( 2) =       0.000520368712
  error estimate for blocks of size 2^( 3) =       0.000536180595
  error estimate for blocks of size 2^( 4) =       0.000547828116
  error estimate for blocks of size 2^( 5) =       0.000554661702
  error estimate for blocks of size 2^( 6) =       0.000558691593
  error estimate for blocks of size 2^( 7) =       0.000559893075

      target function =                  N/A
              le_mean =     -22.825282718866
             les_mean =     521.499515984507
             stat err =       0.000555268621
             autocorr =       1.218704968851
              std dev =       0.711326255197
             le_variance =       0.505985041333


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825282513585        initial
     3.9062e-01     3.9062e+00             2.6489e-04       -22.825284826540  <--
     1.5625e+00     1.5625e+01             9.3550e-05       -22.825284147109
     6.2500e+00     6.2500e+01             2.7168e-05       -22.825282718866

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 1.0980e+02
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.654285e-01 1 1  ON 0
 uu_1                 9.163636e-02 1 1  ON 1
 uu_2                -1.966686e-02 1 1  ON 2
 uu_3                -8.528208e-02 1 1  ON 3
 uu_4                -1.232384e-01 1 1  ON 4
 uu_5                -1.465305e-01 1 1  ON 5
 uu_6                -1.600201e-01 1 1  ON 6
 uu_7                -1.633356e-01 1 1  ON 7
 uu_8                -1.535011e-01 1 1  ON 8
 uu_9                -1.273340e-01 1 1  ON 9
 ud_0                 4.368915e-01 1 1  ON 10
 ud_1                 1.544823e-01 1 1  ON 11
 ud_2                 8.735686e-03 1 1  ON 12
 ud_3                -7.136071e-02 1 1  ON 13
 ud_4                -1.185830e-01 1 1  ON 14
 ud_5                -1.487771e-01 1 1  ON 15
 ud_6                -1.669322e-01 1 1  ON 16
 ud_7                -1.740578e-01 1 1  ON 17
 ud_8                -1.667767e-01 1 1  ON 18
 ud_9                -1.432729e-01 1 1  ON 19
 eC_0                -5.740592e-01 1 1  ON 20
 eC_1                -4.194311e-01 1 1  ON 21
 eC_2                -1.695812e-01 1 1  ON 22
 eC_3                -2.220414e-02 1 1  ON 23
 eC_4                 2.725927e-02 1 1  ON 24
 eC_5                 1.132857e-01 1 1  ON 25
 eC_6                 2.307714e-01 1 1  ON 26
 eC_7                 4.090728e-01 1 1  ON 27
 eC_8                 3.135055e-01 1 1  ON 28
 eC_9                 8.132326e-02 1 1  ON 29
 eO_0                -1.259707e+00 1 1  ON 30
 eO_1                -8.814323e-01 1 1  ON 31
 eO_2                -4.016418e-01 1 1  ON 32
 eO_3                -5.524403e-02 1 1  ON 33
 eO_4                 1.757410e-01 1 1  ON 34
 eO_5                 3.636730e-01 1 1  ON 35
 eO_6                 4.604640e-01 1 1  ON 36
 eO_7                 5.332313e-01 1 1  ON 37
 eO_8                 5.128950e-01 1 1  ON 38
 eO_9                 3.637227e-01 1 1  ON 39
eH1_0                -1.869413e-01 1 1  ON 40
eH1_1                -9.987135e-02 1 1  ON 41
eH1_2                -6.670240e-02 1 1  ON 42
eH1_3                -5.048149e-02 1 1  ON 43
eH1_4                 1.046153e-02 1 1  ON 44
eH1_5                 6.736965e-02 1 1  ON 45
eH1_6                 1.248472e-01 1 1  ON 46
eH1_7                 1.029084e-01 1 1  ON 47
eH1_8                 8.596508e-03 1 1  ON 48
eH1_9                -2.311981e-02 1 1  ON 49
eH2_0                -1.888256e-01 1 1  ON 50
eH2_1                -1.013677e-01 1 1  ON 51
eH2_2                -6.854206e-02 1 1  ON 52
eH2_3                -5.290365e-02 1 1  ON 53
eH2_4                 7.755672e-03 1 1  ON 54
eH2_5                 6.486143e-02 1 1  ON 55
eH2_6                 1.220584e-01 1 1  ON 56
eH2_7                 1.006210e-01 1 1  ON 57
eH2_8                 9.438103e-03 1 1  ON 58
eH2_9                -8.622975e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1503e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8672
    reference variance = 0.448975
====================================================
  Execution time = 7.8025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0608e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6533e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506133757640
                                         uncertainty =       0.005043741532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506133757640
                                         uncertainty =       0.005043741532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503033103
  error estimate for blocks of size 2^( 2) =       0.000520699133
  error estimate for blocks of size 2^( 3) =       0.000536528580
  error estimate for blocks of size 2^( 4) =       0.000546479333
  error estimate for blocks of size 2^( 5) =       0.000553212685
  error estimate for blocks of size 2^( 6) =       0.000558231128
  error estimate for blocks of size 2^( 7) =       0.000558460098

      target function =                  N/A
              le_mean =     -22.825146560918
             les_mean =     521.493399878997
             stat err =       0.000554095811
             autocorr =       1.213323484190
              std dev =       0.711396236047
             le_variance =       0.506084604661


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282514656092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825146560918       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825147792881       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825145954118       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825145167408       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825145782212       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825146380588       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825147005024       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825147004345       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825146637782       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825145915387       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825146528491       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825146581112       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825146863012       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825146526189       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825146570089       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 1.116274e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825146560918       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825147202166       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825146523859       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825145676657       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825145687148       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825145724147       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825146452253       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825146467097       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825146235362       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825145968984       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825146148867       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825146163808       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 2.822337e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825146560918       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825146780677       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825146562093       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825146241884       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825146172027       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825146087473       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825146350387       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825146392947       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825146337067       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825146282571       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 7.293021e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0457e+02
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.654890e-01 1 1  ON 0
 uu_1                 9.171505e-02 1 1  ON 1
 uu_2                -1.976136e-02 1 1  ON 2
 uu_3                -8.528123e-02 1 1  ON 3
 uu_4                -1.232726e-01 1 1  ON 4
 uu_5                -1.465851e-01 1 1  ON 5
 uu_6                -1.600493e-01 1 1  ON 6
 uu_7                -1.633868e-01 1 1  ON 7
 uu_8                -1.534132e-01 1 1  ON 8
 uu_9                -1.270921e-01 1 1  ON 9
 ud_0                 4.368812e-01 1 1  ON 10
 ud_1                 1.544943e-01 1 1  ON 11
 ud_2                 8.759470e-03 1 1  ON 12
 ud_3                -7.124228e-02 1 1  ON 13
 ud_4                -1.185813e-01 1 1  ON 14
 ud_5                -1.486733e-01 1 1  ON 15
 ud_6                -1.670455e-01 1 1  ON 16
 ud_7                -1.741011e-01 1 1  ON 17
 ud_8                -1.666389e-01 1 1  ON 18
 ud_9                -1.429906e-01 1 1  ON 19
 eC_0                -5.742548e-01 1 1  ON 20
 eC_1                -4.192842e-01 1 1  ON 21
 eC_2                -1.694628e-01 1 1  ON 22
 eC_3                -2.220090e-02 1 1  ON 23
 eC_4                 2.712224e-02 1 1  ON 24
 eC_5                 1.130754e-01 1 1  ON 25
 eC_6                 2.307156e-01 1 1  ON 26
 eC_7                 4.089980e-01 1 1  ON 27
 eC_8                 3.137804e-01 1 1  ON 28
 eC_9                 8.144606e-02 1 1  ON 29
 eO_0                -1.259694e+00 1 1  ON 30
 eO_1                -8.815013e-01 1 1  ON 31
 eO_2                -4.018441e-01 1 1  ON 32
 eO_3                -5.536645e-02 1 1  ON 33
 eO_4                 1.756757e-01 1 1  ON 34
 eO_5                 3.636770e-01 1 1  ON 35
 eO_6                 4.605381e-01 1 1  ON 36
 eO_7                 5.331956e-01 1 1  ON 37
 eO_8                 5.129035e-01 1 1  ON 38
 eO_9                 3.639201e-01 1 1  ON 39
eH1_0                -1.867270e-01 1 1  ON 40
eH1_1                -1.000025e-01 1 1  ON 41
eH1_2                -6.661137e-02 1 1  ON 42
eH1_3                -5.062992e-02 1 1  ON 43
eH1_4                 1.046735e-02 1 1  ON 44
eH1_5                 6.750974e-02 1 1  ON 45
eH1_6                 1.248634e-01 1 1  ON 46
eH1_7                 1.027506e-01 1 1  ON 47
eH1_8                 8.592531e-03 1 1  ON 48
eH1_9                -2.321521e-02 1 1  ON 49
eH2_0                -1.887050e-01 1 1  ON 50
eH2_1                -1.014455e-01 1 1  ON 51
eH2_2                -6.865307e-02 1 1  ON 52
eH2_3                -5.301019e-02 1 1  ON 53
eH2_4                 7.620072e-03 1 1  ON 54
eH2_5                 6.476629e-02 1 1  ON 55
eH2_6                 1.222914e-01 1 1  ON 56
eH2_7                 1.005865e-01 1 1  ON 57
eH2_8                 9.559101e-03 1 1  ON 58
eH2_9                -8.640528e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8243
    reference variance = 0.382889
====================================================
  Execution time = 7.6839e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0431e-01
  Total weights = 2.0000e+06
  Execution time = 6.2678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504345548823
                                         uncertainty =       0.004212190060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504345548823
                                         uncertainty =       0.004212190060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502149543
  error estimate for blocks of size 2^( 2) =       0.000520056575
  error estimate for blocks of size 2^( 3) =       0.000535645856
  error estimate for blocks of size 2^( 4) =       0.000547105843
  error estimate for blocks of size 2^( 5) =       0.000552820347
  error estimate for blocks of size 2^( 6) =       0.000555065465
  error estimate for blocks of size 2^( 7) =       0.000557155724

      target function =                  N/A
              le_mean =     -22.825350809084
             les_mean =     521.500947632431
             stat err =       0.000553036845
             autocorr =       1.212947457795
              std dev =       0.710146693869
             le_variance =       0.504308326813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504321900942
                                         uncertainty =       0.004211033917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504321900942
                                         uncertainty =       0.004211033917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502137747
  error estimate for blocks of size 2^( 2) =       0.000520044808
  error estimate for blocks of size 2^( 3) =       0.000535638832
  error estimate for blocks of size 2^( 4) =       0.000547099870
  error estimate for blocks of size 2^( 5) =       0.000552810419
  error estimate for blocks of size 2^( 6) =       0.000555050135
  error estimate for blocks of size 2^( 7) =       0.000557140311

      target function =                  N/A
              le_mean =     -22.825352091325
             les_mean =     521.500982474642
             stat err =       0.000553025184
             autocorr =       1.212953294496
              std dev =       0.710130011909
             le_variance =       0.504284633814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504355764803
                                         uncertainty =       0.004211042698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504355764803
                                         uncertainty =       0.004211042698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502154607
  error estimate for blocks of size 2^( 2) =       0.000520060679
  error estimate for blocks of size 2^( 3) =       0.000535654835
  error estimate for blocks of size 2^( 4) =       0.000547116077
  error estimate for blocks of size 2^( 5) =       0.000552826310
  error estimate for blocks of size 2^( 6) =       0.000555067206
  error estimate for blocks of size 2^( 7) =       0.000557159188

      target function =                  N/A
              le_mean =     -22.825352138517
             les_mean =     521.501018492906
             stat err =       0.000553042195
             autocorr =       1.212946465777
              std dev =       0.710153854996
             le_variance =       0.504318497765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504353783998
                                         uncertainty =       0.004211954592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504353783998
                                         uncertainty =       0.004211954592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502153638
  error estimate for blocks of size 2^( 2) =       0.000520060264
  error estimate for blocks of size 2^( 3) =       0.000535650290
  error estimate for blocks of size 2^( 4) =       0.000547110309
  error estimate for blocks of size 2^( 5) =       0.000552823860
  error estimate for blocks of size 2^( 6) =       0.000555068310
  error estimate for blocks of size 2^( 7) =       0.000557159305

      target function =                  N/A
              le_mean =     -22.825350807936
             les_mean =     521.500955806219
             stat err =       0.000553040446
             autocorr =       1.212943470377
              std dev =       0.710152485763
             le_variance =       0.504316553035


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825350809084        initial
     9.7656e-02     9.7656e-01             1.1163e-03       -22.825352091325
     3.9062e-01     3.9062e+00             2.8223e-04       -22.825352138517  <--
     1.5625e+00     1.5625e+01             7.2930e-05       -22.825350807936

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 1.0827e+02
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.654890e-01 1 1  ON 0
 uu_1                 9.171505e-02 1 1  ON 1
 uu_2                -1.976136e-02 1 1  ON 2
 uu_3                -8.528123e-02 1 1  ON 3
 uu_4                -1.232726e-01 1 1  ON 4
 uu_5                -1.465851e-01 1 1  ON 5
 uu_6                -1.600493e-01 1 1  ON 6
 uu_7                -1.633868e-01 1 1  ON 7
 uu_8                -1.534132e-01 1 1  ON 8
 uu_9                -1.270921e-01 1 1  ON 9
 ud_0                 4.368812e-01 1 1  ON 10
 ud_1                 1.544943e-01 1 1  ON 11
 ud_2                 8.759470e-03 1 1  ON 12
 ud_3                -7.124228e-02 1 1  ON 13
 ud_4                -1.185813e-01 1 1  ON 14
 ud_5                -1.486733e-01 1 1  ON 15
 ud_6                -1.670455e-01 1 1  ON 16
 ud_7                -1.741011e-01 1 1  ON 17
 ud_8                -1.666389e-01 1 1  ON 18
 ud_9                -1.429906e-01 1 1  ON 19
 eC_0                -5.742548e-01 1 1  ON 20
 eC_1                -4.192842e-01 1 1  ON 21
 eC_2                -1.694628e-01 1 1  ON 22
 eC_3                -2.220090e-02 1 1  ON 23
 eC_4                 2.712224e-02 1 1  ON 24
 eC_5                 1.130754e-01 1 1  ON 25
 eC_6                 2.307156e-01 1 1  ON 26
 eC_7                 4.089980e-01 1 1  ON 27
 eC_8                 3.137804e-01 1 1  ON 28
 eC_9                 8.144606e-02 1 1  ON 29
 eO_0                -1.259694e+00 1 1  ON 30
 eO_1                -8.815013e-01 1 1  ON 31
 eO_2                -4.018441e-01 1 1  ON 32
 eO_3                -5.536645e-02 1 1  ON 33
 eO_4                 1.756757e-01 1 1  ON 34
 eO_5                 3.636770e-01 1 1  ON 35
 eO_6                 4.605381e-01 1 1  ON 36
 eO_7                 5.331956e-01 1 1  ON 37
 eO_8                 5.129035e-01 1 1  ON 38
 eO_9                 3.639201e-01 1 1  ON 39
eH1_0                -1.867270e-01 1 1  ON 40
eH1_1                -1.000025e-01 1 1  ON 41
eH1_2                -6.661137e-02 1 1  ON 42
eH1_3                -5.062992e-02 1 1  ON 43
eH1_4                 1.046735e-02 1 1  ON 44
eH1_5                 6.750974e-02 1 1  ON 45
eH1_6                 1.248634e-01 1 1  ON 46
eH1_7                 1.027506e-01 1 1  ON 47
eH1_8                 8.592531e-03 1 1  ON 48
eH1_9                -2.321521e-02 1 1  ON 49
eH2_0                -1.887050e-01 1 1  ON 50
eH2_1                -1.014455e-01 1 1  ON 51
eH2_2                -6.865307e-02 1 1  ON 52
eH2_3                -5.301019e-02 1 1  ON 53
eH2_4                 7.620072e-03 1 1  ON 54
eH2_5                 6.476629e-02 1 1  ON 55
eH2_6                 1.222914e-01 1 1  ON 56
eH2_7                 1.005865e-01 1 1  ON 57
eH2_8                 9.559101e-03 1 1  ON 58
eH2_9                -8.640528e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1285e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8449
    reference variance = 0.961114
====================================================
  Execution time = 8.0018e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1285e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5820e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512918417947
                                         uncertainty =       0.005233612825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512918417947
                                         uncertainty =       0.005233612825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506383001
  error estimate for blocks of size 2^( 2) =       0.000524041146
  error estimate for blocks of size 2^( 3) =       0.000539751189
  error estimate for blocks of size 2^( 4) =       0.000550046787
  error estimate for blocks of size 2^( 5) =       0.000557118756
  error estimate for blocks of size 2^( 6) =       0.000561115957
  error estimate for blocks of size 2^( 7) =       0.000563505796

      target function =                  N/A
              le_mean =     -22.826026083363
             les_mean =     521.540313988353
             stat err =       0.000557946824
             autocorr =       1.214024311952
              std dev =       0.716133707071
             le_variance =       0.512847486404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282602608336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826026083363       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826027790321       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826028171325       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826028676795       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826029565071       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826030883556       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826031044050       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826030994764       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826031409005       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826030600087       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826030084110       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826031257611       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826031489733       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.826031679665       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.826031518992       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.826031402319       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 9.975875e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826026083363       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826026949584       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826027068681       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826027285965       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826027833662       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826028696905       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826028676203       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826028425488       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826028598031       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826028419750       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826028285644       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826028575073       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826028590318       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 3.006608e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826026083363       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826026375006       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826026412626       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826026480076       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826026696123       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826026941562       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826027068766       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826026898993       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826026941165       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826026931642       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 9.297817e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0585e+02
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.656809e-01 1 1  ON 0
 uu_1                 9.164874e-02 1 1  ON 1
 uu_2                -1.975122e-02 1 1  ON 2
 uu_3                -8.532738e-02 1 1  ON 3
 uu_4                -1.232712e-01 1 1  ON 4
 uu_5                -1.466393e-01 1 1  ON 5
 uu_6                -1.599066e-01 1 1  ON 6
 uu_7                -1.635100e-01 1 1  ON 7
 uu_8                -1.533692e-01 1 1  ON 8
 uu_9                -1.270323e-01 1 1  ON 9
 ud_0                 4.368525e-01 1 1  ON 10
 ud_1                 1.545295e-01 1 1  ON 11
 ud_2                 8.836710e-03 1 1  ON 12
 ud_3                -7.118227e-02 1 1  ON 13
 ud_4                -1.185406e-01 1 1  ON 14
 ud_5                -1.485688e-01 1 1  ON 15
 ud_6                -1.670633e-01 1 1  ON 16
 ud_7                -1.743627e-01 1 1  ON 17
 ud_8                -1.665383e-01 1 1  ON 18
 ud_9                -1.427869e-01 1 1  ON 19
 eC_0                -5.743851e-01 1 1  ON 20
 eC_1                -4.192841e-01 1 1  ON 21
 eC_2                -1.693984e-01 1 1  ON 22
 eC_3                -2.220328e-02 1 1  ON 23
 eC_4                 2.695819e-02 1 1  ON 24
 eC_5                 1.129848e-01 1 1  ON 25
 eC_6                 2.307911e-01 1 1  ON 26
 eC_7                 4.088513e-01 1 1  ON 27
 eC_8                 3.140356e-01 1 1  ON 28
 eC_9                 8.156588e-02 1 1  ON 29
 eO_0                -1.259677e+00 1 1  ON 30
 eO_1                -8.813522e-01 1 1  ON 31
 eO_2                -4.018879e-01 1 1  ON 32
 eO_3                -5.537266e-02 1 1  ON 33
 eO_4                 1.754265e-01 1 1  ON 34
 eO_5                 3.634548e-01 1 1  ON 35
 eO_6                 4.605078e-01 1 1  ON 36
 eO_7                 5.331514e-01 1 1  ON 37
 eO_8                 5.128696e-01 1 1  ON 38
 eO_9                 3.641400e-01 1 1  ON 39
eH1_0                -1.868765e-01 1 1  ON 40
eH1_1                -9.983581e-02 1 1  ON 41
eH1_2                -6.675964e-02 1 1  ON 42
eH1_3                -5.061268e-02 1 1  ON 43
eH1_4                 1.036521e-02 1 1  ON 44
eH1_5                 6.757168e-02 1 1  ON 45
eH1_6                 1.250829e-01 1 1  ON 46
eH1_7                 1.026652e-01 1 1  ON 47
eH1_8                 8.682666e-03 1 1  ON 48
eH1_9                -2.335980e-02 1 1  ON 49
eH2_0                -1.888699e-01 1 1  ON 50
eH2_1                -1.013741e-01 1 1  ON 51
eH2_2                -6.869794e-02 1 1  ON 52
eH2_3                -5.331085e-02 1 1  ON 53
eH2_4                 7.495750e-03 1 1  ON 54
eH2_5                 6.496843e-02 1 1  ON 55
eH2_6                 1.223101e-01 1 1  ON 56
eH2_7                 1.007717e-01 1 1  ON 57
eH2_8                 9.734632e-03 1 1  ON 58
eH2_9                -8.765011e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.733
    reference variance = 0.74368
====================================================
  Execution time = 7.6780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0257e-01
  Total weights = 2.0000e+06
  Execution time = 6.2740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502720201831
                                         uncertainty =       0.003313530767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502720201831
                                         uncertainty =       0.003313530767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501334063
  error estimate for blocks of size 2^( 2) =       0.000519177612
  error estimate for blocks of size 2^( 3) =       0.000535011994
  error estimate for blocks of size 2^( 4) =       0.000545979625
  error estimate for blocks of size 2^( 5) =       0.000554059265
  error estimate for blocks of size 2^( 6) =       0.000558904851
  error estimate for blocks of size 2^( 7) =       0.000561404316

      target function =                  N/A
              le_mean =     -22.826115200732
             les_mean =     521.534206591929
             stat err =       0.000555087014
             autocorr =       1.225935742230
              std dev =       0.708993431672
             le_variance =       0.502671686154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502541824400
                                         uncertainty =       0.003313412742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502541824400
                                         uncertainty =       0.003313412742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501245056
  error estimate for blocks of size 2^( 2) =       0.000519093217
  error estimate for blocks of size 2^( 3) =       0.000534932025
  error estimate for blocks of size 2^( 4) =       0.000545902112
  error estimate for blocks of size 2^( 5) =       0.000553979094
  error estimate for blocks of size 2^( 6) =       0.000558831950
  error estimate for blocks of size 2^( 7) =       0.000561332005

      target function =                  N/A
              le_mean =     -22.826111133140
             les_mean =     521.533842423620
             stat err =       0.000555011291
             autocorr =       1.226036591239
              std dev =       0.708867556315
             le_variance =       0.502493212397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502527155689
                                         uncertainty =       0.003312986077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502527155689
                                         uncertainty =       0.003312986077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501237719
  error estimate for blocks of size 2^( 2) =       0.000519087387
  error estimate for blocks of size 2^( 3) =       0.000534927037
  error estimate for blocks of size 2^( 4) =       0.000545897323
  error estimate for blocks of size 2^( 5) =       0.000553976029
  error estimate for blocks of size 2^( 6) =       0.000558827160
  error estimate for blocks of size 2^( 7) =       0.000561328431

      target function =                  N/A
              le_mean =     -22.826110182393
             les_mean =     521.533784308675
             stat err =       0.000555007236
             autocorr =       1.226054571048
              std dev =       0.708857179657
             le_variance =       0.502478501152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502674150480
                                         uncertainty =       0.003313347302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502674150480
                                         uncertainty =       0.003313347302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501311086
  error estimate for blocks of size 2^( 2) =       0.000519156058
  error estimate for blocks of size 2^( 3) =       0.000534991677
  error estimate for blocks of size 2^( 4) =       0.000545960006
  error estimate for blocks of size 2^( 5) =       0.000554039585
  error estimate for blocks of size 2^( 6) =       0.000558885704
  error estimate for blocks of size 2^( 7) =       0.000561385956

      target function =                  N/A
              le_mean =     -22.826113896857
             les_mean =     521.534100990368
             stat err =       0.000555067813
             autocorr =       1.225963305625
              std dev =       0.708960936447
             le_variance =       0.502625609408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826115200732        initial  <--
     9.7656e-02     9.7656e-01             9.9759e-04       -22.826111133140
     3.9062e-01     3.9062e+00             3.0066e-04       -22.826110182393
     1.5625e+00     1.5625e+01             9.2978e-05       -22.826113896857

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 108.1732
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.654890e-01 1 1  ON 0
 uu_1                 9.171505e-02 1 1  ON 1
 uu_2                -1.976136e-02 1 1  ON 2
 uu_3                -8.528123e-02 1 1  ON 3
 uu_4                -1.232726e-01 1 1  ON 4
 uu_5                -1.465851e-01 1 1  ON 5
 uu_6                -1.600493e-01 1 1  ON 6
 uu_7                -1.633868e-01 1 1  ON 7
 uu_8                -1.534132e-01 1 1  ON 8
 uu_9                -1.270921e-01 1 1  ON 9
 ud_0                 4.368812e-01 1 1  ON 10
 ud_1                 1.544943e-01 1 1  ON 11
 ud_2                 8.759470e-03 1 1  ON 12
 ud_3                -7.124228e-02 1 1  ON 13
 ud_4                -1.185813e-01 1 1  ON 14
 ud_5                -1.486733e-01 1 1  ON 15
 ud_6                -1.670455e-01 1 1  ON 16
 ud_7                -1.741011e-01 1 1  ON 17
 ud_8                -1.666389e-01 1 1  ON 18
 ud_9                -1.429906e-01 1 1  ON 19
 eC_0                -5.742548e-01 1 1  ON 20
 eC_1                -4.192842e-01 1 1  ON 21
 eC_2                -1.694628e-01 1 1  ON 22
 eC_3                -2.220090e-02 1 1  ON 23
 eC_4                 2.712224e-02 1 1  ON 24
 eC_5                 1.130754e-01 1 1  ON 25
 eC_6                 2.307156e-01 1 1  ON 26
 eC_7                 4.089980e-01 1 1  ON 27
 eC_8                 3.137804e-01 1 1  ON 28
 eC_9                 8.144606e-02 1 1  ON 29
 eO_0                -1.259694e+00 1 1  ON 30
 eO_1                -8.815013e-01 1 1  ON 31
 eO_2                -4.018441e-01 1 1  ON 32
 eO_3                -5.536645e-02 1 1  ON 33
 eO_4                 1.756757e-01 1 1  ON 34
 eO_5                 3.636770e-01 1 1  ON 35
 eO_6                 4.605381e-01 1 1  ON 36
 eO_7                 5.331956e-01 1 1  ON 37
 eO_8                 5.129035e-01 1 1  ON 38
 eO_9                 3.639201e-01 1 1  ON 39
eH1_0                -1.867270e-01 1 1  ON 40
eH1_1                -1.000025e-01 1 1  ON 41
eH1_2                -6.661137e-02 1 1  ON 42
eH1_3                -5.062992e-02 1 1  ON 43
eH1_4                 1.046735e-02 1 1  ON 44
eH1_5                 6.750974e-02 1 1  ON 45
eH1_6                 1.248634e-01 1 1  ON 46
eH1_7                 1.027506e-01 1 1  ON 47
eH1_8                 8.592531e-03 1 1  ON 48
eH1_9                -2.321521e-02 1 1  ON 49
eH2_0                -1.887050e-01 1 1  ON 50
eH2_1                -1.014455e-01 1 1  ON 51
eH2_2                -6.865307e-02 1 1  ON 52
eH2_3                -5.301019e-02 1 1  ON 53
eH2_4                 7.620072e-03 1 1  ON 54
eH2_5                 6.476629e-02 1 1  ON 55
eH2_6                 1.222914e-01 1 1  ON 56
eH2_7                 1.005865e-01 1 1  ON 57
eH2_8                 9.559101e-03 1 1  ON 58
eH2_9                -8.640528e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1403e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8325
    reference variance = 0.306205
====================================================
  Execution time = 7.8827e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.2103e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6212e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521023839429
                                         uncertainty =       0.017978143935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521023839429
                                         uncertainty =       0.017978143935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510407046
  error estimate for blocks of size 2^( 2) =       0.000528027548
  error estimate for blocks of size 2^( 3) =       0.000543488457
  error estimate for blocks of size 2^( 4) =       0.000554505102
  error estimate for blocks of size 2^( 5) =       0.000558809386
  error estimate for blocks of size 2^( 6) =       0.000562015531
  error estimate for blocks of size 2^( 7) =       0.000565575854

      target function =                  N/A
              le_mean =     -22.825094449287
             les_mean =     521.505967063495
             stat err =       0.000560226468
             autocorr =       1.204741650414
              std dev =       0.721824566740
             le_variance =       0.521030705149


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282509444929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825094449287       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825095820434       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825096159331       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825096328413       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825096515580       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825096773104       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825096640522       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825096719598       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825096684230       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825096598919       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 1.447393e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825094449287       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825094861566       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825094976147       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825095028721       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825095080048       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825095168949       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825095117777       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825095150880       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825095143009       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825095121102       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 3.883738e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825094449287       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825094557859       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825094589399       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825094603482       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825094616730       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825094641114       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825094626840       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825094636043       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825094634039       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825094628871       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+01 is 9.880610e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111925 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0505e+02
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.655278e-01 1 1  ON 0
 uu_1                 9.173441e-02 1 1  ON 1
 uu_2                -1.975382e-02 1 1  ON 2
 uu_3                -8.528895e-02 1 1  ON 3
 uu_4                -1.232656e-01 1 1  ON 4
 uu_5                -1.465646e-01 1 1  ON 5
 uu_6                -1.600720e-01 1 1  ON 6
 uu_7                -1.633861e-01 1 1  ON 7
 uu_8                -1.534181e-01 1 1  ON 8
 uu_9                -1.270977e-01 1 1  ON 9
 ud_0                 4.369013e-01 1 1  ON 10
 ud_1                 1.544915e-01 1 1  ON 11
 ud_2                 8.774750e-03 1 1  ON 12
 ud_3                -7.124776e-02 1 1  ON 13
 ud_4                -1.185759e-01 1 1  ON 14
 ud_5                -1.486467e-01 1 1  ON 15
 ud_6                -1.670617e-01 1 1  ON 16
 ud_7                -1.740785e-01 1 1  ON 17
 ud_8                -1.666283e-01 1 1  ON 18
 ud_9                -1.429991e-01 1 1  ON 19
 eC_0                -5.742481e-01 1 1  ON 20
 eC_1                -4.192692e-01 1 1  ON 21
 eC_2                -1.694598e-01 1 1  ON 22
 eC_3                -2.221364e-02 1 1  ON 23
 eC_4                 2.710496e-02 1 1  ON 24
 eC_5                 1.130540e-01 1 1  ON 25
 eC_6                 2.307211e-01 1 1  ON 26
 eC_7                 4.089938e-01 1 1  ON 27
 eC_8                 3.137969e-01 1 1  ON 28
 eC_9                 8.145425e-02 1 1  ON 29
 eO_0                -1.259717e+00 1 1  ON 30
 eO_1                -8.815047e-01 1 1  ON 31
 eO_2                -4.018449e-01 1 1  ON 32
 eO_3                -5.534988e-02 1 1  ON 33
 eO_4                 1.756719e-01 1 1  ON 34
 eO_5                 3.636729e-01 1 1  ON 35
 eO_6                 4.605330e-01 1 1  ON 36
 eO_7                 5.331965e-01 1 1  ON 37
 eO_8                 5.128917e-01 1 1  ON 38
 eO_9                 3.639367e-01 1 1  ON 39
eH1_0                -1.867361e-01 1 1  ON 40
eH1_1                -9.997607e-02 1 1  ON 41
eH1_2                -6.662931e-02 1 1  ON 42
eH1_3                -5.065929e-02 1 1  ON 43
eH1_4                 1.043946e-02 1 1  ON 44
eH1_5                 6.754585e-02 1 1  ON 45
eH1_6                 1.248687e-01 1 1  ON 46
eH1_7                 1.027582e-01 1 1  ON 47
eH1_8                 8.605616e-03 1 1  ON 48
eH1_9                -2.322407e-02 1 1  ON 49
eH2_0                -1.887129e-01 1 1  ON 50
eH2_1                -1.014422e-01 1 1  ON 51
eH2_2                -6.863963e-02 1 1  ON 52
eH2_3                -5.302472e-02 1 1  ON 53
eH2_4                 7.642838e-03 1 1  ON 54
eH2_5                 6.477046e-02 1 1  ON 55
eH2_6                 1.222919e-01 1 1  ON 56
eH2_7                 1.005716e-01 1 1  ON 57
eH2_8                 9.565631e-03 1 1  ON 58
eH2_9                -8.656610e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6879
    reference variance = 0.470617
====================================================
  Execution time = 7.7239e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0172e-01
  Total weights = 2.0000e+06
  Execution time = 6.2636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501815706818
                                         uncertainty =       0.004186331820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501815706818
                                         uncertainty =       0.004186331820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500848339
  error estimate for blocks of size 2^( 2) =       0.000518725446
  error estimate for blocks of size 2^( 3) =       0.000534212026
  error estimate for blocks of size 2^( 4) =       0.000545475408
  error estimate for blocks of size 2^( 5) =       0.000551345997
  error estimate for blocks of size 2^( 6) =       0.000555130854
  error estimate for blocks of size 2^( 7) =       0.000556331562

      target function =                  N/A
              le_mean =     -22.825983538246
             les_mean =     521.527222354146
             stat err =       0.000552070955
             autocorr =       1.215002925585
              std dev =       0.708306513238
             le_variance =       0.501698116695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501907010695
                                         uncertainty =       0.004187033697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501907010695
                                         uncertainty =       0.004187033697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500893915
  error estimate for blocks of size 2^( 2) =       0.000518769752
  error estimate for blocks of size 2^( 3) =       0.000534253488
  error estimate for blocks of size 2^( 4) =       0.000545514411
  error estimate for blocks of size 2^( 5) =       0.000551384842
  error estimate for blocks of size 2^( 6) =       0.000555172447
  error estimate for blocks of size 2^( 7) =       0.000556370332

      target function =                  N/A
              le_mean =     -22.825982930185
             les_mean =     521.527285906760
             stat err =       0.000552110508
             autocorr =       1.214955898000
              std dev =       0.708370968180
             le_variance =       0.501789428560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501868358161
                                         uncertainty =       0.004186754762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501868358161
                                         uncertainty =       0.004186754762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500874623
  error estimate for blocks of size 2^( 2) =       0.000518751192
  error estimate for blocks of size 2^( 3) =       0.000534236215
  error estimate for blocks of size 2^( 4) =       0.000545498200
  error estimate for blocks of size 2^( 5) =       0.000551369103
  error estimate for blocks of size 2^( 6) =       0.000555155433
  error estimate for blocks of size 2^( 7) =       0.000556354001

      target function =                  N/A
              le_mean =     -22.825983162487
             les_mean =     521.527257859897
             stat err =       0.000552094184
             autocorr =       1.214977643752
              std dev =       0.708343685385
             le_variance =       0.501750776624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501822554413
                                         uncertainty =       0.004186388173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501822554413
                                         uncertainty =       0.004186388173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500851757
  error estimate for blocks of size 2^( 2) =       0.000518728803
  error estimate for blocks of size 2^( 3) =       0.000534215184
  error estimate for blocks of size 2^( 4) =       0.000545478385
  error estimate for blocks of size 2^( 5) =       0.000551349034
  error estimate for blocks of size 2^( 6) =       0.000555134075
  error estimate for blocks of size 2^( 7) =       0.000556334482

      target function =                  N/A
              le_mean =     -22.825983482425
             les_mean =     521.527226654692
             stat err =       0.000552073994
             autocorr =       1.214999713577
              std dev =       0.708311347931
             le_variance =       0.501704965608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825983538246        initial  <--
     9.7656e-01     9.7656e+00             1.4474e-04       -22.825982930185
     3.9062e+00     3.9062e+01             3.8837e-05       -22.825983162487
     1.5625e+01     1.5625e+02             9.8806e-06       -22.825983482425

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 108.6465
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.654890e-01 1 1  ON 0
 uu_1                 9.171505e-02 1 1  ON 1
 uu_2                -1.976136e-02 1 1  ON 2
 uu_3                -8.528123e-02 1 1  ON 3
 uu_4                -1.232726e-01 1 1  ON 4
 uu_5                -1.465851e-01 1 1  ON 5
 uu_6                -1.600493e-01 1 1  ON 6
 uu_7                -1.633868e-01 1 1  ON 7
 uu_8                -1.534132e-01 1 1  ON 8
 uu_9                -1.270921e-01 1 1  ON 9
 ud_0                 4.368812e-01 1 1  ON 10
 ud_1                 1.544943e-01 1 1  ON 11
 ud_2                 8.759470e-03 1 1  ON 12
 ud_3                -7.124228e-02 1 1  ON 13
 ud_4                -1.185813e-01 1 1  ON 14
 ud_5                -1.486733e-01 1 1  ON 15
 ud_6                -1.670455e-01 1 1  ON 16
 ud_7                -1.741011e-01 1 1  ON 17
 ud_8                -1.666389e-01 1 1  ON 18
 ud_9                -1.429906e-01 1 1  ON 19
 eC_0                -5.742548e-01 1 1  ON 20
 eC_1                -4.192842e-01 1 1  ON 21
 eC_2                -1.694628e-01 1 1  ON 22
 eC_3                -2.220090e-02 1 1  ON 23
 eC_4                 2.712224e-02 1 1  ON 24
 eC_5                 1.130754e-01 1 1  ON 25
 eC_6                 2.307156e-01 1 1  ON 26
 eC_7                 4.089980e-01 1 1  ON 27
 eC_8                 3.137804e-01 1 1  ON 28
 eC_9                 8.144606e-02 1 1  ON 29
 eO_0                -1.259694e+00 1 1  ON 30
 eO_1                -8.815013e-01 1 1  ON 31
 eO_2                -4.018441e-01 1 1  ON 32
 eO_3                -5.536645e-02 1 1  ON 33
 eO_4                 1.756757e-01 1 1  ON 34
 eO_5                 3.636770e-01 1 1  ON 35
 eO_6                 4.605381e-01 1 1  ON 36
 eO_7                 5.331956e-01 1 1  ON 37
 eO_8                 5.129035e-01 1 1  ON 38
 eO_9                 3.639201e-01 1 1  ON 39
eH1_0                -1.867270e-01 1 1  ON 40
eH1_1                -1.000025e-01 1 1  ON 41
eH1_2                -6.661137e-02 1 1  ON 42
eH1_3                -5.062992e-02 1 1  ON 43
eH1_4                 1.046735e-02 1 1  ON 44
eH1_5                 6.750974e-02 1 1  ON 45
eH1_6                 1.248634e-01 1 1  ON 46
eH1_7                 1.027506e-01 1 1  ON 47
eH1_8                 8.592531e-03 1 1  ON 48
eH1_9                -2.321521e-02 1 1  ON 49
eH2_0                -1.887050e-01 1 1  ON 50
eH2_1                -1.014455e-01 1 1  ON 51
eH2_2                -6.865307e-02 1 1  ON 52
eH2_3                -5.301019e-02 1 1  ON 53
eH2_4                 7.620072e-03 1 1  ON 54
eH2_5                 6.476629e-02 1 1  ON 55
eH2_6                 1.222914e-01 1 1  ON 56
eH2_7                 1.005865e-01 1 1  ON 57
eH2_8                 9.559101e-03 1 1  ON 58
eH2_9                -8.640528e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1370e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.9364
    reference variance = 0.499949
====================================================
  Execution time = 7.7945e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0517e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6131e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505291297939
                                         uncertainty =       0.003757055551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505291297939
                                         uncertainty =       0.003757055551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502577438
  error estimate for blocks of size 2^( 2) =       0.000521094586
  error estimate for blocks of size 2^( 3) =       0.000536933579
  error estimate for blocks of size 2^( 4) =       0.000547576527
  error estimate for blocks of size 2^( 5) =       0.000553046507
  error estimate for blocks of size 2^( 6) =       0.000554936074
  error estimate for blocks of size 2^( 7) =       0.000558136059

      target function =                  N/A
              le_mean =     -22.826494621740
             les_mean =     521.554024626732
             stat err =       0.000553423792
             autocorr =       1.212577971082
              std dev =       0.710751829385
             le_variance =       0.505168162975


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282649462174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826494621740       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826494697694       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826494650134       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826494611288       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826494665139       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826494678111       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826494705118       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826494694241       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826494690928       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826494700987       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 1.325722e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826494621740       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826494640966       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826494628963       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826494619181       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826494633212       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826494636686       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826494643803       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826494640929       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826494640155       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826494642743       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+01 is 3.330808e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826494621740       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826494626562       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826494623554       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826494621104       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826494624649       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826494625534       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826494627338       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826494626610       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826494626420       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826494627071       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 8.337518e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0408e+02
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.654908e-01 1 1  ON 0
 uu_1                 9.171247e-02 1 1  ON 1
 uu_2                -1.976093e-02 1 1  ON 2
 uu_3                -8.528303e-02 1 1  ON 3
 uu_4                -1.232710e-01 1 1  ON 4
 uu_5                -1.465836e-01 1 1  ON 5
 uu_6                -1.600508e-01 1 1  ON 6
 uu_7                -1.633847e-01 1 1  ON 7
 uu_8                -1.534130e-01 1 1  ON 8
 uu_9                -1.270903e-01 1 1  ON 9
 ud_0                 4.368784e-01 1 1  ON 10
 ud_1                 1.544970e-01 1 1  ON 11
 ud_2                 8.761691e-03 1 1  ON 12
 ud_3                -7.123987e-02 1 1  ON 13
 ud_4                -1.185824e-01 1 1  ON 14
 ud_5                -1.486740e-01 1 1  ON 15
 ud_6                -1.670460e-01 1 1  ON 16
 ud_7                -1.741006e-01 1 1  ON 17
 ud_8                -1.666365e-01 1 1  ON 18
 ud_9                -1.429895e-01 1 1  ON 19
 eC_0                -5.742542e-01 1 1  ON 20
 eC_1                -4.192846e-01 1 1  ON 21
 eC_2                -1.694637e-01 1 1  ON 22
 eC_3                -2.219971e-02 1 1  ON 23
 eC_4                 2.711965e-02 1 1  ON 24
 eC_5                 1.130737e-01 1 1  ON 25
 eC_6                 2.307170e-01 1 1  ON 26
 eC_7                 4.089975e-01 1 1  ON 27
 eC_8                 3.137821e-01 1 1  ON 28
 eC_9                 8.144712e-02 1 1  ON 29
 eO_0                -1.259696e+00 1 1  ON 30
 eO_1                -8.815007e-01 1 1  ON 31
 eO_2                -4.018445e-01 1 1  ON 32
 eO_3                -5.536797e-02 1 1  ON 33
 eO_4                 1.756759e-01 1 1  ON 34
 eO_5                 3.636760e-01 1 1  ON 35
 eO_6                 4.605383e-01 1 1  ON 36
 eO_7                 5.331965e-01 1 1  ON 37
 eO_8                 5.129031e-01 1 1  ON 38
 eO_9                 3.639218e-01 1 1  ON 39
eH1_0                -1.867253e-01 1 1  ON 40
eH1_1                -1.000028e-01 1 1  ON 41
eH1_2                -6.661176e-02 1 1  ON 42
eH1_3                -5.063310e-02 1 1  ON 43
eH1_4                 1.046503e-02 1 1  ON 44
eH1_5                 6.751004e-02 1 1  ON 45
eH1_6                 1.248667e-01 1 1  ON 46
eH1_7                 1.027506e-01 1 1  ON 47
eH1_8                 8.594151e-03 1 1  ON 48
eH1_9                -2.321632e-02 1 1  ON 49
eH2_0                -1.887045e-01 1 1  ON 50
eH2_1                -1.014454e-01 1 1  ON 51
eH2_2                -6.865343e-02 1 1  ON 52
eH2_3                -5.301310e-02 1 1  ON 53
eH2_4                 7.621835e-03 1 1  ON 54
eH2_5                 6.476874e-02 1 1  ON 55
eH2_6                 1.222889e-01 1 1  ON 56
eH2_7                 1.005863e-01 1 1  ON 57
eH2_8                 9.560477e-03 1 1  ON 58
eH2_9                -8.641690e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7645
    reference variance = 0.272392
====================================================
  Execution time = 7.9360e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.2373e-01
  Total weights = 2.0000e+06
  Execution time = 6.2982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523842323833
                                         uncertainty =       0.018035646052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523842323833
                                         uncertainty =       0.018035646052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511731466
  error estimate for blocks of size 2^( 2) =       0.000529373255
  error estimate for blocks of size 2^( 3) =       0.000544877524
  error estimate for blocks of size 2^( 4) =       0.000556710298
  error estimate for blocks of size 2^( 5) =       0.000562569570
  error estimate for blocks of size 2^( 6) =       0.000565758282
  error estimate for blocks of size 2^( 7) =       0.000565529485

      target function =                  N/A
              le_mean =     -22.825246106563
             les_mean =     521.515597749887
             stat err =       0.000562641909
             autocorr =       1.208870865483
              std dev =       0.723697579498
             le_variance =       0.523738186572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523817803845
                                         uncertainty =       0.018035412496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523817803845
                                         uncertainty =       0.018035412496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511719488
  error estimate for blocks of size 2^( 2) =       0.000529362058
  error estimate for blocks of size 2^( 3) =       0.000544866806
  error estimate for blocks of size 2^( 4) =       0.000556700239
  error estimate for blocks of size 2^( 5) =       0.000562560152
  error estimate for blocks of size 2^( 6) =       0.000565749030
  error estimate for blocks of size 2^( 7) =       0.000565520232

      target function =                  N/A
              le_mean =     -22.825245967448
             les_mean =     521.515566881077
             stat err =       0.000562632413
             autocorr =       1.208886654875
              std dev =       0.723680639813
             le_variance =       0.523713668440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523829533451
                                         uncertainty =       0.018035526341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523829533451
                                         uncertainty =       0.018035526341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511725218
  error estimate for blocks of size 2^( 2) =       0.000529367411
  error estimate for blocks of size 2^( 3) =       0.000544871927
  error estimate for blocks of size 2^( 4) =       0.000556705047
  error estimate for blocks of size 2^( 5) =       0.000562564654
  error estimate for blocks of size 2^( 6) =       0.000565753452
  error estimate for blocks of size 2^( 7) =       0.000565524653

      target function =                  N/A
              le_mean =     -22.825246033688
             les_mean =     521.515581633702
             stat err =       0.000562636951
             autocorr =       1.208879082933
              std dev =       0.723688743286
             le_variance =       0.523725397159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523840707141
                                         uncertainty =       0.018035631008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523840707141
                                         uncertainty =       0.018035631008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511730676
  error estimate for blocks of size 2^( 2) =       0.000529372516
  error estimate for blocks of size 2^( 3) =       0.000544876816
  error estimate for blocks of size 2^( 4) =       0.000556709634
  error estimate for blocks of size 2^( 5) =       0.000562568948
  error estimate for blocks of size 2^( 6) =       0.000565757671
  error estimate for blocks of size 2^( 7) =       0.000565528874

      target function =                  N/A
              le_mean =     -22.825246097286
             les_mean =     521.515595709782
             stat err =       0.000562641282
             autocorr =       1.208871903186
              std dev =       0.723696462615
             le_variance =       0.523736570002


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825246106563        initial  <--
     9.7656e+00     9.7656e+01             1.3257e-05       -22.825245967448
     3.9062e+01     3.9062e+02             3.3308e-06       -22.825246033688
     1.5625e+02     1.5625e+03             8.3375e-07       -22.825246097286

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 110.9177
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.654890e-01 1 1  ON 0
 uu_1                 9.171505e-02 1 1  ON 1
 uu_2                -1.976136e-02 1 1  ON 2
 uu_3                -8.528123e-02 1 1  ON 3
 uu_4                -1.232726e-01 1 1  ON 4
 uu_5                -1.465851e-01 1 1  ON 5
 uu_6                -1.600493e-01 1 1  ON 6
 uu_7                -1.633868e-01 1 1  ON 7
 uu_8                -1.534132e-01 1 1  ON 8
 uu_9                -1.270921e-01 1 1  ON 9
 ud_0                 4.368812e-01 1 1  ON 10
 ud_1                 1.544943e-01 1 1  ON 11
 ud_2                 8.759470e-03 1 1  ON 12
 ud_3                -7.124228e-02 1 1  ON 13
 ud_4                -1.185813e-01 1 1  ON 14
 ud_5                -1.486733e-01 1 1  ON 15
 ud_6                -1.670455e-01 1 1  ON 16
 ud_7                -1.741011e-01 1 1  ON 17
 ud_8                -1.666389e-01 1 1  ON 18
 ud_9                -1.429906e-01 1 1  ON 19
 eC_0                -5.742548e-01 1 1  ON 20
 eC_1                -4.192842e-01 1 1  ON 21
 eC_2                -1.694628e-01 1 1  ON 22
 eC_3                -2.220090e-02 1 1  ON 23
 eC_4                 2.712224e-02 1 1  ON 24
 eC_5                 1.130754e-01 1 1  ON 25
 eC_6                 2.307156e-01 1 1  ON 26
 eC_7                 4.089980e-01 1 1  ON 27
 eC_8                 3.137804e-01 1 1  ON 28
 eC_9                 8.144606e-02 1 1  ON 29
 eO_0                -1.259694e+00 1 1  ON 30
 eO_1                -8.815013e-01 1 1  ON 31
 eO_2                -4.018441e-01 1 1  ON 32
 eO_3                -5.536645e-02 1 1  ON 33
 eO_4                 1.756757e-01 1 1  ON 34
 eO_5                 3.636770e-01 1 1  ON 35
 eO_6                 4.605381e-01 1 1  ON 36
 eO_7                 5.331956e-01 1 1  ON 37
 eO_8                 5.129035e-01 1 1  ON 38
 eO_9                 3.639201e-01 1 1  ON 39
eH1_0                -1.867270e-01 1 1  ON 40
eH1_1                -1.000025e-01 1 1  ON 41
eH1_2                -6.661137e-02 1 1  ON 42
eH1_3                -5.062992e-02 1 1  ON 43
eH1_4                 1.046735e-02 1 1  ON 44
eH1_5                 6.750974e-02 1 1  ON 45
eH1_6                 1.248634e-01 1 1  ON 46
eH1_7                 1.027506e-01 1 1  ON 47
eH1_8                 8.592531e-03 1 1  ON 48
eH1_9                -2.321521e-02 1 1  ON 49
eH2_0                -1.887050e-01 1 1  ON 50
eH2_1                -1.014455e-01 1 1  ON 51
eH2_2                -6.865307e-02 1 1  ON 52
eH2_3                -5.301019e-02 1 1  ON 53
eH2_4                 7.620072e-03 1 1  ON 54
eH2_5                 6.476629e-02 1 1  ON 55
eH2_6                 1.222914e-01 1 1  ON 56
eH2_7                 1.005865e-01 1 1  ON 57
eH2_8                 9.559101e-03 1 1  ON 58
eH2_9                -8.640528e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1501e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.9257
    reference variance = 0.614926
====================================================
  Execution time = 7.8106e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0888e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7823e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508901785374
                                         uncertainty =       0.005201529037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508901785374
                                         uncertainty =       0.005201529037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504419072
  error estimate for blocks of size 2^( 2) =       0.000522153594
  error estimate for blocks of size 2^( 3) =       0.000537945650
  error estimate for blocks of size 2^( 4) =       0.000548187032
  error estimate for blocks of size 2^( 5) =       0.000555098989
  error estimate for blocks of size 2^( 6) =       0.000557529288
  error estimate for blocks of size 2^( 7) =       0.000560492077

      target function =                  N/A
              le_mean =     -22.825152506017
             les_mean =     521.496463869400
             stat err =       0.000555326847
             autocorr =       1.212032710409
              std dev =       0.713356293084
             le_variance =       0.508877200883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282515250602e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825152506017       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825152515394       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825152517004       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825152522490       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825152519970       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825152519296       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825152520020       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825152521566       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825152522373       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825152522761       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 2.035749e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825152506017       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825152508368       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825152508771       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825152510142       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825152509509       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825152509349       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825152509523       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825152509914       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825152510117       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825152510217       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+02 is 5.095142e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825152506017       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825152506606       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825152506706       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825152507049       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825152506890       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825152506850       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825152506896       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825152506991       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825152507047       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825152507069       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+03 is 1.274147e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119262 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0594e+02
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.654893e-01 1 1  ON 0
 uu_1                 9.171475e-02 1 1  ON 1
 uu_2                -1.976101e-02 1 1  ON 2
 uu_3                -8.528132e-02 1 1  ON 3
 uu_4                -1.232726e-01 1 1  ON 4
 uu_5                -1.465848e-01 1 1  ON 5
 uu_6                -1.600493e-01 1 1  ON 6
 uu_7                -1.633871e-01 1 1  ON 7
 uu_8                -1.534131e-01 1 1  ON 8
 uu_9                -1.270920e-01 1 1  ON 9
 ud_0                 4.368808e-01 1 1  ON 10
 ud_1                 1.544946e-01 1 1  ON 11
 ud_2                 8.759550e-03 1 1  ON 12
 ud_3                -7.124211e-02 1 1  ON 13
 ud_4                -1.185811e-01 1 1  ON 14
 ud_5                -1.486730e-01 1 1  ON 15
 ud_6                -1.670455e-01 1 1  ON 16
 ud_7                -1.741012e-01 1 1  ON 17
 ud_8                -1.666388e-01 1 1  ON 18
 ud_9                -1.429906e-01 1 1  ON 19
 eC_0                -5.742543e-01 1 1  ON 20
 eC_1                -4.192843e-01 1 1  ON 21
 eC_2                -1.694630e-01 1 1  ON 22
 eC_3                -2.220103e-02 1 1  ON 23
 eC_4                 2.712188e-02 1 1  ON 24
 eC_5                 1.130755e-01 1 1  ON 25
 eC_6                 2.307157e-01 1 1  ON 26
 eC_7                 4.089977e-01 1 1  ON 27
 eC_8                 3.137806e-01 1 1  ON 28
 eC_9                 8.144618e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815014e-01 1 1  ON 31
 eO_2                -4.018442e-01 1 1  ON 32
 eO_3                -5.536659e-02 1 1  ON 33
 eO_4                 1.756756e-01 1 1  ON 34
 eO_5                 3.636773e-01 1 1  ON 35
 eO_6                 4.605381e-01 1 1  ON 36
 eO_7                 5.331956e-01 1 1  ON 37
 eO_8                 5.129034e-01 1 1  ON 38
 eO_9                 3.639203e-01 1 1  ON 39
eH1_0                -1.867270e-01 1 1  ON 40
eH1_1                -1.000026e-01 1 1  ON 41
eH1_2                -6.661120e-02 1 1  ON 42
eH1_3                -5.063005e-02 1 1  ON 43
eH1_4                 1.046728e-02 1 1  ON 44
eH1_5                 6.750975e-02 1 1  ON 45
eH1_6                 1.248636e-01 1 1  ON 46
eH1_7                 1.027504e-01 1 1  ON 47
eH1_8                 8.592560e-03 1 1  ON 48
eH1_9                -2.321533e-02 1 1  ON 49
eH2_0                -1.887052e-01 1 1  ON 50
eH2_1                -1.014455e-01 1 1  ON 51
eH2_2                -6.865303e-02 1 1  ON 52
eH2_3                -5.301006e-02 1 1  ON 53
eH2_4                 7.620499e-03 1 1  ON 54
eH2_5                 6.476627e-02 1 1  ON 55
eH2_6                 1.222910e-01 1 1  ON 56
eH2_7                 1.005865e-01 1 1  ON 57
eH2_8                 9.559187e-03 1 1  ON 58
eH2_9                -8.640694e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.9196
    reference variance = 0.408453
====================================================
  Execution time = 7.7087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0010e-01
  Total weights = 2.0000e+06
  Execution time = 6.2664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500165362162
                                         uncertainty =       0.004557765964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500165362162
                                         uncertainty =       0.004557765964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500051549
  error estimate for blocks of size 2^( 2) =       0.000517804522
  error estimate for blocks of size 2^( 3) =       0.000533461209
  error estimate for blocks of size 2^( 4) =       0.000544968432
  error estimate for blocks of size 2^( 5) =       0.000552348497
  error estimate for blocks of size 2^( 6) =       0.000554745931
  error estimate for blocks of size 2^( 7) =       0.000557480362

      target function =                  N/A
              le_mean =     -22.825803469461
             les_mean =     521.517406880117
             stat err =       0.000552385805
             autocorr =       1.220268683652
              std dev =       0.707179682767
             le_variance =       0.500103103719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500162743845
                                         uncertainty =       0.004557731040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500162743845
                                         uncertainty =       0.004557731040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500050240
  error estimate for blocks of size 2^( 2) =       0.000517803285
  error estimate for blocks of size 2^( 3) =       0.000533460019
  error estimate for blocks of size 2^( 4) =       0.000544967257
  error estimate for blocks of size 2^( 5) =       0.000552347342
  error estimate for blocks of size 2^( 6) =       0.000554744746
  error estimate for blocks of size 2^( 7) =       0.000557479188

      target function =                  N/A
              le_mean =     -22.825803457759
             les_mean =     521.517403727185
             stat err =       0.000552384633
             autocorr =       1.220269895030
              std dev =       0.707177831234
             le_variance =       0.500100484989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500164046418
                                         uncertainty =       0.004557748393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500164046418
                                         uncertainty =       0.004557748393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500050891
  error estimate for blocks of size 2^( 2) =       0.000517803900
  error estimate for blocks of size 2^( 3) =       0.000533460611
  error estimate for blocks of size 2^( 4) =       0.000544967842
  error estimate for blocks of size 2^( 5) =       0.000552347917
  error estimate for blocks of size 2^( 6) =       0.000554745335
  error estimate for blocks of size 2^( 7) =       0.000557479772

      target function =                  N/A
              le_mean =     -22.825803463544
             les_mean =     521.517405294043
             stat err =       0.000552385216
             autocorr =       1.220269292224
              std dev =       0.707178752344
             le_variance =       0.500101787767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500165197480
                                         uncertainty =       0.004557763764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500165197480
                                         uncertainty =       0.004557763764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500051467
  error estimate for blocks of size 2^( 2) =       0.000517804444
  error estimate for blocks of size 2^( 3) =       0.000533461134
  error estimate for blocks of size 2^( 4) =       0.000544968358
  error estimate for blocks of size 2^( 5) =       0.000552348425
  error estimate for blocks of size 2^( 6) =       0.000554745856
  error estimate for blocks of size 2^( 7) =       0.000557480288

      target function =                  N/A
              le_mean =     -22.825803468718
             les_mean =     521.517406681513
             stat err =       0.000552385732
             autocorr =       1.220268759813
              std dev =       0.707179566313
             le_variance =       0.500102939011


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825803469461        initial  <--
     9.7656e+01     9.7656e+02             2.0357e-06       -22.825803457759
     3.9062e+02     3.9062e+03             5.0951e-07       -22.825803463544
     1.5625e+03     1.5625e+04             1.2741e-07       -22.825803468718

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 108.5425
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.654890e-01 1 1  ON 0
 uu_1                 9.171505e-02 1 1  ON 1
 uu_2                -1.976136e-02 1 1  ON 2
 uu_3                -8.528123e-02 1 1  ON 3
 uu_4                -1.232726e-01 1 1  ON 4
 uu_5                -1.465851e-01 1 1  ON 5
 uu_6                -1.600493e-01 1 1  ON 6
 uu_7                -1.633868e-01 1 1  ON 7
 uu_8                -1.534132e-01 1 1  ON 8
 uu_9                -1.270921e-01 1 1  ON 9
 ud_0                 4.368812e-01 1 1  ON 10
 ud_1                 1.544943e-01 1 1  ON 11
 ud_2                 8.759470e-03 1 1  ON 12
 ud_3                -7.124228e-02 1 1  ON 13
 ud_4                -1.185813e-01 1 1  ON 14
 ud_5                -1.486733e-01 1 1  ON 15
 ud_6                -1.670455e-01 1 1  ON 16
 ud_7                -1.741011e-01 1 1  ON 17
 ud_8                -1.666389e-01 1 1  ON 18
 ud_9                -1.429906e-01 1 1  ON 19
 eC_0                -5.742548e-01 1 1  ON 20
 eC_1                -4.192842e-01 1 1  ON 21
 eC_2                -1.694628e-01 1 1  ON 22
 eC_3                -2.220090e-02 1 1  ON 23
 eC_4                 2.712224e-02 1 1  ON 24
 eC_5                 1.130754e-01 1 1  ON 25
 eC_6                 2.307156e-01 1 1  ON 26
 eC_7                 4.089980e-01 1 1  ON 27
 eC_8                 3.137804e-01 1 1  ON 28
 eC_9                 8.144606e-02 1 1  ON 29
 eO_0                -1.259694e+00 1 1  ON 30
 eO_1                -8.815013e-01 1 1  ON 31
 eO_2                -4.018441e-01 1 1  ON 32
 eO_3                -5.536645e-02 1 1  ON 33
 eO_4                 1.756757e-01 1 1  ON 34
 eO_5                 3.636770e-01 1 1  ON 35
 eO_6                 4.605381e-01 1 1  ON 36
 eO_7                 5.331956e-01 1 1  ON 37
 eO_8                 5.129035e-01 1 1  ON 38
 eO_9                 3.639201e-01 1 1  ON 39
eH1_0                -1.867270e-01 1 1  ON 40
eH1_1                -1.000025e-01 1 1  ON 41
eH1_2                -6.661137e-02 1 1  ON 42
eH1_3                -5.062992e-02 1 1  ON 43
eH1_4                 1.046735e-02 1 1  ON 44
eH1_5                 6.750974e-02 1 1  ON 45
eH1_6                 1.248634e-01 1 1  ON 46
eH1_7                 1.027506e-01 1 1  ON 47
eH1_8                 8.592531e-03 1 1  ON 48
eH1_9                -2.321521e-02 1 1  ON 49
eH2_0                -1.887050e-01 1 1  ON 50
eH2_1                -1.014455e-01 1 1  ON 51
eH2_2                -6.865307e-02 1 1  ON 52
eH2_3                -5.301019e-02 1 1  ON 53
eH2_4                 7.620072e-03 1 1  ON 54
eH2_5                 6.476629e-02 1 1  ON 55
eH2_6                 1.222914e-01 1 1  ON 56
eH2_7                 1.005865e-01 1 1  ON 57
eH2_8                 9.559101e-03 1 1  ON 58
eH2_9                -8.640528e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1449e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7379
    reference variance = 0.498567
====================================================
  Execution time = 8.0446e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9725e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6832e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497276530337
                                         uncertainty =       0.003096452301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497276530337
                                         uncertainty =       0.003096452301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498625204
  error estimate for blocks of size 2^( 2) =       0.000516390656
  error estimate for blocks of size 2^( 3) =       0.000531735579
  error estimate for blocks of size 2^( 4) =       0.000542836363
  error estimate for blocks of size 2^( 5) =       0.000549223946
  error estimate for blocks of size 2^( 6) =       0.000552855088
  error estimate for blocks of size 2^( 7) =       0.000554776988

      target function =                  N/A
              le_mean =     -22.825890345290
             les_mean =     521.518523993810
             stat err =       0.000549923096
             autocorr =       1.216341338173
              std dev =       0.705162525398
             le_variance =       0.497254187226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282589034529e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825890345290       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825890345429       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825890345572       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825890345650       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825890345345       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825890345601       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825890345881       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825890345866       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825890345850       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825890345860       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 2.400511e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825890345290       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825890345325       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825890345361       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825890345380       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825890345304       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825890345368       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825890345437       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825890345443       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825890345428       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825890345427       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+03 is 6.002545e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825890345290       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825890345299       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825890345308       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825890345313       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825890345292       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825890345318       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825890345341       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825890345340       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825890345269       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825890345295       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+04 is 1.500716e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0729e+02
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.654890e-01 1 1  ON 0
 uu_1                 9.171504e-02 1 1  ON 1
 uu_2                -1.976137e-02 1 1  ON 2
 uu_3                -8.528124e-02 1 1  ON 3
 uu_4                -1.232726e-01 1 1  ON 4
 uu_5                -1.465851e-01 1 1  ON 5
 uu_6                -1.600493e-01 1 1  ON 6
 uu_7                -1.633868e-01 1 1  ON 7
 uu_8                -1.534132e-01 1 1  ON 8
 uu_9                -1.270921e-01 1 1  ON 9
 ud_0                 4.368812e-01 1 1  ON 10
 ud_1                 1.544944e-01 1 1  ON 11
 ud_2                 8.759487e-03 1 1  ON 12
 ud_3                -7.124227e-02 1 1  ON 13
 ud_4                -1.185813e-01 1 1  ON 14
 ud_5                -1.486734e-01 1 1  ON 15
 ud_6                -1.670455e-01 1 1  ON 16
 ud_7                -1.741011e-01 1 1  ON 17
 ud_8                -1.666389e-01 1 1  ON 18
 ud_9                -1.429906e-01 1 1  ON 19
 eC_0                -5.742548e-01 1 1  ON 20
 eC_1                -4.192842e-01 1 1  ON 21
 eC_2                -1.694628e-01 1 1  ON 22
 eC_3                -2.220089e-02 1 1  ON 23
 eC_4                 2.712218e-02 1 1  ON 24
 eC_5                 1.130755e-01 1 1  ON 25
 eC_6                 2.307156e-01 1 1  ON 26
 eC_7                 4.089979e-01 1 1  ON 27
 eC_8                 3.137804e-01 1 1  ON 28
 eC_9                 8.144607e-02 1 1  ON 29
 eO_0                -1.259694e+00 1 1  ON 30
 eO_1                -8.815013e-01 1 1  ON 31
 eO_2                -4.018441e-01 1 1  ON 32
 eO_3                -5.536645e-02 1 1  ON 33
 eO_4                 1.756757e-01 1 1  ON 34
 eO_5                 3.636770e-01 1 1  ON 35
 eO_6                 4.605380e-01 1 1  ON 36
 eO_7                 5.331956e-01 1 1  ON 37
 eO_8                 5.129035e-01 1 1  ON 38
 eO_9                 3.639201e-01 1 1  ON 39
eH1_0                -1.867270e-01 1 1  ON 40
eH1_1                -1.000025e-01 1 1  ON 41
eH1_2                -6.661134e-02 1 1  ON 42
eH1_3                -5.062992e-02 1 1  ON 43
eH1_4                 1.046731e-02 1 1  ON 44
eH1_5                 6.750975e-02 1 1  ON 45
eH1_6                 1.248634e-01 1 1  ON 46
eH1_7                 1.027506e-01 1 1  ON 47
eH1_8                 8.592546e-03 1 1  ON 48
eH1_9                -2.321522e-02 1 1  ON 49
eH2_0                -1.887051e-01 1 1  ON 50
eH2_1                -1.014455e-01 1 1  ON 51
eH2_2                -6.865309e-02 1 1  ON 52
eH2_3                -5.301019e-02 1 1  ON 53
eH2_4                 7.620102e-03 1 1  ON 54
eH2_5                 6.476631e-02 1 1  ON 55
eH2_6                 1.222914e-01 1 1  ON 56
eH2_7                 1.005865e-01 1 1  ON 57
eH2_8                 9.559099e-03 1 1  ON 58
eH2_9                -8.640550e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8547
    reference variance = 0.391581
====================================================
  Execution time = 7.6511e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0507e-01
  Total weights = 2.0000e+06
  Execution time = 6.3257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505172973427
                                         uncertainty =       0.004509181835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505172973427
                                         uncertainty =       0.004509181835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502528801
  error estimate for blocks of size 2^( 2) =       0.000520070744
  error estimate for blocks of size 2^( 3) =       0.000535249410
  error estimate for blocks of size 2^( 4) =       0.000546052290
  error estimate for blocks of size 2^( 5) =       0.000552044411
  error estimate for blocks of size 2^( 6) =       0.000553885962
  error estimate for blocks of size 2^( 7) =       0.000557743179

      target function =                  N/A
              le_mean =     -22.825791478718
             les_mean =     521.521826768984
             stat err =       0.000552431460
             autocorr =       1.208467268947
              std dev =       0.710683045819
             le_variance =       0.505070391615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505172935982
                                         uncertainty =       0.004509182147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505172935982
                                         uncertainty =       0.004509182147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502528782
  error estimate for blocks of size 2^( 2) =       0.000520070726
  error estimate for blocks of size 2^( 3) =       0.000535249394
  error estimate for blocks of size 2^( 4) =       0.000546052271
  error estimate for blocks of size 2^( 5) =       0.000552044394
  error estimate for blocks of size 2^( 6) =       0.000553885946
  error estimate for blocks of size 2^( 7) =       0.000557743168

      target function =                  N/A
              le_mean =     -22.825791481472
             les_mean =     521.521826857241
             stat err =       0.000552431445
             autocorr =       1.208467289781
              std dev =       0.710683019466
             le_variance =       0.505070354158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505172954685
                                         uncertainty =       0.004509181991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505172954685
                                         uncertainty =       0.004509181991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502528792
  error estimate for blocks of size 2^( 2) =       0.000520070735
  error estimate for blocks of size 2^( 3) =       0.000535249402
  error estimate for blocks of size 2^( 4) =       0.000546052280
  error estimate for blocks of size 2^( 5) =       0.000552044402
  error estimate for blocks of size 2^( 6) =       0.000553885954
  error estimate for blocks of size 2^( 7) =       0.000557743173

      target function =                  N/A
              le_mean =     -22.825791480095
             les_mean =     521.521826813111
             stat err =       0.000552431452
             autocorr =       1.208467279386
              std dev =       0.710683032629
             le_variance =       0.505070372866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505172971083
                                         uncertainty =       0.004509181855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505172971083
                                         uncertainty =       0.004509181855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502528800
  error estimate for blocks of size 2^( 2) =       0.000520070742
  error estimate for blocks of size 2^( 3) =       0.000535249409
  error estimate for blocks of size 2^( 4) =       0.000546052289
  error estimate for blocks of size 2^( 5) =       0.000552044410
  error estimate for blocks of size 2^( 6) =       0.000553885961
  error estimate for blocks of size 2^( 7) =       0.000557743178

      target function =                  N/A
              le_mean =     -22.825791478890
             les_mean =     521.521826774500
             stat err =       0.000552431459
             autocorr =       1.208467270245
              std dev =       0.710683044170
             le_variance =       0.505070389270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825791478718        initial
     9.7656e+02     9.7656e+03             2.4005e-07       -22.825791481472  <--
     3.9062e+03     3.9062e+04             6.0025e-08       -22.825791480095
     1.5625e+04     1.5625e+05             1.5007e-08       -22.825791478890

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 1.0810e+02
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.654892e-01 1 1  ON 0
 uu_1                 9.171502e-02 1 1  ON 1
 uu_2                -1.976142e-02 1 1  ON 2
 uu_3                -8.528129e-02 1 1  ON 3
 uu_4                -1.232726e-01 1 1  ON 4
 uu_5                -1.465850e-01 1 1  ON 5
 uu_6                -1.600493e-01 1 1  ON 6
 uu_7                -1.633868e-01 1 1  ON 7
 uu_8                -1.534132e-01 1 1  ON 8
 uu_9                -1.270921e-01 1 1  ON 9
 ud_0                 4.368812e-01 1 1  ON 10
 ud_1                 1.544944e-01 1 1  ON 11
 ud_2                 8.759538e-03 1 1  ON 12
 ud_3                -7.124224e-02 1 1  ON 13
 ud_4                -1.185812e-01 1 1  ON 14
 ud_5                -1.486734e-01 1 1  ON 15
 ud_6                -1.670455e-01 1 1  ON 16
 ud_7                -1.741011e-01 1 1  ON 17
 ud_8                -1.666389e-01 1 1  ON 18
 ud_9                -1.429906e-01 1 1  ON 19
 eC_0                -5.742548e-01 1 1  ON 20
 eC_1                -4.192842e-01 1 1  ON 21
 eC_2                -1.694628e-01 1 1  ON 22
 eC_3                -2.220084e-02 1 1  ON 23
 eC_4                 2.712202e-02 1 1  ON 24
 eC_5                 1.130755e-01 1 1  ON 25
 eC_6                 2.307156e-01 1 1  ON 26
 eC_7                 4.089979e-01 1 1  ON 27
 eC_8                 3.137804e-01 1 1  ON 28
 eC_9                 8.144610e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815014e-01 1 1  ON 31
 eO_2                -4.018440e-01 1 1  ON 32
 eO_3                -5.536645e-02 1 1  ON 33
 eO_4                 1.756757e-01 1 1  ON 34
 eO_5                 3.636771e-01 1 1  ON 35
 eO_6                 4.605379e-01 1 1  ON 36
 eO_7                 5.331956e-01 1 1  ON 37
 eO_8                 5.129034e-01 1 1  ON 38
 eO_9                 3.639202e-01 1 1  ON 39
eH1_0                -1.867271e-01 1 1  ON 40
eH1_1                -1.000025e-01 1 1  ON 41
eH1_2                -6.661127e-02 1 1  ON 42
eH1_3                -5.062995e-02 1 1  ON 43
eH1_4                 1.046718e-02 1 1  ON 44
eH1_5                 6.750979e-02 1 1  ON 45
eH1_6                 1.248634e-01 1 1  ON 46
eH1_7                 1.027506e-01 1 1  ON 47
eH1_8                 8.592592e-03 1 1  ON 48
eH1_9                -2.321526e-02 1 1  ON 49
eH2_0                -1.887052e-01 1 1  ON 50
eH2_1                -1.014455e-01 1 1  ON 51
eH2_2                -6.865314e-02 1 1  ON 52
eH2_3                -5.301019e-02 1 1  ON 53
eH2_4                 7.620190e-03 1 1  ON 54
eH2_5                 6.476637e-02 1 1  ON 55
eH2_6                 1.222914e-01 1 1  ON 56
eH2_7                 1.005865e-01 1 1  ON 57
eH2_8                 9.559094e-03 1 1  ON 58
eH2_9                -8.640615e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1540e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7866
    reference variance = 0.297433
====================================================
  Execution time = 7.8448e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0439e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6254e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504114477228
                                         uncertainty =       0.003845809691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504114477228
                                         uncertainty =       0.003845809691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502188255
  error estimate for blocks of size 2^( 2) =       0.000519952057
  error estimate for blocks of size 2^( 3) =       0.000535791860
  error estimate for blocks of size 2^( 4) =       0.000546495687
  error estimate for blocks of size 2^( 5) =       0.000554027206
  error estimate for blocks of size 2^( 6) =       0.000558149002
  error estimate for blocks of size 2^( 7) =       0.000561349095

      target function =                  N/A
              le_mean =     -22.825406832588
             les_mean =     521.503582908547
             stat err =       0.000555005247
             autocorr =       1.221408885320
              std dev =       0.710201441566
             le_variance =       0.504386087602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282540683259e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825406832588       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825406831371       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825406832916       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825406833993       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825406832813       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825406831956       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825406831818       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825406832653       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825406832810       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825406832835       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 5.435911e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825406832588       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825406832283       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825406832670       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825406832940       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825406832644       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825406832430       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825406832395       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825406832604       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825406832642       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825406832648       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 1.359797e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825406832588       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825406832511       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825406832608       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825406832676       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825406832604       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825406832550       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825406832540       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825406832609       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825406832605       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825406832608       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+03 is 3.400005e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0471e+02
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.654893e-01 1 1  ON 0
 uu_1                 9.171500e-02 1 1  ON 1
 uu_2                -1.976145e-02 1 1  ON 2
 uu_3                -8.528124e-02 1 1  ON 3
 uu_4                -1.232726e-01 1 1  ON 4
 uu_5                -1.465850e-01 1 1  ON 5
 uu_6                -1.600493e-01 1 1  ON 6
 uu_7                -1.633868e-01 1 1  ON 7
 uu_8                -1.534132e-01 1 1  ON 8
 uu_9                -1.270920e-01 1 1  ON 9
 ud_0                 4.368811e-01 1 1  ON 10
 ud_1                 1.544945e-01 1 1  ON 11
 ud_2                 8.759590e-03 1 1  ON 12
 ud_3                -7.124225e-02 1 1  ON 13
 ud_4                -1.185812e-01 1 1  ON 14
 ud_5                -1.486734e-01 1 1  ON 15
 ud_6                -1.670455e-01 1 1  ON 16
 ud_7                -1.741011e-01 1 1  ON 17
 ud_8                -1.666387e-01 1 1  ON 18
 ud_9                -1.429906e-01 1 1  ON 19
 eC_0                -5.742548e-01 1 1  ON 20
 eC_1                -4.192842e-01 1 1  ON 21
 eC_2                -1.694629e-01 1 1  ON 22
 eC_3                -2.220074e-02 1 1  ON 23
 eC_4                 2.712192e-02 1 1  ON 24
 eC_5                 1.130755e-01 1 1  ON 25
 eC_6                 2.307156e-01 1 1  ON 26
 eC_7                 4.089979e-01 1 1  ON 27
 eC_8                 3.137805e-01 1 1  ON 28
 eC_9                 8.144615e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815014e-01 1 1  ON 31
 eO_2                -4.018440e-01 1 1  ON 32
 eO_3                -5.536646e-02 1 1  ON 33
 eO_4                 1.756756e-01 1 1  ON 34
 eO_5                 3.636771e-01 1 1  ON 35
 eO_6                 4.605379e-01 1 1  ON 36
 eO_7                 5.331956e-01 1 1  ON 37
 eO_8                 5.129034e-01 1 1  ON 38
 eO_9                 3.639203e-01 1 1  ON 39
eH1_0                -1.867272e-01 1 1  ON 40
eH1_1                -1.000026e-01 1 1  ON 41
eH1_2                -6.661122e-02 1 1  ON 42
eH1_3                -5.063006e-02 1 1  ON 43
eH1_4                 1.046721e-02 1 1  ON 44
eH1_5                 6.750993e-02 1 1  ON 45
eH1_6                 1.248633e-01 1 1  ON 46
eH1_7                 1.027506e-01 1 1  ON 47
eH1_8                 8.592694e-03 1 1  ON 48
eH1_9                -2.321527e-02 1 1  ON 49
eH2_0                -1.887051e-01 1 1  ON 50
eH2_1                -1.014455e-01 1 1  ON 51
eH2_2                -6.865303e-02 1 1  ON 52
eH2_3                -5.301031e-02 1 1  ON 53
eH2_4                 7.620177e-03 1 1  ON 54
eH2_5                 6.476631e-02 1 1  ON 55
eH2_6                 1.222913e-01 1 1  ON 56
eH2_7                 1.005866e-01 1 1  ON 57
eH2_8                 9.559131e-03 1 1  ON 58
eH2_9                -8.640672e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7426
    reference variance = 0.258217
====================================================
  Execution time = 7.8958e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.3150e-01
  Total weights = 2.0000e+06
  Execution time = 6.3219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531671240179
                                         uncertainty =       0.014194759746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531671240179
                                         uncertainty =       0.014194759746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515509663
  error estimate for blocks of size 2^( 2) =       0.000533159463
  error estimate for blocks of size 2^( 3) =       0.000548581244
  error estimate for blocks of size 2^( 4) =       0.000559569255
  error estimate for blocks of size 2^( 5) =       0.000564191467
  error estimate for blocks of size 2^( 6) =       0.000568941369
  error estimate for blocks of size 2^( 7) =       0.000571443467

      target function =                  N/A
              le_mean =     -22.825533458961
             les_mean =     521.536477845361
             stat err =       0.000566036390
             autocorr =       1.205632881614
              std dev =       0.729040756714
             le_variance =       0.531500424950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531670803533
                                         uncertainty =       0.014194741621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531670803533
                                         uncertainty =       0.014194741621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515509451
  error estimate for blocks of size 2^( 2) =       0.000533159265
  error estimate for blocks of size 2^( 3) =       0.000548581060
  error estimate for blocks of size 2^( 4) =       0.000559569078
  error estimate for blocks of size 2^( 5) =       0.000564191282
  error estimate for blocks of size 2^( 6) =       0.000568941188
  error estimate for blocks of size 2^( 7) =       0.000571443294

      target function =                  N/A
              le_mean =     -22.825533468314
             les_mean =     521.536477835447
             stat err =       0.000566036210
             autocorr =       1.205633108743
              std dev =       0.729040457083
             le_variance =       0.531499988063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531671021568
                                         uncertainty =       0.014194750675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531671021568
                                         uncertainty =       0.014194750675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515509557
  error estimate for blocks of size 2^( 2) =       0.000533159364
  error estimate for blocks of size 2^( 3) =       0.000548581152
  error estimate for blocks of size 2^( 4) =       0.000559569166
  error estimate for blocks of size 2^( 5) =       0.000564191375
  error estimate for blocks of size 2^( 6) =       0.000568941279
  error estimate for blocks of size 2^( 7) =       0.000571443380

      target function =                  N/A
              le_mean =     -22.825533463643
             les_mean =     521.536477840359
             stat err =       0.000566036300
             autocorr =       1.205632995348
              std dev =       0.729040606700
             le_variance =       0.531500206218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531671212843
                                         uncertainty =       0.014194758612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531671212843
                                         uncertainty =       0.014194758612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515509650
  error estimate for blocks of size 2^( 2) =       0.000533159451
  error estimate for blocks of size 2^( 3) =       0.000548581232
  error estimate for blocks of size 2^( 4) =       0.000559569244
  error estimate for blocks of size 2^( 5) =       0.000564191456
  error estimate for blocks of size 2^( 6) =       0.000568941358
  error estimate for blocks of size 2^( 7) =       0.000571443456

      target function =                  N/A
              le_mean =     -22.825533459547
             les_mean =     521.536477844730
             stat err =       0.000566036378
             autocorr =       1.205632895834
              std dev =       0.729040737955
             le_variance =       0.531500397598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825533458961        initial
     2.4414e+02     2.4414e+03             5.4359e-07       -22.825533468314  <--
     9.7656e+02     9.7656e+03             1.3598e-07       -22.825533463643
     3.9062e+03     3.9062e+04             3.4000e-08       -22.825533459547

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 1.1056e+02
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.654897e-01 1 1  ON 0
 uu_1                 9.171495e-02 1 1  ON 1
 uu_2                -1.976155e-02 1 1  ON 2
 uu_3                -8.528111e-02 1 1  ON 3
 uu_4                -1.232727e-01 1 1  ON 4
 uu_5                -1.465849e-01 1 1  ON 5
 uu_6                -1.600495e-01 1 1  ON 6
 uu_7                -1.633871e-01 1 1  ON 7
 uu_8                -1.534132e-01 1 1  ON 8
 uu_9                -1.270917e-01 1 1  ON 9
 ud_0                 4.368811e-01 1 1  ON 10
 ud_1                 1.544945e-01 1 1  ON 11
 ud_2                 8.759745e-03 1 1  ON 12
 ud_3                -7.124229e-02 1 1  ON 13
 ud_4                -1.185810e-01 1 1  ON 14
 ud_5                -1.486732e-01 1 1  ON 15
 ud_6                -1.670455e-01 1 1  ON 16
 ud_7                -1.741013e-01 1 1  ON 17
 ud_8                -1.666384e-01 1 1  ON 18
 ud_9                -1.429904e-01 1 1  ON 19
 eC_0                -5.742549e-01 1 1  ON 20
 eC_1                -4.192842e-01 1 1  ON 21
 eC_2                -1.694631e-01 1 1  ON 22
 eC_3                -2.220047e-02 1 1  ON 23
 eC_4                 2.712162e-02 1 1  ON 24
 eC_5                 1.130754e-01 1 1  ON 25
 eC_6                 2.307156e-01 1 1  ON 26
 eC_7                 4.089978e-01 1 1  ON 27
 eC_8                 3.137808e-01 1 1  ON 28
 eC_9                 8.144630e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815016e-01 1 1  ON 31
 eO_2                -4.018441e-01 1 1  ON 32
 eO_3                -5.536649e-02 1 1  ON 33
 eO_4                 1.756754e-01 1 1  ON 34
 eO_5                 3.636772e-01 1 1  ON 35
 eO_6                 4.605379e-01 1 1  ON 36
 eO_7                 5.331956e-01 1 1  ON 37
 eO_8                 5.129034e-01 1 1  ON 38
 eO_9                 3.639205e-01 1 1  ON 39
eH1_0                -1.867275e-01 1 1  ON 40
eH1_1                -1.000028e-01 1 1  ON 41
eH1_2                -6.661108e-02 1 1  ON 42
eH1_3                -5.063041e-02 1 1  ON 43
eH1_4                 1.046729e-02 1 1  ON 44
eH1_5                 6.751033e-02 1 1  ON 45
eH1_6                 1.248632e-01 1 1  ON 46
eH1_7                 1.027506e-01 1 1  ON 47
eH1_8                 8.593000e-03 1 1  ON 48
eH1_9                -2.321531e-02 1 1  ON 49
eH2_0                -1.887049e-01 1 1  ON 50
eH2_1                -1.014455e-01 1 1  ON 51
eH2_2                -6.865268e-02 1 1  ON 52
eH2_3                -5.301065e-02 1 1  ON 53
eH2_4                 7.620136e-03 1 1  ON 54
eH2_5                 6.476613e-02 1 1  ON 55
eH2_6                 1.222912e-01 1 1  ON 56
eH2_7                 1.005867e-01 1 1  ON 57
eH2_8                 9.559243e-03 1 1  ON 58
eH2_9                -8.640842e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1528e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7825
    reference variance = 0.287433
====================================================
  Execution time = 7.8764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0223e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6828e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502047927477
                                         uncertainty =       0.003095524225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502047927477
                                         uncertainty =       0.003095524225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501112678
  error estimate for blocks of size 2^( 2) =       0.000519274798
  error estimate for blocks of size 2^( 3) =       0.000535627176
  error estimate for blocks of size 2^( 4) =       0.000546729349
  error estimate for blocks of size 2^( 5) =       0.000552046354
  error estimate for blocks of size 2^( 6) =       0.000557271635
  error estimate for blocks of size 2^( 7) =       0.000559852594

      target function =                  N/A
              le_mean =     -22.825723063963
             les_mean =     521.515860973014
             stat err =       0.000553974983
             autocorr =       1.222107827021
              std dev =       0.708680345002
             le_variance =       0.502227831392


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282572306396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825723063963       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825723069883       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825723079979       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825723086587       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825723090431       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825723083625       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825723089909       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825723093018       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825723094144       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825723095333       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 3.314316e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825723063963       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825723065446       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825723067976       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825723069639       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825723070614       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825723068896       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825723070455       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825723071242       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825723071526       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825723071825       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 8.309434e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825723063963       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825723064334       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825723064967       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825723065383       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825723065628       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825723065197       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825723065588       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825723065785       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825723065856       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825723065930       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 2.078841e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130142 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0560e+02
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.654894e-01 1 1  ON 0
 uu_1                 9.171526e-02 1 1  ON 1
 uu_2                -1.976144e-02 1 1  ON 2
 uu_3                -8.528121e-02 1 1  ON 3
 uu_4                -1.232728e-01 1 1  ON 4
 uu_5                -1.465841e-01 1 1  ON 5
 uu_6                -1.600493e-01 1 1  ON 6
 uu_7                -1.633868e-01 1 1  ON 7
 uu_8                -1.534136e-01 1 1  ON 8
 uu_9                -1.270918e-01 1 1  ON 9
 ud_0                 4.368816e-01 1 1  ON 10
 ud_1                 1.544948e-01 1 1  ON 11
 ud_2                 8.759993e-03 1 1  ON 12
 ud_3                -7.124246e-02 1 1  ON 13
 ud_4                -1.185807e-01 1 1  ON 14
 ud_5                -1.486733e-01 1 1  ON 15
 ud_6                -1.670450e-01 1 1  ON 16
 ud_7                -1.741015e-01 1 1  ON 17
 ud_8                -1.666386e-01 1 1  ON 18
 ud_9                -1.429905e-01 1 1  ON 19
 eC_0                -5.742548e-01 1 1  ON 20
 eC_1                -4.192843e-01 1 1  ON 21
 eC_2                -1.694630e-01 1 1  ON 22
 eC_3                -2.220048e-02 1 1  ON 23
 eC_4                 2.712080e-02 1 1  ON 24
 eC_5                 1.130755e-01 1 1  ON 25
 eC_6                 2.307159e-01 1 1  ON 26
 eC_7                 4.089976e-01 1 1  ON 27
 eC_8                 3.137810e-01 1 1  ON 28
 eC_9                 8.144647e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815022e-01 1 1  ON 31
 eO_2                -4.018433e-01 1 1  ON 32
 eO_3                -5.536610e-02 1 1  ON 33
 eO_4                 1.756752e-01 1 1  ON 34
 eO_5                 3.636772e-01 1 1  ON 35
 eO_6                 4.605378e-01 1 1  ON 36
 eO_7                 5.331955e-01 1 1  ON 37
 eO_8                 5.129033e-01 1 1  ON 38
 eO_9                 3.639207e-01 1 1  ON 39
eH1_0                -1.867276e-01 1 1  ON 40
eH1_1                -1.000026e-01 1 1  ON 41
eH1_2                -6.661127e-02 1 1  ON 42
eH1_3                -5.063034e-02 1 1  ON 43
eH1_4                 1.046711e-02 1 1  ON 44
eH1_5                 6.751024e-02 1 1  ON 45
eH1_6                 1.248632e-01 1 1  ON 46
eH1_7                 1.027507e-01 1 1  ON 47
eH1_8                 8.593247e-03 1 1  ON 48
eH1_9                -2.321547e-02 1 1  ON 49
eH2_0                -1.887052e-01 1 1  ON 50
eH2_1                -1.014457e-01 1 1  ON 51
eH2_2                -6.865330e-02 1 1  ON 52
eH2_3                -5.301087e-02 1 1  ON 53
eH2_4                 7.620891e-03 1 1  ON 54
eH2_5                 6.476611e-02 1 1  ON 55
eH2_6                 1.222912e-01 1 1  ON 56
eH2_7                 1.005869e-01 1 1  ON 57
eH2_8                 9.559574e-03 1 1  ON 58
eH2_9                -8.640972e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8576
    reference variance = 0.302345
====================================================
  Execution time = 7.7348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0854e-01
  Total weights = 2.0000e+06
  Execution time = 6.2655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508305448746
                                         uncertainty =       0.004962491021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508305448746
                                         uncertainty =       0.004962491021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504250813
  error estimate for blocks of size 2^( 2) =       0.000521943341
  error estimate for blocks of size 2^( 3) =       0.000538014275
  error estimate for blocks of size 2^( 4) =       0.000549198314
  error estimate for blocks of size 2^( 5) =       0.000554298388
  error estimate for blocks of size 2^( 6) =       0.000557239233
  error estimate for blocks of size 2^( 7) =       0.000562027444

      target function =                  N/A
              le_mean =     -22.826333791071
             les_mean =     521.550051852886
             stat err =       0.000555690845
             autocorr =       1.214432184730
              std dev =       0.713118339258
             le_variance =       0.508537765786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508307349821
                                         uncertainty =       0.004962526044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508307349821
                                         uncertainty =       0.004962526044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504251754
  error estimate for blocks of size 2^( 2) =       0.000521944223
  error estimate for blocks of size 2^( 3) =       0.000538015065
  error estimate for blocks of size 2^( 4) =       0.000549199060
  error estimate for blocks of size 2^( 5) =       0.000554299114
  error estimate for blocks of size 2^( 6) =       0.000557239929
  error estimate for blocks of size 2^( 7) =       0.000562028114

      target function =                  N/A
              le_mean =     -22.826333799970
             les_mean =     521.550054157115
             stat err =       0.000555691554
             autocorr =       1.214430753566
              std dev =       0.713119669996
             le_variance =       0.508539663735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508306400681
                                         uncertainty =       0.004962508682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508306400681
                                         uncertainty =       0.004962508682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504251285
  error estimate for blocks of size 2^( 2) =       0.000521943783
  error estimate for blocks of size 2^( 3) =       0.000538014671
  error estimate for blocks of size 2^( 4) =       0.000549198687
  error estimate for blocks of size 2^( 5) =       0.000554298751
  error estimate for blocks of size 2^( 6) =       0.000557239582
  error estimate for blocks of size 2^( 7) =       0.000562027780

      target function =                  N/A
              le_mean =     -22.826333795545
             les_mean =     521.550053007534
             stat err =       0.000555691200
             autocorr =       1.214431467921
              std dev =       0.713119005605
             le_variance =       0.508538716154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508305567769
                                         uncertainty =       0.004962493233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508305567769
                                         uncertainty =       0.004962493233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504250872
  error estimate for blocks of size 2^( 2) =       0.000521943397
  error estimate for blocks of size 2^( 3) =       0.000538014325
  error estimate for blocks of size 2^( 4) =       0.000549198361
  error estimate for blocks of size 2^( 5) =       0.000554298433
  error estimate for blocks of size 2^( 6) =       0.000557239276
  error estimate for blocks of size 2^( 7) =       0.000562027486

      target function =                  N/A
              le_mean =     -22.826333791629
             les_mean =     521.550051997206
             stat err =       0.000555690889
             autocorr =       1.214432095088
              std dev =       0.713118422573
             le_variance =       0.508537884613


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826333791071        initial
     6.1035e+01     6.1035e+02             3.3143e-06       -22.826333799970  <--
     2.4414e+02     2.4414e+03             8.3094e-07       -22.826333795545
     9.7656e+02     9.7656e+03             2.0788e-07       -22.826333791629

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 1.1254e+02
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.654888e-01 1 1  ON 0
 uu_1                 9.171620e-02 1 1  ON 1
 uu_2                -1.976110e-02 1 1  ON 2
 uu_3                -8.528149e-02 1 1  ON 3
 uu_4                -1.232728e-01 1 1  ON 4
 uu_5                -1.465817e-01 1 1  ON 5
 uu_6                -1.600487e-01 1 1  ON 6
 uu_7                -1.633861e-01 1 1  ON 7
 uu_8                -1.534148e-01 1 1  ON 8
 uu_9                -1.270923e-01 1 1  ON 9
 ud_0                 4.368833e-01 1 1  ON 10
 ud_1                 1.544956e-01 1 1  ON 11
 ud_2                 8.760732e-03 1 1  ON 12
 ud_3                -7.124295e-02 1 1  ON 13
 ud_4                -1.185796e-01 1 1  ON 14
 ud_5                -1.486739e-01 1 1  ON 15
 ud_6                -1.670433e-01 1 1  ON 16
 ud_7                -1.741023e-01 1 1  ON 17
 ud_8                -1.666393e-01 1 1  ON 18
 ud_9                -1.429908e-01 1 1  ON 19
 eC_0                -5.742546e-01 1 1  ON 20
 eC_1                -4.192845e-01 1 1  ON 21
 eC_2                -1.694627e-01 1 1  ON 22
 eC_3                -2.220053e-02 1 1  ON 23
 eC_4                 2.711835e-02 1 1  ON 24
 eC_5                 1.130760e-01 1 1  ON 25
 eC_6                 2.307168e-01 1 1  ON 26
 eC_7                 4.089971e-01 1 1  ON 27
 eC_8                 3.137819e-01 1 1  ON 28
 eC_9                 8.144697e-02 1 1  ON 29
 eO_0                -1.259697e+00 1 1  ON 30
 eO_1                -8.815038e-01 1 1  ON 31
 eO_2                -4.018408e-01 1 1  ON 32
 eO_3                -5.536492e-02 1 1  ON 33
 eO_4                 1.756747e-01 1 1  ON 34
 eO_5                 3.636772e-01 1 1  ON 35
 eO_6                 4.605376e-01 1 1  ON 36
 eO_7                 5.331953e-01 1 1  ON 37
 eO_8                 5.129027e-01 1 1  ON 38
 eO_9                 3.639214e-01 1 1  ON 39
eH1_0                -1.867278e-01 1 1  ON 40
eH1_1                -1.000019e-01 1 1  ON 41
eH1_2                -6.661185e-02 1 1  ON 42
eH1_3                -5.063013e-02 1 1  ON 43
eH1_4                 1.046657e-02 1 1  ON 44
eH1_5                 6.750996e-02 1 1  ON 45
eH1_6                 1.248632e-01 1 1  ON 46
eH1_7                 1.027508e-01 1 1  ON 47
eH1_8                 8.593987e-03 1 1  ON 48
eH1_9                -2.321596e-02 1 1  ON 49
eH2_0                -1.887058e-01 1 1  ON 50
eH2_1                -1.014461e-01 1 1  ON 51
eH2_2                -6.865516e-02 1 1  ON 52
eH2_3                -5.301150e-02 1 1  ON 53
eH2_4                 7.623144e-03 1 1  ON 54
eH2_5                 6.476606e-02 1 1  ON 55
eH2_6                 1.222911e-01 1 1  ON 56
eH2_7                 1.005874e-01 1 1  ON 57
eH2_8                 9.560566e-03 1 1  ON 58
eH2_9                -8.641364e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1814e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7941
    reference variance = 0.57592
====================================================
  Execution time = 7.8683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9730e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6291e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497208701802
                                         uncertainty =       0.002953454838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497208701802
                                         uncertainty =       0.002953454838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498646173
  error estimate for blocks of size 2^( 2) =       0.000516815034
  error estimate for blocks of size 2^( 3) =       0.000532459143
  error estimate for blocks of size 2^( 4) =       0.000543175452
  error estimate for blocks of size 2^( 5) =       0.000549749728
  error estimate for blocks of size 2^( 6) =       0.000551871747
  error estimate for blocks of size 2^( 7) =       0.000554448435

      target function =                  N/A
              le_mean =     -22.825978561032
             les_mean =     521.522593030869
             stat err =       0.000549811340
             autocorr =       1.215744761217
              std dev =       0.705192180065
             le_variance =       0.497296010825


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282597856103e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825978561032       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825978570778       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825978582385       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825978608418       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825978597634       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825978595549       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825978590060       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825978582289       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825978587081       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825978591894       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+01 is 9.454999e-06

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825978561032       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825978563490       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825978566432       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825978573084       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825978570378       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825978569809       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825978568465       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825978566589       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825978567719       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825978568967       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 2.405509e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825978561032       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825978561648       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825978562386       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825978564058       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825978563381       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825978563236       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825978562901       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825978562437       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825978562715       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825978563029       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 6.040494e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133827 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0498e+02
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.654912e-01 1 1  ON 0
 uu_1                 9.171432e-02 1 1  ON 1
 uu_2                -1.976097e-02 1 1  ON 2
 uu_3                -8.528184e-02 1 1  ON 3
 uu_4                -1.232739e-01 1 1  ON 4
 uu_5                -1.465810e-01 1 1  ON 5
 uu_6                -1.600469e-01 1 1  ON 6
 uu_7                -1.633856e-01 1 1  ON 7
 uu_8                -1.534145e-01 1 1  ON 8
 uu_9                -1.270921e-01 1 1  ON 9
 ud_0                 4.368817e-01 1 1  ON 10
 ud_1                 1.544969e-01 1 1  ON 11
 ud_2                 8.760867e-03 1 1  ON 12
 ud_3                -7.124079e-02 1 1  ON 13
 ud_4                -1.185790e-01 1 1  ON 14
 ud_5                -1.486727e-01 1 1  ON 15
 ud_6                -1.670450e-01 1 1  ON 16
 ud_7                -1.741024e-01 1 1  ON 17
 ud_8                -1.666387e-01 1 1  ON 18
 ud_9                -1.429902e-01 1 1  ON 19
 eC_0                -5.742526e-01 1 1  ON 20
 eC_1                -4.192855e-01 1 1  ON 21
 eC_2                -1.694622e-01 1 1  ON 22
 eC_3                -2.220166e-02 1 1  ON 23
 eC_4                 2.711700e-02 1 1  ON 24
 eC_5                 1.130750e-01 1 1  ON 25
 eC_6                 2.307175e-01 1 1  ON 26
 eC_7                 4.089967e-01 1 1  ON 27
 eC_8                 3.137831e-01 1 1  ON 28
 eC_9                 8.144746e-02 1 1  ON 29
 eO_0                -1.259697e+00 1 1  ON 30
 eO_1                -8.815037e-01 1 1  ON 31
 eO_2                -4.018423e-01 1 1  ON 32
 eO_3                -5.536589e-02 1 1  ON 33
 eO_4                 1.756767e-01 1 1  ON 34
 eO_5                 3.636761e-01 1 1  ON 35
 eO_6                 4.605371e-01 1 1  ON 36
 eO_7                 5.331947e-01 1 1  ON 37
 eO_8                 5.129024e-01 1 1  ON 38
 eO_9                 3.639228e-01 1 1  ON 39
eH1_0                -1.867285e-01 1 1  ON 40
eH1_1                -9.999985e-02 1 1  ON 41
eH1_2                -6.661244e-02 1 1  ON 42
eH1_3                -5.063031e-02 1 1  ON 43
eH1_4                 1.046590e-02 1 1  ON 44
eH1_5                 6.751145e-02 1 1  ON 45
eH1_6                 1.248620e-01 1 1  ON 46
eH1_7                 1.027503e-01 1 1  ON 47
eH1_8                 8.594902e-03 1 1  ON 48
eH1_9                -2.321667e-02 1 1  ON 49
eH2_0                -1.887059e-01 1 1  ON 50
eH2_1                -1.014469e-01 1 1  ON 51
eH2_2                -6.865596e-02 1 1  ON 52
eH2_3                -5.301214e-02 1 1  ON 53
eH2_4                 7.622998e-03 1 1  ON 54
eH2_5                 6.476729e-02 1 1  ON 55
eH2_6                 1.222912e-01 1 1  ON 56
eH2_7                 1.005886e-01 1 1  ON 57
eH2_8                 9.561611e-03 1 1  ON 58
eH2_9                -8.642647e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8553
    reference variance = 1.03171
====================================================
  Execution time = 7.6469e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0369e-01
  Total weights = 2.0000e+06
  Execution time = 6.2940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502901722949
                                         uncertainty =       0.003272639522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502901722949
                                         uncertainty =       0.003272639522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501841788
  error estimate for blocks of size 2^( 2) =       0.000519737087
  error estimate for blocks of size 2^( 3) =       0.000536285511
  error estimate for blocks of size 2^( 4) =       0.000546447968
  error estimate for blocks of size 2^( 5) =       0.000552309940
  error estimate for blocks of size 2^( 6) =       0.000556776710
  error estimate for blocks of size 2^( 7) =       0.000560446545

      target function =                  N/A
              le_mean =     -22.825217613987
             les_mean =     521.494249234909
             stat err =       0.000553995290
             autocorr =       1.218648621092
              std dev =       0.709711463136
             le_variance =       0.503690360906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502892251963
                                         uncertainty =       0.003272617160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502892251963
                                         uncertainty =       0.003272617160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501837023
  error estimate for blocks of size 2^( 2) =       0.000519732683
  error estimate for blocks of size 2^( 3) =       0.000536281298
  error estimate for blocks of size 2^( 4) =       0.000546444144
  error estimate for blocks of size 2^( 5) =       0.000552306495
  error estimate for blocks of size 2^( 6) =       0.000556773325
  error estimate for blocks of size 2^( 7) =       0.000560443169

      target function =                  N/A
              le_mean =     -22.825217626630
             les_mean =     521.494240247014
             stat err =       0.000553991783
             autocorr =       1.218656332666
              std dev =       0.709704724413
             le_variance =       0.503680795854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502896883549
                                         uncertainty =       0.003272628489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502896883549
                                         uncertainty =       0.003272628489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501839354
  error estimate for blocks of size 2^( 2) =       0.000519734836
  error estimate for blocks of size 2^( 3) =       0.000536283358
  error estimate for blocks of size 2^( 4) =       0.000546446012
  error estimate for blocks of size 2^( 5) =       0.000552308177
  error estimate for blocks of size 2^( 6) =       0.000556774977
  error estimate for blocks of size 2^( 7) =       0.000560444815

      target function =                  N/A
              le_mean =     -22.825217620262
             les_mean =     521.494244633935
             stat err =       0.000553993495
             autocorr =       1.218652548440
              std dev =       0.709708019863
             le_variance =       0.503685473457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502901114514
                                         uncertainty =       0.003272638148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502901114514
                                         uncertainty =       0.003272638148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501841482
  error estimate for blocks of size 2^( 2) =       0.000519736804
  error estimate for blocks of size 2^( 3) =       0.000536285241
  error estimate for blocks of size 2^( 4) =       0.000546447722
  error estimate for blocks of size 2^( 5) =       0.000552309718
  error estimate for blocks of size 2^( 6) =       0.000556776492
  error estimate for blocks of size 2^( 7) =       0.000560446327

      target function =                  N/A
              le_mean =     -22.825217614751
             les_mean =     521.494248655311
             stat err =       0.000553995065
             autocorr =       1.218649114309
              std dev =       0.709711030231
             le_variance =       0.503689746431


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825217613987        initial
     1.5259e+01     1.5259e+02             9.4550e-06       -22.825217626630  <--
     6.1035e+01     6.1035e+02             2.4055e-06       -22.825217620262
     2.4414e+02     2.4414e+03             6.0405e-07       -22.825217614751

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 1.0803e+02
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.654982e-01 1 1  ON 0
 uu_1                 9.170884e-02 1 1  ON 1
 uu_2                -1.976064e-02 1 1  ON 2
 uu_3                -8.528289e-02 1 1  ON 3
 uu_4                -1.232773e-01 1 1  ON 4
 uu_5                -1.465790e-01 1 1  ON 5
 uu_6                -1.600414e-01 1 1  ON 6
 uu_7                -1.633840e-01 1 1  ON 7
 uu_8                -1.534136e-01 1 1  ON 8
 uu_9                -1.270915e-01 1 1  ON 9
 ud_0                 4.368773e-01 1 1  ON 10
 ud_1                 1.545007e-01 1 1  ON 11
 ud_2                 8.761366e-03 1 1  ON 12
 ud_3                -7.123448e-02 1 1  ON 13
 ud_4                -1.185772e-01 1 1  ON 14
 ud_5                -1.486691e-01 1 1  ON 15
 ud_6                -1.670499e-01 1 1  ON 16
 ud_7                -1.741027e-01 1 1  ON 17
 ud_8                -1.666367e-01 1 1  ON 18
 ud_9                -1.429885e-01 1 1  ON 19
 eC_0                -5.742469e-01 1 1  ON 20
 eC_1                -4.192883e-01 1 1  ON 21
 eC_2                -1.694606e-01 1 1  ON 22
 eC_3                -2.220506e-02 1 1  ON 23
 eC_4                 2.711299e-02 1 1  ON 24
 eC_5                 1.130719e-01 1 1  ON 25
 eC_6                 2.307195e-01 1 1  ON 26
 eC_7                 4.089956e-01 1 1  ON 27
 eC_8                 3.137866e-01 1 1  ON 28
 eC_9                 8.144892e-02 1 1  ON 29
 eO_0                -1.259696e+00 1 1  ON 30
 eO_1                -8.815037e-01 1 1  ON 31
 eO_2                -4.018469e-01 1 1  ON 32
 eO_3                -5.536877e-02 1 1  ON 33
 eO_4                 1.756824e-01 1 1  ON 34
 eO_5                 3.636728e-01 1 1  ON 35
 eO_6                 4.605355e-01 1 1  ON 36
 eO_7                 5.331929e-01 1 1  ON 37
 eO_8                 5.129013e-01 1 1  ON 38
 eO_9                 3.639271e-01 1 1  ON 39
eH1_0                -1.867304e-01 1 1  ON 40
eH1_1                -9.999361e-02 1 1  ON 41
eH1_2                -6.661420e-02 1 1  ON 42
eH1_3                -5.063084e-02 1 1  ON 43
eH1_4                 1.046395e-02 1 1  ON 44
eH1_5                 6.751587e-02 1 1  ON 45
eH1_6                 1.248582e-01 1 1  ON 46
eH1_7                 1.027490e-01 1 1  ON 47
eH1_8                 8.597633e-03 1 1  ON 48
eH1_9                -2.321879e-02 1 1  ON 49
eH2_0                -1.887063e-01 1 1  ON 50
eH2_1                -1.014492e-01 1 1  ON 51
eH2_2                -6.865835e-02 1 1  ON 52
eH2_3                -5.301406e-02 1 1  ON 53
eH2_4                 7.622556e-03 1 1  ON 54
eH2_5                 6.477095e-02 1 1  ON 55
eH2_6                 1.222918e-01 1 1  ON 56
eH2_7                 1.005921e-01 1 1  ON 57
eH2_8                 9.564735e-03 1 1  ON 58
eH2_9                -8.646479e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1302e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7665
    reference variance = 0.353249
====================================================
  Execution time = 7.7927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0326e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6549e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503367475031
                                         uncertainty =       0.003020242822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503367475031
                                         uncertainty =       0.003020242822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501629598
  error estimate for blocks of size 2^( 2) =       0.000519771881
  error estimate for blocks of size 2^( 3) =       0.000535020532
  error estimate for blocks of size 2^( 4) =       0.000546724260
  error estimate for blocks of size 2^( 5) =       0.000553439107
  error estimate for blocks of size 2^( 6) =       0.000557062067
  error estimate for blocks of size 2^( 7) =       0.000561482247

      target function =                  N/A
              le_mean =     -22.825728270442
             les_mean =     521.517135331806
             stat err =       0.000554676920
             autocorr =       1.222683027189
              std dev =       0.709411380922
             le_variance =       0.503264507381


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282572827044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825728270442       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825728373790       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825728324483       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825728326924       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825728275386       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825728294163       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825728205389       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825728281667       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825728285613       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825728311136       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+00 is 5.380364e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825728270442       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825728297059       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825728284732       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825728285765       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825728272901       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825728278266       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825728252607       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825728270020       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825728271254       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825728277693       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+01 is 1.389757e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825728270442       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825728277147       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825728274067       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825728274357       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825728271148       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825728272543       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825728265897       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825728270127       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825728270443       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825728272054       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 3.504010e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137519 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0449e+02
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.655027e-01 1 1  ON 0
 uu_1                 9.171439e-02 1 1  ON 1
 uu_2                -1.976253e-02 1 1  ON 2
 uu_3                -8.528568e-02 1 1  ON 3
 uu_4                -1.232794e-01 1 1  ON 4
 uu_5                -1.465741e-01 1 1  ON 5
 uu_6                -1.600395e-01 1 1  ON 6
 uu_7                -1.633827e-01 1 1  ON 7
 uu_8                -1.534167e-01 1 1  ON 8
 uu_9                -1.270894e-01 1 1  ON 9
 ud_0                 4.368734e-01 1 1  ON 10
 ud_1                 1.545059e-01 1 1  ON 11
 ud_2                 8.767788e-03 1 1  ON 12
 ud_3                -7.122989e-02 1 1  ON 13
 ud_4                -1.185701e-01 1 1  ON 14
 ud_5                -1.486692e-01 1 1  ON 15
 ud_6                -1.670456e-01 1 1  ON 16
 ud_7                -1.740969e-01 1 1  ON 17
 ud_8                -1.666405e-01 1 1  ON 18
 ud_9                -1.429944e-01 1 1  ON 19
 eC_0                -5.742461e-01 1 1  ON 20
 eC_1                -4.192824e-01 1 1  ON 21
 eC_2                -1.694636e-01 1 1  ON 22
 eC_3                -2.220604e-02 1 1  ON 23
 eC_4                 2.710300e-02 1 1  ON 24
 eC_5                 1.130720e-01 1 1  ON 25
 eC_6                 2.307220e-01 1 1  ON 26
 eC_7                 4.089913e-01 1 1  ON 27
 eC_8                 3.137922e-01 1 1  ON 28
 eC_9                 8.145210e-02 1 1  ON 29
 eO_0                -1.259710e+00 1 1  ON 30
 eO_1                -8.815036e-01 1 1  ON 31
 eO_2                -4.018401e-01 1 1  ON 32
 eO_3                -5.536145e-02 1 1  ON 33
 eO_4                 1.756809e-01 1 1  ON 34
 eO_5                 3.636743e-01 1 1  ON 35
 eO_6                 4.605335e-01 1 1  ON 36
 eO_7                 5.331907e-01 1 1  ON 37
 eO_8                 5.128982e-01 1 1  ON 38
 eO_9                 3.639298e-01 1 1  ON 39
eH1_0                -1.867312e-01 1 1  ON 40
eH1_1                -9.998661e-02 1 1  ON 41
eH1_2                -6.661764e-02 1 1  ON 42
eH1_3                -5.063126e-02 1 1  ON 43
eH1_4                 1.046460e-02 1 1  ON 44
eH1_5                 6.751856e-02 1 1  ON 45
eH1_6                 1.248524e-01 1 1  ON 46
eH1_7                 1.027473e-01 1 1  ON 47
eH1_8                 8.600143e-03 1 1  ON 48
eH1_9                -2.322126e-02 1 1  ON 49
eH2_0                -1.887114e-01 1 1  ON 50
eH2_1                -1.014483e-01 1 1  ON 51
eH2_2                -6.865739e-02 1 1  ON 52
eH2_3                -5.302313e-02 1 1  ON 53
eH2_4                 7.626180e-03 1 1  ON 54
eH2_5                 6.476332e-02 1 1  ON 55
eH2_6                 1.222953e-01 1 1  ON 56
eH2_7                 1.005985e-01 1 1  ON 57
eH2_8                 9.570188e-03 1 1  ON 58
eH2_9                -8.648191e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8158
    reference variance = 0.260541
====================================================
  Execution time = 7.7458e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0922e-01
  Total weights = 2.0000e+06
  Execution time = 6.2730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509287388367
                                         uncertainty =       0.005899930888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509287388367
                                         uncertainty =       0.005899930888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504593086
  error estimate for blocks of size 2^( 2) =       0.000522239854
  error estimate for blocks of size 2^( 3) =       0.000538227258
  error estimate for blocks of size 2^( 4) =       0.000548205717
  error estimate for blocks of size 2^( 5) =       0.000554228373
  error estimate for blocks of size 2^( 6) =       0.000557665175
  error estimate for blocks of size 2^( 7) =       0.000563349183

      target function =                  N/A
              le_mean =     -22.825636294400
             les_mean =     521.518900355158
             stat err =       0.000555862112
             autocorr =       1.213532899432
              std dev =       0.713602386172
             le_variance =       0.509228365550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509267247272
                                         uncertainty =       0.005900009952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509267247272
                                         uncertainty =       0.005900009952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504583130
  error estimate for blocks of size 2^( 2) =       0.000522230361
  error estimate for blocks of size 2^( 3) =       0.000538218321
  error estimate for blocks of size 2^( 4) =       0.000548197148
  error estimate for blocks of size 2^( 5) =       0.000554220203
  error estimate for blocks of size 2^( 6) =       0.000557656545
  error estimate for blocks of size 2^( 7) =       0.000563341627

      target function =                  N/A
              le_mean =     -22.825636088380
             les_mean =     521.518870854381
             stat err =       0.000555853881
             autocorr =       1.213544850367
              std dev =       0.713588305550
             le_variance =       0.509208269818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509275474971
                                         uncertainty =       0.005899959724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509275474971
                                         uncertainty =       0.005899959724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504587196
  error estimate for blocks of size 2^( 2) =       0.000522234244
  error estimate for blocks of size 2^( 3) =       0.000538221962
  error estimate for blocks of size 2^( 4) =       0.000548200632
  error estimate for blocks of size 2^( 5) =       0.000554223503
  error estimate for blocks of size 2^( 6) =       0.000557660056
  error estimate for blocks of size 2^( 7) =       0.000563344610

      target function =                  N/A
              le_mean =     -22.825636180765
             les_mean =     521.518883278332
             stat err =       0.000555857200
             autocorr =       1.213539787283
              std dev =       0.713594055669
             le_variance =       0.509216476286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509285833578
                                         uncertainty =       0.005899934111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509285833578
                                         uncertainty =       0.005899934111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504592318
  error estimate for blocks of size 2^( 2) =       0.000522239122
  error estimate for blocks of size 2^( 3) =       0.000538226566
  error estimate for blocks of size 2^( 4) =       0.000548205052
  error estimate for blocks of size 2^( 5) =       0.000554227736
  error estimate for blocks of size 2^( 6) =       0.000557664506
  error estimate for blocks of size 2^( 7) =       0.000563348583

      target function =                  N/A
              le_mean =     -22.825636279558
             les_mean =     521.518898125866
             stat err =       0.000555861469
             autocorr =       1.213533791139
              std dev =       0.713601298925
             le_variance =       0.509226813827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825636294400        initial  <--
     3.8147e+00     3.8147e+01             5.3804e-05       -22.825636088380
     1.5259e+01     1.5259e+02             1.3898e-05       -22.825636180765
     6.1035e+01     6.1035e+02             3.5040e-06       -22.825636279558

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 108.9186
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.654982e-01 1 1  ON 0
 uu_1                 9.170884e-02 1 1  ON 1
 uu_2                -1.976064e-02 1 1  ON 2
 uu_3                -8.528289e-02 1 1  ON 3
 uu_4                -1.232773e-01 1 1  ON 4
 uu_5                -1.465790e-01 1 1  ON 5
 uu_6                -1.600414e-01 1 1  ON 6
 uu_7                -1.633840e-01 1 1  ON 7
 uu_8                -1.534136e-01 1 1  ON 8
 uu_9                -1.270915e-01 1 1  ON 9
 ud_0                 4.368773e-01 1 1  ON 10
 ud_1                 1.545007e-01 1 1  ON 11
 ud_2                 8.761366e-03 1 1  ON 12
 ud_3                -7.123448e-02 1 1  ON 13
 ud_4                -1.185772e-01 1 1  ON 14
 ud_5                -1.486691e-01 1 1  ON 15
 ud_6                -1.670499e-01 1 1  ON 16
 ud_7                -1.741027e-01 1 1  ON 17
 ud_8                -1.666367e-01 1 1  ON 18
 ud_9                -1.429885e-01 1 1  ON 19
 eC_0                -5.742469e-01 1 1  ON 20
 eC_1                -4.192883e-01 1 1  ON 21
 eC_2                -1.694606e-01 1 1  ON 22
 eC_3                -2.220506e-02 1 1  ON 23
 eC_4                 2.711299e-02 1 1  ON 24
 eC_5                 1.130719e-01 1 1  ON 25
 eC_6                 2.307195e-01 1 1  ON 26
 eC_7                 4.089956e-01 1 1  ON 27
 eC_8                 3.137866e-01 1 1  ON 28
 eC_9                 8.144892e-02 1 1  ON 29
 eO_0                -1.259696e+00 1 1  ON 30
 eO_1                -8.815037e-01 1 1  ON 31
 eO_2                -4.018469e-01 1 1  ON 32
 eO_3                -5.536877e-02 1 1  ON 33
 eO_4                 1.756824e-01 1 1  ON 34
 eO_5                 3.636728e-01 1 1  ON 35
 eO_6                 4.605355e-01 1 1  ON 36
 eO_7                 5.331929e-01 1 1  ON 37
 eO_8                 5.129013e-01 1 1  ON 38
 eO_9                 3.639271e-01 1 1  ON 39
eH1_0                -1.867304e-01 1 1  ON 40
eH1_1                -9.999361e-02 1 1  ON 41
eH1_2                -6.661420e-02 1 1  ON 42
eH1_3                -5.063084e-02 1 1  ON 43
eH1_4                 1.046395e-02 1 1  ON 44
eH1_5                 6.751587e-02 1 1  ON 45
eH1_6                 1.248582e-01 1 1  ON 46
eH1_7                 1.027490e-01 1 1  ON 47
eH1_8                 8.597633e-03 1 1  ON 48
eH1_9                -2.321879e-02 1 1  ON 49
eH2_0                -1.887063e-01 1 1  ON 50
eH2_1                -1.014492e-01 1 1  ON 51
eH2_2                -6.865835e-02 1 1  ON 52
eH2_3                -5.301406e-02 1 1  ON 53
eH2_4                 7.622556e-03 1 1  ON 54
eH2_5                 6.477095e-02 1 1  ON 55
eH2_6                 1.222918e-01 1 1  ON 56
eH2_7                 1.005921e-01 1 1  ON 57
eH2_8                 9.564735e-03 1 1  ON 58
eH2_9                -8.646479e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1341e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.9354
    reference variance = 0.296233
====================================================
  Execution time = 7.7697e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.2028e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6255e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520263736830
                                         uncertainty =       0.010017939124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520263736830
                                         uncertainty =       0.010017939124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510038497
  error estimate for blocks of size 2^( 2) =       0.000527430599
  error estimate for blocks of size 2^( 3) =       0.000542387053
  error estimate for blocks of size 2^( 4) =       0.000553790756
  error estimate for blocks of size 2^( 5) =       0.000559271308
  error estimate for blocks of size 2^( 6) =       0.000563641154
  error estimate for blocks of size 2^( 7) =       0.000564073352

      target function =                  N/A
              le_mean =     -22.826001728983
             les_mean =     521.546633207760
             stat err =       0.000560194142
             autocorr =       1.206344122205
              std dev =       0.721303359466
             le_variance =       0.520278536377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282600172898e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826001728983       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826001732046       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826001722671       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826001699373       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826001681663       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826001684073       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826001687727       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826001682682       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826001688024       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826001685260       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+01 is 4.848589e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826001728983       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826001729753       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826001727398       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826001721538       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826001717046       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826001717655       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826001718566       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826001717312       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826001718634       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826001717952       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.215424e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826001728983       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826001729176       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826001728586       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826001727119       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826001725992       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826001726144       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826001726371       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826001726060       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826001726388       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826001726219       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 3.040620e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0396e+02
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.654980e-01 1 1  ON 0
 uu_1                 9.170812e-02 1 1  ON 1
 uu_2                -1.975978e-02 1 1  ON 2
 uu_3                -8.528346e-02 1 1  ON 3
 uu_4                -1.232773e-01 1 1  ON 4
 uu_5                -1.465784e-01 1 1  ON 5
 uu_6                -1.600410e-01 1 1  ON 6
 uu_7                -1.633836e-01 1 1  ON 7
 uu_8                -1.534142e-01 1 1  ON 8
 uu_9                -1.270913e-01 1 1  ON 9
 ud_0                 4.368763e-01 1 1  ON 10
 ud_1                 1.545011e-01 1 1  ON 11
 ud_2                 8.762061e-03 1 1  ON 12
 ud_3                -7.123371e-02 1 1  ON 13
 ud_4                -1.185770e-01 1 1  ON 14
 ud_5                -1.486691e-01 1 1  ON 15
 ud_6                -1.670500e-01 1 1  ON 16
 ud_7                -1.741031e-01 1 1  ON 17
 ud_8                -1.666360e-01 1 1  ON 18
 ud_9                -1.429883e-01 1 1  ON 19
 eC_0                -5.742461e-01 1 1  ON 20
 eC_1                -4.192890e-01 1 1  ON 21
 eC_2                -1.694610e-01 1 1  ON 22
 eC_3                -2.220477e-02 1 1  ON 23
 eC_4                 2.711250e-02 1 1  ON 24
 eC_5                 1.130713e-01 1 1  ON 25
 eC_6                 2.307200e-01 1 1  ON 26
 eC_7                 4.089955e-01 1 1  ON 27
 eC_8                 3.137871e-01 1 1  ON 28
 eC_9                 8.144919e-02 1 1  ON 29
 eO_0                -1.259696e+00 1 1  ON 30
 eO_1                -8.815042e-01 1 1  ON 31
 eO_2                -4.018478e-01 1 1  ON 32
 eO_3                -5.536856e-02 1 1  ON 33
 eO_4                 1.756819e-01 1 1  ON 34
 eO_5                 3.636740e-01 1 1  ON 35
 eO_6                 4.605350e-01 1 1  ON 36
 eO_7                 5.331926e-01 1 1  ON 37
 eO_8                 5.129013e-01 1 1  ON 38
 eO_9                 3.639277e-01 1 1  ON 39
eH1_0                -1.867309e-01 1 1  ON 40
eH1_1                -9.999326e-02 1 1  ON 41
eH1_2                -6.661504e-02 1 1  ON 42
eH1_3                -5.063019e-02 1 1  ON 43
eH1_4                 1.046383e-02 1 1  ON 44
eH1_5                 6.751645e-02 1 1  ON 45
eH1_6                 1.248580e-01 1 1  ON 46
eH1_7                 1.027486e-01 1 1  ON 47
eH1_8                 8.598165e-03 1 1  ON 48
eH1_9                -2.321893e-02 1 1  ON 49
eH2_0                -1.887069e-01 1 1  ON 50
eH2_1                -1.014492e-01 1 1  ON 51
eH2_2                -6.865786e-02 1 1  ON 52
eH2_3                -5.301476e-02 1 1  ON 53
eH2_4                 7.623087e-03 1 1  ON 54
eH2_5                 6.477073e-02 1 1  ON 55
eH2_6                 1.222921e-01 1 1  ON 56
eH2_7                 1.005924e-01 1 1  ON 57
eH2_8                 9.565096e-03 1 1  ON 58
eH2_9                -8.646936e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8101
    reference variance = 0.404104
====================================================
  Execution time = 7.9541e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0306e-01
  Total weights = 2.0000e+06
  Execution time = 6.2464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503141071609
                                         uncertainty =       0.003062983440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503141071609
                                         uncertainty =       0.003062983440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501526926
  error estimate for blocks of size 2^( 2) =       0.000519529892
  error estimate for blocks of size 2^( 3) =       0.000535742891
  error estimate for blocks of size 2^( 4) =       0.000546181314
  error estimate for blocks of size 2^( 5) =       0.000553012640
  error estimate for blocks of size 2^( 6) =       0.000556912279
  error estimate for blocks of size 2^( 7) =       0.000558129419

      target function =                  N/A
              le_mean =     -22.824914916472
             les_mean =     521.479799208558
             stat err =       0.000553558913
             autocorr =       1.218257758985
              std dev =       0.709266181284
             le_variance =       0.503058515913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503130094467
                                         uncertainty =       0.003062886180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503130094467
                                         uncertainty =       0.003062886180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501521454
  error estimate for blocks of size 2^( 2) =       0.000519524768
  error estimate for blocks of size 2^( 3) =       0.000535738043
  error estimate for blocks of size 2^( 4) =       0.000546176558
  error estimate for blocks of size 2^( 5) =       0.000553008089
  error estimate for blocks of size 2^( 6) =       0.000556907647
  error estimate for blocks of size 2^( 7) =       0.000558124803

      target function =                  N/A
              le_mean =     -22.824914960534
             les_mean =     521.479790242492
             stat err =       0.000553554274
             autocorr =       1.218263925716
              std dev =       0.709258442595
             le_variance =       0.503047538392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503135533516
                                         uncertainty =       0.003062934301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503135533516
                                         uncertainty =       0.003062934301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501524166
  error estimate for blocks of size 2^( 2) =       0.000519527307
  error estimate for blocks of size 2^( 3) =       0.000535740445
  error estimate for blocks of size 2^( 4) =       0.000546178914
  error estimate for blocks of size 2^( 5) =       0.000553010344
  error estimate for blocks of size 2^( 6) =       0.000556909941
  error estimate for blocks of size 2^( 7) =       0.000558127089

      target function =                  N/A
              le_mean =     -22.824914938739
             les_mean =     521.479794686764
             stat err =       0.000553556572
             autocorr =       1.218260867557
              std dev =       0.709262277034
             le_variance =       0.503052977624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503140377733
                                         uncertainty =       0.003062977281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503140377733
                                         uncertainty =       0.003062977281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501526581
  error estimate for blocks of size 2^( 2) =       0.000519529569
  error estimate for blocks of size 2^( 3) =       0.000535742585
  error estimate for blocks of size 2^( 4) =       0.000546181013
  error estimate for blocks of size 2^( 5) =       0.000553012352
  error estimate for blocks of size 2^( 6) =       0.000556911986
  error estimate for blocks of size 2^( 7) =       0.000558129127

      target function =                  N/A
              le_mean =     -22.824914919257
             les_mean =     521.479798641799
             stat err =       0.000553558620
             autocorr =       1.218258148353
              std dev =       0.709265692115
             le_variance =       0.503057822012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824914916472        initial
     3.8147e+01     3.8147e+02             4.8486e-06       -22.824914960534  <--
     1.5259e+02     1.5259e+03             1.2154e-06       -22.824914938739
     6.1035e+02     6.1035e+03             3.0406e-07       -22.824914919257

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 1.1087e+02
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170601e-02 1 1  ON 1
 uu_2                -1.975724e-02 1 1  ON 2
 uu_3                -8.528513e-02 1 1  ON 3
 uu_4                -1.232771e-01 1 1  ON 4
 uu_5                -1.465768e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368734e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764134e-03 1 1  ON 12
 ud_3                -7.123141e-02 1 1  ON 13
 ud_4                -1.185762e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666341e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742437e-01 1 1  ON 20
 eC_1                -4.192910e-01 1 1  ON 21
 eC_2                -1.694623e-01 1 1  ON 22
 eC_3                -2.220391e-02 1 1  ON 23
 eC_4                 2.711107e-02 1 1  ON 24
 eC_5                 1.130695e-01 1 1  ON 25
 eC_6                 2.307214e-01 1 1  ON 26
 eC_7                 4.089952e-01 1 1  ON 27
 eC_8                 3.137884e-01 1 1  ON 28
 eC_9                 8.144998e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815055e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536796e-02 1 1  ON 33
 eO_4                 1.756804e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605335e-01 1 1  ON 36
 eO_7                 5.331915e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867326e-01 1 1  ON 40
eH1_1                -9.999220e-02 1 1  ON 41
eH1_2                -6.661752e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046350e-02 1 1  ON 44
eH1_5                 6.751819e-02 1 1  ON 45
eH1_6                 1.248574e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599759e-03 1 1  ON 48
eH1_9                -2.321936e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865638e-02 1 1  ON 52
eH2_3                -5.301685e-02 1 1  ON 53
eH2_4                 7.624664e-03 1 1  ON 54
eH2_5                 6.477006e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005930e-01 1 1  ON 57
eH2_8                 9.566179e-03 1 1  ON 58
eH2_9                -8.648305e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1484e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.733
    reference variance = 0.392734
====================================================
  Execution time = 7.8081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0919e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6602e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509336828532
                                         uncertainty =       0.006984792658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509336828532
                                         uncertainty =       0.006984792658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504573833
  error estimate for blocks of size 2^( 2) =       0.000522102220
  error estimate for blocks of size 2^( 3) =       0.000537413439
  error estimate for blocks of size 2^( 4) =       0.000548725329
  error estimate for blocks of size 2^( 5) =       0.000554812554
  error estimate for blocks of size 2^( 6) =       0.000557366336
  error estimate for blocks of size 2^( 7) =       0.000556304361

      target function =                  N/A
              le_mean =     -22.824980669328
             les_mean =     521.488931805558
             stat err =       0.000554302145
             autocorr =       1.206823255431
              std dev =       0.713575157192
             le_variance =       0.509189504961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282498066933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824980669328       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824980717206       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824980678177       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824980782329       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824980816635       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824980829625       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824980824632       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824980776733       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824980772973       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824980779080       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+00 is 2.414500e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824980669328       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824980681464       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824980671468       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824980697858       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824980706443       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824980709872       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824980709067       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824980696837       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824980695723       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824980697138       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+01 is 6.109881e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824980669328       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824980672372       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824980669858       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824980676478       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824980678624       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824980679493       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824980679322       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824980676248       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824980675959       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824980676305       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.532130e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144827 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0469e+02
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.654999e-01 1 1  ON 0
 uu_1                 9.170595e-02 1 1  ON 1
 uu_2                -1.975495e-02 1 1  ON 2
 uu_3                -8.528594e-02 1 1  ON 3
 uu_4                -1.232785e-01 1 1  ON 4
 uu_5                -1.465775e-01 1 1  ON 5
 uu_6                -1.600437e-01 1 1  ON 6
 uu_7                -1.633795e-01 1 1  ON 7
 uu_8                -1.534143e-01 1 1  ON 8
 uu_9                -1.270908e-01 1 1  ON 9
 ud_0                 4.368719e-01 1 1  ON 10
 ud_1                 1.545017e-01 1 1  ON 11
 ud_2                 8.762787e-03 1 1  ON 12
 ud_3                -7.123271e-02 1 1  ON 13
 ud_4                -1.185751e-01 1 1  ON 14
 ud_5                -1.486662e-01 1 1  ON 15
 ud_6                -1.670496e-01 1 1  ON 16
 ud_7                -1.741038e-01 1 1  ON 17
 ud_8                -1.666319e-01 1 1  ON 18
 ud_9                -1.429868e-01 1 1  ON 19
 eC_0                -5.742376e-01 1 1  ON 20
 eC_1                -4.192933e-01 1 1  ON 21
 eC_2                -1.694637e-01 1 1  ON 22
 eC_3                -2.220575e-02 1 1  ON 23
 eC_4                 2.710735e-02 1 1  ON 24
 eC_5                 1.130695e-01 1 1  ON 25
 eC_6                 2.307218e-01 1 1  ON 26
 eC_7                 4.089940e-01 1 1  ON 27
 eC_8                 3.137906e-01 1 1  ON 28
 eC_9                 8.145142e-02 1 1  ON 29
 eO_0                -1.259699e+00 1 1  ON 30
 eO_1                -8.815089e-01 1 1  ON 31
 eO_2                -4.018458e-01 1 1  ON 32
 eO_3                -5.536941e-02 1 1  ON 33
 eO_4                 1.756801e-01 1 1  ON 34
 eO_5                 3.636787e-01 1 1  ON 35
 eO_6                 4.605307e-01 1 1  ON 36
 eO_7                 5.331932e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639313e-01 1 1  ON 39
eH1_0                -1.867330e-01 1 1  ON 40
eH1_1                -9.998965e-02 1 1  ON 41
eH1_2                -6.661888e-02 1 1  ON 42
eH1_3                -5.062656e-02 1 1  ON 43
eH1_4                 1.046175e-02 1 1  ON 44
eH1_5                 6.751962e-02 1 1  ON 45
eH1_6                 1.248545e-01 1 1  ON 46
eH1_7                 1.027469e-01 1 1  ON 47
eH1_8                 8.601649e-03 1 1  ON 48
eH1_9                -2.322048e-02 1 1  ON 49
eH2_0                -1.887102e-01 1 1  ON 50
eH2_1                -1.014464e-01 1 1  ON 51
eH2_2                -6.865697e-02 1 1  ON 52
eH2_3                -5.301817e-02 1 1  ON 53
eH2_4                 7.624652e-03 1 1  ON 54
eH2_5                 6.476979e-02 1 1  ON 55
eH2_6                 1.222919e-01 1 1  ON 56
eH2_7                 1.005946e-01 1 1  ON 57
eH2_8                 9.567497e-03 1 1  ON 58
eH2_9                -8.649967e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7902
    reference variance = 0.240461
====================================================
  Execution time = 7.6037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0254e-01
  Total weights = 2.0000e+06
  Execution time = 6.2885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502478456417
                                         uncertainty =       0.002858993052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502478456417
                                         uncertainty =       0.002858993052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501268243
  error estimate for blocks of size 2^( 2) =       0.000519041831
  error estimate for blocks of size 2^( 3) =       0.000534465901
  error estimate for blocks of size 2^( 4) =       0.000545854407
  error estimate for blocks of size 2^( 5) =       0.000553843380
  error estimate for blocks of size 2^( 6) =       0.000558042726
  error estimate for blocks of size 2^( 7) =       0.000561158233

      target function =                  N/A
              le_mean =     -22.825248251476
             les_mean =     521.494497193342
             stat err =       0.000554724687
             autocorr =       1.224657379078
              std dev =       0.708900347782
             le_variance =       0.502539703086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502479620117
                                         uncertainty =       0.002858946096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502479620117
                                         uncertainty =       0.002858946096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501268824
  error estimate for blocks of size 2^( 2) =       0.000519042400
  error estimate for blocks of size 2^( 3) =       0.000534466273
  error estimate for blocks of size 2^( 4) =       0.000545854548
  error estimate for blocks of size 2^( 5) =       0.000553843131
  error estimate for blocks of size 2^( 6) =       0.000558042751
  error estimate for blocks of size 2^( 7) =       0.000561158863

      target function =                  N/A
              le_mean =     -22.825248230077
             les_mean =     521.494497381552
             stat err =       0.000554724823
             autocorr =       1.224655144249
              std dev =       0.708901169544
             le_variance =       0.502540868181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502478929443
                                         uncertainty =       0.002858968700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502478929443
                                         uncertainty =       0.002858968700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501268479
  error estimate for blocks of size 2^( 2) =       0.000519042065
  error estimate for blocks of size 2^( 3) =       0.000534466037
  error estimate for blocks of size 2^( 4) =       0.000545854425
  error estimate for blocks of size 2^( 5) =       0.000553843197
  error estimate for blocks of size 2^( 6) =       0.000558042686
  error estimate for blocks of size 2^( 7) =       0.000561158506

      target function =                  N/A
              le_mean =     -22.825248240510
             les_mean =     521.494497166522
             stat err =       0.000554724704
             autocorr =       1.224656299909
              std dev =       0.708900681969
             le_variance =       0.502540176897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502478511513
                                         uncertainty =       0.002858989980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502478511513
                                         uncertainty =       0.002858989980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501268271
  error estimate for blocks of size 2^( 2) =       0.000519041859
  error estimate for blocks of size 2^( 3) =       0.000534465916
  error estimate for blocks of size 2^( 4) =       0.000545854407
  error estimate for blocks of size 2^( 5) =       0.000553843355
  error estimate for blocks of size 2^( 6) =       0.000558042719
  error estimate for blocks of size 2^( 7) =       0.000561158266

      target function =                  N/A
              le_mean =     -22.825248250038
             les_mean =     521.494497182871
             stat err =       0.000554724687
             autocorr =       1.224657245393
              std dev =       0.708900386714
             le_variance =       0.502539758283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825248251476        initial  <--
     9.5367e+00     9.5367e+01             2.4145e-05       -22.825248230077
     3.8147e+01     3.8147e+02             6.1099e-06       -22.825248240510
     1.5259e+02     1.5259e+03             1.5321e-06       -22.825248250038

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 107.5628
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170601e-02 1 1  ON 1
 uu_2                -1.975724e-02 1 1  ON 2
 uu_3                -8.528513e-02 1 1  ON 3
 uu_4                -1.232771e-01 1 1  ON 4
 uu_5                -1.465768e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368734e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764134e-03 1 1  ON 12
 ud_3                -7.123141e-02 1 1  ON 13
 ud_4                -1.185762e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666341e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742437e-01 1 1  ON 20
 eC_1                -4.192910e-01 1 1  ON 21
 eC_2                -1.694623e-01 1 1  ON 22
 eC_3                -2.220391e-02 1 1  ON 23
 eC_4                 2.711107e-02 1 1  ON 24
 eC_5                 1.130695e-01 1 1  ON 25
 eC_6                 2.307214e-01 1 1  ON 26
 eC_7                 4.089952e-01 1 1  ON 27
 eC_8                 3.137884e-01 1 1  ON 28
 eC_9                 8.144998e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815055e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536796e-02 1 1  ON 33
 eO_4                 1.756804e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605335e-01 1 1  ON 36
 eO_7                 5.331915e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867326e-01 1 1  ON 40
eH1_1                -9.999220e-02 1 1  ON 41
eH1_2                -6.661752e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046350e-02 1 1  ON 44
eH1_5                 6.751819e-02 1 1  ON 45
eH1_6                 1.248574e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599759e-03 1 1  ON 48
eH1_9                -2.321936e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865638e-02 1 1  ON 52
eH2_3                -5.301685e-02 1 1  ON 53
eH2_4                 7.624664e-03 1 1  ON 54
eH2_5                 6.477006e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005930e-01 1 1  ON 57
eH2_8                 9.566179e-03 1 1  ON 58
eH2_9                -8.648305e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1226e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.78
    reference variance = 0.821127
====================================================
  Execution time = 8.0781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0783e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6464e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507818626413
                                         uncertainty =       0.003608176870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507818626413
                                         uncertainty =       0.003608176870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503898924
  error estimate for blocks of size 2^( 2) =       0.000521603672
  error estimate for blocks of size 2^( 3) =       0.000537548640
  error estimate for blocks of size 2^( 4) =       0.000548978265
  error estimate for blocks of size 2^( 5) =       0.000555540847
  error estimate for blocks of size 2^( 6) =       0.000560498263
  error estimate for blocks of size 2^( 7) =       0.000560658568

      target function =                  N/A
              le_mean =     -22.825901181187
             les_mean =     521.529592730693
             stat err =       0.000556418986
             autocorr =       1.219318094684
              std dev =       0.712620692432
             le_variance =       0.507828251283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282590118119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825901181187       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825901183859       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825901182617       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825901170507       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825901168780       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825901171087       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825901173646       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825901173280       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825901172643       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825901171591       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+01 is 1.711094e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825901181187       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825901181856       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825901181546       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825901178512       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825901178077       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825901178656       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825901179291       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825901179197       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825901179036       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825901178772       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+02 is 4.281241e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825901181187       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825901181354       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825901181277       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825901180518       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825901180410       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825901180554       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825901180709       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825901180694       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825901180650       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825901180585       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+03 is 1.070530e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148462 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0726e+02
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170591e-02 1 1  ON 1
 uu_2                -1.975732e-02 1 1  ON 2
 uu_3                -8.528519e-02 1 1  ON 3
 uu_4                -1.232771e-01 1 1  ON 4
 uu_5                -1.465764e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534163e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368731e-01 1 1  ON 10
 ud_1                 1.545024e-01 1 1  ON 11
 ud_2                 8.764220e-03 1 1  ON 12
 ud_3                -7.123132e-02 1 1  ON 13
 ud_4                -1.185762e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670505e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666337e-01 1 1  ON 18
 ud_9                -1.429875e-01 1 1  ON 19
 eC_0                -5.742439e-01 1 1  ON 20
 eC_1                -4.192912e-01 1 1  ON 21
 eC_2                -1.694621e-01 1 1  ON 22
 eC_3                -2.220393e-02 1 1  ON 23
 eC_4                 2.711102e-02 1 1  ON 24
 eC_5                 1.130693e-01 1 1  ON 25
 eC_6                 2.307214e-01 1 1  ON 26
 eC_7                 4.089952e-01 1 1  ON 27
 eC_8                 3.137887e-01 1 1  ON 28
 eC_9                 8.145013e-02 1 1  ON 29
 eO_0                -1.259696e+00 1 1  ON 30
 eO_1                -8.815056e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536788e-02 1 1  ON 33
 eO_4                 1.756807e-01 1 1  ON 34
 eO_5                 3.636775e-01 1 1  ON 35
 eO_6                 4.605333e-01 1 1  ON 36
 eO_7                 5.331915e-01 1 1  ON 37
 eO_8                 5.129013e-01 1 1  ON 38
 eO_9                 3.639296e-01 1 1  ON 39
eH1_0                -1.867330e-01 1 1  ON 40
eH1_1                -9.999208e-02 1 1  ON 41
eH1_2                -6.661715e-02 1 1  ON 42
eH1_3                -5.062818e-02 1 1  ON 43
eH1_4                 1.046313e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248574e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599921e-03 1 1  ON 48
eH1_9                -2.321940e-02 1 1  ON 49
eH2_0                -1.887090e-01 1 1  ON 50
eH2_1                -1.014493e-01 1 1  ON 51
eH2_2                -6.865662e-02 1 1  ON 52
eH2_3                -5.301700e-02 1 1  ON 53
eH2_4                 7.624677e-03 1 1  ON 54
eH2_5                 6.477032e-02 1 1  ON 55
eH2_6                 1.222936e-01 1 1  ON 56
eH2_7                 1.005930e-01 1 1  ON 57
eH2_8                 9.566276e-03 1 1  ON 58
eH2_9                -8.648351e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8361
    reference variance = 0.901106
====================================================
  Execution time = 7.6881e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0702e-01
  Total weights = 2.0000e+06
  Execution time = 6.2801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506973567249
                                         uncertainty =       0.007722421822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506973567249
                                         uncertainty =       0.007722421822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503498461
  error estimate for blocks of size 2^( 2) =       0.000521035932
  error estimate for blocks of size 2^( 3) =       0.000537301064
  error estimate for blocks of size 2^( 4) =       0.000547869656
  error estimate for blocks of size 2^( 5) =       0.000554560042
  error estimate for blocks of size 2^( 6) =       0.000558373836
  error estimate for blocks of size 2^( 7) =       0.000558113599

      target function =                  N/A
              le_mean =     -22.825595834701
             les_mean =     521.514846355242
             stat err =       0.000554729283
             autocorr =       1.213852424854
              std dev =       0.712054351615
             le_variance =       0.507021399654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506971854139
                                         uncertainty =       0.007722404618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506971854139
                                         uncertainty =       0.007722404618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503497611
  error estimate for blocks of size 2^( 2) =       0.000521035122
  error estimate for blocks of size 2^( 3) =       0.000537300287
  error estimate for blocks of size 2^( 4) =       0.000547868917
  error estimate for blocks of size 2^( 5) =       0.000554559296
  error estimate for blocks of size 2^( 6) =       0.000558373106
  error estimate for blocks of size 2^( 7) =       0.000558112911

      target function =                  N/A
              le_mean =     -22.825595822502
             les_mean =     521.514844086680
             stat err =       0.000554728557
             autocorr =       1.213853346431
              std dev =       0.712053149669
             le_variance =       0.507019687954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506972707407
                                         uncertainty =       0.007722413193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506972707407
                                         uncertainty =       0.007722413193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503498034
  error estimate for blocks of size 2^( 2) =       0.000521035525
  error estimate for blocks of size 2^( 3) =       0.000537300674
  error estimate for blocks of size 2^( 4) =       0.000547869285
  error estimate for blocks of size 2^( 5) =       0.000554559668
  error estimate for blocks of size 2^( 6) =       0.000558373470
  error estimate for blocks of size 2^( 7) =       0.000558113254

      target function =                  N/A
              le_mean =     -22.825595828587
             les_mean =     521.514845217036
             stat err =       0.000554728919
             autocorr =       1.213852887336
              std dev =       0.712053748336
             le_variance =       0.507020540519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506973459663
                                         uncertainty =       0.007722420743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506973459663
                                         uncertainty =       0.007722420743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503498407
  error estimate for blocks of size 2^( 2) =       0.000521035881
  error estimate for blocks of size 2^( 3) =       0.000537301016
  error estimate for blocks of size 2^( 4) =       0.000547869609
  error estimate for blocks of size 2^( 5) =       0.000554559995
  error estimate for blocks of size 2^( 6) =       0.000558373790
  error estimate for blocks of size 2^( 7) =       0.000558113556

      target function =                  N/A
              le_mean =     -22.825595833936
             les_mean =     521.514846212821
             stat err =       0.000554729238
             autocorr =       1.213852482717
              std dev =       0.712054276131
             le_variance =       0.507021292157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825595834701        initial  <--
     9.5367e+01     9.5367e+02             1.7111e-06       -22.825595822502
     3.8147e+02     3.8147e+03             4.2812e-07       -22.825595828587
     1.5259e+03     1.5259e+04             1.0705e-07       -22.825595833936

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 108.3539
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170601e-02 1 1  ON 1
 uu_2                -1.975724e-02 1 1  ON 2
 uu_3                -8.528513e-02 1 1  ON 3
 uu_4                -1.232771e-01 1 1  ON 4
 uu_5                -1.465768e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368734e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764134e-03 1 1  ON 12
 ud_3                -7.123141e-02 1 1  ON 13
 ud_4                -1.185762e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666341e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742437e-01 1 1  ON 20
 eC_1                -4.192910e-01 1 1  ON 21
 eC_2                -1.694623e-01 1 1  ON 22
 eC_3                -2.220391e-02 1 1  ON 23
 eC_4                 2.711107e-02 1 1  ON 24
 eC_5                 1.130695e-01 1 1  ON 25
 eC_6                 2.307214e-01 1 1  ON 26
 eC_7                 4.089952e-01 1 1  ON 27
 eC_8                 3.137884e-01 1 1  ON 28
 eC_9                 8.144998e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815055e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536796e-02 1 1  ON 33
 eO_4                 1.756804e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605335e-01 1 1  ON 36
 eO_7                 5.331915e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867326e-01 1 1  ON 40
eH1_1                -9.999220e-02 1 1  ON 41
eH1_2                -6.661752e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046350e-02 1 1  ON 44
eH1_5                 6.751819e-02 1 1  ON 45
eH1_6                 1.248574e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599759e-03 1 1  ON 48
eH1_9                -2.321936e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865638e-02 1 1  ON 52
eH2_3                -5.301685e-02 1 1  ON 53
eH2_4                 7.624664e-03 1 1  ON 54
eH2_5                 6.477006e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005930e-01 1 1  ON 57
eH2_8                 9.566179e-03 1 1  ON 58
eH2_9                -8.648305e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1562e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7878
    reference variance = 1.11696
====================================================
  Execution time = 7.8337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1128e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6039e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511249275100
                                         uncertainty =       0.007197687898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511249275100
                                         uncertainty =       0.007197687898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505606639
  error estimate for blocks of size 2^( 2) =       0.000523237844
  error estimate for blocks of size 2^( 3) =       0.000539050068
  error estimate for blocks of size 2^( 4) =       0.000550085782
  error estimate for blocks of size 2^( 5) =       0.000556678134
  error estimate for blocks of size 2^( 6) =       0.000559700696
  error estimate for blocks of size 2^( 7) =       0.000560088542

      target function =                  N/A
              le_mean =     -22.825740494170
             les_mean =     521.525704997367
             stat err =       0.000556638288
             autocorr =       1.212050226582
              std dev =       0.715035765420
             le_variance =       0.511276145830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282574049417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825740494170       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825740495604       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825740496067       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825740496133       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825740496166       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825740496362       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825740496204       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825740496179       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825740496204       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825740496259       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+02 is 1.579251e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825740494170       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825740494528       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825740494644       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825740494661       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825740494670       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825740494721       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825740494680       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825740494666       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825740494657       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825740494685       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+03 is 3.948700e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825740494170       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825740494259       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825740494288       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825740494292       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825740494292       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825740494305       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825740494297       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825740494289       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825740494338       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825740494334       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+04 is 9.872107e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152062 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0439e+02
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170599e-02 1 1  ON 1
 uu_2                -1.975722e-02 1 1  ON 2
 uu_3                -8.528514e-02 1 1  ON 3
 uu_4                -1.232771e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368734e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764167e-03 1 1  ON 12
 ud_3                -7.123141e-02 1 1  ON 13
 ud_4                -1.185762e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666341e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742437e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694623e-01 1 1  ON 22
 eC_3                -2.220392e-02 1 1  ON 23
 eC_4                 2.711109e-02 1 1  ON 24
 eC_5                 1.130695e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089952e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.144999e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815056e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536797e-02 1 1  ON 33
 eO_4                 1.756805e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605335e-01 1 1  ON 36
 eO_7                 5.331915e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867326e-01 1 1  ON 40
eH1_1                -9.999219e-02 1 1  ON 41
eH1_2                -6.661751e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751819e-02 1 1  ON 45
eH1_6                 1.248574e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599764e-03 1 1  ON 48
eH1_9                -2.321938e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865639e-02 1 1  ON 52
eH2_3                -5.301686e-02 1 1  ON 53
eH2_4                 7.624687e-03 1 1  ON 54
eH2_5                 6.477009e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005930e-01 1 1  ON 57
eH2_8                 9.566173e-03 1 1  ON 58
eH2_9                -8.648322e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.9238
    reference variance = 0.368111
====================================================
  Execution time = 7.9057e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1418e-01
  Total weights = 2.0000e+06
  Execution time = 6.2627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514256981491
                                         uncertainty =       0.005638949643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514256981491
                                         uncertainty =       0.005638949643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507042930
  error estimate for blocks of size 2^( 2) =       0.000524335197
  error estimate for blocks of size 2^( 3) =       0.000540277974
  error estimate for blocks of size 2^( 4) =       0.000550459331
  error estimate for blocks of size 2^( 5) =       0.000555533721
  error estimate for blocks of size 2^( 6) =       0.000557846904
  error estimate for blocks of size 2^( 7) =       0.000560832850

      target function =                  N/A
              le_mean =     -22.825635355410
             les_mean =     521.523814185834
             stat err =       0.000556168201
             autocorr =       1.203158510446
              std dev =       0.717066987652
             le_variance =       0.514185064780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514256690905
                                         uncertainty =       0.005638947690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514256690905
                                         uncertainty =       0.005638947690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507042786
  error estimate for blocks of size 2^( 2) =       0.000524335062
  error estimate for blocks of size 2^( 3) =       0.000540277845
  error estimate for blocks of size 2^( 4) =       0.000550459206
  error estimate for blocks of size 2^( 5) =       0.000555533602
  error estimate for blocks of size 2^( 6) =       0.000557846789
  error estimate for blocks of size 2^( 7) =       0.000560832743

      target function =                  N/A
              le_mean =     -22.825635356071
             les_mean =     521.523813925441
             stat err =       0.000556168085
             autocorr =       1.203158685556
              std dev =       0.717066785036
             le_variance =       0.514184774202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514256836138
                                         uncertainty =       0.005638948667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514256836138
                                         uncertainty =       0.005638948667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507042858
  error estimate for blocks of size 2^( 2) =       0.000524335130
  error estimate for blocks of size 2^( 3) =       0.000540277909
  error estimate for blocks of size 2^( 4) =       0.000550459268
  error estimate for blocks of size 2^( 5) =       0.000555533661
  error estimate for blocks of size 2^( 6) =       0.000557846846
  error estimate for blocks of size 2^( 7) =       0.000560832797

      target function =                  N/A
              le_mean =     -22.825635355741
             les_mean =     521.523814055578
             stat err =       0.000556168143
             autocorr =       1.203158598042
              std dev =       0.717066886302
             le_variance =       0.514184919431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514256963320
                                         uncertainty =       0.005638949521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514256963320
                                         uncertainty =       0.005638949521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507042921
  error estimate for blocks of size 2^( 2) =       0.000524335189
  error estimate for blocks of size 2^( 3) =       0.000540277966
  error estimate for blocks of size 2^( 4) =       0.000550459323
  error estimate for blocks of size 2^( 5) =       0.000555533713
  error estimate for blocks of size 2^( 6) =       0.000557846897
  error estimate for blocks of size 2^( 7) =       0.000560832844

      target function =                  N/A
              le_mean =     -22.825635355451
             les_mean =     521.523814169550
             stat err =       0.000556168194
             autocorr =       1.203158521393
              std dev =       0.717066974982
             le_variance =       0.514185046610


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825635355410        initial
     9.5367e+02     9.5367e+03             1.5793e-07       -22.825635356071  <--
     3.8147e+03     3.8147e+04             3.9487e-08       -22.825635355741
     1.5259e+04     1.5259e+05             9.8721e-09       -22.825635355451

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 1.1044e+02
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599779e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1484e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8252
    reference variance = 0.358397
====================================================
  Execution time = 7.7458e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0280e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6638e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502833018292
                                         uncertainty =       0.004055542798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502833018292
                                         uncertainty =       0.004055542798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501399246
  error estimate for blocks of size 2^( 2) =       0.000519160648
  error estimate for blocks of size 2^( 3) =       0.000535503789
  error estimate for blocks of size 2^( 4) =       0.000547283573
  error estimate for blocks of size 2^( 5) =       0.000553816704
  error estimate for blocks of size 2^( 6) =       0.000556256666
  error estimate for blocks of size 2^( 7) =       0.000557623671

      target function =                  N/A
              le_mean =     -22.825086176851
             les_mean =     521.487361137782
             stat err =       0.000553745154
             autocorr =       1.219698592960
              std dev =       0.709085614370
             le_variance =       0.502802408506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282508617685e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825086176851       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825086181129       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825086183541       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825086184233       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825086184147       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825086184259       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825086184694       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825086185192       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825086184636       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825086184828       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+02 is 1.042697e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825086176851       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825086177922       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825086178525       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825086178698       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825086178677       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825086178704       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825086178813       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825086178938       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825086178800       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825086178849       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+02 is 2.608982e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825086176851       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825086177119       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825086177270       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825086177314       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825086177308       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825086177312       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825086177336       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825086177371       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825086177330       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825086177349       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+03 is 6.523856e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155615 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0410e+02
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.654976e-01 1 1  ON 0
 uu_1                 9.170589e-02 1 1  ON 1
 uu_2                -1.975716e-02 1 1  ON 2
 uu_3                -8.528525e-02 1 1  ON 3
 uu_4                -1.232770e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368734e-01 1 1  ON 10
 ud_1                 1.545024e-01 1 1  ON 11
 ud_2                 8.764342e-03 1 1  ON 12
 ud_3                -7.123140e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486691e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220405e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137886e-01 1 1  ON 28
 eC_9                 8.145006e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018506e-01 1 1  ON 32
 eO_3                -5.536808e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605335e-01 1 1  ON 36
 eO_7                 5.331915e-01 1 1  ON 37
 eO_8                 5.129013e-01 1 1  ON 38
 eO_9                 3.639296e-01 1 1  ON 39
eH1_0                -1.867328e-01 1 1  ON 40
eH1_1                -9.999216e-02 1 1  ON 41
eH1_2                -6.661751e-02 1 1  ON 42
eH1_3                -5.062833e-02 1 1  ON 43
eH1_4                 1.046359e-02 1 1  ON 44
eH1_5                 6.751824e-02 1 1  ON 45
eH1_6                 1.248576e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599786e-03 1 1  ON 48
eH1_9                -2.321950e-02 1 1  ON 49
eH2_0                -1.887090e-01 1 1  ON 50
eH2_1                -1.014490e-01 1 1  ON 51
eH2_2                -6.865637e-02 1 1  ON 52
eH2_3                -5.301693e-02 1 1  ON 53
eH2_4                 7.624795e-03 1 1  ON 54
eH2_5                 6.477026e-02 1 1  ON 55
eH2_6                 1.222932e-01 1 1  ON 56
eH2_7                 1.005930e-01 1 1  ON 57
eH2_8                 9.566241e-03 1 1  ON 58
eH2_9                -8.648448e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8179
    reference variance = 0.449884
====================================================
  Execution time = 7.7609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0498e-01
  Total weights = 2.0000e+06
  Execution time = 6.2831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505047965948
                                         uncertainty =       0.005552895062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505047965948
                                         uncertainty =       0.005552895062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502482681
  error estimate for blocks of size 2^( 2) =       0.000519770014
  error estimate for blocks of size 2^( 3) =       0.000535077082
  error estimate for blocks of size 2^( 4) =       0.000545023651
  error estimate for blocks of size 2^( 5) =       0.000551552303
  error estimate for blocks of size 2^( 6) =       0.000554637157
  error estimate for blocks of size 2^( 7) =       0.000557631349

      target function =                  N/A
              le_mean =     -22.825412751979
             les_mean =     521.504444734917
             stat err =       0.000552211115
             autocorr =       1.207725102313
              std dev =       0.710617822183
             le_variance =       0.504977689205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505048606275
                                         uncertainty =       0.005552903988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505048606275
                                         uncertainty =       0.005552903988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502483000
  error estimate for blocks of size 2^( 2) =       0.000519770318
  error estimate for blocks of size 2^( 3) =       0.000535077367
  error estimate for blocks of size 2^( 4) =       0.000545023935
  error estimate for blocks of size 2^( 5) =       0.000551552595
  error estimate for blocks of size 2^( 6) =       0.000554637433
  error estimate for blocks of size 2^( 7) =       0.000557631605

      target function =                  N/A
              le_mean =     -22.825412751456
             les_mean =     521.504445351816
             stat err =       0.000552211392
             autocorr =       1.207724781104
              std dev =       0.710618273024
             le_variance =       0.504978329956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505048286397
                                         uncertainty =       0.005552899532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505048286397
                                         uncertainty =       0.005552899532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502482840
  error estimate for blocks of size 2^( 2) =       0.000519770166
  error estimate for blocks of size 2^( 3) =       0.000535077224
  error estimate for blocks of size 2^( 4) =       0.000545023793
  error estimate for blocks of size 2^( 5) =       0.000551552449
  error estimate for blocks of size 2^( 6) =       0.000554637295
  error estimate for blocks of size 2^( 7) =       0.000557631477

      target function =                  N/A
              le_mean =     -22.825412751723
             les_mean =     521.504445043876
             stat err =       0.000552211254
             autocorr =       1.207724941550
              std dev =       0.710618047806
             le_variance =       0.504978009867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505048006012
                                         uncertainty =       0.005552895621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505048006012
                                         uncertainty =       0.005552895621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502482701
  error estimate for blocks of size 2^( 2) =       0.000519770033
  error estimate for blocks of size 2^( 3) =       0.000535077100
  error estimate for blocks of size 2^( 4) =       0.000545023669
  error estimate for blocks of size 2^( 5) =       0.000551552322
  error estimate for blocks of size 2^( 6) =       0.000554637174
  error estimate for blocks of size 2^( 7) =       0.000557631365

      target function =                  N/A
              le_mean =     -22.825412751947
             les_mean =     521.504444773548
             stat err =       0.000552211132
             autocorr =       1.207725082214
              std dev =       0.710617850392
             le_variance =       0.504977729296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825412751979        initial  <--
     2.3842e+02     2.3842e+03             1.0427e-06       -22.825412751456
     9.5367e+02     9.5367e+03             2.6090e-07       -22.825412751723
     3.8147e+03     3.8147e+04             6.5239e-08       -22.825412751947

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 112.8893
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599779e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1700e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.804
    reference variance = 0.574103
====================================================
  Execution time = 7.8004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0769e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6691e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507785898175
                                         uncertainty =       0.003902996893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507785898175
                                         uncertainty =       0.003902996893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503831326
  error estimate for blocks of size 2^( 2) =       0.000521387416
  error estimate for blocks of size 2^( 3) =       0.000536815286
  error estimate for blocks of size 2^( 4) =       0.000547560878
  error estimate for blocks of size 2^( 5) =       0.000554529297
  error estimate for blocks of size 2^( 6) =       0.000556799580
  error estimate for blocks of size 2^( 7) =       0.000559045424

      target function =                  N/A
              le_mean =     -22.825504186653
             les_mean =     521.511333131037
             stat err =       0.000554483795
             autocorr =       1.211176354285
              std dev =       0.712525094266
             le_variance =       0.507692009958


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282550418665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825504186653       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825504186894       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825504186997       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825504186959       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825504187047       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825504187046       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825504186990       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825504186991       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825504186985       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825504187009       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+03 is 6.997512e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825504186653       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825504186714       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825504186739       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825504186729       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825504186751       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825504186750       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825504186734       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825504186720       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825504186735       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825504186773       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+03 is 1.749461e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825504186653       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825504186668       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825504186675       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825504186672       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825504186678       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825504186684       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825504186675       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825504186715       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825504186636       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825504186750       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+04 is 4.373703e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159482 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0470e+02
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170593e-02 1 1  ON 1
 uu_2                -1.975714e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764273e-03 1 1  ON 12
 ud_3                -7.123140e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220399e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536801e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999216e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062826e-02 1 1  ON 43
eH1_4                 1.046348e-02 1 1  ON 44
eH1_5                 6.751820e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027476e-01 1 1  ON 47
eH1_8                 8.599782e-03 1 1  ON 48
eH1_9                -2.321943e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624760e-03 1 1  ON 54
eH2_5                 6.477019e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566154e-03 1 1  ON 58
eH2_9                -8.648378e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.9668
    reference variance = 0.533601
====================================================
  Execution time = 7.6979e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1409e-01
  Total weights = 2.0000e+06
  Execution time = 6.2725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514223709194
                                         uncertainty =       0.008509738862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514223709194
                                         uncertainty =       0.008509738862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506996838
  error estimate for blocks of size 2^( 2) =       0.000524191967
  error estimate for blocks of size 2^( 3) =       0.000539408267
  error estimate for blocks of size 2^( 4) =       0.000550307614
  error estimate for blocks of size 2^( 5) =       0.000557078118
  error estimate for blocks of size 2^( 6) =       0.000561254498
  error estimate for blocks of size 2^( 7) =       0.000564440299

      target function =                  N/A
              le_mean =     -22.825732091453
             les_mean =     521.528136841384
             stat err =       0.000558270132
             autocorr =       1.212490334465
              std dev =       0.717001804482
             le_variance =       0.514091587631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514223735425
                                         uncertainty =       0.008509736694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514223735425
                                         uncertainty =       0.008509736694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506996851
  error estimate for blocks of size 2^( 2) =       0.000524191979
  error estimate for blocks of size 2^( 3) =       0.000539408277
  error estimate for blocks of size 2^( 4) =       0.000550307624
  error estimate for blocks of size 2^( 5) =       0.000557078128
  error estimate for blocks of size 2^( 6) =       0.000561254508
  error estimate for blocks of size 2^( 7) =       0.000564440306

      target function =                  N/A
              le_mean =     -22.825732090968
             les_mean =     521.528136845473
             stat err =       0.000558270142
             autocorr =       1.212490313664
              std dev =       0.717001822772
             le_variance =       0.514091613858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514223722311
                                         uncertainty =       0.008509737777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514223722311
                                         uncertainty =       0.008509737777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506996845
  error estimate for blocks of size 2^( 2) =       0.000524191973
  error estimate for blocks of size 2^( 3) =       0.000539408272
  error estimate for blocks of size 2^( 4) =       0.000550307619
  error estimate for blocks of size 2^( 5) =       0.000557078123
  error estimate for blocks of size 2^( 6) =       0.000561254503
  error estimate for blocks of size 2^( 7) =       0.000564440302

      target function =                  N/A
              le_mean =     -22.825732091211
             les_mean =     521.528136843426
             stat err =       0.000558270137
             autocorr =       1.212490324068
              std dev =       0.717001813628
             le_variance =       0.514091600746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514223710833
                                         uncertainty =       0.008509738726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514223710833
                                         uncertainty =       0.008509738726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506996839
  error estimate for blocks of size 2^( 2) =       0.000524191968
  error estimate for blocks of size 2^( 3) =       0.000539408267
  error estimate for blocks of size 2^( 4) =       0.000550307614
  error estimate for blocks of size 2^( 5) =       0.000557078119
  error estimate for blocks of size 2^( 6) =       0.000561254499
  error estimate for blocks of size 2^( 7) =       0.000564440299

      target function =                  N/A
              le_mean =     -22.825732091423
             les_mean =     521.528136841639
             stat err =       0.000558270133
             autocorr =       1.212490333161
              std dev =       0.717001805626
             le_variance =       0.514091589271


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825732091453        initial  <--
     2.3842e+03     2.3842e+04             6.9975e-08       -22.825732090968
     9.5367e+03     9.5367e+04             1.7495e-08       -22.825732091211
     3.8147e+04     3.8147e+05             4.3737e-09       -22.825732091423

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 108.4192
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599779e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1313e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7624
    reference variance = 0.398526
====================================================
  Execution time = 7.8253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0206e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6615e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502038003497
                                         uncertainty =       0.003201340914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502038003497
                                         uncertainty =       0.003201340914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501027731
  error estimate for blocks of size 2^( 2) =       0.000518647109
  error estimate for blocks of size 2^( 3) =       0.000534449614
  error estimate for blocks of size 2^( 4) =       0.000546165535
  error estimate for blocks of size 2^( 5) =       0.000553579856
  error estimate for blocks of size 2^( 6) =       0.000556989947
  error estimate for blocks of size 2^( 7) =       0.000558493776

      target function =                  N/A
              le_mean =     -22.824418642638
             les_mean =     521.456143698779
             stat err =       0.000553807278
             autocorr =       1.221782188470
              std dev =       0.708560212987
             le_variance =       0.502057575428


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282441864264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824418642638       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824418642631       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824418642625       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824418642629       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824418642644       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824418642652       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824418642612       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824418642539       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824418642618       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824418642647       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+04 is 1.029812e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824418642638       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824418642636       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824418642634       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824418642635       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824418642651       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824418642595       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824418642676       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824418642535       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824418642774       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824418642475       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+04 is 2.574559e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824418642638       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824418642637       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824418642637       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824418642637       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824418642638       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824418642559       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824418642048       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824418642749       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824418643177       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824418642887       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+05 is 6.436417e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0488e+02
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123140e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751820e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624757e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648371e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7739
    reference variance = 0.492237
====================================================
  Execution time = 7.7898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9447e-01
  Total weights = 2.0000e+06
  Execution time = 6.2845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494472791442
                                         uncertainty =       0.003226761904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494472791442
                                         uncertainty =       0.003226761904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497229860
  error estimate for blocks of size 2^( 2) =       0.000514970627
  error estimate for blocks of size 2^( 3) =       0.000531159215
  error estimate for blocks of size 2^( 4) =       0.000543098741
  error estimate for blocks of size 2^( 5) =       0.000548520710
  error estimate for blocks of size 2^( 6) =       0.000553011724
  error estimate for blocks of size 2^( 7) =       0.000554922983

      target function =                  N/A
              le_mean =     -22.825003073985
             les_mean =     521.475240147899
             stat err =       0.000549888540
             autocorr =       1.223023871739
              std dev =       0.703189211878
             le_variance =       0.494475067701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494472792761
                                         uncertainty =       0.003226761923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494472792761
                                         uncertainty =       0.003226761923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497229861
  error estimate for blocks of size 2^( 2) =       0.000514970627
  error estimate for blocks of size 2^( 3) =       0.000531159215
  error estimate for blocks of size 2^( 4) =       0.000543098741
  error estimate for blocks of size 2^( 5) =       0.000548520711
  error estimate for blocks of size 2^( 6) =       0.000553011725
  error estimate for blocks of size 2^( 7) =       0.000554922983

      target function =                  N/A
              le_mean =     -22.825003073959
             les_mean =     521.475240148032
             stat err =       0.000549888540
             autocorr =       1.223023870278
              std dev =       0.703189212814
             le_variance =       0.494475069019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494472792101
                                         uncertainty =       0.003226761913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494472792101
                                         uncertainty =       0.003226761913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497229861
  error estimate for blocks of size 2^( 2) =       0.000514970627
  error estimate for blocks of size 2^( 3) =       0.000531159215
  error estimate for blocks of size 2^( 4) =       0.000543098741
  error estimate for blocks of size 2^( 5) =       0.000548520711
  error estimate for blocks of size 2^( 6) =       0.000553011725
  error estimate for blocks of size 2^( 7) =       0.000554922983

      target function =                  N/A
              le_mean =     -22.825003073972
             les_mean =     521.475240147965
             stat err =       0.000549888540
             autocorr =       1.223023871008
              std dev =       0.703189212346
             le_variance =       0.494475068360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494472791524
                                         uncertainty =       0.003226761905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494472791524
                                         uncertainty =       0.003226761905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497229860
  error estimate for blocks of size 2^( 2) =       0.000514970627
  error estimate for blocks of size 2^( 3) =       0.000531159215
  error estimate for blocks of size 2^( 4) =       0.000543098741
  error estimate for blocks of size 2^( 5) =       0.000548520710
  error estimate for blocks of size 2^( 6) =       0.000553011724
  error estimate for blocks of size 2^( 7) =       0.000554922983

      target function =                  N/A
              le_mean =     -22.825003073984
             les_mean =     521.475240147907
             stat err =       0.000549888540
             autocorr =       1.223023871649
              std dev =       0.703189211936
             le_variance =       0.494475067784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825003073985        initial  <--
     2.3842e+04     2.3842e+05             1.0298e-08       -22.825003073959
     9.5367e+04     9.5367e+05             2.5746e-09       -22.825003073972
     3.8147e+05     3.8147e+06             6.4364e-10       -22.825003073984

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 109.4151
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599779e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1430e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8398
    reference variance = 0.526105
====================================================
  Execution time = 7.7753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1260e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6329e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512718367715
                                         uncertainty =       0.006360327873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512718367715
                                         uncertainty =       0.006360327873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506259817
  error estimate for blocks of size 2^( 2) =       0.000523572200
  error estimate for blocks of size 2^( 3) =       0.000539168607
  error estimate for blocks of size 2^( 4) =       0.000549609022
  error estimate for blocks of size 2^( 5) =       0.000555171178
  error estimate for blocks of size 2^( 6) =       0.000557179961
  error estimate for blocks of size 2^( 7) =       0.000557866724

      target function =                  N/A
              le_mean =     -22.825499515442
             les_mean =     521.516025877270
             stat err =       0.000554956721
             autocorr =       1.201631532663
              std dev =       0.715959498957
             le_variance =       0.512598004147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282549951544e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825499515442       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825499515444       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825499515442       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825499515397       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825499515396       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825499515270       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825499515411       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825499516608       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825499515365       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825499515801       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+05 is 7.147763e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825499515442       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825499515442       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825499515442       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825499515441       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825499515658       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825499515028       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825499514839       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825499515061       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825499515336       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825499515719       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+05 is 1.786951e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825499515442       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825499515442       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825499515442       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825499515441       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825499515924       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825499512603       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825499515459       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825499516047       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825499512398       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825499507251       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+06 is 4.467392e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166629 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0409e+02
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123140e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648371e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -23.0401
    reference variance = 1.28767
====================================================
  Execution time = 7.9892e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0336e-01
  Total weights = 2.0000e+06
  Execution time = 6.2744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503383359294
                                         uncertainty =       0.003358320871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503383359294
                                         uncertainty =       0.003358320871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501674825
  error estimate for blocks of size 2^( 2) =       0.000519545663
  error estimate for blocks of size 2^( 3) =       0.000535486975
  error estimate for blocks of size 2^( 4) =       0.000545676889
  error estimate for blocks of size 2^( 5) =       0.000552391715
  error estimate for blocks of size 2^( 6) =       0.000555437892
  error estimate for blocks of size 2^( 7) =       0.000556629633

      target function =                  N/A
              le_mean =     -22.825623144507
             les_mean =     521.512426943512
             stat err =       0.000552534032
             autocorr =       1.213035329879
              std dev =       0.709475341470
             le_variance =       0.503355260154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503383359171
                                         uncertainty =       0.003358320876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503383359171
                                         uncertainty =       0.003358320876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501674825
  error estimate for blocks of size 2^( 2) =       0.000519545663
  error estimate for blocks of size 2^( 3) =       0.000535486975
  error estimate for blocks of size 2^( 4) =       0.000545676889
  error estimate for blocks of size 2^( 5) =       0.000552391715
  error estimate for blocks of size 2^( 6) =       0.000555437892
  error estimate for blocks of size 2^( 7) =       0.000556629633

      target function =                  N/A
              le_mean =     -22.825623144502
             les_mean =     521.512426943165
             stat err =       0.000552534032
             autocorr =       1.213035330061
              std dev =       0.709475341383
             le_variance =       0.503355260031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503383359233
                                         uncertainty =       0.003358320873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503383359233
                                         uncertainty =       0.003358320873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501674825
  error estimate for blocks of size 2^( 2) =       0.000519545663
  error estimate for blocks of size 2^( 3) =       0.000535486975
  error estimate for blocks of size 2^( 4) =       0.000545676889
  error estimate for blocks of size 2^( 5) =       0.000552391715
  error estimate for blocks of size 2^( 6) =       0.000555437892
  error estimate for blocks of size 2^( 7) =       0.000556629633

      target function =                  N/A
              le_mean =     -22.825623144504
             les_mean =     521.512426943338
             stat err =       0.000552534032
             autocorr =       1.213035329969
              std dev =       0.709475341426
             le_variance =       0.503355260092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503383359287
                                         uncertainty =       0.003358320871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503383359287
                                         uncertainty =       0.003358320871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501674825
  error estimate for blocks of size 2^( 2) =       0.000519545663
  error estimate for blocks of size 2^( 3) =       0.000535486975
  error estimate for blocks of size 2^( 4) =       0.000545676889
  error estimate for blocks of size 2^( 5) =       0.000552391715
  error estimate for blocks of size 2^( 6) =       0.000555437892
  error estimate for blocks of size 2^( 7) =       0.000556629633

      target function =                  N/A
              le_mean =     -22.825623144506
             les_mean =     521.512426943490
             stat err =       0.000552534032
             autocorr =       1.213035329891
              std dev =       0.709475341464
             le_variance =       0.503355260146


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825623144507        initial  <--
     2.3842e+05     2.3842e+06             7.1478e-10       -22.825623144502
     9.5367e+05     9.5367e+06             1.7870e-10       -22.825623144504
     3.8147e+06     3.8147e+07             4.4674e-11       -22.825623144506

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 111.3298
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599779e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1543e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.9389
    reference variance = 0.855046
====================================================
  Execution time = 7.8602e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 8.8209e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6652e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.882698576925
                                         uncertainty =       0.286046928850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.882698576925
                                         uncertainty =       0.286046928850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000664111136
  error estimate for blocks of size 2^( 2) =       0.000677797714
  error estimate for blocks of size 2^( 3) =       0.000690102910
  error estimate for blocks of size 2^( 4) =       0.000699453896
  error estimate for blocks of size 2^( 5) =       0.000705071413
  error estimate for blocks of size 2^( 6) =       0.000708650934
  error estimate for blocks of size 2^( 7) =       0.000711081816

      target function =                  N/A
              le_mean =     -22.825202125769
             les_mean =     521.871938841835
             stat err =       0.000706064515
             autocorr =       1.130335183298
              std dev =       0.939194974793
             le_variance =       0.882087200677


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282520212577e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825202125769       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825202125769       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825202125769       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825202125769       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825202127325       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825202125824       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825202125685       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825202126020       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825202128015       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825202126702       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+06 is 1.186012e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825202125769       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825202125769       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825202125769       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825202125769       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825202128290       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825202125414       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825202140420       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825202128633       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825202126858       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825202123894       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+06 is 2.964982e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825202125769       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825202125769       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825202125769       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825202138048       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825202113142       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825202124683       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825202120113       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825202127480       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825202120285       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825202143375       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+07 is 7.412822e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170139 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0526e+02
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599779e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7962
    reference variance = 0.827098
====================================================
  Execution time = 7.7417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0806e-01
  Total weights = 2.0000e+06
  Execution time = 6.2700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508049078283
                                         uncertainty =       0.004747693204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508049078283
                                         uncertainty =       0.004747693204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504014957
  error estimate for blocks of size 2^( 2) =       0.000521880612
  error estimate for blocks of size 2^( 3) =       0.000537774314
  error estimate for blocks of size 2^( 4) =       0.000548402700
  error estimate for blocks of size 2^( 5) =       0.000555166877
  error estimate for blocks of size 2^( 6) =       0.000557733124
  error estimate for blocks of size 2^( 7) =       0.000558434285

      target function =                  N/A
              le_mean =     -22.825133173271
             les_mean =     521.494766277834
             stat err =       0.000554934247
             autocorr =       1.212261198969
              std dev =       0.712784788219
             le_variance =       0.508062154317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508049078236
                                         uncertainty =       0.004747693203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508049078236
                                         uncertainty =       0.004747693203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504014957
  error estimate for blocks of size 2^( 2) =       0.000521880612
  error estimate for blocks of size 2^( 3) =       0.000537774314
  error estimate for blocks of size 2^( 4) =       0.000548402700
  error estimate for blocks of size 2^( 5) =       0.000555166877
  error estimate for blocks of size 2^( 6) =       0.000557733124
  error estimate for blocks of size 2^( 7) =       0.000558434285

      target function =                  N/A
              le_mean =     -22.825133173271
             les_mean =     521.494766277801
             stat err =       0.000554934247
             autocorr =       1.212261198956
              std dev =       0.712784788187
             le_variance =       0.508062154271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508049078260
                                         uncertainty =       0.004747693204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508049078260
                                         uncertainty =       0.004747693204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504014957
  error estimate for blocks of size 2^( 2) =       0.000521880612
  error estimate for blocks of size 2^( 3) =       0.000537774314
  error estimate for blocks of size 2^( 4) =       0.000548402700
  error estimate for blocks of size 2^( 5) =       0.000555166877
  error estimate for blocks of size 2^( 6) =       0.000557733124
  error estimate for blocks of size 2^( 7) =       0.000558434285

      target function =                  N/A
              le_mean =     -22.825133173271
             les_mean =     521.494766277817
             stat err =       0.000554934247
             autocorr =       1.212261198964
              std dev =       0.712784788203
             le_variance =       0.508062154294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508049078280
                                         uncertainty =       0.004747693204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508049078280
                                         uncertainty =       0.004747693204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504014957
  error estimate for blocks of size 2^( 2) =       0.000521880612
  error estimate for blocks of size 2^( 3) =       0.000537774314
  error estimate for blocks of size 2^( 4) =       0.000548402700
  error estimate for blocks of size 2^( 5) =       0.000555166877
  error estimate for blocks of size 2^( 6) =       0.000557733124
  error estimate for blocks of size 2^( 7) =       0.000558434285

      target function =                  N/A
              le_mean =     -22.825133173271
             les_mean =     521.494766277832
             stat err =       0.000554934247
             autocorr =       1.212261198957
              std dev =       0.712784788217
             le_variance =       0.508062154314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825133173271        initial
     2.3842e+06     2.3842e+07             1.1860e-10       -22.825133173271  <--
     9.5367e+06     9.5367e+07             2.9650e-11       -22.825133173271
     3.8147e+07     3.8147e+08             7.4128e-12       -22.825133173271

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 1.0889e+02
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1416e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7702
    reference variance = 0.295667
====================================================
  Execution time = 7.9142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0547e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6528e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505531692981
                                         uncertainty =       0.003394443772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505531692981
                                         uncertainty =       0.003394443772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502727241
  error estimate for blocks of size 2^( 2) =       0.000520570693
  error estimate for blocks of size 2^( 3) =       0.000536513977
  error estimate for blocks of size 2^( 4) =       0.000547340610
  error estimate for blocks of size 2^( 5) =       0.000554431912
  error estimate for blocks of size 2^( 6) =       0.000556917183
  error estimate for blocks of size 2^( 7) =       0.000559306705

      target function =                  N/A
              le_mean =     -22.825453117316
             les_mean =     521.506779115628
             stat err =       0.000554499103
             autocorr =       1.216569314370
              std dev =       0.710963682302
             le_variance =       0.505469357552


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282545311732e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825453117316       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825453117317       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825453117319       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825453117318       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825453117049       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825453117389       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825453117271       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825453117986       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825453118135       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825453118484       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+05 is 3.089427e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825453117316       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825453117317       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825453117317       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825453119206       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825453117684       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825453117368       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825453121419       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825453115670       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825453117508       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825453113533       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+06 is 7.723574e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825453117316       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825453117316       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825453117317       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825453122252       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825453115039       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825453117414       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825453117463       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825453112805       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825453120033       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825453108256       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+06 is 1.930855e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0568e+02
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648371e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7465
    reference variance = 0.595195
====================================================
  Execution time = 7.8187e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1079e-01
  Total weights = 2.0000e+06
  Execution time = 6.2836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510839093777
                                         uncertainty =       0.004346998690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510839093777
                                         uncertainty =       0.004346998690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505367231
  error estimate for blocks of size 2^( 2) =       0.000523397215
  error estimate for blocks of size 2^( 3) =       0.000538959764
  error estimate for blocks of size 2^( 4) =       0.000549178953
  error estimate for blocks of size 2^( 5) =       0.000555008281
  error estimate for blocks of size 2^( 6) =       0.000555975275
  error estimate for blocks of size 2^( 7) =       0.000557457738

      target function =                  N/A
              le_mean =     -22.825702318571
             les_mean =     521.523478156368
             stat err =       0.000554405062
             autocorr =       1.203483715087
              std dev =       0.714697191641
             le_variance =       0.510792075739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510839093490
                                         uncertainty =       0.004346998689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510839093490
                                         uncertainty =       0.004346998689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505367231
  error estimate for blocks of size 2^( 2) =       0.000523397215
  error estimate for blocks of size 2^( 3) =       0.000538959764
  error estimate for blocks of size 2^( 4) =       0.000549178953
  error estimate for blocks of size 2^( 5) =       0.000555008281
  error estimate for blocks of size 2^( 6) =       0.000555975275
  error estimate for blocks of size 2^( 7) =       0.000557457738

      target function =                  N/A
              le_mean =     -22.825702318570
             les_mean =     521.523478156023
             stat err =       0.000554405062
             autocorr =       1.203483715259
              std dev =       0.714697191439
             le_variance =       0.510792075451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510839093634
                                         uncertainty =       0.004346998689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510839093634
                                         uncertainty =       0.004346998689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505367231
  error estimate for blocks of size 2^( 2) =       0.000523397215
  error estimate for blocks of size 2^( 3) =       0.000538959764
  error estimate for blocks of size 2^( 4) =       0.000549178953
  error estimate for blocks of size 2^( 5) =       0.000555008281
  error estimate for blocks of size 2^( 6) =       0.000555975275
  error estimate for blocks of size 2^( 7) =       0.000557457738

      target function =                  N/A
              le_mean =     -22.825702318571
             les_mean =     521.523478156195
             stat err =       0.000554405062
             autocorr =       1.203483715169
              std dev =       0.714697191540
             le_variance =       0.510792075595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510839093759
                                         uncertainty =       0.004346998690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510839093759
                                         uncertainty =       0.004346998690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505367231
  error estimate for blocks of size 2^( 2) =       0.000523397215
  error estimate for blocks of size 2^( 3) =       0.000538959764
  error estimate for blocks of size 2^( 4) =       0.000549178953
  error estimate for blocks of size 2^( 5) =       0.000555008281
  error estimate for blocks of size 2^( 6) =       0.000555975275
  error estimate for blocks of size 2^( 7) =       0.000557457738

      target function =                  N/A
              le_mean =     -22.825702318571
             les_mean =     521.523478156346
             stat err =       0.000554405062
             autocorr =       1.203483715092
              std dev =       0.714697191628
             le_variance =       0.510792075721


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825702318571        initial  <--
     5.9605e+05     5.9605e+06             3.0894e-10       -22.825702318570
     2.3842e+06     2.3842e+07             7.7236e-11       -22.825702318571
     9.5367e+06     9.5367e+07             1.9309e-11       -22.825702318571

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 109.6960
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1538e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8293
    reference variance = 0.324456
====================================================
  Execution time = 7.7810e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0311e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6363e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503040481114
                                         uncertainty =       0.003441296953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503040481114
                                         uncertainty =       0.003441296953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501551544
  error estimate for blocks of size 2^( 2) =       0.000519349111
  error estimate for blocks of size 2^( 3) =       0.000535237682
  error estimate for blocks of size 2^( 4) =       0.000546926267
  error estimate for blocks of size 2^( 5) =       0.000554640819
  error estimate for blocks of size 2^( 6) =       0.000557808363
  error estimate for blocks of size 2^( 7) =       0.000559694161

      target function =                  N/A
              le_mean =     -22.825324519720
             les_mean =     521.498547082034
             stat err =       0.000554767403
             autocorr =       1.223462677495
              std dev =       0.709300996076
             le_variance =       0.503107903034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282532451972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825324519720       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825324519721       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825324519721       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825324520901       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825324519721       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825324520226       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825324519286       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825324522689       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825324519686       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825324517668       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+06 is 3.486082e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825324519720       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825324519721       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825324519721       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825324519721       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825324530565       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825324507471       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825324520540       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825324517221       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825324520321       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825324528675       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+07 is 8.715055e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825324519720       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825324519721       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825324519721       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825324519721       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825324528666       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825324471918       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825324504173       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825324556336       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825324504751       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825324955030       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+07 is 2.180827e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177233 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0418e+02
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8244
    reference variance = 0.487832
====================================================
  Execution time = 7.9060e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1000e-01
  Total weights = 2.0000e+06
  Execution time = 6.2990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510118525718
                                         uncertainty =       0.006156641464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510118525718
                                         uncertainty =       0.006156641464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504973999
  error estimate for blocks of size 2^( 2) =       0.000522636420
  error estimate for blocks of size 2^( 3) =       0.000538955240
  error estimate for blocks of size 2^( 4) =       0.000549241967
  error estimate for blocks of size 2^( 5) =       0.000554324956
  error estimate for blocks of size 2^( 6) =       0.000555956044
  error estimate for blocks of size 2^( 7) =       0.000558112905

      target function =                  N/A
              le_mean =     -22.825413239153
             les_mean =     521.509486762511
             stat err =       0.000554408968
             autocorr =       1.205375776149
              std dev =       0.714141078088
             le_variance =       0.509997479413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510118525727
                                         uncertainty =       0.006156641465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510118525727
                                         uncertainty =       0.006156641465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504973999
  error estimate for blocks of size 2^( 2) =       0.000522636420
  error estimate for blocks of size 2^( 3) =       0.000538955240
  error estimate for blocks of size 2^( 4) =       0.000549241967
  error estimate for blocks of size 2^( 5) =       0.000554324956
  error estimate for blocks of size 2^( 6) =       0.000555956044
  error estimate for blocks of size 2^( 7) =       0.000558112905

      target function =                  N/A
              le_mean =     -22.825413239153
             les_mean =     521.509486762512
             stat err =       0.000554408968
             autocorr =       1.205375776141
              std dev =       0.714141078095
             le_variance =       0.509997479423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510118525722
                                         uncertainty =       0.006156641465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510118525722
                                         uncertainty =       0.006156641465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504973999
  error estimate for blocks of size 2^( 2) =       0.000522636420
  error estimate for blocks of size 2^( 3) =       0.000538955240
  error estimate for blocks of size 2^( 4) =       0.000549241967
  error estimate for blocks of size 2^( 5) =       0.000554324956
  error estimate for blocks of size 2^( 6) =       0.000555956044
  error estimate for blocks of size 2^( 7) =       0.000558112905

      target function =                  N/A
              le_mean =     -22.825413239153
             les_mean =     521.509486762512
             stat err =       0.000554408968
             autocorr =       1.205375776141
              std dev =       0.714141078092
             le_variance =       0.509997479419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510118525718
                                         uncertainty =       0.006156641464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510118525718
                                         uncertainty =       0.006156641464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504973999
  error estimate for blocks of size 2^( 2) =       0.000522636420
  error estimate for blocks of size 2^( 3) =       0.000538955240
  error estimate for blocks of size 2^( 4) =       0.000549241967
  error estimate for blocks of size 2^( 5) =       0.000554324956
  error estimate for blocks of size 2^( 6) =       0.000555956044
  error estimate for blocks of size 2^( 7) =       0.000558112905

      target function =                  N/A
              le_mean =     -22.825413239153
             les_mean =     521.509486762511
             stat err =       0.000554408968
             autocorr =       1.205375776146
              std dev =       0.714141078089
             le_variance =       0.509997479414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825413239153        initial  <--
     5.9605e+06     5.9605e+07             3.4861e-11       -22.825413239153
     2.3842e+07     2.3842e+08             8.7151e-12       -22.825413239153
     9.5367e+07     9.5367e+08             2.1808e-12       -22.825413239153

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 110.6266
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1482e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8331
    reference variance = 0.354274
====================================================
  Execution time = 7.8484e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.9127e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6497e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591381457890
                                         uncertainty =       0.087535592365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591381457890
                                         uncertainty =       0.087535592365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543721323
  error estimate for blocks of size 2^( 2) =       0.000560536928
  error estimate for blocks of size 2^( 3) =       0.000574889943
  error estimate for blocks of size 2^( 4) =       0.000585095823
  error estimate for blocks of size 2^( 5) =       0.000591321444
  error estimate for blocks of size 2^( 6) =       0.000594559964
  error estimate for blocks of size 2^( 7) =       0.000595342618

      target function =                  N/A
              le_mean =     -22.825537950716
             les_mean =     521.596448197090
             stat err =       0.000591579962
             autocorr =       1.183788676822
              std dev =       0.768938068479
             le_variance =       0.591265753156


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282553795072e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825537950716       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825537950716       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825537950716       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825537952504       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825537973187       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825537949739       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825537956963       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825537919177       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825537956807       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825537987474       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+07 is 3.649203e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825537950716       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825537950716       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825537950716       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825537961429       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825537991578       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825538353761       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825538006634       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825538096127       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825537946652       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825537755904       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+08 is 9.112712e-13

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825537950716       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825537950716       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825537950716       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825538016467       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825537340139       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825539785257       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825533450783       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825538313553       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825538106044       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825541141154       residual = 9.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+08 is 2.291617e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0499e+02
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8392
    reference variance = 0.369913
====================================================
  Execution time = 7.8409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0284e-01
  Total weights = 2.0000e+06
  Execution time = 6.2749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502560820978
                                         uncertainty =       0.004088013160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502560820978
                                         uncertainty =       0.004088013160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501419419
  error estimate for blocks of size 2^( 2) =       0.000518930963
  error estimate for blocks of size 2^( 3) =       0.000534908271
  error estimate for blocks of size 2^( 4) =       0.000544420799
  error estimate for blocks of size 2^( 5) =       0.000551512848
  error estimate for blocks of size 2^( 6) =       0.000554532054
  error estimate for blocks of size 2^( 7) =       0.000556404360

      target function =                  N/A
              le_mean =     -22.824652977544
             les_mean =     521.467626161146
             stat err =       0.000551717515
             autocorr =       1.210685232246
              std dev =       0.709114142631
             le_variance =       0.502842867279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502560820972
                                         uncertainty =       0.004088013160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502560820972
                                         uncertainty =       0.004088013160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501419419
  error estimate for blocks of size 2^( 2) =       0.000518930963
  error estimate for blocks of size 2^( 3) =       0.000534908271
  error estimate for blocks of size 2^( 4) =       0.000544420799
  error estimate for blocks of size 2^( 5) =       0.000551512848
  error estimate for blocks of size 2^( 6) =       0.000554532054
  error estimate for blocks of size 2^( 7) =       0.000556404360

      target function =                  N/A
              le_mean =     -22.824652977544
             les_mean =     521.467626161140
             stat err =       0.000551717515
             autocorr =       1.210685232253
              std dev =       0.709114142626
             le_variance =       0.502842867273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502560820975
                                         uncertainty =       0.004088013160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502560820975
                                         uncertainty =       0.004088013160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501419419
  error estimate for blocks of size 2^( 2) =       0.000518930963
  error estimate for blocks of size 2^( 3) =       0.000534908271
  error estimate for blocks of size 2^( 4) =       0.000544420799
  error estimate for blocks of size 2^( 5) =       0.000551512848
  error estimate for blocks of size 2^( 6) =       0.000554532054
  error estimate for blocks of size 2^( 7) =       0.000556404360

      target function =                  N/A
              le_mean =     -22.824652977544
             les_mean =     521.467626161143
             stat err =       0.000551717515
             autocorr =       1.210685232244
              std dev =       0.709114142628
             le_variance =       0.502842867276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502560820978
                                         uncertainty =       0.004088013160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502560820978
                                         uncertainty =       0.004088013160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501419419
  error estimate for blocks of size 2^( 2) =       0.000518930963
  error estimate for blocks of size 2^( 3) =       0.000534908271
  error estimate for blocks of size 2^( 4) =       0.000544420799
  error estimate for blocks of size 2^( 5) =       0.000551512848
  error estimate for blocks of size 2^( 6) =       0.000554532054
  error estimate for blocks of size 2^( 7) =       0.000556404360

      target function =                  N/A
              le_mean =     -22.824652977544
             les_mean =     521.467626161145
             stat err =       0.000551717515
             autocorr =       1.210685232248
              std dev =       0.709114142630
             le_variance =       0.502842867278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824652977544        initial
     5.9605e+07     5.9605e+08             3.6492e-12       -22.824652977544  <--
     2.3842e+08     2.3842e+09             9.1127e-13       -22.824652977544
     9.5367e+08     9.5367e+09             2.2916e-13       -22.824652977544

*****************************************************************************
Applying the update for shift_i =   5.9605e+07     and shift_s =   5.9605e+08
*****************************************************************************

  Execution time = 1.1350e+02
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1850e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.755
    reference variance = 0.377999
====================================================
  Execution time = 7.8873e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0694e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6369e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507072824022
                                         uncertainty =       0.005936265840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507072824022
                                         uncertainty =       0.005936265840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503459907
  error estimate for blocks of size 2^( 2) =       0.000521785873
  error estimate for blocks of size 2^( 3) =       0.000537510823
  error estimate for blocks of size 2^( 4) =       0.000548562021
  error estimate for blocks of size 2^( 5) =       0.000552941593
  error estimate for blocks of size 2^( 6) =       0.000555797641
  error estimate for blocks of size 2^( 7) =       0.000557046713

      target function =                  N/A
              le_mean =     -22.824619009769
             les_mean =     521.470176442741
             stat err =       0.000553586992
             autocorr =       1.209043624535
              std dev =       0.711999828028
             le_variance =       0.506943755113


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282461900977e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824619009769       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824619009769       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824619009769       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824619009769       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824618994732       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824619003081       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824619009714       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824619011919       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824619008566       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+07 is 1.112264e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824619009769       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824619009769       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824619009769       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824619009769       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824618998980       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824618991050       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824618975866       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824619020354       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824619042718       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+07 is 2.781159e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824619009769       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824619009769       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824619009769       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824619009769       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824619109574       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824618956331       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824619204533       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824619118299       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824618376436       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+08 is 6.943979e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0525e+02
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8051
    reference variance = 0.611933
====================================================
  Execution time = 7.7983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0426e-01
  Total weights = 2.0000e+06
  Execution time = 6.2705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504264241361
                                         uncertainty =       0.005006238466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504264241361
                                         uncertainty =       0.005006238466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502125594
  error estimate for blocks of size 2^( 2) =       0.000519954587
  error estimate for blocks of size 2^( 3) =       0.000536150749
  error estimate for blocks of size 2^( 4) =       0.000546820399
  error estimate for blocks of size 2^( 5) =       0.000552496481
  error estimate for blocks of size 2^( 6) =       0.000555554552
  error estimate for blocks of size 2^( 7) =       0.000557222811

      target function =                  N/A
              le_mean =     -22.826066006100
             les_mean =     521.533549287495
             stat err =       0.000553023561
             autocorr =       1.213004887809
              std dev =       0.710112825408
             le_variance =       0.504260224809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504264241363
                                         uncertainty =       0.005006238466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504264241363
                                         uncertainty =       0.005006238466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502125594
  error estimate for blocks of size 2^( 2) =       0.000519954587
  error estimate for blocks of size 2^( 3) =       0.000536150749
  error estimate for blocks of size 2^( 4) =       0.000546820399
  error estimate for blocks of size 2^( 5) =       0.000552496481
  error estimate for blocks of size 2^( 6) =       0.000555554552
  error estimate for blocks of size 2^( 7) =       0.000557222811

      target function =                  N/A
              le_mean =     -22.826066006100
             les_mean =     521.533549287499
             stat err =       0.000553023561
             autocorr =       1.213004887803
              std dev =       0.710112825410
             le_variance =       0.504260224812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504264241362
                                         uncertainty =       0.005006238466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504264241362
                                         uncertainty =       0.005006238466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502125594
  error estimate for blocks of size 2^( 2) =       0.000519954587
  error estimate for blocks of size 2^( 3) =       0.000536150749
  error estimate for blocks of size 2^( 4) =       0.000546820399
  error estimate for blocks of size 2^( 5) =       0.000552496481
  error estimate for blocks of size 2^( 6) =       0.000555554552
  error estimate for blocks of size 2^( 7) =       0.000557222811

      target function =                  N/A
              le_mean =     -22.826066006100
             les_mean =     521.533549287497
             stat err =       0.000553023561
             autocorr =       1.213004887807
              std dev =       0.710112825409
             le_variance =       0.504260224810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504264241361
                                         uncertainty =       0.005006238466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504264241361
                                         uncertainty =       0.005006238466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502125594
  error estimate for blocks of size 2^( 2) =       0.000519954587
  error estimate for blocks of size 2^( 3) =       0.000536150749
  error estimate for blocks of size 2^( 4) =       0.000546820399
  error estimate for blocks of size 2^( 5) =       0.000552496481
  error estimate for blocks of size 2^( 6) =       0.000555554552
  error estimate for blocks of size 2^( 7) =       0.000557222811

      target function =                  N/A
              le_mean =     -22.826066006100
             les_mean =     521.533549287496
             stat err =       0.000553023561
             autocorr =       1.213004887808
              std dev =       0.710112825408
             le_variance =       0.504260224809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826066006100        initial
     1.4901e+07     1.4901e+08             1.1123e-11       -22.826066006100
     5.9605e+07     5.9605e+08             2.7812e-12       -22.826066006100  <--
     2.3842e+08     2.3842e+09             6.9440e-13       -22.826066006100

*****************************************************************************
Applying the update for shift_i =   5.9605e+07     and shift_s =   5.9605e+08
*****************************************************************************

  Execution time = 1.0942e+02
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1468e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7444
    reference variance = 0.44533
====================================================
  Execution time = 7.9506e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0864e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6819e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508510916813
                                         uncertainty =       0.004928160399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508510916813
                                         uncertainty =       0.004928160399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504300873
  error estimate for blocks of size 2^( 2) =       0.000522363287
  error estimate for blocks of size 2^( 3) =       0.000537417482
  error estimate for blocks of size 2^( 4) =       0.000547319761
  error estimate for blocks of size 2^( 5) =       0.000553979125
  error estimate for blocks of size 2^( 6) =       0.000557244066
  error estimate for blocks of size 2^( 7) =       0.000557655515

      target function =                  N/A
              le_mean =     -22.825886128126
             les_mean =     521.529716020100
             stat err =       0.000554049617
             autocorr =       1.207029483214
              std dev =       0.713189133558
             le_variance =       0.508638740225


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282588612813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825886128126       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825886128126       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825886128126       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825886127937       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825886128131       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825886123711       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825886120385       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825886135029       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825886131870       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825886146604       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+07 is 9.336876e-12

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825886128126       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825886128126       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825886128126       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825886129161       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825886132258       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825886128752       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825886160361       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825886063829       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825886158861       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825886094517       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+07 is 2.334321e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825886128126       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825886128126       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825886128126       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825886128126       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825886128126       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825886128126       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825886159372       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825886069523       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825886041988       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825886165734       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+08 is 5.835389e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187438 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0633e+02
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8156
    reference variance = 0.34311
====================================================
  Execution time = 7.7033e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0429e-01
  Total weights = 2.0000e+06
  Execution time = 6.2853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504240599043
                                         uncertainty =       0.003154875332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504240599043
                                         uncertainty =       0.003154875332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502138678
  error estimate for blocks of size 2^( 2) =       0.000519818980
  error estimate for blocks of size 2^( 3) =       0.000535932569
  error estimate for blocks of size 2^( 4) =       0.000547309816
  error estimate for blocks of size 2^( 5) =       0.000554781994
  error estimate for blocks of size 2^( 6) =       0.000559072857
  error estimate for blocks of size 2^( 7) =       0.000559545256

      target function =                  N/A
              le_mean =     -22.825730843853
             les_mean =     521.518274807154
             stat err =       0.000555177481
             autocorr =       1.222408425774
              std dev =       0.710131328199
             le_variance =       0.504286503290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504240599042
                                         uncertainty =       0.003154875332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504240599042
                                         uncertainty =       0.003154875332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502138678
  error estimate for blocks of size 2^( 2) =       0.000519818980
  error estimate for blocks of size 2^( 3) =       0.000535932569
  error estimate for blocks of size 2^( 4) =       0.000547309816
  error estimate for blocks of size 2^( 5) =       0.000554781994
  error estimate for blocks of size 2^( 6) =       0.000559072857
  error estimate for blocks of size 2^( 7) =       0.000559545256

      target function =                  N/A
              le_mean =     -22.825730843853
             les_mean =     521.518274807153
             stat err =       0.000555177481
             autocorr =       1.222408425764
              std dev =       0.710131328198
             le_variance =       0.504286503288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504240599043
                                         uncertainty =       0.003154875332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504240599043
                                         uncertainty =       0.003154875332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502138678
  error estimate for blocks of size 2^( 2) =       0.000519818980
  error estimate for blocks of size 2^( 3) =       0.000535932569
  error estimate for blocks of size 2^( 4) =       0.000547309816
  error estimate for blocks of size 2^( 5) =       0.000554781994
  error estimate for blocks of size 2^( 6) =       0.000559072857
  error estimate for blocks of size 2^( 7) =       0.000559545256

      target function =                  N/A
              le_mean =     -22.825730843853
             les_mean =     521.518274807153
             stat err =       0.000555177481
             autocorr =       1.222408425770
              std dev =       0.710131328199
             le_variance =       0.504286503289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504240599043
                                         uncertainty =       0.003154875332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504240599043
                                         uncertainty =       0.003154875332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502138678
  error estimate for blocks of size 2^( 2) =       0.000519818980
  error estimate for blocks of size 2^( 3) =       0.000535932569
  error estimate for blocks of size 2^( 4) =       0.000547309816
  error estimate for blocks of size 2^( 5) =       0.000554781994
  error estimate for blocks of size 2^( 6) =       0.000559072857
  error estimate for blocks of size 2^( 7) =       0.000559545256

      target function =                  N/A
              le_mean =     -22.825730843853
             les_mean =     521.518274807154
             stat err =       0.000555177481
             autocorr =       1.222408425767
              std dev =       0.710131328199
             le_variance =       0.504286503290


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825730843853        initial
     1.4901e+07     1.4901e+08             9.3369e-12       -22.825730843853
     5.9605e+07     5.9605e+08             2.3343e-12       -22.825730843853  <--
     2.3842e+08     2.3842e+09             5.8354e-13       -22.825730843853

*****************************************************************************
Applying the update for shift_i =   5.9605e+07     and shift_s =   5.9605e+08
*****************************************************************************

  Execution time = 1.0858e+02
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1492e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7942
    reference variance = 0.348985
====================================================
  Execution time = 7.7613e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0691e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6974e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507015463444
                                         uncertainty =       0.004316569481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507015463444
                                         uncertainty =       0.004316569481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503443287
  error estimate for blocks of size 2^( 2) =       0.000521184928
  error estimate for blocks of size 2^( 3) =       0.000537236145
  error estimate for blocks of size 2^( 4) =       0.000548430998
  error estimate for blocks of size 2^( 5) =       0.000555763164
  error estimate for blocks of size 2^( 6) =       0.000559327734
  error estimate for blocks of size 2^( 7) =       0.000559915065

      target function =                  N/A
              le_mean =     -22.825228313977
             les_mean =     521.497957618343
             stat err =       0.000555859240
             autocorr =       1.219069737462
              std dev =       0.711976324471
             le_variance =       0.506910286607


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282522831398e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825228313977       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825228313977       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825228313977       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825228319028       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825228313987       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825228324187       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825228312667       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825228309361       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825228299680       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825228336224       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+07 is 1.165987e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825228313977       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825228313977       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825228313977       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825228313733       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825228289283       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825228282808       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825228287816       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825228248726       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825228297075       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825228313345       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+07 is 2.915409e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825228313977       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825228313977       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825228313977       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825228313977       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825228266025       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825228311744       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825228322384       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825228412002       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825228325436       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825228343735       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+08 is 7.286661e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0460e+02
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8119
    reference variance = 0.410247
====================================================
  Execution time = 7.9439e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9703e-01
  Total weights = 2.0000e+06
  Execution time = 6.2801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497051661866
                                         uncertainty =       0.004196544792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497051661866
                                         uncertainty =       0.004196544792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498513181
  error estimate for blocks of size 2^( 2) =       0.000516574331
  error estimate for blocks of size 2^( 3) =       0.000532458335
  error estimate for blocks of size 2^( 4) =       0.000543699878
  error estimate for blocks of size 2^( 5) =       0.000549567342
  error estimate for blocks of size 2^( 6) =       0.000555419103
  error estimate for blocks of size 2^( 7) =       0.000556022983

      target function =                  N/A
              le_mean =     -22.825164761636
             les_mean =     521.485176930991
             stat err =       0.000551177326
             autocorr =       1.222445189386
              std dev =       0.705004101889
             le_variance =       0.497030783681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497051661867
                                         uncertainty =       0.004196544792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497051661867
                                         uncertainty =       0.004196544792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498513181
  error estimate for blocks of size 2^( 2) =       0.000516574331
  error estimate for blocks of size 2^( 3) =       0.000532458335
  error estimate for blocks of size 2^( 4) =       0.000543699878
  error estimate for blocks of size 2^( 5) =       0.000549567342
  error estimate for blocks of size 2^( 6) =       0.000555419103
  error estimate for blocks of size 2^( 7) =       0.000556022983

      target function =                  N/A
              le_mean =     -22.825164761636
             les_mean =     521.485176930991
             stat err =       0.000551177326
             autocorr =       1.222445189377
              std dev =       0.705004101890
             le_variance =       0.497030783682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497051661867
                                         uncertainty =       0.004196544792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497051661867
                                         uncertainty =       0.004196544792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498513181
  error estimate for blocks of size 2^( 2) =       0.000516574331
  error estimate for blocks of size 2^( 3) =       0.000532458335
  error estimate for blocks of size 2^( 4) =       0.000543699878
  error estimate for blocks of size 2^( 5) =       0.000549567342
  error estimate for blocks of size 2^( 6) =       0.000555419103
  error estimate for blocks of size 2^( 7) =       0.000556022983

      target function =                  N/A
              le_mean =     -22.825164761636
             les_mean =     521.485176930991
             stat err =       0.000551177326
             autocorr =       1.222445189382
              std dev =       0.705004101890
             le_variance =       0.497030783681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497051661866
                                         uncertainty =       0.004196544792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497051661866
                                         uncertainty =       0.004196544792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498513181
  error estimate for blocks of size 2^( 2) =       0.000516574331
  error estimate for blocks of size 2^( 3) =       0.000532458335
  error estimate for blocks of size 2^( 4) =       0.000543699878
  error estimate for blocks of size 2^( 5) =       0.000549567342
  error estimate for blocks of size 2^( 6) =       0.000555419103
  error estimate for blocks of size 2^( 7) =       0.000556022983

      target function =                  N/A
              le_mean =     -22.825164761636
             les_mean =     521.485176930991
             stat err =       0.000551177326
             autocorr =       1.222445189383
              std dev =       0.705004101889
             le_variance =       0.497030783680


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825164761636        initial
     1.4901e+07     1.4901e+08             1.1660e-11       -22.825164761636
     5.9605e+07     5.9605e+08             2.9154e-12       -22.825164761636
     2.3842e+08     2.3842e+09             7.2867e-13       -22.825164761636  <--

*****************************************************************************
Applying the update for shift_i =   2.3842e+08     and shift_s =   2.3842e+09
*****************************************************************************

  Execution time = 1.1092e+02
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1552e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8482
    reference variance = 0.473093
====================================================
  Execution time = 7.7670e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0720e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6539e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507218970631
                                         uncertainty =       0.004232370100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507218970631
                                         uncertainty =       0.004232370100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503589065
  error estimate for blocks of size 2^( 2) =       0.000521514597
  error estimate for blocks of size 2^( 3) =       0.000536872336
  error estimate for blocks of size 2^( 4) =       0.000547671879
  error estimate for blocks of size 2^( 5) =       0.000552800125
  error estimate for blocks of size 2^( 6) =       0.000555202280
  error estimate for blocks of size 2^( 7) =       0.000556036841

      target function =                  N/A
              le_mean =     -22.825754496390
             les_mean =     521.522271968813
             stat err =       0.000552927781
             autocorr =       1.205547258608
              std dev =       0.712182485715
             le_variance =       0.507203892959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282575449639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825754496390       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825754496390       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825754496390       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825754496390       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825754496337       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825754502545       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825754513498       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825754501215       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825754490434       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825754503331       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+07 is 2.646224e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825754496390       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825754496390       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825754496390       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825754496390       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825754477713       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825754360610       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825754396183       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825754592176       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825754044812       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825754381637       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+08 is 6.622444e-13

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825754496390       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825754496390       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825754496390       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825754496390       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825754281164       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825754496390       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825754582031       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825754198970       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825754626656       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825753710067       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+08 is 1.655167e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194526 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.0422e+02
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8125
    reference variance = 0.278704
====================================================
  Execution time = 7.7415e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1331e-01
  Total weights = 2.0000e+06
  Execution time = 6.3217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513415637665
                                         uncertainty =       0.005845727161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513415637665
                                         uncertainty =       0.005845727161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506611352
  error estimate for blocks of size 2^( 2) =       0.000524229004
  error estimate for blocks of size 2^( 3) =       0.000539598560
  error estimate for blocks of size 2^( 4) =       0.000550393472
  error estimate for blocks of size 2^( 5) =       0.000557454409
  error estimate for blocks of size 2^( 6) =       0.000562457707
  error estimate for blocks of size 2^( 7) =       0.000563440643

      target function =                  N/A
              le_mean =     -22.825487343352
             les_mean =     521.516182329718
             stat err =       0.000558436558
             autocorr =       1.215060347023
              std dev =       0.716456645473
             le_variance =       0.513310124842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513415637664
                                         uncertainty =       0.005845727161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513415637664
                                         uncertainty =       0.005845727161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506611352
  error estimate for blocks of size 2^( 2) =       0.000524229004
  error estimate for blocks of size 2^( 3) =       0.000539598560
  error estimate for blocks of size 2^( 4) =       0.000550393472
  error estimate for blocks of size 2^( 5) =       0.000557454409
  error estimate for blocks of size 2^( 6) =       0.000562457707
  error estimate for blocks of size 2^( 7) =       0.000563440643

      target function =                  N/A
              le_mean =     -22.825487343352
             les_mean =     521.516182329719
             stat err =       0.000558436558
             autocorr =       1.215060347019
              std dev =       0.716456645472
             le_variance =       0.513310124841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513415637665
                                         uncertainty =       0.005845727161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513415637665
                                         uncertainty =       0.005845727161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506611352
  error estimate for blocks of size 2^( 2) =       0.000524229004
  error estimate for blocks of size 2^( 3) =       0.000539598560
  error estimate for blocks of size 2^( 4) =       0.000550393472
  error estimate for blocks of size 2^( 5) =       0.000557454409
  error estimate for blocks of size 2^( 6) =       0.000562457707
  error estimate for blocks of size 2^( 7) =       0.000563440643

      target function =                  N/A
              le_mean =     -22.825487343352
             les_mean =     521.516182329719
             stat err =       0.000558436558
             autocorr =       1.215060347018
              std dev =       0.716456645473
             le_variance =       0.513310124842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513415637665
                                         uncertainty =       0.005845727161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513415637665
                                         uncertainty =       0.005845727161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506611352
  error estimate for blocks of size 2^( 2) =       0.000524229004
  error estimate for blocks of size 2^( 3) =       0.000539598560
  error estimate for blocks of size 2^( 4) =       0.000550393472
  error estimate for blocks of size 2^( 5) =       0.000557454409
  error estimate for blocks of size 2^( 6) =       0.000562457707
  error estimate for blocks of size 2^( 7) =       0.000563440643

      target function =                  N/A
              le_mean =     -22.825487343352
             les_mean =     521.516182329718
             stat err =       0.000558436558
             autocorr =       1.215060347024
              std dev =       0.716456645473
             le_variance =       0.513310124842


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825487343352        initial
     5.9605e+07     5.9605e+08             2.6462e-12       -22.825487343352  <--
     2.3842e+08     2.3842e+09             6.6224e-13       -22.825487343352
     9.5367e+08     9.5367e+09             1.6552e-13       -22.825487343352

*****************************************************************************
Applying the update for shift_i =   5.9605e+07     and shift_s =   5.9605e+08
*****************************************************************************

  Execution time = 1.0903e+02
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.654974e-01 1 1  ON 0
 uu_1                 9.170594e-02 1 1  ON 1
 uu_2                -1.975715e-02 1 1  ON 2
 uu_3                -8.528516e-02 1 1  ON 3
 uu_4                -1.232772e-01 1 1  ON 4
 uu_5                -1.465767e-01 1 1  ON 5
 uu_6                -1.600398e-01 1 1  ON 6
 uu_7                -1.633824e-01 1 1  ON 7
 uu_8                -1.534162e-01 1 1  ON 8
 uu_9                -1.270907e-01 1 1  ON 9
 ud_0                 4.368733e-01 1 1  ON 10
 ud_1                 1.545023e-01 1 1  ON 11
 ud_2                 8.764267e-03 1 1  ON 12
 ud_3                -7.123139e-02 1 1  ON 13
 ud_4                -1.185761e-01 1 1  ON 14
 ud_5                -1.486690e-01 1 1  ON 15
 ud_6                -1.670504e-01 1 1  ON 16
 ud_7                -1.741044e-01 1 1  ON 17
 ud_8                -1.666340e-01 1 1  ON 18
 ud_9                -1.429877e-01 1 1  ON 19
 eC_0                -5.742435e-01 1 1  ON 20
 eC_1                -4.192911e-01 1 1  ON 21
 eC_2                -1.694624e-01 1 1  ON 22
 eC_3                -2.220397e-02 1 1  ON 23
 eC_4                 2.711113e-02 1 1  ON 24
 eC_5                 1.130696e-01 1 1  ON 25
 eC_6                 2.307213e-01 1 1  ON 26
 eC_7                 4.089951e-01 1 1  ON 27
 eC_8                 3.137885e-01 1 1  ON 28
 eC_9                 8.145003e-02 1 1  ON 29
 eO_0                -1.259695e+00 1 1  ON 30
 eO_1                -8.815057e-01 1 1  ON 31
 eO_2                -4.018507e-01 1 1  ON 32
 eO_3                -5.536800e-02 1 1  ON 33
 eO_4                 1.756806e-01 1 1  ON 34
 eO_5                 3.636776e-01 1 1  ON 35
 eO_6                 4.605334e-01 1 1  ON 36
 eO_7                 5.331916e-01 1 1  ON 37
 eO_8                 5.129014e-01 1 1  ON 38
 eO_9                 3.639295e-01 1 1  ON 39
eH1_0                -1.867327e-01 1 1  ON 40
eH1_1                -9.999217e-02 1 1  ON 41
eH1_2                -6.661746e-02 1 1  ON 42
eH1_3                -5.062825e-02 1 1  ON 43
eH1_4                 1.046349e-02 1 1  ON 44
eH1_5                 6.751821e-02 1 1  ON 45
eH1_6                 1.248575e-01 1 1  ON 46
eH1_7                 1.027475e-01 1 1  ON 47
eH1_8                 8.599780e-03 1 1  ON 48
eH1_9                -2.321942e-02 1 1  ON 49
eH2_0                -1.887088e-01 1 1  ON 50
eH2_1                -1.014491e-01 1 1  ON 51
eH2_2                -6.865641e-02 1 1  ON 52
eH2_3                -5.301690e-02 1 1  ON 53
eH2_4                 7.624756e-03 1 1  ON 54
eH2_5                 6.477017e-02 1 1  ON 55
eH2_6                 1.222933e-01 1 1  ON 56
eH2_7                 1.005929e-01 1 1  ON 57
eH2_8                 9.566155e-03 1 1  ON 58
eH2_9                -8.648370e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.1325e+02 secs
  Total Execution time = 8.5978e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
