Rank =    0  Free Memory = 74614 MB
Rank =    1  Free Memory = 74614 MB
Rank =    2  Free Memory = 74614 MB
Rank =    3  Free Memory = 74614 MB
Rank =    4  Free Memory = 74614 MB
Rank =    5  Free Memory = 74613 MB
Rank =    6  Free Memory = 74613 MB
Rank =    7  Free Memory = 74613 MB
Rank =    8  Free Memory = 74613 MB
Rank =    9  Free Memory = 74613 MB
Rank =   10  Free Memory = 74613 MB
Rank =   11  Free Memory = 74613 MB
Rank =   12  Free Memory = 74613 MB
Rank =   13  Free Memory = 74612 MB
Rank =   14  Free Memory = 74612 MB
Rank =   15  Free Memory = 74597 MB
Rank =   16  Free Memory = 74597 MB
Rank =   17  Free Memory = 74597 MB
Rank =   18  Free Memory = 74597 MB
Rank =   19  Free Memory = 74597 MB
Rank =   20  Free Memory = 74597 MB
Rank =   21  Free Memory = 74597 MB
Rank =   22  Free Memory = 74597 MB
Rank =   23  Free Memory = 74597 MB
Rank =   24  Free Memory = 74597 MB
Rank =   25  Free Memory = 74597 MB
Rank =   26  Free Memory = 74597 MB
Rank =   27  Free Memory = 74597 MB
Rank =   28  Free Memory = 74597 MB
Rank =   29  Free Memory = 74597 MB
Rank =   30  Free Memory = 74597 MB
Rank =   31  Free Memory = 74597 MB
Rank =   32  Free Memory = 73749 MB
Rank =   33  Free Memory = 73749 MB
Rank =   34  Free Memory = 73749 MB
Rank =   35  Free Memory = 73749 MB
Rank =   36  Free Memory = 73749 MB
Rank =   37  Free Memory = 73749 MB
Rank =   38  Free Memory = 73749 MB
Rank =   39  Free Memory = 73749 MB
Rank =   40  Free Memory = 73749 MB
Rank =   41  Free Memory = 73748 MB
Rank =   42  Free Memory = 73748 MB
Rank =   43  Free Memory = 73748 MB
Rank =   44  Free Memory = 73748 MB
Rank =   45  Free Memory = 73748 MB
Rank =   46  Free Memory = 73748 MB
Rank =   47  Free Memory = 73748 MB
Rank =   48  Free Memory = 73748 MB
Rank =   49  Free Memory = 73748 MB
Rank =   50  Free Memory = 73748 MB
Rank =   51  Free Memory = 73748 MB
Rank =   52  Free Memory = 73748 MB
Rank =   53  Free Memory = 73748 MB
Rank =   54  Free Memory = 73748 MB
Rank =   55  Free Memory = 73748 MB
Rank =   56  Free Memory = 73747 MB
Rank =   57  Free Memory = 73747 MB
Rank =   58  Free Memory = 73747 MB
Rank =   59  Free Memory = 73747 MB
Rank =   60  Free Memory = 73747 MB
Rank =   61  Free Memory = 73747 MB
Rank =   62  Free Memory = 73747 MB
Rank =   63  Free Memory = 73747 MB
Rank =   64  Free Memory = 78820 MB
Rank =   65  Free Memory = 78820 MB
Rank =   66  Free Memory = 78820 MB
Rank =   67  Free Memory = 78820 MB
Rank =   68  Free Memory = 78820 MB
Rank =   69  Free Memory = 78820 MB
Rank =   70  Free Memory = 78820 MB
Rank =   71  Free Memory = 78820 MB
Rank =   72  Free Memory = 78820 MB
Rank =   73  Free Memory = 78820 MB
Rank =   74  Free Memory = 78820 MB
Rank =   75  Free Memory = 78820 MB
Rank =   76  Free Memory = 78820 MB
Rank =   77  Free Memory = 78820 MB
Rank =   78  Free Memory = 78820 MB
Rank =   79  Free Memory = 78820 MB
Rank =   80  Free Memory = 78820 MB
Rank =   81  Free Memory = 78820 MB
Rank =   82  Free Memory = 78820 MB
Rank =   83  Free Memory = 78820 MB
Rank =   84  Free Memory = 78820 MB
Rank =   85  Free Memory = 78820 MB
Rank =   86  Free Memory = 78820 MB
Rank =   87  Free Memory = 78820 MB
Rank =   88  Free Memory = 78820 MB
Rank =   89  Free Memory = 78820 MB
Rank =   90  Free Memory = 78820 MB
Rank =   91  Free Memory = 78820 MB
Rank =   92  Free Memory = 78820 MB
Rank =   93  Free Memory = 78820 MB
Rank =   94  Free Memory = 78820 MB
Rank =   95  Free Memory = 78820 MB
Rank =   96  Free Memory = 77241 MB
Rank =   97  Free Memory = 77241 MB
Rank =   98  Free Memory = 77241 MB
Rank =   99  Free Memory = 77241 MB
Rank =  100  Free Memory = 77241 MB
Rank =  101  Free Memory = 77241 MB
Rank =  102  Free Memory = 77241 MB
Rank =  103  Free Memory = 77241 MB
Rank =  104  Free Memory = 77241 MB
Rank =  105  Free Memory = 77241 MB
Rank =  106  Free Memory = 77241 MB
Rank =  107  Free Memory = 77241 MB
Rank =  108  Free Memory = 77241 MB
Rank =  109  Free Memory = 77241 MB
Rank =  110  Free Memory = 77241 MB
Rank =  111  Free Memory = 77241 MB
Rank =  112  Free Memory = 77241 MB
Rank =  113  Free Memory = 77241 MB
Rank =  114  Free Memory = 77241 MB
Rank =  115  Free Memory = 77241 MB
Rank =  116  Free Memory = 77241 MB
Rank =  117  Free Memory = 77241 MB
Rank =  118  Free Memory = 77241 MB
Rank =  119  Free Memory = 77241 MB
Rank =  120  Free Memory = 77241 MB
Rank =  121  Free Memory = 77241 MB
Rank =  122  Free Memory = 77241 MB
Rank =  123  Free Memory = 77241 MB
Rank =  124  Free Memory = 77241 MB
Rank =  125  Free Memory = 77241 MB
Rank =  126  Free Memory = 77241 MB
Rank =  127  Free Memory = 77241 MB
  Input file(s): opt_h2o_gs_gvptt_48dets_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_48dets_run001b.xml

  Project = H2O
  date    = 2023-05-11 02:49:14 PDT
  host    = n0029.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 538

  Range of prime numbers to use as seeds over processors and threads = 3907-4993


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1  ON     0
     uu_1                 3.590195e-02    1         1  ON     1
     uu_2                -4.559320e-02    1         1  ON     2
     uu_3                -9.369633e-02    1         1  ON     3
     uu_4                -1.254424e-01    1         1  ON     4
     uu_5                -1.327025e-01    1         1  ON     5
     uu_6                -1.091659e-01    1         1  ON     6
     uu_7                -3.320891e-02    1         1  ON     7
     uu_8                 1.030981e-01    1         1  ON     8
     uu_9                 1.188130e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1  ON     0
     ud_1                 7.590189e-02    1         1  ON     1
     ud_2                -7.338664e-03    1         1  ON     2
     ud_3                -5.544926e-02    1         1  ON     3
     ud_4                -1.064782e-01    1         1  ON     4
     ud_5                -1.490405e-01    1         1  ON     5
     ud_6                -1.574171e-01    1         1  ON     6
     ud_7                -1.077761e-01    1         1  ON     7
     ud_8                 9.772284e-03    1         1  ON     8
     ud_9                 9.249491e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1  ON     0
     eO_1                -4.031104e-01    1         1  ON     1
     eO_2                -6.148616e-02    1         1  ON     2
     eO_3                 1.622033e-01    1         1  ON     3
     eO_4                 2.643764e-01    1         1  ON     4
     eO_5                 3.070668e-01    1         1  ON     5
     eO_6                 2.482256e-01    1         1  ON     6
     eO_7                 1.081366e-01    1         1  ON     7
     eO_8                 2.727328e-02    1         1  ON     8
     eO_9                 1.812982e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1  ON     0
     eH1_1                -9.847470e-02    1         1  ON     1
     eH1_2                -6.212571e-02    1         1  ON     2
     eH1_3                -2.890051e-02    1         1  ON     3
     eH1_4                 1.766763e-02    1         1  ON     4
     eH1_5                 3.105966e-02    1         1  ON     5
     eH1_6                 7.793809e-02    1         1  ON     6
     eH1_7                 1.115220e-01    1         1  ON     7
     eH1_8                 8.853209e-02    1         1  ON     8
     eH1_9                 2.358450e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1  ON     0
     eH2_1                -1.001865e-01    1         1  ON     1
     eH2_2                -6.424989e-02    1         1  ON     2
     eH2_3                -3.037191e-02    1         1  ON     3
     eH2_4                 1.621523e-02    1         1  ON     4
     eH2_5                 3.146665e-02    1         1  ON     5
     eH2_6                 8.031567e-02    1         1  ON     6
     eH2_7                 1.152651e-01    1         1  ON     7
     eH2_8                 9.158550e-02    1         1  ON     8
     eH2_9                 2.561491e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 48 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.723602e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 19 unique up determinants.
Found 19 unique down determinants.
Number of terms in pairs array: 18
Number of terms in pairs array: 18
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.8770e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1959
    reference variance = 0.369122
====================================================
  Execution time = 3.2922e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3340e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333515480077
                                         uncertainty =       0.011663315443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333515480077
                                         uncertainty =       0.011663315443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408286245
  error estimate for blocks of size 2^( 2) =       0.000420520732
  error estimate for blocks of size 2^( 3) =       0.000431658364
  error estimate for blocks of size 2^( 4) =       0.000439435724
  error estimate for blocks of size 2^( 5) =       0.000444792934
  error estimate for blocks of size 2^( 6) =       0.000448267881
  error estimate for blocks of size 2^( 7) =       0.000449809745

      target function =                  N/A
              le_mean =     -17.211246031508
             les_mean =     296.560385106802
             stat err =       0.000445576571
             autocorr =       1.191009417429
              std dev =       0.577403945617
             le_variance =       0.333395316414


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721124603151e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211246031508       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211708823188       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211926350873       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212215553951       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212375477744       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212459111435       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212466333639       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212474760580       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212478541098       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212480632064       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212481184713       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212480477421       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.212480429296       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.990643e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211246031508       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211451254354       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211541479478       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211667625893       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211736563481       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211763296519       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211762224257       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211764405613       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211763915734       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211763975456       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211764119793       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211764092609       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 6.427777e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211246031508       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211309641255       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211337568535       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211378053906       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211398298895       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211404639575       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211405185760       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211405336816       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211405336950       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211405244171       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211405255424       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.876747e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3455e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.933228e-01                 1 1 ON  0
uu_1  3.761433e-02                 1 1 ON  1
uu_2  -4.685239e-02                1 1 ON  2
uu_3  -9.466971e-02                1 1 ON  3
uu_4  -1.254327e-01                1 1 ON  4
uu_5  -1.328127e-01                1 1 ON  5
uu_6  -1.095249e-01                1 1 ON  6
uu_7  -3.353920e-02                1 1 ON  7
uu_8  1.029617e-01                 1 1 ON  8
uu_9  1.188541e-01                 1 1 ON  9
ud_0  3.207185e-01                 1 1 ON  10
ud_1  7.804029e-02                 1 1 ON  11
ud_2  -1.084121e-02                1 1 ON  12
ud_3  -5.844077e-02                1 1 ON  13
ud_4  -1.072356e-01                1 1 ON  14
ud_5  -1.486879e-01                1 1 ON  15
ud_6  -1.576955e-01                1 1 ON  16
ud_7  -1.082103e-01                1 1 ON  17
ud_8  9.530153e-03                 1 1 ON  18
ud_9  9.249371e-02                 1 1 ON  19
eO_0  -6.875972e-01                1 1 ON  20
eO_1  -4.053698e-01                1 1 ON  21
eO_2  -5.521530e-02                1 1 ON  22
eO_3  1.654503e-01                 1 1 ON  23
eO_4  2.640994e-01                 1 1 ON  24
eO_5  3.064489e-01                 1 1 ON  25
eO_6  2.481733e-01                 1 1 ON  26
eO_7  1.082240e-01                 1 1 ON  27
eO_8  2.728579e-02                 1 1 ON  28
eO_9  1.813462e-02                 1 1 ON  29
eH1_0 -1.761122e-01                1 1 ON  30
eH1_1 -9.860912e-02                1 1 ON  31
eH1_2 -6.249772e-02                1 1 ON  32
eH1_3 -2.821596e-02                1 1 ON  33
eH1_4 1.808837e-02                 1 1 ON  34
eH1_5 3.113936e-02                 1 1 ON  35
eH1_6 7.760704e-02                 1 1 ON  36
eH1_7 1.113942e-01                 1 1 ON  37
eH1_8 8.857120e-02                 1 1 ON  38
eH1_9 2.360787e-02                 1 1 ON  39
eH2_0 -1.778028e-01                1 1 ON  40
eH2_1 -1.002079e-01                1 1 ON  41
eH2_2 -6.447283e-02                1 1 ON  42
eH2_3 -2.979558e-02                1 1 ON  43
eH2_4 1.662633e-02                 1 1 ON  44
eH2_5 3.138606e-02                 1 1 ON  45
eH2_6 7.994114e-02                 1 1 ON  46
eH2_7 1.151571e-01                 1 1 ON  47
eH2_8 9.165381e-02                 1 1 ON  48
eH2_9 2.563263e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1475
    reference variance = 0.230122
====================================================
  Execution time = 3.2654e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0592e-01
  Total weights = 2.0000e+06
  Execution time = 2.8558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304923567337
                                         uncertainty =       0.002512416484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304923567337
                                         uncertainty =       0.002512416484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390458756
  error estimate for blocks of size 2^( 2) =       0.000403174367
  error estimate for blocks of size 2^( 3) =       0.000413895031
  error estimate for blocks of size 2^( 4) =       0.000421885610
  error estimate for blocks of size 2^( 5) =       0.000426647321
  error estimate for blocks of size 2^( 6) =       0.000429078443
  error estimate for blocks of size 2^( 7) =       0.000430499954

      target function =                  N/A
              le_mean =     -17.211769123872
             les_mean =     296.549912301275
             stat err =       0.000427027832
             autocorr =       1.196084964241
              std dev =       0.552192068259
             le_variance =       0.304916080248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310276957770
                                         uncertainty =       0.002604779924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310276957770
                                         uncertainty =       0.002604779924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393867534
  error estimate for blocks of size 2^( 2) =       0.000405107021
  error estimate for blocks of size 2^( 3) =       0.000414764329
  error estimate for blocks of size 2^( 4) =       0.000422098815
  error estimate for blocks of size 2^( 5) =       0.000426364417
  error estimate for blocks of size 2^( 6) =       0.000428840472
  error estimate for blocks of size 2^( 7) =       0.000430160568

      target function =                  N/A
              le_mean =     -17.211968003829
             les_mean =     296.562105678775
             stat err =       0.000426866068
             autocorr =       1.174580804231
              std dev =       0.557012808724
             le_variance =       0.310263269083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308689571426
                                         uncertainty =       0.002585204861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308689571426
                                         uncertainty =       0.002585204861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392859166
  error estimate for blocks of size 2^( 2) =       0.000404355988
  error estimate for blocks of size 2^( 3) =       0.000414212453
  error estimate for blocks of size 2^( 4) =       0.000421683558
  error estimate for blocks of size 2^( 5) =       0.000426033644
  error estimate for blocks of size 2^( 6) =       0.000428507928
  error estimate for blocks of size 2^( 7) =       0.000429843987

      target function =                  N/A
              le_mean =     -17.211850160574
             les_mean =     296.556462443794
             stat err =       0.000426517279
             autocorr =       1.178689677815
              std dev =       0.555586760181
             le_variance =       0.308676648088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305003149338
                                         uncertainty =       0.002522349478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305003149338
                                         uncertainty =       0.002522349478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390509158
  error estimate for blocks of size 2^( 2) =       0.000403018394
  error estimate for blocks of size 2^( 3) =       0.000413595552
  error estimate for blocks of size 2^( 4) =       0.000421503301
  error estimate for blocks of size 2^( 5) =       0.000426199200
  error estimate for blocks of size 2^( 6) =       0.000428634219
  error estimate for blocks of size 2^( 7) =       0.000430043716

      target function =                  N/A
              le_mean =     -17.211717296112
             les_mean =     296.548206933679
             stat err =       0.000426595109
             autocorr =       1.193354012245
              std dev =       0.552263347399
             le_variance =       0.304994804880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211769123872        initial
     2.5000e-01     2.5000e+00             1.9906e-02       -17.211968003829  <--
     1.0000e+00     1.0000e+01             6.4278e-03       -17.211850160574
     4.0000e+00     4.0000e+01             1.8767e-03       -17.211717296112

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.7075e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.967227e-01 1 1  ON 0
 uu_1                 3.996129e-02 1 1  ON 1
 uu_2                -4.822887e-02 1 1  ON 2
 uu_3                -9.676371e-02 1 1  ON 3
 uu_4                -1.263220e-01 1 1  ON 4
 uu_5                -1.330192e-01 1 1  ON 5
 uu_6                -1.100484e-01 1 1  ON 6
 uu_7                -3.427406e-02 1 1  ON 7
 uu_8                 1.026240e-01 1 1  ON 8
 uu_9                 1.189960e-01 1 1  ON 9
 ud_0                 3.293962e-01 1 1  ON 10
 ud_1                 8.095377e-02 1 1  ON 11
 ud_2                -1.478653e-02 1 1  ON 12
 ud_3                -6.391457e-02 1 1  ON 13
 ud_4                -1.095804e-01 1 1  ON 14
 ud_5                -1.478172e-01 1 1  ON 15
 ud_6                -1.573282e-01 1 1  ON 16
 ud_7                -1.089453e-01 1 1  ON 17
 ud_8                 8.935699e-03 1 1  ON 18
 ud_9                 9.251935e-02 1 1  ON 19
 eO_0                -7.010758e-01 1 1  ON 20
 eO_1                -4.099668e-01 1 1  ON 21
 eO_2                -4.585718e-02 1 1  ON 22
 eO_3                 1.740170e-01 1 1  ON 23
 eO_4                 2.650117e-01 1 1  ON 24
 eO_5                 3.052749e-01 1 1  ON 25
 eO_6                 2.481778e-01 1 1  ON 26
 eO_7                 1.085302e-01 1 1  ON 27
 eO_8                 2.733349e-02 1 1  ON 28
 eO_9                 1.815141e-02 1 1  ON 29
eH1_0                -1.770844e-01 1 1  ON 30
eH1_1                -9.938698e-02 1 1  ON 31
eH1_2                -6.269674e-02 1 1  ON 32
eH1_3                -2.725303e-02 1 1  ON 33
eH1_4                 1.886128e-02 1 1  ON 34
eH1_5                 3.195400e-02 1 1  ON 35
eH1_6                 7.704316e-02 1 1  ON 36
eH1_7                 1.111164e-01 1 1  ON 37
eH1_8                 8.871211e-02 1 1  ON 38
eH1_9                 2.368371e-02 1 1  ON 39
eH2_0                -1.786818e-01 1 1  ON 40
eH2_1                -1.007251e-01 1 1  ON 41
eH2_2                -6.439697e-02 1 1  ON 42
eH2_3                -2.897299e-02 1 1  ON 43
eH2_4                 1.733628e-02 1 1  ON 44
eH2_5                 3.177780e-02 1 1  ON 45
eH2_6                 7.923302e-02 1 1  ON 46
eH2_7                 1.149339e-01 1 1  ON 47
eH2_8                 9.188318e-02 1 1  ON 48
eH2_9                 2.569238e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.0536e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7172e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1877
    reference variance = 0.619425
====================================================
  Execution time = 3.2841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1983e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319886137710
                                         uncertainty =       0.005407328723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319886137710
                                         uncertainty =       0.005407328723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399896775
  error estimate for blocks of size 2^( 2) =       0.000411043909
  error estimate for blocks of size 2^( 3) =       0.000420794613
  error estimate for blocks of size 2^( 4) =       0.000428195491
  error estimate for blocks of size 2^( 5) =       0.000432439404
  error estimate for blocks of size 2^( 6) =       0.000434305795
  error estimate for blocks of size 2^( 7) =       0.000437197342

      target function =                  N/A
              le_mean =     -17.213000594058
             les_mean =     296.607224151789
             stat err =       0.000433034508
             autocorr =       1.172598163867
              std dev =       0.565539442176
             le_variance =       0.319834860657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721300059406e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213000594058       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213096737103       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213169699146       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213278692909       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213374403621       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213438527414       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213494298996       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213503135608       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213521627425       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213518851122       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213530612465       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213532816065       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213534247618       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213533353097       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213532122896       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213532826851       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213533099581       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.213543e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213000594058       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213064133499       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213105377391       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213173917408       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213231799529       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213253362303       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213265847404       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213269330944       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213273969135       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213272378172       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213272293954       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213273224105       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213273367125       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.326062e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213000594058       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213027557788       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213043600051       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213071649094       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213094301990       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213098474129       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213099711849       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213099917491       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213100709521       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213100464041       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213100496919       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.174112e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1796e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.003224e-01 1 1  ON 0
 uu_1                 4.199923e-02 1 1  ON 1
 uu_2                -4.906105e-02 1 1  ON 2
 uu_3                -9.885737e-02 1 1  ON 3
 uu_4                -1.276925e-01 1 1  ON 4
 uu_5                -1.332592e-01 1 1  ON 5
 uu_6                -1.106395e-01 1 1  ON 6
 uu_7                -3.507733e-02 1 1  ON 7
 uu_8                 1.022153e-01 1 1  ON 8
 uu_9                 1.193005e-01 1 1  ON 9
 ud_0                 3.364141e-01 1 1  ON 10
 ud_1                 8.347581e-02 1 1  ON 11
 ud_2                -1.733776e-02 1 1  ON 12
 ud_3                -6.844862e-02 1 1  ON 13
 ud_4                -1.122377e-01 1 1  ON 14
 ud_5                -1.473384e-01 1 1  ON 15
 ud_6                -1.565915e-01 1 1  ON 16
 ud_7                -1.096398e-01 1 1  ON 17
 ud_8                 8.266988e-03 1 1  ON 18
 ud_9                 9.257871e-02 1 1  ON 19
 eO_0                -7.143364e-01 1 1  ON 20
 eO_1                -4.148443e-01 1 1  ON 21
 eO_2                -3.900115e-02 1 1  ON 22
 eO_3                 1.833630e-01 1 1  ON 23
 eO_4                 2.674107e-01 1 1  ON 24
 eO_5                 3.041056e-01 1 1  ON 25
 eO_6                 2.483154e-01 1 1  ON 26
 eO_7                 1.089576e-01 1 1  ON 27
 eO_8                 2.740241e-02 1 1  ON 28
 eO_9                 1.818944e-02 1 1  ON 29
eH1_0                -1.780863e-01 1 1  ON 30
eH1_1                -1.002670e-01 1 1  ON 31
eH1_2                -6.262938e-02 1 1  ON 32
eH1_3                -2.663858e-02 1 1  ON 33
eH1_4                 1.935051e-02 1 1  ON 34
eH1_5                 3.269083e-02 1 1  ON 35
eH1_6                 7.671173e-02 1 1  ON 36
eH1_7                 1.109280e-01 1 1  ON 37
eH1_8                 8.902393e-02 1 1  ON 38
eH1_9                 2.382814e-02 1 1  ON 39
eH2_0                -1.798064e-01 1 1  ON 40
eH2_1                -1.017751e-01 1 1  ON 41
eH2_2                -6.437967e-02 1 1  ON 42
eH2_3                -2.811874e-02 1 1  ON 43
eH2_4                 1.817515e-02 1 1  ON 44
eH2_5                 3.270471e-02 1 1  ON 45
eH2_6                 7.872981e-02 1 1  ON 46
eH2_7                 1.146729e-01 1 1  ON 47
eH2_8                 9.210127e-02 1 1  ON 48
eH2_9                 2.575523e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1853
    reference variance = 0.227442
====================================================
  Execution time = 3.2292e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1772e-01
  Total weights = 2.0000e+06
  Execution time = 2.8798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312211447715
                                         uncertainty =       0.003616635004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312211447715
                                         uncertainty =       0.003616635004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395047110
  error estimate for blocks of size 2^( 2) =       0.000406511763
  error estimate for blocks of size 2^( 3) =       0.000417000495
  error estimate for blocks of size 2^( 4) =       0.000424309072
  error estimate for blocks of size 2^( 5) =       0.000429743819
  error estimate for blocks of size 2^( 6) =       0.000432845933
  error estimate for blocks of size 2^( 7) =       0.000433299816

      target function =                  N/A
              le_mean =     -17.213740348418
             les_mean =     296.624981064493
             stat err =       0.000430049660
             autocorr =       1.185057544739
              std dev =       0.558680980334
             le_variance =       0.312124437787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323289215312
                                         uncertainty =       0.003781430073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323289215312
                                         uncertainty =       0.003781430073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401991766
  error estimate for blocks of size 2^( 2) =       0.000412650078
  error estimate for blocks of size 2^( 3) =       0.000422360655
  error estimate for blocks of size 2^( 4) =       0.000429061774
  error estimate for blocks of size 2^( 5) =       0.000434311191
  error estimate for blocks of size 2^( 6) =       0.000437064421
  error estimate for blocks of size 2^( 7) =       0.000437128007

      target function =                  N/A
              le_mean =     -17.213676393597
             les_mean =     296.633849581397
             stat err =       0.000434391348
             autocorr =       1.167691230797
              std dev =       0.568502207138
             le_variance =       0.323194759521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325087061798
                                         uncertainty =       0.003811289473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325087061798
                                         uncertainty =       0.003811289473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403107910
  error estimate for blocks of size 2^( 2) =       0.000413735861
  error estimate for blocks of size 2^( 3) =       0.000423432501
  error estimate for blocks of size 2^( 4) =       0.000430125615
  error estimate for blocks of size 2^( 5) =       0.000435394206
  error estimate for blocks of size 2^( 6) =       0.000438057418
  error estimate for blocks of size 2^( 7) =       0.000437992540

      target function =                  N/A
              le_mean =     -17.213728789507
             les_mean =     296.637450650596
             stat err =       0.000435392445
             autocorr =       1.166592383805
              std dev =       0.570080673592
             le_variance =       0.324991974403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314242832630
                                         uncertainty =       0.003656236736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314242832630
                                         uncertainty =       0.003656236736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396329559
  error estimate for blocks of size 2^( 2) =       0.000407595555
  error estimate for blocks of size 2^( 3) =       0.000417910995
  error estimate for blocks of size 2^( 4) =       0.000425091217
  error estimate for blocks of size 2^( 5) =       0.000430493015
  error estimate for blocks of size 2^( 6) =       0.000433493637
  error estimate for blocks of size 2^( 7) =       0.000433826778

      target function =                  N/A
              le_mean =     -17.213659509265
             les_mean =     296.624227782008
             stat err =       0.000430726162
             autocorr =       1.181107900555
              std dev =       0.560494637057
             le_variance =       0.314154238169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213740348418        initial  <--
     6.2500e-02     6.2500e-01             3.2135e-02       -17.213676393597
     2.5000e-01     2.5000e+00             1.3261e-02       -17.213728789507
     1.0000e+00     1.0000e+01             4.1741e-03       -17.213659509265

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.7964
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.967227e-01 1 1  ON 0
 uu_1                 3.996129e-02 1 1  ON 1
 uu_2                -4.822887e-02 1 1  ON 2
 uu_3                -9.676371e-02 1 1  ON 3
 uu_4                -1.263220e-01 1 1  ON 4
 uu_5                -1.330192e-01 1 1  ON 5
 uu_6                -1.100484e-01 1 1  ON 6
 uu_7                -3.427406e-02 1 1  ON 7
 uu_8                 1.026240e-01 1 1  ON 8
 uu_9                 1.189960e-01 1 1  ON 9
 ud_0                 3.293962e-01 1 1  ON 10
 ud_1                 8.095377e-02 1 1  ON 11
 ud_2                -1.478653e-02 1 1  ON 12
 ud_3                -6.391457e-02 1 1  ON 13
 ud_4                -1.095804e-01 1 1  ON 14
 ud_5                -1.478172e-01 1 1  ON 15
 ud_6                -1.573282e-01 1 1  ON 16
 ud_7                -1.089453e-01 1 1  ON 17
 ud_8                 8.935699e-03 1 1  ON 18
 ud_9                 9.251935e-02 1 1  ON 19
 eO_0                -7.010758e-01 1 1  ON 20
 eO_1                -4.099668e-01 1 1  ON 21
 eO_2                -4.585718e-02 1 1  ON 22
 eO_3                 1.740170e-01 1 1  ON 23
 eO_4                 2.650117e-01 1 1  ON 24
 eO_5                 3.052749e-01 1 1  ON 25
 eO_6                 2.481778e-01 1 1  ON 26
 eO_7                 1.085302e-01 1 1  ON 27
 eO_8                 2.733349e-02 1 1  ON 28
 eO_9                 1.815141e-02 1 1  ON 29
eH1_0                -1.770844e-01 1 1  ON 30
eH1_1                -9.938698e-02 1 1  ON 31
eH1_2                -6.269674e-02 1 1  ON 32
eH1_3                -2.725303e-02 1 1  ON 33
eH1_4                 1.886128e-02 1 1  ON 34
eH1_5                 3.195400e-02 1 1  ON 35
eH1_6                 7.704316e-02 1 1  ON 36
eH1_7                 1.111164e-01 1 1  ON 37
eH1_8                 8.871211e-02 1 1  ON 38
eH1_9                 2.368371e-02 1 1  ON 39
eH2_0                -1.786818e-01 1 1  ON 40
eH2_1                -1.007251e-01 1 1  ON 41
eH2_2                -6.439697e-02 1 1  ON 42
eH2_3                -2.897299e-02 1 1  ON 43
eH2_4                 1.733628e-02 1 1  ON 44
eH2_5                 3.177780e-02 1 1  ON 45
eH2_6                 7.923302e-02 1 1  ON 46
eH2_7                 1.149339e-01 1 1  ON 47
eH2_8                 9.188318e-02 1 1  ON 48
eH2_9                 2.569238e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8598e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7179e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.235
    reference variance = 0.187958
====================================================
  Execution time = 3.2716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1200e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311440495145
                                         uncertainty =       0.003141982642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311440495145
                                         uncertainty =       0.003141982642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394966342
  error estimate for blocks of size 2^( 2) =       0.000406390528
  error estimate for blocks of size 2^( 3) =       0.000416640568
  error estimate for blocks of size 2^( 4) =       0.000424061404
  error estimate for blocks of size 2^( 5) =       0.000428352517
  error estimate for blocks of size 2^( 6) =       0.000430631382
  error estimate for blocks of size 2^( 7) =       0.000433001432

      target function =                  N/A
              le_mean =     -17.212721868505
             les_mean =     296.589790789372
             stat err =       0.000429011684
             autocorr =       1.179826275827
              std dev =       0.558566757744
             le_variance =       0.311996822856


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721272186851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212721868505       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212754376829       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212784295617       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212828675697       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212852196202       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212861199998       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212866455169       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212866873818       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212867196479       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212867338379       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212867073748       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212867196521       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.259035e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212721868505       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212732409304       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212741968678       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212756000843       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212763121564       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212765709338       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212766505840       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212766366726       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212766491914       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212766476896       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212766459459       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.760379e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212721868505       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212724715057       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212727302978       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212731085349       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212732923237       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212733600229       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212733737117       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212733711872       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212733742638       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212733735336       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.549613e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1674e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.971662e-01 1 1  ON 0
 uu_1                 4.033395e-02 1 1  ON 1
 uu_2                -4.844208e-02 1 1  ON 2
 uu_3                -9.706573e-02 1 1  ON 3
 uu_4                -1.264074e-01 1 1  ON 4
 uu_5                -1.330250e-01 1 1  ON 5
 uu_6                -1.101730e-01 1 1  ON 6
 uu_7                -3.436838e-02 1 1  ON 7
 uu_8                 1.025968e-01 1 1  ON 8
 uu_9                 1.190134e-01 1 1  ON 9
 ud_0                 3.306491e-01 1 1  ON 10
 ud_1                 8.136776e-02 1 1  ON 11
 ud_2                -1.536351e-02 1 1  ON 12
 ud_3                -6.464785e-02 1 1  ON 13
 ud_4                -1.098747e-01 1 1  ON 14
 ud_5                -1.477048e-01 1 1  ON 15
 ud_6                -1.573364e-01 1 1  ON 16
 ud_7                -1.090425e-01 1 1  ON 17
 ud_8                 8.851507e-03 1 1  ON 18
 ud_9                 9.251225e-02 1 1  ON 19
 eO_0                -7.028362e-01 1 1  ON 20
 eO_1                -4.105542e-01 1 1  ON 21
 eO_2                -4.456552e-02 1 1  ON 22
 eO_3                 1.750973e-01 1 1  ON 23
 eO_4                 2.651061e-01 1 1  ON 24
 eO_5                 3.051189e-01 1 1  ON 25
 eO_6                 2.481633e-01 1 1  ON 26
 eO_7                 1.085742e-01 1 1  ON 27
 eO_8                 2.733761e-02 1 1  ON 28
 eO_9                 1.815312e-02 1 1  ON 29
eH1_0                -1.772381e-01 1 1  ON 30
eH1_1                -9.944643e-02 1 1  ON 31
eH1_2                -6.271083e-02 1 1  ON 32
eH1_3                -2.714820e-02 1 1  ON 33
eH1_4                 1.898578e-02 1 1  ON 34
eH1_5                 3.200791e-02 1 1  ON 35
eH1_6                 7.697547e-02 1 1  ON 36
eH1_7                 1.110941e-01 1 1  ON 37
eH1_8                 8.873666e-02 1 1  ON 38
eH1_9                 2.369048e-02 1 1  ON 39
eH2_0                -1.787772e-01 1 1  ON 40
eH2_1                -1.008369e-01 1 1  ON 41
eH2_2                -6.439950e-02 1 1  ON 42
eH2_3                -2.881895e-02 1 1  ON 43
eH2_4                 1.745627e-02 1 1  ON 44
eH2_5                 3.181987e-02 1 1  ON 45
eH2_6                 7.913835e-02 1 1  ON 46
eH2_7                 1.148930e-01 1 1  ON 47
eH2_8                 9.190562e-02 1 1  ON 48
eH2_9                 2.569679e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2162
    reference variance = 0.275982
====================================================
  Execution time = 3.2302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1367e-01
  Total weights = 2.0000e+06
  Execution time = 2.8790e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312540125029
                                         uncertainty =       0.002613068261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312540125029
                                         uncertainty =       0.002613068261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395434276
  error estimate for blocks of size 2^( 2) =       0.000406561040
  error estimate for blocks of size 2^( 3) =       0.000416523866
  error estimate for blocks of size 2^( 4) =       0.000423690873
  error estimate for blocks of size 2^( 5) =       0.000427767727
  error estimate for blocks of size 2^( 6) =       0.000429658983
  error estimate for blocks of size 2^( 7) =       0.000429764535

      target function =                  N/A
              le_mean =     -17.212568865366
             les_mean =     296.585263322398
             stat err =       0.000427720529
             autocorr =       1.169961495192
              std dev =       0.559228516626
             le_variance =       0.312736533808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315588927735
                                         uncertainty =       0.002651065789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315588927735
                                         uncertainty =       0.002651065789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397359114
  error estimate for blocks of size 2^( 2) =       0.000408192885
  error estimate for blocks of size 2^( 3) =       0.000417896175
  error estimate for blocks of size 2^( 4) =       0.000424923626
  error estimate for blocks of size 2^( 5) =       0.000428903427
  error estimate for blocks of size 2^( 6) =       0.000430729388
  error estimate for blocks of size 2^( 7) =       0.000430818252

      target function =                  N/A
              le_mean =     -17.212586097553
             les_mean =     296.588908538124
             stat err =       0.000428843673
             autocorr =       1.164747153497
              std dev =       0.561950647614
             le_variance =       0.315788530354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314459214741
                                         uncertainty =       0.002637247968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314459214741
                                         uncertainty =       0.002637247968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396646949
  error estimate for blocks of size 2^( 2) =       0.000407584670
  error estimate for blocks of size 2^( 3) =       0.000417381415
  error estimate for blocks of size 2^( 4) =       0.000424460983
  error estimate for blocks of size 2^( 5) =       0.000428474770
  error estimate for blocks of size 2^( 6) =       0.000430325737
  error estimate for blocks of size 2^( 7) =       0.000430419429

      target function =                  N/A
              le_mean =     -17.212572000858
             les_mean =     296.587292331284
             stat err =       0.000428420230
             autocorr =       1.166626142508
              std dev =       0.560943494388
             le_variance =       0.314657603896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312786427639
                                         uncertainty =       0.002616309452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312786427639
                                         uncertainty =       0.002616309452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395590129
  error estimate for blocks of size 2^( 2) =       0.000406690516
  error estimate for blocks of size 2^( 3) =       0.000416630389
  error estimate for blocks of size 2^( 4) =       0.000423785415
  error estimate for blocks of size 2^( 5) =       0.000427853609
  error estimate for blocks of size 2^( 6) =       0.000429739409
  error estimate for blocks of size 2^( 7) =       0.000429843188

      target function =                  N/A
              le_mean =     -17.212567231150
             les_mean =     296.585453630676
             stat err =       0.000427805405
             autocorr =       1.169503813655
              std dev =       0.559448925574
             le_variance =       0.312983100326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212568865366        initial
     6.2500e-01     6.2500e+00             6.2590e-03       -17.212586097553  <--
     2.5000e+00     2.5000e+01             1.7604e-03       -17.212572000858
     1.0000e+01     1.0000e+02             4.5496e-04       -17.212567231150

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.6783e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.984104e-01 1 1  ON 0
 uu_1                 4.111401e-02 1 1  ON 1
 uu_2                -4.880691e-02 1 1  ON 2
 uu_3                -9.781399e-02 1 1  ON 3
 uu_4                -1.267812e-01 1 1  ON 4
 uu_5                -1.330593e-01 1 1  ON 5
 uu_6                -1.104648e-01 1 1  ON 6
 uu_7                -3.461764e-02 1 1  ON 7
 uu_8                 1.025236e-01 1 1  ON 8
 uu_9                 1.190677e-01 1 1  ON 9
 ud_0                 3.333570e-01 1 1  ON 10
 ud_1                 8.225158e-02 1 1  ON 11
 ud_2                -1.638646e-02 1 1  ON 12
 ud_3                -6.635246e-02 1 1  ON 13
 ud_4                -1.107322e-01 1 1  ON 14
 ud_5                -1.474289e-01 1 1  ON 15
 ud_6                -1.572130e-01 1 1  ON 16
 ud_7                -1.092610e-01 1 1  ON 17
 ud_8                 8.615386e-03 1 1  ON 18
 ud_9                 9.249393e-02 1 1  ON 19
 eO_0                -7.073349e-01 1 1  ON 20
 eO_1                -4.120692e-01 1 1  ON 21
 eO_2                -4.182217e-02 1 1  ON 22
 eO_3                 1.781019e-01 1 1  ON 23
 eO_4                 2.656060e-01 1 1  ON 24
 eO_5                 3.047449e-01 1 1  ON 25
 eO_6                 2.481410e-01 1 1  ON 26
 eO_7                 1.087114e-01 1 1  ON 27
 eO_8                 2.735103e-02 1 1  ON 28
 eO_9                 1.815843e-02 1 1  ON 29
eH1_0                -1.776826e-01 1 1  ON 30
eH1_1                -9.968805e-02 1 1  ON 31
eH1_2                -6.267457e-02 1 1  ON 32
eH1_3                -2.692035e-02 1 1  ON 33
eH1_4                 1.927182e-02 1 1  ON 34
eH1_5                 3.223759e-02 1 1  ON 35
eH1_6                 7.682927e-02 1 1  ON 36
eH1_7                 1.110410e-01 1 1  ON 37
eH1_8                 8.881317e-02 1 1  ON 38
eH1_9                 2.371141e-02 1 1  ON 39
eH2_0                -1.790770e-01 1 1  ON 40
eH2_1                -1.011752e-01 1 1  ON 41
eH2_2                -6.433135e-02 1 1  ON 42
eH2_3                -2.848470e-02 1 1  ON 43
eH2_4                 1.774544e-02 1 1  ON 44
eH2_5                 3.201220e-02 1 1  ON 45
eH2_6                 7.891005e-02 1 1  ON 46
eH2_7                 1.147839e-01 1 1  ON 47
eH2_8                 9.197593e-02 1 1  ON 48
eH2_9                 2.571080e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8463e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2609
    reference variance = 0.491158
====================================================
  Execution time = 3.3135e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1304e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313132866507
                                         uncertainty =       0.002678575999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313132866507
                                         uncertainty =       0.002678575999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395625087
  error estimate for blocks of size 2^( 2) =       0.000406747631
  error estimate for blocks of size 2^( 3) =       0.000416048495
  error estimate for blocks of size 2^( 4) =       0.000423549199
  error estimate for blocks of size 2^( 5) =       0.000427842028
  error estimate for blocks of size 2^( 6) =       0.000429247461
  error estimate for blocks of size 2^( 7) =       0.000430860054

      target function =                  N/A
              le_mean =     -17.213457066815
             les_mean =     296.616142452977
             stat err =       0.000427874686
             autocorr =       1.169675897597
              std dev =       0.559498363195
             le_variance =       0.313038418418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721345706681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213457066815       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213495379036       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213533615271       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213578733452       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213611972498       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213645847672       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213661700707       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213672051104       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213668580640       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213670260083       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213670376784       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213670513285       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213670849060       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.562253e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213457066815       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213475070383       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213491810890       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213510179719       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213525469161       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213535770443       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213538519199       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213540391932       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213539460247       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213539711609       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213539572953       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.265510e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213457066815       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213462836562       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213468185871       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213473668739       residual = 8.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213478355822       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213480845793       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213481408027       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213481672296       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213481521473       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213481566932       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.466562e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125698 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2234e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.998724e-01 1 1  ON 0
 uu_1                 4.194279e-02 1 1  ON 1
 uu_2                -4.905829e-02 1 1  ON 2
 uu_3                -9.860860e-02 1 1  ON 3
 uu_4                -1.273135e-01 1 1  ON 4
 uu_5                -1.331453e-01 1 1  ON 5
 uu_6                -1.107624e-01 1 1  ON 6
 uu_7                -3.498655e-02 1 1  ON 7
 uu_8                 1.023724e-01 1 1  ON 8
 uu_9                 1.191590e-01 1 1  ON 9
 ud_0                 3.362811e-01 1 1  ON 10
 ud_1                 8.319404e-02 1 1  ON 11
 ud_2                -1.739758e-02 1 1  ON 12
 ud_3                -6.828890e-02 1 1  ON 13
 ud_4                -1.118959e-01 1 1  ON 14
 ud_5                -1.471866e-01 1 1  ON 15
 ud_6                -1.568608e-01 1 1  ON 16
 ud_7                -1.094287e-01 1 1  ON 17
 ud_8                 8.373198e-03 1 1  ON 18
 ud_9                 9.247327e-02 1 1  ON 19
 eO_0                -7.126004e-01 1 1  ON 20
 eO_1                -4.140100e-01 1 1  ON 21
 eO_2                -3.904106e-02 1 1  ON 22
 eO_3                 1.819117e-01 1 1  ON 23
 eO_4                 2.663790e-01 1 1  ON 24
 eO_5                 3.043225e-01 1 1  ON 25
 eO_6                 2.481828e-01 1 1  ON 26
 eO_7                 1.088948e-01 1 1  ON 27
 eO_8                 2.737631e-02 1 1  ON 28
 eO_9                 1.816762e-02 1 1  ON 29
eH1_0                -1.781665e-01 1 1  ON 30
eH1_1                -9.995126e-02 1 1  ON 31
eH1_2                -6.271930e-02 1 1  ON 32
eH1_3                -2.673053e-02 1 1  ON 33
eH1_4                 1.956656e-02 1 1  ON 34
eH1_5                 3.267505e-02 1 1  ON 35
eH1_6                 7.666158e-02 1 1  ON 36
eH1_7                 1.109473e-01 1 1  ON 37
eH1_8                 8.891412e-02 1 1  ON 38
eH1_9                 2.373710e-02 1 1  ON 39
eH2_0                -1.795659e-01 1 1  ON 40
eH2_1                -1.015690e-01 1 1  ON 41
eH2_2                -6.422003e-02 1 1  ON 42
eH2_3                -2.827814e-02 1 1  ON 43
eH2_4                 1.813655e-02 1 1  ON 44
eH2_5                 3.234306e-02 1 1  ON 45
eH2_6                 7.867219e-02 1 1  ON 46
eH2_7                 1.147071e-01 1 1  ON 47
eH2_8                 9.208902e-02 1 1  ON 48
eH2_9                 2.574686e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.182
    reference variance = 0.159976
====================================================
  Execution time = 3.3828e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.2010e-01
  Total weights = 2.0000e+06
  Execution time = 2.8944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317790944393
                                         uncertainty =       0.004705904773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317790944393
                                         uncertainty =       0.004705904773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398535760
  error estimate for blocks of size 2^( 2) =       0.000409505217
  error estimate for blocks of size 2^( 3) =       0.000418893230
  error estimate for blocks of size 2^( 4) =       0.000426096897
  error estimate for blocks of size 2^( 5) =       0.000430890871
  error estimate for blocks of size 2^( 6) =       0.000434121641
  error estimate for blocks of size 2^( 7) =       0.000435551179

      target function =                  N/A
              le_mean =     -17.212701318296
             les_mean =     296.594748018731
             stat err =       0.000431665147
             autocorr =       1.173165752351
              std dev =       0.563614677498
             le_variance =       0.317661504691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323698294165
                                         uncertainty =       0.004810203210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323698294165
                                         uncertainty =       0.004810203210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402223843
  error estimate for blocks of size 2^( 2) =       0.000412783278
  error estimate for blocks of size 2^( 3) =       0.000421791504
  error estimate for blocks of size 2^( 4) =       0.000428791718
  error estimate for blocks of size 2^( 5) =       0.000433603461
  error estimate for blocks of size 2^( 6) =       0.000436901468
  error estimate for blocks of size 2^( 7) =       0.000438196223

      target function =                  N/A
              le_mean =     -17.212743250564
             les_mean =     296.602098087509
             stat err =       0.000434373217
             autocorr =       1.166246779190
              std dev =       0.568830413619
             le_variance =       0.323568039458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322948996903
                                         uncertainty =       0.004793023990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322948996903
                                         uncertainty =       0.004793023990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401757872
  error estimate for blocks of size 2^( 2) =       0.000412382742
  error estimate for blocks of size 2^( 3) =       0.000421457477
  error estimate for blocks of size 2^( 4) =       0.000428493098
  error estimate for blocks of size 2^( 5) =       0.000433313058
  error estimate for blocks of size 2^( 6) =       0.000436613508
  error estimate for blocks of size 2^( 7) =       0.000437916322

      target function =                  N/A
              le_mean =     -17.212723949955
             les_mean =     296.600684391390
             stat err =       0.000434083996
             autocorr =       1.167397501936
              std dev =       0.568171431376
             le_variance =       0.322818775432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318545334418
                                         uncertainty =       0.004719241957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318545334418
                                         uncertainty =       0.004719241957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399008623
  error estimate for blocks of size 2^( 2) =       0.000409919356
  error estimate for blocks of size 2^( 3) =       0.000419255290
  error estimate for blocks of size 2^( 4) =       0.000426431027
  error estimate for blocks of size 2^( 5) =       0.000431229086
  error estimate for blocks of size 2^( 6) =       0.000434470456
  error estimate for blocks of size 2^( 7) =       0.000435877768

      target function =                  N/A
              le_mean =     -17.212693683616
             les_mean =     296.595239449195
             stat err =       0.000432002084
             autocorr =       1.172214588368
              std dev =       0.564283406093
             le_variance =       0.318415762392


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212701318296        initial
     1.5625e-01     1.5625e+00             1.5623e-02       -17.212743250564  <--
     6.2500e-01     6.2500e+00             5.2655e-03       -17.212723949955
     2.5000e+00     2.5000e+01             1.4666e-03       -17.212693683616

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.8355e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.029722e-01 1 1  ON 0
 uu_1                 4.355306e-02 1 1  ON 1
 uu_2                -4.900262e-02 1 1  ON 2
 uu_3                -9.981574e-02 1 1  ON 3
 uu_4                -1.288041e-01 1 1  ON 4
 uu_5                -1.338344e-01 1 1  ON 5
 uu_6                -1.113981e-01 1 1  ON 6
 uu_7                -3.590273e-02 1 1  ON 7
 uu_8                 1.019733e-01 1 1  ON 8
 uu_9                 1.194358e-01 1 1  ON 9
 ud_0                 3.401812e-01 1 1  ON 10
 ud_1                 8.476685e-02 1 1  ON 11
 ud_2                -1.826285e-02 1 1  ON 12
 ud_3                -7.098199e-02 1 1  ON 13
 ud_4                -1.143189e-01 1 1  ON 14
 ud_5                -1.473721e-01 1 1  ON 15
 ud_6                -1.556681e-01 1 1  ON 16
 ud_7                -1.095277e-01 1 1  ON 17
 ud_8                 7.775853e-03 1 1  ON 18
 ud_9                 9.243029e-02 1 1  ON 19
 eO_0                -7.229574e-01 1 1  ON 20
 eO_1                -4.184076e-01 1 1  ON 21
 eO_2                -3.577030e-02 1 1  ON 22
 eO_3                 1.896533e-01 1 1  ON 23
 eO_4                 2.698252e-01 1 1  ON 24
 eO_5                 3.037193e-01 1 1  ON 25
 eO_6                 2.483962e-01 1 1  ON 26
 eO_7                 1.094564e-01 1 1  ON 27
 eO_8                 2.745710e-02 1 1  ON 28
 eO_9                 1.819560e-02 1 1  ON 29
eH1_0                -1.793220e-01 1 1  ON 30
eH1_1                -1.007878e-01 1 1  ON 31
eH1_2                -6.264062e-02 1 1  ON 32
eH1_3                -2.648650e-02 1 1  ON 33
eH1_4                 1.986274e-02 1 1  ON 34
eH1_5                 3.393057e-02 1 1  ON 35
eH1_6                 7.656730e-02 1 1  ON 36
eH1_7                 1.107590e-01 1 1  ON 37
eH1_8                 8.922142e-02 1 1  ON 38
eH1_9                 2.381557e-02 1 1  ON 39
eH2_0                -1.807336e-01 1 1  ON 40
eH2_1                -1.024943e-01 1 1  ON 41
eH2_2                -6.393376e-02 1 1  ON 42
eH2_3                -2.797935e-02 1 1  ON 43
eH2_4                 1.859414e-02 1 1  ON 44
eH2_5                 3.337020e-02 1 1  ON 45
eH2_6                 7.836587e-02 1 1  ON 46
eH2_7                 1.145588e-01 1 1  ON 47
eH2_8                 9.243206e-02 1 1  ON 48
eH2_9                 2.585628e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.0594e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1189
    reference variance = 0.225944
====================================================
  Execution time = 3.2695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1150e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311458066308
                                         uncertainty =       0.002444610912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311458066308
                                         uncertainty =       0.002444610912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394653849
  error estimate for blocks of size 2^( 2) =       0.000405441587
  error estimate for blocks of size 2^( 3) =       0.000414996509
  error estimate for blocks of size 2^( 4) =       0.000422385492
  error estimate for blocks of size 2^( 5) =       0.000427369514
  error estimate for blocks of size 2^( 6) =       0.000428773114
  error estimate for blocks of size 2^( 7) =       0.000427560292

      target function =                  N/A
              le_mean =     -17.213261464001
             les_mean =     296.607873392845
             stat err =       0.000426522103
             autocorr =       1.168020322764
              std dev =       0.558124825212
             le_variance =       0.311503320518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721326146400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213261464001       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213279993974       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213336368348       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213356322571       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213364584663       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213374100741       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213388724829       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213394826897       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213393951400       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213401195933       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213402804956       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213405009803       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213406107083       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213406640816       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213405094853       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213406584454       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213406866771       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 2.441678e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213261464001       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213273799173       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213311098330       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213323632929       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213318178258       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213323470984       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213329372043       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213332197279       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213331618250       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213331876123       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213331677273       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213332615313       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213332620531       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.014389e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213261464001       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213266741634       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213282797435       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213287709609       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213285240049       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213285022835       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213286766680       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213287127499       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213287215716       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213287099284       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213287023255       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.276248e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2061e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.064046e-01 1 1  ON 0
 uu_1                 4.503332e-02 1 1  ON 1
 uu_2                -4.899634e-02 1 1  ON 2
 uu_3                -1.009340e-01 1 1  ON 3
 uu_4                -1.304484e-01 1 1  ON 4
 uu_5                -1.347852e-01 1 1  ON 5
 uu_6                -1.118977e-01 1 1  ON 6
 uu_7                -3.696207e-02 1 1  ON 7
 uu_8                 1.013564e-01 1 1  ON 8
 uu_9                 1.197516e-01 1 1  ON 9
 ud_0                 3.434372e-01 1 1  ON 10
 ud_1                 8.642274e-02 1 1  ON 11
 ud_2                -1.846081e-02 1 1  ON 12
 ud_3                -7.284241e-02 1 1  ON 13
 ud_4                -1.163568e-01 1 1  ON 14
 ud_5                -1.483126e-01 1 1  ON 15
 ud_6                -1.548521e-01 1 1  ON 16
 ud_7                -1.098213e-01 1 1  ON 17
 ud_8                 6.863389e-03 1 1  ON 18
 ud_9                 9.238692e-02 1 1  ON 19
 eO_0                -7.331013e-01 1 1  ON 20
 eO_1                -4.233901e-01 1 1  ON 21
 eO_2                -3.360431e-02 1 1  ON 22
 eO_3                 1.967898e-01 1 1  ON 23
 eO_4                 2.746592e-01 1 1  ON 24
 eO_5                 3.033208e-01 1 1  ON 25
 eO_6                 2.488009e-01 1 1  ON 26
 eO_7                 1.102039e-01 1 1  ON 27
 eO_8                 2.754779e-02 1 1  ON 28
 eO_9                 1.825040e-02 1 1  ON 29
eH1_0                -1.802203e-01 1 1  ON 30
eH1_1                -1.018763e-01 1 1  ON 31
eH1_2                -6.253369e-02 1 1  ON 32
eH1_3                -2.623475e-02 1 1  ON 33
eH1_4                 1.983758e-02 1 1  ON 34
eH1_5                 3.488592e-02 1 1  ON 35
eH1_6                 7.676782e-02 1 1  ON 36
eH1_7                 1.105708e-01 1 1  ON 37
eH1_8                 8.964692e-02 1 1  ON 38
eH1_9                 2.392606e-02 1 1  ON 39
eH2_0                -1.818982e-01 1 1  ON 40
eH2_1                -1.034919e-01 1 1  ON 41
eH2_2                -6.365534e-02 1 1  ON 42
eH2_3                -2.730188e-02 1 1  ON 43
eH2_4                 1.864485e-02 1 1  ON 44
eH2_5                 3.445012e-02 1 1  ON 45
eH2_6                 7.835485e-02 1 1  ON 46
eH2_7                 1.141139e-01 1 1  ON 47
eH2_8                 9.274341e-02 1 1  ON 48
eH2_9                 2.601115e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1924
    reference variance = 0.218528
====================================================
  Execution time = 3.2711e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2426e-01
  Total weights = 2.0000e+06
  Execution time = 2.8876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321198935405
                                         uncertainty =       0.005025224012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321198935405
                                         uncertainty =       0.005025224012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400736656
  error estimate for blocks of size 2^( 2) =       0.000410936270
  error estimate for blocks of size 2^( 3) =       0.000420133220
  error estimate for blocks of size 2^( 4) =       0.000426783544
  error estimate for blocks of size 2^( 5) =       0.000429466564
  error estimate for blocks of size 2^( 6) =       0.000431024141
  error estimate for blocks of size 2^( 7) =       0.000432699835

      target function =                  N/A
              le_mean =     -17.213905745856
             les_mean =     296.639730601419
             stat err =       0.000429993521
             autocorr =       1.151345542753
              std dev =       0.566727213756
             le_variance =       0.321179734812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326990392903
                                         uncertainty =       0.005074245574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326990392903
                                         uncertainty =       0.005074245574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404332638
  error estimate for blocks of size 2^( 2) =       0.000414230032
  error estimate for blocks of size 2^( 3) =       0.000423103515
  error estimate for blocks of size 2^( 4) =       0.000429519686
  error estimate for blocks of size 2^( 5) =       0.000432052436
  error estimate for blocks of size 2^( 6) =       0.000433535230
  error estimate for blocks of size 2^( 7) =       0.000435065738

      target function =                  N/A
              le_mean =     -17.213909411213
             les_mean =     296.645646818239
             stat err =       0.000432543272
             autocorr =       1.144409684989
              std dev =       0.571812700359
             le_variance =       0.326969764292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327682677119
                                         uncertainty =       0.005081855782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327682677119
                                         uncertainty =       0.005081855782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404760525
  error estimate for blocks of size 2^( 2) =       0.000414651917
  error estimate for blocks of size 2^( 3) =       0.000423529098
  error estimate for blocks of size 2^( 4) =       0.000429952014
  error estimate for blocks of size 2^( 5) =       0.000432500431
  error estimate for blocks of size 2^( 6) =       0.000433998586
  error estimate for blocks of size 2^( 7) =       0.000435521858

      target function =                  N/A
              le_mean =     -17.213914424822
             les_mean =     296.646511826166
             stat err =       0.000432993222
             autocorr =       1.144368503458
              std dev =       0.572417823702
             le_variance =       0.327662164892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322415833242
                                         uncertainty =       0.005037145240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322415833242
                                         uncertainty =       0.005037145240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401494957
  error estimate for blocks of size 2^( 2) =       0.000411627663
  error estimate for blocks of size 2^( 3) =       0.000420758948
  error estimate for blocks of size 2^( 4) =       0.000427363667
  error estimate for blocks of size 2^( 5) =       0.000430022838
  error estimate for blocks of size 2^( 6) =       0.000431570477
  error estimate for blocks of size 2^( 7) =       0.000433216575

      target function =                  N/A
              le_mean =     -17.213891650635
             les_mean =     296.640461999948
             stat err =       0.000430543389
             autocorr =       1.149935975666
              std dev =       0.567799613722
             le_variance =       0.322396401343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213905745856        initial
     3.9062e-02     3.9062e-01             2.4417e-02       -17.213909411213
     1.5625e-01     1.5625e+00             1.0144e-02       -17.213914424822  <--
     6.2500e-01     6.2500e+00             3.2762e-03       -17.213891650635

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.7218e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.064046e-01 1 1  ON 0
 uu_1                 4.503332e-02 1 1  ON 1
 uu_2                -4.899634e-02 1 1  ON 2
 uu_3                -1.009340e-01 1 1  ON 3
 uu_4                -1.304484e-01 1 1  ON 4
 uu_5                -1.347852e-01 1 1  ON 5
 uu_6                -1.118977e-01 1 1  ON 6
 uu_7                -3.696207e-02 1 1  ON 7
 uu_8                 1.013564e-01 1 1  ON 8
 uu_9                 1.197516e-01 1 1  ON 9
 ud_0                 3.434372e-01 1 1  ON 10
 ud_1                 8.642274e-02 1 1  ON 11
 ud_2                -1.846081e-02 1 1  ON 12
 ud_3                -7.284241e-02 1 1  ON 13
 ud_4                -1.163568e-01 1 1  ON 14
 ud_5                -1.483126e-01 1 1  ON 15
 ud_6                -1.548521e-01 1 1  ON 16
 ud_7                -1.098213e-01 1 1  ON 17
 ud_8                 6.863389e-03 1 1  ON 18
 ud_9                 9.238692e-02 1 1  ON 19
 eO_0                -7.331013e-01 1 1  ON 20
 eO_1                -4.233901e-01 1 1  ON 21
 eO_2                -3.360431e-02 1 1  ON 22
 eO_3                 1.967898e-01 1 1  ON 23
 eO_4                 2.746592e-01 1 1  ON 24
 eO_5                 3.033208e-01 1 1  ON 25
 eO_6                 2.488009e-01 1 1  ON 26
 eO_7                 1.102039e-01 1 1  ON 27
 eO_8                 2.754779e-02 1 1  ON 28
 eO_9                 1.825040e-02 1 1  ON 29
eH1_0                -1.802203e-01 1 1  ON 30
eH1_1                -1.018763e-01 1 1  ON 31
eH1_2                -6.253369e-02 1 1  ON 32
eH1_3                -2.623475e-02 1 1  ON 33
eH1_4                 1.983758e-02 1 1  ON 34
eH1_5                 3.488592e-02 1 1  ON 35
eH1_6                 7.676782e-02 1 1  ON 36
eH1_7                 1.105708e-01 1 1  ON 37
eH1_8                 8.964692e-02 1 1  ON 38
eH1_9                 2.392606e-02 1 1  ON 39
eH2_0                -1.818982e-01 1 1  ON 40
eH2_1                -1.034919e-01 1 1  ON 41
eH2_2                -6.365534e-02 1 1  ON 42
eH2_3                -2.730188e-02 1 1  ON 43
eH2_4                 1.864485e-02 1 1  ON 44
eH2_5                 3.445012e-02 1 1  ON 45
eH2_6                 7.835485e-02 1 1  ON 46
eH2_7                 1.141139e-01 1 1  ON 47
eH2_8                 9.274341e-02 1 1  ON 48
eH2_9                 2.601115e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9284e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.169
    reference variance = 0.201867
====================================================
  Execution time = 3.2972e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.2844e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328473626057
                                         uncertainty =       0.004443930655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328473626057
                                         uncertainty =       0.004443930655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405238971
  error estimate for blocks of size 2^( 2) =       0.000415659695
  error estimate for blocks of size 2^( 3) =       0.000425059229
  error estimate for blocks of size 2^( 4) =       0.000431983650
  error estimate for blocks of size 2^( 5) =       0.000435354387
  error estimate for blocks of size 2^( 6) =       0.000437976099
  error estimate for blocks of size 2^( 7) =       0.000439072720

      target function =                  N/A
              le_mean =     -17.213229353252
             les_mean =     296.623701850817
             stat err =       0.000436096714
             autocorr =       1.158092425576
              std dev =       0.573094448929
             le_variance =       0.328437247393


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721322935325e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213229353252       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213239713803       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213273601042       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213282220468       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213287265600       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213303239755       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213310043223       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213320032615       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213324754931       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213324277077       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213322600451       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213323215891       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213324673850       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213324481287       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213325763678       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213325612640       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 1.907132e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213229353252       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213236106325       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213257239476       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213258749671       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213260022543       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213265617319       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213267659392       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213270250513       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213270712036       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213270361792       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213269774542       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213269633390       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 7.284101e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213229353252       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213232175526       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213240973976       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213240305007       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213240278599       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213241597947       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213242013711       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213242390207       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213242416462       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213242405233       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.254770e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2065e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.084080e-01 1 1  ON 0
 uu_1                 4.627407e-02 1 1  ON 1
 uu_2                -4.848373e-02 1 1  ON 2
 uu_3                -1.015034e-01 1 1  ON 3
 uu_4                -1.316401e-01 1 1  ON 4
 uu_5                -1.358836e-01 1 1  ON 5
 uu_6                -1.122469e-01 1 1  ON 6
 uu_7                -3.798471e-02 1 1  ON 7
 uu_8                 1.008304e-01 1 1  ON 8
 uu_9                 1.201151e-01 1 1  ON 9
 ud_0                 3.448043e-01 1 1  ON 10
 ud_1                 8.736837e-02 1 1  ON 11
 ud_2                -1.838402e-02 1 1  ON 12
 ud_3                -7.388010e-02 1 1  ON 13
 ud_4                -1.179025e-01 1 1  ON 14
 ud_5                -1.490872e-01 1 1  ON 15
 ud_6                -1.540153e-01 1 1  ON 16
 ud_7                -1.098663e-01 1 1  ON 17
 ud_8                 6.286149e-03 1 1  ON 18
 ud_9                 9.256325e-02 1 1  ON 19
 eO_0                -7.403854e-01 1 1  ON 20
 eO_1                -4.276561e-01 1 1  ON 21
 eO_2                -3.361559e-02 1 1  ON 22
 eO_3                 2.017773e-01 1 1  ON 23
 eO_4                 2.793753e-01 1 1  ON 24
 eO_5                 3.036221e-01 1 1  ON 25
 eO_6                 2.493187e-01 1 1  ON 26
 eO_7                 1.109359e-01 1 1  ON 27
 eO_8                 2.767975e-02 1 1  ON 28
 eO_9                 1.833080e-02 1 1  ON 29
eH1_0                -1.812709e-01 1 1  ON 30
eH1_1                -1.025332e-01 1 1  ON 31
eH1_2                -6.233208e-02 1 1  ON 32
eH1_3                -2.592323e-02 1 1  ON 33
eH1_4                 1.984104e-02 1 1  ON 34
eH1_5                 3.514593e-02 1 1  ON 35
eH1_6                 7.714236e-02 1 1  ON 36
eH1_7                 1.104264e-01 1 1  ON 37
eH1_8                 9.010280e-02 1 1  ON 38
eH1_9                 2.405254e-02 1 1  ON 39
eH2_0                -1.827020e-01 1 1  ON 40
eH2_1                -1.038114e-01 1 1  ON 41
eH2_2                -6.353377e-02 1 1  ON 42
eH2_3                -2.707894e-02 1 1  ON 43
eH2_4                 1.864621e-02 1 1  ON 44
eH2_5                 3.497161e-02 1 1  ON 45
eH2_6                 7.817260e-02 1 1  ON 46
eH2_7                 1.138553e-01 1 1  ON 47
eH2_8                 9.321401e-02 1 1  ON 48
eH2_9                 2.617001e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.0892
    reference variance = 0.230603
====================================================
  Execution time = 3.2395e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2563e-01
  Total weights = 2.0000e+06
  Execution time = 2.8762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324413006971
                                         uncertainty =       0.005491554936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324413006971
                                         uncertainty =       0.005491554936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402676039
  error estimate for blocks of size 2^( 2) =       0.000412919140
  error estimate for blocks of size 2^( 3) =       0.000422029578
  error estimate for blocks of size 2^( 4) =       0.000428763208
  error estimate for blocks of size 2^( 5) =       0.000432158701
  error estimate for blocks of size 2^( 6) =       0.000434735495
  error estimate for blocks of size 2^( 7) =       0.000435945284

      target function =                  N/A
              le_mean =     -17.213748666449
             les_mean =     296.637438975005
             stat err =       0.000432900672
             autocorr =       1.155752771455
              std dev =       0.569469916230
             le_variance =       0.324295985491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327505378778
                                         uncertainty =       0.005563346677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327505378778
                                         uncertainty =       0.005563346677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404590965
  error estimate for blocks of size 2^( 2) =       0.000414699878
  error estimate for blocks of size 2^( 3) =       0.000423646280
  error estimate for blocks of size 2^( 4) =       0.000430246518
  error estimate for blocks of size 2^( 5) =       0.000433589228
  error estimate for blocks of size 2^( 6) =       0.000436146836
  error estimate for blocks of size 2^( 7) =       0.000437289268

      target function =                  N/A
              le_mean =     -17.213739353374
             les_mean =     296.640210060893
             stat err =       0.000434317962
             autocorr =       1.152346854184
              std dev =       0.572178030599
             le_variance =       0.327387698700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327171137673
                                         uncertainty =       0.005550584680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327171137673
                                         uncertainty =       0.005550584680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404384447
  error estimate for blocks of size 2^( 2) =       0.000414510352
  error estimate for blocks of size 2^( 3) =       0.000423477899
  error estimate for blocks of size 2^( 4) =       0.000430100915
  error estimate for blocks of size 2^( 5) =       0.000433459436
  error estimate for blocks of size 2^( 6) =       0.000436027012
  error estimate for blocks of size 2^( 7) =       0.000437174276

      target function =                  N/A
              le_mean =     -17.213732291894
             les_mean =     296.639632815884
             stat err =       0.000434190410
             autocorr =       1.152846711471
              std dev =       0.571885969773
             le_variance =       0.327053562423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324833869224
                                         uncertainty =       0.005500223874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324833869224
                                         uncertainty =       0.005500223874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402937197
  error estimate for blocks of size 2^( 2) =       0.000413158964
  error estimate for blocks of size 2^( 3) =       0.000422244108
  error estimate for blocks of size 2^( 4) =       0.000428958985
  error estimate for blocks of size 2^( 5) =       0.000432348185
  error estimate for blocks of size 2^( 6) =       0.000434924322
  error estimate for blocks of size 2^( 7) =       0.000436122347

      target function =                  N/A
              le_mean =     -17.213740193365
             les_mean =     296.637568052284
             stat err =       0.000433088460
             autocorr =       1.155256711251
              std dev =       0.569839249238
             le_variance =       0.324716769972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213748666449        initial  <--
     3.9062e-02     3.9062e-01             1.9071e-02       -17.213739353374
     1.5625e-01     1.5625e+00             7.2841e-03       -17.213732291894
     6.2500e-01     6.2500e+00             2.2548e-03       -17.213740193365

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.8988
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.064046e-01 1 1  ON 0
 uu_1                 4.503332e-02 1 1  ON 1
 uu_2                -4.899634e-02 1 1  ON 2
 uu_3                -1.009340e-01 1 1  ON 3
 uu_4                -1.304484e-01 1 1  ON 4
 uu_5                -1.347852e-01 1 1  ON 5
 uu_6                -1.118977e-01 1 1  ON 6
 uu_7                -3.696207e-02 1 1  ON 7
 uu_8                 1.013564e-01 1 1  ON 8
 uu_9                 1.197516e-01 1 1  ON 9
 ud_0                 3.434372e-01 1 1  ON 10
 ud_1                 8.642274e-02 1 1  ON 11
 ud_2                -1.846081e-02 1 1  ON 12
 ud_3                -7.284241e-02 1 1  ON 13
 ud_4                -1.163568e-01 1 1  ON 14
 ud_5                -1.483126e-01 1 1  ON 15
 ud_6                -1.548521e-01 1 1  ON 16
 ud_7                -1.098213e-01 1 1  ON 17
 ud_8                 6.863389e-03 1 1  ON 18
 ud_9                 9.238692e-02 1 1  ON 19
 eO_0                -7.331013e-01 1 1  ON 20
 eO_1                -4.233901e-01 1 1  ON 21
 eO_2                -3.360431e-02 1 1  ON 22
 eO_3                 1.967898e-01 1 1  ON 23
 eO_4                 2.746592e-01 1 1  ON 24
 eO_5                 3.033208e-01 1 1  ON 25
 eO_6                 2.488009e-01 1 1  ON 26
 eO_7                 1.102039e-01 1 1  ON 27
 eO_8                 2.754779e-02 1 1  ON 28
 eO_9                 1.825040e-02 1 1  ON 29
eH1_0                -1.802203e-01 1 1  ON 30
eH1_1                -1.018763e-01 1 1  ON 31
eH1_2                -6.253369e-02 1 1  ON 32
eH1_3                -2.623475e-02 1 1  ON 33
eH1_4                 1.983758e-02 1 1  ON 34
eH1_5                 3.488592e-02 1 1  ON 35
eH1_6                 7.676782e-02 1 1  ON 36
eH1_7                 1.105708e-01 1 1  ON 37
eH1_8                 8.964692e-02 1 1  ON 38
eH1_9                 2.392606e-02 1 1  ON 39
eH2_0                -1.818982e-01 1 1  ON 40
eH2_1                -1.034919e-01 1 1  ON 41
eH2_2                -6.365534e-02 1 1  ON 42
eH2_3                -2.730188e-02 1 1  ON 43
eH2_4                 1.864485e-02 1 1  ON 44
eH2_5                 3.445012e-02 1 1  ON 45
eH2_6                 7.835485e-02 1 1  ON 46
eH2_7                 1.141139e-01 1 1  ON 47
eH2_8                 9.274341e-02 1 1  ON 48
eH2_9                 2.601115e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8969e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7182e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2208
    reference variance = 0.256681
====================================================
  Execution time = 3.2973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.3273e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332835321714
                                         uncertainty =       0.014898698023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332835321714
                                         uncertainty =       0.014898698023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407879065
  error estimate for blocks of size 2^( 2) =       0.000417826913
  error estimate for blocks of size 2^( 3) =       0.000426719744
  error estimate for blocks of size 2^( 4) =       0.000433512148
  error estimate for blocks of size 2^( 5) =       0.000437996175
  error estimate for blocks of size 2^( 6) =       0.000440362220
  error estimate for blocks of size 2^( 7) =       0.000439966278

      target function =                  N/A
              le_mean =     -17.213455283746
             les_mean =     296.635773301733
             stat err =       0.000437959205
             autocorr =       1.152934111210
              std dev =       0.576828104867
             le_variance =       0.332730662564


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721345528375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213455283746       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213457037591       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213468576218       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213469210212       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213469389280       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213470574900       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213471229343       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213471702820       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213472092800       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213471899906       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213471867644       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.415070e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213455283746       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213455845605       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213459668950       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213459481295       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213459369700       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213459602741       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213459682160       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213459743116       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213459776193       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 9.616469e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213455283746       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213455434842       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213456472903       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213456391125       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213456352649       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213456403241       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213456414209       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213456421518       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 2.488827e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142127 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1956e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.066940e-01 1 1  ON 0
 uu_1                 4.521182e-02 1 1  ON 1
 uu_2                -4.895091e-02 1 1  ON 2
 uu_3                -1.010303e-01 1 1  ON 3
 uu_4                -1.305982e-01 1 1  ON 4
 uu_5                -1.348623e-01 1 1  ON 5
 uu_6                -1.119988e-01 1 1  ON 6
 uu_7                -3.708782e-02 1 1  ON 7
 uu_8                 1.013117e-01 1 1  ON 8
 uu_9                 1.197898e-01 1 1  ON 9
 ud_0                 3.437472e-01 1 1  ON 10
 ud_1                 8.661019e-02 1 1  ON 11
 ud_2                -1.846302e-02 1 1  ON 12
 ud_3                -7.298161e-02 1 1  ON 13
 ud_4                -1.165610e-01 1 1  ON 14
 ud_5                -1.483739e-01 1 1  ON 15
 ud_6                -1.548254e-01 1 1  ON 16
 ud_7                -1.098842e-01 1 1  ON 17
 ud_8                 6.772783e-03 1 1  ON 18
 ud_9                 9.239073e-02 1 1  ON 19
 eO_0                -7.340629e-01 1 1  ON 20
 eO_1                -4.238409e-01 1 1  ON 21
 eO_2                -3.349907e-02 1 1  ON 22
 eO_3                 1.975328e-01 1 1  ON 23
 eO_4                 2.751566e-01 1 1  ON 24
 eO_5                 3.033054e-01 1 1  ON 25
 eO_6                 2.487993e-01 1 1  ON 26
 eO_7                 1.102690e-01 1 1  ON 27
 eO_8                 2.755808e-02 1 1  ON 28
 eO_9                 1.825504e-02 1 1  ON 29
eH1_0                -1.803545e-01 1 1  ON 30
eH1_1                -1.019774e-01 1 1  ON 31
eH1_2                -6.252334e-02 1 1  ON 32
eH1_3                -2.620983e-02 1 1  ON 33
eH1_4                 1.990582e-02 1 1  ON 34
eH1_5                 3.498253e-02 1 1  ON 35
eH1_6                 7.676977e-02 1 1  ON 36
eH1_7                 1.105512e-01 1 1  ON 37
eH1_8                 8.968509e-02 1 1  ON 38
eH1_9                 2.393683e-02 1 1  ON 39
eH2_0                -1.819548e-01 1 1  ON 40
eH2_1                -1.035274e-01 1 1  ON 41
eH2_2                -6.366742e-02 1 1  ON 42
eH2_3                -2.728796e-02 1 1  ON 43
eH2_4                 1.869352e-02 1 1  ON 44
eH2_5                 3.450758e-02 1 1  ON 45
eH2_6                 7.833693e-02 1 1  ON 46
eH2_7                 1.140650e-01 1 1  ON 47
eH2_8                 9.277446e-02 1 1  ON 48
eH2_9                 2.602616e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2098
    reference variance = 0.287191
====================================================
  Execution time = 3.2419e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.4427e-01
  Total weights = 2.0000e+06
  Execution time = 2.8661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344095994369
                                         uncertainty =       0.025297353236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344095994369
                                         uncertainty =       0.025297353236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414700419
  error estimate for blocks of size 2^( 2) =       0.000424765535
  error estimate for blocks of size 2^( 3) =       0.000434465744
  error estimate for blocks of size 2^( 4) =       0.000441004991
  error estimate for blocks of size 2^( 5) =       0.000445230565
  error estimate for blocks of size 2^( 6) =       0.000446820668
  error estimate for blocks of size 2^( 7) =       0.000447992117

      target function =                  N/A
              le_mean =     -17.213809352526
             les_mean =     296.659185128443
             stat err =       0.000445262085
             autocorr =       1.152822604587
              std dev =       0.586474957098
             le_variance =       0.343952875303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345135646896
                                         uncertainty =       0.025405135280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345135646896
                                         uncertainty =       0.025405135280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415326439
  error estimate for blocks of size 2^( 2) =       0.000425349576
  error estimate for blocks of size 2^( 3) =       0.000435003652
  error estimate for blocks of size 2^( 4) =       0.000441515444
  error estimate for blocks of size 2^( 5) =       0.000445722966
  error estimate for blocks of size 2^( 6) =       0.000447298149
  error estimate for blocks of size 2^( 7) =       0.000448473004

      target function =                  N/A
              le_mean =     -17.213818917547
             les_mean =     296.660553656026
             stat err =       0.000445752391
             autocorr =       1.151882564505
              std dev =       0.587360283332
             le_variance =       0.344992102436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344737604152
                                         uncertainty =       0.025362478809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344737604152
                                         uncertainty =       0.025362478809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415086859
  error estimate for blocks of size 2^( 2) =       0.000425126065
  error estimate for blocks of size 2^( 3) =       0.000434798170
  error estimate for blocks of size 2^( 4) =       0.000441320837
  error estimate for blocks of size 2^( 5) =       0.000445535099
  error estimate for blocks of size 2^( 6) =       0.000447115651
  error estimate for blocks of size 2^( 7) =       0.000448290683

      target function =                  N/A
              le_mean =     -17.213814547742
             les_mean =     296.660005312185
             stat err =       0.000445565568
             autocorr =       1.152246176866
              std dev =       0.587021465049
             le_variance =       0.344594200429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344183009179
                                         uncertainty =       0.025306460560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344183009179
                                         uncertainty =       0.025306460560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414752848
  error estimate for blocks of size 2^( 2) =       0.000424814391
  error estimate for blocks of size 2^( 3) =       0.000434510790
  error estimate for blocks of size 2^( 4) =       0.000441047812
  error estimate for blocks of size 2^( 5) =       0.000445271815
  error estimate for blocks of size 2^( 6) =       0.000446860604
  error estimate for blocks of size 2^( 7) =       0.000448032587

      target function =                  N/A
              le_mean =     -17.213809939775
             les_mean =     296.659292320187
             stat err =       0.000445303204
             autocorr =       1.152744044972
              std dev =       0.586549102388
             le_variance =       0.344039849512


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213809352526        initial
     3.9062e-01     3.9062e+00             3.4151e-03       -17.213818917547  <--
     1.5625e+00     1.5625e+01             9.6165e-04       -17.213814547742
     6.2500e+00     6.2500e+01             2.4888e-04       -17.213809939775

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.6907e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.074760e-01 1 1  ON 0
 uu_1                 4.567441e-02 1 1  ON 1
 uu_2                -4.878202e-02 1 1  ON 2
 uu_3                -1.012263e-01 1 1  ON 3
 uu_4                -1.309962e-01 1 1  ON 4
 uu_5                -1.351481e-01 1 1  ON 5
 uu_6                -1.122798e-01 1 1  ON 6
 uu_7                -3.745186e-02 1 1  ON 7
 uu_8                 1.011781e-01 1 1  ON 8
 uu_9                 1.199045e-01 1 1  ON 9
 ud_0                 3.444829e-01 1 1  ON 10
 ud_1                 8.705970e-02 1 1  ON 11
 ud_2                -1.839117e-02 1 1  ON 12
 ud_3                -7.327392e-02 1 1  ON 13
 ud_4                -1.170456e-01 1 1  ON 14
 ud_5                -1.486091e-01 1 1  ON 15
 ud_6                -1.547487e-01 1 1  ON 16
 ud_7                -1.100490e-01 1 1  ON 17
 ud_8                 6.506373e-03 1 1  ON 18
 ud_9                 9.240254e-02 1 1  ON 19
 eO_0                -7.365163e-01 1 1  ON 20
 eO_1                -4.251407e-01 1 1  ON 21
 eO_2                -3.336990e-02 1 1  ON 22
 eO_3                 1.993404e-01 1 1  ON 23
 eO_4                 2.766895e-01 1 1  ON 24
 eO_5                 3.033308e-01 1 1  ON 25
 eO_6                 2.488042e-01 1 1  ON 26
 eO_7                 1.104657e-01 1 1  ON 27
 eO_8                 2.758911e-02 1 1  ON 28
 eO_9                 1.826901e-02 1 1  ON 29
eH1_0                -1.807088e-01 1 1  ON 30
eH1_1                -1.022508e-01 1 1  ON 31
eH1_2                -6.250466e-02 1 1  ON 32
eH1_3                -2.614928e-02 1 1  ON 33
eH1_4                 2.005196e-02 1 1  ON 34
eH1_5                 3.523919e-02 1 1  ON 35
eH1_6                 7.680672e-02 1 1  ON 36
eH1_7                 1.105003e-01 1 1  ON 37
eH1_8                 8.980056e-02 1 1  ON 38
eH1_9                 2.396932e-02 1 1  ON 39
eH2_0                -1.821002e-01 1 1  ON 40
eH2_1                -1.036600e-01 1 1  ON 41
eH2_2                -6.366536e-02 1 1  ON 42
eH2_3                -2.724747e-02 1 1  ON 43
eH2_4                 1.878018e-02 1 1  ON 44
eH2_5                 3.465948e-02 1 1  ON 45
eH2_6                 7.831797e-02 1 1  ON 46
eH2_7                 1.139268e-01 1 1  ON 47
eH2_8                 9.286854e-02 1 1  ON 48
eH2_9                 2.607144e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8869e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7186e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2571
    reference variance = 0.238633
====================================================
  Execution time = 3.5201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3577e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335842303537
                                         uncertainty =       0.017965207882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335842303537
                                         uncertainty =       0.017965207882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409736068
  error estimate for blocks of size 2^( 2) =       0.000420066381
  error estimate for blocks of size 2^( 3) =       0.000428619246
  error estimate for blocks of size 2^( 4) =       0.000434944465
  error estimate for blocks of size 2^( 5) =       0.000438602915
  error estimate for blocks of size 2^( 6) =       0.000441858728
  error estimate for blocks of size 2^( 7) =       0.000443312982

      target function =                  N/A
              le_mean =     -17.214004132639
             les_mean =     296.657705401602
             stat err =       0.000439679773
             autocorr =       1.151501695599
              std dev =       0.579454304479
             le_variance =       0.335767290979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721400413264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214004132639       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214003981417       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214009829335       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214027747153       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214027852384       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214036166411       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214038042245       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214034409212       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214034565869       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214035751851       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214035137799       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214035652614       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214035911319       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 8.698101e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214004132639       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214004061570       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214006333923       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214011972499       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214012253056       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214014958993       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214014568108       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214014026034       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214014274798       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214014064946       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 2.843652e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214004132639       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214004109861       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214004797628       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214005882445       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214006232791       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214006902074       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214006778906       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214006677488       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214006726554       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 7.881501e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146346 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4243e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.083862e-01 1 1  ON 0
 uu_1                 4.600993e-02 1 1  ON 1
 uu_2                -4.852970e-02 1 1  ON 2
 uu_3                -1.014764e-01 1 1  ON 3
 uu_4                -1.314096e-01 1 1  ON 4
 uu_5                -1.357048e-01 1 1  ON 5
 uu_6                -1.123436e-01 1 1  ON 6
 uu_7                -3.781175e-02 1 1  ON 7
 uu_8                 1.009592e-01 1 1  ON 8
 uu_9                 1.200502e-01 1 1  ON 9
 ud_0                 3.451215e-01 1 1  ON 10
 ud_1                 8.749708e-02 1 1  ON 11
 ud_2                -1.821994e-02 1 1  ON 12
 ud_3                -7.363733e-02 1 1  ON 13
 ud_4                -1.176202e-01 1 1  ON 14
 ud_5                -1.490081e-01 1 1  ON 15
 ud_6                -1.545192e-01 1 1  ON 16
 ud_7                -1.100550e-01 1 1  ON 17
 ud_8                 6.194375e-03 1 1  ON 18
 ud_9                 9.238129e-02 1 1  ON 19
 eO_0                -7.393600e-01 1 1  ON 20
 eO_1                -4.267191e-01 1 1  ON 21
 eO_2                -3.328607e-02 1 1  ON 22
 eO_3                 2.011938e-01 1 1  ON 23
 eO_4                 2.784605e-01 1 1  ON 24
 eO_5                 3.034363e-01 1 1  ON 25
 eO_6                 2.490414e-01 1 1  ON 26
 eO_7                 1.107440e-01 1 1  ON 27
 eO_8                 2.763395e-02 1 1  ON 28
 eO_9                 1.828937e-02 1 1  ON 29
eH1_0                -1.811743e-01 1 1  ON 30
eH1_1                -1.026546e-01 1 1  ON 31
eH1_2                -6.238538e-02 1 1  ON 32
eH1_3                -2.615152e-02 1 1  ON 33
eH1_4                 2.015958e-02 1 1  ON 34
eH1_5                 3.562334e-02 1 1  ON 35
eH1_6                 7.696348e-02 1 1  ON 36
eH1_7                 1.103745e-01 1 1  ON 37
eH1_8                 8.994286e-02 1 1  ON 38
eH1_9                 2.402276e-02 1 1  ON 39
eH2_0                -1.824486e-01 1 1  ON 40
eH2_1                -1.037657e-01 1 1  ON 41
eH2_2                -6.362274e-02 1 1  ON 42
eH2_3                -2.719269e-02 1 1  ON 43
eH2_4                 1.886217e-02 1 1  ON 44
eH2_5                 3.459584e-02 1 1  ON 45
eH2_6                 7.840159e-02 1 1  ON 46
eH2_7                 1.139199e-01 1 1  ON 47
eH2_8                 9.305534e-02 1 1  ON 48
eH2_9                 2.612020e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.201088
====================================================
  Execution time = 3.2519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2642e-01
  Total weights = 2.0000e+06
  Execution time = 2.8775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325861170747
                                         uncertainty =       0.004059701847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325861170747
                                         uncertainty =       0.004059701847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403691553
  error estimate for blocks of size 2^( 2) =       0.000413772690
  error estimate for blocks of size 2^( 3) =       0.000423274135
  error estimate for blocks of size 2^( 4) =       0.000429473718
  error estimate for blocks of size 2^( 5) =       0.000433443777
  error estimate for blocks of size 2^( 6) =       0.000435388581
  error estimate for blocks of size 2^( 7) =       0.000436105899

      target function =                  N/A
              le_mean =     -17.213802002652
             les_mean =     296.640912963952
             stat err =       0.000433602994
             autocorr =       1.153679615744
              std dev =       0.570906069699
             le_variance =       0.325933740419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327286375637
                                         uncertainty =       0.004072129474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327286375637
                                         uncertainty =       0.004072129474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404573413
  error estimate for blocks of size 2^( 2) =       0.000414593309
  error estimate for blocks of size 2^( 3) =       0.000424007217
  error estimate for blocks of size 2^( 4) =       0.000430150726
  error estimate for blocks of size 2^( 5) =       0.000434092355
  error estimate for blocks of size 2^( 6) =       0.000436013400
  error estimate for blocks of size 2^( 7) =       0.000436679485

      target function =                  N/A
              le_mean =     -17.213808873677
             les_mean =     296.642575068905
             stat err =       0.000434233992
             autocorr =       1.152001262751
              std dev =       0.572153207714
             le_variance =       0.327359293097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326847293294
                                         uncertainty =       0.004068795429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326847293294
                                         uncertainty =       0.004068795429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404301842
  error estimate for blocks of size 2^( 2) =       0.000414341776
  error estimate for blocks of size 2^( 3) =       0.000423785061
  error estimate for blocks of size 2^( 4) =       0.000429948029
  error estimate for blocks of size 2^( 5) =       0.000433895502
  error estimate for blocks of size 2^( 6) =       0.000435829201
  error estimate for blocks of size 2^( 7) =       0.000436511407

      target function =                  N/A
              le_mean =     -17.213803186470
             les_mean =     296.641939937911
             stat err =       0.000434046034
             autocorr =       1.152550983553
              std dev =       0.571769148197
             le_variance =       0.326919958830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325988785644
                                         uncertainty =       0.004060970221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325988785644
                                         uncertainty =       0.004060970221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403770575
  error estimate for blocks of size 2^( 2) =       0.000413845981
  error estimate for blocks of size 2^( 3) =       0.000423339449
  error estimate for blocks of size 2^( 4) =       0.000429534047
  error estimate for blocks of size 2^( 5) =       0.000433500611
  error estimate for blocks of size 2^( 6) =       0.000435444499
  error estimate for blocks of size 2^( 7) =       0.000436157026

      target function =                  N/A
              le_mean =     -17.213801144427
             les_mean =     296.641011030807
             stat err =       0.000433659046
             autocorr =       1.153526266363
              std dev =       0.571017822809
             le_variance =       0.326061353966


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213802002652        initial
     9.7656e-02     9.7656e-01             8.6981e-03       -17.213808873677  <--
     3.9062e-01     3.9062e+00             2.8437e-03       -17.213803186470
     1.5625e+00     1.5625e+01             7.8815e-04       -17.213801144427

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.7030e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.100741e-01 1 1  ON 0
 uu_1                 4.706273e-02 1 1  ON 1
 uu_2                -4.796718e-02 1 1  ON 2
 uu_3                -1.016449e-01 1 1  ON 3
 uu_4                -1.322384e-01 1 1  ON 4
 uu_5                -1.369258e-01 1 1  ON 5
 uu_6                -1.128104e-01 1 1  ON 6
 uu_7                -3.885927e-02 1 1  ON 7
 uu_8                 1.003269e-01 1 1  ON 8
 uu_9                 1.204723e-01 1 1  ON 9
 ud_0                 3.463670e-01 1 1  ON 10
 ud_1                 8.844945e-02 1 1  ON 11
 ud_2                -1.783331e-02 1 1  ON 12
 ud_3                -7.399541e-02 1 1  ON 13
 ud_4                -1.185984e-01 1 1  ON 14
 ud_5                -1.500190e-01 1 1  ON 15
 ud_6                -1.543810e-01 1 1  ON 16
 ud_7                -1.100838e-01 1 1  ON 17
 ud_8                 5.324693e-03 1 1  ON 18
 ud_9                 9.232153e-02 1 1  ON 19
 eO_0                -7.452144e-01 1 1  ON 20
 eO_1                -4.304874e-01 1 1  ON 21
 eO_2                -3.395647e-02 1 1  ON 22
 eO_3                 2.042135e-01 1 1  ON 23
 eO_4                 2.831953e-01 1 1  ON 24
 eO_5                 3.041715e-01 1 1  ON 25
 eO_6                 2.497638e-01 1 1  ON 26
 eO_7                 1.115532e-01 1 1  ON 27
 eO_8                 2.776627e-02 1 1  ON 28
 eO_9                 1.834880e-02 1 1  ON 29
eH1_0                -1.821244e-01 1 1  ON 30
eH1_1                -1.033572e-01 1 1  ON 31
eH1_2                -6.239939e-02 1 1  ON 32
eH1_3                -2.613357e-02 1 1  ON 33
eH1_4                 2.031576e-02 1 1  ON 34
eH1_5                 3.620098e-02 1 1  ON 35
eH1_6                 7.751649e-02 1 1  ON 36
eH1_7                 1.100653e-01 1 1  ON 37
eH1_8                 9.035893e-02 1 1  ON 38
eH1_9                 2.417877e-02 1 1  ON 39
eH2_0                -1.830889e-01 1 1  ON 40
eH2_1                -1.041052e-01 1 1  ON 41
eH2_2                -6.360329e-02 1 1  ON 42
eH2_3                -2.710261e-02 1 1  ON 43
eH2_4                 1.891996e-02 1 1  ON 44
eH2_5                 3.430765e-02 1 1  ON 45
eH2_6                 7.872672e-02 1 1  ON 46
eH2_7                 1.139322e-01 1 1  ON 47
eH2_8                 9.359975e-02 1 1  ON 48
eH2_9                 2.626303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1279e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2798
    reference variance = 0.274422
====================================================
  Execution time = 3.2950e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2588e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1340e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325945384797
                                         uncertainty =       0.006391145774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325945384797
                                         uncertainty =       0.006391145774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403661037
  error estimate for blocks of size 2^( 2) =       0.000414072508
  error estimate for blocks of size 2^( 3) =       0.000423385082
  error estimate for blocks of size 2^( 4) =       0.000429757250
  error estimate for blocks of size 2^( 5) =       0.000432554776
  error estimate for blocks of size 2^( 6) =       0.000434558582
  error estimate for blocks of size 2^( 7) =       0.000438149782

      target function =                  N/A
              le_mean =     -17.213775985962
             les_mean =     296.639967997107
             stat err =       0.000433755097
             autocorr =       1.154663720268
              std dev =       0.570862912750
             le_variance =       0.325884465154


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721377598596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213775985962       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213779435694       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213784312535       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213792645586       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213802970795       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213812552537       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213820999325       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213823192375       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213826624654       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213825210618       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213825377230       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213827016474       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213828957387       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213828636423       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213828997511       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213827980977       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213827778460       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.628081e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213775985962       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213778785921       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213781765903       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213786523497       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213791299882       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213793808086       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213797120756       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213797194810       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213797347291       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213796683707       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213797054221       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213797198797       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 5.949512e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213775985962       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213777582820       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213778841952       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213780424656       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213781972635       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213782265332       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213782933070       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213782872162       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213782720895       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213782785678       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.802389e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2099e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.119692e-01 1 1  ON 0
 uu_1                 4.866194e-02 1 1  ON 1
 uu_2                -4.709489e-02 1 1  ON 2
 uu_3                -1.013956e-01 1 1  ON 3
 uu_4                -1.329224e-01 1 1  ON 4
 uu_5                -1.383136e-01 1 1  ON 5
 uu_6                -1.138896e-01 1 1  ON 6
 uu_7                -4.045901e-02 1 1  ON 7
 uu_8                 9.940681e-02 1 1  ON 8
 uu_9                 1.209120e-01 1 1  ON 9
 ud_0                 3.478112e-01 1 1  ON 10
 ud_1                 8.941218e-02 1 1  ON 11
 ud_2                -1.744710e-02 1 1  ON 12
 ud_3                -7.410937e-02 1 1  ON 13
 ud_4                -1.193961e-01 1 1  ON 14
 ud_5                -1.508678e-01 1 1  ON 15
 ud_6                -1.541521e-01 1 1  ON 16
 ud_7                -1.101707e-01 1 1  ON 17
 ud_8                 3.950974e-03 1 1  ON 18
 ud_9                 9.211498e-02 1 1  ON 19
 eO_0                -7.511606e-01 1 1  ON 20
 eO_1                -4.350917e-01 1 1  ON 21
 eO_2                -3.558805e-02 1 1  ON 22
 eO_3                 2.070727e-01 1 1  ON 23
 eO_4                 2.891448e-01 1 1  ON 24
 eO_5                 3.057449e-01 1 1  ON 25
 eO_6                 2.504400e-01 1 1  ON 26
 eO_7                 1.125020e-01 1 1  ON 27
 eO_8                 2.783488e-02 1 1  ON 28
 eO_9                 1.840593e-02 1 1  ON 29
eH1_0                -1.826985e-01 1 1  ON 30
eH1_1                -1.039828e-01 1 1  ON 31
eH1_2                -6.254302e-02 1 1  ON 32
eH1_3                -2.595464e-02 1 1  ON 33
eH1_4                 1.992323e-02 1 1  ON 34
eH1_5                 3.616344e-02 1 1  ON 35
eH1_6                 7.854978e-02 1 1  ON 36
eH1_7                 1.099213e-01 1 1  ON 37
eH1_8                 9.086200e-02 1 1  ON 38
eH1_9                 2.433111e-02 1 1  ON 39
eH2_0                -1.831304e-01 1 1  ON 40
eH2_1                -1.046264e-01 1 1  ON 41
eH2_2                -6.368723e-02 1 1  ON 42
eH2_3                -2.688502e-02 1 1  ON 43
eH2_4                 1.884921e-02 1 1  ON 44
eH2_5                 3.425933e-02 1 1  ON 45
eH2_6                 7.861244e-02 1 1  ON 46
eH2_7                 1.138079e-01 1 1  ON 47
eH2_8                 9.419441e-02 1 1  ON 48
eH2_9                 2.641510e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.3355
    reference variance = 0.328959
====================================================
  Execution time = 3.2323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2272e-01
  Total weights = 2.0000e+06
  Execution time = 2.8631e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321574338776
                                         uncertainty =       0.004314811108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321574338776
                                         uncertainty =       0.004314811108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400967864
  error estimate for blocks of size 2^( 2) =       0.000411559893
  error estimate for blocks of size 2^( 3) =       0.000420192555
  error estimate for blocks of size 2^( 4) =       0.000427776281
  error estimate for blocks of size 2^( 5) =       0.000431694722
  error estimate for blocks of size 2^( 6) =       0.000434778442
  error estimate for blocks of size 2^( 7) =       0.000434939434

      target function =                  N/A
              le_mean =     -17.213798683919
             les_mean =     296.636415425481
             stat err =       0.000432297220
             autocorr =       1.162373636014
              std dev =       0.567054191206
             le_variance =       0.321550455765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323905841282
                                         uncertainty =       0.004363574173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323905841282
                                         uncertainty =       0.004363574173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402418889
  error estimate for blocks of size 2^( 2) =       0.000412928143
  error estimate for blocks of size 2^( 3) =       0.000421454557
  error estimate for blocks of size 2^( 4) =       0.000428962627
  error estimate for blocks of size 2^( 5) =       0.000432831644
  error estimate for blocks of size 2^( 6) =       0.000435927873
  error estimate for blocks of size 2^( 7) =       0.000436045872

      target function =                  N/A
              le_mean =     -17.213809882358
             les_mean =     296.639132428826
             stat err =       0.000433442004
             autocorr =       1.160126306928
              std dev =       0.569106250879
             le_variance =       0.323881924790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323963413727
                                         uncertainty =       0.004362330934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323963413727
                                         uncertainty =       0.004362330934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402454578
  error estimate for blocks of size 2^( 2) =       0.000412962507
  error estimate for blocks of size 2^( 3) =       0.000421494892
  error estimate for blocks of size 2^( 4) =       0.000429007882
  error estimate for blocks of size 2^( 5) =       0.000432884640
  error estimate for blocks of size 2^( 6) =       0.000435979084
  error estimate for blocks of size 2^( 7) =       0.000436105875

      target function =                  N/A
              le_mean =     -17.213808499918
             les_mean =     296.639142284255
             stat err =       0.000433494370
             autocorr =       1.160200852164
              std dev =       0.569156722158
             le_variance =       0.323939374378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322071229752
                                         uncertainty =       0.004324207800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322071229752
                                         uncertainty =       0.004324207800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401277501
  error estimate for blocks of size 2^( 2) =       0.000411850496
  error estimate for blocks of size 2^( 3) =       0.000420462295
  error estimate for blocks of size 2^( 4) =       0.000428031993
  error estimate for blocks of size 2^( 5) =       0.000431942296
  error estimate for blocks of size 2^( 6) =       0.000435026328
  error estimate for blocks of size 2^( 7) =       0.000435182830

      target function =                  N/A
              le_mean =     -17.213797922038
             les_mean =     296.636886004937
             stat err =       0.000432545862
             autocorr =       1.161915921304
              std dev =       0.567492083819
             le_variance =       0.322047265197


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213798683919        initial
     2.4414e-02     2.4414e-01             1.6281e-02       -17.213809882358  <--
     9.7656e-02     9.7656e-01             5.9495e-03       -17.213808499918
     3.9062e-01     3.9062e+00             1.8024e-03       -17.213797922038

*****************************************************************************
Applying the update for shift_i =   2.4414e-02     and shift_s =   2.4414e-01
*****************************************************************************

  Execution time = 4.6768e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.148432e-01 1 1  ON 0
 uu_1                 5.088677e-02 1 1  ON 1
 uu_2                -4.548613e-02 1 1  ON 2
 uu_3                -1.007048e-01 1 1  ON 3
 uu_4                -1.333969e-01 1 1  ON 4
 uu_5                -1.400152e-01 1 1  ON 5
 uu_6                -1.158629e-01 1 1  ON 6
 uu_7                -4.419851e-02 1 1  ON 7
 uu_8                 9.672767e-02 1 1  ON 8
 uu_9                 1.222079e-01 1 1  ON 9
 ud_0                 3.498949e-01 1 1  ON 10
 ud_1                 9.121217e-02 1 1  ON 11
 ud_2                -1.620971e-02 1 1  ON 12
 ud_3                -7.364878e-02 1 1  ON 13
 ud_4                -1.198870e-01 1 1  ON 14
 ud_5                -1.521263e-01 1 1  ON 15
 ud_6                -1.549287e-01 1 1  ON 16
 ud_7                -1.101879e-01 1 1  ON 17
 ud_8                 2.833741e-04 1 1  ON 18
 ud_9                 9.151722e-02 1 1  ON 19
 eO_0                -7.614953e-01 1 1  ON 20
 eO_1                -4.434013e-01 1 1  ON 21
 eO_2                -4.029811e-02 1 1  ON 22
 eO_3                 2.085284e-01 1 1  ON 23
 eO_4                 2.974208e-01 1 1  ON 24
 eO_5                 3.128110e-01 1 1  ON 25
 eO_6                 2.534905e-01 1 1  ON 26
 eO_7                 1.154760e-01 1 1  ON 27
 eO_8                 2.804673e-02 1 1  ON 28
 eO_9                 1.857698e-02 1 1  ON 29
eH1_0                -1.835441e-01 1 1  ON 30
eH1_1                -1.050454e-01 1 1  ON 31
eH1_2                -6.310311e-02 1 1  ON 32
eH1_3                -2.628928e-02 1 1  ON 33
eH1_4                 1.946637e-02 1 1  ON 34
eH1_5                 3.488196e-02 1 1  ON 35
eH1_6                 8.080361e-02 1 1  ON 36
eH1_7                 1.099637e-01 1 1  ON 37
eH1_8                 9.248859e-02 1 1  ON 38
eH1_9                 2.479963e-02 1 1  ON 39
eH2_0                -1.834244e-01 1 1  ON 40
eH2_1                -1.053172e-01 1 1  ON 41
eH2_2                -6.392192e-02 1 1  ON 42
eH2_3                -2.690356e-02 1 1  ON 43
eH2_4                 1.873013e-02 1 1  ON 44
eH2_5                 3.317651e-02 1 1  ON 45
eH2_6                 7.847647e-02 1 1  ON 46
eH2_7                 1.139248e-01 1 1  ON 47
eH2_8                 9.606573e-02 1 1  ON 48
eH2_9                 2.688229e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8873e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.3423
    reference variance = 0.29886
====================================================
  Execution time = 3.3020e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.7504e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375022050916
                                         uncertainty =       0.046716782606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375022050916
                                         uncertainty =       0.046716782606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433035750
  error estimate for blocks of size 2^( 2) =       0.000442459408
  error estimate for blocks of size 2^( 3) =       0.000450931110
  error estimate for blocks of size 2^( 4) =       0.000457995515
  error estimate for blocks of size 2^( 5) =       0.000461924264
  error estimate for blocks of size 2^( 6) =       0.000464500204
  error estimate for blocks of size 2^( 7) =       0.000466571857

      target function =                  N/A
              le_mean =     -17.213232361286
             les_mean =     296.670408057408
             stat err =       0.000462747960
             autocorr =       1.141935363189
              std dev =       0.612405030447
             le_variance =       0.375039921317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721323236129e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213232361286       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213231972670       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213233576229       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213238814461       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213242391156       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213246879964       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213246623293       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213248860311       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213252756988       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213258300398       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213264731712       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213265271590       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213265144318       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213267680584       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213267052147       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213265271815       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213269771159       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213269679826       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213268381752       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213269233590       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213269226883       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213269930062       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.213270677906       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 2.812025e-02

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213232361286       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213231995441       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213233232218       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213237989979       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213240890477       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213244023578       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213243258781       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213244012078       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213245469335       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213248788142       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213250158917       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213249766319       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213249125250       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213249643629       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213249237545       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213248527498       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213249264620       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.051368e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213232361286       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213232064905       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213232522143       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213235968753       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213237721450       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213238768789       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213238022537       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213238155628       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213238084375       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213238545916       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213239030968       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213238947706       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 3.591603e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2336e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.168148e-01 1 1  ON 0
 uu_1                 5.233255e-02 1 1  ON 1
 uu_2                -4.447314e-02 1 1  ON 2
 uu_3                -1.005404e-01 1 1  ON 3
 uu_4                -1.346083e-01 1 1  ON 4
 uu_5                -1.417917e-01 1 1  ON 5
 uu_6                -1.179027e-01 1 1  ON 6
 uu_7                -4.757722e-02 1 1  ON 7
 uu_8                 9.497783e-02 1 1  ON 8
 uu_9                 1.249091e-01 1 1  ON 9
 ud_0                 3.512603e-01 1 1  ON 10
 ud_1                 9.203417e-02 1 1  ON 11
 ud_2                -1.545634e-02 1 1  ON 12
 ud_3                -7.350158e-02 1 1  ON 13
 ud_4                -1.200155e-01 1 1  ON 14
 ud_5                -1.526039e-01 1 1  ON 15
 ud_6                -1.559244e-01 1 1  ON 16
 ud_7                -1.107490e-01 1 1  ON 17
 ud_8                -3.611857e-03 1 1  ON 18
 ud_9                 9.197825e-02 1 1  ON 19
 eO_0                -7.720089e-01 1 1  ON 20
 eO_1                -4.520148e-01 1 1  ON 21
 eO_2                -4.558349e-02 1 1  ON 22
 eO_3                 2.076864e-01 1 1  ON 23
 eO_4                 3.026778e-01 1 1  ON 24
 eO_5                 3.199327e-01 1 1  ON 25
 eO_6                 2.596249e-01 1 1  ON 26
 eO_7                 1.205385e-01 1 1  ON 27
 eO_8                 2.906720e-02 1 1  ON 28
 eO_9                 1.901970e-02 1 1  ON 29
eH1_0                -1.844715e-01 1 1  ON 30
eH1_1                -1.053381e-01 1 1  ON 31
eH1_2                -6.309785e-02 1 1  ON 32
eH1_3                -2.635308e-02 1 1  ON 33
eH1_4                 1.893177e-02 1 1  ON 34
eH1_5                 3.264707e-02 1 1  ON 35
eH1_6                 8.032141e-02 1 1  ON 36
eH1_7                 1.103836e-01 1 1  ON 37
eH1_8                 9.518613e-02 1 1  ON 38
eH1_9                 2.584084e-02 1 1  ON 39
eH2_0                -1.843735e-01 1 1  ON 40
eH2_1                -1.058266e-01 1 1  ON 41
eH2_2                -6.379873e-02 1 1  ON 42
eH2_3                -2.744747e-02 1 1  ON 43
eH2_4                 1.831957e-02 1 1  ON 44
eH2_5                 3.159878e-02 1 1  ON 45
eH2_6                 7.799631e-02 1 1  ON 46
eH2_7                 1.141076e-01 1 1  ON 47
eH2_8                 9.876635e-02 1 1  ON 48
eH2_9                 2.795013e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1574
    reference variance = 0.192719
====================================================
  Execution time = 3.2461e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 5.4490e-01
  Total weights = 2.0000e+06
  Execution time = 2.8715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.542848989939
                                         uncertainty =       0.217058247241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.542848989939
                                         uncertainty =       0.217058247241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000520869276
  error estimate for blocks of size 2^( 2) =       0.000528698155
  error estimate for blocks of size 2^( 3) =       0.000536027300
  error estimate for blocks of size 2^( 4) =       0.000541700700
  error estimate for blocks of size 2^( 5) =       0.000542479032
  error estimate for blocks of size 2^( 6) =       0.000543582285
  error estimate for blocks of size 2^( 7) =       0.000545247013

      target function =                  N/A
              le_mean =     -17.214029958604
             les_mean =     296.865436748756
             stat err =       0.000543252258
             autocorr =       1.087791344209
              std dev =       0.736620393658
             le_variance =       0.542609604353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.546984000434
                                         uncertainty =       0.219500946664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.546984000434
                                         uncertainty =       0.219500946664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000522849724
  error estimate for blocks of size 2^( 2) =       0.000530631306
  error estimate for blocks of size 2^( 3) =       0.000537890807
  error estimate for blocks of size 2^( 4) =       0.000543507235
  error estimate for blocks of size 2^( 5) =       0.000544195284
  error estimate for blocks of size 2^( 6) =       0.000545237712
  error estimate for blocks of size 2^( 7) =       0.000546909271

      target function =                  N/A
              le_mean =     -17.214029604876
             les_mean =     296.869558631002
             stat err =       0.000544962375
             autocorr =       1.086373774696
              std dev =       0.739421170125
             le_variance =       0.546743666829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.547486636413
                                         uncertainty =       0.219797525103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.547486636413
                                         uncertainty =       0.219797525103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000523089725
  error estimate for blocks of size 2^( 2) =       0.000530875661
  error estimate for blocks of size 2^( 3) =       0.000538147145
  error estimate for blocks of size 2^( 4) =       0.000543779569
  error estimate for blocks of size 2^( 5) =       0.000544478667
  error estimate for blocks of size 2^( 6) =       0.000545519577
  error estimate for blocks of size 2^( 7) =       0.000547186517

      target function =                  N/A
              le_mean =     -17.214030092588
             les_mean =     296.870077476159
             stat err =       0.000545241082
             autocorr =       1.086487573725
              std dev =       0.739760583731
             le_variance =       0.547245721243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543949513007
                                         uncertainty =       0.217745825011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543949513007
                                         uncertainty =       0.217745825011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521396964
  error estimate for blocks of size 2^( 2) =       0.000529215282
  error estimate for blocks of size 2^( 3) =       0.000536532828
  error estimate for blocks of size 2^( 4) =       0.000542198536
  error estimate for blocks of size 2^( 5) =       0.000542963403
  error estimate for blocks of size 2^( 6) =       0.000544048798
  error estimate for blocks of size 2^( 7) =       0.000545710978

      target function =                  N/A
              le_mean =     -17.214027454208
             les_mean =     296.866450510493
             stat err =       0.000543730429
             autocorr =       1.087502539709
              std dev =       0.737366657858
             le_variance =       0.543709588121


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214029958604        initial
     6.1035e-03     6.1035e-02             2.8120e-02       -17.214029604876
     2.4414e-02     2.4414e-01             1.0514e-02       -17.214030092588  <--
     9.7656e-02     9.7656e-01             3.5916e-03       -17.214027454208

*****************************************************************************
Applying the update for shift_i =   2.4414e-02     and shift_s =   2.4414e-01
*****************************************************************************

  Execution time = 4.6952e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.168148e-01 1 1  ON 0
 uu_1                 5.233255e-02 1 1  ON 1
 uu_2                -4.447314e-02 1 1  ON 2
 uu_3                -1.005404e-01 1 1  ON 3
 uu_4                -1.346083e-01 1 1  ON 4
 uu_5                -1.417917e-01 1 1  ON 5
 uu_6                -1.179027e-01 1 1  ON 6
 uu_7                -4.757722e-02 1 1  ON 7
 uu_8                 9.497783e-02 1 1  ON 8
 uu_9                 1.249091e-01 1 1  ON 9
 ud_0                 3.512603e-01 1 1  ON 10
 ud_1                 9.203417e-02 1 1  ON 11
 ud_2                -1.545634e-02 1 1  ON 12
 ud_3                -7.350158e-02 1 1  ON 13
 ud_4                -1.200155e-01 1 1  ON 14
 ud_5                -1.526039e-01 1 1  ON 15
 ud_6                -1.559244e-01 1 1  ON 16
 ud_7                -1.107490e-01 1 1  ON 17
 ud_8                -3.611857e-03 1 1  ON 18
 ud_9                 9.197825e-02 1 1  ON 19
 eO_0                -7.720089e-01 1 1  ON 20
 eO_1                -4.520148e-01 1 1  ON 21
 eO_2                -4.558349e-02 1 1  ON 22
 eO_3                 2.076864e-01 1 1  ON 23
 eO_4                 3.026778e-01 1 1  ON 24
 eO_5                 3.199327e-01 1 1  ON 25
 eO_6                 2.596249e-01 1 1  ON 26
 eO_7                 1.205385e-01 1 1  ON 27
 eO_8                 2.906720e-02 1 1  ON 28
 eO_9                 1.901970e-02 1 1  ON 29
eH1_0                -1.844715e-01 1 1  ON 30
eH1_1                -1.053381e-01 1 1  ON 31
eH1_2                -6.309785e-02 1 1  ON 32
eH1_3                -2.635308e-02 1 1  ON 33
eH1_4                 1.893177e-02 1 1  ON 34
eH1_5                 3.264707e-02 1 1  ON 35
eH1_6                 8.032141e-02 1 1  ON 36
eH1_7                 1.103836e-01 1 1  ON 37
eH1_8                 9.518613e-02 1 1  ON 38
eH1_9                 2.584084e-02 1 1  ON 39
eH2_0                -1.843735e-01 1 1  ON 40
eH2_1                -1.058266e-01 1 1  ON 41
eH2_2                -6.379873e-02 1 1  ON 42
eH2_3                -2.744747e-02 1 1  ON 43
eH2_4                 1.831957e-02 1 1  ON 44
eH2_5                 3.159878e-02 1 1  ON 45
eH2_6                 7.799631e-02 1 1  ON 46
eH2_7                 1.141076e-01 1 1  ON 47
eH2_8                 9.876635e-02 1 1  ON 48
eH2_9                 2.795013e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9294e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1024
    reference variance = 0.561143
====================================================
  Execution time = 3.2911e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2967e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329727934746
                                         uncertainty =       0.004115966059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329727934746
                                         uncertainty =       0.004115966059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405996676
  error estimate for blocks of size 2^( 2) =       0.000416197551
  error estimate for blocks of size 2^( 3) =       0.000425158883
  error estimate for blocks of size 2^( 4) =       0.000431813029
  error estimate for blocks of size 2^( 5) =       0.000435708218
  error estimate for blocks of size 2^( 6) =       0.000438018726
  error estimate for blocks of size 2^( 7) =       0.000437658599

      target function =                  N/A
              le_mean =     -17.213855929735
             les_mean =     296.646502405907
             stat err =       0.000435799643
             autocorr =       1.152202426926
              std dev =       0.574166004791
             le_variance =       0.329666601058


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721385592974e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213855929735       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213855731224       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213851574486       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213853034313       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213856470309       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213852988776       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213854488904       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213854838036       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213859516891       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213869898655       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213872471719       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213875067753       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213878663348       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213878898415       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213880065998       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213880762797       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213880958743       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213883700495       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213883615865       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213882867030       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213881812201       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213881908810       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.213882320215       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 2.669468e-02

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213855929735       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213855743018       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213851981912       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213853069051       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213856333690       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213853381408       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213854655170       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213854621597       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213858327274       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213862350893       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213862430305       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213863031802       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213863468893       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213863147400       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213863204998       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213863155627       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 6.792976e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213855929735       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213855778870       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213853045759       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213853383787       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213856052129       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213854327547       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213855046300       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213854710973       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213856626368       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213856794279       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213856632638       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213856685257       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.986221e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1908e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.166511e-01 1 1  ON 0
 uu_1                 5.210330e-02 1 1  ON 1
 uu_2                -4.476298e-02 1 1  ON 2
 uu_3                -1.009771e-01 1 1  ON 3
 uu_4                -1.348158e-01 1 1  ON 4
 uu_5                -1.423163e-01 1 1  ON 5
 uu_6                -1.191459e-01 1 1  ON 6
 uu_7                -4.806655e-02 1 1  ON 7
 uu_8                 9.326211e-02 1 1  ON 8
 uu_9                 1.270748e-01 1 1  ON 9
 ud_0                 3.526370e-01 1 1  ON 10
 ud_1                 9.380550e-02 1 1  ON 11
 ud_2                -1.421600e-02 1 1  ON 12
 ud_3                -7.284270e-02 1 1  ON 13
 ud_4                -1.205142e-01 1 1  ON 14
 ud_5                -1.542720e-01 1 1  ON 15
 ud_6                -1.573248e-01 1 1  ON 16
 ud_7                -1.114232e-01 1 1  ON 17
 ud_8                -6.705919e-03 1 1  ON 18
 ud_9                 9.196187e-02 1 1  ON 19
 eO_0                -7.788019e-01 1 1  ON 20
 eO_1                -4.582647e-01 1 1  ON 21
 eO_2                -5.083872e-02 1 1  ON 22
 eO_3                 2.049781e-01 1 1  ON 23
 eO_4                 3.046569e-01 1 1  ON 24
 eO_5                 3.255743e-01 1 1  ON 25
 eO_6                 2.661774e-01 1 1  ON 26
 eO_7                 1.260334e-01 1 1  ON 27
 eO_8                 2.983746e-02 1 1  ON 28
 eO_9                 1.926611e-02 1 1  ON 29
eH1_0                -1.852092e-01 1 1  ON 30
eH1_1                -1.066759e-01 1 1  ON 31
eH1_2                -6.446185e-02 1 1  ON 32
eH1_3                -2.720127e-02 1 1  ON 33
eH1_4                 1.824712e-02 1 1  ON 34
eH1_5                 3.300202e-02 1 1  ON 35
eH1_6                 7.948557e-02 1 1  ON 36
eH1_7                 1.108371e-01 1 1  ON 37
eH1_8                 9.873456e-02 1 1  ON 38
eH1_9                 2.703796e-02 1 1  ON 39
eH2_0                -1.867116e-01 1 1  ON 40
eH2_1                -1.071863e-01 1 1  ON 41
eH2_2                -6.515981e-02 1 1  ON 42
eH2_3                -2.805404e-02 1 1  ON 43
eH2_4                 1.791354e-02 1 1  ON 44
eH2_5                 3.179005e-02 1 1  ON 45
eH2_6                 7.990745e-02 1 1  ON 46
eH2_7                 1.142573e-01 1 1  ON 47
eH2_8                 1.015020e-01 1 1  ON 48
eH2_9                 2.868258e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1616
    reference variance = 0.142272
====================================================
  Execution time = 3.4194e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2435e-01
  Total weights = 2.0000e+06
  Execution time = 2.8689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324244127199
                                         uncertainty =       0.004185896211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324244127199
                                         uncertainty =       0.004185896211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402638408
  error estimate for blocks of size 2^( 2) =       0.000412879962
  error estimate for blocks of size 2^( 3) =       0.000421931417
  error estimate for blocks of size 2^( 4) =       0.000428715190
  error estimate for blocks of size 2^( 5) =       0.000432378525
  error estimate for blocks of size 2^( 6) =       0.000435151651
  error estimate for blocks of size 2^( 7) =       0.000436552780

      target function =                  N/A
              le_mean =     -17.213961188247
             les_mean =     296.644695003730
             stat err =       0.000433199536
             autocorr =       1.157565476126
              std dev =       0.569416697488
             le_variance =       0.324235375378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324845501998
                                         uncertainty =       0.004197199469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324845501998
                                         uncertainty =       0.004197199469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403011521
  error estimate for blocks of size 2^( 2) =       0.000413232674
  error estimate for blocks of size 2^( 3) =       0.000422238680
  error estimate for blocks of size 2^( 4) =       0.000428974718
  error estimate for blocks of size 2^( 5) =       0.000432588696
  error estimate for blocks of size 2^( 6) =       0.000435330597
  error estimate for blocks of size 2^( 7) =       0.000436710381

      target function =                  N/A
              le_mean =     -17.213966533751
             les_mean =     296.645480234711
             stat err =       0.000433401098
             autocorr =       1.156498547763
              std dev =       0.569944358711
             le_variance =       0.324836572027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324504464003
                                         uncertainty =       0.004176517415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324504464003
                                         uncertainty =       0.004176517415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402799919
  error estimate for blocks of size 2^( 2) =       0.000413042889
  error estimate for blocks of size 2^( 3) =       0.000422062662
  error estimate for blocks of size 2^( 4) =       0.000428807413
  error estimate for blocks of size 2^( 5) =       0.000432428126
  error estimate for blocks of size 2^( 6) =       0.000435171053
  error estimate for blocks of size 2^( 7) =       0.000436569540

      target function =                  N/A
              le_mean =     -17.213968631253
             les_mean =     296.645211424829
             stat err =       0.000433244033
             autocorr =       1.156874987148
              std dev =       0.569645108207
             le_variance =       0.324495549304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324129807207
                                         uncertainty =       0.004179047917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324129807207
                                         uncertainty =       0.004179047917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402567385
  error estimate for blocks of size 2^( 2) =       0.000412814066
  error estimate for blocks of size 2^( 3) =       0.000421860037
  error estimate for blocks of size 2^( 4) =       0.000428635058
  error estimate for blocks of size 2^( 5) =       0.000432289722
  error estimate for blocks of size 2^( 6) =       0.000435053844
  error estimate for blocks of size 2^( 7) =       0.000436458547

      target function =                  N/A
              le_mean =     -17.213960461416
             les_mean =     296.644555604067
             stat err =       0.000433109293
             autocorr =       1.157491554973
              std dev =       0.569316255643
             le_variance =       0.324120998939


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213961188247        initial
     6.1035e-03     6.1035e-02             2.6695e-02       -17.213966533751
     2.4414e-02     2.4414e-01             6.7930e-03       -17.213968631253  <--
     9.7656e-02     9.7656e-01             1.9862e-03       -17.213960461416

*****************************************************************************
Applying the update for shift_i =   2.4414e-02     and shift_s =   2.4414e-01
*****************************************************************************

  Execution time = 4.8667e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.166511e-01 1 1  ON 0
 uu_1                 5.210330e-02 1 1  ON 1
 uu_2                -4.476298e-02 1 1  ON 2
 uu_3                -1.009771e-01 1 1  ON 3
 uu_4                -1.348158e-01 1 1  ON 4
 uu_5                -1.423163e-01 1 1  ON 5
 uu_6                -1.191459e-01 1 1  ON 6
 uu_7                -4.806655e-02 1 1  ON 7
 uu_8                 9.326211e-02 1 1  ON 8
 uu_9                 1.270748e-01 1 1  ON 9
 ud_0                 3.526370e-01 1 1  ON 10
 ud_1                 9.380550e-02 1 1  ON 11
 ud_2                -1.421600e-02 1 1  ON 12
 ud_3                -7.284270e-02 1 1  ON 13
 ud_4                -1.205142e-01 1 1  ON 14
 ud_5                -1.542720e-01 1 1  ON 15
 ud_6                -1.573248e-01 1 1  ON 16
 ud_7                -1.114232e-01 1 1  ON 17
 ud_8                -6.705919e-03 1 1  ON 18
 ud_9                 9.196187e-02 1 1  ON 19
 eO_0                -7.788019e-01 1 1  ON 20
 eO_1                -4.582647e-01 1 1  ON 21
 eO_2                -5.083872e-02 1 1  ON 22
 eO_3                 2.049781e-01 1 1  ON 23
 eO_4                 3.046569e-01 1 1  ON 24
 eO_5                 3.255743e-01 1 1  ON 25
 eO_6                 2.661774e-01 1 1  ON 26
 eO_7                 1.260334e-01 1 1  ON 27
 eO_8                 2.983746e-02 1 1  ON 28
 eO_9                 1.926611e-02 1 1  ON 29
eH1_0                -1.852092e-01 1 1  ON 30
eH1_1                -1.066759e-01 1 1  ON 31
eH1_2                -6.446185e-02 1 1  ON 32
eH1_3                -2.720127e-02 1 1  ON 33
eH1_4                 1.824712e-02 1 1  ON 34
eH1_5                 3.300202e-02 1 1  ON 35
eH1_6                 7.948557e-02 1 1  ON 36
eH1_7                 1.108371e-01 1 1  ON 37
eH1_8                 9.873456e-02 1 1  ON 38
eH1_9                 2.703796e-02 1 1  ON 39
eH2_0                -1.867116e-01 1 1  ON 40
eH2_1                -1.071863e-01 1 1  ON 41
eH2_2                -6.515981e-02 1 1  ON 42
eH2_3                -2.805404e-02 1 1  ON 43
eH2_4                 1.791354e-02 1 1  ON 44
eH2_5                 3.179005e-02 1 1  ON 45
eH2_6                 7.990745e-02 1 1  ON 46
eH2_7                 1.142573e-01 1 1  ON 47
eH2_8                 1.015020e-01 1 1  ON 48
eH2_9                 2.868258e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.0581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2727
    reference variance = 0.264514
====================================================
  Execution time = 3.2988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2907e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328959228476
                                         uncertainty =       0.003114217570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328959228476
                                         uncertainty =       0.003114217570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405631915
  error estimate for blocks of size 2^( 2) =       0.000415376970
  error estimate for blocks of size 2^( 3) =       0.000424481782
  error estimate for blocks of size 2^( 4) =       0.000430938907
  error estimate for blocks of size 2^( 5) =       0.000434183528
  error estimate for blocks of size 2^( 6) =       0.000436391604
  error estimate for blocks of size 2^( 7) =       0.000436176272

      target function =                  N/A
              le_mean =     -17.214645875491
             les_mean =     296.673106954990
             stat err =       0.000434422578
             autocorr =       1.146992401187
              std dev =       0.573650155566
             le_variance =       0.329074500981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721464587549e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214645875491       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214647622344       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214647868148       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214646970871       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214650372961       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214648005549       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214647366502       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214644949163       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214647751120       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214655192112       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214657940325       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214657572555       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214659181445       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214662705953       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214663332006       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214663390882       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214664191041       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214664970675       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214663904231       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214663534309       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.214664029428       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.214664840302       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.214666185925       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 2.020304e-02

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214645875491       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214647499556       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214647770830       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214646737494       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214649581372       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214647276607       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214646688036       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214644974965       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214647200080       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214651233690       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214651506852       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214651081966       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214651719977       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214652373309       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214652236379       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214652143745       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 4.947600e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214645875491       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214647143140       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214647430830       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214646322573       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214647857934       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214646175647       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214645826241       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214645219401       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214646425476       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214647469114       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214647293081       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.431193e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2182e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.181150e-01 1 1  ON 0
 uu_1                 5.376446e-02 1 1  ON 1
 uu_2                -4.339421e-02 1 1  ON 2
 uu_3                -9.992057e-02 1 1  ON 3
 uu_4                -1.343379e-01 1 1  ON 4
 uu_5                -1.422825e-01 1 1  ON 5
 uu_6                -1.211681e-01 1 1  ON 6
 uu_7                -5.233048e-02 1 1  ON 7
 uu_8                 8.945057e-02 1 1  ON 8
 uu_9                 1.286184e-01 1 1  ON 9
 ud_0                 3.535923e-01 1 1  ON 10
 ud_1                 9.478654e-02 1 1  ON 11
 ud_2                -1.305941e-02 1 1  ON 12
 ud_3                -7.145797e-02 1 1  ON 13
 ud_4                -1.194555e-01 1 1  ON 14
 ud_5                -1.531896e-01 1 1  ON 15
 ud_6                -1.579752e-01 1 1  ON 16
 ud_7                -1.146301e-01 1 1  ON 17
 ud_8                -1.085551e-02 1 1  ON 18
 ud_9                 9.146523e-02 1 1  ON 19
 eO_0                -7.837495e-01 1 1  ON 20
 eO_1                -4.629965e-01 1 1  ON 21
 eO_2                -5.445479e-02 1 1  ON 22
 eO_3                 2.029352e-01 1 1  ON 23
 eO_4                 3.050131e-01 1 1  ON 24
 eO_5                 3.303764e-01 1 1  ON 25
 eO_6                 2.709520e-01 1 1  ON 26
 eO_7                 1.306095e-01 1 1  ON 27
 eO_8                 3.033302e-02 1 1  ON 28
 eO_9                 1.936941e-02 1 1  ON 29
eH1_0                -1.855959e-01 1 1  ON 30
eH1_1                -1.071373e-01 1 1  ON 31
eH1_2                -6.461836e-02 1 1  ON 32
eH1_3                -2.763262e-02 1 1  ON 33
eH1_4                 1.832393e-02 1 1  ON 34
eH1_5                 3.178432e-02 1 1  ON 35
eH1_6                 7.857677e-02 1 1  ON 36
eH1_7                 1.111321e-01 1 1  ON 37
eH1_8                 1.011700e-01 1 1  ON 38
eH1_9                 2.757377e-02 1 1  ON 39
eH2_0                -1.854705e-01 1 1  ON 40
eH2_1                -1.069418e-01 1 1  ON 41
eH2_2                -6.493167e-02 1 1  ON 42
eH2_3                -2.792725e-02 1 1  ON 43
eH2_4                 1.761519e-02 1 1  ON 44
eH2_5                 3.078343e-02 1 1  ON 45
eH2_6                 7.657744e-02 1 1  ON 46
eH2_7                 1.137082e-01 1 1  ON 47
eH2_8                 1.040714e-01 1 1  ON 48
eH2_9                 2.938380e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2151
    reference variance = 0.135772
====================================================
  Execution time = 3.2143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2719e-01
  Total weights = 2.0000e+06
  Execution time = 2.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327202424632
                                         uncertainty =       0.003658642312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327202424632
                                         uncertainty =       0.003658642312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404455339
  error estimate for blocks of size 2^( 2) =       0.000413987317
  error estimate for blocks of size 2^( 3) =       0.000423201769
  error estimate for blocks of size 2^( 4) =       0.000430135376
  error estimate for blocks of size 2^( 5) =       0.000435320950
  error estimate for blocks of size 2^( 6) =       0.000437588918
  error estimate for blocks of size 2^( 7) =       0.000439571138

      target function =                  N/A
              le_mean =     -17.213655620165
             les_mean =     296.637107888996
             stat err =       0.000435654095
             autocorr =       1.160225633270
              std dev =       0.571986226180
             le_variance =       0.327168242939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327455249889
                                         uncertainty =       0.003664949793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327455249889
                                         uncertainty =       0.003664949793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404611450
  error estimate for blocks of size 2^( 2) =       0.000414122497
  error estimate for blocks of size 2^( 3) =       0.000423305316
  error estimate for blocks of size 2^( 4) =       0.000430200243
  error estimate for blocks of size 2^( 5) =       0.000435357187
  error estimate for blocks of size 2^( 6) =       0.000437642767
  error estimate for blocks of size 2^( 7) =       0.000439642046

      target function =                  N/A
              le_mean =     -17.213659764200
             les_mean =     296.637503164153
             stat err =       0.000435710561
             autocorr =       1.159631055027
              std dev =       0.572206999459
             le_variance =       0.327420850230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327264617675
                                         uncertainty =       0.003656979498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327264617675
                                         uncertainty =       0.003656979498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404493684
  error estimate for blocks of size 2^( 2) =       0.000414013275
  error estimate for blocks of size 2^( 3) =       0.000423208425
  error estimate for blocks of size 2^( 4) =       0.000430118901
  error estimate for blocks of size 2^( 5) =       0.000435291490
  error estimate for blocks of size 2^( 6) =       0.000437590497
  error estimate for blocks of size 2^( 7) =       0.000439597629

      target function =                  N/A
              le_mean =     -17.213657731164
             les_mean =     296.637242602592
             stat err =       0.000435649629
             autocorr =       1.159981887163
              std dev =       0.572040453604
             le_variance =       0.327230280559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327125560580
                                         uncertainty =       0.003654932350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327125560580
                                         uncertainty =       0.003654932350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404407818
  error estimate for blocks of size 2^( 2) =       0.000413938483
  error estimate for blocks of size 2^( 3) =       0.000423151023
  error estimate for blocks of size 2^( 4) =       0.000430081721
  error estimate for blocks of size 2^( 5) =       0.000435267555
  error estimate for blocks of size 2^( 6) =       0.000437543667
  error estimate for blocks of size 2^( 7) =       0.000439532900

      target function =                  N/A
              le_mean =     -17.213653459025
             les_mean =     296.636956610430
             stat err =       0.000435606461
             autocorr =       1.160244556326
              std dev =       0.571919021006
             le_variance =       0.327091366589


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213655620165        initial
     6.1035e-03     6.1035e-02             2.0203e-02       -17.213659764200  <--
     2.4414e-02     2.4414e-01             4.9476e-03       -17.213657731164
     9.7656e-02     9.7656e-01             1.4312e-03       -17.213653459025

*****************************************************************************
Applying the update for shift_i =   6.1035e-03     and shift_s =   6.1035e-02
*****************************************************************************

  Execution time = 4.6615e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.194978e-01 1 1  ON 0
 uu_1                 5.500942e-02 1 1  ON 1
 uu_2                -4.232186e-02 1 1  ON 2
 uu_3                -9.913650e-02 1 1  ON 3
 uu_4                -1.340191e-01 1 1  ON 4
 uu_5                -1.426551e-01 1 1  ON 5
 uu_6                -1.237622e-01 1 1  ON 6
 uu_7                -5.701338e-02 1 1  ON 7
 uu_8                 8.003649e-02 1 1  ON 8
 uu_9                 1.331257e-01 1 1  ON 9
 ud_0                 3.554006e-01 1 1  ON 10
 ud_1                 9.657429e-02 1 1  ON 11
 ud_2                -1.135599e-02 1 1  ON 12
 ud_3                -6.991766e-02 1 1  ON 13
 ud_4                -1.182478e-01 1 1  ON 14
 ud_5                -1.526185e-01 1 1  ON 15
 ud_6                -1.586931e-01 1 1  ON 16
 ud_7                -1.177158e-01 1 1  ON 17
 ud_8                -1.990662e-02 1 1  ON 18
 ud_9                 8.993172e-02 1 1  ON 19
 eO_0                -7.947805e-01 1 1  ON 20
 eO_1                -4.736019e-01 1 1  ON 21
 eO_2                -6.383568e-02 1 1  ON 22
 eO_3                 1.959329e-01 1 1  ON 23
 eO_4                 3.025435e-01 1 1  ON 24
 eO_5                 3.371728e-01 1 1  ON 25
 eO_6                 2.862048e-01 1 1  ON 26
 eO_7                 1.462364e-01 1 1  ON 27
 eO_8                 3.215335e-02 1 1  ON 28
 eO_9                 1.965660e-02 1 1  ON 29
eH1_0                -1.866366e-01 1 1  ON 30
eH1_1                -1.082884e-01 1 1  ON 31
eH1_2                -6.567671e-02 1 1  ON 32
eH1_3                -2.865421e-02 1 1  ON 33
eH1_4                 1.724669e-02 1 1  ON 34
eH1_5                 2.987736e-02 1 1  ON 35
eH1_6                 7.511088e-02 1 1  ON 36
eH1_7                 1.114919e-01 1 1  ON 37
eH1_8                 1.090512e-01 1 1  ON 38
eH1_9                 2.937402e-02 1 1  ON 39
eH2_0                -1.858325e-01 1 1  ON 40
eH2_1                -1.073753e-01 1 1  ON 41
eH2_2                -6.541927e-02 1 1  ON 42
eH2_3                -2.832039e-02 1 1  ON 43
eH2_4                 1.686648e-02 1 1  ON 44
eH2_5                 2.924332e-02 1 1  ON 45
eH2_6                 7.161420e-02 1 1  ON 46
eH2_7                 1.119702e-01 1 1  ON 47
eH2_8                 1.121768e-01 1 1  ON 48
eH2_9                 3.171353e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8803e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2362
    reference variance = 0.480115
====================================================
  Execution time = 3.2793e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3590e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335901003047
                                         uncertainty =       0.007351640948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335901003047
                                         uncertainty =       0.007351640948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409816085
  error estimate for blocks of size 2^( 2) =       0.000419812452
  error estimate for blocks of size 2^( 3) =       0.000429413185
  error estimate for blocks of size 2^( 4) =       0.000435502232
  error estimate for blocks of size 2^( 5) =       0.000439355729
  error estimate for blocks of size 2^( 6) =       0.000440377075
  error estimate for blocks of size 2^( 7) =       0.000440482095

      target function =                  N/A
              le_mean =     -17.214388160133
             les_mean =     296.671058006261
             stat err =       0.000438929283
             autocorr =       1.147125967342
              std dev =       0.579567464983
             le_variance =       0.335898446466


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721438816013e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214388160133       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214390010445       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214390523233       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214391904686       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214393776622       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214400012527       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214400353337       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214399958778       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214402799176       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214400097362       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214404019238       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214415678678       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214420837720       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214421776351       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214419209200       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214421884138       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214424110674       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214425320342       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214428555093       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214428876950       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.214434583265       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.214435010270       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.214434001289       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.214437084271       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.214436993804       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.214438699242       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.214436309145       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.214436540508       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-03 is 9.678953e-02

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214388160133       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214389972797       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214390412926       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214391768449       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214393611038       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214399611416       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214399881946       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214399388378       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214401802478       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214399448995       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214402041071       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214409210908       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214411432472       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214410745257       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214408880753       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214409156760       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214409926483       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214410097300       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214410750137       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214410379330       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.214411357114       residual = 6.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 2.066646e-02

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214388160133       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214389836373       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214390054869       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214391315644       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214393039719       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214398229894       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214398309897       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214397683668       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214399030466       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214397532145       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214398332895       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214400632851       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214400878873       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214400322367       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214399857629       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 4.960049e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1854e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.187942e-01 1 1  ON 0
 uu_1                 5.390146e-02 1 1  ON 1
 uu_2                -4.361309e-02 1 1  ON 2
 uu_3                -1.005463e-01 1 1  ON 3
 uu_4                -1.360377e-01 1 1  ON 4
 uu_5                -1.460794e-01 1 1  ON 5
 uu_6                -1.262408e-01 1 1  ON 6
 uu_7                -5.780067e-02 1 1  ON 7
 uu_8                 7.383540e-02 1 1  ON 8
 uu_9                 1.398161e-01 1 1  ON 9
 ud_0                 3.572325e-01 1 1  ON 10
 ud_1                 9.841058e-02 1 1  ON 11
 ud_2                -9.927138e-03 1 1  ON 12
 ud_3                -6.870860e-02 1 1  ON 13
 ud_4                -1.172975e-01 1 1  ON 14
 ud_5                -1.528622e-01 1 1  ON 15
 ud_6                -1.626081e-01 1 1  ON 16
 ud_7                -1.212341e-01 1 1  ON 17
 ud_8                -2.892506e-02 1 1  ON 18
 ud_9                 8.733138e-02 1 1  ON 19
 eO_0                -8.070885e-01 1 1  ON 20
 eO_1                -4.854364e-01 1 1  ON 21
 eO_2                -7.509004e-02 1 1  ON 22
 eO_3                 1.859726e-01 1 1  ON 23
 eO_4                 3.004440e-01 1 1  ON 24
 eO_5                 3.468810e-01 1 1  ON 25
 eO_6                 2.961696e-01 1 1  ON 26
 eO_7                 1.669029e-01 1 1  ON 27
 eO_8                 3.644781e-02 1 1  ON 28
 eO_9                 2.056880e-02 1 1  ON 29
eH1_0                -1.883894e-01 1 1  ON 30
eH1_1                -1.101831e-01 1 1  ON 31
eH1_2                -6.776659e-02 1 1  ON 32
eH1_3                -2.999031e-02 1 1  ON 33
eH1_4                 1.535913e-02 1 1  ON 34
eH1_5                 2.896656e-02 1 1  ON 35
eH1_6                 7.101158e-02 1 1  ON 36
eH1_7                 1.096181e-01 1 1  ON 37
eH1_8                 1.200769e-01 1 1  ON 38
eH1_9                 3.326518e-02 1 1  ON 39
eH2_0                -1.902574e-01 1 1  ON 40
eH2_1                -1.105207e-01 1 1  ON 41
eH2_2                -6.806737e-02 1 1  ON 42
eH2_3                -3.066168e-02 1 1  ON 43
eH2_4                 1.450473e-02 1 1  ON 44
eH2_5                 2.604873e-02 1 1  ON 45
eH2_6                 6.937661e-02 1 1  ON 46
eH2_7                 1.127178e-01 1 1  ON 47
eH2_8                 1.236381e-01 1 1  ON 48
eH2_9                 3.694797e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2209
    reference variance = 0.187736
====================================================
  Execution time = 3.2023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3131e-01
  Total weights = 2.0000e+06
  Execution time = 2.8612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330779995319
                                         uncertainty =       0.003794323962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330779995319
                                         uncertainty =       0.003794323962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406731567
  error estimate for blocks of size 2^( 2) =       0.000416799519
  error estimate for blocks of size 2^( 3) =       0.000425846234
  error estimate for blocks of size 2^( 4) =       0.000432704660
  error estimate for blocks of size 2^( 5) =       0.000435758066
  error estimate for blocks of size 2^( 6) =       0.000437458418
  error estimate for blocks of size 2^( 7) =       0.000435605089

      target function =                  N/A
              le_mean =     -17.213828211471
             les_mean =     296.646742664322
             stat err =       0.000435381558
             autocorr =       1.145840842115
              std dev =       0.575205298754
             le_variance =       0.330861135715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331634528387
                                         uncertainty =       0.003803168072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331634528387
                                         uncertainty =       0.003803168072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407259923
  error estimate for blocks of size 2^( 2) =       0.000417295141
  error estimate for blocks of size 2^( 3) =       0.000426300026
  error estimate for blocks of size 2^( 4) =       0.000433122671
  error estimate for blocks of size 2^( 5) =       0.000436154165
  error estimate for blocks of size 2^( 6) =       0.000437848286
  error estimate for blocks of size 2^( 7) =       0.000435944327

      target function =                  N/A
              le_mean =     -17.213840647042
             les_mean =     296.648030945777
             stat err =       0.000435767362
             autocorr =       1.144896031602
              std dev =       0.575952506624
             le_variance =       0.331721289887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331720322820
                                         uncertainty =       0.003804482396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331720322820
                                         uncertainty =       0.003804482396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407311701
  error estimate for blocks of size 2^( 2) =       0.000417353241
  error estimate for blocks of size 2^( 3) =       0.000426372718
  error estimate for blocks of size 2^( 4) =       0.000433209031
  error estimate for blocks of size 2^( 5) =       0.000436256570
  error estimate for blocks of size 2^( 6) =       0.000437977600
  error estimate for blocks of size 2^( 7) =       0.000436056176

      target function =                  N/A
              le_mean =     -17.213833503006
             les_mean =     296.647869346885
             stat err =       0.000435874844
             autocorr =       1.145169670709
              std dev =       0.576025731696
             le_variance =       0.331805643576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330977756228
                                         uncertainty =       0.003796598137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330977756228
                                         uncertainty =       0.003796598137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406853468
  error estimate for blocks of size 2^( 2) =       0.000416912045
  error estimate for blocks of size 2^( 3) =       0.000425950336
  error estimate for blocks of size 2^( 4) =       0.000432802942
  error estimate for blocks of size 2^( 5) =       0.000435855499
  error estimate for blocks of size 2^( 6) =       0.000437569090
  error estimate for blocks of size 2^( 7) =       0.000435693374

      target function =                  N/A
              le_mean =     -17.213823506442
             les_mean =     296.646779033643
             stat err =       0.000435480226
             autocorr =       1.145673416800
              std dev =       0.575377691805
             le_variance =       0.331059488227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213828211471        initial
     1.5259e-03     1.5259e-02             9.6790e-02       -17.213840647042  <--
     6.1035e-03     6.1035e-02             2.0666e-02       -17.213833503006
     2.4414e-02     2.4414e-01             4.9600e-03       -17.213823506442

*****************************************************************************
Applying the update for shift_i =   1.5259e-03     and shift_s =   1.5259e-02
*****************************************************************************

  Execution time = 4.6447e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.151170e-01 1 1  ON 0
 uu_1                 5.001534e-02 1 1  ON 1
 uu_2                -4.768695e-02 1 1  ON 2
 uu_3                -1.049168e-01 1 1  ON 3
 uu_4                -1.410589e-01 1 1  ON 4
 uu_5                -1.523035e-01 1 1  ON 5
 uu_6                -1.346692e-01 1 1  ON 6
 uu_7                -6.851447e-02 1 1  ON 7
 uu_8                 5.086966e-02 1 1  ON 8
 uu_9                 1.610917e-01 1 1  ON 9
 ud_0                 3.593079e-01 1 1  ON 10
 ud_1                 1.004558e-01 1 1  ON 11
 ud_2                -8.171318e-03 1 1  ON 12
 ud_3                -6.732616e-02 1 1  ON 13
 ud_4                -1.165242e-01 1 1  ON 14
 ud_5                -1.535854e-01 1 1  ON 15
 ud_6                -1.673322e-01 1 1  ON 16
 ud_7                -1.308748e-01 1 1  ON 17
 ud_8                -5.442181e-02 1 1  ON 18
 ud_9                 7.502930e-02 1 1  ON 19
 eO_0                -8.373474e-01 1 1  ON 20
 eO_1                -5.151261e-01 1 1  ON 21
 eO_2                -1.034323e-01 1 1  ON 22
 eO_3                 1.607981e-01 1 1  ON 23
 eO_4                 2.831247e-01 1 1  ON 24
 eO_5                 3.461075e-01 1 1  ON 25
 eO_6                 3.238035e-01 1 1  ON 26
 eO_7                 2.430259e-01 1 1  ON 27
 eO_8                 5.369806e-02 1 1  ON 28
 eO_9                 2.390273e-02 1 1  ON 29
eH1_0                -1.949421e-01 1 1  ON 30
eH1_1                -1.165697e-01 1 1  ON 31
eH1_2                -7.428187e-02 1 1  ON 32
eH1_3                -3.599531e-02 1 1  ON 33
eH1_4                 9.132502e-03 1 1  ON 34
eH1_5                 2.257259e-02 1 1  ON 35
eH1_6                 6.352727e-02 1 1  ON 36
eH1_7                 9.859142e-02 1 1  ON 37
eH1_8                 1.580653e-01 1 1  ON 38
eH1_9                 4.813934e-02 1 1  ON 39
eH2_0                -2.006464e-01 1 1  ON 40
eH2_1                -1.201116e-01 1 1  ON 41
eH2_2                -7.747201e-02 1 1  ON 42
eH2_3                -3.972513e-02 1 1  ON 43
eH2_4                 5.608939e-03 1 1  ON 44
eH2_5                 1.652335e-02 1 1  ON 45
eH2_6                 6.186981e-02 1 1  ON 46
eH2_7                 1.065541e-01 1 1  ON 47
eH2_8                 1.629877e-01 1 1  ON 48
eH2_9                 5.697960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8307e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2508
    reference variance = 0.456088
====================================================
  Execution time = 3.3230e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3859e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338710340465
                                         uncertainty =       0.008319341683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338710340465
                                         uncertainty =       0.008319341683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411456591
  error estimate for blocks of size 2^( 2) =       0.000421212649
  error estimate for blocks of size 2^( 3) =       0.000430008683
  error estimate for blocks of size 2^( 4) =       0.000436311638
  error estimate for blocks of size 2^( 5) =       0.000440930945
  error estimate for blocks of size 2^( 6) =       0.000443518098
  error estimate for blocks of size 2^( 7) =       0.000446581000

      target function =                  N/A
              le_mean =     -17.214458130405
             les_mean =     296.676161607060
             stat err =       0.000441835421
             autocorr =       1.153116032418
              std dev =       0.581887491608
             le_variance =       0.338593052889


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721445813041e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-04, overlap shift 3.8147e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214458130405       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214459731273       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214459269737       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214462499766       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214465237350       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214464388249       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214467058647       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214469585071       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214469899574       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214473515747       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214474374837       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214476635662       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214478681769       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214479673662       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214480116097       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214478417909       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214479160184       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214478417262       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214473414752       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214474112788       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.214479253125       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.214483007380       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.214491759461       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.214495292612       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.214498929256       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.214499022491       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.214499943178       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.214502600665       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.214504116430       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.214504446666       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-04 is 2.219657e-01

solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214458130405       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214459721965       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214459273294       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214462433332       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214465184389       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214464365220       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214466970173       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214469452051       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214469722125       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214473106571       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214473869230       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214475862638       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214477582717       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214478319629       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214478558043       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214476908536       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214477431805       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214476747281       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214472883872       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214473449556       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.214476801675       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.214479112803       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.214483030076       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.214484118189       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.214485293725       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.214484760317       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.214484895450       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-03 is 5.698153e-02

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214458130405       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214459685787       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214459286825       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214462176820       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214464959728       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214464273169       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214466637380       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214468946852       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214469064666       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214471701051       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214472177478       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214473449921       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214474362208       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214474571928       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214474495793       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214473293762       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214473484171       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214473040838       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214471330879       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214471653055       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.214472849959       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 1.460108e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230182 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2376e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.101352e-01 1 1  ON 0
 uu_1                 4.546485e-02 1 1  ON 1
 uu_2                -5.225376e-02 1 1  ON 2
 uu_3                -1.094809e-01 1 1  ON 3
 uu_4                -1.448212e-01 1 1  ON 4
 uu_5                -1.550005e-01 1 1  ON 5
 uu_6                -1.386246e-01 1 1  ON 6
 uu_7                -8.469646e-02 1 1  ON 7
 uu_8                 2.686073e-02 1 1  ON 8
 uu_9                 1.762966e-01 1 1  ON 9
 ud_0                 3.572611e-01 1 1  ON 10
 ud_1                 9.828941e-02 1 1  ON 11
 ud_2                -1.026700e-02 1 1  ON 12
 ud_3                -6.969837e-02 1 1  ON 13
 ud_4                -1.190253e-01 1 1  ON 14
 ud_5                -1.557502e-01 1 1  ON 15
 ud_6                -1.662303e-01 1 1  ON 16
 ud_7                -1.377961e-01 1 1  ON 17
 ud_8                -6.373916e-02 1 1  ON 18
 ud_9                 6.864661e-02 1 1  ON 19
 eO_0                -8.476654e-01 1 1  ON 20
 eO_1                -5.246244e-01 1 1  ON 21
 eO_2                -1.128051e-01 1 1  ON 22
 eO_3                 1.513998e-01 1 1  ON 23
 eO_4                 2.667675e-01 1 1  ON 24
 eO_5                 3.198344e-01 1 1  ON 25
 eO_6                 3.183956e-01 1 1  ON 26
 eO_7                 3.000075e-01 1 1  ON 27
 eO_8                 7.078489e-02 1 1  ON 28
 eO_9                 3.102220e-02 1 1  ON 29
eH1_0                -2.012607e-01 1 1  ON 30
eH1_1                -1.214750e-01 1 1  ON 31
eH1_2                -7.939832e-02 1 1  ON 32
eH1_3                -4.185483e-02 1 1  ON 33
eH1_4                 5.510760e-03 1 1  ON 34
eH1_5                 1.852759e-02 1 1  ON 35
eH1_6                 6.581083e-02 1 1  ON 36
eH1_7                 8.389280e-02 1 1  ON 37
eH1_8                 1.746598e-01 1 1  ON 38
eH1_9                 6.357566e-02 1 1  ON 39
eH2_0                -2.015010e-01 1 1  ON 40
eH2_1                -1.218203e-01 1 1  ON 41
eH2_2                -7.946011e-02 1 1  ON 42
eH2_3                -4.215286e-02 1 1  ON 43
eH2_4                 3.905925e-03 1 1  ON 44
eH2_5                 1.850102e-02 1 1  ON 45
eH2_6                 6.007997e-02 1 1  ON 46
eH2_7                 7.290535e-02 1 1  ON 47
eH2_8                 1.851083e-01 1 1  ON 48
eH2_9                 7.073451e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2754
    reference variance = 0.310147
====================================================
  Execution time = 3.2049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.4588e-01
  Total weights = 2.0000e+06
  Execution time = 2.9474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346022982566
                                         uncertainty =       0.009828034231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346022982566
                                         uncertainty =       0.009828034231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415910321
  error estimate for blocks of size 2^( 2) =       0.000425761404
  error estimate for blocks of size 2^( 3) =       0.000434747340
  error estimate for blocks of size 2^( 4) =       0.000441792237
  error estimate for blocks of size 2^( 5) =       0.000446992537
  error estimate for blocks of size 2^( 6) =       0.000449399958
  error estimate for blocks of size 2^( 7) =       0.000452289592

      target function =                  N/A
              le_mean =     -17.214326596470
             les_mean =     296.679002786935
             stat err =       0.000447618581
             autocorr =       1.158288693569
              std dev =       0.588186016474
             le_variance =       0.345962789976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346329500929
                                         uncertainty =       0.009862560803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346329500929
                                         uncertainty =       0.009862560803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416094074
  error estimate for blocks of size 2^( 2) =       0.000425937853
  error estimate for blocks of size 2^( 3) =       0.000434916837
  error estimate for blocks of size 2^( 4) =       0.000441923881
  error estimate for blocks of size 2^( 5) =       0.000447078700
  error estimate for blocks of size 2^( 6) =       0.000449424310
  error estimate for blocks of size 2^( 7) =       0.000452371036

      target function =                  N/A
              le_mean =     -17.214370076585
             les_mean =     296.680805517534
             stat err =       0.000447699482
             autocorr =       1.157684241470
              std dev =       0.588445882858
             le_variance =       0.346268557052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346002753661
                                         uncertainty =       0.009853631797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346002753661
                                         uncertainty =       0.009853631797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415897949
  error estimate for blocks of size 2^( 2) =       0.000425749719
  error estimate for blocks of size 2^( 3) =       0.000434748995
  error estimate for blocks of size 2^( 4) =       0.000441784415
  error estimate for blocks of size 2^( 5) =       0.000446980311
  error estimate for blocks of size 2^( 6) =       0.000449313475
  error estimate for blocks of size 2^( 7) =       0.000452319050

      target function =                  N/A
              le_mean =     -17.214351938229
             les_mean =     296.679854688517
             stat err =       0.000447599313
             autocorr =       1.158257882872
              std dev =       0.588168520292
             le_variance =       0.345942208263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345992472199
                                         uncertainty =       0.009838355981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345992472199
                                         uncertainty =       0.009838355981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415891885
  error estimate for blocks of size 2^( 2) =       0.000425737231
  error estimate for blocks of size 2^( 3) =       0.000434721385
  error estimate for blocks of size 2^( 4) =       0.000441757352
  error estimate for blocks of size 2^( 5) =       0.000446963654
  error estimate for blocks of size 2^( 6) =       0.000449348500
  error estimate for blocks of size 2^( 7) =       0.000452287241

      target function =                  N/A
              le_mean =     -17.214317826780
             les_mean =     296.678670187863
             stat err =       0.000447589187
             autocorr =       1.158239256503
              std dev =       0.588159943742
             le_variance =       0.345932119422


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214326596470        initial
     3.8147e-04     3.8147e-03             2.2197e-01       -17.214370076585  <--
     1.5259e-03     1.5259e-02             5.6982e-02       -17.214351938229
     6.1035e-03     6.1035e-02             1.4601e-02       -17.214317826780

*****************************************************************************
Applying the update for shift_i =   3.8147e-04     and shift_s =   3.8147e-03
*****************************************************************************

  Execution time = 4.7184e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.941446e-01 1 1  ON 0
 uu_1                 2.963246e-02 1 1  ON 1
 uu_2                -6.817308e-02 1 1  ON 2
 uu_3                -1.256189e-01 1 1  ON 3
 uu_4                -1.606145e-01 1 1  ON 4
 uu_5                -1.711319e-01 1 1  ON 5
 uu_6                -1.549078e-01 1 1  ON 6
 uu_7                -1.183027e-01 1 1  ON 7
 uu_8                -3.948656e-02 1 1  ON 8
 uu_9                 2.161513e-01 1 1  ON 9
 ud_0                 3.516668e-01 1 1  ON 10
 ud_1                 9.260094e-02 1 1  ON 11
 ud_2                -1.601146e-02 1 1  ON 12
 ud_3                -7.576988e-02 1 1  ON 13
 ud_4                -1.255199e-01 1 1  ON 14
 ud_5                -1.625056e-01 1 1  ON 15
 ud_6                -1.727721e-01 1 1  ON 16
 ud_7                -1.483130e-01 1 1  ON 17
 ud_8                -9.518263e-02 1 1  ON 18
 ud_9                 4.396270e-02 1 1  ON 19
 eO_0                -8.925555e-01 1 1  ON 20
 eO_1                -5.685190e-01 1 1  ON 21
 eO_2                -1.559933e-01 1 1  ON 22
 eO_3                 1.099443e-01 1 1  ON 23
 eO_4                 2.239848e-01 1 1  ON 24
 eO_5                 2.909200e-01 1 1  ON 25
 eO_6                 3.042248e-01 1 1  ON 26
 eO_7                 4.649917e-01 1 1  ON 27
 eO_8                 1.250754e-01 1 1  ON 28
 eO_9                 5.383079e-02 1 1  ON 29
eH1_0                -2.156283e-01 1 1  ON 30
eH1_1                -1.350727e-01 1 1  ON 31
eH1_2                -9.295108e-02 1 1  ON 32
eH1_3                -5.587519e-02 1 1  ON 33
eH1_4                -6.633110e-03 1 1  ON 34
eH1_5                 6.050227e-03 1 1  ON 35
eH1_6                 5.403795e-02 1 1  ON 36
eH1_7                 4.876177e-02 1 1  ON 37
eH1_8                 2.210661e-01 1 1  ON 38
eH1_9                 1.113898e-01 1 1  ON 39
eH2_0                -2.066541e-01 1 1  ON 40
eH2_1                -1.280510e-01 1 1  ON 41
eH2_2                -8.574498e-02 1 1  ON 42
eH2_3                -4.874071e-02 1 1  ON 43
eH2_4                -2.134638e-03 1 1  ON 44
eH2_5                 1.426200e-02 1 1  ON 45
eH2_6                 4.351997e-02 1 1  ON 46
eH2_7                 3.030514e-04 1 1  ON 47
eH2_8                 2.472097e-01 1 1  ON 48
eH2_9                 1.122618e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9566e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1698
    reference variance = 0.429395
====================================================
  Execution time = 3.3340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2867e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328626486039
                                         uncertainty =       0.004351354377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328626486039
                                         uncertainty =       0.004351354377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405383724
  error estimate for blocks of size 2^( 2) =       0.000415118425
  error estimate for blocks of size 2^( 3) =       0.000423799092
  error estimate for blocks of size 2^( 4) =       0.000429756964
  error estimate for blocks of size 2^( 5) =       0.000433486676
  error estimate for blocks of size 2^( 6) =       0.000437285488
  error estimate for blocks of size 2^( 7) =       0.000439317186

      target function =                  N/A
              le_mean =     -17.213801947908
             les_mean =     296.643649265450
             stat err =       0.000434961578
             autocorr =       1.151248759548
              std dev =       0.573299160977
             le_variance =       0.328671927977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721380194791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-05, overlap shift 9.5367e-04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213801947908       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213806661834       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213810969445       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213808115987       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213809155501       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213816920168       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213817415990       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213821564549       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213821249709       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213830912657       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213835252440       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213835015038       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213836805651       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213836824082       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213836922527       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213842318226       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213844208100       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213843363456       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213842174510       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213844903392       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213846112205       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213844219115       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.213849858865       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.213850602765       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.213849221211       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.213848691226       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-05 is 7.373180e-02

solving harmonic davidson linear method for identity shift 3.8147e-04, overlap shift 3.8147e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213801947908       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213806655502       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213810958405       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213808113698       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213809139190       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213816899276       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213817383366       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213821496368       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213821177195       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213830720142       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213834981173       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213834711513       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213836445982       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213836433345       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213836518874       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213841670481       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213843457519       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213842624575       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213841407368       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213843889992       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213844946975       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213843124538       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.213848139299       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.213848688939       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.213847382928       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.213846879137       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-04 is 6.560981e-02

solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213801947908       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213806630343       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213810914489       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213808104609       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213809075346       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213816816202       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213817254466       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213821228451       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213820893684       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213829977716       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213833942835       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213833560136       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213835092232       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213834973969       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213835021104       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213839331498       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213840789509       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213840003555       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213838753673       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213840518046       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213841171917       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213839655508       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.213843003437       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.213843123050       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.213842158617       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.213841788018       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-03 is 4.565533e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2405e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.923357e-01 1 1  ON 0
 uu_1                 2.747436e-02 1 1  ON 1
 uu_2                -7.032408e-02 1 1  ON 2
 uu_3                -1.281328e-01 1 1  ON 3
 uu_4                -1.649815e-01 1 1  ON 4
 uu_5                -1.767601e-01 1 1  ON 5
 uu_6                -1.628773e-01 1 1  ON 6
 uu_7                -1.115180e-01 1 1  ON 7
 uu_8                -2.802173e-02 1 1  ON 8
 uu_9                 1.993340e-01 1 1  ON 9
 ud_0                 3.522024e-01 1 1  ON 10
 ud_1                 9.298311e-02 1 1  ON 11
 ud_2                -1.573527e-02 1 1  ON 12
 ud_3                -7.521885e-02 1 1  ON 13
 ud_4                -1.246996e-01 1 1  ON 14
 ud_5                -1.628258e-01 1 1  ON 15
 ud_6                -1.769355e-01 1 1  ON 16
 ud_7                -1.532856e-01 1 1  ON 17
 ud_8                -9.721417e-02 1 1  ON 18
 ud_9                 3.705331e-02 1 1  ON 19
 eO_0                -9.062090e-01 1 1  ON 20
 eO_1                -5.841716e-01 1 1  ON 21
 eO_2                -1.711235e-01 1 1  ON 22
 eO_3                 9.648876e-02 1 1  ON 23
 eO_4                 2.198148e-01 1 1  ON 24
 eO_5                 3.044631e-01 1 1  ON 25
 eO_6                 3.364027e-01 1 1  ON 26
 eO_7                 4.619868e-01 1 1  ON 27
 eO_8                 1.400388e-01 1 1  ON 28
 eO_9                 5.778452e-02 1 1  ON 29
eH1_0                -2.146892e-01 1 1  ON 30
eH1_1                -1.367104e-01 1 1  ON 31
eH1_2                -9.435369e-02 1 1  ON 32
eH1_3                -5.620749e-02 1 1  ON 33
eH1_4                -1.017325e-02 1 1  ON 34
eH1_5                 4.778538e-03 1 1  ON 35
eH1_6                 4.637929e-02 1 1  ON 36
eH1_7                 6.310197e-02 1 1  ON 37
eH1_8                 2.167001e-01 1 1  ON 38
eH1_9                 1.137911e-01 1 1  ON 39
eH2_0                -2.176031e-01 1 1  ON 40
eH2_1                -1.383383e-01 1 1  ON 41
eH2_2                -9.671732e-02 1 1  ON 42
eH2_3                -5.817537e-02 1 1  ON 43
eH2_4                -1.131219e-02 1 1  ON 44
eH2_5                 6.083925e-04 1 1  ON 45
eH2_6                 4.411851e-02 1 1  ON 46
eH2_7                 6.591286e-02 1 1  ON 47
eH2_8                 2.399443e-01 1 1  ON 48
eH2_9                 1.145349e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1535
    reference variance = 0.230205
====================================================
  Execution time = 3.2037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2481e-01
  Total weights = 2.0000e+06
  Execution time = 2.8728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324363343279
                                         uncertainty =       0.003249430882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324363343279
                                         uncertainty =       0.003249430882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402738272
  error estimate for blocks of size 2^( 2) =       0.000412831477
  error estimate for blocks of size 2^( 3) =       0.000421081306
  error estimate for blocks of size 2^( 4) =       0.000427137862
  error estimate for blocks of size 2^( 5) =       0.000430563647
  error estimate for blocks of size 2^( 6) =       0.000432934216
  error estimate for blocks of size 2^( 7) =       0.000435780152

      target function =                  N/A
              le_mean =     -17.213889498352
             les_mean =     296.642387730612
             stat err =       0.000431603969
             autocorr =       1.148484281791
              std dev =       0.569557926225
             le_variance =       0.324396231326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324833682132
                                         uncertainty =       0.003252885839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324833682132
                                         uncertainty =       0.003252885839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403030210
  error estimate for blocks of size 2^( 2) =       0.000413107761
  error estimate for blocks of size 2^( 3) =       0.000421337804
  error estimate for blocks of size 2^( 4) =       0.000427368041
  error estimate for blocks of size 2^( 5) =       0.000430794034
  error estimate for blocks of size 2^( 6) =       0.000433187008
  error estimate for blocks of size 2^( 7) =       0.000436057991

      target function =                  N/A
              le_mean =     -17.213826336713
             les_mean =     296.640683688512
             stat err =       0.000431851769
             autocorr =       1.148138296931
              std dev =       0.569970789111
             le_variance =       0.324866700440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325493261719
                                         uncertainty =       0.003255342118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325493261719
                                         uncertainty =       0.003255342118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403439180
  error estimate for blocks of size 2^( 2) =       0.000413553376
  error estimate for blocks of size 2^( 3) =       0.000421824027
  error estimate for blocks of size 2^( 4) =       0.000427879651
  error estimate for blocks of size 2^( 5) =       0.000431344389
  error estimate for blocks of size 2^( 6) =       0.000433784107
  error estimate for blocks of size 2^( 7) =       0.000436679768

      target function =                  N/A
              le_mean =     -17.213877391743
             les_mean =     296.643101039663
             stat err =       0.000432421979
             autocorr =       1.148839538535
              std dev =       0.570549160432
             le_variance =       0.325526344470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324649142472
                                         uncertainty =       0.003251231168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324649142472
                                         uncertainty =       0.003251231168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402915666
  error estimate for blocks of size 2^( 2) =       0.000412990594
  error estimate for blocks of size 2^( 3) =       0.000421221382
  error estimate for blocks of size 2^( 4) =       0.000427249590
  error estimate for blocks of size 2^( 5) =       0.000430675516
  error estimate for blocks of size 2^( 6) =       0.000433059383
  error estimate for blocks of size 2^( 7) =       0.000435916940

      target function =                  N/A
              le_mean =     -17.213830382743
             les_mean =     296.640638350571
             stat err =       0.000431725357
             autocorr =       1.148118747284
              std dev =       0.569808798682
             le_variance =       0.324682067055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213889498352        initial  <--
     9.5367e-05     9.5367e-04             7.3732e-02       -17.213826336713
     3.8147e-04     3.8147e-03             6.5610e-02       -17.213877391743
     1.5259e-03     1.5259e-02             4.5655e-02       -17.213830382743

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.5239
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.941446e-01 1 1  ON 0
 uu_1                 2.963246e-02 1 1  ON 1
 uu_2                -6.817308e-02 1 1  ON 2
 uu_3                -1.256189e-01 1 1  ON 3
 uu_4                -1.606145e-01 1 1  ON 4
 uu_5                -1.711319e-01 1 1  ON 5
 uu_6                -1.549078e-01 1 1  ON 6
 uu_7                -1.183027e-01 1 1  ON 7
 uu_8                -3.948656e-02 1 1  ON 8
 uu_9                 2.161513e-01 1 1  ON 9
 ud_0                 3.516668e-01 1 1  ON 10
 ud_1                 9.260094e-02 1 1  ON 11
 ud_2                -1.601146e-02 1 1  ON 12
 ud_3                -7.576988e-02 1 1  ON 13
 ud_4                -1.255199e-01 1 1  ON 14
 ud_5                -1.625056e-01 1 1  ON 15
 ud_6                -1.727721e-01 1 1  ON 16
 ud_7                -1.483130e-01 1 1  ON 17
 ud_8                -9.518263e-02 1 1  ON 18
 ud_9                 4.396270e-02 1 1  ON 19
 eO_0                -8.925555e-01 1 1  ON 20
 eO_1                -5.685190e-01 1 1  ON 21
 eO_2                -1.559933e-01 1 1  ON 22
 eO_3                 1.099443e-01 1 1  ON 23
 eO_4                 2.239848e-01 1 1  ON 24
 eO_5                 2.909200e-01 1 1  ON 25
 eO_6                 3.042248e-01 1 1  ON 26
 eO_7                 4.649917e-01 1 1  ON 27
 eO_8                 1.250754e-01 1 1  ON 28
 eO_9                 5.383079e-02 1 1  ON 29
eH1_0                -2.156283e-01 1 1  ON 30
eH1_1                -1.350727e-01 1 1  ON 31
eH1_2                -9.295108e-02 1 1  ON 32
eH1_3                -5.587519e-02 1 1  ON 33
eH1_4                -6.633110e-03 1 1  ON 34
eH1_5                 6.050227e-03 1 1  ON 35
eH1_6                 5.403795e-02 1 1  ON 36
eH1_7                 4.876177e-02 1 1  ON 37
eH1_8                 2.210661e-01 1 1  ON 38
eH1_9                 1.113898e-01 1 1  ON 39
eH2_0                -2.066541e-01 1 1  ON 40
eH2_1                -1.280510e-01 1 1  ON 41
eH2_2                -8.574498e-02 1 1  ON 42
eH2_3                -4.874071e-02 1 1  ON 43
eH2_4                -2.134638e-03 1 1  ON 44
eH2_5                 1.426200e-02 1 1  ON 45
eH2_6                 4.351997e-02 1 1  ON 46
eH2_7                 3.030514e-04 1 1  ON 47
eH2_8                 2.472097e-01 1 1  ON 48
eH2_9                 1.122618e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8934e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.254
    reference variance = 0.253989
====================================================
  Execution time = 3.2750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2866e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328666747207
                                         uncertainty =       0.005079196289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328666747207
                                         uncertainty =       0.005079196289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405375297
  error estimate for blocks of size 2^( 2) =       0.000415052842
  error estimate for blocks of size 2^( 3) =       0.000423881122
  error estimate for blocks of size 2^( 4) =       0.000430073881
  error estimate for blocks of size 2^( 5) =       0.000433962380
  error estimate for blocks of size 2^( 6) =       0.000435317010
  error estimate for blocks of size 2^( 7) =       0.000433736546

      target function =                  N/A
              le_mean =     -17.213580949302
             les_mean =     296.636027197349
             stat err =       0.000433272454
             autocorr =       1.142372126438
              std dev =       0.573287243453
             le_variance =       0.328658263506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721358094930e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213580949302       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213585018366       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213593945908       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213595266224       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213598125151       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213600797881       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213603186038       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213605484600       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213609945634       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213613630743       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213614451257       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213614570743       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213618834099       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213620500405       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213622687913       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213621018241       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213620774159       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213621724500       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213623513636       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213624277362       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213625179471       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213627018998       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.213627419843       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.213629327694       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.213628013134       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.213629065463       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.213628307039       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-04 is 3.981402e-02

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213580949302       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213584952490       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213593810638       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213595106492       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213597870092       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213600422611       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213602591378       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213604766060       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213608886739       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213612085904       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213612642978       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213612635582       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213616170439       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213617284611       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213618772527       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213616889125       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213616772569       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213617264414       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213618302165       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213618419717       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213618730897       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213619618262       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.213619685025       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-03 is 2.016244e-02

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213580949302       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213584709017       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213593298458       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213594495830       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213596926719       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213599058684       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213600549166       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213602334139       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213605429332       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213607361435       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213607329875       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213607159143       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213609020839       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213609393319       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213609784000       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213608515466       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213608570490       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 8.402119e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273183 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1984e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.937181e-01 1 1  ON 0
 uu_1                 2.915770e-02 1 1  ON 1
 uu_2                -6.841564e-02 1 1  ON 2
 uu_3                -1.258937e-01 1 1  ON 3
 uu_4                -1.619646e-01 1 1  ON 4
 uu_5                -1.737224e-01 1 1  ON 5
 uu_6                -1.585176e-01 1 1  ON 6
 uu_7                -1.107104e-01 1 1  ON 7
 uu_8                -3.795625e-02 1 1  ON 8
 uu_9                 2.096779e-01 1 1  ON 9
 ud_0                 3.530335e-01 1 1  ON 10
 ud_1                 9.360904e-02 1 1  ON 11
 ud_2                -1.478086e-02 1 1  ON 12
 ud_3                -7.417461e-02 1 1  ON 13
 ud_4                -1.236752e-01 1 1  ON 14
 ud_5                -1.610830e-01 1 1  ON 15
 ud_6                -1.717928e-01 1 1  ON 16
 ud_7                -1.491278e-01 1 1  ON 17
 ud_8                -9.919297e-02 1 1  ON 18
 ud_9                 3.905943e-02 1 1  ON 19
 eO_0                -8.978170e-01 1 1  ON 20
 eO_1                -5.754987e-01 1 1  ON 21
 eO_2                -1.628500e-01 1 1  ON 22
 eO_3                 1.037488e-01 1 1  ON 23
 eO_4                 2.239337e-01 1 1  ON 24
 eO_5                 3.075133e-01 1 1  ON 25
 eO_6                 3.163227e-01 1 1  ON 26
 eO_7                 4.589517e-01 1 1  ON 27
 eO_8                 1.279174e-01 1 1  ON 28
 eO_9                 5.384316e-02 1 1  ON 29
eH1_0                -2.128986e-01 1 1  ON 30
eH1_1                -1.345293e-01 1 1  ON 31
eH1_2                -9.260301e-02 1 1  ON 32
eH1_3                -5.492134e-02 1 1  ON 33
eH1_4                -8.991492e-03 1 1  ON 34
eH1_5                 2.552432e-03 1 1  ON 35
eH1_6                 4.732474e-02 1 1  ON 36
eH1_7                 5.745733e-02 1 1  ON 37
eH1_8                 2.185577e-01 1 1  ON 38
eH1_9                 1.119431e-01 1 1  ON 39
eH2_0                -2.089430e-01 1 1  ON 40
eH2_1                -1.304386e-01 1 1  ON 41
eH2_2                -8.799370e-02 1 1  ON 42
eH2_3                -5.051810e-02 1 1  ON 43
eH2_4                -4.316638e-03 1 1  ON 44
eH2_5                 6.137960e-03 1 1  ON 45
eH2_6                 4.711310e-02 1 1  ON 46
eH2_7                 2.046549e-02 1 1  ON 47
eH2_8                 2.433777e-01 1 1  ON 48
eH2_9                 1.117360e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.253
    reference variance = 0.182175
====================================================
  Execution time = 3.2260e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1919e-01
  Total weights = 2.0000e+06
  Execution time = 2.8774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319243892932
                                         uncertainty =       0.002762904005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319243892932
                                         uncertainty =       0.002762904005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399450195
  error estimate for blocks of size 2^( 2) =       0.000409607577
  error estimate for blocks of size 2^( 3) =       0.000418425881
  error estimate for blocks of size 2^( 4) =       0.000424977826
  error estimate for blocks of size 2^( 5) =       0.000428369448
  error estimate for blocks of size 2^( 6) =       0.000430281387
  error estimate for blocks of size 2^( 7) =       0.000433302938

      target function =                  N/A
              le_mean =     -17.213252512962
             les_mean =     296.615182831534
             stat err =       0.000429232900
             autocorr =       1.154677571739
              std dev =       0.564907882840
             le_variance =       0.319120916095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319370203101
                                         uncertainty =       0.002763621649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319370203101
                                         uncertainty =       0.002763621649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399529186
  error estimate for blocks of size 2^( 2) =       0.000409667878
  error estimate for blocks of size 2^( 3) =       0.000418440640
  error estimate for blocks of size 2^( 4) =       0.000424965352
  error estimate for blocks of size 2^( 5) =       0.000428363915
  error estimate for blocks of size 2^( 6) =       0.000430250287
  error estimate for blocks of size 2^( 7) =       0.000433301666

      target function =                  N/A
              le_mean =     -17.213223399559
             les_mean =     296.614306784362
             stat err =       0.000429220305
             autocorr =       1.154153298441
              std dev =       0.565019593327
             le_variance =       0.319247140844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319539512956
                                         uncertainty =       0.002761072116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319539512956
                                         uncertainty =       0.002761072116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399635227
  error estimate for blocks of size 2^( 2) =       0.000409777077
  error estimate for blocks of size 2^( 3) =       0.000418542748
  error estimate for blocks of size 2^( 4) =       0.000425066125
  error estimate for blocks of size 2^( 5) =       0.000428485217
  error estimate for blocks of size 2^( 6) =       0.000430360411
  error estimate for blocks of size 2^( 7) =       0.000433434464

      target function =                  N/A
              le_mean =     -17.213238559072
             les_mean =     296.614998161758
             stat err =       0.000429336554
             autocorr =       1.154165811042
              std dev =       0.565169558583
             le_variance =       0.319416629949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319145456219
                                         uncertainty =       0.002758464351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319145456219
                                         uncertainty =       0.002758464351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399388716
  error estimate for blocks of size 2^( 2) =       0.000409528775
  error estimate for blocks of size 2^( 3) =       0.000418316831
  error estimate for blocks of size 2^( 4) =       0.000424849407
  error estimate for blocks of size 2^( 5) =       0.000428241746
  error estimate for blocks of size 2^( 6) =       0.000430134760
  error estimate for blocks of size 2^( 7) =       0.000433171078

      target function =                  N/A
              le_mean =     -17.213223305123
             les_mean =     296.614079085509
             stat err =       0.000429099248
             autocorr =       1.154313900578
              std dev =       0.564820938875
             le_variance =       0.319022692991


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213252512962        initial  <--
     9.5367e-04     9.5367e-03             3.9814e-02       -17.213223399559
     3.8147e-03     3.8147e-02             2.0162e-02       -17.213238559072
     1.5259e-02     1.5259e-01             8.4021e-03       -17.213223305123

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.7830
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.941446e-01 1 1  ON 0
 uu_1                 2.963246e-02 1 1  ON 1
 uu_2                -6.817308e-02 1 1  ON 2
 uu_3                -1.256189e-01 1 1  ON 3
 uu_4                -1.606145e-01 1 1  ON 4
 uu_5                -1.711319e-01 1 1  ON 5
 uu_6                -1.549078e-01 1 1  ON 6
 uu_7                -1.183027e-01 1 1  ON 7
 uu_8                -3.948656e-02 1 1  ON 8
 uu_9                 2.161513e-01 1 1  ON 9
 ud_0                 3.516668e-01 1 1  ON 10
 ud_1                 9.260094e-02 1 1  ON 11
 ud_2                -1.601146e-02 1 1  ON 12
 ud_3                -7.576988e-02 1 1  ON 13
 ud_4                -1.255199e-01 1 1  ON 14
 ud_5                -1.625056e-01 1 1  ON 15
 ud_6                -1.727721e-01 1 1  ON 16
 ud_7                -1.483130e-01 1 1  ON 17
 ud_8                -9.518263e-02 1 1  ON 18
 ud_9                 4.396270e-02 1 1  ON 19
 eO_0                -8.925555e-01 1 1  ON 20
 eO_1                -5.685190e-01 1 1  ON 21
 eO_2                -1.559933e-01 1 1  ON 22
 eO_3                 1.099443e-01 1 1  ON 23
 eO_4                 2.239848e-01 1 1  ON 24
 eO_5                 2.909200e-01 1 1  ON 25
 eO_6                 3.042248e-01 1 1  ON 26
 eO_7                 4.649917e-01 1 1  ON 27
 eO_8                 1.250754e-01 1 1  ON 28
 eO_9                 5.383079e-02 1 1  ON 29
eH1_0                -2.156283e-01 1 1  ON 30
eH1_1                -1.350727e-01 1 1  ON 31
eH1_2                -9.295108e-02 1 1  ON 32
eH1_3                -5.587519e-02 1 1  ON 33
eH1_4                -6.633110e-03 1 1  ON 34
eH1_5                 6.050227e-03 1 1  ON 35
eH1_6                 5.403795e-02 1 1  ON 36
eH1_7                 4.876177e-02 1 1  ON 37
eH1_8                 2.210661e-01 1 1  ON 38
eH1_9                 1.113898e-01 1 1  ON 39
eH2_0                -2.066541e-01 1 1  ON 40
eH2_1                -1.280510e-01 1 1  ON 41
eH2_2                -8.574498e-02 1 1  ON 42
eH2_3                -4.874071e-02 1 1  ON 43
eH2_4                -2.134638e-03 1 1  ON 44
eH2_5                 1.426200e-02 1 1  ON 45
eH2_6                 4.351997e-02 1 1  ON 46
eH2_7                 3.030514e-04 1 1  ON 47
eH2_8                 2.472097e-01 1 1  ON 48
eH2_9                 1.122618e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1947
    reference variance = 0.266965
====================================================
  Execution time = 3.3199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3193e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332046003286
                                         uncertainty =       0.006540415970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332046003286
                                         uncertainty =       0.006540415970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407389208
  error estimate for blocks of size 2^( 2) =       0.000417142910
  error estimate for blocks of size 2^( 3) =       0.000426493215
  error estimate for blocks of size 2^( 4) =       0.000432485115
  error estimate for blocks of size 2^( 5) =       0.000435955310
  error estimate for blocks of size 2^( 6) =       0.000436955167
  error estimate for blocks of size 2^( 7) =       0.000436777799

      target function =                  N/A
              le_mean =     -17.213617451575
             les_mean =     296.640557536769
             stat err =       0.000435543348
             autocorr =       1.142993418409
              std dev =       0.576135343100
             le_variance =       0.331931933569


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721361745157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213617451575       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213622370098       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213629591687       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213637127204       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213641681748       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213646250406       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213646528071       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213648788582       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213644918801       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213644225628       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213641541311       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213641481941       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213643565659       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213643302753       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213642598620       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213644555145       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213645315079       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213645342074       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213644765462       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213645054818       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213644826156       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 1.220301e-02

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213617451575       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213621794283       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213628089436       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213634208258       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213637728449       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213641865875       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213641101654       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213641709932       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213639942966       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213637653518       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213638024826       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213637775120       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213638671509       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213638513667       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 4.025056e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213617451575       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213620409251       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213624514119       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213627802323       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213630520661       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213632548747       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213631604365       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213631685139       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213631318311       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213630831139       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213630655078       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.638799e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2373e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.935748e-01 1 1  ON 0
 uu_1                 2.921269e-02 1 1  ON 1
 uu_2                -6.866107e-02 1 1  ON 2
 uu_3                -1.261030e-01 1 1  ON 3
 uu_4                -1.619627e-01 1 1  ON 4
 uu_5                -1.716579e-01 1 1  ON 5
 uu_6                -1.559415e-01 1 1  ON 6
 uu_7                -1.148417e-01 1 1  ON 7
 uu_8                -3.850056e-02 1 1  ON 8
 uu_9                 2.154112e-01 1 1  ON 9
 ud_0                 3.505499e-01 1 1  ON 10
 ud_1                 9.160653e-02 1 1  ON 11
 ud_2                -1.708837e-02 1 1  ON 12
 ud_3                -7.652522e-02 1 1  ON 13
 ud_4                -1.257015e-01 1 1  ON 14
 ud_5                -1.621668e-01 1 1  ON 15
 ud_6                -1.722648e-01 1 1  ON 16
 ud_7                -1.469335e-01 1 1  ON 17
 ud_8                -9.431741e-02 1 1  ON 18
 ud_9                 4.388072e-02 1 1  ON 19
 eO_0                -8.924578e-01 1 1  ON 20
 eO_1                -5.699846e-01 1 1  ON 21
 eO_2                -1.575325e-01 1 1  ON 22
 eO_3                 1.079924e-01 1 1  ON 23
 eO_4                 2.233766e-01 1 1  ON 24
 eO_5                 2.940672e-01 1 1  ON 25
 eO_6                 3.059347e-01 1 1  ON 26
 eO_7                 4.647007e-01 1 1  ON 27
 eO_8                 1.257154e-01 1 1  ON 28
 eO_9                 5.402936e-02 1 1  ON 29
eH1_0                -2.141544e-01 1 1  ON 30
eH1_1                -1.347749e-01 1 1  ON 31
eH1_2                -9.216171e-02 1 1  ON 32
eH1_3                -5.427823e-02 1 1  ON 33
eH1_4                -7.923961e-03 1 1  ON 34
eH1_5                 4.610433e-03 1 1  ON 35
eH1_6                 5.106896e-02 1 1  ON 36
eH1_7                 4.979105e-02 1 1  ON 37
eH1_8                 2.212044e-01 1 1  ON 38
eH1_9                 1.116325e-01 1 1  ON 39
eH2_0                -2.077901e-01 1 1  ON 40
eH2_1                -1.285480e-01 1 1  ON 41
eH2_2                -8.656854e-02 1 1  ON 42
eH2_3                -4.842717e-02 1 1  ON 43
eH2_4                -2.587024e-03 1 1  ON 44
eH2_5                 1.023694e-02 1 1  ON 45
eH2_6                 4.635357e-02 1 1  ON 46
eH2_7                 3.898892e-03 1 1  ON 47
eH2_8                 2.469570e-01 1 1  ON 48
eH2_9                 1.124802e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.189
    reference variance = 0.327852
====================================================
  Execution time = 3.2336e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2493e-01
  Total weights = 2.0000e+06
  Execution time = 2.8663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325061838658
                                         uncertainty =       0.002920737158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325061838658
                                         uncertainty =       0.002920737158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403160032
  error estimate for blocks of size 2^( 2) =       0.000413007016
  error estimate for blocks of size 2^( 3) =       0.000422054392
  error estimate for blocks of size 2^( 4) =       0.000428471700
  error estimate for blocks of size 2^( 5) =       0.000432057636
  error estimate for blocks of size 2^( 6) =       0.000433463526
  error estimate for blocks of size 2^( 7) =       0.000434325214

      target function =                  N/A
              le_mean =     -17.213516743087
             les_mean =     296.630234524175
             stat err =       0.000432079519
             autocorr =       1.148609543309
              std dev =       0.570154384517
             le_variance =       0.325076022184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324840577782
                                         uncertainty =       0.002917968267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324840577782
                                         uncertainty =       0.002917968267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403022499
  error estimate for blocks of size 2^( 2) =       0.000412856371
  error estimate for blocks of size 2^( 3) =       0.000421902387
  error estimate for blocks of size 2^( 4) =       0.000428310396
  error estimate for blocks of size 2^( 5) =       0.000431889521
  error estimate for blocks of size 2^( 6) =       0.000433297425
  error estimate for blocks of size 2^( 7) =       0.000434083728

      target function =                  N/A
              le_mean =     -17.213502150082
             les_mean =     296.629510377359
             stat err =       0.000431895267
             autocorr =       1.148413549236
              std dev =       0.569959883583
             le_variance =       0.324854268894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324835220857
                                         uncertainty =       0.002917058765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324835220857
                                         uncertainty =       0.002917058765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403019024
  error estimate for blocks of size 2^( 2) =       0.000412848766
  error estimate for blocks of size 2^( 3) =       0.000421896235
  error estimate for blocks of size 2^( 4) =       0.000428304597
  error estimate for blocks of size 2^( 5) =       0.000431878355
  error estimate for blocks of size 2^( 6) =       0.000433291215
  error estimate for blocks of size 2^( 7) =       0.000434042896

      target function =                  N/A
              le_mean =     -17.213506096527
             les_mean =     296.629640640656
             stat err =       0.000431879265
             autocorr =       1.148348251943
              std dev =       0.569954970056
             le_variance =       0.324848667892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325037443663
                                         uncertainty =       0.002920510973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325037443663
                                         uncertainty =       0.002920510973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403144730
  error estimate for blocks of size 2^( 2) =       0.000412980300
  error estimate for blocks of size 2^( 3) =       0.000422020473
  error estimate for blocks of size 2^( 4) =       0.000428430420
  error estimate for blocks of size 2^( 5) =       0.000432008460
  error estimate for blocks of size 2^( 6) =       0.000433413001
  error estimate for blocks of size 2^( 7) =       0.000434237972

      target function =                  N/A
              le_mean =     -17.213505874684
             les_mean =     296.629835681219
             stat err =       0.000432022463
             autocorr =       1.148393391429
              std dev =       0.570132744147
             le_variance =       0.325051345949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213516743087        initial  <--
     9.5367e-03     9.5367e-02             1.2203e-02       -17.213502150082
     3.8147e-02     3.8147e-01             4.0251e-03       -17.213506096527
     1.5259e-01     1.5259e+00             1.6388e-03       -17.213505874684

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.8533
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.941446e-01 1 1  ON 0
 uu_1                 2.963246e-02 1 1  ON 1
 uu_2                -6.817308e-02 1 1  ON 2
 uu_3                -1.256189e-01 1 1  ON 3
 uu_4                -1.606145e-01 1 1  ON 4
 uu_5                -1.711319e-01 1 1  ON 5
 uu_6                -1.549078e-01 1 1  ON 6
 uu_7                -1.183027e-01 1 1  ON 7
 uu_8                -3.948656e-02 1 1  ON 8
 uu_9                 2.161513e-01 1 1  ON 9
 ud_0                 3.516668e-01 1 1  ON 10
 ud_1                 9.260094e-02 1 1  ON 11
 ud_2                -1.601146e-02 1 1  ON 12
 ud_3                -7.576988e-02 1 1  ON 13
 ud_4                -1.255199e-01 1 1  ON 14
 ud_5                -1.625056e-01 1 1  ON 15
 ud_6                -1.727721e-01 1 1  ON 16
 ud_7                -1.483130e-01 1 1  ON 17
 ud_8                -9.518263e-02 1 1  ON 18
 ud_9                 4.396270e-02 1 1  ON 19
 eO_0                -8.925555e-01 1 1  ON 20
 eO_1                -5.685190e-01 1 1  ON 21
 eO_2                -1.559933e-01 1 1  ON 22
 eO_3                 1.099443e-01 1 1  ON 23
 eO_4                 2.239848e-01 1 1  ON 24
 eO_5                 2.909200e-01 1 1  ON 25
 eO_6                 3.042248e-01 1 1  ON 26
 eO_7                 4.649917e-01 1 1  ON 27
 eO_8                 1.250754e-01 1 1  ON 28
 eO_9                 5.383079e-02 1 1  ON 29
eH1_0                -2.156283e-01 1 1  ON 30
eH1_1                -1.350727e-01 1 1  ON 31
eH1_2                -9.295108e-02 1 1  ON 32
eH1_3                -5.587519e-02 1 1  ON 33
eH1_4                -6.633110e-03 1 1  ON 34
eH1_5                 6.050227e-03 1 1  ON 35
eH1_6                 5.403795e-02 1 1  ON 36
eH1_7                 4.876177e-02 1 1  ON 37
eH1_8                 2.210661e-01 1 1  ON 38
eH1_9                 1.113898e-01 1 1  ON 39
eH2_0                -2.066541e-01 1 1  ON 40
eH2_1                -1.280510e-01 1 1  ON 41
eH2_2                -8.574498e-02 1 1  ON 42
eH2_3                -4.874071e-02 1 1  ON 43
eH2_4                -2.134638e-03 1 1  ON 44
eH2_5                 1.426200e-02 1 1  ON 45
eH2_6                 4.351997e-02 1 1  ON 46
eH2_7                 3.030514e-04 1 1  ON 47
eH2_8                 2.472097e-01 1 1  ON 48
eH2_9                 1.122618e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9231e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2363
    reference variance = 0.391824
====================================================
  Execution time = 3.5190e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2715e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327165884943
                                         uncertainty =       0.003337178181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327165884943
                                         uncertainty =       0.003337178181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404444142
  error estimate for blocks of size 2^( 2) =       0.000414308441
  error estimate for blocks of size 2^( 3) =       0.000423026215
  error estimate for blocks of size 2^( 4) =       0.000429852521
  error estimate for blocks of size 2^( 5) =       0.000434933120
  error estimate for blocks of size 2^( 6) =       0.000435826364
  error estimate for blocks of size 2^( 7) =       0.000437467465

      target function =                  N/A
              le_mean =     -17.213538446209
             les_mean =     296.633055804063
             stat err =       0.000434519867
             autocorr =       1.154256096958
              std dev =       0.571970391311
             le_variance =       0.327150128536


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721353844621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213538446209       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213541668131       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213540375394       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213543911288       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213546151360       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213551034304       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213550220621       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213549353167       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213550043026       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213550021966       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213550471264       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213550472771       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.585462e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213538446209       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213540076349       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213539576694       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213540275628       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213541692300       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213543616382       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213543064190       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213542669432       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213542865424       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213542906815       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 8.008745e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213538446209       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213538993936       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213538883922       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213538875752       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213539329683       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213539766686       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213539718173       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213539649538       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.085717e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4240e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.942221e-01 1 1  ON 0
 uu_1                 2.964438e-02 1 1  ON 1
 uu_2                -6.808834e-02 1 1  ON 2
 uu_3                -1.255625e-01 1 1  ON 3
 uu_4                -1.610237e-01 1 1  ON 4
 uu_5                -1.716322e-01 1 1  ON 5
 uu_6                -1.549922e-01 1 1  ON 6
 uu_7                -1.176808e-01 1 1  ON 7
 uu_8                -3.931245e-02 1 1  ON 8
 uu_9                 2.160488e-01 1 1  ON 9
 ud_0                 3.514685e-01 1 1  ON 10
 ud_1                 9.234969e-02 1 1  ON 11
 ud_2                -1.639128e-02 1 1  ON 12
 ud_3                -7.601339e-02 1 1  ON 13
 ud_4                -1.255464e-01 1 1  ON 14
 ud_5                -1.622537e-01 1 1  ON 15
 ud_6                -1.724425e-01 1 1  ON 16
 ud_7                -1.478516e-01 1 1  ON 17
 ud_8                -9.506520e-02 1 1  ON 18
 ud_9                 4.388275e-02 1 1  ON 19
 eO_0                -8.921216e-01 1 1  ON 20
 eO_1                -5.689823e-01 1 1  ON 21
 eO_2                -1.562952e-01 1 1  ON 22
 eO_3                 1.096206e-01 1 1  ON 23
 eO_4                 2.239651e-01 1 1  ON 24
 eO_5                 2.912624e-01 1 1  ON 25
 eO_6                 3.044926e-01 1 1  ON 26
 eO_7                 4.650048e-01 1 1  ON 27
 eO_8                 1.251143e-01 1 1  ON 28
 eO_9                 5.384069e-02 1 1  ON 29
eH1_0                -2.152336e-01 1 1  ON 30
eH1_1                -1.352053e-01 1 1  ON 31
eH1_2                -9.292746e-02 1 1  ON 32
eH1_3                -5.543454e-02 1 1  ON 33
eH1_4                -6.984297e-03 1 1  ON 34
eH1_5                 5.674938e-03 1 1  ON 35
eH1_6                 5.379355e-02 1 1  ON 36
eH1_7                 4.897740e-02 1 1  ON 37
eH1_8                 2.210702e-01 1 1  ON 38
eH1_9                 1.114002e-01 1 1  ON 39
eH2_0                -2.067208e-01 1 1  ON 40
eH2_1                -1.281407e-01 1 1  ON 41
eH2_2                -8.568976e-02 1 1  ON 42
eH2_3                -4.838395e-02 1 1  ON 43
eH2_4                -2.301350e-03 1 1  ON 44
eH2_5                 1.346112e-02 1 1  ON 45
eH2_6                 4.385660e-02 1 1  ON 46
eH2_7                 7.301314e-04 1 1  ON 47
eH2_8                 2.471615e-01 1 1  ON 48
eH2_9                 1.122582e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1582
    reference variance = 0.24346
====================================================
  Execution time = 3.2126e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2764e-01
  Total weights = 2.0000e+06
  Execution time = 2.8767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327520881242
                                         uncertainty =       0.003453302763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327520881242
                                         uncertainty =       0.003453302763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404726839
  error estimate for blocks of size 2^( 2) =       0.000414877289
  error estimate for blocks of size 2^( 3) =       0.000424045353
  error estimate for blocks of size 2^( 4) =       0.000430353514
  error estimate for blocks of size 2^( 5) =       0.000434358001
  error estimate for blocks of size 2^( 6) =       0.000437641345
  error estimate for blocks of size 2^( 7) =       0.000438240291

      target function =                  N/A
              le_mean =     -17.214364005372
             les_mean =     296.661935574692
             stat err =       0.000435148288
             autocorr =       1.155980602664
              std dev =       0.572370185319
             le_variance =       0.327607629042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327466077743
                                         uncertainty =       0.003458795928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327466077743
                                         uncertainty =       0.003458795928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404692960
  error estimate for blocks of size 2^( 2) =       0.000414826497
  error estimate for blocks of size 2^( 3) =       0.000423981894
  error estimate for blocks of size 2^( 4) =       0.000430280042
  error estimate for blocks of size 2^( 5) =       0.000434288279
  error estimate for blocks of size 2^( 6) =       0.000437562101
  error estimate for blocks of size 2^( 7) =       0.000438156323

      target function =                  N/A
              le_mean =     -17.214358999506
             les_mean =     296.661708383497
             stat err =       0.000435071686
             autocorr =       1.155767141075
              std dev =       0.572322272332
             le_variance =       0.327552783407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327602985940
                                         uncertainty =       0.003461078020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327602985940
                                         uncertainty =       0.003461078020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404777574
  error estimate for blocks of size 2^( 2) =       0.000414906697
  error estimate for blocks of size 2^( 3) =       0.000424059648
  error estimate for blocks of size 2^( 4) =       0.000430355273
  error estimate for blocks of size 2^( 5) =       0.000434363179
  error estimate for blocks of size 2^( 6) =       0.000437636034
  error estimate for blocks of size 2^( 7) =       0.000438230717

      target function =                  N/A
              le_mean =     -17.214359548118
             les_mean =     296.661864257577
             stat err =       0.000435146301
             autocorr =       1.155680285224
              std dev =       0.572441935520
             le_variance =       0.327689769542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327546417707
                                         uncertainty =       0.003455098942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327546417707
                                         uncertainty =       0.003455098942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404742627
  error estimate for blocks of size 2^( 2) =       0.000414888350
  error estimate for blocks of size 2^( 3) =       0.000424053150
  error estimate for blocks of size 2^( 4) =       0.000430358467
  error estimate for blocks of size 2^( 5) =       0.000434363359
  error estimate for blocks of size 2^( 6) =       0.000437644426
  error estimate for blocks of size 2^( 7) =       0.000438242561

      target function =                  N/A
              le_mean =     -17.214362570790
             les_mean =     296.661911742230
             stat err =       0.000435152203
             autocorr =       1.155911227983
              std dev =       0.572392511680
             le_variance =       0.327633187427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214364005372        initial  <--
     9.5367e-02     9.5367e-01             2.5855e-03       -17.214358999506
     3.8147e-01     3.8147e+00             8.0087e-04       -17.214359548118
     1.5259e+00     1.5259e+01             2.0857e-04       -17.214362570790

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.6205
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.941446e-01 1 1  ON 0
 uu_1                 2.963246e-02 1 1  ON 1
 uu_2                -6.817308e-02 1 1  ON 2
 uu_3                -1.256189e-01 1 1  ON 3
 uu_4                -1.606145e-01 1 1  ON 4
 uu_5                -1.711319e-01 1 1  ON 5
 uu_6                -1.549078e-01 1 1  ON 6
 uu_7                -1.183027e-01 1 1  ON 7
 uu_8                -3.948656e-02 1 1  ON 8
 uu_9                 2.161513e-01 1 1  ON 9
 ud_0                 3.516668e-01 1 1  ON 10
 ud_1                 9.260094e-02 1 1  ON 11
 ud_2                -1.601146e-02 1 1  ON 12
 ud_3                -7.576988e-02 1 1  ON 13
 ud_4                -1.255199e-01 1 1  ON 14
 ud_5                -1.625056e-01 1 1  ON 15
 ud_6                -1.727721e-01 1 1  ON 16
 ud_7                -1.483130e-01 1 1  ON 17
 ud_8                -9.518263e-02 1 1  ON 18
 ud_9                 4.396270e-02 1 1  ON 19
 eO_0                -8.925555e-01 1 1  ON 20
 eO_1                -5.685190e-01 1 1  ON 21
 eO_2                -1.559933e-01 1 1  ON 22
 eO_3                 1.099443e-01 1 1  ON 23
 eO_4                 2.239848e-01 1 1  ON 24
 eO_5                 2.909200e-01 1 1  ON 25
 eO_6                 3.042248e-01 1 1  ON 26
 eO_7                 4.649917e-01 1 1  ON 27
 eO_8                 1.250754e-01 1 1  ON 28
 eO_9                 5.383079e-02 1 1  ON 29
eH1_0                -2.156283e-01 1 1  ON 30
eH1_1                -1.350727e-01 1 1  ON 31
eH1_2                -9.295108e-02 1 1  ON 32
eH1_3                -5.587519e-02 1 1  ON 33
eH1_4                -6.633110e-03 1 1  ON 34
eH1_5                 6.050227e-03 1 1  ON 35
eH1_6                 5.403795e-02 1 1  ON 36
eH1_7                 4.876177e-02 1 1  ON 37
eH1_8                 2.210661e-01 1 1  ON 38
eH1_9                 1.113898e-01 1 1  ON 39
eH2_0                -2.066541e-01 1 1  ON 40
eH2_1                -1.280510e-01 1 1  ON 41
eH2_2                -8.574498e-02 1 1  ON 42
eH2_3                -4.874071e-02 1 1  ON 43
eH2_4                -2.134638e-03 1 1  ON 44
eH2_5                 1.426200e-02 1 1  ON 45
eH2_6                 4.351997e-02 1 1  ON 46
eH2_7                 3.030514e-04 1 1  ON 47
eH2_8                 2.472097e-01 1 1  ON 48
eH2_9                 1.122618e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.0866e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2519
    reference variance = 0.275478
====================================================
  Execution time = 3.2487e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2815e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328142063414
                                         uncertainty =       0.003069933421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328142063414
                                         uncertainty =       0.003069933421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405059611
  error estimate for blocks of size 2^( 2) =       0.000414809417
  error estimate for blocks of size 2^( 3) =       0.000423741289
  error estimate for blocks of size 2^( 4) =       0.000430131177
  error estimate for blocks of size 2^( 5) =       0.000434335558
  error estimate for blocks of size 2^( 6) =       0.000435729705
  error estimate for blocks of size 2^( 7) =       0.000436410436

      target function =                  N/A
              le_mean =     -17.213735514015
             les_mean =     296.640836759525
             stat err =       0.000434151719
             autocorr =       1.148801958445
              std dev =       0.572840795628
             le_variance =       0.328146577136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721373551402e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213735514015       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213735347855       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213736246998       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213737217341       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213737094003       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213737124667       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213737001172       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213737109236       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.965270e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213735514015       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213735466924       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213735710097       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213735981595       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213736002438       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213735967812       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213735939842       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213735957915       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 7.918825e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213735514015       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213735501836       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213735563713       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213735630181       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213735641702       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213735631876       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213735624733       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213735628423       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.016323e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292551 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1552e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.941612e-01 1 1  ON 0
 uu_1                 2.961375e-02 1 1  ON 1
 uu_2                -6.817490e-02 1 1  ON 2
 uu_3                -1.256203e-01 1 1  ON 3
 uu_4                -1.606839e-01 1 1  ON 4
 uu_5                -1.711587e-01 1 1  ON 5
 uu_6                -1.549070e-01 1 1  ON 6
 uu_7                -1.182281e-01 1 1  ON 7
 uu_8                -3.946774e-02 1 1  ON 8
 uu_9                 2.161445e-01 1 1  ON 9
 ud_0                 3.516137e-01 1 1  ON 10
 ud_1                 9.259535e-02 1 1  ON 11
 ud_2                -1.603809e-02 1 1  ON 12
 ud_3                -7.579196e-02 1 1  ON 13
 ud_4                -1.255116e-01 1 1  ON 14
 ud_5                -1.624788e-01 1 1  ON 15
 ud_6                -1.727565e-01 1 1  ON 16
 ud_7                -1.482856e-01 1 1  ON 17
 ud_8                -9.516344e-02 1 1  ON 18
 ud_9                 4.396285e-02 1 1  ON 19
 eO_0                -8.925131e-01 1 1  ON 20
 eO_1                -5.685484e-01 1 1  ON 21
 eO_2                -1.560086e-01 1 1  ON 22
 eO_3                 1.098651e-01 1 1  ON 23
 eO_4                 2.239847e-01 1 1  ON 24
 eO_5                 2.909639e-01 1 1  ON 25
 eO_6                 3.042481e-01 1 1  ON 26
 eO_7                 4.649943e-01 1 1  ON 27
 eO_8                 1.250841e-01 1 1  ON 28
 eO_9                 5.383313e-02 1 1  ON 29
eH1_0                -2.155927e-01 1 1  ON 30
eH1_1                -1.351164e-01 1 1  ON 31
eH1_2                -9.295036e-02 1 1  ON 32
eH1_3                -5.582385e-02 1 1  ON 33
eH1_4                -6.667038e-03 1 1  ON 34
eH1_5                 6.055568e-03 1 1  ON 35
eH1_6                 5.400977e-02 1 1  ON 36
eH1_7                 4.876657e-02 1 1  ON 37
eH1_8                 2.210689e-01 1 1  ON 38
eH1_9                 1.113929e-01 1 1  ON 39
eH2_0                -2.066657e-01 1 1  ON 40
eH2_1                -1.280732e-01 1 1  ON 41
eH2_2                -8.575948e-02 1 1  ON 42
eH2_3                -4.869612e-02 1 1  ON 43
eH2_4                -2.151759e-03 1 1  ON 44
eH2_5                 1.418965e-02 1 1  ON 45
eH2_6                 4.356735e-02 1 1  ON 46
eH2_7                 3.471515e-04 1 1  ON 47
eH2_8                 2.472076e-01 1 1  ON 48
eH2_9                 1.122640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2001
    reference variance = 0.224412
====================================================
  Execution time = 3.2029e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2503e-01
  Total weights = 2.0000e+06
  Execution time = 2.8697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325032663241
                                         uncertainty =       0.002141143554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325032663241
                                         uncertainty =       0.002141143554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403150744
  error estimate for blocks of size 2^( 2) =       0.000412690696
  error estimate for blocks of size 2^( 3) =       0.000422052331
  error estimate for blocks of size 2^( 4) =       0.000428507007
  error estimate for blocks of size 2^( 5) =       0.000432643359
  error estimate for blocks of size 2^( 6) =       0.000434283697
  error estimate for blocks of size 2^( 7) =       0.000436710627

      target function =                  N/A
              le_mean =     -17.214130643949
             les_mean =     296.651354708981
             stat err =       0.000433036173
             autocorr =       1.153754532190
              std dev =       0.570141249653
             le_variance =       0.325061044556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324937003483
                                         uncertainty =       0.002140404310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324937003483
                                         uncertainty =       0.002140404310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403091359
  error estimate for blocks of size 2^( 2) =       0.000412630005
  error estimate for blocks of size 2^( 3) =       0.000421988518
  error estimate for blocks of size 2^( 4) =       0.000428441009
  error estimate for blocks of size 2^( 5) =       0.000432575771
  error estimate for blocks of size 2^( 6) =       0.000434208740
  error estimate for blocks of size 2^( 7) =       0.000436639293

      target function =                  N/A
              le_mean =     -17.214131468997
             les_mean =     296.651287357259
             stat err =       0.000432966203
             autocorr =       1.153721581467
              std dev =       0.570057267146
             le_variance =       0.324965287826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324969001556
                                         uncertainty =       0.002140649832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324969001556
                                         uncertainty =       0.002140649832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403111217
  error estimate for blocks of size 2^( 2) =       0.000412650620
  error estimate for blocks of size 2^( 3) =       0.000422010494
  error estimate for blocks of size 2^( 4) =       0.000428463899
  error estimate for blocks of size 2^( 5) =       0.000432599198
  error estimate for blocks of size 2^( 6) =       0.000434234984
  error estimate for blocks of size 2^( 7) =       0.000436664167

      target function =                  N/A
              le_mean =     -17.214131001052
             les_mean =     296.651303266232
             stat err =       0.000432990562
             autocorr =       1.153737724122
              std dev =       0.570085350930
             le_variance =       0.324997307345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325023902388
                                         uncertainty =       0.002141076169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325023902388
                                         uncertainty =       0.002141076169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403145304
  error estimate for blocks of size 2^( 2) =       0.000412685192
  error estimate for blocks of size 2^( 3) =       0.000422046597
  error estimate for blocks of size 2^( 4) =       0.000428501106
  error estimate for blocks of size 2^( 5) =       0.000432637313
  error estimate for blocks of size 2^( 6) =       0.000434277045
  error estimate for blocks of size 2^( 7) =       0.000436704275

      target function =                  N/A
              le_mean =     -17.214130676554
             les_mean =     296.651347059940
             stat err =       0.000433029935
             autocorr =       1.153752426012
              std dev =       0.570133557157
             le_variance =       0.325052272996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214130643949        initial
     9.5367e-01     9.5367e+00             2.9653e-04       -17.214131468997  <--
     3.8147e+00     3.8147e+01             7.9188e-05       -17.214131001052
     1.5259e+01     1.5259e+02             2.0163e-05       -17.214130676554

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 4.6499e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.941900e-01 1 1  ON 0
 uu_1                 2.957273e-02 1 1  ON 1
 uu_2                -6.818072e-02 1 1  ON 2
 uu_3                -1.256391e-01 1 1  ON 3
 uu_4                -1.608431e-01 1 1  ON 4
 uu_5                -1.712566e-01 1 1  ON 5
 uu_6                -1.549062e-01 1 1  ON 6
 uu_7                -1.180121e-01 1 1  ON 7
 uu_8                -3.941250e-02 1 1  ON 8
 uu_9                 2.161253e-01 1 1  ON 9
 ud_0                 3.514845e-01 1 1  ON 10
 ud_1                 9.255771e-02 1 1  ON 11
 ud_2                -1.611307e-02 1 1  ON 12
 ud_3                -7.584555e-02 1 1  ON 13
 ud_4                -1.254992e-01 1 1  ON 14
 ud_5                -1.624124e-01 1 1  ON 15
 ud_6                -1.727075e-01 1 1  ON 16
 ud_7                -1.482032e-01 1 1  ON 17
 ud_8                -9.510707e-02 1 1  ON 18
 ud_9                 4.396371e-02 1 1  ON 19
 eO_0                -8.924081e-01 1 1  ON 20
 eO_1                -5.686138e-01 1 1  ON 21
 eO_2                -1.560567e-01 1 1  ON 22
 eO_3                 1.096478e-01 1 1  ON 23
 eO_4                 2.239723e-01 1 1  ON 24
 eO_5                 2.910908e-01 1 1  ON 25
 eO_6                 3.043175e-01 1 1  ON 26
 eO_7                 4.650025e-01 1 1  ON 27
 eO_8                 1.251091e-01 1 1  ON 28
 eO_9                 5.383983e-02 1 1  ON 29
eH1_0                -2.155043e-01 1 1  ON 30
eH1_1                -1.352145e-01 1 1  ON 31
eH1_2                -9.294828e-02 1 1  ON 32
eH1_3                -5.569842e-02 1 1  ON 33
eH1_4                -6.748348e-03 1 1  ON 34
eH1_5                 6.062120e-03 1 1  ON 35
eH1_6                 5.392840e-02 1 1  ON 36
eH1_7                 4.878152e-02 1 1  ON 37
eH1_8                 2.210773e-01 1 1  ON 38
eH1_9                 1.114018e-01 1 1  ON 39
eH2_0                -2.067040e-01 1 1  ON 40
eH2_1                -1.281228e-01 1 1  ON 41
eH2_2                -8.579393e-02 1 1  ON 42
eH2_3                -4.859157e-02 1 1  ON 43
eH2_4                -2.189724e-03 1 1  ON 44
eH2_5                 1.397910e-02 1 1  ON 45
eH2_6                 4.370077e-02 1 1  ON 46
eH2_7                 4.744829e-04 1 1  ON 47
eH2_8                 2.472019e-01 1 1  ON 48
eH2_9                 1.122702e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8065e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1844
    reference variance = 0.339785
====================================================
  Execution time = 3.2509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.4345e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343522996726
                                         uncertainty =       0.017077544691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343522996726
                                         uncertainty =       0.017077544691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414396181
  error estimate for blocks of size 2^( 2) =       0.000424186164
  error estimate for blocks of size 2^( 3) =       0.000433526697
  error estimate for blocks of size 2^( 4) =       0.000440794010
  error estimate for blocks of size 2^( 5) =       0.000445274436
  error estimate for blocks of size 2^( 6) =       0.000446871909
  error estimate for blocks of size 2^( 7) =       0.000447209448

      target function =                  N/A
              le_mean =     -17.213662519274
             les_mean =     296.653625545458
             stat err =       0.000445037451
             autocorr =       1.153351354681
              std dev =       0.586044699425
             le_variance =       0.343448389724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721366251927e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213662519274       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213663961420       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213665032423       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213666337890       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213669545473       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213669878366       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213669883995       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213669297163       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213669445376       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213669385488       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.123815e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213662519274       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213663079385       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213663431104       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213663911471       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213664894396       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213665046800       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213664978680       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213664871308       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.175046e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213662519274       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213662681792       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213662777338       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213662915617       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213663177485       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213663234185       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213663215355       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 8.893973e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299663 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1559e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.942641e-01 1 1  ON 0
 uu_1                 2.953178e-02 1 1  ON 1
 uu_2                -6.820655e-02 1 1  ON 2
 uu_3                -1.256216e-01 1 1  ON 3
 uu_4                -1.609711e-01 1 1  ON 4
 uu_5                -1.714748e-01 1 1  ON 5
 uu_6                -1.548819e-01 1 1  ON 6
 uu_7                -1.177913e-01 1 1  ON 7
 uu_8                -3.935365e-02 1 1  ON 8
 uu_9                 2.160954e-01 1 1  ON 9
 ud_0                 3.514796e-01 1 1  ON 10
 ud_1                 9.234998e-02 1 1  ON 11
 ud_2                -1.620135e-02 1 1  ON 12
 ud_3                -7.590811e-02 1 1  ON 13
 ud_4                -1.255308e-01 1 1  ON 14
 ud_5                -1.623700e-01 1 1  ON 15
 ud_6                -1.726412e-01 1 1  ON 16
 ud_7                -1.480305e-01 1 1  ON 17
 ud_8                -9.502619e-02 1 1  ON 18
 ud_9                 4.395936e-02 1 1  ON 19
 eO_0                -8.921892e-01 1 1  ON 20
 eO_1                -5.687667e-01 1 1  ON 21
 eO_2                -1.562390e-01 1 1  ON 22
 eO_3                 1.093996e-01 1 1  ON 23
 eO_4                 2.239824e-01 1 1  ON 24
 eO_5                 2.912642e-01 1 1  ON 25
 eO_6                 3.044504e-01 1 1  ON 26
 eO_7                 4.650097e-01 1 1  ON 27
 eO_8                 1.251374e-01 1 1  ON 28
 eO_9                 5.384587e-02 1 1  ON 29
eH1_0                -2.152910e-01 1 1  ON 30
eH1_1                -1.352510e-01 1 1  ON 31
eH1_2                -9.295454e-02 1 1  ON 32
eH1_3                -5.561796e-02 1 1  ON 33
eH1_4                -7.065853e-03 1 1  ON 34
eH1_5                 6.046156e-03 1 1  ON 35
eH1_6                 5.392487e-02 1 1  ON 36
eH1_7                 4.884861e-02 1 1  ON 37
eH1_8                 2.210775e-01 1 1  ON 38
eH1_9                 1.114107e-01 1 1  ON 39
eH2_0                -2.067578e-01 1 1  ON 40
eH2_1                -1.281217e-01 1 1  ON 41
eH2_2                -8.586508e-02 1 1  ON 42
eH2_3                -4.851294e-02 1 1  ON 43
eH2_4                -2.162696e-03 1 1  ON 44
eH2_5                 1.366566e-02 1 1  ON 45
eH2_6                 4.384852e-02 1 1  ON 46
eH2_7                 6.536160e-04 1 1  ON 47
eH2_8                 2.471907e-01 1 1  ON 48
eH2_9                 1.122757e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2781
    reference variance = 0.218048
====================================================
  Execution time = 3.2176e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2706e-01
  Total weights = 2.0000e+06
  Execution time = 2.8678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326987789259
                                         uncertainty =       0.003755968777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326987789259
                                         uncertainty =       0.003755968777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404329115
  error estimate for blocks of size 2^( 2) =       0.000414360492
  error estimate for blocks of size 2^( 3) =       0.000422657381
  error estimate for blocks of size 2^( 4) =       0.000429391949
  error estimate for blocks of size 2^( 5) =       0.000433465784
  error estimate for blocks of size 2^( 6) =       0.000435362583
  error estimate for blocks of size 2^( 7) =       0.000436577151

      target function =                  N/A
              le_mean =     -17.215041472929
             les_mean =     296.684616817667
             stat err =       0.000433699367
             autocorr =       1.150555427286
              std dev =       0.571807718100
             le_variance =       0.326964066479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327108739030
                                         uncertainty =       0.003756611432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327108739030
                                         uncertainty =       0.003756611432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404403990
  error estimate for blocks of size 2^( 2) =       0.000414428158
  error estimate for blocks of size 2^( 3) =       0.000422722934
  error estimate for blocks of size 2^( 4) =       0.000429456999
  error estimate for blocks of size 2^( 5) =       0.000433524064
  error estimate for blocks of size 2^( 6) =       0.000435421186
  error estimate for blocks of size 2^( 7) =       0.000436625498

      target function =                  N/A
              le_mean =     -17.215041861196
             les_mean =     296.684751294002
             stat err =       0.000433756937
             autocorr =       1.150434777060
              std dev =       0.571913607838
             le_variance =       0.327085174831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327183849832
                                         uncertainty =       0.003757973386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327183849832
                                         uncertainty =       0.003757973386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404450428
  error estimate for blocks of size 2^( 2) =       0.000414474103
  error estimate for blocks of size 2^( 3) =       0.000422767320
  error estimate for blocks of size 2^( 4) =       0.000429500103
  error estimate for blocks of size 2^( 5) =       0.000433569252
  error estimate for blocks of size 2^( 6) =       0.000435467328
  error estimate for blocks of size 2^( 7) =       0.000436669854

      target function =                  N/A
              le_mean =     -17.215040961631
             les_mean =     296.684795444305
             stat err =       0.000433801634
             autocorr =       1.150407671488
              std dev =       0.571979280431
             le_variance =       0.327160297242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327030285286
                                         uncertainty =       0.003756413311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327030285286
                                         uncertainty =       0.003756413311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404355408
  error estimate for blocks of size 2^( 2) =       0.000414385307
  error estimate for blocks of size 2^( 3) =       0.000422681347
  error estimate for blocks of size 2^( 4) =       0.000429415405
  error estimate for blocks of size 2^( 5) =       0.000433488548
  error estimate for blocks of size 2^( 6) =       0.000435385509
  error estimate for blocks of size 2^( 7) =       0.000436597858

      target function =                  N/A
              le_mean =     -17.215041221948
             les_mean =     296.684650702313
             stat err =       0.000433721830
             autocorr =       1.150524974928
              std dev =       0.571844902435
             le_variance =       0.327006592441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215041472929        initial
     2.3842e-01     2.3842e+00             1.1238e-03       -17.215041861196  <--
     9.5367e-01     9.5367e+00             3.1750e-04       -17.215040961631
     3.8147e+00     3.8147e+01             8.8940e-05       -17.215041221948

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 4.6653e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.942607e-01 1 1  ON 0
 uu_1                 2.943626e-02 1 1  ON 1
 uu_2                -6.827391e-02 1 1  ON 2
 uu_3                -1.256387e-01 1 1  ON 3
 uu_4                -1.611712e-01 1 1  ON 4
 uu_5                -1.719230e-01 1 1  ON 5
 uu_6                -1.549025e-01 1 1  ON 6
 uu_7                -1.171721e-01 1 1  ON 7
 uu_8                -3.917497e-02 1 1  ON 8
 uu_9                 2.160085e-01 1 1  ON 9
 ud_0                 3.512485e-01 1 1  ON 10
 ud_1                 9.197468e-02 1 1  ON 11
 ud_2                -1.643179e-02 1 1  ON 12
 ud_3                -7.604001e-02 1 1  ON 13
 ud_4                -1.255954e-01 1 1  ON 14
 ud_5                -1.623157e-01 1 1  ON 15
 ud_6                -1.725003e-01 1 1  ON 16
 ud_7                -1.475366e-01 1 1  ON 17
 ud_8                -9.478272e-02 1 1  ON 18
 ud_9                 4.394859e-02 1 1  ON 19
 eO_0                -8.919274e-01 1 1  ON 20
 eO_1                -5.690153e-01 1 1  ON 21
 eO_2                -1.566685e-01 1 1  ON 22
 eO_3                 1.088294e-01 1 1  ON 23
 eO_4                 2.239432e-01 1 1  ON 24
 eO_5                 2.917490e-01 1 1  ON 25
 eO_6                 3.048453e-01 1 1  ON 26
 eO_7                 4.650325e-01 1 1  ON 27
 eO_8                 1.252226e-01 1 1  ON 28
 eO_9                 5.386422e-02 1 1  ON 29
eH1_0                -2.148533e-01 1 1  ON 30
eH1_1                -1.352645e-01 1 1  ON 31
eH1_2                -9.297686e-02 1 1  ON 32
eH1_3                -5.552455e-02 1 1  ON 33
eH1_4                -7.621100e-03 1 1  ON 34
eH1_5                 5.899766e-03 1 1  ON 35
eH1_6                 5.387325e-02 1 1  ON 36
eH1_7                 4.904815e-02 1 1  ON 37
eH1_8                 2.210794e-01 1 1  ON 38
eH1_9                 1.114377e-01 1 1  ON 39
eH2_0                -2.069080e-01 1 1  ON 40
eH2_1                -1.281335e-01 1 1  ON 41
eH2_2                -8.596963e-02 1 1  ON 42
eH2_3                -4.843068e-02 1 1  ON 43
eH2_4                -2.111336e-03 1 1  ON 44
eH2_5                 1.285528e-02 1 1  ON 45
eH2_6                 4.425040e-02 1 1  ON 46
eH2_7                 1.179063e-03 1 1  ON 47
eH2_8                 2.471582e-01 1 1  ON 48
eH2_9                 1.122925e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8226e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1909
    reference variance = 0.17793
====================================================
  Execution time = 3.2717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.2529e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325362277272
                                         uncertainty =       0.002763426987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325362277272
                                         uncertainty =       0.002763426987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403295887
  error estimate for blocks of size 2^( 2) =       0.000413707249
  error estimate for blocks of size 2^( 3) =       0.000422693433
  error estimate for blocks of size 2^( 4) =       0.000429071748
  error estimate for blocks of size 2^( 5) =       0.000432750569
  error estimate for blocks of size 2^( 6) =       0.000433942258
  error estimate for blocks of size 2^( 7) =       0.000435917152

      target function =                  N/A
              le_mean =     -17.213493456732
             les_mean =     296.629651966737
             stat err =       0.000432920432
             autocorr =       1.152308010206
              std dev =       0.570346512587
             le_variance =       0.325295144420


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721349345673e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213493456732       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213496576497       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213498362452       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213497368956       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213497944594       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213500077058       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213500182513       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213501275032       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213501871342       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213501645793       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213503054584       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213503314545       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 2.504650e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213493456732       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213495476635       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213496468078       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213496112402       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213496215712       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213497468060       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213497228119       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213497519132       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213497510688       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213497468413       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 7.662734e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213493456732       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213494294802       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213494698105       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213494662259       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213494679729       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213495056290       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213494970593       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213494987757       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.008757e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308190 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1873e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.940648e-01 1 1  ON 0
 uu_1                 2.939412e-02 1 1  ON 1
 uu_2                -6.829044e-02 1 1  ON 2
 uu_3                -1.256850e-01 1 1  ON 3
 uu_4                -1.614960e-01 1 1  ON 4
 uu_5                -1.719312e-01 1 1  ON 5
 uu_6                -1.551030e-01 1 1  ON 6
 uu_7                -1.165791e-01 1 1  ON 7
 uu_8                -3.899599e-02 1 1  ON 8
 uu_9                 2.158977e-01 1 1  ON 9
 ud_0                 3.509619e-01 1 1  ON 10
 ud_1                 9.182255e-02 1 1  ON 11
 ud_2                -1.667702e-02 1 1  ON 12
 ud_3                -7.619918e-02 1 1  ON 13
 ud_4                -1.255335e-01 1 1  ON 14
 ud_5                -1.622671e-01 1 1  ON 15
 ud_6                -1.721931e-01 1 1  ON 16
 ud_7                -1.470346e-01 1 1  ON 17
 ud_8                -9.475501e-02 1 1  ON 18
 ud_9                 4.378031e-02 1 1  ON 19
 eO_0                -8.918031e-01 1 1  ON 20
 eO_1                -5.693040e-01 1 1  ON 21
 eO_2                -1.570655e-01 1 1  ON 22
 eO_3                 1.085299e-01 1 1  ON 23
 eO_4                 2.235461e-01 1 1  ON 24
 eO_5                 2.925153e-01 1 1  ON 25
 eO_6                 3.052869e-01 1 1  ON 26
 eO_7                 4.650232e-01 1 1  ON 27
 eO_8                 1.252661e-01 1 1  ON 28
 eO_9                 5.387150e-02 1 1  ON 29
eH1_0                -2.146546e-01 1 1  ON 30
eH1_1                -1.353496e-01 1 1  ON 31
eH1_2                -9.285892e-02 1 1  ON 32
eH1_3                -5.519389e-02 1 1  ON 33
eH1_4                -7.920606e-03 1 1  ON 34
eH1_5                 5.490669e-03 1 1  ON 35
eH1_6                 5.368912e-02 1 1  ON 36
eH1_7                 4.933942e-02 1 1  ON 37
eH1_8                 2.210952e-01 1 1  ON 38
eH1_9                 1.114539e-01 1 1  ON 39
eH2_0                -2.068675e-01 1 1  ON 40
eH2_1                -1.284574e-01 1 1  ON 41
eH2_2                -8.620634e-02 1 1  ON 42
eH2_3                -4.847306e-02 1 1  ON 43
eH2_4                -1.901513e-03 1 1  ON 44
eH2_5                 1.219743e-02 1 1  ON 45
eH2_6                 4.463354e-02 1 1  ON 46
eH2_7                 1.827902e-03 1 1  ON 47
eH2_8                 2.470971e-01 1 1  ON 48
eH2_9                 1.123069e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.3028
    reference variance = 0.305667
====================================================
  Execution time = 3.4373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.3485e-01
  Total weights = 2.0000e+06
  Execution time = 2.8661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335079562000
                                         uncertainty =       0.006657382090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335079562000
                                         uncertainty =       0.006657382090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409255506
  error estimate for blocks of size 2^( 2) =       0.000419219761
  error estimate for blocks of size 2^( 3) =       0.000427810998
  error estimate for blocks of size 2^( 4) =       0.000434490676
  error estimate for blocks of size 2^( 5) =       0.000439002126
  error estimate for blocks of size 2^( 6) =       0.000441961335
  error estimate for blocks of size 2^( 7) =       0.000440842674

      target function =                  N/A
              le_mean =     -17.213485355705
             les_mean =     296.639058062108
             stat err =       0.000439074203
             autocorr =       1.151030363939
              std dev =       0.578774687177
             le_variance =       0.334980138517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334777835624
                                         uncertainty =       0.006644606704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334777835624
                                         uncertainty =       0.006644606704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409071230
  error estimate for blocks of size 2^( 2) =       0.000419035342
  error estimate for blocks of size 2^( 3) =       0.000427628474
  error estimate for blocks of size 2^( 4) =       0.000434311642
  error estimate for blocks of size 2^( 5) =       0.000438828476
  error estimate for blocks of size 2^( 6) =       0.000441783816
  error estimate for blocks of size 2^( 7) =       0.000440660618

      target function =                  N/A
              le_mean =     -17.213485747185
             les_mean =     296.638769943521
             stat err =       0.000438896138
             autocorr =       1.151133374736
              std dev =       0.578514081343
             le_variance =       0.334678542312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334827119278
                                         uncertainty =       0.006640818949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334827119278
                                         uncertainty =       0.006640818949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409101324
  error estimate for blocks of size 2^( 2) =       0.000419063853
  error estimate for blocks of size 2^( 3) =       0.000427654967
  error estimate for blocks of size 2^( 4) =       0.000434337537
  error estimate for blocks of size 2^( 5) =       0.000438857900
  error estimate for blocks of size 2^( 6) =       0.000441812414
  error estimate for blocks of size 2^( 7) =       0.000440683927

      target function =                  N/A
              le_mean =     -17.213484716433
             les_mean =     296.638783702366
             stat err =       0.000438922945
             autocorr =       1.151104622167
              std dev =       0.578556640998
             le_variance =       0.334727786843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335013702697
                                         uncertainty =       0.006653516294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335013702697
                                         uncertainty =       0.006653516294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409215285
  error estimate for blocks of size 2^( 2) =       0.000419179475
  error estimate for blocks of size 2^( 3) =       0.000427770752
  error estimate for blocks of size 2^( 4) =       0.000434450967
  error estimate for blocks of size 2^( 5) =       0.000438964432
  error estimate for blocks of size 2^( 6) =       0.000441922632
  error estimate for blocks of size 2^( 7) =       0.000440801292

      target function =                  N/A
              le_mean =     -17.213484666761
             les_mean =     296.638968503604
             stat err =       0.000439034831
             autocorr =       1.151050186855
              std dev =       0.578717805377
             le_variance =       0.334914298260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213485355705        initial
     5.9605e-02     5.9605e-01             2.5046e-03       -17.213485747185  <--
     2.3842e-01     2.3842e+00             7.6627e-04       -17.213484716433
     9.5367e-01     9.5367e+00             2.0088e-04       -17.213484666761

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 4.8783e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.937809e-01 1 1  ON 0
 uu_1                 2.918483e-02 1 1  ON 1
 uu_2                -6.846522e-02 1 1  ON 2
 uu_3                -1.258663e-01 1 1  ON 3
 uu_4                -1.617799e-01 1 1  ON 4
 uu_5                -1.720330e-01 1 1  ON 5
 uu_6                -1.558665e-01 1 1  ON 6
 uu_7                -1.152337e-01 1 1  ON 7
 uu_8                -3.852638e-02 1 1  ON 8
 uu_9                 2.156029e-01 1 1  ON 9
 ud_0                 3.505516e-01 1 1  ON 10
 ud_1                 9.156276e-02 1 1  ON 11
 ud_2                -1.693347e-02 1 1  ON 12
 ud_3                -7.635785e-02 1 1  ON 13
 ud_4                -1.255166e-01 1 1  ON 14
 ud_5                -1.621694e-01 1 1  ON 15
 ud_6                -1.721181e-01 1 1  ON 16
 ud_7                -1.459459e-01 1 1  ON 17
 ud_8                -9.467427e-02 1 1  ON 18
 ud_9                 4.332789e-02 1 1  ON 19
 eO_0                -8.920434e-01 1 1  ON 20
 eO_1                -5.697882e-01 1 1  ON 21
 eO_2                -1.578709e-01 1 1  ON 22
 eO_3                 1.078385e-01 1 1  ON 23
 eO_4                 2.227454e-01 1 1  ON 24
 eO_5                 2.942537e-01 1 1  ON 25
 eO_6                 3.064258e-01 1 1  ON 26
 eO_7                 4.649990e-01 1 1  ON 27
 eO_8                 1.253898e-01 1 1  ON 28
 eO_9                 5.389282e-02 1 1  ON 29
eH1_0                -2.142883e-01 1 1  ON 30
eH1_1                -1.352268e-01 1 1  ON 31
eH1_2                -9.262122e-02 1 1  ON 32
eH1_3                -5.492225e-02 1 1  ON 33
eH1_4                -8.143359e-03 1 1  ON 34
eH1_5                 4.565026e-03 1 1  ON 35
eH1_6                 5.300859e-02 1 1  ON 36
eH1_7                 5.006022e-02 1 1  ON 37
eH1_8                 2.211373e-01 1 1  ON 38
eH1_9                 1.115002e-01 1 1  ON 39
eH2_0                -2.070239e-01 1 1  ON 40
eH2_1                -1.289553e-01 1 1  ON 41
eH2_2                -8.659186e-02 1 1  ON 42
eH2_3                -4.880230e-02 1 1  ON 43
eH2_4                -1.872064e-03 1 1  ON 44
eH2_5                 1.106671e-02 1 1  ON 45
eH2_6                 4.546653e-02 1 1  ON 46
eH2_7                 3.517414e-03 1 1  ON 47
eH2_8                 2.469334e-01 1 1  ON 48
eH2_9                 1.123487e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.0667e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1661
    reference variance = 0.195469
====================================================
  Execution time = 3.2472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2845e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328585429377
                                         uncertainty =       0.003095051377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328585429377
                                         uncertainty =       0.003095051377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405248601
  error estimate for blocks of size 2^( 2) =       0.000415529791
  error estimate for blocks of size 2^( 3) =       0.000424100429
  error estimate for blocks of size 2^( 4) =       0.000430285849
  error estimate for blocks of size 2^( 5) =       0.000435084649
  error estimate for blocks of size 2^( 6) =       0.000435508578
  error estimate for blocks of size 2^( 7) =       0.000434585090

      target function =                  N/A
              le_mean =     -17.214148561731
             les_mean =     296.655363397604
             stat err =       0.000433866042
             autocorr =       1.146220764125
              std dev =       0.573108067010
             le_variance =       0.328452856472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721414856173e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214148561731       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214148900764       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214148159807       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214149974365       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214153559262       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214154917019       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214155349108       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214158458436       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214156348875       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214158652146       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214156574510       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214155649235       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214156580279       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214156101684       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214156163687       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214157515735       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214157465088       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214156815605       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-02 is 6.863064e-03

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214148561731       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214148842911       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214148257437       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214149991078       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214152072499       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214153173014       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214153217249       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214154825517       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214153321307       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214154216585       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214153267997       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214153177243       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 2.017703e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214148561731       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214148728844       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214148436947       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214149015807       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214149473556       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214150413040       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214150612044       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214150946689       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214150477035       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214150652421       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 6.046358e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314783 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1544e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.937135e-01 1 1  ON 0
 uu_1                 2.887922e-02 1 1  ON 1
 uu_2                -6.897198e-02 1 1  ON 2
 uu_3                -1.262394e-01 1 1  ON 3
 uu_4                -1.620636e-01 1 1  ON 4
 uu_5                -1.730886e-01 1 1  ON 5
 uu_6                -1.564835e-01 1 1  ON 6
 uu_7                -1.132160e-01 1 1  ON 7
 uu_8                -3.770876e-02 1 1  ON 8
 uu_9                 2.151212e-01 1 1  ON 9
 ud_0                 3.501860e-01 1 1  ON 10
 ud_1                 9.113920e-02 1 1  ON 11
 ud_2                -1.736120e-02 1 1  ON 12
 ud_3                -7.674354e-02 1 1  ON 13
 ud_4                -1.256342e-01 1 1  ON 14
 ud_5                -1.620465e-01 1 1  ON 15
 ud_6                -1.721168e-01 1 1  ON 16
 ud_7                -1.453470e-01 1 1  ON 17
 ud_8                -9.407469e-02 1 1  ON 18
 ud_9                 4.316900e-02 1 1  ON 19
 eO_0                -8.930489e-01 1 1  ON 20
 eO_1                -5.701396e-01 1 1  ON 21
 eO_2                -1.580960e-01 1 1  ON 22
 eO_3                 1.066247e-01 1 1  ON 23
 eO_4                 2.223654e-01 1 1  ON 24
 eO_5                 2.956879e-01 1 1  ON 25
 eO_6                 3.076260e-01 1 1  ON 26
 eO_7                 4.649157e-01 1 1  ON 27
 eO_8                 1.257818e-01 1 1  ON 28
 eO_9                 5.400984e-02 1 1  ON 29
eH1_0                -2.138540e-01 1 1  ON 30
eH1_1                -1.349026e-01 1 1  ON 31
eH1_2                -9.293211e-02 1 1  ON 32
eH1_3                -5.521175e-02 1 1  ON 33
eH1_4                -8.879334e-03 1 1  ON 34
eH1_5                 4.488820e-03 1 1  ON 35
eH1_6                 5.228792e-02 1 1  ON 36
eH1_7                 5.119694e-02 1 1  ON 37
eH1_8                 2.211301e-01 1 1  ON 38
eH1_9                 1.115682e-01 1 1  ON 39
eH2_0                -2.077936e-01 1 1  ON 40
eH2_1                -1.289202e-01 1 1  ON 41
eH2_2                -8.654324e-02 1 1  ON 42
eH2_3                -4.914475e-02 1 1  ON 43
eH2_4                -2.688372e-03 1 1  ON 44
eH2_5                 1.013523e-02 1 1  ON 45
eH2_6                 4.623182e-02 1 1  ON 46
eH2_7                 5.429411e-03 1 1  ON 47
eH2_8                 2.468480e-01 1 1  ON 48
eH2_9                 1.124280e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1314
    reference variance = 0.150214
====================================================
  Execution time = 3.1579e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2547e-01
  Total weights = 2.0000e+06
  Execution time = 2.8481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325281973011
                                         uncertainty =       0.002775196848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325281973011
                                         uncertainty =       0.002775196848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403272660
  error estimate for blocks of size 2^( 2) =       0.000413209614
  error estimate for blocks of size 2^( 3) =       0.000422363706
  error estimate for blocks of size 2^( 4) =       0.000429592026
  error estimate for blocks of size 2^( 5) =       0.000433430246
  error estimate for blocks of size 2^( 6) =       0.000434456606
  error estimate for blocks of size 2^( 7) =       0.000435240816

      target function =                  N/A
              le_mean =     -17.214374665045
             les_mean =     296.659952622515
             stat err =       0.000433179924
             autocorr =       1.153822705775
              std dev =       0.570313665086
             le_variance =       0.325257676584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325637388182
                                         uncertainty =       0.002777990510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325637388182
                                         uncertainty =       0.002777990510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403492803
  error estimate for blocks of size 2^( 2) =       0.000413420341
  error estimate for blocks of size 2^( 3) =       0.000422561201
  error estimate for blocks of size 2^( 4) =       0.000429782285
  error estimate for blocks of size 2^( 5) =       0.000433602507
  error estimate for blocks of size 2^( 6) =       0.000434634176
  error estimate for blocks of size 2^( 7) =       0.000435424942

      target function =                  N/A
              le_mean =     -17.214375263808
             les_mean =     296.660328444369
             stat err =       0.000433360977
             autocorr =       1.153527676610
              std dev =       0.570624994167
             le_variance =       0.325612883968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325730921902
                                         uncertainty =       0.002778399823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325730921902
                                         uncertainty =       0.002778399823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403550750
  error estimate for blocks of size 2^( 2) =       0.000413476114
  error estimate for blocks of size 2^( 3) =       0.000422616235
  error estimate for blocks of size 2^( 4) =       0.000429841724
  error estimate for blocks of size 2^( 5) =       0.000433664980
  error estimate for blocks of size 2^( 6) =       0.000434700079
  error estimate for blocks of size 2^( 7) =       0.000435490209

      target function =                  N/A
              le_mean =     -17.214375517599
             les_mean =     296.660430714507
             stat err =       0.000433424248
             autocorr =       1.153533176407
              std dev =       0.570706944443
             le_variance =       0.325706416435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325447478970
                                         uncertainty =       0.002776336249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325447478970
                                         uncertainty =       0.002776336249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403375219
  error estimate for blocks of size 2^( 2) =       0.000413307406
  error estimate for blocks of size 2^( 3) =       0.000422456161
  error estimate for blocks of size 2^( 4) =       0.000429682928
  error estimate for blocks of size 2^( 5) =       0.000433517357
  error estimate for blocks of size 2^( 6) =       0.000434546636
  error estimate for blocks of size 2^( 7) =       0.000435332384

      target function =                  N/A
              le_mean =     -17.214373100492
             les_mean =     296.660064214514
             stat err =       0.000433269826
             autocorr =       1.153714794515
              std dev =       0.570458705145
             le_variance =       0.325423134276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214374665045        initial
     1.4901e-02     1.4901e-01             6.8631e-03       -17.214375263808
     5.9605e-02     5.9605e-01             2.0177e-03       -17.214375517599  <--
     2.3842e-01     2.3842e+00             6.0464e-04       -17.214373100492

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 4.5939e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.937135e-01 1 1  ON 0
 uu_1                 2.887922e-02 1 1  ON 1
 uu_2                -6.897198e-02 1 1  ON 2
 uu_3                -1.262394e-01 1 1  ON 3
 uu_4                -1.620636e-01 1 1  ON 4
 uu_5                -1.730886e-01 1 1  ON 5
 uu_6                -1.564835e-01 1 1  ON 6
 uu_7                -1.132160e-01 1 1  ON 7
 uu_8                -3.770876e-02 1 1  ON 8
 uu_9                 2.151212e-01 1 1  ON 9
 ud_0                 3.501860e-01 1 1  ON 10
 ud_1                 9.113920e-02 1 1  ON 11
 ud_2                -1.736120e-02 1 1  ON 12
 ud_3                -7.674354e-02 1 1  ON 13
 ud_4                -1.256342e-01 1 1  ON 14
 ud_5                -1.620465e-01 1 1  ON 15
 ud_6                -1.721168e-01 1 1  ON 16
 ud_7                -1.453470e-01 1 1  ON 17
 ud_8                -9.407469e-02 1 1  ON 18
 ud_9                 4.316900e-02 1 1  ON 19
 eO_0                -8.930489e-01 1 1  ON 20
 eO_1                -5.701396e-01 1 1  ON 21
 eO_2                -1.580960e-01 1 1  ON 22
 eO_3                 1.066247e-01 1 1  ON 23
 eO_4                 2.223654e-01 1 1  ON 24
 eO_5                 2.956879e-01 1 1  ON 25
 eO_6                 3.076260e-01 1 1  ON 26
 eO_7                 4.649157e-01 1 1  ON 27
 eO_8                 1.257818e-01 1 1  ON 28
 eO_9                 5.400984e-02 1 1  ON 29
eH1_0                -2.138540e-01 1 1  ON 30
eH1_1                -1.349026e-01 1 1  ON 31
eH1_2                -9.293211e-02 1 1  ON 32
eH1_3                -5.521175e-02 1 1  ON 33
eH1_4                -8.879334e-03 1 1  ON 34
eH1_5                 4.488820e-03 1 1  ON 35
eH1_6                 5.228792e-02 1 1  ON 36
eH1_7                 5.119694e-02 1 1  ON 37
eH1_8                 2.211301e-01 1 1  ON 38
eH1_9                 1.115682e-01 1 1  ON 39
eH2_0                -2.077936e-01 1 1  ON 40
eH2_1                -1.289202e-01 1 1  ON 41
eH2_2                -8.654324e-02 1 1  ON 42
eH2_3                -4.914475e-02 1 1  ON 43
eH2_4                -2.688372e-03 1 1  ON 44
eH2_5                 1.013523e-02 1 1  ON 45
eH2_6                 4.623182e-02 1 1  ON 46
eH2_7                 5.429411e-03 1 1  ON 47
eH2_8                 2.468480e-01 1 1  ON 48
eH2_9                 1.124280e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7488e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2909
    reference variance = 0.265238
====================================================
  Execution time = 3.2511e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2764e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327720175720
                                         uncertainty =       0.003320737245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327720175720
                                         uncertainty =       0.003320737245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404748280
  error estimate for blocks of size 2^( 2) =       0.000414531219
  error estimate for blocks of size 2^( 3) =       0.000423446739
  error estimate for blocks of size 2^( 4) =       0.000430038280
  error estimate for blocks of size 2^( 5) =       0.000434771843
  error estimate for blocks of size 2^( 6) =       0.000437419105
  error estimate for blocks of size 2^( 7) =       0.000441775506

      target function =                  N/A
              le_mean =     -17.213790135325
             les_mean =     296.642213000217
             stat err =       0.000436001183
             autocorr =       1.160393564636
              std dev =       0.572400507524
             le_variance =       0.327642341014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721379013533e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213790135325       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213793377533       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213794640043       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213794025937       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213797324362       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213796764539       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213796005423       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213797084835       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213795247278       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213795765142       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213797746043       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213797886845       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213797946846       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213796951215       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213796710340       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213796918051       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213797808827       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-02 is 6.559581e-03

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213790135325       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213792777091       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213793687756       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213793869310       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213796542539       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213795177503       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213795263859       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213795453071       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213794651501       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213794860112       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213795374833       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213795598250       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 2.113010e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213790135325       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213791652899       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213792104692       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213793076743       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213792935875       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213793924086       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213793157694       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213793193561       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213793065329       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213793125196       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 7.014551e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320990 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1765e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.936766e-01 1 1  ON 0
 uu_1                 2.895443e-02 1 1  ON 1
 uu_2                -6.892950e-02 1 1  ON 2
 uu_3                -1.263546e-01 1 1  ON 3
 uu_4                -1.624452e-01 1 1  ON 4
 uu_5                -1.740311e-01 1 1  ON 5
 uu_6                -1.580741e-01 1 1  ON 6
 uu_7                -1.119532e-01 1 1  ON 7
 uu_8                -3.700048e-02 1 1  ON 8
 uu_9                 2.149478e-01 1 1  ON 9
 ud_0                 3.495012e-01 1 1  ON 10
 ud_1                 9.062725e-02 1 1  ON 11
 ud_2                -1.754733e-02 1 1  ON 12
 ud_3                -7.671838e-02 1 1  ON 13
 ud_4                -1.257061e-01 1 1  ON 14
 ud_5                -1.620346e-01 1 1  ON 15
 ud_6                -1.727174e-01 1 1  ON 16
 ud_7                -1.449309e-01 1 1  ON 17
 ud_8                -9.335669e-02 1 1  ON 18
 ud_9                 4.330735e-02 1 1  ON 19
 eO_0                -8.932384e-01 1 1  ON 20
 eO_1                -5.711392e-01 1 1  ON 21
 eO_2                -1.596907e-01 1 1  ON 22
 eO_3                 1.057141e-01 1 1  ON 23
 eO_4                 2.230356e-01 1 1  ON 24
 eO_5                 2.970366e-01 1 1  ON 25
 eO_6                 3.084351e-01 1 1  ON 26
 eO_7                 4.649670e-01 1 1  ON 27
 eO_8                 1.263723e-01 1 1  ON 28
 eO_9                 5.416523e-02 1 1  ON 29
eH1_0                -2.136954e-01 1 1  ON 30
eH1_1                -1.346537e-01 1 1  ON 31
eH1_2                -9.303340e-02 1 1  ON 32
eH1_3                -5.495655e-02 1 1  ON 33
eH1_4                -8.933239e-03 1 1  ON 34
eH1_5                 3.547048e-03 1 1  ON 35
eH1_6                 5.157120e-02 1 1  ON 36
eH1_7                 5.211625e-02 1 1  ON 37
eH1_8                 2.211083e-01 1 1  ON 38
eH1_9                 1.117392e-01 1 1  ON 39
eH2_0                -2.077703e-01 1 1  ON 40
eH2_1                -1.290544e-01 1 1  ON 41
eH2_2                -8.688391e-02 1 1  ON 42
eH2_3                -4.959366e-02 1 1  ON 43
eH2_4                -3.040281e-03 1 1  ON 44
eH2_5                 8.022216e-03 1 1  ON 45
eH2_6                 4.727517e-02 1 1  ON 46
eH2_7                 7.252766e-03 1 1  ON 47
eH2_8                 2.467110e-01 1 1  ON 48
eH2_9                 1.126965e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.227107
====================================================
  Execution time = 3.1874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.4840e-01
  Total weights = 2.0000e+06
  Execution time = 2.8442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348755224983
                                         uncertainty =       0.021087936038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348755224983
                                         uncertainty =       0.021087936038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417560958
  error estimate for blocks of size 2^( 2) =       0.000427254059
  error estimate for blocks of size 2^( 3) =       0.000435360418
  error estimate for blocks of size 2^( 4) =       0.000441932464
  error estimate for blocks of size 2^( 5) =       0.000445514396
  error estimate for blocks of size 2^( 6) =       0.000448233742
  error estimate for blocks of size 2^( 7) =       0.000451486024

      target function =                  N/A
              le_mean =     -17.213752416315
             les_mean =     296.661986383821
             stat err =       0.000446791656
             autocorr =       1.144907333807
              std dev =       0.590520370518
             le_variance =       0.348714307997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348433852448
                                         uncertainty =       0.021080510035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348433852448
                                         uncertainty =       0.021080510035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417368532
  error estimate for blocks of size 2^( 2) =       0.000427073084
  error estimate for blocks of size 2^( 3) =       0.000435189499
  error estimate for blocks of size 2^( 4) =       0.000441763674
  error estimate for blocks of size 2^( 5) =       0.000445337690
  error estimate for blocks of size 2^( 6) =       0.000448045306
  error estimate for blocks of size 2^( 7) =       0.000451282316

      target function =                  N/A
              le_mean =     -17.213754179446
             les_mean =     296.661725758548
             stat err =       0.000446607247
             autocorr =       1.145017510619
              std dev =       0.590248237906
             le_variance =       0.348392982351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348151477012
                                         uncertainty =       0.021065445650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348151477012
                                         uncertainty =       0.021065445650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417199368
  error estimate for blocks of size 2^( 2) =       0.000426911235
  error estimate for blocks of size 2^( 3) =       0.000435032810
  error estimate for blocks of size 2^( 4) =       0.000441613721
  error estimate for blocks of size 2^( 5) =       0.000445194058
  error estimate for blocks of size 2^( 6) =       0.000447900792
  error estimate for blocks of size 2^( 7) =       0.000451143049

      target function =                  N/A
              le_mean =     -17.213756785740
             les_mean =     296.661533129039
             stat err =       0.000446462905
             autocorr =       1.145205642807
              std dev =       0.590009003740
             le_variance =       0.348110624494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348572249025
                                         uncertainty =       0.021081324716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348572249025
                                         uncertainty =       0.021081324716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417451428
  error estimate for blocks of size 2^( 2) =       0.000427149422
  error estimate for blocks of size 2^( 3) =       0.000435259146
  error estimate for blocks of size 2^( 4) =       0.000441834114
  error estimate for blocks of size 2^( 5) =       0.000445415934
  error estimate for blocks of size 2^( 6) =       0.000448133103
  error estimate for blocks of size 2^( 7) =       0.000451383370

      target function =                  N/A
              le_mean =     -17.213752566576
             les_mean =     296.661808638353
             stat err =       0.000446691630
             autocorr =       1.144995364916
              std dev =       0.590365470983
             le_variance =       0.348531389329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213752416315        initial
     1.4901e-02     1.4901e-01             6.5596e-03       -17.213754179446
     5.9605e-02     5.9605e-01             2.1130e-03       -17.213756785740  <--
     2.3842e-01     2.3842e+00             7.0146e-04       -17.213752566576

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 4.6193e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.936766e-01 1 1  ON 0
 uu_1                 2.895443e-02 1 1  ON 1
 uu_2                -6.892950e-02 1 1  ON 2
 uu_3                -1.263546e-01 1 1  ON 3
 uu_4                -1.624452e-01 1 1  ON 4
 uu_5                -1.740311e-01 1 1  ON 5
 uu_6                -1.580741e-01 1 1  ON 6
 uu_7                -1.119532e-01 1 1  ON 7
 uu_8                -3.700048e-02 1 1  ON 8
 uu_9                 2.149478e-01 1 1  ON 9
 ud_0                 3.495012e-01 1 1  ON 10
 ud_1                 9.062725e-02 1 1  ON 11
 ud_2                -1.754733e-02 1 1  ON 12
 ud_3                -7.671838e-02 1 1  ON 13
 ud_4                -1.257061e-01 1 1  ON 14
 ud_5                -1.620346e-01 1 1  ON 15
 ud_6                -1.727174e-01 1 1  ON 16
 ud_7                -1.449309e-01 1 1  ON 17
 ud_8                -9.335669e-02 1 1  ON 18
 ud_9                 4.330735e-02 1 1  ON 19
 eO_0                -8.932384e-01 1 1  ON 20
 eO_1                -5.711392e-01 1 1  ON 21
 eO_2                -1.596907e-01 1 1  ON 22
 eO_3                 1.057141e-01 1 1  ON 23
 eO_4                 2.230356e-01 1 1  ON 24
 eO_5                 2.970366e-01 1 1  ON 25
 eO_6                 3.084351e-01 1 1  ON 26
 eO_7                 4.649670e-01 1 1  ON 27
 eO_8                 1.263723e-01 1 1  ON 28
 eO_9                 5.416523e-02 1 1  ON 29
eH1_0                -2.136954e-01 1 1  ON 30
eH1_1                -1.346537e-01 1 1  ON 31
eH1_2                -9.303340e-02 1 1  ON 32
eH1_3                -5.495655e-02 1 1  ON 33
eH1_4                -8.933239e-03 1 1  ON 34
eH1_5                 3.547048e-03 1 1  ON 35
eH1_6                 5.157120e-02 1 1  ON 36
eH1_7                 5.211625e-02 1 1  ON 37
eH1_8                 2.211083e-01 1 1  ON 38
eH1_9                 1.117392e-01 1 1  ON 39
eH2_0                -2.077703e-01 1 1  ON 40
eH2_1                -1.290544e-01 1 1  ON 41
eH2_2                -8.688391e-02 1 1  ON 42
eH2_3                -4.959366e-02 1 1  ON 43
eH2_4                -3.040281e-03 1 1  ON 44
eH2_5                 8.022216e-03 1 1  ON 45
eH2_6                 4.727517e-02 1 1  ON 46
eH2_7                 7.252766e-03 1 1  ON 47
eH2_8                 2.467110e-01 1 1  ON 48
eH2_9                 1.126965e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7963e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1955
    reference variance = 0.355481
====================================================
  Execution time = 3.2535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3472e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334657673325
                                         uncertainty =       0.004803875423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334657673325
                                         uncertainty =       0.004803875423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409096294
  error estimate for blocks of size 2^( 2) =       0.000418528992
  error estimate for blocks of size 2^( 3) =       0.000426959784
  error estimate for blocks of size 2^( 4) =       0.000433979607
  error estimate for blocks of size 2^( 5) =       0.000437930002
  error estimate for blocks of size 2^( 6) =       0.000440148276
  error estimate for blocks of size 2^( 7) =       0.000439960898

      target function =                  N/A
              le_mean =     -17.213942287559
             les_mean =     296.654528468284
             stat err =       0.000438004696
             autocorr =       1.146321509734
              std dev =       0.578549527887
             le_variance =       0.334719556218


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721394228756e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213942287559       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213944502050       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213945270312       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213945730619       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213948572668       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213949814372       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213949920478       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213950871779       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213951805051       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213953465478       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213952150442       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213951487864       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213952974359       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213953230589       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213953321183       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213953706620       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213953561285       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-02 is 6.965459e-03

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213942287559       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213944106533       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213944911529       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213945433679       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213947425928       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213948445982       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213948237833       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213948699267       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213949006192       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213949531205       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213948823207       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 1.805432e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213942287559       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213943348547       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213944074813       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213944596681       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213945156173       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213945916452       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213945581484       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213945676697       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213945713479       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213945819322       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 5.315586e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.326928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1831e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.929650e-01 1 1  ON 0
 uu_1                 2.841596e-02 1 1  ON 1
 uu_2                -6.923457e-02 1 1  ON 2
 uu_3                -1.265061e-01 1 1  ON 3
 uu_4                -1.621946e-01 1 1  ON 4
 uu_5                -1.734667e-01 1 1  ON 5
 uu_6                -1.584757e-01 1 1  ON 6
 uu_7                -1.109161e-01 1 1  ON 7
 uu_8                -3.659858e-02 1 1  ON 8
 uu_9                 2.144771e-01 1 1  ON 9
 ud_0                 3.496746e-01 1 1  ON 10
 ud_1                 9.071393e-02 1 1  ON 11
 ud_2                -1.766713e-02 1 1  ON 12
 ud_3                -7.684909e-02 1 1  ON 13
 ud_4                -1.258067e-01 1 1  ON 14
 ud_5                -1.621288e-01 1 1  ON 15
 ud_6                -1.727022e-01 1 1  ON 16
 ud_7                -1.449483e-01 1 1  ON 17
 ud_8                -9.325494e-02 1 1  ON 18
 ud_9                 4.311513e-02 1 1  ON 19
 eO_0                -8.932396e-01 1 1  ON 20
 eO_1                -5.709958e-01 1 1  ON 21
 eO_2                -1.596890e-01 1 1  ON 22
 eO_3                 1.043195e-01 1 1  ON 23
 eO_4                 2.219782e-01 1 1  ON 24
 eO_5                 2.980585e-01 1 1  ON 25
 eO_6                 3.094243e-01 1 1  ON 26
 eO_7                 4.649319e-01 1 1  ON 27
 eO_8                 1.266632e-01 1 1  ON 28
 eO_9                 5.421853e-02 1 1  ON 29
eH1_0                -2.141320e-01 1 1  ON 30
eH1_1                -1.352933e-01 1 1  ON 31
eH1_2                -9.299782e-02 1 1  ON 32
eH1_3                -5.506670e-02 1 1  ON 33
eH1_4                -8.452240e-03 1 1  ON 34
eH1_5                 3.676460e-03 1 1  ON 35
eH1_6                 5.096831e-02 1 1  ON 36
eH1_7                 5.299393e-02 1 1  ON 37
eH1_8                 2.212054e-01 1 1  ON 38
eH1_9                 1.118485e-01 1 1  ON 39
eH2_0                -2.078110e-01 1 1  ON 40
eH2_1                -1.295545e-01 1 1  ON 41
eH2_2                -8.717926e-02 1 1  ON 42
eH2_3                -5.007616e-02 1 1  ON 43
eH2_4                -3.114377e-03 1 1  ON 44
eH2_5                 7.238614e-03 1 1  ON 45
eH2_6                 4.766913e-02 1 1  ON 46
eH2_7                 9.058198e-03 1 1  ON 47
eH2_8                 2.466397e-01 1 1  ON 48
eH2_9                 1.127390e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2438
    reference variance = 0.958734
====================================================
  Execution time = 3.2068e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3209e-01
  Total weights = 2.0000e+06
  Execution time = 2.8502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332096151394
                                         uncertainty =       0.004764818604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332096151394
                                         uncertainty =       0.004764818604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407496147
  error estimate for blocks of size 2^( 2) =       0.000417553984
  error estimate for blocks of size 2^( 3) =       0.000426607223
  error estimate for blocks of size 2^( 4) =       0.000432728835
  error estimate for blocks of size 2^( 5) =       0.000437383481
  error estimate for blocks of size 2^( 6) =       0.000438030685
  error estimate for blocks of size 2^( 7) =       0.000440047018

      target function =                  N/A
              le_mean =     -17.213859111089
             les_mean =     296.649051550493
             stat err =       0.000437047505
             autocorr =       1.150297765166
              std dev =       0.576286578137
             le_variance =       0.332106220141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332111365590
                                         uncertainty =       0.004770067383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332111365590
                                         uncertainty =       0.004770067383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407505369
  error estimate for blocks of size 2^( 2) =       0.000417556635
  error estimate for blocks of size 2^( 3) =       0.000426606038
  error estimate for blocks of size 2^( 4) =       0.000432729700
  error estimate for blocks of size 2^( 5) =       0.000437377908
  error estimate for blocks of size 2^( 6) =       0.000438027646
  error estimate for blocks of size 2^( 7) =       0.000440040112

      target function =                  N/A
              le_mean =     -17.213857910629
             les_mean =     296.649025253051
             stat err =       0.000437043841
             autocorr =       1.150226419744
              std dev =       0.576299619795
             le_variance =       0.332121251776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332080068273
                                         uncertainty =       0.004771906217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332080068273
                                         uncertainty =       0.004771906217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407486171
  error estimate for blocks of size 2^( 2) =       0.000417535331
  error estimate for blocks of size 2^( 3) =       0.000426586324
  error estimate for blocks of size 2^( 4) =       0.000432715593
  error estimate for blocks of size 2^( 5) =       0.000437363634
  error estimate for blocks of size 2^( 6) =       0.000438023211
  error estimate for blocks of size 2^( 7) =       0.000440028579

      target function =                  N/A
              le_mean =     -17.213859003975
             les_mean =     296.649031602147
             stat err =       0.000437032754
             autocorr =       1.150276440826
              std dev =       0.576272469817
             le_variance =       0.332089959469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332136421197
                                         uncertainty =       0.004766825428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332136421197
                                         uncertainty =       0.004766825428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407520838
  error estimate for blocks of size 2^( 2) =       0.000417574502
  error estimate for blocks of size 2^( 3) =       0.000426624680
  error estimate for blocks of size 2^( 4) =       0.000432746450
  error estimate for blocks of size 2^( 5) =       0.000437399094
  error estimate for blocks of size 2^( 6) =       0.000438049546
  error estimate for blocks of size 2^( 7) =       0.000440060762

      target function =                  N/A
              le_mean =     -17.213858345019
             les_mean =     296.649065423140
             stat err =       0.000437063963
             autocorr =       1.150245010116
              std dev =       0.576321496084
             le_variance =       0.332146466848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213859111089        initial  <--
     1.4901e-02     1.4901e-01             6.9655e-03       -17.213857910629
     5.9605e-02     5.9605e-01             1.8054e-03       -17.213859003975
     2.3842e-01     2.3842e+00             5.3156e-04       -17.213858345019

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.5730
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.936766e-01 1 1  ON 0
 uu_1                 2.895443e-02 1 1  ON 1
 uu_2                -6.892950e-02 1 1  ON 2
 uu_3                -1.263546e-01 1 1  ON 3
 uu_4                -1.624452e-01 1 1  ON 4
 uu_5                -1.740311e-01 1 1  ON 5
 uu_6                -1.580741e-01 1 1  ON 6
 uu_7                -1.119532e-01 1 1  ON 7
 uu_8                -3.700048e-02 1 1  ON 8
 uu_9                 2.149478e-01 1 1  ON 9
 ud_0                 3.495012e-01 1 1  ON 10
 ud_1                 9.062725e-02 1 1  ON 11
 ud_2                -1.754733e-02 1 1  ON 12
 ud_3                -7.671838e-02 1 1  ON 13
 ud_4                -1.257061e-01 1 1  ON 14
 ud_5                -1.620346e-01 1 1  ON 15
 ud_6                -1.727174e-01 1 1  ON 16
 ud_7                -1.449309e-01 1 1  ON 17
 ud_8                -9.335669e-02 1 1  ON 18
 ud_9                 4.330735e-02 1 1  ON 19
 eO_0                -8.932384e-01 1 1  ON 20
 eO_1                -5.711392e-01 1 1  ON 21
 eO_2                -1.596907e-01 1 1  ON 22
 eO_3                 1.057141e-01 1 1  ON 23
 eO_4                 2.230356e-01 1 1  ON 24
 eO_5                 2.970366e-01 1 1  ON 25
 eO_6                 3.084351e-01 1 1  ON 26
 eO_7                 4.649670e-01 1 1  ON 27
 eO_8                 1.263723e-01 1 1  ON 28
 eO_9                 5.416523e-02 1 1  ON 29
eH1_0                -2.136954e-01 1 1  ON 30
eH1_1                -1.346537e-01 1 1  ON 31
eH1_2                -9.303340e-02 1 1  ON 32
eH1_3                -5.495655e-02 1 1  ON 33
eH1_4                -8.933239e-03 1 1  ON 34
eH1_5                 3.547048e-03 1 1  ON 35
eH1_6                 5.157120e-02 1 1  ON 36
eH1_7                 5.211625e-02 1 1  ON 37
eH1_8                 2.211083e-01 1 1  ON 38
eH1_9                 1.117392e-01 1 1  ON 39
eH2_0                -2.077703e-01 1 1  ON 40
eH2_1                -1.290544e-01 1 1  ON 41
eH2_2                -8.688391e-02 1 1  ON 42
eH2_3                -4.959366e-02 1 1  ON 43
eH2_4                -3.040281e-03 1 1  ON 44
eH2_5                 8.022216e-03 1 1  ON 45
eH2_6                 4.727517e-02 1 1  ON 46
eH2_7                 7.252766e-03 1 1  ON 47
eH2_8                 2.467110e-01 1 1  ON 48
eH2_9                 1.126965e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.3167
    reference variance = 0.540035
====================================================
  Execution time = 3.2790e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2305e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323133743284
                                         uncertainty =       0.003213173416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323133743284
                                         uncertainty =       0.003213173416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401899995
  error estimate for blocks of size 2^( 2) =       0.000411756317
  error estimate for blocks of size 2^( 3) =       0.000420782605
  error estimate for blocks of size 2^( 4) =       0.000427432232
  error estimate for blocks of size 2^( 5) =       0.000432150134
  error estimate for blocks of size 2^( 6) =       0.000434015633
  error estimate for blocks of size 2^( 7) =       0.000436278866

      target function =                  N/A
              le_mean =     -17.214064397303
             les_mean =     296.647060125396
             stat err =       0.000432469216
             autocorr =       1.157908912022
              std dev =       0.568372424059
             le_variance =       0.323047212431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721406439730e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214064397303       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214064018614       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214064202178       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214064467223       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214064587824       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214065029613       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214065728316       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214065960082       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214065806517       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214065685243       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 7.725155e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214064397303       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214064220596       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214064206166       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214064247423       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214064455745       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214064729267       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214064926192       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214064919989       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.435562e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214064397303       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214064340910       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214064324453       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214064327236       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214064406460       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214064492822       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214064523770       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.164411e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329766 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2082e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.936788e-01 1 1  ON 0
 uu_1                 2.883643e-02 1 1  ON 1
 uu_2                -6.892810e-02 1 1  ON 2
 uu_3                -1.263571e-01 1 1  ON 3
 uu_4                -1.623820e-01 1 1  ON 4
 uu_5                -1.739945e-01 1 1  ON 5
 uu_6                -1.580961e-01 1 1  ON 6
 uu_7                -1.119117e-01 1 1  ON 7
 uu_8                -3.698378e-02 1 1  ON 8
 uu_9                 2.148984e-01 1 1  ON 9
 ud_0                 3.498448e-01 1 1  ON 10
 ud_1                 9.067954e-02 1 1  ON 11
 ud_2                -1.754077e-02 1 1  ON 12
 ud_3                -7.671237e-02 1 1  ON 13
 ud_4                -1.256808e-01 1 1  ON 14
 ud_5                -1.620902e-01 1 1  ON 15
 ud_6                -1.729501e-01 1 1  ON 16
 ud_7                -1.450092e-01 1 1  ON 17
 ud_8                -9.338287e-02 1 1  ON 18
 ud_9                 4.323859e-02 1 1  ON 19
 eO_0                -8.933077e-01 1 1  ON 20
 eO_1                -5.711330e-01 1 1  ON 21
 eO_2                -1.594967e-01 1 1  ON 22
 eO_3                 1.055218e-01 1 1  ON 23
 eO_4                 2.229933e-01 1 1  ON 24
 eO_5                 2.971260e-01 1 1  ON 25
 eO_6                 3.084853e-01 1 1  ON 26
 eO_7                 4.649145e-01 1 1  ON 27
 eO_8                 1.263836e-01 1 1  ON 28
 eO_9                 5.416726e-02 1 1  ON 29
eH1_0                -2.137955e-01 1 1  ON 30
eH1_1                -1.348319e-01 1 1  ON 31
eH1_2                -9.282825e-02 1 1  ON 32
eH1_3                -5.491510e-02 1 1  ON 33
eH1_4                -8.839814e-03 1 1  ON 34
eH1_5                 3.562745e-03 1 1  ON 35
eH1_6                 5.146096e-02 1 1  ON 36
eH1_7                 5.216727e-02 1 1  ON 37
eH1_8                 2.210852e-01 1 1  ON 38
eH1_9                 1.117399e-01 1 1  ON 39
eH2_0                -2.076518e-01 1 1  ON 40
eH2_1                -1.291506e-01 1 1  ON 41
eH2_2                -8.700154e-02 1 1  ON 42
eH2_3                -4.951216e-02 1 1  ON 43
eH2_4                -3.053024e-03 1 1  ON 44
eH2_5                 7.938182e-03 1 1  ON 45
eH2_6                 4.724516e-02 1 1  ON 46
eH2_7                 7.417804e-03 1 1  ON 47
eH2_8                 2.466829e-01 1 1  ON 48
eH2_9                 1.126945e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2708
    reference variance = 0.265133
====================================================
  Execution time = 3.2156e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2696e-01
  Total weights = 2.0000e+06
  Execution time = 2.8548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326731142953
                                         uncertainty =       0.002949468544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326731142953
                                         uncertainty =       0.002949468544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404192943
  error estimate for blocks of size 2^( 2) =       0.000413905670
  error estimate for blocks of size 2^( 3) =       0.000422336052
  error estimate for blocks of size 2^( 4) =       0.000428997372
  error estimate for blocks of size 2^( 5) =       0.000432166149
  error estimate for blocks of size 2^( 6) =       0.000434803563
  error estimate for blocks of size 2^( 7) =       0.000437244205

      target function =                  N/A
              le_mean =     -17.213538306508
             les_mean =     296.632644736113
             stat err =       0.000433302822
             autocorr =       1.149226370361
              std dev =       0.571615141405
             le_variance =       0.326743869883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327103085239
                                         uncertainty =       0.002951186789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327103085239
                                         uncertainty =       0.002951186789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404422894
  error estimate for blocks of size 2^( 2) =       0.000414120050
  error estimate for blocks of size 2^( 3) =       0.000422541687
  error estimate for blocks of size 2^( 4) =       0.000429200218
  error estimate for blocks of size 2^( 5) =       0.000432364493
  error estimate for blocks of size 2^( 6) =       0.000435005273
  error estimate for blocks of size 2^( 7) =       0.000437440338

      target function =                  N/A
              le_mean =     -17.213537639959
             les_mean =     296.632993672808
             stat err =       0.000433502580
             autocorr =       1.148978518247
              std dev =       0.571940341358
             le_variance =       0.327115754073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327172880125
                                         uncertainty =       0.002951913935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327172880125
                                         uncertainty =       0.002951913935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404466036
  error estimate for blocks of size 2^( 2) =       0.000414161459
  error estimate for blocks of size 2^( 3) =       0.000422581339
  error estimate for blocks of size 2^( 4) =       0.000429239519
  error estimate for blocks of size 2^( 5) =       0.000432403761
  error estimate for blocks of size 2^( 6) =       0.000435043401
  error estimate for blocks of size 2^( 7) =       0.000437481135

      target function =                  N/A
              le_mean =     -17.213538398844
             les_mean =     296.633089593675
             stat err =       0.000433541954
             autocorr =       1.148942100696
              std dev =       0.572001353843
             le_variance =       0.327185548798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326812494952
                                         uncertainty =       0.002949883193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326812494952
                                         uncertainty =       0.002949883193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404243250
  error estimate for blocks of size 2^( 2) =       0.000413952729
  error estimate for blocks of size 2^( 3) =       0.000422381085
  error estimate for blocks of size 2^( 4) =       0.000429041804
  error estimate for blocks of size 2^( 5) =       0.000432209969
  error estimate for blocks of size 2^( 6) =       0.000434847421
  error estimate for blocks of size 2^( 7) =       0.000437287682

      target function =                  N/A
              le_mean =     -17.213538262035
             les_mean =     296.632724545334
             stat err =       0.000433346719
             autocorr =       1.149173153706
              std dev =       0.571686286526
             le_variance =       0.326825210202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213538306508        initial
     1.4901e-01     1.4901e+00             7.7252e-04       -17.213537639959
     5.9605e-01     5.9605e+00             3.4356e-04       -17.213538398844  <--
     2.3842e+00     2.3842e+01             1.1644e-04       -17.213538262035

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 4.6544e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.936788e-01 1 1  ON 0
 uu_1                 2.883643e-02 1 1  ON 1
 uu_2                -6.892810e-02 1 1  ON 2
 uu_3                -1.263571e-01 1 1  ON 3
 uu_4                -1.623820e-01 1 1  ON 4
 uu_5                -1.739945e-01 1 1  ON 5
 uu_6                -1.580961e-01 1 1  ON 6
 uu_7                -1.119117e-01 1 1  ON 7
 uu_8                -3.698378e-02 1 1  ON 8
 uu_9                 2.148984e-01 1 1  ON 9
 ud_0                 3.498448e-01 1 1  ON 10
 ud_1                 9.067954e-02 1 1  ON 11
 ud_2                -1.754077e-02 1 1  ON 12
 ud_3                -7.671237e-02 1 1  ON 13
 ud_4                -1.256808e-01 1 1  ON 14
 ud_5                -1.620902e-01 1 1  ON 15
 ud_6                -1.729501e-01 1 1  ON 16
 ud_7                -1.450092e-01 1 1  ON 17
 ud_8                -9.338287e-02 1 1  ON 18
 ud_9                 4.323859e-02 1 1  ON 19
 eO_0                -8.933077e-01 1 1  ON 20
 eO_1                -5.711330e-01 1 1  ON 21
 eO_2                -1.594967e-01 1 1  ON 22
 eO_3                 1.055218e-01 1 1  ON 23
 eO_4                 2.229933e-01 1 1  ON 24
 eO_5                 2.971260e-01 1 1  ON 25
 eO_6                 3.084853e-01 1 1  ON 26
 eO_7                 4.649145e-01 1 1  ON 27
 eO_8                 1.263836e-01 1 1  ON 28
 eO_9                 5.416726e-02 1 1  ON 29
eH1_0                -2.137955e-01 1 1  ON 30
eH1_1                -1.348319e-01 1 1  ON 31
eH1_2                -9.282825e-02 1 1  ON 32
eH1_3                -5.491510e-02 1 1  ON 33
eH1_4                -8.839814e-03 1 1  ON 34
eH1_5                 3.562745e-03 1 1  ON 35
eH1_6                 5.146096e-02 1 1  ON 36
eH1_7                 5.216727e-02 1 1  ON 37
eH1_8                 2.210852e-01 1 1  ON 38
eH1_9                 1.117399e-01 1 1  ON 39
eH2_0                -2.076518e-01 1 1  ON 40
eH2_1                -1.291506e-01 1 1  ON 41
eH2_2                -8.700154e-02 1 1  ON 42
eH2_3                -4.951216e-02 1 1  ON 43
eH2_4                -3.053024e-03 1 1  ON 44
eH2_5                 7.938182e-03 1 1  ON 45
eH2_6                 4.724516e-02 1 1  ON 46
eH2_7                 7.417804e-03 1 1  ON 47
eH2_8                 2.466829e-01 1 1  ON 48
eH2_9                 1.126945e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8631e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.223
    reference variance = 0.270936
====================================================
  Execution time = 3.2751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2191e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321973157568
                                         uncertainty =       0.002506152819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321973157568
                                         uncertainty =       0.002506152819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401191159
  error estimate for blocks of size 2^( 2) =       0.000411375131
  error estimate for blocks of size 2^( 3) =       0.000420351037
  error estimate for blocks of size 2^( 4) =       0.000426711280
  error estimate for blocks of size 2^( 5) =       0.000430554188
  error estimate for blocks of size 2^( 6) =       0.000430988434
  error estimate for blocks of size 2^( 7) =       0.000432776227

      target function =                  N/A
              le_mean =     -17.213914425974
             les_mean =     296.640758396395
             stat err =       0.000430257532
             autocorr =       1.150149394431
              std dev =       0.567369978594
             le_variance =       0.321908692610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721391442597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213914425974       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213915860675       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213915535508       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213915955001       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213915634439       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213916806601       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213916685758       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213916477400       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213916303182       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213916441580       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 8.317528e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213914425974       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213914989078       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213914851499       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213915189708       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213915084046       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213915476096       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213915294815       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213915254089       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 2.115093e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213914425974       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213914590142       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213914548775       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213914694714       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213914668439       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213914757745       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213914701395       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 5.320165e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.332649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1887e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.936245e-01 1 1  ON 0
 uu_1                 2.872482e-02 1 1  ON 1
 uu_2                -6.894819e-02 1 1  ON 2
 uu_3                -1.263610e-01 1 1  ON 3
 uu_4                -1.624076e-01 1 1  ON 4
 uu_5                -1.739681e-01 1 1  ON 5
 uu_6                -1.581490e-01 1 1  ON 6
 uu_7                -1.117857e-01 1 1  ON 7
 uu_8                -3.691716e-02 1 1  ON 8
 uu_9                 2.148548e-01 1 1  ON 9
 ud_0                 3.499233e-01 1 1  ON 10
 ud_1                 9.070075e-02 1 1  ON 11
 ud_2                -1.755828e-02 1 1  ON 12
 ud_3                -7.666822e-02 1 1  ON 13
 ud_4                -1.257860e-01 1 1  ON 14
 ud_5                -1.622073e-01 1 1  ON 15
 ud_6                -1.728904e-01 1 1  ON 16
 ud_7                -1.450285e-01 1 1  ON 17
 ud_8                -9.337635e-02 1 1  ON 18
 ud_9                 4.320172e-02 1 1  ON 19
 eO_0                -8.933482e-01 1 1  ON 20
 eO_1                -5.712053e-01 1 1  ON 21
 eO_2                -1.595275e-01 1 1  ON 22
 eO_3                 1.054329e-01 1 1  ON 23
 eO_4                 2.229693e-01 1 1  ON 24
 eO_5                 2.972522e-01 1 1  ON 25
 eO_6                 3.085977e-01 1 1  ON 26
 eO_7                 4.648871e-01 1 1  ON 27
 eO_8                 1.264072e-01 1 1  ON 28
 eO_9                 5.417268e-02 1 1  ON 29
eH1_0                -2.138163e-01 1 1  ON 30
eH1_1                -1.348035e-01 1 1  ON 31
eH1_2                -9.271785e-02 1 1  ON 32
eH1_3                -5.497598e-02 1 1  ON 33
eH1_4                -8.784680e-03 1 1  ON 34
eH1_5                 3.456280e-03 1 1  ON 35
eH1_6                 5.139849e-02 1 1  ON 36
eH1_7                 5.219503e-02 1 1  ON 37
eH1_8                 2.210780e-01 1 1  ON 38
eH1_9                 1.117521e-01 1 1  ON 39
eH2_0                -2.076212e-01 1 1  ON 40
eH2_1                -1.292130e-01 1 1  ON 41
eH2_2                -8.696521e-02 1 1  ON 42
eH2_3                -4.953522e-02 1 1  ON 43
eH2_4                -3.151329e-03 1 1  ON 44
eH2_5                 7.770079e-03 1 1  ON 45
eH2_6                 4.731312e-02 1 1  ON 46
eH2_7                 7.629313e-03 1 1  ON 47
eH2_8                 2.466679e-01 1 1  ON 48
eH2_9                 1.127033e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1599
    reference variance = 0.173751
====================================================
  Execution time = 3.2006e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.2471e-01
  Total weights = 2.0000e+06
  Execution time = 2.8320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324814974211
                                         uncertainty =       0.003596955551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324814974211
                                         uncertainty =       0.003596955551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402915985
  error estimate for blocks of size 2^( 2) =       0.000413199573
  error estimate for blocks of size 2^( 3) =       0.000422263444
  error estimate for blocks of size 2^( 4) =       0.000428646542
  error estimate for blocks of size 2^( 5) =       0.000433115902
  error estimate for blocks of size 2^( 6) =       0.000436085309
  error estimate for blocks of size 2^( 7) =       0.000438693350

      target function =                  N/A
              le_mean =     -17.213453545619
             les_mean =     296.627665387286
             stat err =       0.000434135276
             autocorr =       1.160970422950
              std dev =       0.569809250921
             le_variance =       0.324682582436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324825528292
                                         uncertainty =       0.003596106366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324825528292
                                         uncertainty =       0.003596106366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402922497
  error estimate for blocks of size 2^( 2) =       0.000413205048
  error estimate for blocks of size 2^( 3) =       0.000422270486
  error estimate for blocks of size 2^( 4) =       0.000428653009
  error estimate for blocks of size 2^( 5) =       0.000433120631
  error estimate for blocks of size 2^( 6) =       0.000436091920
  error estimate for blocks of size 2^( 7) =       0.000438694714

      target function =                  N/A
              le_mean =     -17.213452743868
             les_mean =     296.627648280297
             stat err =       0.000434140069
             autocorr =       1.160958531909
              std dev =       0.569818459908
             le_variance =       0.324693077252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324863235040
                                         uncertainty =       0.003596364655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324863235040
                                         uncertainty =       0.003596364655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402945866
  error estimate for blocks of size 2^( 2) =       0.000413227173
  error estimate for blocks of size 2^( 3) =       0.000422292120
  error estimate for blocks of size 2^( 4) =       0.000428674737
  error estimate for blocks of size 2^( 5) =       0.000433142006
  error estimate for blocks of size 2^( 6) =       0.000436113092
  error estimate for blocks of size 2^( 7) =       0.000438716793

      target function =                  N/A
              le_mean =     -17.213452937680
             les_mean =     296.627692616809
             stat err =       0.000434161657
             autocorr =       1.160939327412
              std dev =       0.569851508236
             le_variance =       0.324730741439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324826830419
                                         uncertainty =       0.003596903835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324826830419
                                         uncertainty =       0.003596903835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402923327
  error estimate for blocks of size 2^( 2) =       0.000413206332
  error estimate for blocks of size 2^( 3) =       0.000422270296
  error estimate for blocks of size 2^( 4) =       0.000428653346
  error estimate for blocks of size 2^( 5) =       0.000433122212
  error estimate for blocks of size 2^( 6) =       0.000436091856
  error estimate for blocks of size 2^( 7) =       0.000438699310

      target function =                  N/A
              le_mean =     -17.213453471540
             les_mean =     296.627674669655
             stat err =       0.000434141681
             autocorr =       1.160962370862
              std dev =       0.569819633844
             le_variance =       0.324694415115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213453545619        initial  <--
     1.4901e-01     1.4901e+00             8.3175e-04       -17.213452743868
     5.9605e-01     5.9605e+00             2.1151e-04       -17.213452937680
     2.3842e+00     2.3842e+01             5.3202e-05       -17.213453471540

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.2659
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.936788e-01 1 1  ON 0
 uu_1                 2.883643e-02 1 1  ON 1
 uu_2                -6.892810e-02 1 1  ON 2
 uu_3                -1.263571e-01 1 1  ON 3
 uu_4                -1.623820e-01 1 1  ON 4
 uu_5                -1.739945e-01 1 1  ON 5
 uu_6                -1.580961e-01 1 1  ON 6
 uu_7                -1.119117e-01 1 1  ON 7
 uu_8                -3.698378e-02 1 1  ON 8
 uu_9                 2.148984e-01 1 1  ON 9
 ud_0                 3.498448e-01 1 1  ON 10
 ud_1                 9.067954e-02 1 1  ON 11
 ud_2                -1.754077e-02 1 1  ON 12
 ud_3                -7.671237e-02 1 1  ON 13
 ud_4                -1.256808e-01 1 1  ON 14
 ud_5                -1.620902e-01 1 1  ON 15
 ud_6                -1.729501e-01 1 1  ON 16
 ud_7                -1.450092e-01 1 1  ON 17
 ud_8                -9.338287e-02 1 1  ON 18
 ud_9                 4.323859e-02 1 1  ON 19
 eO_0                -8.933077e-01 1 1  ON 20
 eO_1                -5.711330e-01 1 1  ON 21
 eO_2                -1.594967e-01 1 1  ON 22
 eO_3                 1.055218e-01 1 1  ON 23
 eO_4                 2.229933e-01 1 1  ON 24
 eO_5                 2.971260e-01 1 1  ON 25
 eO_6                 3.084853e-01 1 1  ON 26
 eO_7                 4.649145e-01 1 1  ON 27
 eO_8                 1.263836e-01 1 1  ON 28
 eO_9                 5.416726e-02 1 1  ON 29
eH1_0                -2.137955e-01 1 1  ON 30
eH1_1                -1.348319e-01 1 1  ON 31
eH1_2                -9.282825e-02 1 1  ON 32
eH1_3                -5.491510e-02 1 1  ON 33
eH1_4                -8.839814e-03 1 1  ON 34
eH1_5                 3.562745e-03 1 1  ON 35
eH1_6                 5.146096e-02 1 1  ON 36
eH1_7                 5.216727e-02 1 1  ON 37
eH1_8                 2.210852e-01 1 1  ON 38
eH1_9                 1.117399e-01 1 1  ON 39
eH2_0                -2.076518e-01 1 1  ON 40
eH2_1                -1.291506e-01 1 1  ON 41
eH2_2                -8.700154e-02 1 1  ON 42
eH2_3                -4.951216e-02 1 1  ON 43
eH2_4                -3.053024e-03 1 1  ON 44
eH2_5                 7.938182e-03 1 1  ON 45
eH2_6                 4.724516e-02 1 1  ON 46
eH2_7                 7.417804e-03 1 1  ON 47
eH2_8                 2.466829e-01 1 1  ON 48
eH2_9                 1.126945e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8160e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2174
    reference variance = 0.139532
====================================================
  Execution time = 3.2950e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2557e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325475485146
                                         uncertainty =       0.003417848999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325475485146
                                         uncertainty =       0.003417848999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403466133
  error estimate for blocks of size 2^( 2) =       0.000414038686
  error estimate for blocks of size 2^( 3) =       0.000422668220
  error estimate for blocks of size 2^( 4) =       0.000429120171
  error estimate for blocks of size 2^( 5) =       0.000434008007
  error estimate for blocks of size 2^( 6) =       0.000435124526
  error estimate for blocks of size 2^( 7) =       0.000436969578

      target function =                  N/A
              le_mean =     -17.213806413342
             les_mean =     296.640700913437
             stat err =       0.000433805570
             autocorr =       1.156048562269
              std dev =       0.570587276590
             le_variance =       0.325569840207


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721380641334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213806413342       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213806976410       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213806796499       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213806773927       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213806534882       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213806251601       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213806460394       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213806464846       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.154207e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213806413342       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213806575757       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213806543715       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213806537196       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213806458980       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213806387731       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213806423469       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.866381e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213806413342       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213806455569       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213806448611       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213806447053       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213806426252       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213806408340       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213806415899       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 7.711699e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1925e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.936646e-01 1 1  ON 0
 uu_1                 2.881195e-02 1 1  ON 1
 uu_2                -6.892459e-02 1 1  ON 2
 uu_3                -1.263682e-01 1 1  ON 3
 uu_4                -1.623935e-01 1 1  ON 4
 uu_5                -1.739704e-01 1 1  ON 5
 uu_6                -1.580877e-01 1 1  ON 6
 uu_7                -1.118952e-01 1 1  ON 7
 uu_8                -3.697717e-02 1 1  ON 8
 uu_9                 2.148954e-01 1 1  ON 9
 ud_0                 3.498161e-01 1 1  ON 10
 ud_1                 9.070415e-02 1 1  ON 11
 ud_2                -1.753633e-02 1 1  ON 12
 ud_3                -7.670710e-02 1 1  ON 13
 ud_4                -1.256786e-01 1 1  ON 14
 ud_5                -1.620925e-01 1 1  ON 15
 ud_6                -1.729587e-01 1 1  ON 16
 ud_7                -1.450089e-01 1 1  ON 17
 ud_8                -9.337999e-02 1 1  ON 18
 ud_9                 4.323651e-02 1 1  ON 19
 eO_0                -8.933244e-01 1 1  ON 20
 eO_1                -5.711346e-01 1 1  ON 21
 eO_2                -1.594997e-01 1 1  ON 22
 eO_3                 1.055350e-01 1 1  ON 23
 eO_4                 2.229772e-01 1 1  ON 24
 eO_5                 2.971330e-01 1 1  ON 25
 eO_6                 3.084976e-01 1 1  ON 26
 eO_7                 4.649143e-01 1 1  ON 27
 eO_8                 1.263874e-01 1 1  ON 28
 eO_9                 5.416818e-02 1 1  ON 29
eH1_0                -2.137985e-01 1 1  ON 30
eH1_1                -1.348530e-01 1 1  ON 31
eH1_2                -9.281821e-02 1 1  ON 32
eH1_3                -5.489590e-02 1 1  ON 33
eH1_4                -8.820068e-03 1 1  ON 34
eH1_5                 3.550463e-03 1 1  ON 35
eH1_6                 5.144374e-02 1 1  ON 36
eH1_7                 5.217067e-02 1 1  ON 37
eH1_8                 2.210846e-01 1 1  ON 38
eH1_9                 1.117407e-01 1 1  ON 39
eH2_0                -2.076616e-01 1 1  ON 40
eH2_1                -1.291530e-01 1 1  ON 41
eH2_2                -8.700472e-02 1 1  ON 42
eH2_3                -4.950210e-02 1 1  ON 43
eH2_4                -3.071171e-03 1 1  ON 44
eH2_5                 7.922002e-03 1 1  ON 45
eH2_6                 4.725941e-02 1 1  ON 46
eH2_7                 7.444943e-03 1 1  ON 47
eH2_8                 2.466811e-01 1 1  ON 48
eH2_9                 1.126943e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2229
    reference variance = 0.143803
====================================================
  Execution time = 3.2326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3255e-01
  Total weights = 2.0000e+06
  Execution time = 2.8425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332627906349
                                         uncertainty =       0.003674148180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332627906349
                                         uncertainty =       0.003674148180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407794478
  error estimate for blocks of size 2^( 2) =       0.000418133602
  error estimate for blocks of size 2^( 3) =       0.000427169883
  error estimate for blocks of size 2^( 4) =       0.000433618334
  error estimate for blocks of size 2^( 5) =       0.000437246248
  error estimate for blocks of size 2^( 6) =       0.000439950751
  error estimate for blocks of size 2^( 7) =       0.000443513241

      target function =                  N/A
              le_mean =     -17.214121230867
             les_mean =     296.658562256495
             stat err =       0.000438582144
             autocorr =       1.156695941219
              std dev =       0.576708480772
             le_variance =       0.332592671794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332501597412
                                         uncertainty =       0.003672416774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332501597412
                                         uncertainty =       0.003672416774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407717008
  error estimate for blocks of size 2^( 2) =       0.000418058167
  error estimate for blocks of size 2^( 3) =       0.000427096213
  error estimate for blocks of size 2^( 4) =       0.000433545531
  error estimate for blocks of size 2^( 5) =       0.000437175112
  error estimate for blocks of size 2^( 6) =       0.000439880972
  error estimate for blocks of size 2^( 7) =       0.000443440697

      target function =                  N/A
              le_mean =     -17.214121407307
             les_mean =     296.658441976880
             stat err =       0.000438510578
             autocorr =       1.156757942277
              std dev =       0.576598922642
             le_variance =       0.332466317592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332543789858
                                         uncertainty =       0.003673011100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332543789858
                                         uncertainty =       0.003673011100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407742890
  error estimate for blocks of size 2^( 2) =       0.000418083489
  error estimate for blocks of size 2^( 3) =       0.000427121025
  error estimate for blocks of size 2^( 4) =       0.000433570033
  error estimate for blocks of size 2^( 5) =       0.000437199069
  error estimate for blocks of size 2^( 6) =       0.000439904595
  error estimate for blocks of size 2^( 7) =       0.000443465340

      target function =                  N/A
              le_mean =     -17.214121365396
             les_mean =     296.658482744821
             stat err =       0.000438534759
             autocorr =       1.156738660576
              std dev =       0.576635524837
             le_variance =       0.332508528504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332616697305
                                         uncertainty =       0.003673996991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332616697305
                                         uncertainty =       0.003673996991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407787604
  error estimate for blocks of size 2^( 2) =       0.000418126925
  error estimate for blocks of size 2^( 3) =       0.000427163372
  error estimate for blocks of size 2^( 4) =       0.000433611895
  error estimate for blocks of size 2^( 5) =       0.000437239960
  error estimate for blocks of size 2^( 6) =       0.000439944601
  error estimate for blocks of size 2^( 7) =       0.000443506857

      target function =                  N/A
              le_mean =     -17.214121247509
             les_mean =     296.658551616872
             stat err =       0.000438575829
             autocorr =       1.156701626320
              std dev =       0.576698759519
             le_variance =       0.332581459230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214121230867        initial
     1.4901e+00     1.4901e+01             1.1542e-04       -17.214121407307  <--
     5.9605e+00     5.9605e+01             2.8664e-05       -17.214121365396
     2.3842e+01     2.3842e+02             7.7117e-06       -17.214121247509

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 4.6612e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.936210e-01 1 1  ON 0
 uu_1                 2.875577e-02 1 1  ON 1
 uu_2                -6.892800e-02 1 1  ON 2
 uu_3                -1.263933e-01 1 1  ON 3
 uu_4                -1.624260e-01 1 1  ON 4
 uu_5                -1.739123e-01 1 1  ON 5
 uu_6                -1.580662e-01 1 1  ON 6
 uu_7                -1.118427e-01 1 1  ON 7
 uu_8                -3.695583e-02 1 1  ON 8
 uu_9                 2.148854e-01 1 1  ON 9
 ud_0                 3.497652e-01 1 1  ON 10
 ud_1                 9.075930e-02 1 1  ON 11
 ud_2                -1.752431e-02 1 1  ON 12
 ud_3                -7.669687e-02 1 1  ON 13
 ud_4                -1.256761e-01 1 1  ON 14
 ud_5                -1.620982e-01 1 1  ON 15
 ud_6                -1.729892e-01 1 1  ON 16
 ud_7                -1.450098e-01 1 1  ON 17
 ud_8                -9.337120e-02 1 1  ON 18
 ud_9                 4.322953e-02 1 1  ON 19
 eO_0                -8.933689e-01 1 1  ON 20
 eO_1                -5.711420e-01 1 1  ON 21
 eO_2                -1.595077e-01 1 1  ON 22
 eO_3                 1.055704e-01 1 1  ON 23
 eO_4                 2.229258e-01 1 1  ON 24
 eO_5                 2.971543e-01 1 1  ON 25
 eO_6                 3.085369e-01 1 1  ON 26
 eO_7                 4.649134e-01 1 1  ON 27
 eO_8                 1.263997e-01 1 1  ON 28
 eO_9                 5.417119e-02 1 1  ON 29
eH1_0                -2.138054e-01 1 1  ON 30
eH1_1                -1.349051e-01 1 1  ON 31
eH1_2                -9.279257e-02 1 1  ON 32
eH1_3                -5.483939e-02 1 1  ON 33
eH1_4                -8.762584e-03 1 1  ON 34
eH1_5                 3.511273e-03 1 1  ON 35
eH1_6                 5.138782e-02 1 1  ON 36
eH1_7                 5.218138e-02 1 1  ON 37
eH1_8                 2.210827e-01 1 1  ON 38
eH1_9                 1.117436e-01 1 1  ON 39
eH2_0                -2.076908e-01 1 1  ON 40
eH2_1                -1.291605e-01 1 1  ON 41
eH2_2                -8.701186e-02 1 1  ON 42
eH2_3                -4.948122e-02 1 1  ON 43
eH2_4                -3.122414e-03 1 1  ON 44
eH2_5                 7.869255e-03 1 1  ON 45
eH2_6                 4.730398e-02 1 1  ON 46
eH2_7                 7.533225e-03 1 1  ON 47
eH2_8                 2.466754e-01 1 1  ON 48
eH2_9                 1.126936e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8543e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2688
    reference variance = 0.615131
====================================================
  Execution time = 3.4754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.4439e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344426229265
                                         uncertainty =       0.019858395363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344426229265
                                         uncertainty =       0.019858395363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414965150
  error estimate for blocks of size 2^( 2) =       0.000425069416
  error estimate for blocks of size 2^( 3) =       0.000433345750
  error estimate for blocks of size 2^( 4) =       0.000439617209
  error estimate for blocks of size 2^( 5) =       0.000444207146
  error estimate for blocks of size 2^( 6) =       0.000444408974
  error estimate for blocks of size 2^( 7) =       0.000444579741

      target function =                  N/A
              le_mean =     -17.214620092784
             les_mean =     296.687536917713
             stat err =       0.000443203268
             autocorr =       1.140729461053
              std dev =       0.586849342708
             le_variance =       0.344392151037


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721462009278e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214620092784       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214620337845       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214621079429       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214621249791       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214620630044       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214620682151       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214621044124       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214621025925       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 3.734425e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214620092784       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214620175648       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214620418246       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214620529956       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214620352461       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214620420388       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214620493897       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 9.368235e-05

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214620092784       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214620115502       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214620181380       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214620217946       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214620176299       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214620197678       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214620215890       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.383650e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.337444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4227e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.936214e-01 1 1  ON 0
 uu_1                 2.874488e-02 1 1  ON 1
 uu_2                -6.892796e-02 1 1  ON 2
 uu_3                -1.264249e-01 1 1  ON 3
 uu_4                -1.624403e-01 1 1  ON 4
 uu_5                -1.739138e-01 1 1  ON 5
 uu_6                -1.580649e-01 1 1  ON 6
 uu_7                -1.118033e-01 1 1  ON 7
 uu_8                -3.694538e-02 1 1  ON 8
 uu_9                 2.148687e-01 1 1  ON 9
 ud_0                 3.498054e-01 1 1  ON 10
 ud_1                 9.074419e-02 1 1  ON 11
 ud_2                -1.753526e-02 1 1  ON 12
 ud_3                -7.671498e-02 1 1  ON 13
 ud_4                -1.256883e-01 1 1  ON 14
 ud_5                -1.621470e-01 1 1  ON 15
 ud_6                -1.729567e-01 1 1  ON 16
 ud_7                -1.449816e-01 1 1  ON 17
 ud_8                -9.336886e-02 1 1  ON 18
 ud_9                 4.321496e-02 1 1  ON 19
 eO_0                -8.933961e-01 1 1  ON 20
 eO_1                -5.711787e-01 1 1  ON 21
 eO_2                -1.594986e-01 1 1  ON 22
 eO_3                 1.055492e-01 1 1  ON 23
 eO_4                 2.228967e-01 1 1  ON 24
 eO_5                 2.972235e-01 1 1  ON 25
 eO_6                 3.085779e-01 1 1  ON 26
 eO_7                 4.648950e-01 1 1  ON 27
 eO_8                 1.264074e-01 1 1  ON 28
 eO_9                 5.417484e-02 1 1  ON 29
eH1_0                -2.137740e-01 1 1  ON 30
eH1_1                -1.349598e-01 1 1  ON 31
eH1_2                -9.276874e-02 1 1  ON 32
eH1_3                -5.489221e-02 1 1  ON 33
eH1_4                -8.719243e-03 1 1  ON 34
eH1_5                 3.528329e-03 1 1  ON 35
eH1_6                 5.135540e-02 1 1  ON 36
eH1_7                 5.221374e-02 1 1  ON 37
eH1_8                 2.210722e-01 1 1  ON 38
eH1_9                 1.117447e-01 1 1  ON 39
eH2_0                -2.077052e-01 1 1  ON 40
eH2_1                -1.291368e-01 1 1  ON 41
eH2_2                -8.703692e-02 1 1  ON 42
eH2_3                -4.951653e-02 1 1  ON 43
eH2_4                -3.169295e-03 1 1  ON 44
eH2_5                 7.844751e-03 1 1  ON 45
eH2_6                 4.733295e-02 1 1  ON 46
eH2_7                 7.626907e-03 1 1  ON 47
eH2_8                 2.466719e-01 1 1  ON 48
eH2_9                 1.126934e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2123
    reference variance = 0.195168
====================================================
  Execution time = 3.1946e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2937e-01
  Total weights = 2.0000e+06
  Execution time = 2.8318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329292199830
                                         uncertainty =       0.004357717911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329292199830
                                         uncertainty =       0.004357717911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405783696
  error estimate for blocks of size 2^( 2) =       0.000415612589
  error estimate for blocks of size 2^( 3) =       0.000424508815
  error estimate for blocks of size 2^( 4) =       0.000431086262
  error estimate for blocks of size 2^( 5) =       0.000434446328
  error estimate for blocks of size 2^( 6) =       0.000436171033
  error estimate for blocks of size 2^( 7) =       0.000438886126

      target function =                  N/A
              le_mean =     -17.214427072064
             les_mean =     296.665820070612
             stat err =       0.000435147437
             autocorr =       1.149962486922
              std dev =       0.573864806271
             le_variance =       0.329320815876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329403629095
                                         uncertainty =       0.004359024597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329403629095
                                         uncertainty =       0.004359024597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405852373
  error estimate for blocks of size 2^( 2) =       0.000415679053
  error estimate for blocks of size 2^( 3) =       0.000424572610
  error estimate for blocks of size 2^( 4) =       0.000431147068
  error estimate for blocks of size 2^( 5) =       0.000434503133
  error estimate for blocks of size 2^( 6) =       0.000436225637
  error estimate for blocks of size 2^( 7) =       0.000438944822

      target function =                  N/A
              le_mean =     -17.214427360910
             les_mean =     296.665941496526
             stat err =       0.000435205165
             autocorr =       1.149878365364
              std dev =       0.573961930087
             le_variance =       0.329432297190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329386434789
                                         uncertainty =       0.004358930321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329386434789
                                         uncertainty =       0.004358930321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405841771
  error estimate for blocks of size 2^( 2) =       0.000415668684
  error estimate for blocks of size 2^( 3) =       0.000424562672
  error estimate for blocks of size 2^( 4) =       0.000431137613
  error estimate for blocks of size 2^( 5) =       0.000434494207
  error estimate for blocks of size 2^( 6) =       0.000436216639
  error estimate for blocks of size 2^( 7) =       0.000438935458

      target function =                  N/A
              le_mean =     -17.214427345406
             les_mean =     296.665923751253
             stat err =       0.000435195979
             autocorr =       1.149889903262
              std dev =       0.573946936306
             le_variance =       0.329415085695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329306238862
                                         uncertainty =       0.004357905969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329306238862
                                         uncertainty =       0.004357905969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405792348
  error estimate for blocks of size 2^( 2) =       0.000415620944
  error estimate for blocks of size 2^( 3) =       0.000424516842
  error estimate for blocks of size 2^( 4) =       0.000431093917
  error estimate for blocks of size 2^( 5) =       0.000434453454
  error estimate for blocks of size 2^( 6) =       0.000436177804
  error estimate for blocks of size 2^( 7) =       0.000438893474

      target function =                  N/A
              le_mean =     -17.214427102032
             les_mean =     296.665835146124
             stat err =       0.000435154662
             autocorr =       1.149951634446
              std dev =       0.573877042260
             le_variance =       0.329334859633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214427072064        initial
     3.7253e-01     3.7253e+00             3.7344e-04       -17.214427360910  <--
     1.4901e+00     1.4901e+01             9.3682e-05       -17.214427345406
     5.9605e+00     5.9605e+01             2.3836e-05       -17.214427102032

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 4.6209e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.936110e-01 1 1  ON 0
 uu_1                 2.871735e-02 1 1  ON 1
 uu_2                -6.894657e-02 1 1  ON 2
 uu_3                -1.264796e-01 1 1  ON 3
 uu_4                -1.624794e-01 1 1  ON 4
 uu_5                -1.739332e-01 1 1  ON 5
 uu_6                -1.580648e-01 1 1  ON 6
 uu_7                -1.116863e-01 1 1  ON 7
 uu_8                -3.691345e-02 1 1  ON 8
 uu_9                 2.148191e-01 1 1  ON 9
 ud_0                 3.498493e-01 1 1  ON 10
 ud_1                 9.072693e-02 1 1  ON 11
 ud_2                -1.755644e-02 1 1  ON 12
 ud_3                -7.674879e-02 1 1  ON 13
 ud_4                -1.257121e-01 1 1  ON 14
 ud_5                -1.622665e-01 1 1  ON 15
 ud_6                -1.728797e-01 1 1  ON 16
 ud_7                -1.449009e-01 1 1  ON 17
 ud_8                -9.336071e-02 1 1  ON 18
 ud_9                 4.317171e-02 1 1  ON 19
 eO_0                -8.934955e-01 1 1  ON 20
 eO_1                -5.712462e-01 1 1  ON 21
 eO_2                -1.595120e-01 1 1  ON 22
 eO_3                 1.055026e-01 1 1  ON 23
 eO_4                 2.228133e-01 1 1  ON 24
 eO_5                 2.974255e-01 1 1  ON 25
 eO_6                 3.087000e-01 1 1  ON 26
 eO_7                 4.648405e-01 1 1  ON 27
 eO_8                 1.264306e-01 1 1  ON 28
 eO_9                 5.418577e-02 1 1  ON 29
eH1_0                -2.137073e-01 1 1  ON 30
eH1_1                -1.350697e-01 1 1  ON 31
eH1_2                -9.273821e-02 1 1  ON 32
eH1_3                -5.498802e-02 1 1  ON 33
eH1_4                -8.643410e-03 1 1  ON 34
eH1_5                 3.582417e-03 1 1  ON 35
eH1_6                 5.126136e-02 1 1  ON 36
eH1_7                 5.231019e-02 1 1  ON 37
eH1_8                 2.210409e-01 1 1  ON 38
eH1_9                 1.117482e-01 1 1  ON 39
eH2_0                -2.077413e-01 1 1  ON 40
eH2_1                -1.291208e-01 1 1  ON 41
eH2_2                -8.708799e-02 1 1  ON 42
eH2_3                -4.962052e-02 1 1  ON 43
eH2_4                -3.289594e-03 1 1  ON 44
eH2_5                 7.777367e-03 1 1  ON 45
eH2_6                 4.741610e-02 1 1  ON 46
eH2_7                 7.906667e-03 1 1  ON 47
eH2_8                 2.466617e-01 1 1  ON 48
eH2_9                 1.126928e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.0441e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.3409
    reference variance = 0.675758
====================================================
  Execution time = 3.2990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3125e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331276500296
                                         uncertainty =       0.005249791271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331276500296
                                         uncertainty =       0.005249791271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406973179
  error estimate for blocks of size 2^( 2) =       0.000416520119
  error estimate for blocks of size 2^( 3) =       0.000425250762
  error estimate for blocks of size 2^( 4) =       0.000431960435
  error estimate for blocks of size 2^( 5) =       0.000437285597
  error estimate for blocks of size 2^( 6) =       0.000440145663
  error estimate for blocks of size 2^( 7) =       0.000439062498

      target function =                  N/A
              le_mean =     -17.214298304809
             les_mean =     296.663320298915
             stat err =       0.000437113548
             autocorr =       1.153604541325
              std dev =       0.575546989893
             le_variance =       0.331254337575


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721429830481e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214298304809       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214300464103       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214301668826       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214300772029       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214300736444       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214301068460       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214301306693       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214301843571       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214301230948       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214301584167       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-02 is 1.271868e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214298304809       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214299404425       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214300444646       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214300043127       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214299857537       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214299777863       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214299972585       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214300070072       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 3.275324e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214298304809       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214298675924       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214299188708       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214299079167       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214299013677       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214298911810       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214299001005       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 8.135556e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.340298 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2048e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.935352e-01 1 1  ON 0
 uu_1                 2.871789e-02 1 1  ON 1
 uu_2                -6.891036e-02 1 1  ON 2
 uu_3                -1.263266e-01 1 1  ON 3
 uu_4                -1.624609e-01 1 1  ON 4
 uu_5                -1.739038e-01 1 1  ON 5
 uu_6                -1.581450e-01 1 1  ON 6
 uu_7                -1.117118e-01 1 1  ON 7
 uu_8                -3.695076e-02 1 1  ON 8
 uu_9                 2.147209e-01 1 1  ON 9
 ud_0                 3.497709e-01 1 1  ON 10
 ud_1                 9.078978e-02 1 1  ON 11
 ud_2                -1.762879e-02 1 1  ON 12
 ud_3                -7.669618e-02 1 1  ON 13
 ud_4                -1.256682e-01 1 1  ON 14
 ud_5                -1.622576e-01 1 1  ON 15
 ud_6                -1.728631e-01 1 1  ON 16
 ud_7                -1.448908e-01 1 1  ON 17
 ud_8                -9.338610e-02 1 1  ON 18
 ud_9                 4.310557e-02 1 1  ON 19
 eO_0                -8.936258e-01 1 1  ON 20
 eO_1                -5.711144e-01 1 1  ON 21
 eO_2                -1.597292e-01 1 1  ON 22
 eO_3                 1.055020e-01 1 1  ON 23
 eO_4                 2.226766e-01 1 1  ON 24
 eO_5                 2.976562e-01 1 1  ON 25
 eO_6                 3.088288e-01 1 1  ON 26
 eO_7                 4.647804e-01 1 1  ON 27
 eO_8                 1.264647e-01 1 1  ON 28
 eO_9                 5.419704e-02 1 1  ON 29
eH1_0                -2.137480e-01 1 1  ON 30
eH1_1                -1.349580e-01 1 1  ON 31
eH1_2                -9.265492e-02 1 1  ON 32
eH1_3                -5.496035e-02 1 1  ON 33
eH1_4                -8.519481e-03 1 1  ON 34
eH1_5                 3.443961e-03 1 1  ON 35
eH1_6                 5.107959e-02 1 1  ON 36
eH1_7                 5.233662e-02 1 1  ON 37
eH1_8                 2.209940e-01 1 1  ON 38
eH1_9                 1.117633e-01 1 1  ON 39
eH2_0                -2.079673e-01 1 1  ON 40
eH2_1                -1.292785e-01 1 1  ON 41
eH2_2                -8.716162e-02 1 1  ON 42
eH2_3                -4.960650e-02 1 1  ON 43
eH2_4                -3.328081e-03 1 1  ON 44
eH2_5                 7.840498e-03 1 1  ON 45
eH2_6                 4.755143e-02 1 1  ON 46
eH2_7                 8.234200e-03 1 1  ON 47
eH2_8                 2.466203e-01 1 1  ON 48
eH2_9                 1.126836e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2569
    reference variance = 0.229751
====================================================
  Execution time = 3.2255e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2877e-01
  Total weights = 2.0000e+06
  Execution time = 2.8342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328766329615
                                         uncertainty =       0.003122372356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328766329615
                                         uncertainty =       0.003122372356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405504842
  error estimate for blocks of size 2^( 2) =       0.000415204340
  error estimate for blocks of size 2^( 3) =       0.000423652072
  error estimate for blocks of size 2^( 4) =       0.000429816113
  error estimate for blocks of size 2^( 5) =       0.000433611196
  error estimate for blocks of size 2^( 6) =       0.000436026750
  error estimate for blocks of size 2^( 7) =       0.000438148125

      target function =                  N/A
              le_mean =     -17.214194832928
             les_mean =     296.657371935966
             stat err =       0.000434400546
             autocorr =       1.147594967348
              std dev =       0.573470447706
             le_variance =       0.328868354393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328606898512
                                         uncertainty =       0.003121078915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328606898512
                                         uncertainty =       0.003121078915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405406506
  error estimate for blocks of size 2^( 2) =       0.000415107737
  error estimate for blocks of size 2^( 3) =       0.000423557328
  error estimate for blocks of size 2^( 4) =       0.000429724813
  error estimate for blocks of size 2^( 5) =       0.000433523695
  error estimate for blocks of size 2^( 6) =       0.000435939652
  error estimate for blocks of size 2^( 7) =       0.000438049421

      target function =                  N/A
              le_mean =     -17.214192565631
             les_mean =     296.657134393037
             stat err =       0.000434309395
             autocorr =       1.147669975457
              std dev =       0.573331379553
             le_variance =       0.328708870780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328580035507
                                         uncertainty =       0.003120591941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328580035507
                                         uncertainty =       0.003120591941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405389959
  error estimate for blocks of size 2^( 2) =       0.000415091451
  error estimate for blocks of size 2^( 3) =       0.000423539281
  error estimate for blocks of size 2^( 4) =       0.000429706152
  error estimate for blocks of size 2^( 5) =       0.000433506051
  error estimate for blocks of size 2^( 6) =       0.000435922385
  error estimate for blocks of size 2^( 7) =       0.000438027559

      target function =                  N/A
              le_mean =     -17.214191678221
             les_mean =     296.657077007986
             stat err =       0.000434290537
             autocorr =       1.147663996280
              std dev =       0.573307978143
             le_variance =       0.328682037803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328726083192
                                         uncertainty =       0.003121892791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328726083192
                                         uncertainty =       0.003121892791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405480026
  error estimate for blocks of size 2^( 2) =       0.000415179931
  error estimate for blocks of size 2^( 3) =       0.000423627462
  error estimate for blocks of size 2^( 4) =       0.000429791933
  error estimate for blocks of size 2^( 5) =       0.000433588092
  error estimate for blocks of size 2^( 6) =       0.000436003749
  error estimate for blocks of size 2^( 7) =       0.000438121489

      target function =                  N/A
              le_mean =     -17.214193996884
             les_mean =     296.657302901669
             stat err =       0.000434376316
             autocorr =       1.147607406382
              std dev =       0.573435352706
             le_variance =       0.328828103733


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214194832928        initial  <--
     9.3132e-02     9.3132e-01             1.2719e-03       -17.214192565631
     3.7253e-01     3.7253e+00             3.2753e-04       -17.214191678221
     1.4901e+00     1.4901e+01             8.1356e-05       -17.214193996884

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.5326
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.936110e-01 1 1  ON 0
 uu_1                 2.871735e-02 1 1  ON 1
 uu_2                -6.894657e-02 1 1  ON 2
 uu_3                -1.264796e-01 1 1  ON 3
 uu_4                -1.624794e-01 1 1  ON 4
 uu_5                -1.739332e-01 1 1  ON 5
 uu_6                -1.580648e-01 1 1  ON 6
 uu_7                -1.116863e-01 1 1  ON 7
 uu_8                -3.691345e-02 1 1  ON 8
 uu_9                 2.148191e-01 1 1  ON 9
 ud_0                 3.498493e-01 1 1  ON 10
 ud_1                 9.072693e-02 1 1  ON 11
 ud_2                -1.755644e-02 1 1  ON 12
 ud_3                -7.674879e-02 1 1  ON 13
 ud_4                -1.257121e-01 1 1  ON 14
 ud_5                -1.622665e-01 1 1  ON 15
 ud_6                -1.728797e-01 1 1  ON 16
 ud_7                -1.449009e-01 1 1  ON 17
 ud_8                -9.336071e-02 1 1  ON 18
 ud_9                 4.317171e-02 1 1  ON 19
 eO_0                -8.934955e-01 1 1  ON 20
 eO_1                -5.712462e-01 1 1  ON 21
 eO_2                -1.595120e-01 1 1  ON 22
 eO_3                 1.055026e-01 1 1  ON 23
 eO_4                 2.228133e-01 1 1  ON 24
 eO_5                 2.974255e-01 1 1  ON 25
 eO_6                 3.087000e-01 1 1  ON 26
 eO_7                 4.648405e-01 1 1  ON 27
 eO_8                 1.264306e-01 1 1  ON 28
 eO_9                 5.418577e-02 1 1  ON 29
eH1_0                -2.137073e-01 1 1  ON 30
eH1_1                -1.350697e-01 1 1  ON 31
eH1_2                -9.273821e-02 1 1  ON 32
eH1_3                -5.498802e-02 1 1  ON 33
eH1_4                -8.643410e-03 1 1  ON 34
eH1_5                 3.582417e-03 1 1  ON 35
eH1_6                 5.126136e-02 1 1  ON 36
eH1_7                 5.231019e-02 1 1  ON 37
eH1_8                 2.210409e-01 1 1  ON 38
eH1_9                 1.117482e-01 1 1  ON 39
eH2_0                -2.077413e-01 1 1  ON 40
eH2_1                -1.291208e-01 1 1  ON 41
eH2_2                -8.708799e-02 1 1  ON 42
eH2_3                -4.962052e-02 1 1  ON 43
eH2_4                -3.289594e-03 1 1  ON 44
eH2_5                 7.777367e-03 1 1  ON 45
eH2_6                 4.741610e-02 1 1  ON 46
eH2_7                 7.906667e-03 1 1  ON 47
eH2_8                 2.466617e-01 1 1  ON 48
eH2_9                 1.126928e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8586e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.6206
    reference variance = 30.6755
====================================================
  Execution time = 3.2684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2819e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326194490286
                                         uncertainty =       0.003487115802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326194490286
                                         uncertainty =       0.003487115802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405087850
  error estimate for blocks of size 2^( 2) =       0.000413816637
  error estimate for blocks of size 2^( 3) =       0.000423040002
  error estimate for blocks of size 2^( 4) =       0.000430076922
  error estimate for blocks of size 2^( 5) =       0.000434869330
  error estimate for blocks of size 2^( 6) =       0.000435926952
  error estimate for blocks of size 2^( 7) =       0.000437479499

      target function =                  N/A
              le_mean =     -17.214190467842
             les_mean =     296.656545632233
             stat err =       0.000434588176
             autocorr =       1.150952435381
              std dev =       0.572880732090
             le_variance =       0.328192333200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721419046784e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214190467842       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214190527707       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214189833020       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214189519045       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214189512142       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214189460634       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214189411692       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 1.269695e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214190467842       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214190484702       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214190255074       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214190150328       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214190142899       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214190123671       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214190108742       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 3.299527e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214190467842       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214190472195       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214190409830       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214190381280       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214190375981       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214190370012       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214190368925       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 8.577311e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342586 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1804e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.935947e-01 1 1  ON 0
 uu_1                 2.874293e-02 1 1  ON 1
 uu_2                -6.896905e-02 1 1  ON 2
 uu_3                -1.264696e-01 1 1  ON 3
 uu_4                -1.624994e-01 1 1  ON 4
 uu_5                -1.739326e-01 1 1  ON 5
 uu_6                -1.580745e-01 1 1  ON 6
 uu_7                -1.116683e-01 1 1  ON 7
 uu_8                -3.690411e-02 1 1  ON 8
 uu_9                 2.148156e-01 1 1  ON 9
 ud_0                 3.498577e-01 1 1  ON 10
 ud_1                 9.074771e-02 1 1  ON 11
 ud_2                -1.755897e-02 1 1  ON 12
 ud_3                -7.675801e-02 1 1  ON 13
 ud_4                -1.257044e-01 1 1  ON 14
 ud_5                -1.622937e-01 1 1  ON 15
 ud_6                -1.728853e-01 1 1  ON 16
 ud_7                -1.448968e-01 1 1  ON 17
 ud_8                -9.335799e-02 1 1  ON 18
 ud_9                 4.316706e-02 1 1  ON 19
 eO_0                -8.935283e-01 1 1  ON 20
 eO_1                -5.712452e-01 1 1  ON 21
 eO_2                -1.595060e-01 1 1  ON 22
 eO_3                 1.055159e-01 1 1  ON 23
 eO_4                 2.227976e-01 1 1  ON 24
 eO_5                 2.974314e-01 1 1  ON 25
 eO_6                 3.087212e-01 1 1  ON 26
 eO_7                 4.648355e-01 1 1  ON 27
 eO_8                 1.264352e-01 1 1  ON 28
 eO_9                 5.418738e-02 1 1  ON 29
eH1_0                -2.136848e-01 1 1  ON 30
eH1_1                -1.350562e-01 1 1  ON 31
eH1_2                -9.275068e-02 1 1  ON 32
eH1_3                -5.499558e-02 1 1  ON 33
eH1_4                -8.636703e-03 1 1  ON 34
eH1_5                 3.583773e-03 1 1  ON 35
eH1_6                 5.122837e-02 1 1  ON 36
eH1_7                 5.231556e-02 1 1  ON 37
eH1_8                 2.210412e-01 1 1  ON 38
eH1_9                 1.117501e-01 1 1  ON 39
eH2_0                -2.077464e-01 1 1  ON 40
eH2_1                -1.291340e-01 1 1  ON 41
eH2_2                -8.710922e-02 1 1  ON 42
eH2_3                -4.963546e-02 1 1  ON 43
eH2_4                -3.278431e-03 1 1  ON 44
eH2_5                 7.777781e-03 1 1  ON 45
eH2_6                 4.743189e-02 1 1  ON 46
eH2_7                 7.937178e-03 1 1  ON 47
eH2_8                 2.466567e-01 1 1  ON 48
eH2_9                 1.126935e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2064
    reference variance = 0.270021
====================================================
  Execution time = 3.2311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2289e-01
  Total weights = 2.0000e+06
  Execution time = 2.8262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322946544559
                                         uncertainty =       0.003087252383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322946544559
                                         uncertainty =       0.003087252383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401788514
  error estimate for blocks of size 2^( 2) =       0.000411984007
  error estimate for blocks of size 2^( 3) =       0.000420631563
  error estimate for blocks of size 2^( 4) =       0.000427564781
  error estimate for blocks of size 2^( 5) =       0.000431520472
  error estimate for blocks of size 2^( 6) =       0.000432731083
  error estimate for blocks of size 2^( 7) =       0.000434663879

      target function =                  N/A
              le_mean =     -17.214609812174
             les_mean =     296.665658844418
             stat err =       0.000431620054
             autocorr =       1.154006337386
              std dev =       0.568214766127
             le_variance =       0.322868020445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323013752827
                                         uncertainty =       0.003088097703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323013752827
                                         uncertainty =       0.003088097703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401830316
  error estimate for blocks of size 2^( 2) =       0.000412023964
  error estimate for blocks of size 2^( 3) =       0.000420668582
  error estimate for blocks of size 2^( 4) =       0.000427599661
  error estimate for blocks of size 2^( 5) =       0.000431552908
  error estimate for blocks of size 2^( 6) =       0.000432765041
  error estimate for blocks of size 2^( 7) =       0.000434695877

      target function =                  N/A
              le_mean =     -17.214608840717
             les_mean =     296.665692583436
             stat err =       0.000431653372
             autocorr =       1.153944382483
              std dev =       0.568273882924
             le_variance =       0.322935206013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322981790801
                                         uncertainty =       0.003087713394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322981790801
                                         uncertainty =       0.003087713394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401810435
  error estimate for blocks of size 2^( 2) =       0.000412004962
  error estimate for blocks of size 2^( 3) =       0.000420650883
  error estimate for blocks of size 2^( 4) =       0.000427582978
  error estimate for blocks of size 2^( 5) =       0.000431537280
  error estimate for blocks of size 2^( 6) =       0.000432749340
  error estimate for blocks of size 2^( 7) =       0.000434680734

      target function =                  N/A
              le_mean =     -17.214609219632
             les_mean =     296.665673674515
             stat err =       0.000431637583
             autocorr =       1.153974153188
              std dev =       0.568245766672
             le_variance =       0.322903251341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322950963224
                                         uncertainty =       0.003087311229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322950963224
                                         uncertainty =       0.003087311229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401791262
  error estimate for blocks of size 2^( 2) =       0.000411986633
  error estimate for blocks of size 2^( 3) =       0.000420633978
  error estimate for blocks of size 2^( 4) =       0.000427567055
  error estimate for blocks of size 2^( 5) =       0.000431522566
  error estimate for blocks of size 2^( 6) =       0.000432733393
  error estimate for blocks of size 2^( 7) =       0.000434665993

      target function =                  N/A
              le_mean =     -17.214609730919
             les_mean =     296.665660463405
             stat err =       0.000431622252
             autocorr =       1.154002304329
              std dev =       0.568218652447
             le_variance =       0.322872436988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214609812174        initial  <--
     9.3132e-01     9.3132e+00             1.2697e-04       -17.214608840717
     3.7253e+00     3.7253e+01             3.2995e-05       -17.214609219632
     1.4901e+01     1.4901e+02             8.5773e-06       -17.214609730919

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.5523
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.936110e-01 1 1  ON 0
 uu_1                 2.871735e-02 1 1  ON 1
 uu_2                -6.894657e-02 1 1  ON 2
 uu_3                -1.264796e-01 1 1  ON 3
 uu_4                -1.624794e-01 1 1  ON 4
 uu_5                -1.739332e-01 1 1  ON 5
 uu_6                -1.580648e-01 1 1  ON 6
 uu_7                -1.116863e-01 1 1  ON 7
 uu_8                -3.691345e-02 1 1  ON 8
 uu_9                 2.148191e-01 1 1  ON 9
 ud_0                 3.498493e-01 1 1  ON 10
 ud_1                 9.072693e-02 1 1  ON 11
 ud_2                -1.755644e-02 1 1  ON 12
 ud_3                -7.674879e-02 1 1  ON 13
 ud_4                -1.257121e-01 1 1  ON 14
 ud_5                -1.622665e-01 1 1  ON 15
 ud_6                -1.728797e-01 1 1  ON 16
 ud_7                -1.449009e-01 1 1  ON 17
 ud_8                -9.336071e-02 1 1  ON 18
 ud_9                 4.317171e-02 1 1  ON 19
 eO_0                -8.934955e-01 1 1  ON 20
 eO_1                -5.712462e-01 1 1  ON 21
 eO_2                -1.595120e-01 1 1  ON 22
 eO_3                 1.055026e-01 1 1  ON 23
 eO_4                 2.228133e-01 1 1  ON 24
 eO_5                 2.974255e-01 1 1  ON 25
 eO_6                 3.087000e-01 1 1  ON 26
 eO_7                 4.648405e-01 1 1  ON 27
 eO_8                 1.264306e-01 1 1  ON 28
 eO_9                 5.418577e-02 1 1  ON 29
eH1_0                -2.137073e-01 1 1  ON 30
eH1_1                -1.350697e-01 1 1  ON 31
eH1_2                -9.273821e-02 1 1  ON 32
eH1_3                -5.498802e-02 1 1  ON 33
eH1_4                -8.643410e-03 1 1  ON 34
eH1_5                 3.582417e-03 1 1  ON 35
eH1_6                 5.126136e-02 1 1  ON 36
eH1_7                 5.231019e-02 1 1  ON 37
eH1_8                 2.210409e-01 1 1  ON 38
eH1_9                 1.117482e-01 1 1  ON 39
eH2_0                -2.077413e-01 1 1  ON 40
eH2_1                -1.291208e-01 1 1  ON 41
eH2_2                -8.708799e-02 1 1  ON 42
eH2_3                -4.962052e-02 1 1  ON 43
eH2_4                -3.289594e-03 1 1  ON 44
eH2_5                 7.777367e-03 1 1  ON 45
eH2_6                 4.741610e-02 1 1  ON 46
eH2_7                 7.906667e-03 1 1  ON 47
eH2_8                 2.466617e-01 1 1  ON 48
eH2_9                 1.126928e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8362e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2317
    reference variance = 0.284731
====================================================
  Execution time = 3.2733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3226e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330814272785
                                         uncertainty =       0.003913504016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330814272785
                                         uncertainty =       0.003913504016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407590749
  error estimate for blocks of size 2^( 2) =       0.000417763162
  error estimate for blocks of size 2^( 3) =       0.000426557272
  error estimate for blocks of size 2^( 4) =       0.000432915049
  error estimate for blocks of size 2^( 5) =       0.000437425597
  error estimate for blocks of size 2^( 6) =       0.000439094343
  error estimate for blocks of size 2^( 7) =       0.000439591346

      target function =                  N/A
              le_mean =     -17.214410854706
             les_mean =     296.668201345243
             stat err =       0.000437256584
             autocorr =       1.150864196161
              std dev =       0.576420364626
             le_variance =       0.332260436755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721441085471e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214410854706       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214410857420       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214410918873       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214410966415       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214410938182       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214410946993       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214410939750       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.954026e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214410854706       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214410855399       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214410871045       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214410883266       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214410876256       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214410878511       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214410876830       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 4.978657e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214410854706       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214410854880       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214410858810       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214410861887       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214410860138       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214410860705       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214410860293       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.250673e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.344828 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1885e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.936153e-01 1 1  ON 0
 uu_1                 2.871555e-02 1 1  ON 1
 uu_2                -6.894876e-02 1 1  ON 2
 uu_3                -1.264805e-01 1 1  ON 3
 uu_4                -1.624785e-01 1 1  ON 4
 uu_5                -1.739350e-01 1 1  ON 5
 uu_6                -1.580668e-01 1 1  ON 6
 uu_7                -1.116841e-01 1 1  ON 7
 uu_8                -3.691234e-02 1 1  ON 8
 uu_9                 2.148186e-01 1 1  ON 9
 ud_0                 3.498512e-01 1 1  ON 10
 ud_1                 9.072788e-02 1 1  ON 11
 ud_2                -1.755677e-02 1 1  ON 12
 ud_3                -7.674985e-02 1 1  ON 13
 ud_4                -1.257123e-01 1 1  ON 14
 ud_5                -1.622671e-01 1 1  ON 15
 ud_6                -1.728804e-01 1 1  ON 16
 ud_7                -1.449007e-01 1 1  ON 17
 ud_8                -9.336053e-02 1 1  ON 18
 ud_9                 4.317106e-02 1 1  ON 19
 eO_0                -8.934960e-01 1 1  ON 20
 eO_1                -5.712473e-01 1 1  ON 21
 eO_2                -1.595109e-01 1 1  ON 22
 eO_3                 1.055020e-01 1 1  ON 23
 eO_4                 2.228106e-01 1 1  ON 24
 eO_5                 2.974273e-01 1 1  ON 25
 eO_6                 3.087020e-01 1 1  ON 26
 eO_7                 4.648403e-01 1 1  ON 27
 eO_8                 1.264309e-01 1 1  ON 28
 eO_9                 5.418587e-02 1 1  ON 29
eH1_0                -2.137102e-01 1 1  ON 30
eH1_1                -1.350689e-01 1 1  ON 31
eH1_2                -9.273692e-02 1 1  ON 32
eH1_3                -5.498753e-02 1 1  ON 33
eH1_4                -8.641667e-03 1 1  ON 34
eH1_5                 3.582551e-03 1 1  ON 35
eH1_6                 5.125898e-02 1 1  ON 36
eH1_7                 5.231110e-02 1 1  ON 37
eH1_8                 2.210407e-01 1 1  ON 38
eH1_9                 1.117483e-01 1 1  ON 39
eH2_0                -2.077418e-01 1 1  ON 40
eH2_1                -1.291258e-01 1 1  ON 41
eH2_2                -8.708601e-02 1 1  ON 42
eH2_3                -4.961970e-02 1 1  ON 43
eH2_4                -3.289462e-03 1 1  ON 44
eH2_5                 7.775531e-03 1 1  ON 45
eH2_6                 4.741671e-02 1 1  ON 46
eH2_7                 7.910821e-03 1 1  ON 47
eH2_8                 2.466614e-01 1 1  ON 48
eH2_9                 1.126927e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.242
    reference variance = 0.243229
====================================================
  Execution time = 3.4751e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2685e-01
  Total weights = 2.0000e+06
  Execution time = 2.8401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326811098806
                                         uncertainty =       0.003347588227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326811098806
                                         uncertainty =       0.003347588227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404258053
  error estimate for blocks of size 2^( 2) =       0.000414375274
  error estimate for blocks of size 2^( 3) =       0.000423362610
  error estimate for blocks of size 2^( 4) =       0.000429779313
  error estimate for blocks of size 2^( 5) =       0.000433894003
  error estimate for blocks of size 2^( 6) =       0.000435032000
  error estimate for blocks of size 2^( 7) =       0.000437821447

      target function =                  N/A
              le_mean =     -17.213643801233
             les_mean =     296.636381899818
             stat err =       0.000434131691
             autocorr =       1.153255723850
              std dev =       0.571707221864
             le_variance =       0.326849147532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326819369922
                                         uncertainty =       0.003347648483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326819369922
                                         uncertainty =       0.003347648483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404263168
  error estimate for blocks of size 2^( 2) =       0.000414380145
  error estimate for blocks of size 2^( 3) =       0.000423367259
  error estimate for blocks of size 2^( 4) =       0.000429783859
  error estimate for blocks of size 2^( 5) =       0.000433898477
  error estimate for blocks of size 2^( 6) =       0.000435036147
  error estimate for blocks of size 2^( 7) =       0.000437826120

      target function =                  N/A
              le_mean =     -17.213643823855
             les_mean =     296.636390948585
             stat err =       0.000434136151
             autocorr =       1.153250239629
              std dev =       0.571714454481
             le_variance =       0.326857417463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326815306427
                                         uncertainty =       0.003347618808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326815306427
                                         uncertainty =       0.003347618808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404260655
  error estimate for blocks of size 2^( 2) =       0.000414377752
  error estimate for blocks of size 2^( 3) =       0.000423364976
  error estimate for blocks of size 2^( 4) =       0.000429781624
  error estimate for blocks of size 2^( 5) =       0.000433896279
  error estimate for blocks of size 2^( 6) =       0.000435034106
  error estimate for blocks of size 2^( 7) =       0.000437823823

      target function =                  N/A
              le_mean =     -17.213643812566
             les_mean =     296.636386496944
             stat err =       0.000434133958
             autocorr =       1.153252925375
              std dev =       0.571710901134
             le_variance =       0.326853354476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326811626889
                                         uncertainty =       0.003347592065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326811626889
                                         uncertainty =       0.003347592065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404258380
  error estimate for blocks of size 2^( 2) =       0.000414375585
  error estimate for blocks of size 2^( 3) =       0.000423362907
  error estimate for blocks of size 2^( 4) =       0.000429779603
  error estimate for blocks of size 2^( 5) =       0.000433894289
  error estimate for blocks of size 2^( 6) =       0.000435032265
  error estimate for blocks of size 2^( 7) =       0.000437821745

      target function =                  N/A
              le_mean =     -17.213643802626
             les_mean =     296.636382475802
             stat err =       0.000434131975
             autocorr =       1.153255372106
              std dev =       0.571707683635
             le_variance =       0.326849675527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213643801233        initial
     9.3132e+00     9.3132e+01             1.9540e-05       -17.213643823855  <--
     3.7253e+01     3.7253e+02             4.9787e-06       -17.213643812566
     1.4901e+02     1.4901e+03             1.2507e-06       -17.213643802626

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 4.9050e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.936278e-01 1 1  ON 0
 uu_1                 2.871020e-02 1 1  ON 1
 uu_2                -6.895502e-02 1 1  ON 2
 uu_3                -1.264834e-01 1 1  ON 3
 uu_4                -1.624759e-01 1 1  ON 4
 uu_5                -1.739403e-01 1 1  ON 5
 uu_6                -1.580727e-01 1 1  ON 6
 uu_7                -1.116774e-01 1 1  ON 7
 uu_8                -3.690900e-02 1 1  ON 8
 uu_9                 2.148172e-01 1 1  ON 9
 ud_0                 3.498567e-01 1 1  ON 10
 ud_1                 9.073060e-02 1 1  ON 11
 ud_2                -1.755775e-02 1 1  ON 12
 ud_3                -7.675292e-02 1 1  ON 13
 ud_4                -1.257128e-01 1 1  ON 14
 ud_5                -1.622689e-01 1 1  ON 15
 ud_6                -1.728824e-01 1 1  ON 16
 ud_7                -1.449003e-01 1 1  ON 17
 ud_8                -9.336001e-02 1 1  ON 18
 ud_9                 4.316912e-02 1 1  ON 19
 eO_0                -8.934976e-01 1 1  ON 20
 eO_1                -5.712506e-01 1 1  ON 21
 eO_2                -1.595080e-01 1 1  ON 22
 eO_3                 1.055002e-01 1 1  ON 23
 eO_4                 2.228026e-01 1 1  ON 24
 eO_5                 2.974327e-01 1 1  ON 25
 eO_6                 3.087078e-01 1 1  ON 26
 eO_7                 4.648396e-01 1 1  ON 27
 eO_8                 1.264317e-01 1 1  ON 28
 eO_9                 5.418616e-02 1 1  ON 29
eH1_0                -2.137189e-01 1 1  ON 30
eH1_1                -1.350666e-01 1 1  ON 31
eH1_2                -9.273313e-02 1 1  ON 32
eH1_3                -5.498607e-02 1 1  ON 33
eH1_4                -8.636502e-03 1 1  ON 34
eH1_5                 3.582996e-03 1 1  ON 35
eH1_6                 5.125187e-02 1 1  ON 36
eH1_7                 5.231383e-02 1 1  ON 37
eH1_8                 2.210399e-01 1 1  ON 38
eH1_9                 1.117485e-01 1 1  ON 39
eH2_0                -2.077434e-01 1 1  ON 40
eH2_1                -1.291403e-01 1 1  ON 41
eH2_2                -8.708033e-02 1 1  ON 42
eH2_3                -4.961731e-02 1 1  ON 43
eH2_4                -3.289028e-03 1 1  ON 44
eH2_5                 7.770048e-03 1 1  ON 45
eH2_6                 4.741852e-02 1 1  ON 46
eH2_7                 7.923218e-03 1 1  ON 47
eH2_8                 2.466603e-01 1 1  ON 48
eH2_9                 1.126924e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.0940e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1931
    reference variance = 0.21467
====================================================
  Execution time = 3.2583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.3548e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335589077707
                                         uncertainty =       0.008623408400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335589077707
                                         uncertainty =       0.008623408400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409560126
  error estimate for blocks of size 2^( 2) =       0.000419758172
  error estimate for blocks of size 2^( 3) =       0.000428582320
  error estimate for blocks of size 2^( 4) =       0.000434636109
  error estimate for blocks of size 2^( 5) =       0.000438795073
  error estimate for blocks of size 2^( 6) =       0.000441046625
  error estimate for blocks of size 2^( 7) =       0.000441826506

      target function =                  N/A
              le_mean =     -17.213452532692
             les_mean =     296.638426921065
             stat err =       0.000439076078
             autocorr =       1.149328608161
              std dev =       0.579205484749
             le_variance =       0.335478993564


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721345253269e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213452532692       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213452625880       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213452620574       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213452358856       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213452519912       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213452506073       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213452502049       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 6.115290e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213452532692       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213452557064       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213452554448       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213452483186       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213452519204       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213452516166       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213452515911       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.558454e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213452532692       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213452538856       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213452538108       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213452519890       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213452528519       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213452527787       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213452527768       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 3.917751e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1511e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.936219e-01 1 1  ON 0
 uu_1                 2.870896e-02 1 1  ON 1
 uu_2                -6.896329e-02 1 1  ON 2
 uu_3                -1.264825e-01 1 1  ON 3
 uu_4                -1.624743e-01 1 1  ON 4
 uu_5                -1.739384e-01 1 1  ON 5
 uu_6                -1.580699e-01 1 1  ON 6
 uu_7                -1.116683e-01 1 1  ON 7
 uu_8                -3.690853e-02 1 1  ON 8
 uu_9                 2.148129e-01 1 1  ON 9
 ud_0                 3.498607e-01 1 1  ON 10
 ud_1                 9.073848e-02 1 1  ON 11
 ud_2                -1.755742e-02 1 1  ON 12
 ud_3                -7.675449e-02 1 1  ON 13
 ud_4                -1.257169e-01 1 1  ON 14
 ud_5                -1.622652e-01 1 1  ON 15
 ud_6                -1.728904e-01 1 1  ON 16
 ud_7                -1.449034e-01 1 1  ON 17
 ud_8                -9.336001e-02 1 1  ON 18
 ud_9                 4.316767e-02 1 1  ON 19
 eO_0                -8.935067e-01 1 1  ON 20
 eO_1                -5.712528e-01 1 1  ON 21
 eO_2                -1.594955e-01 1 1  ON 22
 eO_3                 1.054969e-01 1 1  ON 23
 eO_4                 2.227917e-01 1 1  ON 24
 eO_5                 2.974371e-01 1 1  ON 25
 eO_6                 3.087153e-01 1 1  ON 26
 eO_7                 4.648383e-01 1 1  ON 27
 eO_8                 1.264335e-01 1 1  ON 28
 eO_9                 5.418670e-02 1 1  ON 29
eH1_0                -2.137314e-01 1 1  ON 30
eH1_1                -1.350563e-01 1 1  ON 31
eH1_2                -9.272344e-02 1 1  ON 32
eH1_3                -5.498929e-02 1 1  ON 33
eH1_4                -8.627278e-03 1 1  ON 34
eH1_5                 3.575129e-03 1 1  ON 35
eH1_6                 5.124499e-02 1 1  ON 36
eH1_7                 5.231662e-02 1 1  ON 37
eH1_8                 2.210381e-01 1 1  ON 38
eH1_9                 1.117484e-01 1 1  ON 39
eH2_0                -2.077480e-01 1 1  ON 40
eH2_1                -1.291452e-01 1 1  ON 41
eH2_2                -8.707881e-02 1 1  ON 42
eH2_3                -4.961223e-02 1 1  ON 43
eH2_4                -3.295170e-03 1 1  ON 44
eH2_5                 7.759201e-03 1 1  ON 45
eH2_6                 4.742328e-02 1 1  ON 46
eH2_7                 7.938803e-03 1 1  ON 47
eH2_8                 2.466594e-01 1 1  ON 48
eH2_9                 1.126925e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1992
    reference variance = 0.224951
====================================================
  Execution time = 3.2112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2663e-01
  Total weights = 2.0000e+06
  Execution time = 2.8344e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326706633534
                                         uncertainty =       0.002925519884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326706633534
                                         uncertainty =       0.002925519884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404121412
  error estimate for blocks of size 2^( 2) =       0.000414247682
  error estimate for blocks of size 2^( 3) =       0.000423089668
  error estimate for blocks of size 2^( 4) =       0.000428845511
  error estimate for blocks of size 2^( 5) =       0.000433392190
  error estimate for blocks of size 2^( 6) =       0.000434311715
  error estimate for blocks of size 2^( 7) =       0.000433020708

      target function =                  N/A
              le_mean =     -17.213899944553
             les_mean =     296.644979368775
             stat err =       0.000432392531
             autocorr =       1.144807969753
              std dev =       0.571513981448
             le_variance =       0.326628230991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326707764440
                                         uncertainty =       0.002925457770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326707764440
                                         uncertainty =       0.002925457770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404122114
  error estimate for blocks of size 2^( 2) =       0.000414248334
  error estimate for blocks of size 2^( 3) =       0.000423090417
  error estimate for blocks of size 2^( 4) =       0.000428846691
  error estimate for blocks of size 2^( 5) =       0.000433392875
  error estimate for blocks of size 2^( 6) =       0.000434311546
  error estimate for blocks of size 2^( 7) =       0.000433021043

      target function =                  N/A
              le_mean =     -17.213899966065
             les_mean =     296.644981244190
             stat err =       0.000432393039
             autocorr =       1.144806679933
              std dev =       0.571514974261
             le_variance =       0.326629365805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326706451555
                                         uncertainty =       0.002925471240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326706451555
                                         uncertainty =       0.002925471240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404121301
  error estimate for blocks of size 2^( 2) =       0.000414247565
  error estimate for blocks of size 2^( 3) =       0.000423089607
  error estimate for blocks of size 2^( 4) =       0.000428845692
  error estimate for blocks of size 2^( 5) =       0.000433392088
  error estimate for blocks of size 2^( 6) =       0.000434311152
  error estimate for blocks of size 2^( 7) =       0.000433020391

      target function =                  N/A
              le_mean =     -17.213899954115
             les_mean =     296.644979518391
             stat err =       0.000432392331
             autocorr =       1.144807538213
              std dev =       0.571513824353
             le_variance =       0.326628051427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326706583998
                                         uncertainty =       0.002925513171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326706583998
                                         uncertainty =       0.002925513171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404121381
  error estimate for blocks of size 2^( 2) =       0.000414247651
  error estimate for blocks of size 2^( 3) =       0.000423089644
  error estimate for blocks of size 2^( 4) =       0.000428845519
  error estimate for blocks of size 2^( 5) =       0.000433392161
  error estimate for blocks of size 2^( 6) =       0.000434311627
  error estimate for blocks of size 2^( 7) =       0.000433020650

      target function =                  N/A
              le_mean =     -17.213899945463
             les_mean =     296.644979350880
             stat err =       0.000432392489
             autocorr =       1.144807919531
              std dev =       0.571513938390
             le_variance =       0.326628181774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213899944553        initial
     2.3283e+00     2.3283e+01             6.1153e-05       -17.213899966065  <--
     9.3132e+00     9.3132e+01             1.5585e-05       -17.213899954115
     3.7253e+01     3.7253e+02             3.9178e-06       -17.213899945463

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 4.6420e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.936053e-01 1 1  ON 0
 uu_1                 2.870464e-02 1 1  ON 1
 uu_2                -6.898547e-02 1 1  ON 2
 uu_3                -1.264816e-01 1 1  ON 3
 uu_4                -1.624696e-01 1 1  ON 4
 uu_5                -1.739331e-01 1 1  ON 5
 uu_6                -1.580621e-01 1 1  ON 6
 uu_7                -1.116418e-01 1 1  ON 7
 uu_8                -3.690716e-02 1 1  ON 8
 uu_9                 2.148004e-01 1 1  ON 9
 ud_0                 3.498742e-01 1 1  ON 10
 ud_1                 9.075888e-02 1 1  ON 11
 ud_2                -1.755556e-02 1 1  ON 12
 ud_3                -7.675883e-02 1 1  ON 13
 ud_4                -1.257281e-01 1 1  ON 14
 ud_5                -1.622557e-01 1 1  ON 15
 ud_6                -1.729140e-01 1 1  ON 16
 ud_7                -1.449124e-01 1 1  ON 17
 ud_8                -9.336001e-02 1 1  ON 18
 ud_9                 4.316342e-02 1 1  ON 19
 eO_0                -8.935322e-01 1 1  ON 20
 eO_1                -5.712588e-01 1 1  ON 21
 eO_2                -1.594615e-01 1 1  ON 22
 eO_3                 1.054883e-01 1 1  ON 23
 eO_4                 2.227595e-01 1 1  ON 24
 eO_5                 2.974498e-01 1 1  ON 25
 eO_6                 3.087373e-01 1 1  ON 26
 eO_7                 4.648344e-01 1 1  ON 27
 eO_8                 1.264389e-01 1 1  ON 28
 eO_9                 5.418829e-02 1 1  ON 29
eH1_0                -2.137669e-01 1 1  ON 30
eH1_1                -1.350276e-01 1 1  ON 31
eH1_2                -9.269564e-02 1 1  ON 32
eH1_3                -5.499689e-02 1 1  ON 33
eH1_4                -8.601524e-03 1 1  ON 34
eH1_5                 3.552555e-03 1 1  ON 35
eH1_6                 5.122477e-02 1 1  ON 36
eH1_7                 5.232478e-02 1 1  ON 37
eH1_8                 2.210328e-01 1 1  ON 38
eH1_9                 1.117479e-01 1 1  ON 39
eH2_0                -2.077617e-01 1 1  ON 40
eH2_1                -1.291582e-01 1 1  ON 41
eH2_2                -8.707405e-02 1 1  ON 42
eH2_3                -4.959864e-02 1 1  ON 43
eH2_4                -3.312446e-03 1 1  ON 44
eH2_5                 7.727118e-03 1 1  ON 45
eH2_6                 4.743696e-02 1 1  ON 46
eH2_7                 7.984371e-03 1 1  ON 47
eH2_8                 2.466566e-01 1 1  ON 48
eH2_9                 1.126928e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2276
    reference variance = 0.241369
====================================================
  Execution time = 3.2412e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3409e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334067927595
                                         uncertainty =       0.006020830576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334067927595
                                         uncertainty =       0.006020830576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408712786
  error estimate for blocks of size 2^( 2) =       0.000418326424
  error estimate for blocks of size 2^( 3) =       0.000427362530
  error estimate for blocks of size 2^( 4) =       0.000433611904
  error estimate for blocks of size 2^( 5) =       0.000437732377
  error estimate for blocks of size 2^( 6) =       0.000439232974
  error estimate for blocks of size 2^( 7) =       0.000440353791

      target function =                  N/A
              le_mean =     -17.213641273340
             les_mean =     296.643538002696
             stat err =       0.000437732762
             autocorr =       1.147048170448
              std dev =       0.578007164750
             le_variance =       0.334092282502


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721364127334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213641273340       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213641216901       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213641341626       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213642039262       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213642323440       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213642580256       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213642464928       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 2.712605e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213641273340       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213641256325       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213641292231       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213641492506       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213641630138       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213641745413       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213641729437       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 8.177961e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213641273340       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213641268856       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213641278149       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213641329837       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213641370529       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213641405794       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213641404779       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.170006e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.349331 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1294e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.935236e-01 1 1  ON 0
 uu_1                 2.871040e-02 1 1  ON 1
 uu_2                -6.898617e-02 1 1  ON 2
 uu_3                -1.264645e-01 1 1  ON 3
 uu_4                -1.624646e-01 1 1  ON 4
 uu_5                -1.738876e-01 1 1  ON 5
 uu_6                -1.580560e-01 1 1  ON 6
 uu_7                -1.116322e-01 1 1  ON 7
 uu_8                -3.690871e-02 1 1  ON 8
 uu_9                 2.147848e-01 1 1  ON 9
 ud_0                 3.498121e-01 1 1  ON 10
 ud_1                 9.081987e-02 1 1  ON 11
 ud_2                -1.754182e-02 1 1  ON 12
 ud_3                -7.676366e-02 1 1  ON 13
 ud_4                -1.257404e-01 1 1  ON 14
 ud_5                -1.622410e-01 1 1  ON 15
 ud_6                -1.729023e-01 1 1  ON 16
 ud_7                -1.449175e-01 1 1  ON 17
 ud_8                -9.337278e-02 1 1  ON 18
 ud_9                 4.315300e-02 1 1  ON 19
 eO_0                -8.935628e-01 1 1  ON 20
 eO_1                -5.712995e-01 1 1  ON 21
 eO_2                -1.594540e-01 1 1  ON 22
 eO_3                 1.055182e-01 1 1  ON 23
 eO_4                 2.227283e-01 1 1  ON 24
 eO_5                 2.974882e-01 1 1  ON 25
 eO_6                 3.087589e-01 1 1  ON 26
 eO_7                 4.648288e-01 1 1  ON 27
 eO_8                 1.264472e-01 1 1  ON 28
 eO_9                 5.419014e-02 1 1  ON 29
eH1_0                -2.137670e-01 1 1  ON 30
eH1_1                -1.350319e-01 1 1  ON 31
eH1_2                -9.266732e-02 1 1  ON 32
eH1_3                -5.497425e-02 1 1  ON 33
eH1_4                -8.609908e-03 1 1  ON 34
eH1_5                 3.516280e-03 1 1  ON 35
eH1_6                 5.120404e-02 1 1  ON 36
eH1_7                 5.234442e-02 1 1  ON 37
eH1_8                 2.210270e-01 1 1  ON 38
eH1_9                 1.117498e-01 1 1  ON 39
eH2_0                -2.077655e-01 1 1  ON 40
eH2_1                -1.292050e-01 1 1  ON 41
eH2_2                -8.704677e-02 1 1  ON 42
eH2_3                -4.960059e-02 1 1  ON 43
eH2_4                -3.344494e-03 1 1  ON 44
eH2_5                 7.730641e-03 1 1  ON 45
eH2_6                 4.745403e-02 1 1  ON 46
eH2_7                 8.026381e-03 1 1  ON 47
eH2_8                 2.466464e-01 1 1  ON 48
eH2_9                 1.126956e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1918
    reference variance = 0.204602
====================================================
  Execution time = 3.1865e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2766e-01
  Total weights = 2.0000e+06
  Execution time = 2.8261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327690158424
                                         uncertainty =       0.004305916064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327690158424
                                         uncertainty =       0.004305916064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404820337
  error estimate for blocks of size 2^( 2) =       0.000414718163
  error estimate for blocks of size 2^( 3) =       0.000423423272
  error estimate for blocks of size 2^( 4) =       0.000429886823
  error estimate for blocks of size 2^( 5) =       0.000433857048
  error estimate for blocks of size 2^( 6) =       0.000436939572
  error estimate for blocks of size 2^( 7) =       0.000439595742

      target function =                  N/A
              le_mean =     -17.213752116463
             les_mean =     296.641020773460
             stat err =       0.000435069796
             autocorr =       1.155029894751
              std dev =       0.572502410754
             le_variance =       0.327759010319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327424442231
                                         uncertainty =       0.004304237911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327424442231
                                         uncertainty =       0.004304237911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404656198
  error estimate for blocks of size 2^( 2) =       0.000414559430
  error estimate for blocks of size 2^( 3) =       0.000423270581
  error estimate for blocks of size 2^( 4) =       0.000429735479
  error estimate for blocks of size 2^( 5) =       0.000433709006
  error estimate for blocks of size 2^( 6) =       0.000436790729
  error estimate for blocks of size 2^( 7) =       0.000439447648

      target function =                  N/A
              le_mean =     -17.213752649826
             les_mean =     296.640773402782
             stat err =       0.000434920715
             autocorr =       1.155175032867
              std dev =       0.572270283304
             le_variance =       0.327493277153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327486920413
                                         uncertainty =       0.004304552077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327486920413
                                         uncertainty =       0.004304552077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404694800
  error estimate for blocks of size 2^( 2) =       0.000414596803
  error estimate for blocks of size 2^( 3) =       0.000423306440
  error estimate for blocks of size 2^( 4) =       0.000429771135
  error estimate for blocks of size 2^( 5) =       0.000433744371
  error estimate for blocks of size 2^( 6) =       0.000436826332
  error estimate for blocks of size 2^( 7) =       0.000439483121

      target function =                  N/A
              le_mean =     -17.213752676538
             les_mean =     296.640836807134
             stat err =       0.000434956240
             autocorr =       1.155143353432
              std dev =       0.572324874439
             le_variance =       0.327555761902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327660828146
                                         uncertainty =       0.004305716569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327660828146
                                         uncertainty =       0.004305716569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404802222
  error estimate for blocks of size 2^( 2) =       0.000414700650
  error estimate for blocks of size 2^( 3) =       0.000423406405
  error estimate for blocks of size 2^( 4) =       0.000429870126
  error estimate for blocks of size 2^( 5) =       0.000433840805
  error estimate for blocks of size 2^( 6) =       0.000436923252
  error estimate for blocks of size 2^( 7) =       0.000439579513

      target function =                  N/A
              le_mean =     -17.213752195494
             les_mean =     296.640994162641
             stat err =       0.000435053424
             autocorr =       1.155046332004
              std dev =       0.572476793102
             le_variance =       0.327729678640


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213752116463        initial
     5.8208e-01     5.8208e+00             2.7126e-04       -17.213752649826
     2.3283e+00     2.3283e+01             8.1780e-05       -17.213752676538  <--
     9.3132e+00     9.3132e+01             2.1700e-05       -17.213752195494

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 4.6102e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.935236e-01 1 1  ON 0
 uu_1                 2.871040e-02 1 1  ON 1
 uu_2                -6.898617e-02 1 1  ON 2
 uu_3                -1.264645e-01 1 1  ON 3
 uu_4                -1.624646e-01 1 1  ON 4
 uu_5                -1.738876e-01 1 1  ON 5
 uu_6                -1.580560e-01 1 1  ON 6
 uu_7                -1.116322e-01 1 1  ON 7
 uu_8                -3.690871e-02 1 1  ON 8
 uu_9                 2.147848e-01 1 1  ON 9
 ud_0                 3.498121e-01 1 1  ON 10
 ud_1                 9.081987e-02 1 1  ON 11
 ud_2                -1.754182e-02 1 1  ON 12
 ud_3                -7.676366e-02 1 1  ON 13
 ud_4                -1.257404e-01 1 1  ON 14
 ud_5                -1.622410e-01 1 1  ON 15
 ud_6                -1.729023e-01 1 1  ON 16
 ud_7                -1.449175e-01 1 1  ON 17
 ud_8                -9.337278e-02 1 1  ON 18
 ud_9                 4.315300e-02 1 1  ON 19
 eO_0                -8.935628e-01 1 1  ON 20
 eO_1                -5.712995e-01 1 1  ON 21
 eO_2                -1.594540e-01 1 1  ON 22
 eO_3                 1.055182e-01 1 1  ON 23
 eO_4                 2.227283e-01 1 1  ON 24
 eO_5                 2.974882e-01 1 1  ON 25
 eO_6                 3.087589e-01 1 1  ON 26
 eO_7                 4.648288e-01 1 1  ON 27
 eO_8                 1.264472e-01 1 1  ON 28
 eO_9                 5.419014e-02 1 1  ON 29
eH1_0                -2.137670e-01 1 1  ON 30
eH1_1                -1.350319e-01 1 1  ON 31
eH1_2                -9.266732e-02 1 1  ON 32
eH1_3                -5.497425e-02 1 1  ON 33
eH1_4                -8.609908e-03 1 1  ON 34
eH1_5                 3.516280e-03 1 1  ON 35
eH1_6                 5.120404e-02 1 1  ON 36
eH1_7                 5.234442e-02 1 1  ON 37
eH1_8                 2.210270e-01 1 1  ON 38
eH1_9                 1.117498e-01 1 1  ON 39
eH2_0                -2.077655e-01 1 1  ON 40
eH2_1                -1.292050e-01 1 1  ON 41
eH2_2                -8.704677e-02 1 1  ON 42
eH2_3                -4.960059e-02 1 1  ON 43
eH2_4                -3.344494e-03 1 1  ON 44
eH2_5                 7.730641e-03 1 1  ON 45
eH2_6                 4.745403e-02 1 1  ON 46
eH2_7                 8.026381e-03 1 1  ON 47
eH2_8                 2.466464e-01 1 1  ON 48
eH2_9                 1.126956e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7402e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1973
    reference variance = 0.275973
====================================================
  Execution time = 3.2397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2893e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329012745596
                                         uncertainty =       0.003305844057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329012745596
                                         uncertainty =       0.003305844057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405545822
  error estimate for blocks of size 2^( 2) =       0.000415517520
  error estimate for blocks of size 2^( 3) =       0.000424212844
  error estimate for blocks of size 2^( 4) =       0.000430084519
  error estimate for blocks of size 2^( 5) =       0.000433759991
  error estimate for blocks of size 2^( 6) =       0.000435297902
  error estimate for blocks of size 2^( 7) =       0.000436652518

      target function =                  N/A
              le_mean =     -17.213843439325
             les_mean =     296.645340616251
             stat err =       0.000433948732
             autocorr =       1.144977587427
              std dev =       0.573528401330
             le_variance =       0.328934827132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721384343932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213843439325       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213843850380       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213844247511       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213844811375       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213844839330       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213844948466       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213844842852       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213844894598       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 2.406465e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213843439325       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213843569521       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213843689127       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213843862278       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213843886429       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213843890400       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213843870026       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 7.078296e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213843439325       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213843474201       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213843505941       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213843551912       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213843559187       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213843557634       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213843553528       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.914311e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.351718 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1425e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.934810e-01 1 1  ON 0
 uu_1                 2.869990e-02 1 1  ON 1
 uu_2                -6.902403e-02 1 1  ON 2
 uu_3                -1.264801e-01 1 1  ON 3
 uu_4                -1.624664e-01 1 1  ON 4
 uu_5                -1.738599e-01 1 1  ON 5
 uu_6                -1.580414e-01 1 1  ON 6
 uu_7                -1.115901e-01 1 1  ON 7
 uu_8                -3.689178e-02 1 1  ON 8
 uu_9                 2.147743e-01 1 1  ON 9
 ud_0                 3.497744e-01 1 1  ON 10
 ud_1                 9.080181e-02 1 1  ON 11
 ud_2                -1.751293e-02 1 1  ON 12
 ud_3                -7.672505e-02 1 1  ON 13
 ud_4                -1.257605e-01 1 1  ON 14
 ud_5                -1.622715e-01 1 1  ON 15
 ud_6                -1.728945e-01 1 1  ON 16
 ud_7                -1.448967e-01 1 1  ON 17
 ud_8                -9.336654e-02 1 1  ON 18
 ud_9                 4.314379e-02 1 1  ON 19
 eO_0                -8.935921e-01 1 1  ON 20
 eO_1                -5.712929e-01 1 1  ON 21
 eO_2                -1.595036e-01 1 1  ON 22
 eO_3                 1.055205e-01 1 1  ON 23
 eO_4                 2.227166e-01 1 1  ON 24
 eO_5                 2.975296e-01 1 1  ON 25
 eO_6                 3.087867e-01 1 1  ON 26
 eO_7                 4.648298e-01 1 1  ON 27
 eO_8                 1.264551e-01 1 1  ON 28
 eO_9                 5.419079e-02 1 1  ON 29
eH1_0                -2.138041e-01 1 1  ON 30
eH1_1                -1.349815e-01 1 1  ON 31
eH1_2                -9.263429e-02 1 1  ON 32
eH1_3                -5.497870e-02 1 1  ON 33
eH1_4                -8.610280e-03 1 1  ON 34
eH1_5                 3.495468e-03 1 1  ON 35
eH1_6                 5.115791e-02 1 1  ON 36
eH1_7                 5.236570e-02 1 1  ON 37
eH1_8                 2.210258e-01 1 1  ON 38
eH1_9                 1.117516e-01 1 1  ON 39
eH2_0                -2.078012e-01 1 1  ON 40
eH2_1                -1.292473e-01 1 1  ON 41
eH2_2                -8.704958e-02 1 1  ON 42
eH2_3                -4.952981e-02 1 1  ON 43
eH2_4                -3.367389e-03 1 1  ON 44
eH2_5                 7.677278e-03 1 1  ON 45
eH2_6                 4.746576e-02 1 1  ON 46
eH2_7                 8.087996e-03 1 1  ON 47
eH2_8                 2.466501e-01 1 1  ON 48
eH2_9                 1.127021e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2139
    reference variance = 0.436431
====================================================
  Execution time = 3.2154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2665e-01
  Total weights = 2.0000e+06
  Execution time = 2.8378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326818432276
                                         uncertainty =       0.003070630619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326818432276
                                         uncertainty =       0.003070630619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404157603
  error estimate for blocks of size 2^( 2) =       0.000413617924
  error estimate for blocks of size 2^( 3) =       0.000421769336
  error estimate for blocks of size 2^( 4) =       0.000428222369
  error estimate for blocks of size 2^( 5) =       0.000432895399
  error estimate for blocks of size 2^( 6) =       0.000434027378
  error estimate for blocks of size 2^( 7) =       0.000437779025

      target function =                  N/A
              le_mean =     -17.213840298105
             les_mean =     296.642984380728
             stat err =       0.000433231043
             autocorr =       1.149046570702
              std dev =       0.571565162872
             le_variance =       0.326686735409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326687048599
                                         uncertainty =       0.003069694953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326687048599
                                         uncertainty =       0.003069694953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404076361
  error estimate for blocks of size 2^( 2) =       0.000413540952
  error estimate for blocks of size 2^( 3) =       0.000421695904
  error estimate for blocks of size 2^( 4) =       0.000428154695
  error estimate for blocks of size 2^( 5) =       0.000432829934
  error estimate for blocks of size 2^( 6) =       0.000433966543
  error estimate for blocks of size 2^( 7) =       0.000437714743

      target function =                  N/A
              le_mean =     -17.213841201342
             les_mean =     296.642884152883
             stat err =       0.000433166478
             autocorr =       1.149166062988
              std dev =       0.571450270039
             le_variance =       0.326555411127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326736208308
                                         uncertainty =       0.003070032886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326736208308
                                         uncertainty =       0.003070032886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404106761
  error estimate for blocks of size 2^( 2) =       0.000413569713
  error estimate for blocks of size 2^( 3) =       0.000421723335
  error estimate for blocks of size 2^( 4) =       0.000428180119
  error estimate for blocks of size 2^( 5) =       0.000432854116
  error estimate for blocks of size 2^( 6) =       0.000433988841
  error estimate for blocks of size 2^( 7) =       0.000437737549

      target function =                  N/A
              le_mean =     -17.213840888424
             les_mean =     296.642922516767
             stat err =       0.000433190156
             autocorr =       1.149118788877
              std dev =       0.571493261619
             le_variance =       0.326604548076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326807695000
                                         uncertainty =       0.003070556399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326807695000
                                         uncertainty =       0.003070556399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404150963
  error estimate for blocks of size 2^( 2) =       0.000413611625
  error estimate for blocks of size 2^( 3) =       0.000421763322
  error estimate for blocks of size 2^( 4) =       0.000428216861
  error estimate for blocks of size 2^( 5) =       0.000432889990
  error estimate for blocks of size 2^( 6) =       0.000434022337
  error estimate for blocks of size 2^( 7) =       0.000437773547

      target function =                  N/A
              le_mean =     -17.213840366773
             les_mean =     296.642976012009
             stat err =       0.000433225684
             autocorr =       1.149055893708
              std dev =       0.571555773821
             le_variance =       0.326676002589


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213840298105        initial
     5.8208e-01     5.8208e+00             2.4065e-04       -17.213841201342  <--
     2.3283e+00     2.3283e+01             7.0783e-05       -17.213840888424
     9.3132e+00     9.3132e+01             1.9143e-05       -17.213840366773

*****************************************************************************
Applying the update for shift_i =   5.8208e-01     and shift_s =   5.8208e+00
*****************************************************************************

  Execution time = 4.6462e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.933741e-01 1 1  ON 0
 uu_1                 2.865461e-02 1 1  ON 1
 uu_2                -6.911380e-02 1 1  ON 2
 uu_3                -1.265287e-01 1 1  ON 3
 uu_4                -1.624760e-01 1 1  ON 4
 uu_5                -1.737918e-01 1 1  ON 5
 uu_6                -1.580012e-01 1 1  ON 6
 uu_7                -1.114680e-01 1 1  ON 7
 uu_8                -3.684242e-02 1 1  ON 8
 uu_9                 2.147434e-01 1 1  ON 9
 ud_0                 3.497023e-01 1 1  ON 10
 ud_1                 9.077708e-02 1 1  ON 11
 ud_2                -1.745850e-02 1 1  ON 12
 ud_3                -7.665554e-02 1 1  ON 13
 ud_4                -1.257919e-01 1 1  ON 14
 ud_5                -1.623605e-01 1 1  ON 15
 ud_6                -1.728867e-01 1 1  ON 16
 ud_7                -1.448403e-01 1 1  ON 17
 ud_8                -9.334872e-02 1 1  ON 18
 ud_9                 4.311675e-02 1 1  ON 19
 eO_0                -8.936528e-01 1 1  ON 20
 eO_1                -5.713222e-01 1 1  ON 21
 eO_2                -1.596134e-01 1 1  ON 22
 eO_3                 1.055234e-01 1 1  ON 23
 eO_4                 2.226801e-01 1 1  ON 24
 eO_5                 2.976466e-01 1 1  ON 25
 eO_6                 3.088669e-01 1 1  ON 26
 eO_7                 4.648326e-01 1 1  ON 27
 eO_8                 1.264783e-01 1 1  ON 28
 eO_9                 5.419267e-02 1 1  ON 29
eH1_0                -2.138883e-01 1 1  ON 30
eH1_1                -1.348536e-01 1 1  ON 31
eH1_2                -9.255611e-02 1 1  ON 32
eH1_3                -5.497319e-02 1 1  ON 33
eH1_4                -8.615322e-03 1 1  ON 34
eH1_5                 3.434121e-03 1 1  ON 35
eH1_6                 5.102333e-02 1 1  ON 36
eH1_7                 5.242756e-02 1 1  ON 37
eH1_8                 2.210221e-01 1 1  ON 38
eH1_9                 1.117567e-01 1 1  ON 39
eH2_0                -2.079047e-01 1 1  ON 40
eH2_1                -1.293343e-01 1 1  ON 41
eH2_2                -8.705152e-02 1 1  ON 42
eH2_3                -4.938133e-02 1 1  ON 43
eH2_4                -3.406836e-03 1 1  ON 44
eH2_5                 7.515693e-03 1 1  ON 45
eH2_6                 4.749381e-02 1 1  ON 46
eH2_7                 8.267027e-03 1 1  ON 47
eH2_8                 2.466607e-01 1 1  ON 48
eH2_9                 1.127211e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1756
    reference variance = 0.161392
====================================================
  Execution time = 3.4281e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2600e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0421e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326005466477
                                         uncertainty =       0.002951405384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326005466477
                                         uncertainty =       0.002951405384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403734983
  error estimate for blocks of size 2^( 2) =       0.000414034823
  error estimate for blocks of size 2^( 3) =       0.000422843975
  error estimate for blocks of size 2^( 4) =       0.000429080752
  error estimate for blocks of size 2^( 5) =       0.000432958394
  error estimate for blocks of size 2^( 6) =       0.000434968959
  error estimate for blocks of size 2^( 7) =       0.000436251854

      target function =                  N/A
              le_mean =     -17.213657375405
             les_mean =     296.636003948349
             stat err =       0.000433314989
             autocorr =       1.151899687519
              std dev =       0.570967489015
             le_variance =       0.326003873512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721365737541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213657375405       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213656503220       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213656035208       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213656951600       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213657923223       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213657014660       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213656956451       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213657240221       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213657295369       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213657342322       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e-01 is 7.430676e-04

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213657375405       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213657008554       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213656606483       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213656956320       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213657398604       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213657023486       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213657101136       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213657128334       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 1.866455e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213657375405       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213657264826       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213657090900       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213657180432       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213657310050       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213657234166       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213657244434       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 6.114481e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.354563 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3335e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.933204e-01 1 1  ON 0
 uu_1                 2.857057e-02 1 1  ON 1
 uu_2                -6.910867e-02 1 1  ON 2
 uu_3                -1.265404e-01 1 1  ON 3
 uu_4                -1.624661e-01 1 1  ON 4
 uu_5                -1.736115e-01 1 1  ON 5
 uu_6                -1.581151e-01 1 1  ON 6
 uu_7                -1.114069e-01 1 1  ON 7
 uu_8                -3.681539e-02 1 1  ON 8
 uu_9                 2.146819e-01 1 1  ON 9
 ud_0                 3.497662e-01 1 1  ON 10
 ud_1                 9.094467e-02 1 1  ON 11
 ud_2                -1.746538e-02 1 1  ON 12
 ud_3                -7.666346e-02 1 1  ON 13
 ud_4                -1.258281e-01 1 1  ON 14
 ud_5                -1.624572e-01 1 1  ON 15
 ud_6                -1.729295e-01 1 1  ON 16
 ud_7                -1.449007e-01 1 1  ON 17
 ud_8                -9.334377e-02 1 1  ON 18
 ud_9                 4.309952e-02 1 1  ON 19
 eO_0                -8.936599e-01 1 1  ON 20
 eO_1                -5.714883e-01 1 1  ON 21
 eO_2                -1.595542e-01 1 1  ON 22
 eO_3                 1.054884e-01 1 1  ON 23
 eO_4                 2.226211e-01 1 1  ON 24
 eO_5                 2.976983e-01 1 1  ON 25
 eO_6                 3.089871e-01 1 1  ON 26
 eO_7                 4.648296e-01 1 1  ON 27
 eO_8                 1.265049e-01 1 1  ON 28
 eO_9                 5.419963e-02 1 1  ON 29
eH1_0                -2.138880e-01 1 1  ON 30
eH1_1                -1.348471e-01 1 1  ON 31
eH1_2                -9.252377e-02 1 1  ON 32
eH1_3                -5.487367e-02 1 1  ON 33
eH1_4                -8.562289e-03 1 1  ON 34
eH1_5                 3.476529e-03 1 1  ON 35
eH1_6                 5.083712e-02 1 1  ON 36
eH1_7                 5.240618e-02 1 1  ON 37
eH1_8                 2.209778e-01 1 1  ON 38
eH1_9                 1.117614e-01 1 1  ON 39
eH2_0                -2.080914e-01 1 1  ON 40
eH2_1                -1.294381e-01 1 1  ON 41
eH2_2                -8.699938e-02 1 1  ON 42
eH2_3                -4.935184e-02 1 1  ON 43
eH2_4                -3.412682e-03 1 1  ON 44
eH2_5                 7.489314e-03 1 1  ON 45
eH2_6                 4.756933e-02 1 1  ON 46
eH2_7                 8.452465e-03 1 1  ON 47
eH2_8                 2.466321e-01 1 1  ON 48
eH2_9                 1.127227e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1976
    reference variance = 0.216984
====================================================
  Execution time = 3.1912e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2880e-01
  Total weights = 2.0000e+06
  Execution time = 2.8254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328917994827
                                         uncertainty =       0.004252206582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328917994827
                                         uncertainty =       0.004252206582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405500973
  error estimate for blocks of size 2^( 2) =       0.000415057844
  error estimate for blocks of size 2^( 3) =       0.000424157955
  error estimate for blocks of size 2^( 4) =       0.000430613119
  error estimate for blocks of size 2^( 5) =       0.000435525303
  error estimate for blocks of size 2^( 6) =       0.000438405724
  error estimate for blocks of size 2^( 7) =       0.000441009636

      target function =                  N/A
              le_mean =     -17.214453452704
             les_mean =     296.666269588871
             stat err =       0.000436388445
             autocorr =       1.158144329126
              std dev =       0.573464975381
             le_variance =       0.328862077989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328806516461
                                         uncertainty =       0.004246906005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328806516461
                                         uncertainty =       0.004246906005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405432286
  error estimate for blocks of size 2^( 2) =       0.000414988605
  error estimate for blocks of size 2^( 3) =       0.000424088482
  error estimate for blocks of size 2^( 4) =       0.000430543639
  error estimate for blocks of size 2^( 5) =       0.000435457468
  error estimate for blocks of size 2^( 6) =       0.000438336013
  error estimate for blocks of size 2^( 7) =       0.000440938040

      target function =                  N/A
              le_mean =     -17.214452193027
             les_mean =     296.666114819127
             stat err =       0.000436318790
             autocorr =       1.158166959406
              std dev =       0.573367837867
             le_variance =       0.328750677500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328804895894
                                         uncertainty =       0.004246805949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328804895894
                                         uncertainty =       0.004246805949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405431295
  error estimate for blocks of size 2^( 2) =       0.000414987676
  error estimate for blocks of size 2^( 3) =       0.000424087292
  error estimate for blocks of size 2^( 4) =       0.000430542338
  error estimate for blocks of size 2^( 5) =       0.000435458196
  error estimate for blocks of size 2^( 6) =       0.000438335059
  error estimate for blocks of size 2^( 7) =       0.000440935800

      target function =                  N/A
              le_mean =     -17.214452104523
             les_mean =     296.666110164463
             stat err =       0.000436317848
             autocorr =       1.158167623707
              std dev =       0.573366435996
             le_variance =       0.328749069927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328888285927
                                         uncertainty =       0.004251172685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328888285927
                                         uncertainty =       0.004251172685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405482667
  error estimate for blocks of size 2^( 2) =       0.000415039740
  error estimate for blocks of size 2^( 3) =       0.000424139896
  error estimate for blocks of size 2^( 4) =       0.000430595130
  error estimate for blocks of size 2^( 5) =       0.000435508230
  error estimate for blocks of size 2^( 6) =       0.000438387723
  error estimate for blocks of size 2^( 7) =       0.000440991039

      target function =                  N/A
              le_mean =     -17.214453082998
             les_mean =     296.666227168137
             stat err =       0.000436370531
             autocorr =       1.158153808176
              std dev =       0.573439086410
             le_variance =       0.328832385823


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214453452704        initial  <--
     1.4552e-01     1.4552e+00             7.4307e-04       -17.214452193027
     5.8208e-01     5.8208e+00             1.8665e-04       -17.214452104523
     2.3283e+00     2.3283e+01             6.1145e-05       -17.214453082998

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.1532
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.933741e-01 1 1  ON 0
 uu_1                 2.865461e-02 1 1  ON 1
 uu_2                -6.911380e-02 1 1  ON 2
 uu_3                -1.265287e-01 1 1  ON 3
 uu_4                -1.624760e-01 1 1  ON 4
 uu_5                -1.737918e-01 1 1  ON 5
 uu_6                -1.580012e-01 1 1  ON 6
 uu_7                -1.114680e-01 1 1  ON 7
 uu_8                -3.684242e-02 1 1  ON 8
 uu_9                 2.147434e-01 1 1  ON 9
 ud_0                 3.497023e-01 1 1  ON 10
 ud_1                 9.077708e-02 1 1  ON 11
 ud_2                -1.745850e-02 1 1  ON 12
 ud_3                -7.665554e-02 1 1  ON 13
 ud_4                -1.257919e-01 1 1  ON 14
 ud_5                -1.623605e-01 1 1  ON 15
 ud_6                -1.728867e-01 1 1  ON 16
 ud_7                -1.448403e-01 1 1  ON 17
 ud_8                -9.334872e-02 1 1  ON 18
 ud_9                 4.311675e-02 1 1  ON 19
 eO_0                -8.936528e-01 1 1  ON 20
 eO_1                -5.713222e-01 1 1  ON 21
 eO_2                -1.596134e-01 1 1  ON 22
 eO_3                 1.055234e-01 1 1  ON 23
 eO_4                 2.226801e-01 1 1  ON 24
 eO_5                 2.976466e-01 1 1  ON 25
 eO_6                 3.088669e-01 1 1  ON 26
 eO_7                 4.648326e-01 1 1  ON 27
 eO_8                 1.264783e-01 1 1  ON 28
 eO_9                 5.419267e-02 1 1  ON 29
eH1_0                -2.138883e-01 1 1  ON 30
eH1_1                -1.348536e-01 1 1  ON 31
eH1_2                -9.255611e-02 1 1  ON 32
eH1_3                -5.497319e-02 1 1  ON 33
eH1_4                -8.615322e-03 1 1  ON 34
eH1_5                 3.434121e-03 1 1  ON 35
eH1_6                 5.102333e-02 1 1  ON 36
eH1_7                 5.242756e-02 1 1  ON 37
eH1_8                 2.210221e-01 1 1  ON 38
eH1_9                 1.117567e-01 1 1  ON 39
eH2_0                -2.079047e-01 1 1  ON 40
eH2_1                -1.293343e-01 1 1  ON 41
eH2_2                -8.705152e-02 1 1  ON 42
eH2_3                -4.938133e-02 1 1  ON 43
eH2_4                -3.406836e-03 1 1  ON 44
eH2_5                 7.515693e-03 1 1  ON 45
eH2_6                 4.749381e-02 1 1  ON 46
eH2_7                 8.267027e-03 1 1  ON 47
eH2_8                 2.466607e-01 1 1  ON 48
eH2_9                 1.127211e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2204
    reference variance = 0.323767
====================================================
  Execution time = 3.2358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2703e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327123358498
                                         uncertainty =       0.003559140477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327123358498
                                         uncertainty =       0.003559140477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404371709
  error estimate for blocks of size 2^( 2) =       0.000414902858
  error estimate for blocks of size 2^( 3) =       0.000423869610
  error estimate for blocks of size 2^( 4) =       0.000430799997
  error estimate for blocks of size 2^( 5) =       0.000434656738
  error estimate for blocks of size 2^( 6) =       0.000436877890
  error estimate for blocks of size 2^( 7) =       0.000437369524

      target function =                  N/A
              le_mean =     -17.213893485065
             les_mean =     296.645161708985
             stat err =       0.000434926037
             autocorr =       1.156829327182
              std dev =       0.571867954449
             le_variance =       0.327032957326


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721389348507e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213893485065       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213893854559       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213893329065       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213892922162       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213893194464       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213893113529       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213893121160       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213893107145       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 9.266600e-05

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213893485065       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213893584914       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213893426220       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213893307706       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213893376333       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213893358932       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213893361503       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.696197e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213893485065       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213893510543       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213893468760       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213893437816       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213893454897       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213893450736       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213893451463       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 6.979354e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.356971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1450e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.933566e-01 1 1  ON 0
 uu_1                 2.864340e-02 1 1  ON 1
 uu_2                -6.910614e-02 1 1  ON 2
 uu_3                -1.265226e-01 1 1  ON 3
 uu_4                -1.624700e-01 1 1  ON 4
 uu_5                -1.737970e-01 1 1  ON 5
 uu_6                -1.580063e-01 1 1  ON 6
 uu_7                -1.114589e-01 1 1  ON 7
 uu_8                -3.683848e-02 1 1  ON 8
 uu_9                 2.147382e-01 1 1  ON 9
 ud_0                 3.496937e-01 1 1  ON 10
 ud_1                 9.079584e-02 1 1  ON 11
 ud_2                -1.746718e-02 1 1  ON 12
 ud_3                -7.668250e-02 1 1  ON 13
 ud_4                -1.257812e-01 1 1  ON 14
 ud_5                -1.623594e-01 1 1  ON 15
 ud_6                -1.728860e-01 1 1  ON 16
 ud_7                -1.448418e-01 1 1  ON 17
 ud_8                -9.334243e-02 1 1  ON 18
 ud_9                 4.311614e-02 1 1  ON 19
 eO_0                -8.936636e-01 1 1  ON 20
 eO_1                -5.713379e-01 1 1  ON 21
 eO_2                -1.596104e-01 1 1  ON 22
 eO_3                 1.055242e-01 1 1  ON 23
 eO_4                 2.226806e-01 1 1  ON 24
 eO_5                 2.976524e-01 1 1  ON 25
 eO_6                 3.088775e-01 1 1  ON 26
 eO_7                 4.648308e-01 1 1  ON 27
 eO_8                 1.264826e-01 1 1  ON 28
 eO_9                 5.419405e-02 1 1  ON 29
eH1_0                -2.138994e-01 1 1  ON 30
eH1_1                -1.348615e-01 1 1  ON 31
eH1_2                -9.257304e-02 1 1  ON 32
eH1_3                -5.496653e-02 1 1  ON 33
eH1_4                -8.597654e-03 1 1  ON 34
eH1_5                 3.448803e-03 1 1  ON 35
eH1_6                 5.101254e-02 1 1  ON 36
eH1_7                 5.243025e-02 1 1  ON 37
eH1_8                 2.210217e-01 1 1  ON 38
eH1_9                 1.117594e-01 1 1  ON 39
eH2_0                -2.079194e-01 1 1  ON 40
eH2_1                -1.293400e-01 1 1  ON 41
eH2_2                -8.705174e-02 1 1  ON 42
eH2_3                -4.939740e-02 1 1  ON 43
eH2_4                -3.392256e-03 1 1  ON 44
eH2_5                 7.507945e-03 1 1  ON 45
eH2_6                 4.750016e-02 1 1  ON 46
eH2_7                 8.288666e-03 1 1  ON 47
eH2_8                 2.466599e-01 1 1  ON 48
eH2_9                 1.127219e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2309
    reference variance = 0.216527
====================================================
  Execution time = 3.2740e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2825e-01
  Total weights = 2.0000e+06
  Execution time = 2.8396e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328164249208
                                         uncertainty =       0.002762472127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328164249208
                                         uncertainty =       0.002762472127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405136188
  error estimate for blocks of size 2^( 2) =       0.000414838589
  error estimate for blocks of size 2^( 3) =       0.000423455898
  error estimate for blocks of size 2^( 4) =       0.000429834415
  error estimate for blocks of size 2^( 5) =       0.000432221812
  error estimate for blocks of size 2^( 6) =       0.000435348886
  error estimate for blocks of size 2^( 7) =       0.000435344179

      target function =                  N/A
              le_mean =     -17.215024704888
             les_mean =     296.685346086689
             stat err =       0.000433187323
             autocorr =       1.143271568730
              std dev =       0.572949091051
             le_variance =       0.328270660936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328110867583
                                         uncertainty =       0.002762195226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328110867583
                                         uncertainty =       0.002762195226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405103214
  error estimate for blocks of size 2^( 2) =       0.000414806693
  error estimate for blocks of size 2^( 3) =       0.000423423634
  error estimate for blocks of size 2^( 4) =       0.000429802475
  error estimate for blocks of size 2^( 5) =       0.000432190642
  error estimate for blocks of size 2^( 6) =       0.000435318556
  error estimate for blocks of size 2^( 7) =       0.000435314404

      target function =                  N/A
              le_mean =     -17.215024267667
             les_mean =     296.685277600246
             stat err =       0.000433156519
             autocorr =       1.143295075567
              std dev =       0.572902459407
             le_variance =       0.328217227995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328125487956
                                         uncertainty =       0.002762268503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328125487956
                                         uncertainty =       0.002762268503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405112248
  error estimate for blocks of size 2^( 2) =       0.000414815521
  error estimate for blocks of size 2^( 3) =       0.000423432736
  error estimate for blocks of size 2^( 4) =       0.000429811536
  error estimate for blocks of size 2^( 5) =       0.000432199474
  error estimate for blocks of size 2^( 6) =       0.000435326961
  error estimate for blocks of size 2^( 7) =       0.000435322503

      target function =                  N/A
              le_mean =     -17.215024401922
             les_mean =     296.685296860888
             stat err =       0.000433165119
             autocorr =       1.143289480769
              std dev =       0.572915234777
             le_variance =       0.328231866239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328158950050
                                         uncertainty =       0.002762443916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328158950050
                                         uncertainty =       0.002762443916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405132915
  error estimate for blocks of size 2^( 2) =       0.000414835436
  error estimate for blocks of size 2^( 3) =       0.000423452736
  error estimate for blocks of size 2^( 4) =       0.000429831292
  error estimate for blocks of size 2^( 5) =       0.000432218761
  error estimate for blocks of size 2^( 6) =       0.000435345889
  error estimate for blocks of size 2^( 7) =       0.000435341215

      target function =                  N/A
              le_mean =     -17.215024662971
             les_mean =     296.685339339872
             stat err =       0.000433184289
             autocorr =       1.143274025464
              std dev =       0.572944462684
             le_variance =       0.328265357320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215024704888        initial  <--
     1.4552e+00     1.4552e+01             9.2666e-05       -17.215024267667
     5.8208e+00     5.8208e+01             2.6962e-05       -17.215024401922
     2.3283e+01     2.3283e+02             6.9794e-06       -17.215024662971

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.0949
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.933741e-01 1 1  ON 0
 uu_1                 2.865461e-02 1 1  ON 1
 uu_2                -6.911380e-02 1 1  ON 2
 uu_3                -1.265287e-01 1 1  ON 3
 uu_4                -1.624760e-01 1 1  ON 4
 uu_5                -1.737918e-01 1 1  ON 5
 uu_6                -1.580012e-01 1 1  ON 6
 uu_7                -1.114680e-01 1 1  ON 7
 uu_8                -3.684242e-02 1 1  ON 8
 uu_9                 2.147434e-01 1 1  ON 9
 ud_0                 3.497023e-01 1 1  ON 10
 ud_1                 9.077708e-02 1 1  ON 11
 ud_2                -1.745850e-02 1 1  ON 12
 ud_3                -7.665554e-02 1 1  ON 13
 ud_4                -1.257919e-01 1 1  ON 14
 ud_5                -1.623605e-01 1 1  ON 15
 ud_6                -1.728867e-01 1 1  ON 16
 ud_7                -1.448403e-01 1 1  ON 17
 ud_8                -9.334872e-02 1 1  ON 18
 ud_9                 4.311675e-02 1 1  ON 19
 eO_0                -8.936528e-01 1 1  ON 20
 eO_1                -5.713222e-01 1 1  ON 21
 eO_2                -1.596134e-01 1 1  ON 22
 eO_3                 1.055234e-01 1 1  ON 23
 eO_4                 2.226801e-01 1 1  ON 24
 eO_5                 2.976466e-01 1 1  ON 25
 eO_6                 3.088669e-01 1 1  ON 26
 eO_7                 4.648326e-01 1 1  ON 27
 eO_8                 1.264783e-01 1 1  ON 28
 eO_9                 5.419267e-02 1 1  ON 29
eH1_0                -2.138883e-01 1 1  ON 30
eH1_1                -1.348536e-01 1 1  ON 31
eH1_2                -9.255611e-02 1 1  ON 32
eH1_3                -5.497319e-02 1 1  ON 33
eH1_4                -8.615322e-03 1 1  ON 34
eH1_5                 3.434121e-03 1 1  ON 35
eH1_6                 5.102333e-02 1 1  ON 36
eH1_7                 5.242756e-02 1 1  ON 37
eH1_8                 2.210221e-01 1 1  ON 38
eH1_9                 1.117567e-01 1 1  ON 39
eH2_0                -2.079047e-01 1 1  ON 40
eH2_1                -1.293343e-01 1 1  ON 41
eH2_2                -8.705152e-02 1 1  ON 42
eH2_3                -4.938133e-02 1 1  ON 43
eH2_4                -3.406836e-03 1 1  ON 44
eH2_5                 7.515693e-03 1 1  ON 45
eH2_6                 4.749381e-02 1 1  ON 46
eH2_7                 8.267027e-03 1 1  ON 47
eH2_8                 2.466607e-01 1 1  ON 48
eH2_9                 1.127211e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1519
    reference variance = 0.257727
====================================================
  Execution time = 3.2621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324314371921
                                         uncertainty =       0.002831560930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324314371921
                                         uncertainty =       0.002831560930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402813235
  error estimate for blocks of size 2^( 2) =       0.000412539704
  error estimate for blocks of size 2^( 3) =       0.000421577926
  error estimate for blocks of size 2^( 4) =       0.000427336751
  error estimate for blocks of size 2^( 5) =       0.000430998212
  error estimate for blocks of size 2^( 6) =       0.000433453573
  error estimate for blocks of size 2^( 7) =       0.000432482054

      target function =                  N/A
              le_mean =     -17.214454263018
             les_mean =     296.661952416477
             stat err =       0.000431067648
             autocorr =       1.145205420958
              std dev =       0.569663940570
             le_variance =       0.324517005186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721445426302e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214454263018       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214454279613       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214454276722       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214454280414       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214454292174       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214454292463       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 8.481787e-06

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214454263018       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214454267200       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214454266461       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214454267406       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214454270525       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214454270596       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 2.127251e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214454263018       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214454264066       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214454263880       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214454264118       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214454264909       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214454264927       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 5.322082e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.358867 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1727e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.933733e-01 1 1  ON 0
 uu_1                 2.865501e-02 1 1  ON 1
 uu_2                -6.911372e-02 1 1  ON 2
 uu_3                -1.265301e-01 1 1  ON 3
 uu_4                -1.624751e-01 1 1  ON 4
 uu_5                -1.737915e-01 1 1  ON 5
 uu_6                -1.580023e-01 1 1  ON 6
 uu_7                -1.114675e-01 1 1  ON 7
 uu_8                -3.684188e-02 1 1  ON 8
 uu_9                 2.147431e-01 1 1  ON 9
 ud_0                 3.497018e-01 1 1  ON 10
 ud_1                 9.077766e-02 1 1  ON 11
 ud_2                -1.745921e-02 1 1  ON 12
 ud_3                -7.665523e-02 1 1  ON 13
 ud_4                -1.257908e-01 1 1  ON 14
 ud_5                -1.623610e-01 1 1  ON 15
 ud_6                -1.728873e-01 1 1  ON 16
 ud_7                -1.448403e-01 1 1  ON 17
 ud_8                -9.334835e-02 1 1  ON 18
 ud_9                 4.311650e-02 1 1  ON 19
 eO_0                -8.936534e-01 1 1  ON 20
 eO_1                -5.713225e-01 1 1  ON 21
 eO_2                -1.596126e-01 1 1  ON 22
 eO_3                 1.055226e-01 1 1  ON 23
 eO_4                 2.226796e-01 1 1  ON 24
 eO_5                 2.976472e-01 1 1  ON 25
 eO_6                 3.088675e-01 1 1  ON 26
 eO_7                 4.648325e-01 1 1  ON 27
 eO_8                 1.264786e-01 1 1  ON 28
 eO_9                 5.419277e-02 1 1  ON 29
eH1_0                -2.138897e-01 1 1  ON 30
eH1_1                -1.348540e-01 1 1  ON 31
eH1_2                -9.255554e-02 1 1  ON 32
eH1_3                -5.497262e-02 1 1  ON 33
eH1_4                -8.614239e-03 1 1  ON 34
eH1_5                 3.434507e-03 1 1  ON 35
eH1_6                 5.102222e-02 1 1  ON 36
eH1_7                 5.242781e-02 1 1  ON 37
eH1_8                 2.210221e-01 1 1  ON 38
eH1_9                 1.117568e-01 1 1  ON 39
eH2_0                -2.079054e-01 1 1  ON 40
eH2_1                -1.293360e-01 1 1  ON 41
eH2_2                -8.705122e-02 1 1  ON 42
eH2_3                -4.938066e-02 1 1  ON 43
eH2_4                -3.405925e-03 1 1  ON 44
eH2_5                 7.514079e-03 1 1  ON 45
eH2_6                 4.749383e-02 1 1  ON 46
eH2_7                 8.269154e-03 1 1  ON 47
eH2_8                 2.466605e-01 1 1  ON 48
eH2_9                 1.127212e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2165
    reference variance = 0.190268
====================================================
  Execution time = 3.2396e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2194e-01
  Total weights = 2.0000e+06
  Execution time = 2.8398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321975236129
                                         uncertainty =       0.002445500298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321975236129
                                         uncertainty =       0.002445500298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401212861
  error estimate for blocks of size 2^( 2) =       0.000411624153
  error estimate for blocks of size 2^( 3) =       0.000420465471
  error estimate for blocks of size 2^( 4) =       0.000426808900
  error estimate for blocks of size 2^( 5) =       0.000431416473
  error estimate for blocks of size 2^( 6) =       0.000433638489
  error estimate for blocks of size 2^( 7) =       0.000435325455

      target function =                  N/A
              le_mean =     -17.214391262506
             les_mean =     296.657209897999
             stat err =       0.000431797329
             autocorr =       1.158271074334
              std dev =       0.567400669999
             le_variance =       0.321943520315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321973493849
                                         uncertainty =       0.002445496368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321973493849
                                         uncertainty =       0.002445496368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401211777
  error estimate for blocks of size 2^( 2) =       0.000411623008
  error estimate for blocks of size 2^( 3) =       0.000420464275
  error estimate for blocks of size 2^( 4) =       0.000426807776
  error estimate for blocks of size 2^( 5) =       0.000431415459
  error estimate for blocks of size 2^( 6) =       0.000433637455
  error estimate for blocks of size 2^( 7) =       0.000435324404

      target function =                  N/A
              le_mean =     -17.214391212342
             les_mean =     296.657206430404
             stat err =       0.000431796274
             autocorr =       1.158271672813
              std dev =       0.567399136260
             le_variance =       0.321941779829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321974339380
                                         uncertainty =       0.002445498166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321974339380
                                         uncertainty =       0.002445498166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401212303
  error estimate for blocks of size 2^( 2) =       0.000411623564
  error estimate for blocks of size 2^( 3) =       0.000420464856
  error estimate for blocks of size 2^( 4) =       0.000426808322
  error estimate for blocks of size 2^( 5) =       0.000431415950
  error estimate for blocks of size 2^( 6) =       0.000433637957
  error estimate for blocks of size 2^( 7) =       0.000435324915

      target function =                  N/A
              le_mean =     -17.214391237041
             les_mean =     296.657208125448
             stat err =       0.000431796786
             autocorr =       1.158271382736
              std dev =       0.567399880588
             le_variance =       0.321942624491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321975123165
                                         uncertainty =       0.002445500026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321975123165
                                         uncertainty =       0.002445500026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401212791
  error estimate for blocks of size 2^( 2) =       0.000411624079
  error estimate for blocks of size 2^( 3) =       0.000420465393
  error estimate for blocks of size 2^( 4) =       0.000426808827
  error estimate for blocks of size 2^( 5) =       0.000431416407
  error estimate for blocks of size 2^( 6) =       0.000433638422
  error estimate for blocks of size 2^( 7) =       0.000435325387

      target function =                  N/A
              le_mean =     -17.214391259305
             les_mean =     296.657209674929
             stat err =       0.000431797261
             autocorr =       1.158271113158
              std dev =       0.567400570557
             le_variance =       0.321943407468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214391262506        initial  <--
     1.4552e+01     1.4552e+02             8.4818e-06       -17.214391212342
     5.8208e+01     5.8208e+02             2.1273e-06       -17.214391237041
     2.3283e+02     2.3283e+03             5.3221e-07       -17.214391259305

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.7242
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.933741e-01 1 1  ON 0
 uu_1                 2.865461e-02 1 1  ON 1
 uu_2                -6.911380e-02 1 1  ON 2
 uu_3                -1.265287e-01 1 1  ON 3
 uu_4                -1.624760e-01 1 1  ON 4
 uu_5                -1.737918e-01 1 1  ON 5
 uu_6                -1.580012e-01 1 1  ON 6
 uu_7                -1.114680e-01 1 1  ON 7
 uu_8                -3.684242e-02 1 1  ON 8
 uu_9                 2.147434e-01 1 1  ON 9
 ud_0                 3.497023e-01 1 1  ON 10
 ud_1                 9.077708e-02 1 1  ON 11
 ud_2                -1.745850e-02 1 1  ON 12
 ud_3                -7.665554e-02 1 1  ON 13
 ud_4                -1.257919e-01 1 1  ON 14
 ud_5                -1.623605e-01 1 1  ON 15
 ud_6                -1.728867e-01 1 1  ON 16
 ud_7                -1.448403e-01 1 1  ON 17
 ud_8                -9.334872e-02 1 1  ON 18
 ud_9                 4.311675e-02 1 1  ON 19
 eO_0                -8.936528e-01 1 1  ON 20
 eO_1                -5.713222e-01 1 1  ON 21
 eO_2                -1.596134e-01 1 1  ON 22
 eO_3                 1.055234e-01 1 1  ON 23
 eO_4                 2.226801e-01 1 1  ON 24
 eO_5                 2.976466e-01 1 1  ON 25
 eO_6                 3.088669e-01 1 1  ON 26
 eO_7                 4.648326e-01 1 1  ON 27
 eO_8                 1.264783e-01 1 1  ON 28
 eO_9                 5.419267e-02 1 1  ON 29
eH1_0                -2.138883e-01 1 1  ON 30
eH1_1                -1.348536e-01 1 1  ON 31
eH1_2                -9.255611e-02 1 1  ON 32
eH1_3                -5.497319e-02 1 1  ON 33
eH1_4                -8.615322e-03 1 1  ON 34
eH1_5                 3.434121e-03 1 1  ON 35
eH1_6                 5.102333e-02 1 1  ON 36
eH1_7                 5.242756e-02 1 1  ON 37
eH1_8                 2.210221e-01 1 1  ON 38
eH1_9                 1.117567e-01 1 1  ON 39
eH2_0                -2.079047e-01 1 1  ON 40
eH2_1                -1.293343e-01 1 1  ON 41
eH2_2                -8.705152e-02 1 1  ON 42
eH2_3                -4.938133e-02 1 1  ON 43
eH2_4                -3.406836e-03 1 1  ON 44
eH2_5                 7.515693e-03 1 1  ON 45
eH2_6                 4.749381e-02 1 1  ON 46
eH2_7                 8.267027e-03 1 1  ON 47
eH2_8                 2.466607e-01 1 1  ON 48
eH2_9                 1.127211e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8457e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2424
    reference variance = 0.243035
====================================================
  Execution time = 3.3241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.4327e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343307153014
                                         uncertainty =       0.013868915178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343307153014
                                         uncertainty =       0.013868915178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414289711
  error estimate for blocks of size 2^( 2) =       0.000423936219
  error estimate for blocks of size 2^( 3) =       0.000432244498
  error estimate for blocks of size 2^( 4) =       0.000438557906
  error estimate for blocks of size 2^( 5) =       0.000442346503
  error estimate for blocks of size 2^( 6) =       0.000443723615
  error estimate for blocks of size 2^( 7) =       0.000445425198

      target function =                  N/A
              le_mean =     -17.214256573692
             les_mean =     296.673901142380
             stat err =       0.000442513306
             autocorr =       1.140891573913
              std dev =       0.585894127896
             le_variance =       0.343271929103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721425657369e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214256573692       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214256576441       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214256571896       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214256569598       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214256567788       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214256568246       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214256568156       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.263458e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214256573692       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214256574381       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214256573243       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214256572667       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214256572213       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214256572328       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214256572305       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.164890e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214256573692       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214256573865       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214256573580       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214256573436       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214256573319       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214256573351       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214256573350       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 7.916140e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5244e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.933742e-01 1 1  ON 0
 uu_1                 2.865446e-02 1 1  ON 1
 uu_2                -6.911366e-02 1 1  ON 2
 uu_3                -1.265290e-01 1 1  ON 3
 uu_4                -1.624760e-01 1 1  ON 4
 uu_5                -1.737916e-01 1 1  ON 5
 uu_6                -1.580013e-01 1 1  ON 6
 uu_7                -1.114679e-01 1 1  ON 7
 uu_8                -3.684245e-02 1 1  ON 8
 uu_9                 2.147434e-01 1 1  ON 9
 ud_0                 3.497022e-01 1 1  ON 10
 ud_1                 9.077730e-02 1 1  ON 11
 ud_2                -1.745842e-02 1 1  ON 12
 ud_3                -7.665557e-02 1 1  ON 13
 ud_4                -1.257917e-01 1 1  ON 14
 ud_5                -1.623605e-01 1 1  ON 15
 ud_6                -1.728868e-01 1 1  ON 16
 ud_7                -1.448404e-01 1 1  ON 17
 ud_8                -9.334879e-02 1 1  ON 18
 ud_9                 4.311671e-02 1 1  ON 19
 eO_0                -8.936527e-01 1 1  ON 20
 eO_1                -5.713225e-01 1 1  ON 21
 eO_2                -1.596131e-01 1 1  ON 22
 eO_3                 1.055234e-01 1 1  ON 23
 eO_4                 2.226799e-01 1 1  ON 24
 eO_5                 2.976467e-01 1 1  ON 25
 eO_6                 3.088670e-01 1 1  ON 26
 eO_7                 4.648326e-01 1 1  ON 27
 eO_8                 1.264783e-01 1 1  ON 28
 eO_9                 5.419268e-02 1 1  ON 29
eH1_0                -2.138881e-01 1 1  ON 30
eH1_1                -1.348535e-01 1 1  ON 31
eH1_2                -9.255608e-02 1 1  ON 32
eH1_3                -5.497332e-02 1 1  ON 33
eH1_4                -8.615459e-03 1 1  ON 34
eH1_5                 3.434181e-03 1 1  ON 35
eH1_6                 5.102324e-02 1 1  ON 36
eH1_7                 5.242754e-02 1 1  ON 37
eH1_8                 2.210221e-01 1 1  ON 38
eH1_9                 1.117567e-01 1 1  ON 39
eH2_0                -2.079047e-01 1 1  ON 40
eH2_1                -1.293343e-01 1 1  ON 41
eH2_2                -8.705161e-02 1 1  ON 42
eH2_3                -4.938144e-02 1 1  ON 43
eH2_4                -3.406817e-03 1 1  ON 44
eH2_5                 7.515696e-03 1 1  ON 45
eH2_6                 4.749385e-02 1 1  ON 46
eH2_7                 8.267190e-03 1 1  ON 47
eH2_8                 2.466607e-01 1 1  ON 48
eH2_9                 1.127211e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1894
    reference variance = 0.229372
====================================================
  Execution time = 3.2328e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.3156e-01
  Total weights = 2.0000e+06
  Execution time = 2.8276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331454183154
                                         uncertainty =       0.007458871595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331454183154
                                         uncertainty =       0.007458871595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407163912
  error estimate for blocks of size 2^( 2) =       0.000417221647
  error estimate for blocks of size 2^( 3) =       0.000426115858
  error estimate for blocks of size 2^( 4) =       0.000432194140
  error estimate for blocks of size 2^( 5) =       0.000436471646
  error estimate for blocks of size 2^( 6) =       0.000438469021
  error estimate for blocks of size 2^( 7) =       0.000438859817

      target function =                  N/A
              le_mean =     -17.213414454357
             les_mean =     296.633201914017
             stat err =       0.000436498656
             autocorr =       1.149283747245
              std dev =       0.575816726343
             le_variance =       0.331564902336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453250950
                                         uncertainty =       0.007458869454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453250950
                                         uncertainty =       0.007458869454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407163339
  error estimate for blocks of size 2^( 2) =       0.000417221101
  error estimate for blocks of size 2^( 3) =       0.000426115325
  error estimate for blocks of size 2^( 4) =       0.000432193606
  error estimate for blocks of size 2^( 5) =       0.000436471094
  error estimate for blocks of size 2^( 6) =       0.000438468500
  error estimate for blocks of size 2^( 7) =       0.000438859325

      target function =                  N/A
              le_mean =     -17.213414450694
             les_mean =     296.633200855016
             stat err =       0.000436498131
             autocorr =       1.149284218573
              std dev =       0.575815916271
             le_variance =       0.331563969430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453715251
                                         uncertainty =       0.007458870498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453715251
                                         uncertainty =       0.007458870498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407163624
  error estimate for blocks of size 2^( 2) =       0.000417221373
  error estimate for blocks of size 2^( 3) =       0.000426115590
  error estimate for blocks of size 2^( 4) =       0.000432193872
  error estimate for blocks of size 2^( 5) =       0.000436471369
  error estimate for blocks of size 2^( 6) =       0.000438468760
  error estimate for blocks of size 2^( 7) =       0.000438859570

      target function =                  N/A
              le_mean =     -17.213414452517
             les_mean =     296.633201382417
             stat err =       0.000436498393
             autocorr =       1.149283983884
              std dev =       0.575816319742
             le_variance =       0.331564434081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331454124608
                                         uncertainty =       0.007458871457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331454124608
                                         uncertainty =       0.007458871457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407163876
  error estimate for blocks of size 2^( 2) =       0.000417221612
  error estimate for blocks of size 2^( 3) =       0.000426115824
  error estimate for blocks of size 2^( 4) =       0.000432194106
  error estimate for blocks of size 2^( 5) =       0.000436471612
  error estimate for blocks of size 2^( 6) =       0.000438468988
  error estimate for blocks of size 2^( 7) =       0.000438859786

      target function =                  N/A
              le_mean =     -17.213414454126
             les_mean =     296.633201847492
             stat err =       0.000436498623
             autocorr =       1.149283776869
              std dev =       0.575816675467
             le_variance =       0.331564843746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213414454357        initial  <--
     1.4552e+02     1.4552e+03             1.2635e-06       -17.213414450694
     5.8208e+02     5.8208e+03             3.1649e-07       -17.213414452517
     2.3283e+03     2.3283e+04             7.9161e-08       -17.213414454126

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.5569
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.933741e-01 1 1  ON 0
 uu_1                 2.865461e-02 1 1  ON 1
 uu_2                -6.911380e-02 1 1  ON 2
 uu_3                -1.265287e-01 1 1  ON 3
 uu_4                -1.624760e-01 1 1  ON 4
 uu_5                -1.737918e-01 1 1  ON 5
 uu_6                -1.580012e-01 1 1  ON 6
 uu_7                -1.114680e-01 1 1  ON 7
 uu_8                -3.684242e-02 1 1  ON 8
 uu_9                 2.147434e-01 1 1  ON 9
 ud_0                 3.497023e-01 1 1  ON 10
 ud_1                 9.077708e-02 1 1  ON 11
 ud_2                -1.745850e-02 1 1  ON 12
 ud_3                -7.665554e-02 1 1  ON 13
 ud_4                -1.257919e-01 1 1  ON 14
 ud_5                -1.623605e-01 1 1  ON 15
 ud_6                -1.728867e-01 1 1  ON 16
 ud_7                -1.448403e-01 1 1  ON 17
 ud_8                -9.334872e-02 1 1  ON 18
 ud_9                 4.311675e-02 1 1  ON 19
 eO_0                -8.936528e-01 1 1  ON 20
 eO_1                -5.713222e-01 1 1  ON 21
 eO_2                -1.596134e-01 1 1  ON 22
 eO_3                 1.055234e-01 1 1  ON 23
 eO_4                 2.226801e-01 1 1  ON 24
 eO_5                 2.976466e-01 1 1  ON 25
 eO_6                 3.088669e-01 1 1  ON 26
 eO_7                 4.648326e-01 1 1  ON 27
 eO_8                 1.264783e-01 1 1  ON 28
 eO_9                 5.419267e-02 1 1  ON 29
eH1_0                -2.138883e-01 1 1  ON 30
eH1_1                -1.348536e-01 1 1  ON 31
eH1_2                -9.255611e-02 1 1  ON 32
eH1_3                -5.497319e-02 1 1  ON 33
eH1_4                -8.615322e-03 1 1  ON 34
eH1_5                 3.434121e-03 1 1  ON 35
eH1_6                 5.102333e-02 1 1  ON 36
eH1_7                 5.242756e-02 1 1  ON 37
eH1_8                 2.210221e-01 1 1  ON 38
eH1_9                 1.117567e-01 1 1  ON 39
eH2_0                -2.079047e-01 1 1  ON 40
eH2_1                -1.293343e-01 1 1  ON 41
eH2_2                -8.705152e-02 1 1  ON 42
eH2_3                -4.938133e-02 1 1  ON 43
eH2_4                -3.406836e-03 1 1  ON 44
eH2_5                 7.515693e-03 1 1  ON 45
eH2_6                 4.749381e-02 1 1  ON 46
eH2_7                 8.267027e-03 1 1  ON 47
eH2_8                 2.466607e-01 1 1  ON 48
eH2_9                 1.127211e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1806e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.183
    reference variance = 0.205509
====================================================
  Execution time = 3.3011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.6516e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365150190943
                                         uncertainty =       0.040362340306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365150190943
                                         uncertainty =       0.040362340306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427292769
  error estimate for blocks of size 2^( 2) =       0.000436684863
  error estimate for blocks of size 2^( 3) =       0.000444775580
  error estimate for blocks of size 2^( 4) =       0.000451097238
  error estimate for blocks of size 2^( 5) =       0.000454919345
  error estimate for blocks of size 2^( 6) =       0.000457520179
  error estimate for blocks of size 2^( 7) =       0.000457903323

      target function =                  N/A
              le_mean =     -17.213415209968
             les_mean =     296.666821228907
             stat err =       0.000455360021
             autocorr =       1.135687146750
              std dev =       0.604283228908
             le_variance =       0.365158220739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721341520997e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213415209968       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213415209651       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213415209503       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213415209620       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213415209535       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213415209622       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213415209499       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.182592e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213415209968       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213415209889       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213415209852       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213415209881       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213415209859       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213415209887       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213415209834       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 2.957025e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213415209968       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213415209948       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213415209939       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213415209946       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213415209943       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213415209946       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213415209942       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 7.392904e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.363377 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2106e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.933741e-01 1 1  ON 0
 uu_1                 2.865461e-02 1 1  ON 1
 uu_2                -6.911379e-02 1 1  ON 2
 uu_3                -1.265287e-01 1 1  ON 3
 uu_4                -1.624761e-01 1 1  ON 4
 uu_5                -1.737918e-01 1 1  ON 5
 uu_6                -1.580012e-01 1 1  ON 6
 uu_7                -1.114680e-01 1 1  ON 7
 uu_8                -3.684242e-02 1 1  ON 8
 uu_9                 2.147434e-01 1 1  ON 9
 ud_0                 3.497023e-01 1 1  ON 10
 ud_1                 9.077708e-02 1 1  ON 11
 ud_2                -1.745851e-02 1 1  ON 12
 ud_3                -7.665556e-02 1 1  ON 13
 ud_4                -1.257919e-01 1 1  ON 14
 ud_5                -1.623605e-01 1 1  ON 15
 ud_6                -1.728867e-01 1 1  ON 16
 ud_7                -1.448403e-01 1 1  ON 17
 ud_8                -9.334872e-02 1 1  ON 18
 ud_9                 4.311675e-02 1 1  ON 19
 eO_0                -8.936527e-01 1 1  ON 20
 eO_1                -5.713222e-01 1 1  ON 21
 eO_2                -1.596134e-01 1 1  ON 22
 eO_3                 1.055234e-01 1 1  ON 23
 eO_4                 2.226800e-01 1 1  ON 24
 eO_5                 2.976466e-01 1 1  ON 25
 eO_6                 3.088669e-01 1 1  ON 26
 eO_7                 4.648326e-01 1 1  ON 27
 eO_8                 1.264783e-01 1 1  ON 28
 eO_9                 5.419267e-02 1 1  ON 29
eH1_0                -2.138883e-01 1 1  ON 30
eH1_1                -1.348536e-01 1 1  ON 31
eH1_2                -9.255611e-02 1 1  ON 32
eH1_3                -5.497318e-02 1 1  ON 33
eH1_4                -8.615310e-03 1 1  ON 34
eH1_5                 3.434110e-03 1 1  ON 35
eH1_6                 5.102330e-02 1 1  ON 36
eH1_7                 5.242756e-02 1 1  ON 37
eH1_8                 2.210221e-01 1 1  ON 38
eH1_9                 1.117567e-01 1 1  ON 39
eH2_0                -2.079047e-01 1 1  ON 40
eH2_1                -1.293343e-01 1 1  ON 41
eH2_2                -8.705151e-02 1 1  ON 42
eH2_3                -4.938133e-02 1 1  ON 43
eH2_4                -3.406863e-03 1 1  ON 44
eH2_5                 7.515684e-03 1 1  ON 45
eH2_6                 4.749381e-02 1 1  ON 46
eH2_7                 8.267050e-03 1 1  ON 47
eH2_8                 2.466607e-01 1 1  ON 48
eH2_9                 1.127211e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2292
    reference variance = 0.261721
====================================================
  Execution time = 3.1990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2978e-01
  Total weights = 2.0000e+06
  Execution time = 2.8318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329852206954
                                         uncertainty =       0.004354342130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329852206954
                                         uncertainty =       0.004354342130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406064632
  error estimate for blocks of size 2^( 2) =       0.000415805710
  error estimate for blocks of size 2^( 3) =       0.000423891368
  error estimate for blocks of size 2^( 4) =       0.000429868446
  error estimate for blocks of size 2^( 5) =       0.000433286259
  error estimate for blocks of size 2^( 6) =       0.000434216656
  error estimate for blocks of size 2^( 7) =       0.000437521618

      target function =                  N/A
              le_mean =     -17.213937685825
             les_mean =     296.649427457610
             stat err =       0.000433723245
             autocorr =       1.140867130193
              std dev =       0.574262110042
             le_variance =       0.329776971030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329852247290
                                         uncertainty =       0.004354342460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329852247290
                                         uncertainty =       0.004354342460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406064657
  error estimate for blocks of size 2^( 2) =       0.000415805733
  error estimate for blocks of size 2^( 3) =       0.000423891389
  error estimate for blocks of size 2^( 4) =       0.000429868467
  error estimate for blocks of size 2^( 5) =       0.000433286280
  error estimate for blocks of size 2^( 6) =       0.000434216677
  error estimate for blocks of size 2^( 7) =       0.000437521637

      target function =                  N/A
              le_mean =     -17.213937684594
             les_mean =     296.649427455522
             stat err =       0.000433723265
             autocorr =       1.140867096544
              std dev =       0.574262145113
             le_variance =       0.329777011310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329852227122
                                         uncertainty =       0.004354342295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329852227122
                                         uncertainty =       0.004354342295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406064645
  error estimate for blocks of size 2^( 2) =       0.000415805721
  error estimate for blocks of size 2^( 3) =       0.000423891379
  error estimate for blocks of size 2^( 4) =       0.000429868457
  error estimate for blocks of size 2^( 5) =       0.000433286270
  error estimate for blocks of size 2^( 6) =       0.000434216667
  error estimate for blocks of size 2^( 7) =       0.000437521627

      target function =                  N/A
              le_mean =     -17.213937685210
             les_mean =     296.649427456560
             stat err =       0.000433723255
             autocorr =       1.140867113365
              std dev =       0.574262127577
             le_variance =       0.329776991170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329852209475
                                         uncertainty =       0.004354342151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329852209475
                                         uncertainty =       0.004354342151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406064634
  error estimate for blocks of size 2^( 2) =       0.000415805711
  error estimate for blocks of size 2^( 3) =       0.000423891369
  error estimate for blocks of size 2^( 4) =       0.000429868448
  error estimate for blocks of size 2^( 5) =       0.000433286261
  error estimate for blocks of size 2^( 6) =       0.000434216658
  error estimate for blocks of size 2^( 7) =       0.000437521619

      target function =                  N/A
              le_mean =     -17.213937685748
             les_mean =     296.649427457478
             stat err =       0.000433723246
             autocorr =       1.140867128090
              std dev =       0.574262112234
             le_variance =       0.329776973548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213937685825        initial  <--
     1.4552e+03     1.4552e+04             1.1826e-07       -17.213937684594
     5.8208e+03     5.8208e+04             2.9570e-08       -17.213937685210
     2.3283e+04     2.3283e+05             7.3929e-09       -17.213937685748

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.2408
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.933741e-01 1 1  ON 0
 uu_1                 2.865461e-02 1 1  ON 1
 uu_2                -6.911380e-02 1 1  ON 2
 uu_3                -1.265287e-01 1 1  ON 3
 uu_4                -1.624760e-01 1 1  ON 4
 uu_5                -1.737918e-01 1 1  ON 5
 uu_6                -1.580012e-01 1 1  ON 6
 uu_7                -1.114680e-01 1 1  ON 7
 uu_8                -3.684242e-02 1 1  ON 8
 uu_9                 2.147434e-01 1 1  ON 9
 ud_0                 3.497023e-01 1 1  ON 10
 ud_1                 9.077708e-02 1 1  ON 11
 ud_2                -1.745850e-02 1 1  ON 12
 ud_3                -7.665554e-02 1 1  ON 13
 ud_4                -1.257919e-01 1 1  ON 14
 ud_5                -1.623605e-01 1 1  ON 15
 ud_6                -1.728867e-01 1 1  ON 16
 ud_7                -1.448403e-01 1 1  ON 17
 ud_8                -9.334872e-02 1 1  ON 18
 ud_9                 4.311675e-02 1 1  ON 19
 eO_0                -8.936528e-01 1 1  ON 20
 eO_1                -5.713222e-01 1 1  ON 21
 eO_2                -1.596134e-01 1 1  ON 22
 eO_3                 1.055234e-01 1 1  ON 23
 eO_4                 2.226801e-01 1 1  ON 24
 eO_5                 2.976466e-01 1 1  ON 25
 eO_6                 3.088669e-01 1 1  ON 26
 eO_7                 4.648326e-01 1 1  ON 27
 eO_8                 1.264783e-01 1 1  ON 28
 eO_9                 5.419267e-02 1 1  ON 29
eH1_0                -2.138883e-01 1 1  ON 30
eH1_1                -1.348536e-01 1 1  ON 31
eH1_2                -9.255611e-02 1 1  ON 32
eH1_3                -5.497319e-02 1 1  ON 33
eH1_4                -8.615322e-03 1 1  ON 34
eH1_5                 3.434121e-03 1 1  ON 35
eH1_6                 5.102333e-02 1 1  ON 36
eH1_7                 5.242756e-02 1 1  ON 37
eH1_8                 2.210221e-01 1 1  ON 38
eH1_9                 1.117567e-01 1 1  ON 39
eH2_0                -2.079047e-01 1 1  ON 40
eH2_1                -1.293343e-01 1 1  ON 41
eH2_2                -8.705152e-02 1 1  ON 42
eH2_3                -4.938133e-02 1 1  ON 43
eH2_4                -3.406836e-03 1 1  ON 44
eH2_5                 7.515693e-03 1 1  ON 45
eH2_6                 4.749381e-02 1 1  ON 46
eH2_7                 8.267027e-03 1 1  ON 47
eH2_8                 2.466607e-01 1 1  ON 48
eH2_9                 1.127211e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.248496
====================================================
  Execution time = 3.2440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2852e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2614e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328628743457
                                         uncertainty =       0.004099937931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328628743457
                                         uncertainty =       0.004099937931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405288154
  error estimate for blocks of size 2^( 2) =       0.000415986595
  error estimate for blocks of size 2^( 3) =       0.000425252317
  error estimate for blocks of size 2^( 4) =       0.000431336903
  error estimate for blocks of size 2^( 5) =       0.000435772065
  error estimate for blocks of size 2^( 6) =       0.000435931136
  error estimate for blocks of size 2^( 7) =       0.000438578826

      target function =                  N/A
              le_mean =     -17.214099356099
             les_mean =     296.653733452278
             stat err =       0.000435404732
             autocorr =       1.154139941164
              std dev =       0.573164003494
             le_variance =       0.328516974901


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721409935610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214099356099       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214099356097       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214099356109       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214099356110       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214099356128       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214099356138       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214099356126       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.192968e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214099356099       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214099356098       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214099356101       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214099356101       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214099356095       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214099356139       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214099356046       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 2.982426e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214099356099       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214099356098       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214099356099       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214099356058       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214099356138       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214099356000       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214099356175       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 7.456068e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365665 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1712e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.933741e-01 1 1  ON 0
 uu_1                 2.865461e-02 1 1  ON 1
 uu_2                -6.911380e-02 1 1  ON 2
 uu_3                -1.265287e-01 1 1  ON 3
 uu_4                -1.624760e-01 1 1  ON 4
 uu_5                -1.737918e-01 1 1  ON 5
 uu_6                -1.580012e-01 1 1  ON 6
 uu_7                -1.114680e-01 1 1  ON 7
 uu_8                -3.684242e-02 1 1  ON 8
 uu_9                 2.147434e-01 1 1  ON 9
 ud_0                 3.497023e-01 1 1  ON 10
 ud_1                 9.077708e-02 1 1  ON 11
 ud_2                -1.745850e-02 1 1  ON 12
 ud_3                -7.665554e-02 1 1  ON 13
 ud_4                -1.257919e-01 1 1  ON 14
 ud_5                -1.623605e-01 1 1  ON 15
 ud_6                -1.728867e-01 1 1  ON 16
 ud_7                -1.448403e-01 1 1  ON 17
 ud_8                -9.334872e-02 1 1  ON 18
 ud_9                 4.311675e-02 1 1  ON 19
 eO_0                -8.936528e-01 1 1  ON 20
 eO_1                -5.713222e-01 1 1  ON 21
 eO_2                -1.596134e-01 1 1  ON 22
 eO_3                 1.055234e-01 1 1  ON 23
 eO_4                 2.226801e-01 1 1  ON 24
 eO_5                 2.976466e-01 1 1  ON 25
 eO_6                 3.088669e-01 1 1  ON 26
 eO_7                 4.648326e-01 1 1  ON 27
 eO_8                 1.264783e-01 1 1  ON 28
 eO_9                 5.419267e-02 1 1  ON 29
eH1_0                -2.138883e-01 1 1  ON 30
eH1_1                -1.348536e-01 1 1  ON 31
eH1_2                -9.255611e-02 1 1  ON 32
eH1_3                -5.497319e-02 1 1  ON 33
eH1_4                -8.615321e-03 1 1  ON 34
eH1_5                 3.434121e-03 1 1  ON 35
eH1_6                 5.102333e-02 1 1  ON 36
eH1_7                 5.242756e-02 1 1  ON 37
eH1_8                 2.210221e-01 1 1  ON 38
eH1_9                 1.117567e-01 1 1  ON 39
eH2_0                -2.079047e-01 1 1  ON 40
eH2_1                -1.293343e-01 1 1  ON 41
eH2_2                -8.705152e-02 1 1  ON 42
eH2_3                -4.938133e-02 1 1  ON 43
eH2_4                -3.406837e-03 1 1  ON 44
eH2_5                 7.515691e-03 1 1  ON 45
eH2_6                 4.749381e-02 1 1  ON 46
eH2_7                 8.267030e-03 1 1  ON 47
eH2_8                 2.466607e-01 1 1  ON 48
eH2_9                 1.127211e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1695
    reference variance = 0.187106
====================================================
  Execution time = 3.2045e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2661e-01
  Total weights = 2.0000e+06
  Execution time = 2.8314e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326696435240
                                         uncertainty =       0.003169951820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326696435240
                                         uncertainty =       0.003169951820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404111387
  error estimate for blocks of size 2^( 2) =       0.000413935982
  error estimate for blocks of size 2^( 3) =       0.000422669552
  error estimate for blocks of size 2^( 4) =       0.000429439905
  error estimate for blocks of size 2^( 5) =       0.000433470644
  error estimate for blocks of size 2^( 6) =       0.000435666357
  error estimate for blocks of size 2^( 7) =       0.000436557746

      target function =                  N/A
              le_mean =     -17.214046865757
             les_mean =     296.650021358571
             stat err =       0.000433783663
             autocorr =       1.152243342679
              std dev =       0.571499803502
             le_variance =       0.326612025403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326696434972
                                         uncertainty =       0.003169951803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326696434972
                                         uncertainty =       0.003169951803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404111386
  error estimate for blocks of size 2^( 2) =       0.000413935982
  error estimate for blocks of size 2^( 3) =       0.000422669552
  error estimate for blocks of size 2^( 4) =       0.000429439904
  error estimate for blocks of size 2^( 5) =       0.000433470643
  error estimate for blocks of size 2^( 6) =       0.000435666356
  error estimate for blocks of size 2^( 7) =       0.000436557745

      target function =                  N/A
              le_mean =     -17.214046865730
             les_mean =     296.650021357381
             stat err =       0.000433783662
             autocorr =       1.152243341140
              std dev =       0.571499803269
             le_variance =       0.326612025137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326696435106
                                         uncertainty =       0.003169951811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326696435106
                                         uncertainty =       0.003169951811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404111386
  error estimate for blocks of size 2^( 2) =       0.000413935982
  error estimate for blocks of size 2^( 3) =       0.000422669552
  error estimate for blocks of size 2^( 4) =       0.000429439904
  error estimate for blocks of size 2^( 5) =       0.000433470644
  error estimate for blocks of size 2^( 6) =       0.000435666356
  error estimate for blocks of size 2^( 7) =       0.000436557745

      target function =                  N/A
              le_mean =     -17.214046865743
             les_mean =     296.650021357976
             stat err =       0.000433783662
             autocorr =       1.152243341905
              std dev =       0.571499803386
             le_variance =       0.326612025270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326696435223
                                         uncertainty =       0.003169951818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326696435223
                                         uncertainty =       0.003169951818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404111386
  error estimate for blocks of size 2^( 2) =       0.000413935982
  error estimate for blocks of size 2^( 3) =       0.000422669552
  error estimate for blocks of size 2^( 4) =       0.000429439904
  error estimate for blocks of size 2^( 5) =       0.000433470644
  error estimate for blocks of size 2^( 6) =       0.000435666356
  error estimate for blocks of size 2^( 7) =       0.000436557746

      target function =                  N/A
              le_mean =     -17.214046865755
             les_mean =     296.650021358496
             stat err =       0.000433783663
             autocorr =       1.152243342584
              std dev =       0.571499803487
             le_variance =       0.326612025386


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214046865757        initial  <--
     1.4552e+04     1.4552e+05             1.1930e-08       -17.214046865730
     5.8208e+04     5.8208e+05             2.9824e-09       -17.214046865743
     2.3283e+05     2.3283e+06             7.4561e-10       -17.214046865755

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.3069
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.933741e-01 1 1  ON 0
 uu_1                 2.865461e-02 1 1  ON 1
 uu_2                -6.911380e-02 1 1  ON 2
 uu_3                -1.265287e-01 1 1  ON 3
 uu_4                -1.624760e-01 1 1  ON 4
 uu_5                -1.737918e-01 1 1  ON 5
 uu_6                -1.580012e-01 1 1  ON 6
 uu_7                -1.114680e-01 1 1  ON 7
 uu_8                -3.684242e-02 1 1  ON 8
 uu_9                 2.147434e-01 1 1  ON 9
 ud_0                 3.497023e-01 1 1  ON 10
 ud_1                 9.077708e-02 1 1  ON 11
 ud_2                -1.745850e-02 1 1  ON 12
 ud_3                -7.665554e-02 1 1  ON 13
 ud_4                -1.257919e-01 1 1  ON 14
 ud_5                -1.623605e-01 1 1  ON 15
 ud_6                -1.728867e-01 1 1  ON 16
 ud_7                -1.448403e-01 1 1  ON 17
 ud_8                -9.334872e-02 1 1  ON 18
 ud_9                 4.311675e-02 1 1  ON 19
 eO_0                -8.936528e-01 1 1  ON 20
 eO_1                -5.713222e-01 1 1  ON 21
 eO_2                -1.596134e-01 1 1  ON 22
 eO_3                 1.055234e-01 1 1  ON 23
 eO_4                 2.226801e-01 1 1  ON 24
 eO_5                 2.976466e-01 1 1  ON 25
 eO_6                 3.088669e-01 1 1  ON 26
 eO_7                 4.648326e-01 1 1  ON 27
 eO_8                 1.264783e-01 1 1  ON 28
 eO_9                 5.419267e-02 1 1  ON 29
eH1_0                -2.138883e-01 1 1  ON 30
eH1_1                -1.348536e-01 1 1  ON 31
eH1_2                -9.255611e-02 1 1  ON 32
eH1_3                -5.497319e-02 1 1  ON 33
eH1_4                -8.615322e-03 1 1  ON 34
eH1_5                 3.434121e-03 1 1  ON 35
eH1_6                 5.102333e-02 1 1  ON 36
eH1_7                 5.242756e-02 1 1  ON 37
eH1_8                 2.210221e-01 1 1  ON 38
eH1_9                 1.117567e-01 1 1  ON 39
eH2_0                -2.079047e-01 1 1  ON 40
eH2_1                -1.293343e-01 1 1  ON 41
eH2_2                -8.705152e-02 1 1  ON 42
eH2_3                -4.938133e-02 1 1  ON 43
eH2_4                -3.406836e-03 1 1  ON 44
eH2_5                 7.515693e-03 1 1  ON 45
eH2_6                 4.749381e-02 1 1  ON 46
eH2_7                 8.267027e-03 1 1  ON 47
eH2_8                 2.466607e-01 1 1  ON 48
eH2_9                 1.127211e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8024e+01 secs
  Total Execution time = 3.5666e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
