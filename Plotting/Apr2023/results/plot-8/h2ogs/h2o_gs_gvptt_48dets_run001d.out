Rank =    0  Free Memory = 50459 MB
Rank =    1  Free Memory = 50459 MB
Rank =    2  Free Memory = 50459 MB
Rank =    3  Free Memory = 50459 MB
Rank =    4  Free Memory = 50459 MB
Rank =    5  Free Memory = 50459 MB
Rank =    6  Free Memory = 50458 MB
Rank =    7  Free Memory = 50458 MB
Rank =    8  Free Memory = 50457 MB
Rank =    9  Free Memory = 50457 MB
Rank =   10  Free Memory = 50457 MB
Rank =   11  Free Memory = 50457 MB
Rank =   12  Free Memory = 50457 MB
Rank =   13  Free Memory = 50457 MB
Rank =   14  Free Memory = 50456 MB
Rank =   15  Free Memory = 50442 MB
Rank =   16  Free Memory = 50442 MB
Rank =   17  Free Memory = 50442 MB
Rank =   18  Free Memory = 50442 MB
Rank =   19  Free Memory = 50442 MB
Rank =   20  Free Memory = 50442 MB
Rank =   21  Free Memory = 50442 MB
Rank =   22  Free Memory = 50442 MB
Rank =   23  Free Memory = 50442 MB
Rank =   24  Free Memory = 50442 MB
Rank =   25  Free Memory = 50442 MB
Rank =   26  Free Memory = 50442 MB
Rank =   27  Free Memory = 50442 MB
Rank =   28  Free Memory = 50442 MB
Rank =   29  Free Memory = 50442 MB
Rank =   30  Free Memory = 50442 MB
Rank =   31  Free Memory = 50442 MB
Rank =   32  Free Memory = 64453 MB
Rank =   33  Free Memory = 64453 MB
Rank =   34  Free Memory = 64453 MB
Rank =   35  Free Memory = 64453 MB
Rank =   36  Free Memory = 64453 MB
Rank =   37  Free Memory = 64453 MB
Rank =   38  Free Memory = 64453 MB
Rank =   39  Free Memory = 64453 MB
Rank =   40  Free Memory = 64453 MB
Rank =   41  Free Memory = 64453 MB
Rank =   42  Free Memory = 64453 MB
Rank =   43  Free Memory = 64453 MB
Rank =   44  Free Memory = 64453 MB
Rank =   45  Free Memory = 64453 MB
Rank =   46  Free Memory = 64453 MB
Rank =   47  Free Memory = 64453 MB
Rank =   48  Free Memory = 64453 MB
Rank =   49  Free Memory = 64453 MB
Rank =   50  Free Memory = 64453 MB
Rank =   51  Free Memory = 64453 MB
Rank =   52  Free Memory = 64453 MB
Rank =   53  Free Memory = 64453 MB
Rank =   54  Free Memory = 64453 MB
Rank =   55  Free Memory = 64453 MB
Rank =   56  Free Memory = 64453 MB
Rank =   57  Free Memory = 64453 MB
Rank =   58  Free Memory = 64453 MB
Rank =   59  Free Memory = 64453 MB
Rank =   60  Free Memory = 64453 MB
Rank =   61  Free Memory = 64453 MB
Rank =   62  Free Memory = 64453 MB
Rank =   63  Free Memory = 64453 MB
Rank =   64  Free Memory = 49604 MB
Rank =   65  Free Memory = 49604 MB
Rank =   66  Free Memory = 49604 MB
Rank =   67  Free Memory = 49604 MB
Rank =   68  Free Memory = 49604 MB
Rank =   69  Free Memory = 49604 MB
Rank =   70  Free Memory = 49604 MB
Rank =   71  Free Memory = 49604 MB
Rank =   72  Free Memory = 49604 MB
Rank =   73  Free Memory = 49604 MB
Rank =   74  Free Memory = 49604 MB
Rank =   75  Free Memory = 49604 MB
Rank =   76  Free Memory = 49604 MB
Rank =   77  Free Memory = 49604 MB
Rank =   78  Free Memory = 49604 MB
Rank =   79  Free Memory = 49604 MB
Rank =   80  Free Memory = 49604 MB
Rank =   81  Free Memory = 49604 MB
Rank =   82  Free Memory = 49604 MB
Rank =   83  Free Memory = 49604 MB
Rank =   84  Free Memory = 49604 MB
Rank =   85  Free Memory = 49604 MB
Rank =   86  Free Memory = 49604 MB
Rank =   87  Free Memory = 49604 MB
Rank =   88  Free Memory = 49604 MB
Rank =   89  Free Memory = 49604 MB
Rank =   90  Free Memory = 49604 MB
Rank =   91  Free Memory = 49604 MB
Rank =   92  Free Memory = 49604 MB
Rank =   93  Free Memory = 49604 MB
Rank =   94  Free Memory = 49604 MB
Rank =   95  Free Memory = 49604 MB
Rank =   96  Free Memory = 73636 MB
Rank =   97  Free Memory = 73636 MB
Rank =   98  Free Memory = 73636 MB
Rank =   99  Free Memory = 73636 MB
Rank =  100  Free Memory = 73636 MB
Rank =  101  Free Memory = 73636 MB
Rank =  102  Free Memory = 73636 MB
Rank =  103  Free Memory = 73636 MB
Rank =  104  Free Memory = 73636 MB
Rank =  105  Free Memory = 73636 MB
Rank =  106  Free Memory = 73635 MB
Rank =  107  Free Memory = 73635 MB
Rank =  108  Free Memory = 73635 MB
Rank =  109  Free Memory = 73635 MB
Rank =  110  Free Memory = 73635 MB
Rank =  111  Free Memory = 73635 MB
Rank =  112  Free Memory = 73635 MB
Rank =  113  Free Memory = 73635 MB
Rank =  114  Free Memory = 73635 MB
Rank =  115  Free Memory = 73635 MB
Rank =  116  Free Memory = 73635 MB
Rank =  117  Free Memory = 73635 MB
Rank =  118  Free Memory = 73635 MB
Rank =  119  Free Memory = 73635 MB
Rank =  120  Free Memory = 73635 MB
Rank =  121  Free Memory = 73635 MB
Rank =  122  Free Memory = 73635 MB
Rank =  123  Free Memory = 73635 MB
Rank =  124  Free Memory = 73635 MB
Rank =  125  Free Memory = 73635 MB
Rank =  126  Free Memory = 73635 MB
Rank =  127  Free Memory = 73635 MB
  Input file(s): opt_h2o_gs_gvptt_48dets_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_48dets_run001d.xml

  Project = H2O
  date    = 2023-05-11 17:14:22 PDT
  host    = n0092.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 222

  Range of prime numbers to use as seeds over processors and threads = 1423-2377


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.933741e-01    1         1  ON     0
     uu_1                 2.865461e-02    1         1  ON     1
     uu_2                -6.911380e-02    1         1  ON     2
     uu_3                -1.265287e-01    1         1  ON     3
     uu_4                -1.624760e-01    1         1  ON     4
     uu_5                -1.737918e-01    1         1  ON     5
     uu_6                -1.580012e-01    1         1  ON     6
     uu_7                -1.114680e-01    1         1  ON     7
     uu_8                -3.684242e-02    1         1  ON     8
     uu_9                 2.147434e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.497023e-01    1         1  ON     0
     ud_1                 9.077708e-02    1         1  ON     1
     ud_2                -1.745850e-02    1         1  ON     2
     ud_3                -7.665554e-02    1         1  ON     3
     ud_4                -1.257919e-01    1         1  ON     4
     ud_5                -1.623605e-01    1         1  ON     5
     ud_6                -1.728867e-01    1         1  ON     6
     ud_7                -1.448403e-01    1         1  ON     7
     ud_8                -9.334872e-02    1         1  ON     8
     ud_9                 4.311675e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.936528e-01    1         1  ON     0
     eO_1                -5.713222e-01    1         1  ON     1
     eO_2                -1.596134e-01    1         1  ON     2
     eO_3                 1.055234e-01    1         1  ON     3
     eO_4                 2.226801e-01    1         1  ON     4
     eO_5                 2.976466e-01    1         1  ON     5
     eO_6                 3.088669e-01    1         1  ON     6
     eO_7                 4.648326e-01    1         1  ON     7
     eO_8                 1.264783e-01    1         1  ON     8
     eO_9                 5.419267e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.138883e-01    1         1  ON     0
     eH1_1                -1.348536e-01    1         1  ON     1
     eH1_2                -9.255611e-02    1         1  ON     2
     eH1_3                -5.497319e-02    1         1  ON     3
     eH1_4                -8.615322e-03    1         1  ON     4
     eH1_5                 3.434121e-03    1         1  ON     5
     eH1_6                 5.102333e-02    1         1  ON     6
     eH1_7                 5.242756e-02    1         1  ON     7
     eH1_8                 2.210221e-01    1         1  ON     8
     eH1_9                 1.117567e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.079047e-01    1         1  ON     0
     eH2_1                -1.293343e-01    1         1  ON     1
     eH2_2                -8.705152e-02    1         1  ON     2
     eH2_3                -4.938133e-02    1         1  ON     3
     eH2_4                -3.406836e-03    1         1  ON     4
     eH2_5                 7.515693e-03    1         1  ON     5
     eH2_6                 4.749381e-02    1         1  ON     6
     eH2_7                 8.267027e-03    1         1  ON     7
     eH2_8                 2.466607e-01    1         1  ON     8
     eH2_9                 1.127211e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 48 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.693696e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 19 unique up determinants.
Found 19 unique down determinants.
Number of terms in pairs array: 18
Number of terms in pairs array: 18
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.5288e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.319
    reference variance = 0.348358
====================================================
  Execution time = 1.9597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2191e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321912730946
                                         uncertainty =       0.003492415748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321912730946
                                         uncertainty =       0.003492415748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401194114
  error estimate for blocks of size 2^( 2) =       0.000411756949
  error estimate for blocks of size 2^( 3) =       0.000421029262
  error estimate for blocks of size 2^( 4) =       0.000427996796
  error estimate for blocks of size 2^( 5) =       0.000432894957
  error estimate for blocks of size 2^( 6) =       0.000434421834
  error estimate for blocks of size 2^( 7) =       0.000436105152

      target function =                  N/A
              le_mean =     -17.214661473279
             les_mean =     296.666482913147
             stat err =       0.000432854685
             autocorr =       1.164059389441
              std dev =       0.567374157432
             le_variance =       0.321913434522


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721466147328e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214661473279       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214691941398       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214701189854       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214706165644       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214715226911       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214716859457       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214714227089       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214713688492       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214713726777       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214713109624       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214713265958       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 3.282490e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214661473279       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214674841490       residual = 9.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214678670917       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214681071090       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214685082322       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214685269271       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214684451654       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214684310398       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214684230122       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.068321e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214661473279       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214665592961       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214666771300       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214667574555       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214668875398       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214668830373       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214668659566       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214668630740       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214668603041       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 2.977858e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218856 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5147e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.932266e-01                 1 1 ON  0
uu_1  2.864311e-02                 1 1 ON  1
uu_2  -6.922217e-02                1 1 ON  2
uu_3  -1.265701e-01                1 1 ON  3
uu_4  -1.623167e-01                1 1 ON  4
uu_5  -1.736801e-01                1 1 ON  5
uu_6  -1.580277e-01                1 1 ON  6
uu_7  -1.114669e-01                1 1 ON  7
uu_8  -3.680052e-02                1 1 ON  8
uu_9  2.147285e-01                 1 1 ON  9
ud_0  3.506582e-01                 1 1 ON  10
ud_1  9.137355e-02                 1 1 ON  11
ud_2  -1.800808e-02                1 1 ON  12
ud_3  -7.739914e-02                1 1 ON  13
ud_4  -1.260630e-01                1 1 ON  14
ud_5  -1.621809e-01                1 1 ON  15
ud_6  -1.729575e-01                1 1 ON  16
ud_7  -1.449274e-01                1 1 ON  17
ud_8  -9.335228e-02                1 1 ON  18
ud_9  4.309590e-02                 1 1 ON  19
eO_0  -8.947211e-01                1 1 ON  20
eO_1  -5.718275e-01                1 1 ON  21
eO_2  -1.586230e-01                1 1 ON  22
eO_3  1.061944e-01                 1 1 ON  23
eO_4  2.226451e-01                 1 1 ON  24
eO_5  2.975858e-01                 1 1 ON  25
eO_6  3.088523e-01                 1 1 ON  26
eO_7  4.648193e-01                 1 1 ON  27
eO_8  1.265071e-01                 1 1 ON  28
eO_9  5.419968e-02                 1 1 ON  29
eH1_0 -2.139778e-01                1 1 ON  30
eH1_1 -1.347510e-01                1 1 ON  31
eH1_2 -9.256126e-02                1 1 ON  32
eH1_3 -5.495654e-02                1 1 ON  33
eH1_4 -8.491514e-03                1 1 ON  34
eH1_5 3.394290e-03                 1 1 ON  35
eH1_6 5.089177e-02                 1 1 ON  36
eH1_7 5.244404e-02                 1 1 ON  37
eH1_8 2.210221e-01                 1 1 ON  38
eH1_9 1.117599e-01                 1 1 ON  39
eH2_0 -2.079534e-01                1 1 ON  40
eH2_1 -1.293080e-01                1 1 ON  41
eH2_2 -8.719698e-02                1 1 ON  42
eH2_3 -4.938159e-02                1 1 ON  43
eH2_4 -3.229748e-03                1 1 ON  44
eH2_5 7.494512e-03                 1 1 ON  45
eH2_6 4.745376e-02                 1 1 ON  46
eH2_7 8.342478e-03                 1 1 ON  47
eH2_8 2.466255e-01                 1 1 ON  48
eH2_9 1.127240e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2721
    reference variance = 0.288712
====================================================
  Execution time = 2.1902e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2080e-01
  Total weights = 2.0000e+06
  Execution time = 1.7032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319884436493
                                         uncertainty =       0.003674666520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319884436493
                                         uncertainty =       0.003674666520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399982484
  error estimate for blocks of size 2^( 2) =       0.000410032130
  error estimate for blocks of size 2^( 3) =       0.000419801241
  error estimate for blocks of size 2^( 4) =       0.000426553109
  error estimate for blocks of size 2^( 5) =       0.000431193370
  error estimate for blocks of size 2^( 6) =       0.000434042664
  error estimate for blocks of size 2^( 7) =       0.000436381307

      target function =                  N/A
              le_mean =     -17.214568565437
             les_mean =     296.661342709187
             stat err =       0.000432042612
             autocorr =       1.166732298816
              std dev =       0.565660653624
             le_variance =       0.319971975059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322145823550
                                         uncertainty =       0.003701638402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322145823550
                                         uncertainty =       0.003701638402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401394459
  error estimate for blocks of size 2^( 2) =       0.000411313028
  error estimate for blocks of size 2^( 3) =       0.000420962310
  error estimate for blocks of size 2^( 4) =       0.000427611380
  error estimate for blocks of size 2^( 5) =       0.000432221263
  error estimate for blocks of size 2^( 6) =       0.000435060287
  error estimate for blocks of size 2^( 7) =       0.000437446891

      target function =                  N/A
              le_mean =     -17.214569410183
             les_mean =     296.663634840031
             stat err =       0.000433084955
             autocorr =       1.164135273569
              std dev =       0.567657487508
             le_variance =       0.322235023124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321589841778
                                         uncertainty =       0.003695130155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321589841778
                                         uncertainty =       0.003695130155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401047867
  error estimate for blocks of size 2^( 2) =       0.000410990468
  error estimate for blocks of size 2^( 3) =       0.000420664361
  error estimate for blocks of size 2^( 4) =       0.000427332853
  error estimate for blocks of size 2^( 5) =       0.000431953852
  error estimate for blocks of size 2^( 6) =       0.000434797452
  error estimate for blocks of size 2^( 7) =       0.000437181797

      target function =                  N/A
              le_mean =     -17.214566766699
             les_mean =     296.662987586819
             stat err =       0.000432816489
             autocorr =       1.164702946155
              std dev =       0.567167332040
             le_variance =       0.321678782533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320116583024
                                         uncertainty =       0.003677600007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320116583024
                                         uncertainty =       0.003677600007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400127688
  error estimate for blocks of size 2^( 2) =       0.000410160278
  error estimate for blocks of size 2^( 3) =       0.000419914580
  error estimate for blocks of size 2^( 4) =       0.000426653546
  error estimate for blocks of size 2^( 5) =       0.000431291228
  error estimate for blocks of size 2^( 6) =       0.000434139744
  error estimate for blocks of size 2^( 7) =       0.000436485936

      target function =                  N/A
              le_mean =     -17.214566129958
             les_mean =     296.661491215859
             stat err =       0.000432142613
             autocorr =       1.166425427777
              std dev =       0.565866002911
             le_variance =       0.320204333250


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214568565437        initial
     2.5000e-01     2.5000e+00             3.2825e-03       -17.214569410183  <--
     1.0000e+00     1.0000e+01             1.0683e-03       -17.214566766699
     4.0000e+00     4.0000e+01             2.9779e-04       -17.214566129958

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0521e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.931102e-01 1 1  ON 0
 uu_1                 2.860834e-02 1 1  ON 1
 uu_2                -6.940096e-02 1 1  ON 2
 uu_3                -1.267310e-01 1 1  ON 3
 uu_4                -1.622184e-01 1 1  ON 4
 uu_5                -1.735003e-01 1 1  ON 5
 uu_6                -1.580492e-01 1 1  ON 6
 uu_7                -1.114320e-01 1 1  ON 7
 uu_8                -3.666759e-02 1 1  ON 8
 uu_9                 2.146854e-01 1 1  ON 9
 ud_0                 3.522695e-01 1 1  ON 10
 ud_1                 9.214024e-02 1 1  ON 11
 ud_2                -1.861340e-02 1 1  ON 12
 ud_3                -7.864774e-02 1 1  ON 13
 ud_4                -1.267792e-01 1 1  ON 14
 ud_5                -1.618961e-01 1 1  ON 15
 ud_6                -1.729129e-01 1 1  ON 16
 ud_7                -1.450640e-01 1 1  ON 17
 ud_8                -9.333995e-02 1 1  ON 18
 ud_9                 4.303742e-02 1 1  ON 19
 eO_0                -8.969352e-01 1 1  ON 20
 eO_1                -5.728358e-01 1 1  ON 21
 eO_2                -1.572153e-01 1 1  ON 22
 eO_3                 1.077871e-01 1 1  ON 23
 eO_4                 2.228621e-01 1 1  ON 24
 eO_5                 2.975278e-01 1 1  ON 25
 eO_6                 3.088391e-01 1 1  ON 26
 eO_7                 4.647868e-01 1 1  ON 27
 eO_8                 1.265946e-01 1 1  ON 28
 eO_9                 5.422093e-02 1 1  ON 29
eH1_0                -2.141429e-01 1 1  ON 30
eH1_1                -1.346270e-01 1 1  ON 31
eH1_2                -9.250081e-02 1 1  ON 32
eH1_3                -5.491945e-02 1 1  ON 33
eH1_4                -8.325027e-03 1 1  ON 34
eH1_5                 3.391305e-03 1 1  ON 35
eH1_6                 5.058132e-02 1 1  ON 36
eH1_7                 5.251085e-02 1 1  ON 37
eH1_8                 2.210256e-01 1 1  ON 38
eH1_9                 1.117702e-01 1 1  ON 39
eH2_0                -2.081006e-01 1 1  ON 40
eH2_1                -1.294130e-01 1 1  ON 41
eH2_2                -8.739511e-02 1 1  ON 42
eH2_3                -4.940404e-02 1 1  ON 43
eH2_4                -2.966363e-03 1 1  ON 44
eH2_5                 7.560060e-03 1 1  ON 45
eH2_6                 4.741739e-02 1 1  ON 46
eH2_7                 8.587211e-03 1 1  ON 47
eH2_8                 2.465238e-01 1 1  ON 48
eH2_9                 1.127331e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5673e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7296e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1913
    reference variance = 0.201703
====================================================
  Execution time = 1.9466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1961e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319682254850
                                         uncertainty =       0.003939731444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319682254850
                                         uncertainty =       0.003939731444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399758923
  error estimate for blocks of size 2^( 2) =       0.000409650100
  error estimate for blocks of size 2^( 3) =       0.000418780743
  error estimate for blocks of size 2^( 4) =       0.000425580831
  error estimate for blocks of size 2^( 5) =       0.000430356508
  error estimate for blocks of size 2^( 6) =       0.000432408920
  error estimate for blocks of size 2^( 7) =       0.000434980375

      target function =                  N/A
              le_mean =     -17.214145126893
             les_mean =     296.646406683669
             stat err =       0.000430831658
             autocorr =       1.161499115916
              std dev =       0.565344491209
             le_variance =       0.319614393741


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721414512689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214145126893       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214160170386       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214160394693       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214162762552       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214169228793       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214170873877       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214172759066       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214177655438       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214176870930       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214175584394       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214176534037       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214176400136       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214176438898       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214176545210       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 6.241263e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214145126893       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214154222378       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214155609630       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214155465609       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214160567475       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214161633963       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214161842801       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214163459834       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214163076987       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214162781961       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214162869999       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.714015e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214145126893       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214148650153       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214149793671       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214149489014       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214151867676       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214152124850       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214152045428       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214152354568       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214152306537       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 8.953934e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4841e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.933121e-01 1 1  ON 0
 uu_1                 2.879616e-02 1 1  ON 1
 uu_2                -6.949425e-02 1 1  ON 2
 uu_3                -1.269443e-01 1 1  ON 3
 uu_4                -1.621427e-01 1 1  ON 4
 uu_5                -1.732948e-01 1 1  ON 5
 uu_6                -1.583694e-01 1 1  ON 6
 uu_7                -1.114424e-01 1 1  ON 7
 uu_8                -3.668717e-02 1 1  ON 8
 uu_9                 2.145349e-01 1 1  ON 9
 ud_0                 3.539156e-01 1 1  ON 10
 ud_1                 9.300149e-02 1 1  ON 11
 ud_2                -1.914796e-02 1 1  ON 12
 ud_3                -7.981307e-02 1 1  ON 13
 ud_4                -1.275122e-01 1 1  ON 14
 ud_5                -1.620049e-01 1 1  ON 15
 ud_6                -1.727482e-01 1 1  ON 16
 ud_7                -1.451107e-01 1 1  ON 17
 ud_8                -9.336945e-02 1 1  ON 18
 ud_9                 4.293154e-02 1 1  ON 19
 eO_0                -8.996493e-01 1 1  ON 20
 eO_1                -5.737014e-01 1 1  ON 21
 eO_2                -1.557525e-01 1 1  ON 22
 eO_3                 1.098428e-01 1 1  ON 23
 eO_4                 2.230108e-01 1 1  ON 24
 eO_5                 2.974327e-01 1 1  ON 25
 eO_6                 3.088395e-01 1 1  ON 26
 eO_7                 4.646787e-01 1 1  ON 27
 eO_8                 1.266822e-01 1 1  ON 28
 eO_9                 5.424196e-02 1 1  ON 29
eH1_0                -2.142670e-01 1 1  ON 30
eH1_1                -1.346653e-01 1 1  ON 31
eH1_2                -9.234826e-02 1 1  ON 32
eH1_3                -5.450493e-02 1 1  ON 33
eH1_4                -8.062011e-03 1 1  ON 34
eH1_5                 3.447180e-03 1 1  ON 35
eH1_6                 5.006090e-02 1 1  ON 36
eH1_7                 5.235128e-02 1 1  ON 37
eH1_8                 2.209280e-01 1 1  ON 38
eH1_9                 1.117933e-01 1 1  ON 39
eH2_0                -2.081999e-01 1 1  ON 40
eH2_1                -1.297101e-01 1 1  ON 41
eH2_2                -8.747688e-02 1 1  ON 42
eH2_3                -4.937229e-02 1 1  ON 43
eH2_4                -3.250289e-03 1 1  ON 44
eH2_5                 7.684013e-03 1 1  ON 45
eH2_6                 4.759805e-02 1 1  ON 46
eH2_7                 9.080737e-03 1 1  ON 47
eH2_8                 2.464326e-01 1 1  ON 48
eH2_9                 1.127465e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2229
    reference variance = 0.24556
====================================================
  Execution time = 1.8935e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 5.8520e-01
  Total weights = 2.0000e+06
  Execution time = 1.7032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580571791668
                                         uncertainty =       0.257832507704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580571791668
                                         uncertainty =       0.257832507704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538557745
  error estimate for blocks of size 2^( 2) =       0.000546049968
  error estimate for blocks of size 2^( 3) =       0.000553130960
  error estimate for blocks of size 2^( 4) =       0.000558333773
  error estimate for blocks of size 2^( 5) =       0.000561564411
  error estimate for blocks of size 2^( 6) =       0.000563038702
  error estimate for blocks of size 2^( 7) =       0.000564298448

      target function =                  N/A
              le_mean =     -17.214200930437
             les_mean =     296.908802272304
             stat err =       0.000561808833
             autocorr =       1.088209656947
              std dev =       0.761635666766
             le_variance =       0.580088888890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.589404422049
                                         uncertainty =       0.263691455024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.589404422049
                                         uncertainty =       0.263691455024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000542638087
  error estimate for blocks of size 2^( 2) =       0.000550032083
  error estimate for blocks of size 2^( 3) =       0.000557002109
  error estimate for blocks of size 2^( 4) =       0.000562145608
  error estimate for blocks of size 2^( 5) =       0.000565355796
  error estimate for blocks of size 2^( 6) =       0.000566798340
  error estimate for blocks of size 2^( 7) =       0.000568112550

      target function =                  N/A
              le_mean =     -17.214190984742
             les_mean =     296.917283152353
             stat err =       0.000565603074
             autocorr =       1.086433066913
              std dev =       0.767406142550
             le_variance =       0.588912187623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.590916733174
                                         uncertainty =       0.264852137752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.590916733174
                                         uncertainty =       0.264852137752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543333523
  error estimate for blocks of size 2^( 2) =       0.000550711922
  error estimate for blocks of size 2^( 3) =       0.000557667305
  error estimate for blocks of size 2^( 4) =       0.000562809597
  error estimate for blocks of size 2^( 5) =       0.000566019697
  error estimate for blocks of size 2^( 6) =       0.000567456285
  error estimate for blocks of size 2^( 7) =       0.000568791525

      target function =                  N/A
              le_mean =     -17.214191471635
             les_mean =     296.918810361852
             stat err =       0.000566269276
             autocorr =       1.086207993943
              std dev =       0.768389637454
             le_variance =       0.590422634947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582656192969
                                         uncertainty =       0.259322178340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582656192969
                                         uncertainty =       0.259322178340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539523376
  error estimate for blocks of size 2^( 2) =       0.000546990371
  error estimate for blocks of size 2^( 3) =       0.000554044550
  error estimate for blocks of size 2^( 4) =       0.000559235329
  error estimate for blocks of size 2^( 5) =       0.000562461681
  error estimate for blocks of size 2^( 6) =       0.000563928474
  error estimate for blocks of size 2^( 7) =       0.000565203524

      target function =                  N/A
              le_mean =     -17.214193715697
             les_mean =     296.910635936312
             stat err =       0.000562707252
             autocorr =       1.087788573744
              std dev =       0.763001275137
             le_variance =       0.582170945861


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214200930437        initial  <--
     6.2500e-02     6.2500e-01             6.2413e-03       -17.214190984742
     2.5000e-01     2.5000e+00             2.7140e-03       -17.214191471635
     1.0000e+00     1.0000e+01             8.9539e-04       -17.214193715697

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.6264
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.931102e-01 1 1  ON 0
 uu_1                 2.860834e-02 1 1  ON 1
 uu_2                -6.940096e-02 1 1  ON 2
 uu_3                -1.267310e-01 1 1  ON 3
 uu_4                -1.622184e-01 1 1  ON 4
 uu_5                -1.735003e-01 1 1  ON 5
 uu_6                -1.580492e-01 1 1  ON 6
 uu_7                -1.114320e-01 1 1  ON 7
 uu_8                -3.666759e-02 1 1  ON 8
 uu_9                 2.146854e-01 1 1  ON 9
 ud_0                 3.522695e-01 1 1  ON 10
 ud_1                 9.214024e-02 1 1  ON 11
 ud_2                -1.861340e-02 1 1  ON 12
 ud_3                -7.864774e-02 1 1  ON 13
 ud_4                -1.267792e-01 1 1  ON 14
 ud_5                -1.618961e-01 1 1  ON 15
 ud_6                -1.729129e-01 1 1  ON 16
 ud_7                -1.450640e-01 1 1  ON 17
 ud_8                -9.333995e-02 1 1  ON 18
 ud_9                 4.303742e-02 1 1  ON 19
 eO_0                -8.969352e-01 1 1  ON 20
 eO_1                -5.728358e-01 1 1  ON 21
 eO_2                -1.572153e-01 1 1  ON 22
 eO_3                 1.077871e-01 1 1  ON 23
 eO_4                 2.228621e-01 1 1  ON 24
 eO_5                 2.975278e-01 1 1  ON 25
 eO_6                 3.088391e-01 1 1  ON 26
 eO_7                 4.647868e-01 1 1  ON 27
 eO_8                 1.265946e-01 1 1  ON 28
 eO_9                 5.422093e-02 1 1  ON 29
eH1_0                -2.141429e-01 1 1  ON 30
eH1_1                -1.346270e-01 1 1  ON 31
eH1_2                -9.250081e-02 1 1  ON 32
eH1_3                -5.491945e-02 1 1  ON 33
eH1_4                -8.325027e-03 1 1  ON 34
eH1_5                 3.391305e-03 1 1  ON 35
eH1_6                 5.058132e-02 1 1  ON 36
eH1_7                 5.251085e-02 1 1  ON 37
eH1_8                 2.210256e-01 1 1  ON 38
eH1_9                 1.117702e-01 1 1  ON 39
eH2_0                -2.081006e-01 1 1  ON 40
eH2_1                -1.294130e-01 1 1  ON 41
eH2_2                -8.739511e-02 1 1  ON 42
eH2_3                -4.940404e-02 1 1  ON 43
eH2_4                -2.966363e-03 1 1  ON 44
eH2_5                 7.560060e-03 1 1  ON 45
eH2_6                 4.741739e-02 1 1  ON 46
eH2_7                 8.587211e-03 1 1  ON 47
eH2_8                 2.465238e-01 1 1  ON 48
eH2_9                 1.127331e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2473e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7251e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1922
    reference variance = 0.2889
====================================================
  Execution time = 1.9231e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3340e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333465076130
                                         uncertainty =       0.010530812293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333465076130
                                         uncertainty =       0.010530812293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408290233
  error estimate for blocks of size 2^( 2) =       0.000418100516
  error estimate for blocks of size 2^( 3) =       0.000427077212
  error estimate for blocks of size 2^( 4) =       0.000433546989
  error estimate for blocks of size 2^( 5) =       0.000438917713
  error estimate for blocks of size 2^( 6) =       0.000440198195
  error estimate for blocks of size 2^( 7) =       0.000441944434

      target function =                  N/A
              le_mean =     -17.214616117312
             les_mean =     296.676409727763
             stat err =       0.000438651833
             autocorr =       1.154255403249
              std dev =       0.577409584298
             le_variance =       0.333401828039


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721461611731e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214616117312       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214617959588       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214618679734       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214619353289       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214624440381       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214625065891       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214625045316       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214624644097       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214624741044       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.100519e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214616117312       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214616743787       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214616960299       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214617106530       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214618630087       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214618860960       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214618840556       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214618816025       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 3.149186e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214616117312       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214616289431       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214616346930       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214616381274       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214616773014       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214616841385       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214616834615       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214616839811       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 8.207196e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227062 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4843e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.930882e-01 1 1  ON 0
 uu_1                 2.860644e-02 1 1  ON 1
 uu_2                -6.940926e-02 1 1  ON 2
 uu_3                -1.267579e-01 1 1  ON 3
 uu_4                -1.621993e-01 1 1  ON 4
 uu_5                -1.734660e-01 1 1  ON 5
 uu_6                -1.580648e-01 1 1  ON 6
 uu_7                -1.114173e-01 1 1  ON 7
 uu_8                -3.666216e-02 1 1  ON 8
 uu_9                 2.146702e-01 1 1  ON 9
 ud_0                 3.525493e-01 1 1  ON 10
 ud_1                 9.224025e-02 1 1  ON 11
 ud_2                -1.875212e-02 1 1  ON 12
 ud_3                -7.880504e-02 1 1  ON 13
 ud_4                -1.268421e-01 1 1  ON 14
 ud_5                -1.618816e-01 1 1  ON 15
 ud_6                -1.729223e-01 1 1  ON 16
 ud_7                -1.450796e-01 1 1  ON 17
 ud_8                -9.334183e-02 1 1  ON 18
 ud_9                 4.301886e-02 1 1  ON 19
 eO_0                -8.972502e-01 1 1  ON 20
 eO_1                -5.729289e-01 1 1  ON 21
 eO_2                -1.569962e-01 1 1  ON 22
 eO_3                 1.079695e-01 1 1  ON 23
 eO_4                 2.228704e-01 1 1  ON 24
 eO_5                 2.975200e-01 1 1  ON 25
 eO_6                 3.088457e-01 1 1  ON 26
 eO_7                 4.647774e-01 1 1  ON 27
 eO_8                 1.265995e-01 1 1  ON 28
 eO_9                 5.422173e-02 1 1  ON 29
eH1_0                -2.141386e-01 1 1  ON 30
eH1_1                -1.346437e-01 1 1  ON 31
eH1_2                -9.251643e-02 1 1  ON 32
eH1_3                -5.486785e-02 1 1  ON 33
eH1_4                -8.313955e-03 1 1  ON 34
eH1_5                 3.393155e-03 1 1  ON 35
eH1_6                 5.054021e-02 1 1  ON 36
eH1_7                 5.251175e-02 1 1  ON 37
eH1_8                 2.210215e-01 1 1  ON 38
eH1_9                 1.117738e-01 1 1  ON 39
eH2_0                -2.081411e-01 1 1  ON 40
eH2_1                -1.294392e-01 1 1  ON 41
eH2_2                -8.738356e-02 1 1  ON 42
eH2_3                -4.938132e-02 1 1  ON 43
eH2_4                -2.967559e-03 1 1  ON 44
eH2_5                 7.574722e-03 1 1  ON 45
eH2_6                 4.741687e-02 1 1  ON 46
eH2_7                 8.617574e-03 1 1  ON 47
eH2_8                 2.465121e-01 1 1  ON 48
eH2_9                 1.127327e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2014
    reference variance = 0.233601
====================================================
  Execution time = 1.9055e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2270e-01
  Total weights = 2.0000e+06
  Execution time = 1.6945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322448515773
                                         uncertainty =       0.004091968339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322448515773
                                         uncertainty =       0.004091968339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401513305
  error estimate for blocks of size 2^( 2) =       0.000411819829
  error estimate for blocks of size 2^( 3) =       0.000421170284
  error estimate for blocks of size 2^( 4) =       0.000427824815
  error estimate for blocks of size 2^( 5) =       0.000431920016
  error estimate for blocks of size 2^( 6) =       0.000434403693
  error estimate for blocks of size 2^( 7) =       0.000435193031

      target function =                  N/A
              le_mean =     -17.214366197547
             les_mean =     296.656829290304
             stat err =       0.000432335389
             autocorr =       1.159422407286
              std dev =       0.567825561488
             le_variance =       0.322425868279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323294570281
                                         uncertainty =       0.004094414424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323294570281
                                         uncertainty =       0.004094414424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402039985
  error estimate for blocks of size 2^( 2) =       0.000412306617
  error estimate for blocks of size 2^( 3) =       0.000421625033
  error estimate for blocks of size 2^( 4) =       0.000428259208
  error estimate for blocks of size 2^( 5) =       0.000432340412
  error estimate for blocks of size 2^( 6) =       0.000434804887
  error estimate for blocks of size 2^( 7) =       0.000435580120

      target function =                  N/A
              le_mean =     -17.214371341480
             les_mean =     296.657852819276
             stat err =       0.000432746157
             autocorr =       1.158585112753
              std dev =       0.568570398930
             le_variance =       0.323272298539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323001506902
                                         uncertainty =       0.004093863526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323001506902
                                         uncertainty =       0.004093863526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401857635
  error estimate for blocks of size 2^( 2) =       0.000412137416
  error estimate for blocks of size 2^( 3) =       0.000421466637
  error estimate for blocks of size 2^( 4) =       0.000428108276
  error estimate for blocks of size 2^( 5) =       0.000432194803
  error estimate for blocks of size 2^( 6) =       0.000434665406
  error estimate for blocks of size 2^( 7) =       0.000435444138

      target function =                  N/A
              le_mean =     -17.214369288648
             les_mean =     296.657488961281
             stat err =       0.000432603156
             autocorr =       1.158870530164
              std dev =       0.568312516855
             le_variance =       0.322979116814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322522716861
                                         uncertainty =       0.004092225974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322522716861
                                         uncertainty =       0.004092225974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401559526
  error estimate for blocks of size 2^( 2) =       0.000411862348
  error estimate for blocks of size 2^( 3) =       0.000421209877
  error estimate for blocks of size 2^( 4) =       0.000427862663
  error estimate for blocks of size 2^( 5) =       0.000431956717
  error estimate for blocks of size 2^( 6) =       0.000434438567
  error estimate for blocks of size 2^( 7) =       0.000435226404

      target function =                  N/A
              le_mean =     -17.214366523563
             les_mean =     296.656914751760
             stat err =       0.000432371088
             autocorr =       1.159346955375
              std dev =       0.567890927411
             le_variance =       0.322500105436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214366197547        initial
     6.2500e-01     6.2500e+00             1.1005e-03       -17.214371341480  <--
     2.5000e+00     2.5000e+01             3.1492e-04       -17.214369288648
     1.0000e+01     1.0000e+02             8.2072e-05       -17.214366523563

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.7599e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.930606e-01 1 1  ON 0
 uu_1                 2.860567e-02 1 1  ON 1
 uu_2                -6.945412e-02 1 1  ON 2
 uu_3                -1.268187e-01 1 1  ON 3
 uu_4                -1.621887e-01 1 1  ON 4
 uu_5                -1.733746e-01 1 1  ON 5
 uu_6                -1.580983e-01 1 1  ON 6
 uu_7                -1.113716e-01 1 1  ON 7
 uu_8                -3.664559e-02 1 1  ON 8
 uu_9                 2.146265e-01 1 1  ON 9
 ud_0                 3.531397e-01 1 1  ON 10
 ud_1                 9.245867e-02 1 1  ON 11
 ud_2                -1.899193e-02 1 1  ON 12
 ud_3                -7.916715e-02 1 1  ON 13
 ud_4                -1.270291e-01 1 1  ON 14
 ud_5                -1.618482e-01 1 1  ON 15
 ud_6                -1.729180e-01 1 1  ON 16
 ud_7                -1.451107e-01 1 1  ON 17
 ud_8                -9.334437e-02 1 1  ON 18
 ud_9                 4.296613e-02 1 1  ON 19
 eO_0                -8.980358e-01 1 1  ON 20
 eO_1                -5.731797e-01 1 1  ON 21
 eO_2                -1.565374e-01 1 1  ON 22
 eO_3                 1.084811e-01 1 1  ON 23
 eO_4                 2.229235e-01 1 1  ON 24
 eO_5                 2.975110e-01 1 1  ON 25
 eO_6                 3.088683e-01 1 1  ON 26
 eO_7                 4.647515e-01 1 1  ON 27
 eO_8                 1.266137e-01 1 1  ON 28
 eO_9                 5.422406e-02 1 1  ON 29
eH1_0                -2.141352e-01 1 1  ON 30
eH1_1                -1.346925e-01 1 1  ON 31
eH1_2                -9.252656e-02 1 1  ON 32
eH1_3                -5.476374e-02 1 1  ON 33
eH1_4                -8.284898e-03 1 1  ON 34
eH1_5                 3.409662e-03 1 1  ON 35
eH1_6                 5.043001e-02 1 1  ON 36
eH1_7                 5.251635e-02 1 1  ON 37
eH1_8                 2.210102e-01 1 1  ON 38
eH1_9                 1.117841e-01 1 1  ON 39
eH2_0                -2.082564e-01 1 1  ON 40
eH2_1                -1.295106e-01 1 1  ON 41
eH2_2                -8.734901e-02 1 1  ON 42
eH2_3                -4.933637e-02 1 1  ON 43
eH2_4                -2.974684e-03 1 1  ON 44
eH2_5                 7.624328e-03 1 1  ON 45
eH2_6                 4.742287e-02 1 1  ON 46
eH2_7                 8.707066e-03 1 1  ON 47
eH2_8                 2.464788e-01 1 1  ON 48
eH2_9                 1.127316e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7233e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2266
    reference variance = 0.319653
====================================================
  Execution time = 1.9672e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3360e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333580260482
                                         uncertainty =       0.004353892180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333580260482
                                         uncertainty =       0.004353892180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408413444
  error estimate for blocks of size 2^( 2) =       0.000418631231
  error estimate for blocks of size 2^( 3) =       0.000427326224
  error estimate for blocks of size 2^( 4) =       0.000433519755
  error estimate for blocks of size 2^( 5) =       0.000438144733
  error estimate for blocks of size 2^( 6) =       0.000440994905
  error estimate for blocks of size 2^( 7) =       0.000443108482

      target function =                  N/A
              le_mean =     -17.214664650319
             les_mean =     296.678281938694
             stat err =       0.000438941969
             autocorr =       1.155085560680
              std dev =       0.577583831614
             le_variance =       0.333603082541


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721466465032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214664650319       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214670553451       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214675935045       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214677638523       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214679083728       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214677944896       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214679784058       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214680014904       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214679837391       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214680220116       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214680006341       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214679902424       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.868063e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214664650319       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214667259438       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214670169794       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214670256117       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214671269216       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214670855456       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214671468671       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214671504097       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214671482111       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214671498460       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.026443e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214664650319       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214665457585       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214666458066       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214666450351       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214666777925       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214666658313       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214666811549       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214666812010       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214666810178       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.951206e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231018 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5140e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.931091e-01 1 1  ON 0
 uu_1                 2.860295e-02 1 1  ON 1
 uu_2                -6.953303e-02 1 1  ON 2
 uu_3                -1.269389e-01 1 1  ON 3
 uu_4                -1.621466e-01 1 1  ON 4
 uu_5                -1.731673e-01 1 1  ON 5
 uu_6                -1.582414e-01 1 1  ON 6
 uu_7                -1.113807e-01 1 1  ON 7
 uu_8                -3.661020e-02 1 1  ON 8
 uu_9                 2.145925e-01 1 1  ON 9
 ud_0                 3.537077e-01 1 1  ON 10
 ud_1                 9.280465e-02 1 1  ON 11
 ud_2                -1.915538e-02 1 1  ON 12
 ud_3                -7.971677e-02 1 1  ON 13
 ud_4                -1.274225e-01 1 1  ON 14
 ud_5                -1.618295e-01 1 1  ON 15
 ud_6                -1.726493e-01 1 1  ON 16
 ud_7                -1.451492e-01 1 1  ON 17
 ud_8                -9.337491e-02 1 1  ON 18
 ud_9                 4.291814e-02 1 1  ON 19
 eO_0                -8.990622e-01 1 1  ON 20
 eO_1                -5.734720e-01 1 1  ON 21
 eO_2                -1.560162e-01 1 1  ON 22
 eO_3                 1.091937e-01 1 1  ON 23
 eO_4                 2.229844e-01 1 1  ON 24
 eO_5                 2.974970e-01 1 1  ON 25
 eO_6                 3.089064e-01 1 1  ON 26
 eO_7                 4.647074e-01 1 1  ON 27
 eO_8                 1.266487e-01 1 1  ON 28
 eO_9                 5.423299e-02 1 1  ON 29
eH1_0                -2.142550e-01 1 1  ON 30
eH1_1                -1.348390e-01 1 1  ON 31
eH1_2                -9.259078e-02 1 1  ON 32
eH1_3                -5.451569e-02 1 1  ON 33
eH1_4                -8.053257e-03 1 1  ON 34
eH1_5                 3.482273e-03 1 1  ON 35
eH1_6                 5.024018e-02 1 1  ON 36
eH1_7                 5.249687e-02 1 1  ON 37
eH1_8                 2.209860e-01 1 1  ON 38
eH1_9                 1.117905e-01 1 1  ON 39
eH2_0                -2.084140e-01 1 1  ON 40
eH2_1                -1.295864e-01 1 1  ON 41
eH2_2                -8.738008e-02 1 1  ON 42
eH2_3                -4.922723e-02 1 1  ON 43
eH2_4                -2.988545e-03 1 1  ON 44
eH2_5                 7.591378e-03 1 1  ON 45
eH2_6                 4.749489e-02 1 1  ON 46
eH2_7                 8.890532e-03 1 1  ON 47
eH2_8                 2.464188e-01 1 1  ON 48
eH2_9                 1.127309e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2223
    reference variance = 0.183222
====================================================
  Execution time = 1.9114e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2732e-01
  Total weights = 2.0000e+06
  Execution time = 1.7032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326868875718
                                         uncertainty =       0.007853118223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326868875718
                                         uncertainty =       0.007853118223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404206912
  error estimate for blocks of size 2^( 2) =       0.000414718739
  error estimate for blocks of size 2^( 3) =       0.000423621162
  error estimate for blocks of size 2^( 4) =       0.000429917082
  error estimate for blocks of size 2^( 5) =       0.000433780543
  error estimate for blocks of size 2^( 6) =       0.000436930993
  error estimate for blocks of size 2^( 7) =       0.000437880345

      target function =                  N/A
              le_mean =     -17.215192135914
             les_mean =     296.689606568813
             stat err =       0.000434627241
             autocorr =       1.156182557959
              std dev =       0.571634897258
             le_variance =       0.326766455763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328269796041
                                         uncertainty =       0.007869690804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328269796041
                                         uncertainty =       0.007869690804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405071801
  error estimate for blocks of size 2^( 2) =       0.000415532581
  error estimate for blocks of size 2^( 3) =       0.000424368697
  error estimate for blocks of size 2^( 4) =       0.000430625309
  error estimate for blocks of size 2^( 5) =       0.000434476027
  error estimate for blocks of size 2^( 6) =       0.000437603233
  error estimate for blocks of size 2^( 7) =       0.000438518977

      target function =                  N/A
              le_mean =     -17.215197440988
             les_mean =     296.691189096075
             stat err =       0.000435305887
             autocorr =       1.154848616937
              std dev =       0.572858034736
             le_variance =       0.328166327962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327984423924
                                         uncertainty =       0.007865761591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327984423924
                                         uncertainty =       0.007865761591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404895741
  error estimate for blocks of size 2^( 2) =       0.000415364756
  error estimate for blocks of size 2^( 3) =       0.000424210992
  error estimate for blocks of size 2^( 4) =       0.000430473106
  error estimate for blocks of size 2^( 5) =       0.000434324615
  error estimate for blocks of size 2^( 6) =       0.000437456522
  error estimate for blocks of size 2^( 7) =       0.000438373008

      target function =                  N/A
              le_mean =     -17.215195653402
             les_mean =     296.690842343749
             stat err =       0.000435156813
             autocorr =       1.155061627293
              std dev =       0.572609048796
             le_variance =       0.327881122764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327031639800
                                         uncertainty =       0.007854930160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327031639800
                                         uncertainty =       0.007854930160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404307485
  error estimate for blocks of size 2^( 2) =       0.000414812357
  error estimate for blocks of size 2^( 3) =       0.000423705755
  error estimate for blocks of size 2^( 4) =       0.000429996141
  error estimate for blocks of size 2^( 5) =       0.000433857475
  error estimate for blocks of size 2^( 6) =       0.000437004954
  error estimate for blocks of size 2^( 7) =       0.000437948748

      target function =                  N/A
              le_mean =     -17.215191896210
             les_mean =     296.689760944827
             stat err =       0.000434701829
             autocorr =       1.156004095124
              std dev =       0.571777128755
             le_variance =       0.326929084967


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215192135914        initial
     1.5625e-01     1.5625e+00             2.8681e-03       -17.215197440988  <--
     6.2500e-01     6.2500e+00             1.0264e-03       -17.215195653402
     2.5000e+00     2.5000e+01             2.9512e-04       -17.215191896210

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.7698e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.933577e-01 1 1  ON 0
 uu_1                 2.869976e-02 1 1  ON 1
 uu_2                -6.961022e-02 1 1  ON 2
 uu_3                -1.271314e-01 1 1  ON 3
 uu_4                -1.622378e-01 1 1  ON 4
 uu_5                -1.729992e-01 1 1  ON 5
 uu_6                -1.585531e-01 1 1  ON 6
 uu_7                -1.113864e-01 1 1  ON 7
 uu_8                -3.650722e-02 1 1  ON 8
 uu_9                 2.144941e-01 1 1  ON 9
 ud_0                 3.545613e-01 1 1  ON 10
 ud_1                 9.324521e-02 1 1  ON 11
 ud_2                -1.931358e-02 1 1  ON 12
 ud_3                -8.044687e-02 1 1  ON 13
 ud_4                -1.281328e-01 1 1  ON 14
 ud_5                -1.619857e-01 1 1  ON 15
 ud_6                -1.720300e-01 1 1  ON 16
 ud_7                -1.451771e-01 1 1  ON 17
 ud_8                -9.343417e-02 1 1  ON 18
 ud_9                 4.278130e-02 1 1  ON 19
 eO_0                -9.009038e-01 1 1  ON 20
 eO_1                -5.742209e-01 1 1  ON 21
 eO_2                -1.553866e-01 1 1  ON 22
 eO_3                 1.105361e-01 1 1  ON 23
 eO_4                 2.234110e-01 1 1  ON 24
 eO_5                 2.975515e-01 1 1  ON 25
 eO_6                 3.090359e-01 1 1  ON 26
 eO_7                 4.645851e-01 1 1  ON 27
 eO_8                 1.267521e-01 1 1  ON 28
 eO_9                 5.425930e-02 1 1  ON 29
eH1_0                -2.145410e-01 1 1  ON 30
eH1_1                -1.350821e-01 1 1  ON 31
eH1_2                -9.256385e-02 1 1  ON 32
eH1_3                -5.415458e-02 1 1  ON 33
eH1_4                -7.632167e-03 1 1  ON 34
eH1_5                 3.745997e-03 1 1  ON 35
eH1_6                 4.977738e-02 1 1  ON 36
eH1_7                 5.245036e-02 1 1  ON 37
eH1_8                 2.209166e-01 1 1  ON 38
eH1_9                 1.118098e-01 1 1  ON 39
eH2_0                -2.087587e-01 1 1  ON 40
eH2_1                -1.297898e-01 1 1  ON 41
eH2_2                -8.740908e-02 1 1  ON 42
eH2_3                -4.912587e-02 1 1  ON 43
eH2_4                -3.073540e-03 1 1  ON 44
eH2_5                 7.507806e-03 1 1  ON 45
eH2_6                 4.774446e-02 1 1  ON 46
eH2_7                 9.436478e-03 1 1  ON 47
eH2_8                 2.462472e-01 1 1  ON 48
eH2_9                 1.127293e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2843e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2157
    reference variance = 0.204954
====================================================
  Execution time = 1.9596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3674e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797391446
                                         uncertainty =       0.012352758736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797391446
                                         uncertainty =       0.012352758736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410329033
  error estimate for blocks of size 2^( 2) =       0.000420247410
  error estimate for blocks of size 2^( 3) =       0.000428551524
  error estimate for blocks of size 2^( 4) =       0.000435608244
  error estimate for blocks of size 2^( 5) =       0.000439522620
  error estimate for blocks of size 2^( 6) =       0.000440608711
  error estimate for blocks of size 2^( 7) =       0.000442852579

      target function =                  N/A
              le_mean =     -17.215000307278
             les_mean =     296.692975241321
             stat err =       0.000439648038
             autocorr =       1.148010305514
              std dev =       0.580292883056
             le_variance =       0.336739830125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721500030728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215000307278       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215003300619       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215005160892       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215007680586       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215008586749       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215006648308       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215008464371       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215009608272       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215010026864       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215011246683       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215011832762       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215010916902       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215010646553       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.014218e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215000307278       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215002276382       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215003234650       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215005313684       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215004266757       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215005098873       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215005216852       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215005558567       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215005663771       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215005762761       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215005727494       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.089490e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215000307278       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215001138584       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215001459518       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215002114973       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215002052145       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215001991241       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215002281150       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215002284819       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.668928e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5082e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.933539e-01 1 1  ON 0
 uu_1                 2.862089e-02 1 1  ON 1
 uu_2                -6.970611e-02 1 1  ON 2
 uu_3                -1.272815e-01 1 1  ON 3
 uu_4                -1.623569e-01 1 1  ON 4
 uu_5                -1.731628e-01 1 1  ON 5
 uu_6                -1.586157e-01 1 1  ON 6
 uu_7                -1.109301e-01 1 1  ON 7
 uu_8                -3.631522e-02 1 1  ON 8
 uu_9                 2.142860e-01 1 1  ON 9
 ud_0                 3.550567e-01 1 1  ON 10
 ud_1                 9.346598e-02 1 1  ON 11
 ud_2                -1.947624e-02 1 1  ON 12
 ud_3                -8.084193e-02 1 1  ON 13
 ud_4                -1.285509e-01 1 1  ON 14
 ud_5                -1.624649e-01 1 1  ON 15
 ud_6                -1.717560e-01 1 1  ON 16
 ud_7                -1.449688e-01 1 1  ON 17
 ud_8                -9.332562e-02 1 1  ON 18
 ud_9                 4.276044e-02 1 1  ON 19
 eO_0                -9.029933e-01 1 1  ON 20
 eO_1                -5.753387e-01 1 1  ON 21
 eO_2                -1.551110e-01 1 1  ON 22
 eO_3                 1.119712e-01 1 1  ON 23
 eO_4                 2.243482e-01 1 1  ON 24
 eO_5                 2.977232e-01 1 1  ON 25
 eO_6                 3.092340e-01 1 1  ON 26
 eO_7                 4.645528e-01 1 1  ON 27
 eO_8                 1.269061e-01 1 1  ON 28
 eO_9                 5.430545e-02 1 1  ON 29
eH1_0                -2.142935e-01 1 1  ON 30
eH1_1                -1.349364e-01 1 1  ON 31
eH1_2                -9.220481e-02 1 1  ON 32
eH1_3                -5.397027e-02 1 1  ON 33
eH1_4                -8.293478e-03 1 1  ON 34
eH1_5                 3.721075e-03 1 1  ON 35
eH1_6                 4.950726e-02 1 1  ON 36
eH1_7                 5.238973e-02 1 1  ON 37
eH1_8                 2.208457e-01 1 1  ON 38
eH1_9                 1.118866e-01 1 1  ON 39
eH2_0                -2.091113e-01 1 1  ON 40
eH2_1                -1.299668e-01 1 1  ON 41
eH2_2                -8.716596e-02 1 1  ON 42
eH2_3                -4.928487e-02 1 1  ON 43
eH2_4                -3.309953e-03 1 1  ON 44
eH2_5                 7.356895e-03 1 1  ON 45
eH2_6                 4.795822e-02 1 1  ON 46
eH2_7                 1.011992e-02 1 1  ON 47
eH2_8                 2.461143e-01 1 1  ON 48
eH2_9                 1.127615e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.3634
    reference variance = 0.935222
====================================================
  Execution time = 1.8944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2946e-01
  Total weights = 2.0000e+06
  Execution time = 1.7021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328931765053
                                         uncertainty =       0.005259240468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328931765053
                                         uncertainty =       0.005259240468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405573927
  error estimate for blocks of size 2^( 2) =       0.000415632265
  error estimate for blocks of size 2^( 3) =       0.000424692514
  error estimate for blocks of size 2^( 4) =       0.000431277637
  error estimate for blocks of size 2^( 5) =       0.000436983539
  error estimate for blocks of size 2^( 6) =       0.000438748447
  error estimate for blocks of size 2^( 7) =       0.000439298764

      target function =                  N/A
              le_mean =     -17.214718739732
             les_mean =     296.675521544769
             stat err =       0.000436577097
             autocorr =       1.158728906010
              std dev =       0.573568148673
             le_variance =       0.328980421172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329864970755
                                         uncertainty =       0.005279418116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329864970755
                                         uncertainty =       0.005279418116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406148324
  error estimate for blocks of size 2^( 2) =       0.000416179862
  error estimate for blocks of size 2^( 3) =       0.000425203996
  error estimate for blocks of size 2^( 4) =       0.000431761253
  error estimate for blocks of size 2^( 5) =       0.000437449548
  error estimate for blocks of size 2^( 6) =       0.000439229923
  error estimate for blocks of size 2^( 7) =       0.000439749761

      target function =                  N/A
              le_mean =     -17.214717329480
             les_mean =     296.676405491309
             stat err =       0.000437047621
             autocorr =       1.157945690756
              std dev =       0.574380468287
             le_variance =       0.329912922350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329905849808
                                         uncertainty =       0.005280443042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329905849808
                                         uncertainty =       0.005280443042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406173400
  error estimate for blocks of size 2^( 2) =       0.000416200812
  error estimate for blocks of size 2^( 3) =       0.000425224759
  error estimate for blocks of size 2^( 4) =       0.000431781377
  error estimate for blocks of size 2^( 5) =       0.000437472480
  error estimate for blocks of size 2^( 6) =       0.000439255552
  error estimate for blocks of size 2^( 7) =       0.000439779775

      target function =                  N/A
              le_mean =     -17.214716679472
             les_mean =     296.676423851324
             stat err =       0.000437072296
             autocorr =       1.157933456387
              std dev =       0.574415931019
             le_variance =       0.329953661809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329106471811
                                         uncertainty =       0.005263168824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329106471811
                                         uncertainty =       0.005263168824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405681484
  error estimate for blocks of size 2^( 2) =       0.000415733125
  error estimate for blocks of size 2^( 3) =       0.000424786253
  error estimate for blocks of size 2^( 4) =       0.000431365846
  error estimate for blocks of size 2^( 5) =       0.000437068748
  error estimate for blocks of size 2^( 6) =       0.000438837313
  error estimate for blocks of size 2^( 7) =       0.000439383503

      target function =                  N/A
              le_mean =     -17.214717353793
             les_mean =     296.675648339996
             stat err =       0.000436663852
             autocorr =       1.158574887395
              std dev =       0.573720257249
             le_variance =       0.329154933578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214718739732        initial  <--
     3.9062e-02     3.9062e-01             5.0142e-03       -17.214717329480
     1.5625e-01     1.5625e+00             2.0895e-03       -17.214716679472
     6.2500e-01     6.2500e+00             6.6689e-04       -17.214717353793

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.5471
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.933577e-01 1 1  ON 0
 uu_1                 2.869976e-02 1 1  ON 1
 uu_2                -6.961022e-02 1 1  ON 2
 uu_3                -1.271314e-01 1 1  ON 3
 uu_4                -1.622378e-01 1 1  ON 4
 uu_5                -1.729992e-01 1 1  ON 5
 uu_6                -1.585531e-01 1 1  ON 6
 uu_7                -1.113864e-01 1 1  ON 7
 uu_8                -3.650722e-02 1 1  ON 8
 uu_9                 2.144941e-01 1 1  ON 9
 ud_0                 3.545613e-01 1 1  ON 10
 ud_1                 9.324521e-02 1 1  ON 11
 ud_2                -1.931358e-02 1 1  ON 12
 ud_3                -8.044687e-02 1 1  ON 13
 ud_4                -1.281328e-01 1 1  ON 14
 ud_5                -1.619857e-01 1 1  ON 15
 ud_6                -1.720300e-01 1 1  ON 16
 ud_7                -1.451771e-01 1 1  ON 17
 ud_8                -9.343417e-02 1 1  ON 18
 ud_9                 4.278130e-02 1 1  ON 19
 eO_0                -9.009038e-01 1 1  ON 20
 eO_1                -5.742209e-01 1 1  ON 21
 eO_2                -1.553866e-01 1 1  ON 22
 eO_3                 1.105361e-01 1 1  ON 23
 eO_4                 2.234110e-01 1 1  ON 24
 eO_5                 2.975515e-01 1 1  ON 25
 eO_6                 3.090359e-01 1 1  ON 26
 eO_7                 4.645851e-01 1 1  ON 27
 eO_8                 1.267521e-01 1 1  ON 28
 eO_9                 5.425930e-02 1 1  ON 29
eH1_0                -2.145410e-01 1 1  ON 30
eH1_1                -1.350821e-01 1 1  ON 31
eH1_2                -9.256385e-02 1 1  ON 32
eH1_3                -5.415458e-02 1 1  ON 33
eH1_4                -7.632167e-03 1 1  ON 34
eH1_5                 3.745997e-03 1 1  ON 35
eH1_6                 4.977738e-02 1 1  ON 36
eH1_7                 5.245036e-02 1 1  ON 37
eH1_8                 2.209166e-01 1 1  ON 38
eH1_9                 1.118098e-01 1 1  ON 39
eH2_0                -2.087587e-01 1 1  ON 40
eH2_1                -1.297898e-01 1 1  ON 41
eH2_2                -8.740908e-02 1 1  ON 42
eH2_3                -4.912587e-02 1 1  ON 43
eH2_4                -3.073540e-03 1 1  ON 44
eH2_5                 7.507806e-03 1 1  ON 45
eH2_6                 4.774446e-02 1 1  ON 46
eH2_7                 9.436478e-03 1 1  ON 47
eH2_8                 2.462472e-01 1 1  ON 48
eH2_9                 1.127293e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2636e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7243e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1821
    reference variance = 0.20566
====================================================
  Execution time = 1.9929e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2295e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871211472
                                         uncertainty =       0.003140274170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871211472
                                         uncertainty =       0.003140274170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401839814
  error estimate for blocks of size 2^( 2) =       0.000411878990
  error estimate for blocks of size 2^( 3) =       0.000421233858
  error estimate for blocks of size 2^( 4) =       0.000427667911
  error estimate for blocks of size 2^( 5) =       0.000433529884
  error estimate for blocks of size 2^( 6) =       0.000435819674
  error estimate for blocks of size 2^( 7) =       0.000437039207

      target function =                  N/A
              le_mean =     -17.214371366102
             les_mean =     296.657531840926
             stat err =       0.000433514169
             autocorr =       1.163859792226
              std dev =       0.568287314932
             le_variance =       0.322950472312


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721437136610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214371366102       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214372282353       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214372979015       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214374361210       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214376239334       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214375502243       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214375969990       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214375430681       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214375405340       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 9.742419e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214371366102       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214371658183       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214371906973       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214372389433       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214373095561       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214372887315       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214372963441       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214372849482       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.800839e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214371366102       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214371444516       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214371514861       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214371652124       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214371856917       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214371807816       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214371821591       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.189228e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237900 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5371e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.934055e-01 1 1  ON 0
 uu_1                 2.875301e-02 1 1  ON 1
 uu_2                -6.963032e-02 1 1  ON 2
 uu_3                -1.270818e-01 1 1  ON 3
 uu_4                -1.623301e-01 1 1  ON 4
 uu_5                -1.730668e-01 1 1  ON 5
 uu_6                -1.585510e-01 1 1  ON 6
 uu_7                -1.113724e-01 1 1  ON 7
 uu_8                -3.649747e-02 1 1  ON 8
 uu_9                 2.144751e-01 1 1  ON 9
 ud_0                 3.546946e-01 1 1  ON 10
 ud_1                 9.326676e-02 1 1  ON 11
 ud_2                -1.934320e-02 1 1  ON 12
 ud_3                -8.051213e-02 1 1  ON 13
 ud_4                -1.281651e-01 1 1  ON 14
 ud_5                -1.620021e-01 1 1  ON 15
 ud_6                -1.720253e-01 1 1  ON 16
 ud_7                -1.451867e-01 1 1  ON 17
 ud_8                -9.343657e-02 1 1  ON 18
 ud_9                 4.276610e-02 1 1  ON 19
 eO_0                -9.011839e-01 1 1  ON 20
 eO_1                -5.743225e-01 1 1  ON 21
 eO_2                -1.552847e-01 1 1  ON 22
 eO_3                 1.107677e-01 1 1  ON 23
 eO_4                 2.234444e-01 1 1  ON 24
 eO_5                 2.975369e-01 1 1  ON 25
 eO_6                 3.090580e-01 1 1  ON 26
 eO_7                 4.645772e-01 1 1  ON 27
 eO_8                 1.267634e-01 1 1  ON 28
 eO_9                 5.426156e-02 1 1  ON 29
eH1_0                -2.145023e-01 1 1  ON 30
eH1_1                -1.350634e-01 1 1  ON 31
eH1_2                -9.248696e-02 1 1  ON 32
eH1_3                -5.419628e-02 1 1  ON 33
eH1_4                -7.635829e-03 1 1  ON 34
eH1_5                 3.771745e-03 1 1  ON 35
eH1_6                 4.968055e-02 1 1  ON 36
eH1_7                 5.243957e-02 1 1  ON 37
eH1_8                 2.209085e-01 1 1  ON 38
eH1_9                 1.118096e-01 1 1  ON 39
eH2_0                -2.088025e-01 1 1  ON 40
eH2_1                -1.298344e-01 1 1  ON 41
eH2_2                -8.736450e-02 1 1  ON 42
eH2_3                -4.913199e-02 1 1  ON 43
eH2_4                -3.129414e-03 1 1  ON 44
eH2_5                 7.557280e-03 1 1  ON 45
eH2_6                 4.775667e-02 1 1  ON 46
eH2_7                 9.490261e-03 1 1  ON 47
eH2_8                 2.462318e-01 1 1  ON 48
eH2_9                 1.127296e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1747
    reference variance = 0.257358
====================================================
  Execution time = 1.9013e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2314e-01
  Total weights = 2.0000e+06
  Execution time = 1.6936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323052093553
                                         uncertainty =       0.003237941182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323052093553
                                         uncertainty =       0.003237941182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401868173
  error estimate for blocks of size 2^( 2) =       0.000411935867
  error estimate for blocks of size 2^( 3) =       0.000420822354
  error estimate for blocks of size 2^( 4) =       0.000426633771
  error estimate for blocks of size 2^( 5) =       0.000430629635
  error estimate for blocks of size 2^( 6) =       0.000433854170
  error estimate for blocks of size 2^( 7) =       0.000433390100

      target function =                  N/A
              le_mean =     -17.214732829094
             les_mean =     296.670022272836
             stat err =       0.000431126919
             autocorr =       1.150914484081
              std dev =       0.568327420822
             le_variance =       0.322996057258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323437710952
                                         uncertainty =       0.003243533956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323437710952
                                         uncertainty =       0.003243533956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402107936
  error estimate for blocks of size 2^( 2) =       0.000412165277
  error estimate for blocks of size 2^( 3) =       0.000421040089
  error estimate for blocks of size 2^( 4) =       0.000426840303
  error estimate for blocks of size 2^( 5) =       0.000430828800
  error estimate for blocks of size 2^( 6) =       0.000434050494
  error estimate for blocks of size 2^( 7) =       0.000433587294

      target function =                  N/A
              le_mean =     -17.214733227412
             les_mean =     296.670421513364
             stat err =       0.000431326723
             autocorr =       1.150608141076
              std dev =       0.568666496356
             le_variance =       0.323381584078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323334749220
                                         uncertainty =       0.003241707842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323334749220
                                         uncertainty =       0.003241707842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402043928
  error estimate for blocks of size 2^( 2) =       0.000412104135
  error estimate for blocks of size 2^( 3) =       0.000420982057
  error estimate for blocks of size 2^( 4) =       0.000426786351
  error estimate for blocks of size 2^( 5) =       0.000430776964
  error estimate for blocks of size 2^( 6) =       0.000434000177
  error estimate for blocks of size 2^( 7) =       0.000433537550

      target function =                  N/A
              le_mean =     -17.214733247268
             les_mean =     296.670319252823
             stat err =       0.000431275261
             autocorr =       1.150699906496
              std dev =       0.568575975449
             le_variance =       0.323278639858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323093202083
                                         uncertainty =       0.003238464201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323093202083
                                         uncertainty =       0.003238464201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401893739
  error estimate for blocks of size 2^( 2) =       0.000411960369
  error estimate for blocks of size 2^( 3) =       0.000420845598
  error estimate for blocks of size 2^( 4) =       0.000426656051
  error estimate for blocks of size 2^( 5) =       0.000430651162
  error estimate for blocks of size 2^( 6) =       0.000433875589
  error estimate for blocks of size 2^( 7) =       0.000433411846

      target function =                  N/A
              le_mean =     -17.214732878414
             les_mean =     296.670065068287
             stat err =       0.000431148662
             autocorr =       1.150884138641
              std dev =       0.568363576124
             le_variance =       0.323037154664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214732829094        initial
     3.9062e-01     3.9062e+00             9.7424e-04       -17.214733227412
     1.5625e+00     1.5625e+01             2.8008e-04       -17.214733247268  <--
     6.2500e+00     6.2500e+01             7.1892e-05       -17.214732878414

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.7558e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.934055e-01 1 1  ON 0
 uu_1                 2.875301e-02 1 1  ON 1
 uu_2                -6.963032e-02 1 1  ON 2
 uu_3                -1.270818e-01 1 1  ON 3
 uu_4                -1.623301e-01 1 1  ON 4
 uu_5                -1.730668e-01 1 1  ON 5
 uu_6                -1.585510e-01 1 1  ON 6
 uu_7                -1.113724e-01 1 1  ON 7
 uu_8                -3.649747e-02 1 1  ON 8
 uu_9                 2.144751e-01 1 1  ON 9
 ud_0                 3.546946e-01 1 1  ON 10
 ud_1                 9.326676e-02 1 1  ON 11
 ud_2                -1.934320e-02 1 1  ON 12
 ud_3                -8.051213e-02 1 1  ON 13
 ud_4                -1.281651e-01 1 1  ON 14
 ud_5                -1.620021e-01 1 1  ON 15
 ud_6                -1.720253e-01 1 1  ON 16
 ud_7                -1.451867e-01 1 1  ON 17
 ud_8                -9.343657e-02 1 1  ON 18
 ud_9                 4.276610e-02 1 1  ON 19
 eO_0                -9.011839e-01 1 1  ON 20
 eO_1                -5.743225e-01 1 1  ON 21
 eO_2                -1.552847e-01 1 1  ON 22
 eO_3                 1.107677e-01 1 1  ON 23
 eO_4                 2.234444e-01 1 1  ON 24
 eO_5                 2.975369e-01 1 1  ON 25
 eO_6                 3.090580e-01 1 1  ON 26
 eO_7                 4.645772e-01 1 1  ON 27
 eO_8                 1.267634e-01 1 1  ON 28
 eO_9                 5.426156e-02 1 1  ON 29
eH1_0                -2.145023e-01 1 1  ON 30
eH1_1                -1.350634e-01 1 1  ON 31
eH1_2                -9.248696e-02 1 1  ON 32
eH1_3                -5.419628e-02 1 1  ON 33
eH1_4                -7.635829e-03 1 1  ON 34
eH1_5                 3.771745e-03 1 1  ON 35
eH1_6                 4.968055e-02 1 1  ON 36
eH1_7                 5.243957e-02 1 1  ON 37
eH1_8                 2.209085e-01 1 1  ON 38
eH1_9                 1.118096e-01 1 1  ON 39
eH2_0                -2.088025e-01 1 1  ON 40
eH2_1                -1.298344e-01 1 1  ON 41
eH2_2                -8.736450e-02 1 1  ON 42
eH2_3                -4.913199e-02 1 1  ON 43
eH2_4                -3.129414e-03 1 1  ON 44
eH2_5                 7.557280e-03 1 1  ON 45
eH2_6                 4.775667e-02 1 1  ON 46
eH2_7                 9.490261e-03 1 1  ON 47
eH2_8                 2.462318e-01 1 1  ON 48
eH2_9                 1.127296e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2935e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7232e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1264
    reference variance = 0.467579
====================================================
  Execution time = 2.1646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3108e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4440e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331099028929
                                         uncertainty =       0.010759136822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331099028929
                                         uncertainty =       0.010759136822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406867260
  error estimate for blocks of size 2^( 2) =       0.000416522579
  error estimate for blocks of size 2^( 3) =       0.000425532380
  error estimate for blocks of size 2^( 4) =       0.000432368660
  error estimate for blocks of size 2^( 5) =       0.000436668972
  error estimate for blocks of size 2^( 6) =       0.000437981572
  error estimate for blocks of size 2^( 7) =       0.000440350296

      target function =                  N/A
              le_mean =     -17.214686951586
             les_mean =     296.676528610767
             stat err =       0.000436842375
             autocorr =       1.152773621517
              std dev =       0.575397197763
             le_variance =       0.331081935193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721468695159e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214686951586       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214687188539       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214687455255       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214688329552       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214688664309       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214688553681       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214688709614       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214688739223       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214688754420       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 8.090320e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214686951586       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214687028826       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214687161614       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214687482965       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214687585423       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214687539083       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214687593417       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214687578823       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.218456e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214686951586       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214686972484       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214687013868       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214687105329       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214687132607       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214687121129       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214687133886       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 5.518246e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240572 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7097e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.934349e-01 1 1  ON 0
 uu_1                 2.870614e-02 1 1  ON 1
 uu_2                -6.964805e-02 1 1  ON 2
 uu_3                -1.271016e-01 1 1  ON 3
 uu_4                -1.623594e-01 1 1  ON 4
 uu_5                -1.730505e-01 1 1  ON 5
 uu_6                -1.585246e-01 1 1  ON 6
 uu_7                -1.113398e-01 1 1  ON 7
 uu_8                -3.648892e-02 1 1  ON 8
 uu_9                 2.144577e-01 1 1  ON 9
 ud_0                 3.548548e-01 1 1  ON 10
 ud_1                 9.331059e-02 1 1  ON 11
 ud_2                -1.936811e-02 1 1  ON 12
 ud_3                -8.057549e-02 1 1  ON 13
 ud_4                -1.281940e-01 1 1  ON 14
 ud_5                -1.620230e-01 1 1  ON 15
 ud_6                -1.720279e-01 1 1  ON 16
 ud_7                -1.452359e-01 1 1  ON 17
 ud_8                -9.344202e-02 1 1  ON 18
 ud_9                 4.274985e-02 1 1  ON 19
 eO_0                -9.014058e-01 1 1  ON 20
 eO_1                -5.744514e-01 1 1  ON 21
 eO_2                -1.552157e-01 1 1  ON 22
 eO_3                 1.109659e-01 1 1  ON 23
 eO_4                 2.234988e-01 1 1  ON 24
 eO_5                 2.975505e-01 1 1  ON 25
 eO_6                 3.090654e-01 1 1  ON 26
 eO_7                 4.645698e-01 1 1  ON 27
 eO_8                 1.267771e-01 1 1  ON 28
 eO_9                 5.426339e-02 1 1  ON 29
eH1_0                -2.144397e-01 1 1  ON 30
eH1_1                -1.351120e-01 1 1  ON 31
eH1_2                -9.241945e-02 1 1  ON 32
eH1_3                -5.421779e-02 1 1  ON 33
eH1_4                -7.620709e-03 1 1  ON 34
eH1_5                 3.747386e-03 1 1  ON 35
eH1_6                 4.963003e-02 1 1  ON 36
eH1_7                 5.244151e-02 1 1  ON 37
eH1_8                 2.209051e-01 1 1  ON 38
eH1_9                 1.118094e-01 1 1  ON 39
eH2_0                -2.087898e-01 1 1  ON 40
eH2_1                -1.297880e-01 1 1  ON 41
eH2_2                -8.735143e-02 1 1  ON 42
eH2_3                -4.915239e-02 1 1  ON 43
eH2_4                -3.193291e-03 1 1  ON 44
eH2_5                 7.490311e-03 1 1  ON 45
eH2_6                 4.777396e-02 1 1  ON 46
eH2_7                 9.558025e-03 1 1  ON 47
eH2_8                 2.462189e-01 1 1  ON 48
eH2_9                 1.127332e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.189
    reference variance = 0.252891
====================================================
  Execution time = 1.9219e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3005e-01
  Total weights = 2.0000e+06
  Execution time = 1.7067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330031765149
                                         uncertainty =       0.007793032173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330031765149
                                         uncertainty =       0.007793032173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406145051
  error estimate for blocks of size 2^( 2) =       0.000415884586
  error estimate for blocks of size 2^( 3) =       0.000424832227
  error estimate for blocks of size 2^( 4) =       0.000430581155
  error estimate for blocks of size 2^( 5) =       0.000434530989
  error estimate for blocks of size 2^( 6) =       0.000437210053
  error estimate for blocks of size 2^( 7) =       0.000436822737

      target function =                  N/A
              le_mean =     -17.214473321558
             les_mean =     296.667999179059
             stat err =       0.000434786233
             autocorr =       1.146012190691
              std dev =       0.574375839816
             le_variance =       0.329907605364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330422795872
                                         uncertainty =       0.007809917939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330422795872
                                         uncertainty =       0.007809917939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406385553
  error estimate for blocks of size 2^( 2) =       0.000416113642
  error estimate for blocks of size 2^( 3) =       0.000425049947
  error estimate for blocks of size 2^( 4) =       0.000430790309
  error estimate for blocks of size 2^( 5) =       0.000434741994
  error estimate for blocks of size 2^( 6) =       0.000437413554
  error estimate for blocks of size 2^( 7) =       0.000437024001

      target function =                  N/A
              le_mean =     -17.214472218474
             les_mean =     296.668352030844
             stat err =       0.000434992465
             autocorr =       1.145742298032
              std dev =       0.574715960610
             le_variance =       0.330298435380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330320308834
                                         uncertainty =       0.007804644997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330320308834
                                         uncertainty =       0.007804644997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406322540
  error estimate for blocks of size 2^( 2) =       0.000416053274
  error estimate for blocks of size 2^( 3) =       0.000424992478
  error estimate for blocks of size 2^( 4) =       0.000430735747
  error estimate for blocks of size 2^( 5) =       0.000434687963
  error estimate for blocks of size 2^( 6) =       0.000437361382
  error estimate for blocks of size 2^( 7) =       0.000436972190

      target function =                  N/A
              le_mean =     -17.214472425104
             les_mean =     296.668256722846
             stat err =       0.000434939321
             autocorr =       1.145817665599
              std dev =       0.574626846990
             le_variance =       0.330196013281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330072786341
                                         uncertainty =       0.007794620695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330072786341
                                         uncertainty =       0.007794620695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406170289
  error estimate for blocks of size 2^( 2) =       0.000415908544
  error estimate for blocks of size 2^( 3) =       0.000424854961
  error estimate for blocks of size 2^( 4) =       0.000430603118
  error estimate for blocks of size 2^( 5) =       0.000434553326
  error estimate for blocks of size 2^( 6) =       0.000437231560
  error estimate for blocks of size 2^( 7) =       0.000436843966

      target function =                  N/A
              le_mean =     -17.214473169314
             les_mean =     296.668034939350
             stat err =       0.000434807993
             autocorr =       1.145984473765
              std dev =       0.574411531296
             le_variance =       0.329948607286


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214473321558        initial  <--
     3.9062e-01     3.9062e+00             8.0903e-04       -17.214472218474
     1.5625e+00     1.5625e+01             2.2185e-04       -17.214472425104
     6.2500e+00     6.2500e+01             5.5182e-05       -17.214473169314

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.8310
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.934055e-01 1 1  ON 0
 uu_1                 2.875301e-02 1 1  ON 1
 uu_2                -6.963032e-02 1 1  ON 2
 uu_3                -1.270818e-01 1 1  ON 3
 uu_4                -1.623301e-01 1 1  ON 4
 uu_5                -1.730668e-01 1 1  ON 5
 uu_6                -1.585510e-01 1 1  ON 6
 uu_7                -1.113724e-01 1 1  ON 7
 uu_8                -3.649747e-02 1 1  ON 8
 uu_9                 2.144751e-01 1 1  ON 9
 ud_0                 3.546946e-01 1 1  ON 10
 ud_1                 9.326676e-02 1 1  ON 11
 ud_2                -1.934320e-02 1 1  ON 12
 ud_3                -8.051213e-02 1 1  ON 13
 ud_4                -1.281651e-01 1 1  ON 14
 ud_5                -1.620021e-01 1 1  ON 15
 ud_6                -1.720253e-01 1 1  ON 16
 ud_7                -1.451867e-01 1 1  ON 17
 ud_8                -9.343657e-02 1 1  ON 18
 ud_9                 4.276610e-02 1 1  ON 19
 eO_0                -9.011839e-01 1 1  ON 20
 eO_1                -5.743225e-01 1 1  ON 21
 eO_2                -1.552847e-01 1 1  ON 22
 eO_3                 1.107677e-01 1 1  ON 23
 eO_4                 2.234444e-01 1 1  ON 24
 eO_5                 2.975369e-01 1 1  ON 25
 eO_6                 3.090580e-01 1 1  ON 26
 eO_7                 4.645772e-01 1 1  ON 27
 eO_8                 1.267634e-01 1 1  ON 28
 eO_9                 5.426156e-02 1 1  ON 29
eH1_0                -2.145023e-01 1 1  ON 30
eH1_1                -1.350634e-01 1 1  ON 31
eH1_2                -9.248696e-02 1 1  ON 32
eH1_3                -5.419628e-02 1 1  ON 33
eH1_4                -7.635829e-03 1 1  ON 34
eH1_5                 3.771745e-03 1 1  ON 35
eH1_6                 4.968055e-02 1 1  ON 36
eH1_7                 5.243957e-02 1 1  ON 37
eH1_8                 2.209085e-01 1 1  ON 38
eH1_9                 1.118096e-01 1 1  ON 39
eH2_0                -2.088025e-01 1 1  ON 40
eH2_1                -1.298344e-01 1 1  ON 41
eH2_2                -8.736450e-02 1 1  ON 42
eH2_3                -4.913199e-02 1 1  ON 43
eH2_4                -3.129414e-03 1 1  ON 44
eH2_5                 7.557280e-03 1 1  ON 45
eH2_6                 4.775667e-02 1 1  ON 46
eH2_7                 9.490261e-03 1 1  ON 47
eH2_8                 2.462318e-01 1 1  ON 48
eH2_9                 1.127296e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4934e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.211
    reference variance = 0.324809
====================================================
  Execution time = 1.9476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2357e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323478633149
                                         uncertainty =       0.002589269991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323478633149
                                         uncertainty =       0.002589269991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402222826
  error estimate for blocks of size 2^( 2) =       0.000412858094
  error estimate for blocks of size 2^( 3) =       0.000422306498
  error estimate for blocks of size 2^( 4) =       0.000428806948
  error estimate for blocks of size 2^( 5) =       0.000433220650
  error estimate for blocks of size 2^( 6) =       0.000435261255
  error estimate for blocks of size 2^( 7) =       0.000434470273

      target function =                  N/A
              le_mean =     -17.215185001533
             les_mean =     296.686160879250
             stat err =       0.000432939781
             autocorr =       1.158568083586
              std dev =       0.568828976073
             le_variance =       0.323566404021


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721518500153e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215185001533       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215185205161       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215185420649       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215185366830       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215185395524       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215185344538       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215185381660       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 9.929443e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215185001533       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215185054208       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215185111584       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215185096976       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215185101564       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215185089646       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215185099251       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.529075e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215185001533       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215185014817       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215185029396       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215185025673       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215185026628       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215185023704       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215185026125       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 6.351768e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242802 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5056e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.933985e-01 1 1  ON 0
 uu_1                 2.874352e-02 1 1  ON 1
 uu_2                -6.963181e-02 1 1  ON 2
 uu_3                -1.270787e-01 1 1  ON 3
 uu_4                -1.623298e-01 1 1  ON 4
 uu_5                -1.730571e-01 1 1  ON 5
 uu_6                -1.585471e-01 1 1  ON 6
 uu_7                -1.113723e-01 1 1  ON 7
 uu_8                -3.649724e-02 1 1  ON 8
 uu_9                 2.144732e-01 1 1  ON 9
 ud_0                 3.547128e-01 1 1  ON 10
 ud_1                 9.327466e-02 1 1  ON 11
 ud_2                -1.934558e-02 1 1  ON 12
 ud_3                -8.051760e-02 1 1  ON 13
 ud_4                -1.281743e-01 1 1  ON 14
 ud_5                -1.620048e-01 1 1  ON 15
 ud_6                -1.720272e-01 1 1  ON 16
 ud_7                -1.451920e-01 1 1  ON 17
 ud_8                -9.343728e-02 1 1  ON 18
 ud_9                 4.276528e-02 1 1  ON 19
 eO_0                -9.012055e-01 1 1  ON 20
 eO_1                -5.743314e-01 1 1  ON 21
 eO_2                -1.552807e-01 1 1  ON 22
 eO_3                 1.107930e-01 1 1  ON 23
 eO_4                 2.234456e-01 1 1  ON 24
 eO_5                 2.975359e-01 1 1  ON 25
 eO_6                 3.090588e-01 1 1  ON 26
 eO_7                 4.645757e-01 1 1  ON 27
 eO_8                 1.267646e-01 1 1  ON 28
 eO_9                 5.426189e-02 1 1  ON 29
eH1_0                -2.145005e-01 1 1  ON 30
eH1_1                -1.350576e-01 1 1  ON 31
eH1_2                -9.248495e-02 1 1  ON 32
eH1_3                -5.419634e-02 1 1  ON 33
eH1_4                -7.642034e-03 1 1  ON 34
eH1_5                 3.772199e-03 1 1  ON 35
eH1_6                 4.967443e-02 1 1  ON 36
eH1_7                 5.244109e-02 1 1  ON 37
eH1_8                 2.209084e-01 1 1  ON 38
eH1_9                 1.118099e-01 1 1  ON 39
eH2_0                -2.088048e-01 1 1  ON 40
eH2_1                -1.298396e-01 1 1  ON 41
eH2_2                -8.736167e-02 1 1  ON 42
eH2_3                -4.913356e-02 1 1  ON 43
eH2_4                -3.126506e-03 1 1  ON 44
eH2_5                 7.558466e-03 1 1  ON 45
eH2_6                 4.775476e-02 1 1  ON 46
eH2_7                 9.495194e-03 1 1  ON 47
eH2_8                 2.462304e-01 1 1  ON 48
eH2_9                 1.127298e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2074
    reference variance = 0.397311
====================================================
  Execution time = 1.9107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3539e-01
  Total weights = 2.0000e+06
  Execution time = 1.6958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335415391371
                                         uncertainty =       0.007505332610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335415391371
                                         uncertainty =       0.007505332610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409499222
  error estimate for blocks of size 2^( 2) =       0.000419188162
  error estimate for blocks of size 2^( 3) =       0.000428106670
  error estimate for blocks of size 2^( 4) =       0.000435178316
  error estimate for blocks of size 2^( 5) =       0.000439324145
  error estimate for blocks of size 2^( 6) =       0.000440895891
  error estimate for blocks of size 2^( 7) =       0.000441304285

      target function =                  N/A
              le_mean =     -17.214186250127
             les_mean =     296.663587311472
             stat err =       0.000439175659
             autocorr =       1.150192051779
              std dev =       0.579119353059
             le_variance =       0.335379225087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335458020899
                                         uncertainty =       0.007505561937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335458020899
                                         uncertainty =       0.007505561937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409525261
  error estimate for blocks of size 2^( 2) =       0.000419212604
  error estimate for blocks of size 2^( 3) =       0.000428129744
  error estimate for blocks of size 2^( 4) =       0.000435199894
  error estimate for blocks of size 2^( 5) =       0.000439345518
  error estimate for blocks of size 2^( 6) =       0.000440916342
  error estimate for blocks of size 2^( 7) =       0.000441325648

      target function =                  N/A
              le_mean =     -17.214186119908
             les_mean =     296.663625482463
             stat err =       0.000439196851
             autocorr =       1.150156775783
              std dev =       0.579156178710
             le_variance =       0.335421879339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335437754496
                                         uncertainty =       0.007505450272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335437754496
                                         uncertainty =       0.007505450272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409512882
  error estimate for blocks of size 2^( 2) =       0.000419200972
  error estimate for blocks of size 2^( 3) =       0.000428118754
  error estimate for blocks of size 2^( 4) =       0.000435189610
  error estimate for blocks of size 2^( 5) =       0.000439335338
  error estimate for blocks of size 2^( 6) =       0.000440906617
  error estimate for blocks of size 2^( 7) =       0.000441315500

      target function =                  N/A
              le_mean =     -17.214186184430
             les_mean =     296.663607425792
             stat err =       0.000439186766
             autocorr =       1.150173492921
              std dev =       0.579138671885
             le_variance =       0.335401601273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335418220271
                                         uncertainty =       0.007505347406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335418220271
                                         uncertainty =       0.007505347406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409500950
  error estimate for blocks of size 2^( 2) =       0.000419189782
  error estimate for blocks of size 2^( 3) =       0.000428108198
  error estimate for blocks of size 2^( 4) =       0.000435179743
  error estimate for blocks of size 2^( 5) =       0.000439325560
  error estimate for blocks of size 2^( 6) =       0.000440897247
  error estimate for blocks of size 2^( 7) =       0.000441305703

      target function =                  N/A
              le_mean =     -17.214186241616
             les_mean =     296.663589848997
             stat err =       0.000439177063
             autocorr =       1.150189699164
              std dev =       0.579121796899
             le_variance =       0.335382055643


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214186250127        initial  <--
     3.9062e+00     3.9062e+01             9.9294e-05       -17.214186119908
     1.5625e+01     1.5625e+02             2.5291e-05       -17.214186184430
     6.2500e+01     6.2500e+02             6.3518e-06       -17.214186241616

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.6684
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.934055e-01 1 1  ON 0
 uu_1                 2.875301e-02 1 1  ON 1
 uu_2                -6.963032e-02 1 1  ON 2
 uu_3                -1.270818e-01 1 1  ON 3
 uu_4                -1.623301e-01 1 1  ON 4
 uu_5                -1.730668e-01 1 1  ON 5
 uu_6                -1.585510e-01 1 1  ON 6
 uu_7                -1.113724e-01 1 1  ON 7
 uu_8                -3.649747e-02 1 1  ON 8
 uu_9                 2.144751e-01 1 1  ON 9
 ud_0                 3.546946e-01 1 1  ON 10
 ud_1                 9.326676e-02 1 1  ON 11
 ud_2                -1.934320e-02 1 1  ON 12
 ud_3                -8.051213e-02 1 1  ON 13
 ud_4                -1.281651e-01 1 1  ON 14
 ud_5                -1.620021e-01 1 1  ON 15
 ud_6                -1.720253e-01 1 1  ON 16
 ud_7                -1.451867e-01 1 1  ON 17
 ud_8                -9.343657e-02 1 1  ON 18
 ud_9                 4.276610e-02 1 1  ON 19
 eO_0                -9.011839e-01 1 1  ON 20
 eO_1                -5.743225e-01 1 1  ON 21
 eO_2                -1.552847e-01 1 1  ON 22
 eO_3                 1.107677e-01 1 1  ON 23
 eO_4                 2.234444e-01 1 1  ON 24
 eO_5                 2.975369e-01 1 1  ON 25
 eO_6                 3.090580e-01 1 1  ON 26
 eO_7                 4.645772e-01 1 1  ON 27
 eO_8                 1.267634e-01 1 1  ON 28
 eO_9                 5.426156e-02 1 1  ON 29
eH1_0                -2.145023e-01 1 1  ON 30
eH1_1                -1.350634e-01 1 1  ON 31
eH1_2                -9.248696e-02 1 1  ON 32
eH1_3                -5.419628e-02 1 1  ON 33
eH1_4                -7.635829e-03 1 1  ON 34
eH1_5                 3.771745e-03 1 1  ON 35
eH1_6                 4.968055e-02 1 1  ON 36
eH1_7                 5.243957e-02 1 1  ON 37
eH1_8                 2.209085e-01 1 1  ON 38
eH1_9                 1.118096e-01 1 1  ON 39
eH2_0                -2.088025e-01 1 1  ON 40
eH2_1                -1.298344e-01 1 1  ON 41
eH2_2                -8.736450e-02 1 1  ON 42
eH2_3                -4.913199e-02 1 1  ON 43
eH2_4                -3.129414e-03 1 1  ON 44
eH2_5                 7.557280e-03 1 1  ON 45
eH2_6                 4.775667e-02 1 1  ON 46
eH2_7                 9.490261e-03 1 1  ON 47
eH2_8                 2.462318e-01 1 1  ON 48
eH2_9                 1.127296e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2134
    reference variance = 0.775107
====================================================
  Execution time = 1.9452e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2115e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321198967383
                                         uncertainty =       0.003967407197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321198967383
                                         uncertainty =       0.003967407197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400717066
  error estimate for blocks of size 2^( 2) =       0.000410800518
  error estimate for blocks of size 2^( 3) =       0.000419539989
  error estimate for blocks of size 2^( 4) =       0.000425525334
  error estimate for blocks of size 2^( 5) =       0.000429881523
  error estimate for blocks of size 2^( 6) =       0.000433276118
  error estimate for blocks of size 2^( 7) =       0.000435875874

      target function =                  N/A
              le_mean =     -17.214315605371
             les_mean =     296.653809934681
             stat err =       0.000431139712
             autocorr =       1.157604954820
              std dev =       0.566699509382
             le_variance =       0.321148333934


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721431560537e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214315605371       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214315583154       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214315576357       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214315568130       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214315571026       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214315581968       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214315578807       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.061836e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214315605371       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214315599779       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214315598075       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214315596002       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214315596724       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214315599455       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214315598677       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.657484e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214315605371       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214315603971       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214315603544       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214315603025       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214315603205       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214315603888       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214315603694       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 6.645514e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245035 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4878e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.934053e-01 1 1  ON 0
 uu_1                 2.875300e-02 1 1  ON 1
 uu_2                -6.963088e-02 1 1  ON 2
 uu_3                -1.270819e-01 1 1  ON 3
 uu_4                -1.623308e-01 1 1  ON 4
 uu_5                -1.730669e-01 1 1  ON 5
 uu_6                -1.585504e-01 1 1  ON 6
 uu_7                -1.113717e-01 1 1  ON 7
 uu_8                -3.649720e-02 1 1  ON 8
 uu_9                 2.144749e-01 1 1  ON 9
 ud_0                 3.546960e-01 1 1  ON 10
 ud_1                 9.326738e-02 1 1  ON 11
 ud_2                -1.934400e-02 1 1  ON 12
 ud_3                -8.051290e-02 1 1  ON 13
 ud_4                -1.281659e-01 1 1  ON 14
 ud_5                -1.620028e-01 1 1  ON 15
 ud_6                -1.720249e-01 1 1  ON 16
 ud_7                -1.451864e-01 1 1  ON 17
 ud_8                -9.343645e-02 1 1  ON 18
 ud_9                 4.276602e-02 1 1  ON 19
 eO_0                -9.011866e-01 1 1  ON 20
 eO_1                -5.743243e-01 1 1  ON 21
 eO_2                -1.552837e-01 1 1  ON 22
 eO_3                 1.107699e-01 1 1  ON 23
 eO_4                 2.234449e-01 1 1  ON 24
 eO_5                 2.975370e-01 1 1  ON 25
 eO_6                 3.090585e-01 1 1  ON 26
 eO_7                 4.645773e-01 1 1  ON 27
 eO_8                 1.267635e-01 1 1  ON 28
 eO_9                 5.426160e-02 1 1  ON 29
eH1_0                -2.145021e-01 1 1  ON 30
eH1_1                -1.350633e-01 1 1  ON 31
eH1_2                -9.248668e-02 1 1  ON 32
eH1_3                -5.419658e-02 1 1  ON 33
eH1_4                -7.636462e-03 1 1  ON 34
eH1_5                 3.772221e-03 1 1  ON 35
eH1_6                 4.968021e-02 1 1  ON 36
eH1_7                 5.243977e-02 1 1  ON 37
eH1_8                 2.209086e-01 1 1  ON 38
eH1_9                 1.118096e-01 1 1  ON 39
eH2_0                -2.088027e-01 1 1  ON 40
eH2_1                -1.298341e-01 1 1  ON 41
eH2_2                -8.736386e-02 1 1  ON 42
eH2_3                -4.913237e-02 1 1  ON 43
eH2_4                -3.129473e-03 1 1  ON 44
eH2_5                 7.556482e-03 1 1  ON 45
eH2_6                 4.775642e-02 1 1  ON 46
eH2_7                 9.490981e-03 1 1  ON 47
eH2_8                 2.462317e-01 1 1  ON 48
eH2_9                 1.127296e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1795
    reference variance = 0.195129
====================================================
  Execution time = 1.9396e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1975e-01
  Total weights = 2.0000e+06
  Execution time = 1.6938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319691164359
                                         uncertainty =       0.003025028806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319691164359
                                         uncertainty =       0.003025028806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399841213
  error estimate for blocks of size 2^( 2) =       0.000409938867
  error estimate for blocks of size 2^( 3) =       0.000418955720
  error estimate for blocks of size 2^( 4) =       0.000425307498
  error estimate for blocks of size 2^( 5) =       0.000429727555
  error estimate for blocks of size 2^( 6) =       0.000431632678
  error estimate for blocks of size 2^( 7) =       0.000434142812

      target function =                  N/A
              le_mean =     -17.214800670708
             les_mean =     296.669107964171
             stat err =       0.000430202636
             autocorr =       1.157633324623
              std dev =       0.565460866757
             le_variance =       0.319745991833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319697313954
                                         uncertainty =       0.003025072008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319697313954
                                         uncertainty =       0.003025072008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399845059
  error estimate for blocks of size 2^( 2) =       0.000409942503
  error estimate for blocks of size 2^( 3) =       0.000418959153
  error estimate for blocks of size 2^( 4) =       0.000425310716
  error estimate for blocks of size 2^( 5) =       0.000429730693
  error estimate for blocks of size 2^( 6) =       0.000431635628
  error estimate for blocks of size 2^( 7) =       0.000434145696

      target function =                  N/A
              le_mean =     -17.214800678401
             les_mean =     296.669114379750
             stat err =       0.000430205683
             autocorr =       1.157627458574
              std dev =       0.565466305409
             le_variance =       0.319752142553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319694254902
                                         uncertainty =       0.003025050655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319694254902
                                         uncertainty =       0.003025050655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399843146
  error estimate for blocks of size 2^( 2) =       0.000409940694
  error estimate for blocks of size 2^( 3) =       0.000418957445
  error estimate for blocks of size 2^( 4) =       0.000425309115
  error estimate for blocks of size 2^( 5) =       0.000429729132
  error estimate for blocks of size 2^( 6) =       0.000431634160
  error estimate for blocks of size 2^( 7) =       0.000434144261

      target function =                  N/A
              le_mean =     -17.214800674423
             les_mean =     296.669111183193
             stat err =       0.000430204167
             autocorr =       1.157630374109
              std dev =       0.565463600020
             le_variance =       0.319749082947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319691551154
                                         uncertainty =       0.003025031545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319691551154
                                         uncertainty =       0.003025031545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399841455
  error estimate for blocks of size 2^( 2) =       0.000409939096
  error estimate for blocks of size 2^( 3) =       0.000418955936
  error estimate for blocks of size 2^( 4) =       0.000425307701
  error estimate for blocks of size 2^( 5) =       0.000429727752
  error estimate for blocks of size 2^( 6) =       0.000431632863
  error estimate for blocks of size 2^( 7) =       0.000434142993

      target function =                  N/A
              le_mean =     -17.214800671166
             les_mean =     296.669108366788
             stat err =       0.000430202827
             autocorr =       1.157632955255
              std dev =       0.565461208838
             le_variance =       0.319746378700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214800670708        initial
     3.9062e+01     3.9062e+02             1.0618e-05       -17.214800678401  <--
     1.5625e+02     1.5625e+03             2.6575e-06       -17.214800674423
     6.2500e+02     6.2500e+03             6.6455e-07       -17.214800671166

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.7943e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.934047e-01 1 1  ON 0
 uu_1                 2.875294e-02 1 1  ON 1
 uu_2                -6.963255e-02 1 1  ON 2
 uu_3                -1.270821e-01 1 1  ON 3
 uu_4                -1.623330e-01 1 1  ON 4
 uu_5                -1.730672e-01 1 1  ON 5
 uu_6                -1.585487e-01 1 1  ON 6
 uu_7                -1.113697e-01 1 1  ON 7
 uu_8                -3.649637e-02 1 1  ON 8
 uu_9                 2.144745e-01 1 1  ON 9
 ud_0                 3.547003e-01 1 1  ON 10
 ud_1                 9.326922e-02 1 1  ON 11
 ud_2                -1.934636e-02 1 1  ON 12
 ud_3                -8.051522e-02 1 1  ON 13
 ud_4                -1.281685e-01 1 1  ON 14
 ud_5                -1.620049e-01 1 1  ON 15
 ud_6                -1.720235e-01 1 1  ON 16
 ud_7                -1.451855e-01 1 1  ON 17
 ud_8                -9.343608e-02 1 1  ON 18
 ud_9                 4.276580e-02 1 1  ON 19
 eO_0                -9.011945e-01 1 1  ON 20
 eO_1                -5.743298e-01 1 1  ON 21
 eO_2                -1.552807e-01 1 1  ON 22
 eO_3                 1.107767e-01 1 1  ON 23
 eO_4                 2.234464e-01 1 1  ON 24
 eO_5                 2.975371e-01 1 1  ON 25
 eO_6                 3.090599e-01 1 1  ON 26
 eO_7                 4.645773e-01 1 1  ON 27
 eO_8                 1.267638e-01 1 1  ON 28
 eO_9                 5.426171e-02 1 1  ON 29
eH1_0                -2.145015e-01 1 1  ON 30
eH1_1                -1.350631e-01 1 1  ON 31
eH1_2                -9.248584e-02 1 1  ON 32
eH1_3                -5.419749e-02 1 1  ON 33
eH1_4                -7.638363e-03 1 1  ON 34
eH1_5                 3.773645e-03 1 1  ON 35
eH1_6                 4.967918e-02 1 1  ON 36
eH1_7                 5.244037e-02 1 1  ON 37
eH1_8                 2.209086e-01 1 1  ON 38
eH1_9                 1.118097e-01 1 1  ON 39
eH2_0                -2.088034e-01 1 1  ON 40
eH2_1                -1.298332e-01 1 1  ON 41
eH2_2                -8.736196e-02 1 1  ON 42
eH2_3                -4.913353e-02 1 1  ON 43
eH2_4                -3.129654e-03 1 1  ON 44
eH2_5                 7.554092e-03 1 1  ON 45
eH2_6                 4.775565e-02 1 1  ON 46
eH2_7                 9.493137e-03 1 1  ON 47
eH2_8                 2.462317e-01 1 1  ON 48
eH2_9                 1.127298e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2826e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2149
    reference variance = 0.14647
====================================================
  Execution time = 1.9466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2307e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323064046611
                                         uncertainty =       0.003488895225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323064046611
                                         uncertainty =       0.003488895225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401911186
  error estimate for blocks of size 2^( 2) =       0.000411995162
  error estimate for blocks of size 2^( 3) =       0.000420844424
  error estimate for blocks of size 2^( 4) =       0.000426610077
  error estimate for blocks of size 2^( 5) =       0.000429997841
  error estimate for blocks of size 2^( 6) =       0.000431772552
  error estimate for blocks of size 2^( 7) =       0.000433219442

      target function =                  N/A
              le_mean =     -17.214660418560
             les_mean =     296.667598368158
             stat err =       0.000430399978
             autocorr =       1.146791044755
              std dev =       0.568388250552
             le_variance =       0.323065203366


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721466041856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214660418560       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214660488178       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214660604651       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214660555140       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214660520441       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214660537818       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214660544284       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.527875e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214660418560       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214660436186       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214660466013       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214660453598       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214660445004       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214660448878       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214660450742       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.141851e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214660418560       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214660422980       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214660430483       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214660427377       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214660425236       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214660426170       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214660426656       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.860895e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247266 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4909e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.934068e-01 1 1  ON 0
 uu_1                 2.875455e-02 1 1  ON 1
 uu_2                -6.963329e-02 1 1  ON 2
 uu_3                -1.270842e-01 1 1  ON 3
 uu_4                -1.623343e-01 1 1  ON 4
 uu_5                -1.730687e-01 1 1  ON 5
 uu_6                -1.585488e-01 1 1  ON 6
 uu_7                -1.113687e-01 1 1  ON 7
 uu_8                -3.649572e-02 1 1  ON 8
 uu_9                 2.144739e-01 1 1  ON 9
 ud_0                 3.547019e-01 1 1  ON 10
 ud_1                 9.327018e-02 1 1  ON 11
 ud_2                -1.934669e-02 1 1  ON 12
 ud_3                -8.051806e-02 1 1  ON 13
 ud_4                -1.281703e-01 1 1  ON 14
 ud_5                -1.620053e-01 1 1  ON 15
 ud_6                -1.720209e-01 1 1  ON 16
 ud_7                -1.451858e-01 1 1  ON 17
 ud_8                -9.343628e-02 1 1  ON 18
 ud_9                 4.276556e-02 1 1  ON 19
 eO_0                -9.012059e-01 1 1  ON 20
 eO_1                -5.743327e-01 1 1  ON 21
 eO_2                -1.552768e-01 1 1  ON 22
 eO_3                 1.107838e-01 1 1  ON 23
 eO_4                 2.234485e-01 1 1  ON 24
 eO_5                 2.975369e-01 1 1  ON 25
 eO_6                 3.090608e-01 1 1  ON 26
 eO_7                 4.645772e-01 1 1  ON 27
 eO_8                 1.267643e-01 1 1  ON 28
 eO_9                 5.426196e-02 1 1  ON 29
eH1_0                -2.145019e-01 1 1  ON 30
eH1_1                -1.350626e-01 1 1  ON 31
eH1_2                -9.248481e-02 1 1  ON 32
eH1_3                -5.419596e-02 1 1  ON 33
eH1_4                -7.638499e-03 1 1  ON 34
eH1_5                 3.772948e-03 1 1  ON 35
eH1_6                 4.967662e-02 1 1  ON 36
eH1_7                 5.244070e-02 1 1  ON 37
eH1_8                 2.209085e-01 1 1  ON 38
eH1_9                 1.118099e-01 1 1  ON 39
eH2_0                -2.088045e-01 1 1  ON 40
eH2_1                -1.298316e-01 1 1  ON 41
eH2_2                -8.736032e-02 1 1  ON 42
eH2_3                -4.913570e-02 1 1  ON 43
eH2_4                -3.130645e-03 1 1  ON 44
eH2_5                 7.554033e-03 1 1  ON 45
eH2_6                 4.775437e-02 1 1  ON 46
eH2_7                 9.495419e-03 1 1  ON 47
eH2_8                 2.462314e-01 1 1  ON 48
eH2_9                 1.127299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1492
    reference variance = 0.547337
====================================================
  Execution time = 2.1281e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3335e-01
  Total weights = 2.0000e+06
  Execution time = 1.6999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333398866485
                                         uncertainty =       0.003836156455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333398866485
                                         uncertainty =       0.003836156455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408258349
  error estimate for blocks of size 2^( 2) =       0.000418432469
  error estimate for blocks of size 2^( 3) =       0.000427316337
  error estimate for blocks of size 2^( 4) =       0.000433528131
  error estimate for blocks of size 2^( 5) =       0.000437254742
  error estimate for blocks of size 2^( 6) =       0.000439516004
  error estimate for blocks of size 2^( 7) =       0.000440642822

      target function =                  N/A
              le_mean =     -17.214335764634
             les_mean =     296.666705410566
             stat err =       0.000437735425
             autocorr =       1.149617159483
              std dev =       0.577364494662
             le_variance =       0.333349759697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333410882461
                                         uncertainty =       0.003836264924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333410882461
                                         uncertainty =       0.003836264924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408265707
  error estimate for blocks of size 2^( 2) =       0.000418439532
  error estimate for blocks of size 2^( 3) =       0.000427323073
  error estimate for blocks of size 2^( 4) =       0.000433534467
  error estimate for blocks of size 2^( 5) =       0.000437260915
  error estimate for blocks of size 2^( 6) =       0.000439521651
  error estimate for blocks of size 2^( 7) =       0.000440648557

      target function =                  N/A
              le_mean =     -17.214335863065
             les_mean =     296.666720814111
             stat err =       0.000437741398
             autocorr =       1.149607099491
              std dev =       0.577374899345
             le_variance =       0.333361774394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333404884317
                                         uncertainty =       0.003836210525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333404884317
                                         uncertainty =       0.003836210525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408262034
  error estimate for blocks of size 2^( 2) =       0.000418436007
  error estimate for blocks of size 2^( 3) =       0.000427319712
  error estimate for blocks of size 2^( 4) =       0.000433531305
  error estimate for blocks of size 2^( 5) =       0.000437257834
  error estimate for blocks of size 2^( 6) =       0.000439518827
  error estimate for blocks of size 2^( 7) =       0.000440645692

      target function =                  N/A
              le_mean =     -17.214335814491
             les_mean =     296.666713144269
             stat err =       0.000437738414
             autocorr =       1.149612112827
              std dev =       0.577369705549
             le_variance =       0.333355776885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333399618777
                                         uncertainty =       0.003836163207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333399618777
                                         uncertainty =       0.003836163207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408258810
  error estimate for blocks of size 2^( 2) =       0.000418432912
  error estimate for blocks of size 2^( 3) =       0.000427316759
  error estimate for blocks of size 2^( 4) =       0.000433528528
  error estimate for blocks of size 2^( 5) =       0.000437255128
  error estimate for blocks of size 2^( 6) =       0.000439516357
  error estimate for blocks of size 2^( 7) =       0.000440643180

      target function =                  N/A
              le_mean =     -17.214335770867
             les_mean =     296.666706377369
             stat err =       0.000437735798
             autocorr =       1.149616528124
              std dev =       0.577365146080
             le_variance =       0.333350511908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214335764634        initial
     9.7656e+00     9.7656e+01             4.5279e-05       -17.214335863065  <--
     3.9062e+01     3.9062e+02             1.1419e-05       -17.214335814491
     1.5625e+02     1.5625e+03             2.8609e-06       -17.214335770867

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.9942e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.934131e-01 1 1  ON 0
 uu_1                 2.875924e-02 1 1  ON 1
 uu_2                -6.963543e-02 1 1  ON 2
 uu_3                -1.270903e-01 1 1  ON 3
 uu_4                -1.623384e-01 1 1  ON 4
 uu_5                -1.730731e-01 1 1  ON 5
 uu_6                -1.585490e-01 1 1  ON 6
 uu_7                -1.113657e-01 1 1  ON 7
 uu_8                -3.649377e-02 1 1  ON 8
 uu_9                 2.144719e-01 1 1  ON 9
 ud_0                 3.547067e-01 1 1  ON 10
 ud_1                 9.327303e-02 1 1  ON 11
 ud_2                -1.934778e-02 1 1  ON 12
 ud_3                -8.052645e-02 1 1  ON 13
 ud_4                -1.281758e-01 1 1  ON 14
 ud_5                -1.620066e-01 1 1  ON 15
 ud_6                -1.720131e-01 1 1  ON 16
 ud_7                -1.451866e-01 1 1  ON 17
 ud_8                -9.343688e-02 1 1  ON 18
 ud_9                 4.276485e-02 1 1  ON 19
 eO_0                -9.012398e-01 1 1  ON 20
 eO_1                -5.743413e-01 1 1  ON 21
 eO_2                -1.552655e-01 1 1  ON 22
 eO_3                 1.108049e-01 1 1  ON 23
 eO_4                 2.234547e-01 1 1  ON 24
 eO_5                 2.975361e-01 1 1  ON 25
 eO_6                 3.090633e-01 1 1  ON 26
 eO_7                 4.645768e-01 1 1  ON 27
 eO_8                 1.267657e-01 1 1  ON 28
 eO_9                 5.426270e-02 1 1  ON 29
eH1_0                -2.145033e-01 1 1  ON 30
eH1_1                -1.350610e-01 1 1  ON 31
eH1_2                -9.248167e-02 1 1  ON 32
eH1_3                -5.419140e-02 1 1  ON 33
eH1_4                -7.638912e-03 1 1  ON 34
eH1_5                 3.770856e-03 1 1  ON 35
eH1_6                 4.966898e-02 1 1  ON 36
eH1_7                 5.244167e-02 1 1  ON 37
eH1_8                 2.209083e-01 1 1  ON 38
eH1_9                 1.118105e-01 1 1  ON 39
eH2_0                -2.088077e-01 1 1  ON 40
eH2_1                -1.298271e-01 1 1  ON 41
eH2_2                -8.735546e-02 1 1  ON 42
eH2_3                -4.914199e-02 1 1  ON 43
eH2_4                -3.133675e-03 1 1  ON 44
eH2_5                 7.553862e-03 1 1  ON 45
eH2_6                 4.775054e-02 1 1  ON 46
eH2_7                 9.502224e-03 1 1  ON 47
eH2_8                 2.462307e-01 1 1  ON 48
eH2_9                 1.127302e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4856e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.250001
====================================================
  Execution time = 2.0453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2204e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322007597907
                                         uncertainty =       0.002717883171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322007597907
                                         uncertainty =       0.002717883171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401275771
  error estimate for blocks of size 2^( 2) =       0.000411531276
  error estimate for blocks of size 2^( 3) =       0.000420481018
  error estimate for blocks of size 2^( 4) =       0.000427163744
  error estimate for blocks of size 2^( 5) =       0.000431208573
  error estimate for blocks of size 2^( 6) =       0.000433172997
  error estimate for blocks of size 2^( 7) =       0.000435460698

      target function =                  N/A
              le_mean =     -17.214599733412
             les_mean =     296.664488309197
             stat err =       0.000431751503
             autocorr =       1.157662166413
              std dev =       0.567489637456
             le_variance =       0.322044488620


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721459973341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214599733412       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214599911655       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214600197191       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214600360881       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214600305929       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214600159146       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214600190524       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.560970e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214599733412       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214599782304       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214599862231       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214599911360       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214599900467       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214599858312       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214599861886       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.981559e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214599733412       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214599745940       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214599766553       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214599779439       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214599777011       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214599766152       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214599766673       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.000630e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5867e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.934154e-01 1 1  ON 0
 uu_1                 2.875984e-02 1 1  ON 1
 uu_2                -6.962628e-02 1 1  ON 2
 uu_3                -1.270968e-01 1 1  ON 3
 uu_4                -1.623331e-01 1 1  ON 4
 uu_5                -1.730773e-01 1 1  ON 5
 uu_6                -1.585615e-01 1 1  ON 6
 uu_7                -1.113616e-01 1 1  ON 7
 uu_8                -3.649082e-02 1 1  ON 8
 uu_9                 2.144682e-01 1 1  ON 9
 ud_0                 3.547409e-01 1 1  ON 10
 ud_1                 9.327342e-02 1 1  ON 11
 ud_2                -1.935879e-02 1 1  ON 12
 ud_3                -8.053637e-02 1 1  ON 13
 ud_4                -1.281917e-01 1 1  ON 14
 ud_5                -1.620131e-01 1 1  ON 15
 ud_6                -1.720086e-01 1 1  ON 16
 ud_7                -1.451799e-01 1 1  ON 17
 ud_8                -9.343576e-02 1 1  ON 18
 ud_9                 4.276114e-02 1 1  ON 19
 eO_0                -9.012796e-01 1 1  ON 20
 eO_1                -5.743604e-01 1 1  ON 21
 eO_2                -1.552582e-01 1 1  ON 22
 eO_3                 1.108394e-01 1 1  ON 23
 eO_4                 2.234645e-01 1 1  ON 24
 eO_5                 2.975385e-01 1 1  ON 25
 eO_6                 3.090674e-01 1 1  ON 26
 eO_7                 4.645755e-01 1 1  ON 27
 eO_8                 1.267677e-01 1 1  ON 28
 eO_9                 5.426291e-02 1 1  ON 29
eH1_0                -2.145007e-01 1 1  ON 30
eH1_1                -1.350673e-01 1 1  ON 31
eH1_2                -9.247240e-02 1 1  ON 32
eH1_3                -5.419652e-02 1 1  ON 33
eH1_4                -7.639269e-03 1 1  ON 34
eH1_5                 3.773433e-03 1 1  ON 35
eH1_6                 4.966559e-02 1 1  ON 36
eH1_7                 5.244467e-02 1 1  ON 37
eH1_8                 2.209062e-01 1 1  ON 38
eH1_9                 1.118103e-01 1 1  ON 39
eH2_0                -2.088100e-01 1 1  ON 40
eH2_1                -1.298270e-01 1 1  ON 41
eH2_2                -8.735424e-02 1 1  ON 42
eH2_3                -4.914099e-02 1 1  ON 43
eH2_4                -3.137457e-03 1 1  ON 44
eH2_5                 7.551033e-03 1 1  ON 45
eH2_6                 4.774495e-02 1 1  ON 46
eH2_7                 9.513104e-03 1 1  ON 47
eH2_8                 2.462309e-01 1 1  ON 48
eH2_9                 1.127308e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2852
    reference variance = 0.345612
====================================================
  Execution time = 1.9838e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3371e-01
  Total weights = 2.0000e+06
  Execution time = 1.6994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333725135973
                                         uncertainty =       0.005951217775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333725135973
                                         uncertainty =       0.005951217775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408457135
  error estimate for blocks of size 2^( 2) =       0.000418420810
  error estimate for blocks of size 2^( 3) =       0.000427329940
  error estimate for blocks of size 2^( 4) =       0.000434094232
  error estimate for blocks of size 2^( 5) =       0.000437853988
  error estimate for blocks of size 2^( 6) =       0.000440023010
  error estimate for blocks of size 2^( 7) =       0.000439687585

      target function =                  N/A
              le_mean =     -17.214774312142
             les_mean =     296.682128913255
             stat err =       0.000437914704
             autocorr =       1.149439406136
              std dev =       0.577645619825
             le_variance =       0.333674462103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333854317141
                                         uncertainty =       0.005955381517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333854317141
                                         uncertainty =       0.005955381517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408536181
  error estimate for blocks of size 2^( 2) =       0.000418496324
  error estimate for blocks of size 2^( 3) =       0.000427400988
  error estimate for blocks of size 2^( 4) =       0.000434161721
  error estimate for blocks of size 2^( 5) =       0.000437918792
  error estimate for blocks of size 2^( 6) =       0.000440086671
  error estimate for blocks of size 2^( 7) =       0.000439749399

      target function =                  N/A
              le_mean =     -17.214774284932
             les_mean =     296.682257136454
             stat err =       0.000437979146
             autocorr =       1.149332837973
              std dev =       0.577757407750
             le_variance =       0.333803622209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333795373610
                                         uncertainty =       0.005953515498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333795373610
                                         uncertainty =       0.005953515498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408500115
  error estimate for blocks of size 2^( 2) =       0.000418461864
  error estimate for blocks of size 2^( 3) =       0.000427368563
  error estimate for blocks of size 2^( 4) =       0.000434130893
  error estimate for blocks of size 2^( 5) =       0.000437889205
  error estimate for blocks of size 2^( 6) =       0.000440057603
  error estimate for blocks of size 2^( 7) =       0.000439721122

      target function =                  N/A
              le_mean =     -17.214774309891
             les_mean =     296.682199062232
             stat err =       0.000437949705
             autocorr =       1.149381255110
              std dev =       0.577706403477
             le_variance =       0.333744688619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333734109930
                                         uncertainty =       0.005951512917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333734109930
                                         uncertainty =       0.005951512917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408462627
  error estimate for blocks of size 2^( 2) =       0.000418426055
  error estimate for blocks of size 2^( 3) =       0.000427334874
  error estimate for blocks of size 2^( 4) =       0.000434098914
  error estimate for blocks of size 2^( 5) =       0.000437858485
  error estimate for blocks of size 2^( 6) =       0.000440027427
  error estimate for blocks of size 2^( 7) =       0.000439691865

      target function =                  N/A
              le_mean =     -17.214774311680
             les_mean =     296.682137869894
             stat err =       0.000437919173
             autocorr =       1.149431959044
              std dev =       0.577653386254
             le_variance =       0.333683434650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214774312142        initial  <--
     2.4414e+00     2.4414e+01             1.5610e-04       -17.214774284932
     9.7656e+00     9.7656e+01             3.9816e-05       -17.214774309891
     3.9062e+01     3.9062e+02             1.0006e-05       -17.214774311680

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.4051
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.934131e-01 1 1  ON 0
 uu_1                 2.875924e-02 1 1  ON 1
 uu_2                -6.963543e-02 1 1  ON 2
 uu_3                -1.270903e-01 1 1  ON 3
 uu_4                -1.623384e-01 1 1  ON 4
 uu_5                -1.730731e-01 1 1  ON 5
 uu_6                -1.585490e-01 1 1  ON 6
 uu_7                -1.113657e-01 1 1  ON 7
 uu_8                -3.649377e-02 1 1  ON 8
 uu_9                 2.144719e-01 1 1  ON 9
 ud_0                 3.547067e-01 1 1  ON 10
 ud_1                 9.327303e-02 1 1  ON 11
 ud_2                -1.934778e-02 1 1  ON 12
 ud_3                -8.052645e-02 1 1  ON 13
 ud_4                -1.281758e-01 1 1  ON 14
 ud_5                -1.620066e-01 1 1  ON 15
 ud_6                -1.720131e-01 1 1  ON 16
 ud_7                -1.451866e-01 1 1  ON 17
 ud_8                -9.343688e-02 1 1  ON 18
 ud_9                 4.276485e-02 1 1  ON 19
 eO_0                -9.012398e-01 1 1  ON 20
 eO_1                -5.743413e-01 1 1  ON 21
 eO_2                -1.552655e-01 1 1  ON 22
 eO_3                 1.108049e-01 1 1  ON 23
 eO_4                 2.234547e-01 1 1  ON 24
 eO_5                 2.975361e-01 1 1  ON 25
 eO_6                 3.090633e-01 1 1  ON 26
 eO_7                 4.645768e-01 1 1  ON 27
 eO_8                 1.267657e-01 1 1  ON 28
 eO_9                 5.426270e-02 1 1  ON 29
eH1_0                -2.145033e-01 1 1  ON 30
eH1_1                -1.350610e-01 1 1  ON 31
eH1_2                -9.248167e-02 1 1  ON 32
eH1_3                -5.419140e-02 1 1  ON 33
eH1_4                -7.638912e-03 1 1  ON 34
eH1_5                 3.770856e-03 1 1  ON 35
eH1_6                 4.966898e-02 1 1  ON 36
eH1_7                 5.244167e-02 1 1  ON 37
eH1_8                 2.209083e-01 1 1  ON 38
eH1_9                 1.118105e-01 1 1  ON 39
eH2_0                -2.088077e-01 1 1  ON 40
eH2_1                -1.298271e-01 1 1  ON 41
eH2_2                -8.735546e-02 1 1  ON 42
eH2_3                -4.914199e-02 1 1  ON 43
eH2_4                -3.133675e-03 1 1  ON 44
eH2_5                 7.553862e-03 1 1  ON 45
eH2_6                 4.775054e-02 1 1  ON 46
eH2_7                 9.502224e-03 1 1  ON 47
eH2_8                 2.462307e-01 1 1  ON 48
eH2_9                 1.127302e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4279e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2747
    reference variance = 1.51289
====================================================
  Execution time = 1.9465e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2601e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325968827046
                                         uncertainty =       0.003934511902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325968827046
                                         uncertainty =       0.003934511902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403740839
  error estimate for blocks of size 2^( 2) =       0.000414258012
  error estimate for blocks of size 2^( 3) =       0.000423031432
  error estimate for blocks of size 2^( 4) =       0.000429223243
  error estimate for blocks of size 2^( 5) =       0.000432809917
  error estimate for blocks of size 2^( 6) =       0.000436111994
  error estimate for blocks of size 2^( 7) =       0.000438619820

      target function =                  N/A
              le_mean =     -17.214701034509
             les_mean =     296.671944874343
             stat err =       0.000434191244
             autocorr =       1.156529618624
              std dev =       0.570975769906
             le_variance =       0.326013329820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721470103451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214701034509       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214701083032       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214701111419       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214701105022       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214701104824       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214701090364       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214701097363       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.834627e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214701034509       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214701046727       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214701053932       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214701052339       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214701052283       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214701048635       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214701050387       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 4.605394e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214701034509       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214701037569       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214701039377       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214701038980       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214701038965       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214701038051       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214701038489       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.152535e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4991e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.934128e-01 1 1  ON 0
 uu_1                 2.875914e-02 1 1  ON 1
 uu_2                -6.963545e-02 1 1  ON 2
 uu_3                -1.270903e-01 1 1  ON 3
 uu_4                -1.623382e-01 1 1  ON 4
 uu_5                -1.730726e-01 1 1  ON 5
 uu_6                -1.585496e-01 1 1  ON 6
 uu_7                -1.113657e-01 1 1  ON 7
 uu_8                -3.649357e-02 1 1  ON 8
 uu_9                 2.144716e-01 1 1  ON 9
 ud_0                 3.547095e-01 1 1  ON 10
 ud_1                 9.327433e-02 1 1  ON 11
 ud_2                -1.934865e-02 1 1  ON 12
 ud_3                -8.052702e-02 1 1  ON 13
 ud_4                -1.281765e-01 1 1  ON 14
 ud_5                -1.620077e-01 1 1  ON 15
 ud_6                -1.720139e-01 1 1  ON 16
 ud_7                -1.451868e-01 1 1  ON 17
 ud_8                -9.343679e-02 1 1  ON 18
 ud_9                 4.276474e-02 1 1  ON 19
 eO_0                -9.012444e-01 1 1  ON 20
 eO_1                -5.743426e-01 1 1  ON 21
 eO_2                -1.552640e-01 1 1  ON 22
 eO_3                 1.108079e-01 1 1  ON 23
 eO_4                 2.234563e-01 1 1  ON 24
 eO_5                 2.975359e-01 1 1  ON 25
 eO_6                 3.090633e-01 1 1  ON 26
 eO_7                 4.645767e-01 1 1  ON 27
 eO_8                 1.267659e-01 1 1  ON 28
 eO_9                 5.426276e-02 1 1  ON 29
eH1_0                -2.145037e-01 1 1  ON 30
eH1_1                -1.350604e-01 1 1  ON 31
eH1_2                -9.248120e-02 1 1  ON 32
eH1_3                -5.419191e-02 1 1  ON 33
eH1_4                -7.638202e-03 1 1  ON 34
eH1_5                 3.771135e-03 1 1  ON 35
eH1_6                 4.966801e-02 1 1  ON 36
eH1_7                 5.244162e-02 1 1  ON 37
eH1_8                 2.209081e-01 1 1  ON 38
eH1_9                 1.118106e-01 1 1  ON 39
eH2_0                -2.088075e-01 1 1  ON 40
eH2_1                -1.298266e-01 1 1  ON 41
eH2_2                -8.735546e-02 1 1  ON 42
eH2_3                -4.914270e-02 1 1  ON 43
eH2_4                -3.134944e-03 1 1  ON 44
eH2_5                 7.553774e-03 1 1  ON 45
eH2_6                 4.775061e-02 1 1  ON 46
eH2_7                 9.503421e-03 1 1  ON 47
eH2_8                 2.462306e-01 1 1  ON 48
eH2_9                 1.127303e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2109
    reference variance = 0.243678
====================================================
  Execution time = 1.9306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2976e-01
  Total weights = 2.0000e+06
  Execution time = 2.1193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329820324998
                                         uncertainty =       0.005858631066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329820324998
                                         uncertainty =       0.005858631066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406053556
  error estimate for blocks of size 2^( 2) =       0.000415752253
  error estimate for blocks of size 2^( 3) =       0.000424619160
  error estimate for blocks of size 2^( 4) =       0.000431643128
  error estimate for blocks of size 2^( 5) =       0.000436206034
  error estimate for blocks of size 2^( 6) =       0.000438338186
  error estimate for blocks of size 2^( 7) =       0.000439355534

      target function =                  N/A
              le_mean =     -17.214270830778
             les_mean =     296.660879051077
             stat err =       0.000436385720
             autocorr =       1.154979898605
              std dev =       0.574246445870
             le_variance =       0.329758980595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329830652141
                                         uncertainty =       0.005858719879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329830652141
                                         uncertainty =       0.005858719879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406059915
  error estimate for blocks of size 2^( 2) =       0.000415758241
  error estimate for blocks of size 2^( 3) =       0.000424624825
  error estimate for blocks of size 2^( 4) =       0.000431648560
  error estimate for blocks of size 2^( 5) =       0.000436211308
  error estimate for blocks of size 2^( 6) =       0.000438343419
  error estimate for blocks of size 2^( 7) =       0.000439360815

      target function =                  N/A
              le_mean =     -17.214270872022
             les_mean =     296.660890798933
             stat err =       0.000436391025
             autocorr =       1.154971806269
              std dev =       0.574255438351
             le_variance =       0.329769308476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329825521620
                                         uncertainty =       0.005858675901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329825521620
                                         uncertainty =       0.005858675901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406056756
  error estimate for blocks of size 2^( 2) =       0.000415755266
  error estimate for blocks of size 2^( 3) =       0.000424622010
  error estimate for blocks of size 2^( 4) =       0.000431645860
  error estimate for blocks of size 2^( 5) =       0.000436208686
  error estimate for blocks of size 2^( 6) =       0.000438340817
  error estimate for blocks of size 2^( 7) =       0.000439358190

      target function =                  N/A
              le_mean =     -17.214270851711
             les_mean =     296.660884968781
             stat err =       0.000436388388
             autocorr =       1.154975818885
              std dev =       0.574250970902
             le_variance =       0.329764177581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329820975577
                                         uncertainty =       0.005858636684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329820975577
                                         uncertainty =       0.005858636684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406053957
  error estimate for blocks of size 2^( 2) =       0.000415752630
  error estimate for blocks of size 2^( 3) =       0.000424619516
  error estimate for blocks of size 2^( 4) =       0.000431643470
  error estimate for blocks of size 2^( 5) =       0.000436206366
  error estimate for blocks of size 2^( 6) =       0.000438338515
  error estimate for blocks of size 2^( 7) =       0.000439355867

      target function =                  N/A
              le_mean =     -17.214270833398
             les_mean =     296.660879791932
             stat err =       0.000436386054
             autocorr =       1.154979387550
              std dev =       0.574247012373
             le_variance =       0.329759631219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214270830778        initial
     2.4414e+01     2.4414e+02             1.8346e-05       -17.214270872022  <--
     9.7656e+01     9.7656e+02             4.6054e-06       -17.214270851711
     3.9062e+02     3.9062e+03             1.1525e-06       -17.214270833398

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 2.9530e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.934119e-01 1 1  ON 0
 uu_1                 2.875886e-02 1 1  ON 1
 uu_2                -6.963553e-02 1 1  ON 2
 uu_3                -1.270903e-01 1 1  ON 3
 uu_4                -1.623378e-01 1 1  ON 4
 uu_5                -1.730710e-01 1 1  ON 5
 uu_6                -1.585512e-01 1 1  ON 6
 uu_7                -1.113655e-01 1 1  ON 7
 uu_8                -3.649296e-02 1 1  ON 8
 uu_9                 2.144709e-01 1 1  ON 9
 ud_0                 3.547177e-01 1 1  ON 10
 ud_1                 9.327815e-02 1 1  ON 11
 ud_2                -1.935119e-02 1 1  ON 12
 ud_3                -8.052874e-02 1 1  ON 13
 ud_4                -1.281786e-01 1 1  ON 14
 ud_5                -1.620113e-01 1 1  ON 15
 ud_6                -1.720162e-01 1 1  ON 16
 ud_7                -1.451873e-01 1 1  ON 17
 ud_8                -9.343653e-02 1 1  ON 18
 ud_9                 4.276444e-02 1 1  ON 19
 eO_0                -9.012582e-01 1 1  ON 20
 eO_1                -5.743468e-01 1 1  ON 21
 eO_2                -1.552598e-01 1 1  ON 22
 eO_3                 1.108167e-01 1 1  ON 23
 eO_4                 2.234613e-01 1 1  ON 24
 eO_5                 2.975354e-01 1 1  ON 25
 eO_6                 3.090633e-01 1 1  ON 26
 eO_7                 4.645762e-01 1 1  ON 27
 eO_8                 1.267666e-01 1 1  ON 28
 eO_9                 5.426294e-02 1 1  ON 29
eH1_0                -2.145048e-01 1 1  ON 30
eH1_1                -1.350588e-01 1 1  ON 31
eH1_2                -9.247981e-02 1 1  ON 32
eH1_3                -5.419344e-02 1 1  ON 33
eH1_4                -7.636095e-03 1 1  ON 34
eH1_5                 3.771977e-03 1 1  ON 35
eH1_6                 4.966512e-02 1 1  ON 36
eH1_7                 5.244146e-02 1 1  ON 37
eH1_8                 2.209075e-01 1 1  ON 38
eH1_9                 1.118108e-01 1 1  ON 39
eH2_0                -2.088069e-01 1 1  ON 40
eH2_1                -1.298249e-01 1 1  ON 41
eH2_2                -8.735548e-02 1 1  ON 42
eH2_3                -4.914480e-02 1 1  ON 43
eH2_4                -3.138746e-03 1 1  ON 44
eH2_5                 7.553512e-03 1 1  ON 45
eH2_6                 4.775081e-02 1 1  ON 46
eH2_7                 9.506999e-03 1 1  ON 47
eH2_8                 2.462305e-01 1 1  ON 48
eH2_9                 1.127305e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4527e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.3353
    reference variance = 0.320237
====================================================
  Execution time = 1.9661e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3002e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330114237219
                                         uncertainty =       0.004326977324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330114237219
                                         uncertainty =       0.004326977324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406215697
  error estimate for blocks of size 2^( 2) =       0.000416227470
  error estimate for blocks of size 2^( 3) =       0.000425717708
  error estimate for blocks of size 2^( 4) =       0.000432332428
  error estimate for blocks of size 2^( 5) =       0.000436597679
  error estimate for blocks of size 2^( 6) =       0.000440263083
  error estimate for blocks of size 2^( 7) =       0.000441841202

      target function =                  N/A
              le_mean =     -17.214248130418
             les_mean =     296.660360915595
             stat err =       0.000437758598
             autocorr =       1.161330859666
              std dev =       0.574475747964
             le_variance =       0.330022384999


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721424813042e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214248130418       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214248263868       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214248301222       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214248295359       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214248320441       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214248322917       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214248299820       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 6.901538e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214248130418       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214248164769       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214248174264       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214248172874       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214248179357       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214248180190       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214248174186       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.744206e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214248130418       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214248139070       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214248141454       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214248141112       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214248142746       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214248142969       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214248141453       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 4.372452e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253900 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5166e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.934073e-01 1 1  ON 0
 uu_1                 2.875720e-02 1 1  ON 1
 uu_2                -6.963577e-02 1 1  ON 2
 uu_3                -1.270905e-01 1 1  ON 3
 uu_4                -1.623360e-01 1 1  ON 4
 uu_5                -1.730715e-01 1 1  ON 5
 uu_6                -1.585488e-01 1 1  ON 6
 uu_7                -1.113632e-01 1 1  ON 7
 uu_8                -3.649206e-02 1 1  ON 8
 uu_9                 2.144697e-01 1 1  ON 9
 ud_0                 3.547271e-01 1 1  ON 10
 ud_1                 9.328251e-02 1 1  ON 11
 ud_2                -1.935021e-02 1 1  ON 12
 ud_3                -8.053323e-02 1 1  ON 13
 ud_4                -1.281843e-01 1 1  ON 14
 ud_5                -1.620171e-01 1 1  ON 15
 ud_6                -1.720107e-01 1 1  ON 16
 ud_7                -1.451880e-01 1 1  ON 17
 ud_8                -9.343863e-02 1 1  ON 18
 ud_9                 4.276283e-02 1 1  ON 19
 eO_0                -9.012734e-01 1 1  ON 20
 eO_1                -5.743572e-01 1 1  ON 21
 eO_2                -1.552571e-01 1 1  ON 22
 eO_3                 1.108342e-01 1 1  ON 23
 eO_4                 2.234654e-01 1 1  ON 24
 eO_5                 2.975349e-01 1 1  ON 25
 eO_6                 3.090650e-01 1 1  ON 26
 eO_7                 4.645761e-01 1 1  ON 27
 eO_8                 1.267670e-01 1 1  ON 28
 eO_9                 5.426294e-02 1 1  ON 29
eH1_0                -2.145037e-01 1 1  ON 30
eH1_1                -1.350583e-01 1 1  ON 31
eH1_2                -9.247654e-02 1 1  ON 32
eH1_3                -5.419539e-02 1 1  ON 33
eH1_4                -7.636586e-03 1 1  ON 34
eH1_5                 3.772757e-03 1 1  ON 35
eH1_6                 4.966281e-02 1 1  ON 36
eH1_7                 5.244123e-02 1 1  ON 37
eH1_8                 2.209066e-01 1 1  ON 38
eH1_9                 1.118109e-01 1 1  ON 39
eH2_0                -2.088093e-01 1 1  ON 40
eH2_1                -1.298219e-01 1 1  ON 41
eH2_2                -8.735427e-02 1 1  ON 42
eH2_3                -4.914466e-02 1 1  ON 43
eH2_4                -3.141273e-03 1 1  ON 44
eH2_5                 7.551268e-03 1 1  ON 45
eH2_6                 4.774988e-02 1 1  ON 46
eH2_7                 9.511510e-03 1 1  ON 47
eH2_8                 2.462297e-01 1 1  ON 48
eH2_9                 1.127304e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2555
    reference variance = 0.175496
====================================================
  Execution time = 1.9521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2828e-01
  Total weights = 2.0000e+06
  Execution time = 1.6990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328276168335
                                         uncertainty =       0.004901290397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328276168335
                                         uncertainty =       0.004901290397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405140403
  error estimate for blocks of size 2^( 2) =       0.000415158494
  error estimate for blocks of size 2^( 3) =       0.000423271561
  error estimate for blocks of size 2^( 4) =       0.000429576696
  error estimate for blocks of size 2^( 5) =       0.000433069186
  error estimate for blocks of size 2^( 6) =       0.000435198961
  error estimate for blocks of size 2^( 7) =       0.000436009911

      target function =                  N/A
              le_mean =     -17.214804824442
             les_mean =     296.677782472147
             stat err =       0.000433463689
             autocorr =       1.144706985241
              std dev =       0.572955052899
             le_variance =       0.328277492642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328294930878
                                         uncertainty =       0.004901627989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328294930878
                                         uncertainty =       0.004901627989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405151994
  error estimate for blocks of size 2^( 2) =       0.000415169508
  error estimate for blocks of size 2^( 3) =       0.000423281894
  error estimate for blocks of size 2^( 4) =       0.000429586454
  error estimate for blocks of size 2^( 5) =       0.000433078354
  error estimate for blocks of size 2^( 6) =       0.000435208296
  error estimate for blocks of size 2^( 7) =       0.000436018139

      target function =                  N/A
              le_mean =     -17.214805050701
             les_mean =     296.677809045529
             stat err =       0.000433472811
             autocorr =       1.144689667540
              std dev =       0.572971444343
             le_variance =       0.328296276033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328285671609
                                         uncertainty =       0.004901462200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328285671609
                                         uncertainty =       0.004901462200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405146274
  error estimate for blocks of size 2^( 2) =       0.000415164072
  error estimate for blocks of size 2^( 3) =       0.000423276796
  error estimate for blocks of size 2^( 4) =       0.000429581641
  error estimate for blocks of size 2^( 5) =       0.000433073830
  error estimate for blocks of size 2^( 6) =       0.000435203690
  error estimate for blocks of size 2^( 7) =       0.000436014080

      target function =                  N/A
              le_mean =     -17.214804939721
             les_mean =     296.677795955094
             stat err =       0.000433468310
             autocorr =       1.144698219575
              std dev =       0.572963355373
             le_variance =       0.328287006600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328277359808
                                         uncertainty =       0.004901311970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328277359808
                                         uncertainty =       0.004901311970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405141139
  error estimate for blocks of size 2^( 2) =       0.000415159193
  error estimate for blocks of size 2^( 3) =       0.000423272217
  error estimate for blocks of size 2^( 4) =       0.000429577316
  error estimate for blocks of size 2^( 5) =       0.000433069768
  error estimate for blocks of size 2^( 6) =       0.000435199554
  error estimate for blocks of size 2^( 7) =       0.000436010434

      target function =                  N/A
              le_mean =     -17.214804838854
             les_mean =     296.677784161154
             stat err =       0.000433464268
             autocorr =       1.144705885669
              std dev =       0.572956093832
             le_variance =       0.328278685459


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214804824442        initial
     6.1035e+00     6.1035e+01             6.9015e-05       -17.214805050701  <--
     2.4414e+01     2.4414e+02             1.7442e-05       -17.214804939721
     9.7656e+01     9.7656e+02             4.3725e-06       -17.214804838854

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 2.8143e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.933939e-01 1 1  ON 0
 uu_1                 2.875264e-02 1 1  ON 1
 uu_2                -6.963672e-02 1 1  ON 2
 uu_3                -1.270911e-01 1 1  ON 3
 uu_4                -1.623309e-01 1 1  ON 4
 uu_5                -1.730728e-01 1 1  ON 5
 uu_6                -1.585417e-01 1 1  ON 6
 uu_7                -1.113562e-01 1 1  ON 7
 uu_8                -3.648942e-02 1 1  ON 8
 uu_9                 2.144659e-01 1 1  ON 9
 ud_0                 3.547547e-01 1 1  ON 10
 ud_1                 9.329533e-02 1 1  ON 11
 ud_2                -1.934722e-02 1 1  ON 12
 ud_3                -8.054638e-02 1 1  ON 13
 ud_4                -1.282011e-01 1 1  ON 14
 ud_5                -1.620345e-01 1 1  ON 15
 ud_6                -1.719946e-01 1 1  ON 16
 ud_7                -1.451900e-01 1 1  ON 17
 ud_8                -9.344482e-02 1 1  ON 18
 ud_9                 4.275809e-02 1 1  ON 19
 eO_0                -9.013187e-01 1 1  ON 20
 eO_1                -5.743880e-01 1 1  ON 21
 eO_2                -1.552491e-01 1 1  ON 22
 eO_3                 1.108857e-01 1 1  ON 23
 eO_4                 2.234775e-01 1 1  ON 24
 eO_5                 2.975334e-01 1 1  ON 25
 eO_6                 3.090701e-01 1 1  ON 26
 eO_7                 4.645756e-01 1 1  ON 27
 eO_8                 1.267681e-01 1 1  ON 28
 eO_9                 5.426291e-02 1 1  ON 29
eH1_0                -2.145005e-01 1 1  ON 30
eH1_1                -1.350569e-01 1 1  ON 31
eH1_2                -9.246708e-02 1 1  ON 32
eH1_3                -5.420081e-02 1 1  ON 33
eH1_4                -7.638313e-03 1 1  ON 34
eH1_5                 3.775084e-03 1 1  ON 35
eH1_6                 4.965597e-02 1 1  ON 36
eH1_7                 5.244057e-02 1 1  ON 37
eH1_8                 2.209041e-01 1 1  ON 38
eH1_9                 1.118113e-01 1 1  ON 39
eH2_0                -2.088162e-01 1 1  ON 40
eH2_1                -1.298133e-01 1 1  ON 41
eH2_2                -8.735068e-02 1 1  ON 42
eH2_3                -4.914409e-02 1 1  ON 43
eH2_4                -3.148949e-03 1 1  ON 44
eH2_5                 7.544588e-03 1 1  ON 45
eH2_6                 4.774712e-02 1 1  ON 46
eH2_7                 9.524866e-03 1 1  ON 47
eH2_8                 2.462276e-01 1 1  ON 48
eH2_9                 1.127302e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3316e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2433
    reference variance = 0.456659
====================================================
  Execution time = 1.9328e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1877e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318753150798
                                         uncertainty =       0.002494177220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318753150798
                                         uncertainty =       0.002494177220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399231975
  error estimate for blocks of size 2^( 2) =       0.000409623488
  error estimate for blocks of size 2^( 3) =       0.000418833874
  error estimate for blocks of size 2^( 4) =       0.000425402873
  error estimate for blocks of size 2^( 5) =       0.000428659239
  error estimate for blocks of size 2^( 6) =       0.000430544185
  error estimate for blocks of size 2^( 7) =       0.000429160724

      target function =                  N/A
              le_mean =     -17.215280253052
             les_mean =     296.684646370722
             stat err =       0.000428441755
             autocorr =       1.151682973547
              std dev =       0.564599272915
             le_variance =       0.318772338976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721528025305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215280253052       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215280592991       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215280504673       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215280730512       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215280667476       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215280922071       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215280910679       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.085404e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215280253052       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215280346049       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215280326932       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215280378852       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215280391086       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215280429416       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215280432013       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 5.408103e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215280253052       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215280276863       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215280272363       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215280284609       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215280295827       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215280297744       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215280299381       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.386991e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256135 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4774e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.934018e-01 1 1  ON 0
 uu_1                 2.873614e-02 1 1  ON 1
 uu_2                -6.963421e-02 1 1  ON 2
 uu_3                -1.271031e-01 1 1  ON 3
 uu_4                -1.623326e-01 1 1  ON 4
 uu_5                -1.730738e-01 1 1  ON 5
 uu_6                -1.585373e-01 1 1  ON 6
 uu_7                -1.113476e-01 1 1  ON 7
 uu_8                -3.648275e-02 1 1  ON 8
 uu_9                 2.144609e-01 1 1  ON 9
 ud_0                 3.548088e-01 1 1  ON 10
 ud_1                 9.331073e-02 1 1  ON 11
 ud_2                -1.935655e-02 1 1  ON 12
 ud_3                -8.056168e-02 1 1  ON 13
 ud_4                -1.282156e-01 1 1  ON 14
 ud_5                -1.620515e-01 1 1  ON 15
 ud_6                -1.720030e-01 1 1  ON 16
 ud_7                -1.451911e-01 1 1  ON 17
 ud_8                -9.344573e-02 1 1  ON 18
 ud_9                 4.275268e-02 1 1  ON 19
 eO_0                -9.013679e-01 1 1  ON 20
 eO_1                -5.744266e-01 1 1  ON 21
 eO_2                -1.552290e-01 1 1  ON 22
 eO_3                 1.109395e-01 1 1  ON 23
 eO_4                 2.234906e-01 1 1  ON 24
 eO_5                 2.975264e-01 1 1  ON 25
 eO_6                 3.090764e-01 1 1  ON 26
 eO_7                 4.645731e-01 1 1  ON 27
 eO_8                 1.267715e-01 1 1  ON 28
 eO_9                 5.426353e-02 1 1  ON 29
eH1_0                -2.145007e-01 1 1  ON 30
eH1_1                -1.350657e-01 1 1  ON 31
eH1_2                -9.246316e-02 1 1  ON 32
eH1_3                -5.419529e-02 1 1  ON 33
eH1_4                -7.637050e-03 1 1  ON 34
eH1_5                 3.788841e-03 1 1  ON 35
eH1_6                 4.964277e-02 1 1  ON 36
eH1_7                 5.243852e-02 1 1  ON 37
eH1_8                 2.209021e-01 1 1  ON 38
eH1_9                 1.118122e-01 1 1  ON 39
eH2_0                -2.088126e-01 1 1  ON 40
eH2_1                -1.298190e-01 1 1  ON 41
eH2_2                -8.735220e-02 1 1  ON 42
eH2_3                -4.916055e-02 1 1  ON 43
eH2_4                -3.146781e-03 1 1  ON 44
eH2_5                 7.540642e-03 1 1  ON 45
eH2_6                 4.775105e-02 1 1  ON 46
eH2_7                 9.544011e-03 1 1  ON 47
eH2_8                 2.462253e-01 1 1  ON 48
eH2_9                 1.127305e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1985
    reference variance = 0.258773
====================================================
  Execution time = 1.8945e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3697e-01
  Total weights = 2.0000e+06
  Execution time = 1.6977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336977718069
                                         uncertainty =       0.008676232579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336977718069
                                         uncertainty =       0.008676232579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410439962
  error estimate for blocks of size 2^( 2) =       0.000420423560
  error estimate for blocks of size 2^( 3) =       0.000429327412
  error estimate for blocks of size 2^( 4) =       0.000435959056
  error estimate for blocks of size 2^( 5) =       0.000439550848
  error estimate for blocks of size 2^( 6) =       0.000442027473
  error estimate for blocks of size 2^( 7) =       0.000441789062

      target function =                  N/A
              le_mean =     -17.214375762901
             les_mean =     296.671654663298
             stat err =       0.000439831610
             autocorr =       1.148348209061
              std dev =       0.580449761305
             le_variance =       0.336921925399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337142947927
                                         uncertainty =       0.008680193457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337142947927
                                         uncertainty =       0.008680193457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410540592
  error estimate for blocks of size 2^( 2) =       0.000420519457
  error estimate for blocks of size 2^( 3) =       0.000429418547
  error estimate for blocks of size 2^( 4) =       0.000436046940
  error estimate for blocks of size 2^( 5) =       0.000439638709
  error estimate for blocks of size 2^( 6) =       0.000442114444
  error estimate for blocks of size 2^( 7) =       0.000441873879

      target function =                  N/A
              le_mean =     -17.214376252131
             les_mean =     296.671836737551
             stat err =       0.000439918493
             autocorr =       1.148238828679
              std dev =       0.580592073791
             le_variance =       0.337087156149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337070105248
                                         uncertainty =       0.008678453500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337070105248
                                         uncertainty =       0.008678453500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410496231
  error estimate for blocks of size 2^( 2) =       0.000420477129
  error estimate for blocks of size 2^( 3) =       0.000429378262
  error estimate for blocks of size 2^( 4) =       0.000436008056
  error estimate for blocks of size 2^( 5) =       0.000439599905
  error estimate for blocks of size 2^( 6) =       0.000442075973
  error estimate for blocks of size 2^( 7) =       0.000441836184

      target function =                  N/A
              le_mean =     -17.214376023392
             les_mean =     296.671756018191
             stat err =       0.000439880029
             autocorr =       1.148286190118
              std dev =       0.580529337721
             le_variance =       0.337014311954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336989537614
                                         uncertainty =       0.008676517727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336989537614
                                         uncertainty =       0.008676517727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410447162
  error estimate for blocks of size 2^( 2) =       0.000420430411
  error estimate for blocks of size 2^( 3) =       0.000429333913
  error estimate for blocks of size 2^( 4) =       0.000435965317
  error estimate for blocks of size 2^( 5) =       0.000439557119
  error estimate for blocks of size 2^( 6) =       0.000442033669
  error estimate for blocks of size 2^( 7) =       0.000441795074

      target function =                  N/A
              le_mean =     -17.214375794504
             les_mean =     296.671667570768
             stat err =       0.000439837795
             autocorr =       1.148340222883
              std dev =       0.580459942485
             le_variance =       0.336933744830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214375762901        initial
     1.5259e+00     1.5259e+01             2.0854e-04       -17.214376252131  <--
     6.1035e+00     6.1035e+01             5.4081e-05       -17.214376023392
     2.4414e+01     2.4414e+02             1.3870e-05       -17.214375794504

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.7732e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.934195e-01 1 1  ON 0
 uu_1                 2.869805e-02 1 1  ON 1
 uu_2                -6.963567e-02 1 1  ON 2
 uu_3                -1.271317e-01 1 1  ON 3
 uu_4                -1.623415e-01 1 1  ON 4
 uu_5                -1.730752e-01 1 1  ON 5
 uu_6                -1.585240e-01 1 1  ON 6
 uu_7                -1.113228e-01 1 1  ON 7
 uu_8                -3.646348e-02 1 1  ON 8
 uu_9                 2.144463e-01 1 1  ON 9
 ud_0                 3.549498e-01 1 1  ON 10
 ud_1                 9.335361e-02 1 1  ON 11
 ud_2                -1.937323e-02 1 1  ON 12
 ud_3                -8.060541e-02 1 1  ON 13
 ud_4                -1.282549e-01 1 1  ON 14
 ud_5                -1.620990e-01 1 1  ON 15
 ud_6                -1.720264e-01 1 1  ON 16
 ud_7                -1.451941e-01 1 1  ON 17
 ud_8                -9.344813e-02 1 1  ON 18
 ud_9                 4.273716e-02 1 1  ON 19
 eO_0                -9.015126e-01 1 1  ON 20
 eO_1                -5.745305e-01 1 1  ON 21
 eO_2                -1.551773e-01 1 1  ON 22
 eO_3                 1.110943e-01 1 1  ON 23
 eO_4                 2.235302e-01 1 1  ON 24
 eO_5                 2.975060e-01 1 1  ON 25
 eO_6                 3.090948e-01 1 1  ON 26
 eO_7                 4.645657e-01 1 1  ON 27
 eO_8                 1.267813e-01 1 1  ON 28
 eO_9                 5.426533e-02 1 1  ON 29
eH1_0                -2.145013e-01 1 1  ON 30
eH1_1                -1.350890e-01 1 1  ON 31
eH1_2                -9.245313e-02 1 1  ON 32
eH1_3                -5.417978e-02 1 1  ON 33
eH1_4                -7.634147e-03 1 1  ON 34
eH1_5                 3.828915e-03 1 1  ON 35
eH1_6                 4.960494e-02 1 1  ON 36
eH1_7                 5.243260e-02 1 1  ON 37
eH1_8                 2.208964e-01 1 1  ON 38
eH1_9                 1.118147e-01 1 1  ON 39
eH2_0                -2.088021e-01 1 1  ON 40
eH2_1                -1.298375e-01 1 1  ON 41
eH2_2                -8.735830e-02 1 1  ON 42
eH2_3                -4.920336e-02 1 1  ON 43
eH2_4                -3.144375e-03 1 1  ON 44
eH2_5                 7.531162e-03 1 1  ON 45
eH2_6                 4.776309e-02 1 1  ON 46
eH2_7                 9.599241e-03 1 1  ON 47
eH2_8                 2.462190e-01 1 1  ON 48
eH2_9                 1.127313e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2512e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2657
    reference variance = 0.372487
====================================================
  Execution time = 1.9637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3447e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334296973498
                                         uncertainty =       0.007008895036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334296973498
                                         uncertainty =       0.007008895036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408944125
  error estimate for blocks of size 2^( 2) =       0.000418423456
  error estimate for blocks of size 2^( 3) =       0.000427228067
  error estimate for blocks of size 2^( 4) =       0.000433685243
  error estimate for blocks of size 2^( 5) =       0.000437571408
  error estimate for blocks of size 2^( 6) =       0.000438123017
  error estimate for blocks of size 2^( 7) =       0.000439857181

      target function =                  N/A
              le_mean =     -17.214826614233
             les_mean =     296.684725784939
             stat err =       0.000437309212
             autocorr =       1.143534591246
              std dev =       0.578334327238
             le_variance =       0.334470594061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721482661423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214826614233       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214827042472       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214827336139       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214826667077       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214826771983       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214826442608       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214826683688       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214826553237       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214826758835       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 7.298639e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214826614233       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214826753679       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214826856305       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214826568397       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214826592931       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214826500863       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214826574717       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.064925e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214826614233       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214826651947       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214826680648       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214826598172       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214826575125       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214826574347       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214826593195       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 5.497717e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5070e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.932867e-01 1 1  ON 0
 uu_1                 2.875685e-02 1 1  ON 1
 uu_2                -6.963524e-02 1 1  ON 2
 uu_3                -1.271300e-01 1 1  ON 3
 uu_4                -1.623193e-01 1 1  ON 4
 uu_5                -1.730918e-01 1 1  ON 5
 uu_6                -1.585420e-01 1 1  ON 6
 uu_7                -1.112697e-01 1 1  ON 7
 uu_8                -3.643707e-02 1 1  ON 8
 uu_9                 2.144319e-01 1 1  ON 9
 ud_0                 3.550413e-01 1 1  ON 10
 ud_1                 9.340421e-02 1 1  ON 11
 ud_2                -1.939528e-02 1 1  ON 12
 ud_3                -8.067548e-02 1 1  ON 13
 ud_4                -1.283150e-01 1 1  ON 14
 ud_5                -1.621487e-01 1 1  ON 15
 ud_6                -1.719886e-01 1 1  ON 16
 ud_7                -1.451843e-01 1 1  ON 17
 ud_8                -9.344687e-02 1 1  ON 18
 ud_9                 4.273112e-02 1 1  ON 19
 eO_0                -9.017184e-01 1 1  ON 20
 eO_1                -5.746384e-01 1 1  ON 21
 eO_2                -1.551245e-01 1 1  ON 22
 eO_3                 1.113008e-01 1 1  ON 23
 eO_4                 2.235692e-01 1 1  ON 24
 eO_5                 2.974843e-01 1 1  ON 25
 eO_6                 3.091189e-01 1 1  ON 26
 eO_7                 4.645620e-01 1 1  ON 27
 eO_8                 1.267935e-01 1 1  ON 28
 eO_9                 5.426922e-02 1 1  ON 29
eH1_0                -2.144201e-01 1 1  ON 30
eH1_1                -1.351180e-01 1 1  ON 31
eH1_2                -9.250232e-02 1 1  ON 32
eH1_3                -5.419090e-02 1 1  ON 33
eH1_4                -7.639290e-03 1 1  ON 34
eH1_5                 3.906511e-03 1 1  ON 35
eH1_6                 4.953654e-02 1 1  ON 36
eH1_7                 5.243530e-02 1 1  ON 37
eH1_8                 2.208911e-01 1 1  ON 38
eH1_9                 1.118168e-01 1 1  ON 39
eH2_0                -2.088202e-01 1 1  ON 40
eH2_1                -1.298985e-01 1 1  ON 41
eH2_2                -8.735905e-02 1 1  ON 42
eH2_3                -4.925095e-02 1 1  ON 43
eH2_4                -3.149993e-03 1 1  ON 44
eH2_5                 7.564783e-03 1 1  ON 45
eH2_6                 4.777834e-02 1 1  ON 46
eH2_7                 9.678440e-03 1 1  ON 47
eH2_8                 2.462188e-01 1 1  ON 48
eH2_9                 1.127335e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2099
    reference variance = 0.194994
====================================================
  Execution time = 1.9417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2058e-01
  Total weights = 2.0000e+06
  Execution time = 1.7045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320575879952
                                         uncertainty =       0.003474305001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320575879952
                                         uncertainty =       0.003474305001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400316348
  error estimate for blocks of size 2^( 2) =       0.000410334336
  error estimate for blocks of size 2^( 3) =       0.000419753484
  error estimate for blocks of size 2^( 4) =       0.000426107375
  error estimate for blocks of size 2^( 5) =       0.000429277365
  error estimate for blocks of size 2^( 6) =       0.000431939298
  error estimate for blocks of size 2^( 7) =       0.000434427277

      target function =                  N/A
              le_mean =     -17.214785856978
             les_mean =     296.669358298300
             stat err =       0.000430437829
             autocorr =       1.156150075343
              std dev =       0.566132808586
             le_variance =       0.320506356958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320796467580
                                         uncertainty =       0.003477249649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320796467580
                                         uncertainty =       0.003477249649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400454024
  error estimate for blocks of size 2^( 2) =       0.000410463130
  error estimate for blocks of size 2^( 3) =       0.000419872938
  error estimate for blocks of size 2^( 4) =       0.000426221118
  error estimate for blocks of size 2^( 5) =       0.000429384699
  error estimate for blocks of size 2^( 6) =       0.000432037682
  error estimate for blocks of size 2^( 7) =       0.000434525715

      target function =                  N/A
              le_mean =     -17.214786406768
             les_mean =     296.669597721755
             stat err =       0.000430542303
             autocorr =       1.155916157496
              std dev =       0.566327512544
             le_variance =       0.320726851464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320717569320
                                         uncertainty =       0.003476134966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320717569320
                                         uncertainty =       0.003476134966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400404784
  error estimate for blocks of size 2^( 2) =       0.000410416283
  error estimate for blocks of size 2^( 3) =       0.000419829050
  error estimate for blocks of size 2^( 4) =       0.000426179519
  error estimate for blocks of size 2^( 5) =       0.000429345681
  error estimate for blocks of size 2^( 6) =       0.000432001510
  error estimate for blocks of size 2^( 7) =       0.000434489792

      target function =                  N/A
              le_mean =     -17.214786045933
             les_mean =     296.669506429422
             stat err =       0.000430504126
             autocorr =       1.155995435689
              std dev =       0.566257876315
             le_variance =       0.320647982488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320594668792
                                         uncertainty =       0.003474552468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320594668792
                                         uncertainty =       0.003474552468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400328077
  error estimate for blocks of size 2^( 2) =       0.000410345157
  error estimate for blocks of size 2^( 3) =       0.000419763415
  error estimate for blocks of size 2^( 4) =       0.000426116825
  error estimate for blocks of size 2^( 5) =       0.000429286303
  error estimate for blocks of size 2^( 6) =       0.000431947397
  error estimate for blocks of size 2^( 7) =       0.000434435456

      target function =                  N/A
              le_mean =     -17.214785863772
             les_mean =     296.669377313077
             stat err =       0.000430446495
             autocorr =       1.156128884987
              std dev =       0.566149395329
             le_variance =       0.320525137832


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214785856978        initial
     3.8147e-01     3.8147e+00             7.2986e-04       -17.214786406768  <--
     1.5259e+00     1.5259e+01             2.0649e-04       -17.214786045933
     6.1035e+00     6.1035e+01             5.4977e-05       -17.214785863772

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.8014e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.931165e-01 1 1  ON 0
 uu_1                 2.883440e-02 1 1  ON 1
 uu_2                -6.964717e-02 1 1  ON 2
 uu_3                -1.271542e-01 1 1  ON 3
 uu_4                -1.623448e-01 1 1  ON 4
 uu_5                -1.731291e-01 1 1  ON 5
 uu_6                -1.586114e-01 1 1  ON 6
 uu_7                -1.111085e-01 1 1  ON 7
 uu_8                -3.635262e-02 1 1  ON 8
 uu_9                 2.143835e-01 1 1  ON 9
 ud_0                 3.552242e-01 1 1  ON 10
 ud_1                 9.353244e-02 1 1  ON 11
 ud_2                -1.941740e-02 1 1  ON 12
 ud_3                -8.080008e-02 1 1  ON 13
 ud_4                -1.284665e-01 1 1  ON 14
 ud_5                -1.622932e-01 1 1  ON 15
 ud_6                -1.719118e-01 1 1  ON 16
 ud_7                -1.451672e-01 1 1  ON 17
 ud_8                -9.344527e-02 1 1  ON 18
 ud_9                 4.271032e-02 1 1  ON 19
 eO_0                -9.022424e-01 1 1  ON 20
 eO_1                -5.749331e-01 1 1  ON 21
 eO_2                -1.550570e-01 1 1  ON 22
 eO_3                 1.118010e-01 1 1  ON 23
 eO_4                 2.237564e-01 1 1  ON 24
 eO_5                 2.974333e-01 1 1  ON 25
 eO_6                 3.091922e-01 1 1  ON 26
 eO_7                 4.645474e-01 1 1  ON 27
 eO_8                 1.268342e-01 1 1  ON 28
 eO_9                 5.428225e-02 1 1  ON 29
eH1_0                -2.142243e-01 1 1  ON 30
eH1_1                -1.351992e-01 1 1  ON 31
eH1_2                -9.259627e-02 1 1  ON 32
eH1_3                -5.423037e-02 1 1  ON 33
eH1_4                -7.649019e-03 1 1  ON 34
eH1_5                 4.133721e-03 1 1  ON 35
eH1_6                 4.932541e-02 1 1  ON 36
eH1_7                 5.244432e-02 1 1  ON 37
eH1_8                 2.208720e-01 1 1  ON 38
eH1_9                 1.118237e-01 1 1  ON 39
eH2_0                -2.088741e-01 1 1  ON 40
eH2_1                -1.300401e-01 1 1  ON 41
eH2_2                -8.739542e-02 1 1  ON 42
eH2_3                -4.936394e-02 1 1  ON 43
eH2_4                -3.213155e-03 1 1  ON 44
eH2_5                 7.642907e-03 1 1  ON 45
eH2_6                 4.783165e-02 1 1  ON 46
eH2_7                 9.939607e-03 1 1  ON 47
eH2_8                 2.462171e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3090e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.3141
    reference variance = 0.43936
====================================================
  Execution time = 1.9330e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2326e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323293616828
                                         uncertainty =       0.003091860382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323293616828
                                         uncertainty =       0.003091860382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402031586
  error estimate for blocks of size 2^( 2) =       0.000411372593
  error estimate for blocks of size 2^( 3) =       0.000420288154
  error estimate for blocks of size 2^( 4) =       0.000425847733
  error estimate for blocks of size 2^( 5) =       0.000429290754
  error estimate for blocks of size 2^( 6) =       0.000431064538
  error estimate for blocks of size 2^( 7) =       0.000432570080

      target function =                  N/A
              le_mean =     -17.214991492144
             les_mean =     296.679190705217
             stat err =       0.000429693276
             autocorr =       1.142343632847
              std dev =       0.568558521392
             le_variance =       0.323258792248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721499149214e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214991492144       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214992922798       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214991996864       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214992476823       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214993276098       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214992716542       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214992536331       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214994004879       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214993782111       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214993918284       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214993891951       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.878124e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214991492144       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214992232331       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214991873234       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214991796778       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214992194275       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214991842491       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214991914078       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214992258408       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 6.361241e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214991492144       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214991744725       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214991655907       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214991559446       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214991668923       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214991542515       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214991607952       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.794741e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4825e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.936112e-01 1 1  ON 0
 uu_1                 2.882501e-02 1 1  ON 1
 uu_2                -6.969491e-02 1 1  ON 2
 uu_3                -1.272622e-01 1 1  ON 3
 uu_4                -1.624735e-01 1 1  ON 4
 uu_5                -1.730505e-01 1 1  ON 5
 uu_6                -1.588532e-01 1 1  ON 6
 uu_7                -1.111998e-01 1 1  ON 7
 uu_8                -3.631495e-02 1 1  ON 8
 uu_9                 2.143122e-01 1 1  ON 9
 ud_0                 3.555173e-01 1 1  ON 10
 ud_1                 9.353738e-02 1 1  ON 11
 ud_2                -1.940732e-02 1 1  ON 12
 ud_3                -8.086465e-02 1 1  ON 13
 ud_4                -1.285585e-01 1 1  ON 14
 ud_5                -1.623807e-01 1 1  ON 15
 ud_6                -1.718744e-01 1 1  ON 16
 ud_7                -1.451646e-01 1 1  ON 17
 ud_8                -9.351010e-02 1 1  ON 18
 ud_9                 4.262480e-02 1 1  ON 19
 eO_0                -9.028786e-01 1 1  ON 20
 eO_1                -5.750873e-01 1 1  ON 21
 eO_2                -1.549810e-01 1 1  ON 22
 eO_3                 1.119787e-01 1 1  ON 23
 eO_4                 2.242119e-01 1 1  ON 24
 eO_5                 2.975202e-01 1 1  ON 25
 eO_6                 3.092052e-01 1 1  ON 26
 eO_7                 4.644818e-01 1 1  ON 27
 eO_8                 1.268619e-01 1 1  ON 28
 eO_9                 5.429241e-02 1 1  ON 29
eH1_0                -2.141329e-01 1 1  ON 30
eH1_1                -1.352227e-01 1 1  ON 31
eH1_2                -9.246607e-02 1 1  ON 32
eH1_3                -5.427626e-02 1 1  ON 33
eH1_4                -7.680892e-03 1 1  ON 34
eH1_5                 4.153907e-03 1 1  ON 35
eH1_6                 4.921883e-02 1 1  ON 36
eH1_7                 5.244940e-02 1 1  ON 37
eH1_8                 2.208161e-01 1 1  ON 38
eH1_9                 1.118278e-01 1 1  ON 39
eH2_0                -2.089572e-01 1 1  ON 40
eH2_1                -1.300915e-01 1 1  ON 41
eH2_2                -8.735042e-02 1 1  ON 42
eH2_3                -4.943743e-02 1 1  ON 43
eH2_4                -3.106271e-03 1 1  ON 44
eH2_5                 7.480791e-03 1 1  ON 45
eH2_6                 4.788099e-02 1 1  ON 46
eH2_7                 1.018919e-02 1 1  ON 47
eH2_8                 2.461234e-01 1 1  ON 48
eH2_9                 1.127350e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2292
    reference variance = 0.209437
====================================================
  Execution time = 1.8865e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 4.9748e-01
  Total weights = 2.0000e+06
  Execution time = 1.7081e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497042450787
                                         uncertainty =       0.174099175360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497042450787
                                         uncertainty =       0.174099175360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498368897
  error estimate for blocks of size 2^( 2) =       0.000506523809
  error estimate for blocks of size 2^( 3) =       0.000513764456
  error estimate for blocks of size 2^( 4) =       0.000519319622
  error estimate for blocks of size 2^( 5) =       0.000522498361
  error estimate for blocks of size 2^( 6) =       0.000523947945
  error estimate for blocks of size 2^( 7) =       0.000523380366

      target function =                  N/A
              le_mean =     -17.215395052996
             les_mean =     296.866569696546
             stat err =       0.000522286574
             autocorr =       1.098287050498
              std dev =       0.704800052630
             le_variance =       0.496743114188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498465389475
                                         uncertainty =       0.174741597096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498465389475
                                         uncertainty =       0.174741597096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499081717
  error estimate for blocks of size 2^( 2) =       0.000507219393
  error estimate for blocks of size 2^( 3) =       0.000514444309
  error estimate for blocks of size 2^( 4) =       0.000519987937
  error estimate for blocks of size 2^( 5) =       0.000523161167
  error estimate for blocks of size 2^( 6) =       0.000524611766
  error estimate for blocks of size 2^( 7) =       0.000524051011

      target function =                  N/A
              le_mean =     -17.215394337394
             les_mean =     296.867967063421
             stat err =       0.000522952970
             autocorr =       1.097948441428
              std dev =       0.705808132948
             le_variance =       0.498165120536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498522373381
                                         uncertainty =       0.174790589075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498522373381
                                         uncertainty =       0.174790589075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499110239
  error estimate for blocks of size 2^( 2) =       0.000507247312
  error estimate for blocks of size 2^( 3) =       0.000514473721
  error estimate for blocks of size 2^( 4) =       0.000520020061
  error estimate for blocks of size 2^( 5) =       0.000523193418
  error estimate for blocks of size 2^( 6) =       0.000524642536
  error estimate for blocks of size 2^( 7) =       0.000524084475

      target function =                  N/A
              le_mean =     -17.215394609360
             les_mean =     296.868033369198
             stat err =       0.000522985123
             autocorr =       1.097957955363
              std dev =       0.705848469812
             le_variance =       0.498222062336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497320769858
                                         uncertainty =       0.174224278451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497320769858
                                         uncertainty =       0.174224278451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498508405
  error estimate for blocks of size 2^( 2) =       0.000506659837
  error estimate for blocks of size 2^( 3) =       0.000513897961
  error estimate for blocks of size 2^( 4) =       0.000519451513
  error estimate for blocks of size 2^( 5) =       0.000522628911
  error estimate for blocks of size 2^( 6) =       0.000524078161
  error estimate for blocks of size 2^( 7) =       0.000523511756

      target function =                  N/A
              le_mean =     -17.215394901490
             les_mean =     296.866842626065
             stat err =       0.000522417585
             autocorr =       1.098223174847
              std dev =       0.704997347747
             le_variance =       0.497021260330


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215395052996        initial  <--
     9.5367e-02     9.5367e-01             1.8781e-03       -17.215394337394
     3.8147e-01     3.8147e+00             6.3612e-04       -17.215394609360
     1.5259e+00     1.5259e+01             1.7947e-04       -17.215394901490

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.4951
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.931165e-01 1 1  ON 0
 uu_1                 2.883440e-02 1 1  ON 1
 uu_2                -6.964717e-02 1 1  ON 2
 uu_3                -1.271542e-01 1 1  ON 3
 uu_4                -1.623448e-01 1 1  ON 4
 uu_5                -1.731291e-01 1 1  ON 5
 uu_6                -1.586114e-01 1 1  ON 6
 uu_7                -1.111085e-01 1 1  ON 7
 uu_8                -3.635262e-02 1 1  ON 8
 uu_9                 2.143835e-01 1 1  ON 9
 ud_0                 3.552242e-01 1 1  ON 10
 ud_1                 9.353244e-02 1 1  ON 11
 ud_2                -1.941740e-02 1 1  ON 12
 ud_3                -8.080008e-02 1 1  ON 13
 ud_4                -1.284665e-01 1 1  ON 14
 ud_5                -1.622932e-01 1 1  ON 15
 ud_6                -1.719118e-01 1 1  ON 16
 ud_7                -1.451672e-01 1 1  ON 17
 ud_8                -9.344527e-02 1 1  ON 18
 ud_9                 4.271032e-02 1 1  ON 19
 eO_0                -9.022424e-01 1 1  ON 20
 eO_1                -5.749331e-01 1 1  ON 21
 eO_2                -1.550570e-01 1 1  ON 22
 eO_3                 1.118010e-01 1 1  ON 23
 eO_4                 2.237564e-01 1 1  ON 24
 eO_5                 2.974333e-01 1 1  ON 25
 eO_6                 3.091922e-01 1 1  ON 26
 eO_7                 4.645474e-01 1 1  ON 27
 eO_8                 1.268342e-01 1 1  ON 28
 eO_9                 5.428225e-02 1 1  ON 29
eH1_0                -2.142243e-01 1 1  ON 30
eH1_1                -1.351992e-01 1 1  ON 31
eH1_2                -9.259627e-02 1 1  ON 32
eH1_3                -5.423037e-02 1 1  ON 33
eH1_4                -7.649019e-03 1 1  ON 34
eH1_5                 4.133721e-03 1 1  ON 35
eH1_6                 4.932541e-02 1 1  ON 36
eH1_7                 5.244432e-02 1 1  ON 37
eH1_8                 2.208720e-01 1 1  ON 38
eH1_9                 1.118237e-01 1 1  ON 39
eH2_0                -2.088741e-01 1 1  ON 40
eH2_1                -1.300401e-01 1 1  ON 41
eH2_2                -8.739542e-02 1 1  ON 42
eH2_3                -4.936394e-02 1 1  ON 43
eH2_4                -3.213155e-03 1 1  ON 44
eH2_5                 7.642907e-03 1 1  ON 45
eH2_6                 4.783165e-02 1 1  ON 46
eH2_7                 9.939607e-03 1 1  ON 47
eH2_8                 2.462171e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2326e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2085
    reference variance = 0.230157
====================================================
  Execution time = 1.9602e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2975e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329822837176
                                         uncertainty =       0.004357824012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329822837176
                                         uncertainty =       0.004357824012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406045055
  error estimate for blocks of size 2^( 2) =       0.000416231366
  error estimate for blocks of size 2^( 3) =       0.000424741664
  error estimate for blocks of size 2^( 4) =       0.000431352665
  error estimate for blocks of size 2^( 5) =       0.000435372652
  error estimate for blocks of size 2^( 6) =       0.000436403712
  error estimate for blocks of size 2^( 7) =       0.000438517244

      target function =                  N/A
              le_mean =     -17.214857626897
             les_mean =     296.681068123534
             stat err =       0.000435411568
             autocorr =       1.149877230467
              std dev =       0.574234424311
             le_variance =       0.329745174064


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721485762690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214857626897       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214857789627       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214857613106       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214858170062       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214858354992       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214858239533       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214858194678       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214858332252       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.214592e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214857626897       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214857673445       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214857610655       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214857757606       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214857828452       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214857767061       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214857783976       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 8.448539e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214857626897       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214857638969       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214857621755       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214857658922       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214857678648       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214857660867       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214857666883       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.149303e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264179 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5117e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.931318e-01 1 1  ON 0
 uu_1                 2.885245e-02 1 1  ON 1
 uu_2                -6.964493e-02 1 1  ON 2
 uu_3                -1.271466e-01 1 1  ON 3
 uu_4                -1.623730e-01 1 1  ON 4
 uu_5                -1.731607e-01 1 1  ON 5
 uu_6                -1.586186e-01 1 1  ON 6
 uu_7                -1.110971e-01 1 1  ON 7
 uu_8                -3.634370e-02 1 1  ON 8
 uu_9                 2.143780e-01 1 1  ON 9
 ud_0                 3.552527e-01 1 1  ON 10
 ud_1                 9.353170e-02 1 1  ON 11
 ud_2                -1.943848e-02 1 1  ON 12
 ud_3                -8.083225e-02 1 1  ON 13
 ud_4                -1.284873e-01 1 1  ON 14
 ud_5                -1.622786e-01 1 1  ON 15
 ud_6                -1.718969e-01 1 1  ON 16
 ud_7                -1.451615e-01 1 1  ON 17
 ud_8                -9.343716e-02 1 1  ON 18
 ud_9                 4.270833e-02 1 1  ON 19
 eO_0                -9.023269e-01 1 1  ON 20
 eO_1                -5.749638e-01 1 1  ON 21
 eO_2                -1.550414e-01 1 1  ON 22
 eO_3                 1.118724e-01 1 1  ON 23
 eO_4                 2.237803e-01 1 1  ON 24
 eO_5                 2.974238e-01 1 1  ON 25
 eO_6                 3.091972e-01 1 1  ON 26
 eO_7                 4.645486e-01 1 1  ON 27
 eO_8                 1.268402e-01 1 1  ON 28
 eO_9                 5.428335e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352023e-01 1 1  ON 31
eH1_2                -9.257567e-02 1 1  ON 32
eH1_3                -5.421683e-02 1 1  ON 33
eH1_4                -7.667781e-03 1 1  ON 34
eH1_5                 4.147892e-03 1 1  ON 35
eH1_6                 4.931357e-02 1 1  ON 36
eH1_7                 5.244360e-02 1 1  ON 37
eH1_8                 2.208681e-01 1 1  ON 38
eH1_9                 1.118244e-01 1 1  ON 39
eH2_0                -2.088879e-01 1 1  ON 40
eH2_1                -1.300783e-01 1 1  ON 41
eH2_2                -8.737302e-02 1 1  ON 42
eH2_3                -4.935686e-02 1 1  ON 43
eH2_4                -3.218555e-03 1 1  ON 44
eH2_5                 7.652857e-03 1 1  ON 45
eH2_6                 4.782648e-02 1 1  ON 46
eH2_7                 9.960643e-03 1 1  ON 47
eH2_8                 2.462155e-01 1 1  ON 48
eH2_9                 1.127430e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1841
    reference variance = 0.146194
====================================================
  Execution time = 1.9264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3038e-01
  Total weights = 2.0000e+06
  Execution time = 1.6953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330363770585
                                         uncertainty =       0.004839839539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330363770585
                                         uncertainty =       0.004839839539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406412300
  error estimate for blocks of size 2^( 2) =       0.000416435371
  error estimate for blocks of size 2^( 3) =       0.000425559644
  error estimate for blocks of size 2^( 4) =       0.000431535436
  error estimate for blocks of size 2^( 5) =       0.000435151689
  error estimate for blocks of size 2^( 6) =       0.000437332192
  error estimate for blocks of size 2^( 7) =       0.000438370035

      target function =                  N/A
              le_mean =     -17.214574606066
             les_mean =     296.671920617999
             stat err =       0.000435597338
             autocorr =       1.148779686672
              std dev =       0.574753786725
             le_variance =       0.330341915355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330492609410
                                         uncertainty =       0.004841430360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330492609410
                                         uncertainty =       0.004841430360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406491561
  error estimate for blocks of size 2^( 2) =       0.000416510053
  error estimate for blocks of size 2^( 3) =       0.000425630310
  error estimate for blocks of size 2^( 4) =       0.000431604039
  error estimate for blocks of size 2^( 5) =       0.000435219210
  error estimate for blocks of size 2^( 6) =       0.000437398405
  error estimate for blocks of size 2^( 7) =       0.000438436868

      target function =                  N/A
              le_mean =     -17.214574083109
             les_mean =     296.672031475641
             stat err =       0.000435664631
             autocorr =       1.148686559148
              std dev =       0.574865878305
             le_variance =       0.330470778040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330442138565
                                         uncertainty =       0.004840821709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330442138565
                                         uncertainty =       0.004840821709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406460512
  error estimate for blocks of size 2^( 2) =       0.000416480804
  error estimate for blocks of size 2^( 3) =       0.000425602670
  error estimate for blocks of size 2^( 4) =       0.000431577174
  error estimate for blocks of size 2^( 5) =       0.000435192715
  error estimate for blocks of size 2^( 6) =       0.000437372501
  error estimate for blocks of size 2^( 7) =       0.000438410527

      target function =                  N/A
              le_mean =     -17.214574279531
             les_mean =     296.671987755407
             stat err =       0.000435638229
             autocorr =       1.148722820173
              std dev =       0.574821968204
             le_variance =       0.330420295130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330374117814
                                         uncertainty =       0.004839969263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330374117814
                                         uncertainty =       0.004839969263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406418666
  error estimate for blocks of size 2^( 2) =       0.000416441368
  error estimate for blocks of size 2^( 3) =       0.000425565324
  error estimate for blocks of size 2^( 4) =       0.000431540943
  error estimate for blocks of size 2^( 5) =       0.000435157099
  error estimate for blocks of size 2^( 6) =       0.000437337506
  error estimate for blocks of size 2^( 7) =       0.000438375368

      target function =                  N/A
              le_mean =     -17.214574560207
             les_mean =     296.671929387839
             stat err =       0.000435602729
             autocorr =       1.148772133237
              std dev =       0.574762789397
             le_variance =       0.330352264076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214574606066        initial  <--
     9.5367e-01     9.5367e+00             3.2146e-04       -17.214574083109
     3.8147e+00     3.8147e+01             8.4485e-05       -17.214574279531
     1.5259e+01     1.5259e+02             2.1493e-05       -17.214574560207

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.8235
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.931165e-01 1 1  ON 0
 uu_1                 2.883440e-02 1 1  ON 1
 uu_2                -6.964717e-02 1 1  ON 2
 uu_3                -1.271542e-01 1 1  ON 3
 uu_4                -1.623448e-01 1 1  ON 4
 uu_5                -1.731291e-01 1 1  ON 5
 uu_6                -1.586114e-01 1 1  ON 6
 uu_7                -1.111085e-01 1 1  ON 7
 uu_8                -3.635262e-02 1 1  ON 8
 uu_9                 2.143835e-01 1 1  ON 9
 ud_0                 3.552242e-01 1 1  ON 10
 ud_1                 9.353244e-02 1 1  ON 11
 ud_2                -1.941740e-02 1 1  ON 12
 ud_3                -8.080008e-02 1 1  ON 13
 ud_4                -1.284665e-01 1 1  ON 14
 ud_5                -1.622932e-01 1 1  ON 15
 ud_6                -1.719118e-01 1 1  ON 16
 ud_7                -1.451672e-01 1 1  ON 17
 ud_8                -9.344527e-02 1 1  ON 18
 ud_9                 4.271032e-02 1 1  ON 19
 eO_0                -9.022424e-01 1 1  ON 20
 eO_1                -5.749331e-01 1 1  ON 21
 eO_2                -1.550570e-01 1 1  ON 22
 eO_3                 1.118010e-01 1 1  ON 23
 eO_4                 2.237564e-01 1 1  ON 24
 eO_5                 2.974333e-01 1 1  ON 25
 eO_6                 3.091922e-01 1 1  ON 26
 eO_7                 4.645474e-01 1 1  ON 27
 eO_8                 1.268342e-01 1 1  ON 28
 eO_9                 5.428225e-02 1 1  ON 29
eH1_0                -2.142243e-01 1 1  ON 30
eH1_1                -1.351992e-01 1 1  ON 31
eH1_2                -9.259627e-02 1 1  ON 32
eH1_3                -5.423037e-02 1 1  ON 33
eH1_4                -7.649019e-03 1 1  ON 34
eH1_5                 4.133721e-03 1 1  ON 35
eH1_6                 4.932541e-02 1 1  ON 36
eH1_7                 5.244432e-02 1 1  ON 37
eH1_8                 2.208720e-01 1 1  ON 38
eH1_9                 1.118237e-01 1 1  ON 39
eH2_0                -2.088741e-01 1 1  ON 40
eH2_1                -1.300401e-01 1 1  ON 41
eH2_2                -8.739542e-02 1 1  ON 42
eH2_3                -4.936394e-02 1 1  ON 43
eH2_4                -3.213155e-03 1 1  ON 44
eH2_5                 7.642907e-03 1 1  ON 45
eH2_6                 4.783165e-02 1 1  ON 46
eH2_7                 9.939607e-03 1 1  ON 47
eH2_8                 2.462171e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2946e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2078
    reference variance = 0.231534
====================================================
  Execution time = 1.9367e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2398e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324097321279
                                         uncertainty =       0.003581706837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324097321279
                                         uncertainty =       0.003581706837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402477851
  error estimate for blocks of size 2^( 2) =       0.000412410012
  error estimate for blocks of size 2^( 3) =       0.000421527533
  error estimate for blocks of size 2^( 4) =       0.000427636554
  error estimate for blocks of size 2^( 5) =       0.000432070188
  error estimate for blocks of size 2^( 6) =       0.000434682704
  error estimate for blocks of size 2^( 7) =       0.000435810090

      target function =                  N/A
              le_mean =     -17.215090605559
             les_mean =     296.683321236331
             stat err =       0.000432549884
             autocorr =       1.155017141030
              std dev =       0.569189635112
             le_variance =       0.323976840719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721509060556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215090605559       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215090645439       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215090719531       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215090739145       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215090684796       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215090711626       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215090697275       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 3.354948e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215090605559       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215090615639       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215090634525       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215090639568       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215090625767       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215090632405       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215090628721       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 8.437278e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215090605559       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215090608086       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215090612831       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215090614100       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215090610636       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215090612292       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215090611364       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.112484e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266437 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4844e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.931174e-01 1 1  ON 0
 uu_1                 2.883277e-02 1 1  ON 1
 uu_2                -6.964759e-02 1 1  ON 2
 uu_3                -1.271559e-01 1 1  ON 3
 uu_4                -1.623457e-01 1 1  ON 4
 uu_5                -1.731295e-01 1 1  ON 5
 uu_6                -1.586114e-01 1 1  ON 6
 uu_7                -1.111072e-01 1 1  ON 7
 uu_8                -3.635168e-02 1 1  ON 8
 uu_9                 2.143831e-01 1 1  ON 9
 ud_0                 3.552301e-01 1 1  ON 10
 ud_1                 9.353398e-02 1 1  ON 11
 ud_2                -1.941653e-02 1 1  ON 12
 ud_3                -8.080243e-02 1 1  ON 13
 ud_4                -1.284692e-01 1 1  ON 14
 ud_5                -1.622964e-01 1 1  ON 15
 ud_6                -1.719130e-01 1 1  ON 16
 ud_7                -1.451684e-01 1 1  ON 17
 ud_8                -9.344473e-02 1 1  ON 18
 ud_9                 4.271054e-02 1 1  ON 19
 eO_0                -9.022502e-01 1 1  ON 20
 eO_1                -5.749389e-01 1 1  ON 21
 eO_2                -1.550561e-01 1 1  ON 22
 eO_3                 1.118094e-01 1 1  ON 23
 eO_4                 2.237598e-01 1 1  ON 24
 eO_5                 2.974328e-01 1 1  ON 25
 eO_6                 3.091927e-01 1 1  ON 26
 eO_7                 4.645470e-01 1 1  ON 27
 eO_8                 1.268349e-01 1 1  ON 28
 eO_9                 5.428260e-02 1 1  ON 29
eH1_0                -2.142256e-01 1 1  ON 30
eH1_1                -1.351978e-01 1 1  ON 31
eH1_2                -9.259498e-02 1 1  ON 32
eH1_3                -5.423070e-02 1 1  ON 33
eH1_4                -7.649398e-03 1 1  ON 34
eH1_5                 4.135467e-03 1 1  ON 35
eH1_6                 4.932263e-02 1 1  ON 36
eH1_7                 5.244410e-02 1 1  ON 37
eH1_8                 2.208718e-01 1 1  ON 38
eH1_9                 1.118241e-01 1 1  ON 39
eH2_0                -2.088721e-01 1 1  ON 40
eH2_1                -1.300422e-01 1 1  ON 41
eH2_2                -8.739640e-02 1 1  ON 42
eH2_3                -4.936330e-02 1 1  ON 43
eH2_4                -3.216145e-03 1 1  ON 44
eH2_5                 7.642476e-03 1 1  ON 45
eH2_6                 4.783262e-02 1 1  ON 46
eH2_7                 9.942606e-03 1 1  ON 47
eH2_8                 2.462165e-01 1 1  ON 48
eH2_9                 1.127409e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1796
    reference variance = 0.222333
====================================================
  Execution time = 2.1442e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.5094e-01
  Total weights = 2.0000e+06
  Execution time = 1.6998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351051747308
                                         uncertainty =       0.020205730626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351051747308
                                         uncertainty =       0.020205730626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418886852
  error estimate for blocks of size 2^( 2) =       0.000429023207
  error estimate for blocks of size 2^( 3) =       0.000437574031
  error estimate for blocks of size 2^( 4) =       0.000443235989
  error estimate for blocks of size 2^( 5) =       0.000446995259
  error estimate for blocks of size 2^( 6) =       0.000449365879
  error estimate for blocks of size 2^( 7) =       0.000451663309

      target function =                  N/A
              le_mean =     -17.214457303750
             les_mean =     296.688472477422
             stat err =       0.000447815109
             autocorr =       1.142888927985
              std dev =       0.592395467785
             le_variance =       0.350932390252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351070062832
                                         uncertainty =       0.020206212706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351070062832
                                         uncertainty =       0.020206212706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418897779
  error estimate for blocks of size 2^( 2) =       0.000429033752
  error estimate for blocks of size 2^( 3) =       0.000437584051
  error estimate for blocks of size 2^( 4) =       0.000443245503
  error estimate for blocks of size 2^( 5) =       0.000447004334
  error estimate for blocks of size 2^( 6) =       0.000449374653
  error estimate for blocks of size 2^( 7) =       0.000451671724

      target function =                  N/A
              le_mean =     -17.214457306806
             les_mean =     296.688490890275
             stat err =       0.000447824054
             autocorr =       1.142874962960
              std dev =       0.592410919809
             le_variance =       0.350950697909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351061065623
                                         uncertainty =       0.020205988205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351061065623
                                         uncertainty =       0.020205988205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418892411
  error estimate for blocks of size 2^( 2) =       0.000429028572
  error estimate for blocks of size 2^( 3) =       0.000437579132
  error estimate for blocks of size 2^( 4) =       0.000443240834
  error estimate for blocks of size 2^( 5) =       0.000446999881
  error estimate for blocks of size 2^( 6) =       0.000449370349
  error estimate for blocks of size 2^( 7) =       0.000451667596

      target function =                  N/A
              le_mean =     -17.214457306025
             les_mean =     296.688481870027
             stat err =       0.000447819665
             autocorr =       1.142881849773
              std dev =       0.592403329267
             le_variance =       0.350941704527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351052917155
                                         uncertainty =       0.020205763370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351052917155
                                         uncertainty =       0.020205763370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418887550
  error estimate for blocks of size 2^( 2) =       0.000429023881
  error estimate for blocks of size 2^( 3) =       0.000437574671
  error estimate for blocks of size 2^( 4) =       0.000443236597
  error estimate for blocks of size 2^( 5) =       0.000446995839
  error estimate for blocks of size 2^( 6) =       0.000449366440
  error estimate for blocks of size 2^( 7) =       0.000451663848

      target function =                  N/A
              le_mean =     -17.214457304043
             les_mean =     296.688473656848
             stat err =       0.000447815681
             autocorr =       1.142888040080
              std dev =       0.592396454741
             le_variance =       0.350933559590


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214457303750        initial
     9.5367e+00     9.5367e+01             3.3549e-05       -17.214457306806  <--
     3.8147e+01     3.8147e+02             8.4373e-06       -17.214457306025
     1.5259e+02     1.5259e+03             2.1125e-06       -17.214457304043

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 3.0025e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.931201e-01 1 1  ON 0
 uu_1                 2.882809e-02 1 1  ON 1
 uu_2                -6.964897e-02 1 1  ON 2
 uu_3                -1.271609e-01 1 1  ON 3
 uu_4                -1.623484e-01 1 1  ON 4
 uu_5                -1.731305e-01 1 1  ON 5
 uu_6                -1.586113e-01 1 1  ON 6
 uu_7                -1.111033e-01 1 1  ON 7
 uu_8                -3.634889e-02 1 1  ON 8
 uu_9                 2.143821e-01 1 1  ON 9
 ud_0                 3.552477e-01 1 1  ON 10
 ud_1                 9.353868e-02 1 1  ON 11
 ud_2                -1.941396e-02 1 1  ON 12
 ud_3                -8.080929e-02 1 1  ON 13
 ud_4                -1.284770e-01 1 1  ON 14
 ud_5                -1.623058e-01 1 1  ON 15
 ud_6                -1.719164e-01 1 1  ON 16
 ud_7                -1.451717e-01 1 1  ON 17
 ud_8                -9.344311e-02 1 1  ON 18
 ud_9                 4.271119e-02 1 1  ON 19
 eO_0                -9.022736e-01 1 1  ON 20
 eO_1                -5.749559e-01 1 1  ON 21
 eO_2                -1.550535e-01 1 1  ON 22
 eO_3                 1.118345e-01 1 1  ON 23
 eO_4                 2.237698e-01 1 1  ON 24
 eO_5                 2.974311e-01 1 1  ON 25
 eO_6                 3.091942e-01 1 1  ON 26
 eO_7                 4.645458e-01 1 1  ON 27
 eO_8                 1.268371e-01 1 1  ON 28
 eO_9                 5.428362e-02 1 1  ON 29
eH1_0                -2.142295e-01 1 1  ON 30
eH1_1                -1.351937e-01 1 1  ON 31
eH1_2                -9.259116e-02 1 1  ON 32
eH1_3                -5.423159e-02 1 1  ON 33
eH1_4                -7.650582e-03 1 1  ON 34
eH1_5                 4.140670e-03 1 1  ON 35
eH1_6                 4.931436e-02 1 1  ON 36
eH1_7                 5.244344e-02 1 1  ON 37
eH1_8                 2.208711e-01 1 1  ON 38
eH1_9                 1.118252e-01 1 1  ON 39
eH2_0                -2.088664e-01 1 1  ON 40
eH2_1                -1.300483e-01 1 1  ON 41
eH2_2                -8.739932e-02 1 1  ON 42
eH2_3                -4.936146e-02 1 1  ON 43
eH2_4                -3.225054e-03 1 1  ON 44
eH2_5                 7.641173e-03 1 1  ON 45
eH2_6                 4.783552e-02 1 1  ON 46
eH2_7                 9.951544e-03 1 1  ON 47
eH2_8                 2.462146e-01 1 1  ON 48
eH2_9                 1.127416e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4875e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2002
    reference variance = 0.331972
====================================================
  Execution time = 1.9396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2437e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324390935451
                                         uncertainty =       0.002815809959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324390935451
                                         uncertainty =       0.002815809959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402720560
  error estimate for blocks of size 2^( 2) =       0.000413097564
  error estimate for blocks of size 2^( 3) =       0.000421817817
  error estimate for blocks of size 2^( 4) =       0.000428401348
  error estimate for blocks of size 2^( 5) =       0.000431965605
  error estimate for blocks of size 2^( 6) =       0.000432811921
  error estimate for blocks of size 2^( 7) =       0.000435735893

      target function =                  N/A
              le_mean =     -17.214302726339
             les_mean =     296.656585890667
             stat err =       0.000432228692
             autocorr =       1.151912739526
              std dev =       0.569532877722
             le_variance =       0.324367698806


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721430272634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214302726339       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214303051943       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214303195661       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214303241834       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214303388385       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214303294923       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214303297725       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 9.661926e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214302726339       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214302812612       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214302852407       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214302866005       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214302906929       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214302884367       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214302884109       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.629870e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214302726339       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214302748235       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214302758456       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214302762009       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214302772564       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214302766999       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214302766885       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 6.730151e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4836e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.931464e-01 1 1  ON 0
 uu_1                 2.881331e-02 1 1  ON 1
 uu_2                -6.965385e-02 1 1  ON 2
 uu_3                -1.271687e-01 1 1  ON 3
 uu_4                -1.623555e-01 1 1  ON 4
 uu_5                -1.731327e-01 1 1  ON 5
 uu_6                -1.586072e-01 1 1  ON 6
 uu_7                -1.111005e-01 1 1  ON 7
 uu_8                -3.634877e-02 1 1  ON 8
 uu_9                 2.143789e-01 1 1  ON 9
 ud_0                 3.552733e-01 1 1  ON 10
 ud_1                 9.353502e-02 1 1  ON 11
 ud_2                -1.941450e-02 1 1  ON 12
 ud_3                -8.081969e-02 1 1  ON 13
 ud_4                -1.284911e-01 1 1  ON 14
 ud_5                -1.623065e-01 1 1  ON 15
 ud_6                -1.719185e-01 1 1  ON 16
 ud_7                -1.451675e-01 1 1  ON 17
 ud_8                -9.344283e-02 1 1  ON 18
 ud_9                 4.270969e-02 1 1  ON 19
 eO_0                -9.022941e-01 1 1  ON 20
 eO_1                -5.749700e-01 1 1  ON 21
 eO_2                -1.550501e-01 1 1  ON 22
 eO_3                 1.118555e-01 1 1  ON 23
 eO_4                 2.237746e-01 1 1  ON 24
 eO_5                 2.974328e-01 1 1  ON 25
 eO_6                 3.091968e-01 1 1  ON 26
 eO_7                 4.645439e-01 1 1  ON 27
 eO_8                 1.268392e-01 1 1  ON 28
 eO_9                 5.428436e-02 1 1  ON 29
eH1_0                -2.142307e-01 1 1  ON 30
eH1_1                -1.351999e-01 1 1  ON 31
eH1_2                -9.257689e-02 1 1  ON 32
eH1_3                -5.422963e-02 1 1  ON 33
eH1_4                -7.652474e-03 1 1  ON 34
eH1_5                 4.140735e-03 1 1  ON 35
eH1_6                 4.930636e-02 1 1  ON 36
eH1_7                 5.244464e-02 1 1  ON 37
eH1_8                 2.208685e-01 1 1  ON 38
eH1_9                 1.118263e-01 1 1  ON 39
eH2_0                -2.088720e-01 1 1  ON 40
eH2_1                -1.300565e-01 1 1  ON 41
eH2_2                -8.740397e-02 1 1  ON 42
eH2_3                -4.935861e-02 1 1  ON 43
eH2_4                -3.221166e-03 1 1  ON 44
eH2_5                 7.636340e-03 1 1  ON 45
eH2_6                 4.783938e-02 1 1  ON 46
eH2_7                 9.965473e-03 1 1  ON 47
eH2_8                 2.462134e-01 1 1  ON 48
eH2_9                 1.127413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2264
    reference variance = 0.238606
====================================================
  Execution time = 1.9185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2903e-01
  Total weights = 2.0000e+06
  Execution time = 1.6963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329103417687
                                         uncertainty =       0.011087871925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329103417687
                                         uncertainty =       0.011087871925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405588638
  error estimate for blocks of size 2^( 2) =       0.000415925922
  error estimate for blocks of size 2^( 3) =       0.000424677942
  error estimate for blocks of size 2^( 4) =       0.000430962513
  error estimate for blocks of size 2^( 5) =       0.000433660530
  error estimate for blocks of size 2^( 6) =       0.000435743532
  error estimate for blocks of size 2^( 7) =       0.000436253402

      target function =                  N/A
              le_mean =     -17.213905619576
             les_mean =     296.647550801888
             stat err =       0.000434154994
             autocorr =       1.145824334421
              std dev =       0.573588952754
             le_variance =       0.329004286721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329199363078
                                         uncertainty =       0.011088710092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329199363078
                                         uncertainty =       0.011088710092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405647755
  error estimate for blocks of size 2^( 2) =       0.000415983125
  error estimate for blocks of size 2^( 3) =       0.000424733016
  error estimate for blocks of size 2^( 4) =       0.000431015373
  error estimate for blocks of size 2^( 5) =       0.000433712365
  error estimate for blocks of size 2^( 6) =       0.000435794548
  error estimate for blocks of size 2^( 7) =       0.000436305410

      target function =                  N/A
              le_mean =     -17.213906002305
             les_mean =     296.647659894495
             stat err =       0.000434206924
             autocorr =       1.145764427931
              std dev =       0.573672557175
             le_variance =       0.329100202856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329156343066
                                         uncertainty =       0.011088245531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329156343066
                                         uncertainty =       0.011088245531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405621249
  error estimate for blocks of size 2^( 2) =       0.000415957475
  error estimate for blocks of size 2^( 3) =       0.000424708333
  error estimate for blocks of size 2^( 4) =       0.000430991690
  error estimate for blocks of size 2^( 5) =       0.000433689152
  error estimate for blocks of size 2^( 6) =       0.000435771669
  error estimate for blocks of size 2^( 7) =       0.000436282126

      target function =                  N/A
              le_mean =     -17.213905822219
             les_mean =     296.647610687283
             stat err =       0.000434183659
             autocorr =       1.145791384148
              std dev =       0.573635071779
             le_variance =       0.329057195575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329110209215
                                         uncertainty =       0.011087916918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329110209215
                                         uncertainty =       0.011087916918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405592823
  error estimate for blocks of size 2^( 2) =       0.000415929971
  error estimate for blocks of size 2^( 3) =       0.000424681842
  error estimate for blocks of size 2^( 4) =       0.000430966258
  error estimate for blocks of size 2^( 5) =       0.000433664203
  error estimate for blocks of size 2^( 6) =       0.000435747141
  error estimate for blocks of size 2^( 7) =       0.000436257089

      target function =                  N/A
              le_mean =     -17.213905644757
             les_mean =     296.647558458191
             stat err =       0.000434158673
             autocorr =       1.145820106202
              std dev =       0.573594871065
             le_variance =       0.329011076112


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213905619576        initial
     2.3842e+00     2.3842e+01             9.6619e-05       -17.213906002305  <--
     9.5367e+00     9.5367e+01             2.6299e-05       -17.213905822219
     3.8147e+01     3.8147e+02             6.7302e-06       -17.213905644757

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 2.7753e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.932167e-01 1 1  ON 0
 uu_1                 2.877427e-02 1 1  ON 1
 uu_2                -6.966818e-02 1 1  ON 2
 uu_3                -1.271915e-01 1 1  ON 3
 uu_4                -1.623750e-01 1 1  ON 4
 uu_5                -1.731392e-01 1 1  ON 5
 uu_6                -1.585947e-01 1 1  ON 6
 uu_7                -1.110920e-01 1 1  ON 7
 uu_8                -3.634830e-02 1 1  ON 8
 uu_9                 2.143697e-01 1 1  ON 9
 ud_0                 3.553397e-01 1 1  ON 10
 ud_1                 9.352809e-02 1 1  ON 11
 ud_2                -1.941614e-02 1 1  ON 12
 ud_3                -8.084837e-02 1 1  ON 13
 ud_4                -1.285293e-01 1 1  ON 14
 ud_5                -1.623096e-01 1 1  ON 15
 ud_6                -1.719235e-01 1 1  ON 16
 ud_7                -1.451545e-01 1 1  ON 17
 ud_8                -9.344184e-02 1 1  ON 18
 ud_9                 4.270536e-02 1 1  ON 19
 eO_0                -9.023560e-01 1 1  ON 20
 eO_1                -5.750092e-01 1 1  ON 21
 eO_2                -1.550406e-01 1 1  ON 22
 eO_3                 1.119164e-01 1 1  ON 23
 eO_4                 2.237884e-01 1 1  ON 24
 eO_5                 2.974377e-01 1 1  ON 25
 eO_6                 3.092046e-01 1 1  ON 26
 eO_7                 4.645383e-01 1 1  ON 27
 eO_8                 1.268454e-01 1 1  ON 28
 eO_9                 5.428650e-02 1 1  ON 29
eH1_0                -2.142345e-01 1 1  ON 30
eH1_1                -1.352157e-01 1 1  ON 31
eH1_2                -9.253837e-02 1 1  ON 32
eH1_3                -5.422258e-02 1 1  ON 33
eH1_4                -7.658057e-03 1 1  ON 34
eH1_5                 4.140316e-03 1 1  ON 35
eH1_6                 4.928319e-02 1 1  ON 36
eH1_7                 5.244820e-02 1 1  ON 37
eH1_8                 2.208611e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.088888e-01 1 1  ON 40
eH2_1                -1.300804e-01 1 1  ON 41
eH2_2                -8.741678e-02 1 1  ON 42
eH2_3                -4.935126e-02 1 1  ON 43
eH2_4                -3.210039e-03 1 1  ON 44
eH2_5                 7.622990e-03 1 1  ON 45
eH2_6                 4.785090e-02 1 1  ON 46
eH2_7                 1.000604e-02 1 1  ON 47
eH2_8                 2.462102e-01 1 1  ON 48
eH2_9                 1.127404e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2595e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2611
    reference variance = 0.502045
====================================================
  Execution time = 1.9532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1726e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317270942303
                                         uncertainty =       0.002281520581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317270942303
                                         uncertainty =       0.002281520581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398283479
  error estimate for blocks of size 2^( 2) =       0.000408787963
  error estimate for blocks of size 2^( 3) =       0.000417914690
  error estimate for blocks of size 2^( 4) =       0.000424206691
  error estimate for blocks of size 2^( 5) =       0.000427934368
  error estimate for blocks of size 2^( 6) =       0.000430414362
  error estimate for blocks of size 2^( 7) =       0.000433040228

      target function =                  N/A
              le_mean =     -17.214811424379
             les_mean =     296.666991677874
             stat err =       0.000428898912
             autocorr =       1.159645655087
              std dev =       0.563257897930
             le_variance =       0.317259459580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721481142438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214811424379       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214811335622       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214811264708       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214811194148       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214811332789       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214811330149       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214811211330       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 4.352503e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214811424379       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214811395187       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214811372651       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214811337597       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214811380831       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214811362548       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214811339773       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.156195e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214811424379       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214811416456       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214811410386       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214811399791       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214811410276       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214811404508       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214811398253       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.940649e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270945 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5008e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.932652e-01 1 1  ON 0
 uu_1                 2.874462e-02 1 1  ON 1
 uu_2                -6.966924e-02 1 1  ON 2
 uu_3                -1.272124e-01 1 1  ON 3
 uu_4                -1.623769e-01 1 1  ON 4
 uu_5                -1.731619e-01 1 1  ON 5
 uu_6                -1.585929e-01 1 1  ON 6
 uu_7                -1.110724e-01 1 1  ON 7
 uu_8                -3.633992e-02 1 1  ON 8
 uu_9                 2.143577e-01 1 1  ON 9
 ud_0                 3.553503e-01 1 1  ON 10
 ud_1                 9.354749e-02 1 1  ON 11
 ud_2                -1.941527e-02 1 1  ON 12
 ud_3                -8.088353e-02 1 1  ON 13
 ud_4                -1.285896e-01 1 1  ON 14
 ud_5                -1.623176e-01 1 1  ON 15
 ud_6                -1.718829e-01 1 1  ON 16
 ud_7                -1.451355e-01 1 1  ON 17
 ud_8                -9.342908e-02 1 1  ON 18
 ud_9                 4.269886e-02 1 1  ON 19
 eO_0                -9.024716e-01 1 1  ON 20
 eO_1                -5.750763e-01 1 1  ON 21
 eO_2                -1.550092e-01 1 1  ON 22
 eO_3                 1.119961e-01 1 1  ON 23
 eO_4                 2.238258e-01 1 1  ON 24
 eO_5                 2.974494e-01 1 1  ON 25
 eO_6                 3.092221e-01 1 1  ON 26
 eO_7                 4.645371e-01 1 1  ON 27
 eO_8                 1.268512e-01 1 1  ON 28
 eO_9                 5.428679e-02 1 1  ON 29
eH1_0                -2.142571e-01 1 1  ON 30
eH1_1                -1.352048e-01 1 1  ON 31
eH1_2                -9.251300e-02 1 1  ON 32
eH1_3                -5.424547e-02 1 1  ON 33
eH1_4                -7.644346e-03 1 1  ON 34
eH1_5                 4.138967e-03 1 1  ON 35
eH1_6                 4.926619e-02 1 1  ON 36
eH1_7                 5.245744e-02 1 1  ON 37
eH1_8                 2.208610e-01 1 1  ON 38
eH1_9                 1.118331e-01 1 1  ON 39
eH2_0                -2.089353e-01 1 1  ON 40
eH2_1                -1.301005e-01 1 1  ON 41
eH2_2                -8.741533e-02 1 1  ON 42
eH2_3                -4.934022e-02 1 1  ON 43
eH2_4                -3.181812e-03 1 1  ON 44
eH2_5                 7.608949e-03 1 1  ON 45
eH2_6                 4.785340e-02 1 1  ON 46
eH2_7                 1.005040e-02 1 1  ON 47
eH2_8                 2.462036e-01 1 1  ON 48
eH2_9                 1.127397e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2896
    reference variance = 0.585988
====================================================
  Execution time = 1.9110e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2670e-01
  Total weights = 2.0000e+06
  Execution time = 1.7103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326682805074
                                         uncertainty =       0.004261076880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326682805074
                                         uncertainty =       0.004261076880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404157938
  error estimate for blocks of size 2^( 2) =       0.000413654219
  error estimate for blocks of size 2^( 3) =       0.000422559092
  error estimate for blocks of size 2^( 4) =       0.000429081056
  error estimate for blocks of size 2^( 5) =       0.000432350523
  error estimate for blocks of size 2^( 6) =       0.000434865716
  error estimate for blocks of size 2^( 7) =       0.000436015033

      target function =                  N/A
              le_mean =     -17.214610506632
             les_mean =     296.669502009795
             stat err =       0.000433078082
             autocorr =       1.148233419545
              std dev =       0.571565637620
             le_variance =       0.326687278108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326741780988
                                         uncertainty =       0.004262977598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326741780988
                                         uncertainty =       0.004262977598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404194443
  error estimate for blocks of size 2^( 2) =       0.000413689738
  error estimate for blocks of size 2^( 3) =       0.000422592728
  error estimate for blocks of size 2^( 4) =       0.000429112800
  error estimate for blocks of size 2^( 5) =       0.000432382316
  error estimate for blocks of size 2^( 6) =       0.000434893289
  error estimate for blocks of size 2^( 7) =       0.000436045489

      target function =                  N/A
              le_mean =     -17.214609881590
             les_mean =     296.669539506838
             stat err =       0.000433108473
             autocorr =       1.148187157141
              std dev =       0.571617262570
             le_variance =       0.326746294868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326698733089
                                         uncertainty =       0.004261946343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326698733089
                                         uncertainty =       0.004261946343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404167810
  error estimate for blocks of size 2^( 2) =       0.000413664163
  error estimate for blocks of size 2^( 3) =       0.000422568555
  error estimate for blocks of size 2^( 4) =       0.000429089610
  error estimate for blocks of size 2^( 5) =       0.000432359378
  error estimate for blocks of size 2^( 6) =       0.000434872030
  error estimate for blocks of size 2^( 7) =       0.000436023085

      target function =                  N/A
              le_mean =     -17.214610062355
             les_mean =     296.669502673022
             stat err =       0.000433086026
             autocorr =       1.148219449001
              std dev =       0.571579598512
             le_variance =       0.326703237435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326684051314
                                         uncertainty =       0.004261180004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326684051314
                                         uncertainty =       0.004261180004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404158712
  error estimate for blocks of size 2^( 2) =       0.000413655024
  error estimate for blocks of size 2^( 3) =       0.000422559858
  error estimate for blocks of size 2^( 4) =       0.000429081706
  error estimate for blocks of size 2^( 5) =       0.000432351223
  error estimate for blocks of size 2^( 6) =       0.000434866088
  error estimate for blocks of size 2^( 7) =       0.000436015634

      target function =                  N/A
              le_mean =     -17.214610440778
             les_mean =     296.669500993264
             stat err =       0.000433078663
             autocorr =       1.148232101955
              std dev =       0.571566731755
             le_variance =       0.326688528849


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214610506632        initial  <--
     5.9605e-01     5.9605e+00             4.3525e-04       -17.214609881590
     2.3842e+00     2.3842e+01             1.1562e-04       -17.214610062355
     9.5367e+00     9.5367e+01             2.9406e-05       -17.214610440778

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.7436
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.932167e-01 1 1  ON 0
 uu_1                 2.877427e-02 1 1  ON 1
 uu_2                -6.966818e-02 1 1  ON 2
 uu_3                -1.271915e-01 1 1  ON 3
 uu_4                -1.623750e-01 1 1  ON 4
 uu_5                -1.731392e-01 1 1  ON 5
 uu_6                -1.585947e-01 1 1  ON 6
 uu_7                -1.110920e-01 1 1  ON 7
 uu_8                -3.634830e-02 1 1  ON 8
 uu_9                 2.143697e-01 1 1  ON 9
 ud_0                 3.553397e-01 1 1  ON 10
 ud_1                 9.352809e-02 1 1  ON 11
 ud_2                -1.941614e-02 1 1  ON 12
 ud_3                -8.084837e-02 1 1  ON 13
 ud_4                -1.285293e-01 1 1  ON 14
 ud_5                -1.623096e-01 1 1  ON 15
 ud_6                -1.719235e-01 1 1  ON 16
 ud_7                -1.451545e-01 1 1  ON 17
 ud_8                -9.344184e-02 1 1  ON 18
 ud_9                 4.270536e-02 1 1  ON 19
 eO_0                -9.023560e-01 1 1  ON 20
 eO_1                -5.750092e-01 1 1  ON 21
 eO_2                -1.550406e-01 1 1  ON 22
 eO_3                 1.119164e-01 1 1  ON 23
 eO_4                 2.237884e-01 1 1  ON 24
 eO_5                 2.974377e-01 1 1  ON 25
 eO_6                 3.092046e-01 1 1  ON 26
 eO_7                 4.645383e-01 1 1  ON 27
 eO_8                 1.268454e-01 1 1  ON 28
 eO_9                 5.428650e-02 1 1  ON 29
eH1_0                -2.142345e-01 1 1  ON 30
eH1_1                -1.352157e-01 1 1  ON 31
eH1_2                -9.253837e-02 1 1  ON 32
eH1_3                -5.422258e-02 1 1  ON 33
eH1_4                -7.658057e-03 1 1  ON 34
eH1_5                 4.140316e-03 1 1  ON 35
eH1_6                 4.928319e-02 1 1  ON 36
eH1_7                 5.244820e-02 1 1  ON 37
eH1_8                 2.208611e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.088888e-01 1 1  ON 40
eH2_1                -1.300804e-01 1 1  ON 41
eH2_2                -8.741678e-02 1 1  ON 42
eH2_3                -4.935126e-02 1 1  ON 43
eH2_4                -3.210039e-03 1 1  ON 44
eH2_5                 7.622990e-03 1 1  ON 45
eH2_6                 4.785090e-02 1 1  ON 46
eH2_7                 1.000604e-02 1 1  ON 47
eH2_8                 2.462102e-01 1 1  ON 48
eH2_9                 1.127404e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2255
    reference variance = 0.29048
====================================================
  Execution time = 1.9383e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2533e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325341103571
                                         uncertainty =       0.003879647458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325341103571
                                         uncertainty =       0.003879647458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403315443
  error estimate for blocks of size 2^( 2) =       0.000413606677
  error estimate for blocks of size 2^( 3) =       0.000422853580
  error estimate for blocks of size 2^( 4) =       0.000429623160
  error estimate for blocks of size 2^( 5) =       0.000433445570
  error estimate for blocks of size 2^( 6) =       0.000435697643
  error estimate for blocks of size 2^( 7) =       0.000435193471

      target function =                  N/A
              le_mean =     -17.214345393064
             les_mean =     296.659013842936
             stat err =       0.000433489961
             autocorr =       1.155229802953
              std dev =       0.570374170084
             le_variance =       0.325326693899


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721434539306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214345393064       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214345351695       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214345327331       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214345317420       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214345305415       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214345319100       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214345309553       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.293451e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214345393064       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214345382395       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214345375815       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214345373370       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214345370444       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214345373668       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214345371351       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.076989e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214345393064       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214345390375       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214345388697       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214345388088       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214345387362       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214345388153       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214345387580       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.694221e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4830e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.932242e-01 1 1  ON 0
 uu_1                 2.877183e-02 1 1  ON 1
 uu_2                -6.967357e-02 1 1  ON 2
 uu_3                -1.271923e-01 1 1  ON 3
 uu_4                -1.623815e-01 1 1  ON 4
 uu_5                -1.731371e-01 1 1  ON 5
 uu_6                -1.585937e-01 1 1  ON 6
 uu_7                -1.110890e-01 1 1  ON 7
 uu_8                -3.634675e-02 1 1  ON 8
 uu_9                 2.143684e-01 1 1  ON 9
 ud_0                 3.553480e-01 1 1  ON 10
 ud_1                 9.353001e-02 1 1  ON 11
 ud_2                -1.941690e-02 1 1  ON 12
 ud_3                -8.084980e-02 1 1  ON 13
 ud_4                -1.285372e-01 1 1  ON 14
 ud_5                -1.623110e-01 1 1  ON 15
 ud_6                -1.719208e-01 1 1  ON 16
 ud_7                -1.451550e-01 1 1  ON 17
 ud_8                -9.344272e-02 1 1  ON 18
 ud_9                 4.270419e-02 1 1  ON 19
 eO_0                -9.023631e-01 1 1  ON 20
 eO_1                -5.750181e-01 1 1  ON 21
 eO_2                -1.550392e-01 1 1  ON 22
 eO_3                 1.119272e-01 1 1  ON 23
 eO_4                 2.237911e-01 1 1  ON 24
 eO_5                 2.974373e-01 1 1  ON 25
 eO_6                 3.092058e-01 1 1  ON 26
 eO_7                 4.645377e-01 1 1  ON 27
 eO_8                 1.268461e-01 1 1  ON 28
 eO_9                 5.428676e-02 1 1  ON 29
eH1_0                -2.142350e-01 1 1  ON 30
eH1_1                -1.352177e-01 1 1  ON 31
eH1_2                -9.253540e-02 1 1  ON 32
eH1_3                -5.422110e-02 1 1  ON 33
eH1_4                -7.657867e-03 1 1  ON 34
eH1_5                 4.140282e-03 1 1  ON 35
eH1_6                 4.928009e-02 1 1  ON 36
eH1_7                 5.244915e-02 1 1  ON 37
eH1_8                 2.208610e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.088920e-01 1 1  ON 40
eH2_1                -1.300824e-01 1 1  ON 41
eH2_2                -8.741506e-02 1 1  ON 42
eH2_3                -4.934887e-02 1 1  ON 43
eH2_4                -3.210108e-03 1 1  ON 44
eH2_5                 7.621016e-03 1 1  ON 45
eH2_6                 4.785025e-02 1 1  ON 46
eH2_7                 1.001032e-02 1 1  ON 47
eH2_8                 2.462095e-01 1 1  ON 48
eH2_9                 1.127405e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2093
    reference variance = 0.159904
====================================================
  Execution time = 1.9112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2692e-01
  Total weights = 2.0000e+06
  Execution time = 1.7006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326968650841
                                         uncertainty =       0.004066623318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326968650841
                                         uncertainty =       0.004066623318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404295353
  error estimate for blocks of size 2^( 2) =       0.000414877334
  error estimate for blocks of size 2^( 3) =       0.000423475263
  error estimate for blocks of size 2^( 4) =       0.000429903565
  error estimate for blocks of size 2^( 5) =       0.000434137243
  error estimate for blocks of size 2^( 6) =       0.000435750426
  error estimate for blocks of size 2^( 7) =       0.000437628656

      target function =                  N/A
              le_mean =     -17.214582844791
             les_mean =     296.668771821545
             stat err =       0.000434354972
             autocorr =       1.154229304589
              std dev =       0.571759971334
             le_variance =       0.326909464819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327003008667
                                         uncertainty =       0.004066975973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327003008667
                                         uncertainty =       0.004066975973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404316610
  error estimate for blocks of size 2^( 2) =       0.000414897862
  error estimate for blocks of size 2^( 3) =       0.000423495077
  error estimate for blocks of size 2^( 4) =       0.000429922978
  error estimate for blocks of size 2^( 5) =       0.000434156465
  error estimate for blocks of size 2^( 6) =       0.000435769263
  error estimate for blocks of size 2^( 7) =       0.000437647779

      target function =                  N/A
              le_mean =     -17.214582900974
             les_mean =     296.668808133811
             stat err =       0.000434374121
             autocorr =       1.154209697661
              std dev =       0.571790033827
             le_variance =       0.326943842784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326986655182
                                         uncertainty =       0.004066808003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326986655182
                                         uncertainty =       0.004066808003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404306492
  error estimate for blocks of size 2^( 2) =       0.000414888092
  error estimate for blocks of size 2^( 3) =       0.000423485650
  error estimate for blocks of size 2^( 4) =       0.000429913742
  error estimate for blocks of size 2^( 5) =       0.000434147323
  error estimate for blocks of size 2^( 6) =       0.000435760309
  error estimate for blocks of size 2^( 7) =       0.000437638688

      target function =                  N/A
              le_mean =     -17.214582870756
             les_mean =     296.668790730286
             stat err =       0.000434365016
             autocorr =       1.154219076233
              std dev =       0.571775724945
             le_variance =       0.326927479637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326970928424
                                         uncertainty =       0.004066646688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326970928424
                                         uncertainty =       0.004066646688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404296762
  error estimate for blocks of size 2^( 2) =       0.000414878695
  error estimate for blocks of size 2^( 3) =       0.000423476577
  error estimate for blocks of size 2^( 4) =       0.000429904853
  error estimate for blocks of size 2^( 5) =       0.000434138518
  error estimate for blocks of size 2^( 6) =       0.000435751676
  error estimate for blocks of size 2^( 7) =       0.000437629925

      target function =                  N/A
              le_mean =     -17.214582847860
             les_mean =     296.668774206088
             stat err =       0.000434356243
             autocorr =       1.154228011467
              std dev =       0.571761964217
             le_variance =       0.326911743726


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214582844791        initial
     5.9605e+00     5.9605e+01             4.2935e-05       -17.214582900974  <--
     2.3842e+01     2.3842e+02             1.0770e-05       -17.214582870756
     9.5367e+01     9.5367e+02             2.6942e-06       -17.214582847860

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.7687e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876447e-02 1 1  ON 1
 uu_2                -6.968854e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634214e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353582e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085438e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023846e-01 1 1  ON 20
 eO_1                -5.750441e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092094e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252688e-02 1 1  ON 32
eH1_3                -5.421651e-02 1 1  ON 33
eH1_4                -7.657330e-03 1 1  ON 34
eH1_5                 4.140145e-03 1 1  ON 35
eH1_6                 4.927092e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210309e-03 1 1  ON 44
eH2_5                 7.615139e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002303e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2522e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.259
    reference variance = 0.244572
====================================================
  Execution time = 1.9806e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2568e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325550192599
                                         uncertainty =       0.003359460072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325550192599
                                         uncertainty =       0.003359460072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403536082
  error estimate for blocks of size 2^( 2) =       0.000413389120
  error estimate for blocks of size 2^( 3) =       0.000422101936
  error estimate for blocks of size 2^( 4) =       0.000428897219
  error estimate for blocks of size 2^( 5) =       0.000433612293
  error estimate for blocks of size 2^( 6) =       0.000436585171
  error estimate for blocks of size 2^( 7) =       0.000437655371

      target function =                  N/A
              le_mean =     -17.214151697409
             les_mean =     296.652701236814
             stat err =       0.000434187513
             autocorr =       1.157683688231
              std dev =       0.570686199464
             le_variance =       0.325682738259


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721415169741e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214151697409       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214151679635       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214151715591       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214151912402       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214151473045       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214151545966       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214151676492       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.722103e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214151697409       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214151692387       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214151701861       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214151761601       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214151628517       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214151646806       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214151671718       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.325868e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214151697409       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214151696111       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214151698512       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214151714243       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214151679325       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214151683724       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214151689744       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.084339e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275428 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5283e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.932772e-01 1 1  ON 0
 uu_1                 2.875456e-02 1 1  ON 1
 uu_2                -6.969538e-02 1 1  ON 2
 uu_3                -1.272093e-01 1 1  ON 3
 uu_4                -1.623959e-01 1 1  ON 4
 uu_5                -1.731407e-01 1 1  ON 5
 uu_6                -1.585999e-01 1 1  ON 6
 uu_7                -1.110717e-01 1 1  ON 7
 uu_8                -3.633865e-02 1 1  ON 8
 uu_9                 2.143604e-01 1 1  ON 9
 ud_0                 3.554014e-01 1 1  ON 10
 ud_1                 9.353417e-02 1 1  ON 11
 ud_2                -1.941979e-02 1 1  ON 12
 ud_3                -8.087403e-02 1 1  ON 13
 ud_4                -1.285716e-01 1 1  ON 14
 ud_5                -1.623120e-01 1 1  ON 15
 ud_6                -1.719244e-01 1 1  ON 16
 ud_7                -1.451518e-01 1 1  ON 17
 ud_8                -9.344064e-02 1 1  ON 18
 ud_9                 4.269861e-02 1 1  ON 19
 eO_0                -9.024279e-01 1 1  ON 20
 eO_1                -5.750682e-01 1 1  ON 21
 eO_2                -1.550271e-01 1 1  ON 22
 eO_3                 1.119827e-01 1 1  ON 23
 eO_4                 2.238317e-01 1 1  ON 24
 eO_5                 2.974327e-01 1 1  ON 25
 eO_6                 3.092125e-01 1 1  ON 26
 eO_7                 4.645350e-01 1 1  ON 27
 eO_8                 1.268509e-01 1 1  ON 28
 eO_9                 5.428820e-02 1 1  ON 29
eH1_0                -2.142450e-01 1 1  ON 30
eH1_1                -1.352336e-01 1 1  ON 31
eH1_2                -9.252237e-02 1 1  ON 32
eH1_3                -5.421539e-02 1 1  ON 33
eH1_4                -7.667290e-03 1 1  ON 34
eH1_5                 4.155664e-03 1 1  ON 35
eH1_6                 4.927145e-02 1 1  ON 36
eH1_7                 5.245764e-02 1 1  ON 37
eH1_8                 2.208599e-01 1 1  ON 38
eH1_9                 1.118300e-01 1 1  ON 39
eH2_0                -2.089030e-01 1 1  ON 40
eH2_1                -1.300812e-01 1 1  ON 41
eH2_2                -8.739231e-02 1 1  ON 42
eH2_3                -4.933704e-02 1 1  ON 43
eH2_4                -3.219277e-03 1 1  ON 44
eH2_5                 7.584952e-03 1 1  ON 45
eH2_6                 4.784252e-02 1 1  ON 46
eH2_7                 1.004021e-02 1 1  ON 47
eH2_8                 2.462055e-01 1 1  ON 48
eH2_9                 1.127412e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.3832
    reference variance = 1.68872
====================================================
  Execution time = 1.8915e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.4983e-01
  Total weights = 2.0000e+06
  Execution time = 1.7084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349705937224
                                         uncertainty =       0.021542507959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349705937224
                                         uncertainty =       0.021542507959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418211010
  error estimate for blocks of size 2^( 2) =       0.000428085984
  error estimate for blocks of size 2^( 3) =       0.000436799826
  error estimate for blocks of size 2^( 4) =       0.000443403475
  error estimate for blocks of size 2^( 5) =       0.000447088450
  error estimate for blocks of size 2^( 6) =       0.000448913031
  error estimate for blocks of size 2^( 7) =       0.000451032596

      target function =                  N/A
              le_mean =     -17.214846883750
             les_mean =     296.700753954197
             stat err =       0.000447609388
             autocorr =       1.145532589143
              std dev =       0.591439682591
             le_variance =       0.349800898143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349823708846
                                         uncertainty =       0.021544529315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349823708846
                                         uncertainty =       0.021544529315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418281415
  error estimate for blocks of size 2^( 2) =       0.000428154239
  error estimate for blocks of size 2^( 3) =       0.000436866208
  error estimate for blocks of size 2^( 4) =       0.000443469035
  error estimate for blocks of size 2^( 5) =       0.000447152767
  error estimate for blocks of size 2^( 6) =       0.000448976992
  error estimate for blocks of size 2^( 7) =       0.000451096716

      target function =                  N/A
              le_mean =     -17.214846403321
             les_mean =     296.700855198636
             stat err =       0.000447673877
             autocorr =       1.145476991390
              std dev =       0.591539249459
             le_variance =       0.349918683650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349772962842
                                         uncertainty =       0.021543596848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349772962842
                                         uncertainty =       0.021543596848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418251079
  error estimate for blocks of size 2^( 2) =       0.000428124837
  error estimate for blocks of size 2^( 3) =       0.000436837628
  error estimate for blocks of size 2^( 4) =       0.000443440842
  error estimate for blocks of size 2^( 5) =       0.000447125140
  error estimate for blocks of size 2^( 6) =       0.000448949503
  error estimate for blocks of size 2^( 7) =       0.000451069234

      target function =                  N/A
              le_mean =     -17.214846598596
             les_mean =     296.700811168695
             stat err =       0.000447646180
             autocorr =       1.145501402125
              std dev =       0.591496348632
             le_variance =       0.349867930445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349714600435
                                         uncertainty =       0.021542649671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349714600435
                                         uncertainty =       0.021542649671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418216189
  error estimate for blocks of size 2^( 2) =       0.000428091006
  error estimate for blocks of size 2^( 3) =       0.000436804712
  error estimate for blocks of size 2^( 4) =       0.000443408305
  error estimate for blocks of size 2^( 5) =       0.000447093193
  error estimate for blocks of size 2^( 6) =       0.000448917746
  error estimate for blocks of size 2^( 7) =       0.000451037333

      target function =                  N/A
              le_mean =     -17.214846845617
             les_mean =     296.700761305287
             stat err =       0.000447614144
             autocorr =       1.145528561323
              std dev =       0.591447007056
             le_variance =       0.349809562156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214846883750        initial  <--
     1.4901e+00     1.4901e+01             1.7221e-04       -17.214846403321
     5.9605e+00     5.9605e+01             4.3259e-05       -17.214846598596
     2.3842e+01     2.3842e+02             1.0843e-05       -17.214846845617

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.5994
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876447e-02 1 1  ON 1
 uu_2                -6.968854e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634214e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353582e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085438e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023846e-01 1 1  ON 20
 eO_1                -5.750441e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092094e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252688e-02 1 1  ON 32
eH1_3                -5.421651e-02 1 1  ON 33
eH1_4                -7.657330e-03 1 1  ON 34
eH1_5                 4.140145e-03 1 1  ON 35
eH1_6                 4.927092e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210309e-03 1 1  ON 44
eH2_5                 7.615139e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002303e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2888e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2696
    reference variance = 0.520643
====================================================
  Execution time = 1.9699e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2425e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324311992868
                                         uncertainty =       0.003884161383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324311992868
                                         uncertainty =       0.003884161383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402650388
  error estimate for blocks of size 2^( 2) =       0.000412547049
  error estimate for blocks of size 2^( 3) =       0.000421126587
  error estimate for blocks of size 2^( 4) =       0.000428126527
  error estimate for blocks of size 2^( 5) =       0.000432054636
  error estimate for blocks of size 2^( 6) =       0.000434642967
  error estimate for blocks of size 2^( 7) =       0.000434307783

      target function =                  N/A
              le_mean =     -17.215106580995
             les_mean =     296.684149102684
             stat err =       0.000432282978
             autocorr =       1.152603743640
              std dev =       0.569433639503
             le_variance =       0.324254669798


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721510658099e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215106580995       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215106573582       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215106610329       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215106645521       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215106664820       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215106676126       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215106666200       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.898408e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215106580995       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215106579126       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215106588436       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215106597385       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215106602181       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215106605094       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215106602593       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 4.762745e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215106580995       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215106580527       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215106582862       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215106585109       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215106586306       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215106587040       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215106586413       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.191733e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5156e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.932477e-01 1 1  ON 0
 uu_1                 2.876345e-02 1 1  ON 1
 uu_2                -6.968939e-02 1 1  ON 2
 uu_3                -1.271963e-01 1 1  ON 3
 uu_4                -1.624012e-01 1 1  ON 4
 uu_5                -1.731299e-01 1 1  ON 5
 uu_6                -1.585904e-01 1 1  ON 6
 uu_7                -1.110800e-01 1 1  ON 7
 uu_8                -3.634207e-02 1 1  ON 8
 uu_9                 2.143643e-01 1 1  ON 9
 ud_0                 3.553747e-01 1 1  ON 10
 ud_1                 9.353736e-02 1 1  ON 11
 ud_2                -1.941840e-02 1 1  ON 12
 ud_3                -8.085653e-02 1 1  ON 13
 ud_4                -1.285614e-01 1 1  ON 14
 ud_5                -1.623171e-01 1 1  ON 15
 ud_6                -1.719110e-01 1 1  ON 16
 ud_7                -1.451568e-01 1 1  ON 17
 ud_8                -9.344560e-02 1 1  ON 18
 ud_9                 4.270023e-02 1 1  ON 19
 eO_0                -9.023886e-01 1 1  ON 20
 eO_1                -5.750485e-01 1 1  ON 21
 eO_2                -1.550336e-01 1 1  ON 22
 eO_3                 1.119641e-01 1 1  ON 23
 eO_4                 2.237998e-01 1 1  ON 24
 eO_5                 2.974364e-01 1 1  ON 25
 eO_6                 3.092102e-01 1 1  ON 26
 eO_7                 4.645354e-01 1 1  ON 27
 eO_8                 1.268485e-01 1 1  ON 28
 eO_9                 5.428759e-02 1 1  ON 29
eH1_0                -2.142370e-01 1 1  ON 30
eH1_1                -1.352225e-01 1 1  ON 31
eH1_2                -9.252590e-02 1 1  ON 32
eH1_3                -5.421610e-02 1 1  ON 33
eH1_4                -7.657783e-03 1 1  ON 34
eH1_5                 4.140118e-03 1 1  ON 35
eH1_6                 4.926976e-02 1 1  ON 36
eH1_7                 5.245178e-02 1 1  ON 37
eH1_8                 2.208604e-01 1 1  ON 38
eH1_9                 1.118296e-01 1 1  ON 39
eH2_0                -2.088999e-01 1 1  ON 40
eH2_1                -1.300885e-01 1 1  ON 41
eH2_2                -8.741093e-02 1 1  ON 42
eH2_3                -4.934225e-02 1 1  ON 43
eH2_4                -3.211579e-03 1 1  ON 44
eH2_5                 7.614092e-03 1 1  ON 45
eH2_6                 4.784858e-02 1 1  ON 46
eH2_7                 1.002521e-02 1 1  ON 47
eH2_8                 2.462072e-01 1 1  ON 48
eH2_9                 1.127406e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.272
    reference variance = 0.255466
====================================================
  Execution time = 1.9366e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2652e-01
  Total weights = 2.0000e+06
  Execution time = 1.6948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326210578475
                                         uncertainty =       0.004221829447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326210578475
                                         uncertainty =       0.004221829447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404054217
  error estimate for blocks of size 2^( 2) =       0.000414100915
  error estimate for blocks of size 2^( 3) =       0.000423371167
  error estimate for blocks of size 2^( 4) =       0.000428885749
  error estimate for blocks of size 2^( 5) =       0.000431975913
  error estimate for blocks of size 2^( 6) =       0.000434455626
  error estimate for blocks of size 2^( 7) =       0.000433313708

      target function =                  N/A
              le_mean =     -17.215125198854
             les_mean =     296.687055069197
             stat err =       0.000432157749
             autocorr =       1.143945468125
              std dev =       0.571418953356
             le_variance =       0.326519620254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326220847638
                                         uncertainty =       0.004222034608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326220847638
                                         uncertainty =       0.004222034608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404060577
  error estimate for blocks of size 2^( 2) =       0.000414107076
  error estimate for blocks of size 2^( 3) =       0.000423377051
  error estimate for blocks of size 2^( 4) =       0.000428891349
  error estimate for blocks of size 2^( 5) =       0.000431981330
  error estimate for blocks of size 2^( 6) =       0.000434461125
  error estimate for blocks of size 2^( 7) =       0.000433319101

      target function =                  N/A
              le_mean =     -17.215125142564
             les_mean =     296.687063411132
             stat err =       0.000432163226
             autocorr =       1.143938452081
              std dev =       0.571427948441
             le_variance =       0.326529900260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326215743760
                                         uncertainty =       0.004221932478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326215743760
                                         uncertainty =       0.004221932478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404057416
  error estimate for blocks of size 2^( 2) =       0.000414104014
  error estimate for blocks of size 2^( 3) =       0.000423374127
  error estimate for blocks of size 2^( 4) =       0.000428888567
  error estimate for blocks of size 2^( 5) =       0.000431978639
  error estimate for blocks of size 2^( 6) =       0.000434458395
  error estimate for blocks of size 2^( 7) =       0.000433316425

      target function =                  N/A
              le_mean =     -17.215125170176
             les_mean =     296.687059252552
             stat err =       0.000432160507
             autocorr =       1.143941951946
              std dev =       0.571423477817
             le_variance =       0.326524791001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326211225028
                                         uncertainty =       0.004221842339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326211225028
                                         uncertainty =       0.004221842339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404054617
  error estimate for blocks of size 2^( 2) =       0.000414101303
  error estimate for blocks of size 2^( 3) =       0.000423371538
  error estimate for blocks of size 2^( 4) =       0.000428886102
  error estimate for blocks of size 2^( 5) =       0.000431976254
  error estimate for blocks of size 2^( 6) =       0.000434455972
  error estimate for blocks of size 2^( 7) =       0.000433314048

      target function =                  N/A
              le_mean =     -17.215125195241
             les_mean =     296.687055592063
             stat err =       0.000432158094
             autocorr =       1.143945028318
              std dev =       0.571419519698
             le_variance =       0.326520267492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215125198854        initial  <--
     1.4901e+01     1.4901e+02             1.8984e-05       -17.215125142564
     5.9605e+01     5.9605e+02             4.7627e-06       -17.215125170176
     2.3842e+02     2.3842e+03             1.1917e-06       -17.215125195241

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.9350
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876447e-02 1 1  ON 1
 uu_2                -6.968854e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634214e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353582e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085438e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023846e-01 1 1  ON 20
 eO_1                -5.750441e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092094e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252688e-02 1 1  ON 32
eH1_3                -5.421651e-02 1 1  ON 33
eH1_4                -7.657330e-03 1 1  ON 34
eH1_5                 4.140145e-03 1 1  ON 35
eH1_6                 4.927092e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210309e-03 1 1  ON 44
eH2_5                 7.615139e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002303e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3096e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7232e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2371
    reference variance = 0.163384
====================================================
  Execution time = 2.1730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.4551e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345649587010
                                         uncertainty =       0.021827532982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345649587010
                                         uncertainty =       0.021827532982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415637897
  error estimate for blocks of size 2^( 2) =       0.000425575768
  error estimate for blocks of size 2^( 3) =       0.000434036771
  error estimate for blocks of size 2^( 4) =       0.000440135101
  error estimate for blocks of size 2^( 5) =       0.000443896606
  error estimate for blocks of size 2^( 6) =       0.000446904613
  error estimate for blocks of size 2^( 7) =       0.000446789592

      target function =                  N/A
              le_mean =     -17.214934858108
             les_mean =     296.699491718199
             stat err =       0.000444431478
             autocorr =       1.143350395976
              std dev =       0.587800750284
             le_variance =       0.345509722035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721493485811e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214934858108       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214934857669       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214934858796       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214934858549       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214934858413       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214934858118       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214934858283       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 2.034424e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214934858108       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214934857998       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214934858280       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214934858219       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214934858184       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214934858110       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214934858152       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 5.088420e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214934858108       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214934858081       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214934858151       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214934858136       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214934858128       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214934858114       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214934858119       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.272252e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279847 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7161e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.932456e-01 1 1  ON 0
 uu_1                 2.876438e-02 1 1  ON 1
 uu_2                -6.968858e-02 1 1  ON 2
 uu_3                -1.271954e-01 1 1  ON 3
 uu_4                -1.623999e-01 1 1  ON 4
 uu_5                -1.731314e-01 1 1  ON 5
 uu_6                -1.585909e-01 1 1  ON 6
 uu_7                -1.110798e-01 1 1  ON 7
 uu_8                -3.634208e-02 1 1  ON 8
 uu_9                 2.143647e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353584e-02 1 1  ON 11
 ud_2                -1.941871e-02 1 1  ON 12
 ud_3                -8.085454e-02 1 1  ON 13
 ud_4                -1.285597e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719124e-01 1 1  ON 16
 ud_7                -1.451565e-01 1 1  ON 17
 ud_8                -9.344527e-02 1 1  ON 18
 ud_9                 4.270072e-02 1 1  ON 19
 eO_0                -9.023851e-01 1 1  ON 20
 eO_1                -5.750443e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119597e-01 1 1  ON 23
 eO_4                 2.237991e-01 1 1  ON 24
 eO_5                 2.974360e-01 1 1  ON 25
 eO_6                 3.092095e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428753e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352234e-01 1 1  ON 31
eH1_2                -9.252681e-02 1 1  ON 32
eH1_3                -5.421673e-02 1 1  ON 33
eH1_4                -7.657378e-03 1 1  ON 34
eH1_5                 4.140329e-03 1 1  ON 35
eH1_6                 4.927075e-02 1 1  ON 36
eH1_7                 5.245197e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089018e-01 1 1  ON 40
eH2_1                -1.300880e-01 1 1  ON 41
eH2_2                -8.741003e-02 1 1  ON 42
eH2_3                -4.934175e-02 1 1  ON 43
eH2_4                -3.210221e-03 1 1  ON 44
eH2_5                 7.614966e-03 1 1  ON 45
eH2_6                 4.784823e-02 1 1  ON 46
eH2_7                 1.002315e-02 1 1  ON 47
eH2_8                 2.462074e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1593
    reference variance = 0.264361
====================================================
  Execution time = 1.9186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.4239e-01
  Total weights = 2.0000e+06
  Execution time = 1.7048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342544542481
                                         uncertainty =       0.011984596409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342544542481
                                         uncertainty =       0.011984596409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413758146
  error estimate for blocks of size 2^( 2) =       0.000423603206
  error estimate for blocks of size 2^( 3) =       0.000432079131
  error estimate for blocks of size 2^( 4) =       0.000438874751
  error estimate for blocks of size 2^( 5) =       0.000443357382
  error estimate for blocks of size 2^( 6) =       0.000445641523
  error estimate for blocks of size 2^( 7) =       0.000446678102

      target function =                  N/A
              le_mean =     -17.213925396801
             les_mean =     296.661619001437
             stat err =       0.000443637940
             autocorr =       1.149646299519
              std dev =       0.585142380960
             le_variance =       0.342391605996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342544786735
                                         uncertainty =       0.011984582562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342544786735
                                         uncertainty =       0.011984582562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413758293
  error estimate for blocks of size 2^( 2) =       0.000423603360
  error estimate for blocks of size 2^( 3) =       0.000432079287
  error estimate for blocks of size 2^( 4) =       0.000438874901
  error estimate for blocks of size 2^( 5) =       0.000443357530
  error estimate for blocks of size 2^( 6) =       0.000445641665
  error estimate for blocks of size 2^( 7) =       0.000446678248

      target function =                  N/A
              le_mean =     -17.213925392936
             les_mean =     296.661619112755
             stat err =       0.000443638086
             autocorr =       1.149646238756
              std dev =       0.585142589801
             le_variance =       0.342391850399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342544664351
                                         uncertainty =       0.011984589466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342544664351
                                         uncertainty =       0.011984589466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413758219
  error estimate for blocks of size 2^( 2) =       0.000423603283
  error estimate for blocks of size 2^( 3) =       0.000432079209
  error estimate for blocks of size 2^( 4) =       0.000438874826
  error estimate for blocks of size 2^( 5) =       0.000443357456
  error estimate for blocks of size 2^( 6) =       0.000445641594
  error estimate for blocks of size 2^( 7) =       0.000446678175

      target function =                  N/A
              le_mean =     -17.213925394864
             les_mean =     296.661619056702
             stat err =       0.000443638013
             autocorr =       1.149646269402
              std dev =       0.585142485162
             le_variance =       0.342391727941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342544557706
                                         uncertainty =       0.011984595540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342544557706
                                         uncertainty =       0.011984595540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413758155
  error estimate for blocks of size 2^( 2) =       0.000423603216
  error estimate for blocks of size 2^( 3) =       0.000432079141
  error estimate for blocks of size 2^( 4) =       0.000438874760
  error estimate for blocks of size 2^( 5) =       0.000443357391
  error estimate for blocks of size 2^( 6) =       0.000445641532
  error estimate for blocks of size 2^( 7) =       0.000446678111

      target function =                  N/A
              le_mean =     -17.213925396559
             les_mean =     296.661619008328
             stat err =       0.000443637949
             autocorr =       1.149646295762
              std dev =       0.585142393978
             le_variance =       0.342391621230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213925396801        initial  <--
     1.4901e+02     1.4901e+03             2.0344e-06       -17.213925392936
     5.9605e+02     5.9605e+03             5.0884e-07       -17.213925394864
     2.3842e+03     2.3842e+04             1.2723e-07       -17.213925396559

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.7606
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876447e-02 1 1  ON 1
 uu_2                -6.968854e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634214e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353582e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085438e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023846e-01 1 1  ON 20
 eO_1                -5.750441e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092094e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252688e-02 1 1  ON 32
eH1_3                -5.421651e-02 1 1  ON 33
eH1_4                -7.657330e-03 1 1  ON 34
eH1_5                 4.140145e-03 1 1  ON 35
eH1_6                 4.927092e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210309e-03 1 1  ON 44
eH2_5                 7.615139e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002303e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4927e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2069
    reference variance = 0.170346
====================================================
  Execution time = 1.9474e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3380e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333855551546
                                         uncertainty =       0.007804742177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333855551546
                                         uncertainty =       0.007804742177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408535632
  error estimate for blocks of size 2^( 2) =       0.000418526354
  error estimate for blocks of size 2^( 3) =       0.000427624874
  error estimate for blocks of size 2^( 4) =       0.000434003072
  error estimate for blocks of size 2^( 5) =       0.000437362448
  error estimate for blocks of size 2^( 6) =       0.000440351212
  error estimate for blocks of size 2^( 7) =       0.000442083296

      target function =                  N/A
              le_mean =     -17.214587204771
             les_mean =     296.675815189750
             stat err =       0.000438450007
             autocorr =       1.151808501350
              std dev =       0.577756632131
             le_variance =       0.333802725971


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721458720477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214587204771       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214587204527       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214587204825       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214587204904       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214587205095       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214587205193       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214587205187       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.859224e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214587204771       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214587204710       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214587204785       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214587204804       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214587204852       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214587204876       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214587204870       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 4.648068e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214587204771       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214587204756       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214587204775       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214587204780       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214587204791       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214587204794       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214587204798       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.162018e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282059 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4972e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876446e-02 1 1  ON 1
 uu_2                -6.968854e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634214e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353583e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085441e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023847e-01 1 1  ON 20
 eO_1                -5.750442e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092095e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252688e-02 1 1  ON 32
eH1_3                -5.421652e-02 1 1  ON 33
eH1_4                -7.657340e-03 1 1  ON 34
eH1_5                 4.140145e-03 1 1  ON 35
eH1_6                 4.927091e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741012e-02 1 1  ON 42
eH2_3                -4.934180e-02 1 1  ON 43
eH2_4                -3.210299e-03 1 1  ON 44
eH2_5                 7.615133e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002305e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1828
    reference variance = 0.183796
====================================================
  Execution time = 1.9168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3243e-01
  Total weights = 2.0000e+06
  Execution time = 1.6945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332472260034
                                         uncertainty =       0.013422838936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332472260034
                                         uncertainty =       0.013422838936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407693742
  error estimate for blocks of size 2^( 2) =       0.000418021302
  error estimate for blocks of size 2^( 3) =       0.000426947974
  error estimate for blocks of size 2^( 4) =       0.000433253262
  error estimate for blocks of size 2^( 5) =       0.000437456791
  error estimate for blocks of size 2^( 6) =       0.000439208018
  error estimate for blocks of size 2^( 7) =       0.000441025697

      target function =                  N/A
              le_mean =     -17.213860027957
             les_mean =     296.649405269628
             stat err =       0.000437735942
             autocorr =       1.152806258991
              std dev =       0.576566018539
             le_variance =       0.332428373734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332472321645
                                         uncertainty =       0.013422844040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332472321645
                                         uncertainty =       0.013422844040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407693779
  error estimate for blocks of size 2^( 2) =       0.000418021339
  error estimate for blocks of size 2^( 3) =       0.000426948010
  error estimate for blocks of size 2^( 4) =       0.000433253296
  error estimate for blocks of size 2^( 5) =       0.000437456823
  error estimate for blocks of size 2^( 6) =       0.000439208050
  error estimate for blocks of size 2^( 7) =       0.000441025727

      target function =                  N/A
              le_mean =     -17.213860026552
             les_mean =     296.649405282799
             stat err =       0.000437735974
             autocorr =       1.152806214092
              std dev =       0.576566071920
             le_variance =       0.332428435290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332472290838
                                         uncertainty =       0.013422841488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332472290838
                                         uncertainty =       0.013422841488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407693760
  error estimate for blocks of size 2^( 2) =       0.000418021320
  error estimate for blocks of size 2^( 3) =       0.000426947992
  error estimate for blocks of size 2^( 4) =       0.000433253279
  error estimate for blocks of size 2^( 5) =       0.000437456807
  error estimate for blocks of size 2^( 6) =       0.000439208034
  error estimate for blocks of size 2^( 7) =       0.000441025712

      target function =                  N/A
              le_mean =     -17.213860027255
             les_mean =     296.649405276208
             stat err =       0.000437735958
             autocorr =       1.152806236547
              std dev =       0.576566045228
             le_variance =       0.332428404510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332472263884
                                         uncertainty =       0.013422839255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332472263884
                                         uncertainty =       0.013422839255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407693744
  error estimate for blocks of size 2^( 2) =       0.000418021304
  error estimate for blocks of size 2^( 3) =       0.000426947977
  error estimate for blocks of size 2^( 4) =       0.000433253264
  error estimate for blocks of size 2^( 5) =       0.000437456793
  error estimate for blocks of size 2^( 6) =       0.000439208020
  error estimate for blocks of size 2^( 7) =       0.000441025699

      target function =                  N/A
              le_mean =     -17.213860027870
             les_mean =     296.649405270450
             stat err =       0.000437735944
             autocorr =       1.152806256180
              std dev =       0.576566021875
             le_variance =       0.332428377581


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213860027957        initial  <--
     1.4901e+03     1.4901e+04             1.8592e-07       -17.213860026552
     5.9605e+03     5.9605e+04             4.6481e-08       -17.213860027255
     2.3842e+04     2.3842e+05             1.1620e-08       -17.213860027870

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.7564
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876447e-02 1 1  ON 1
 uu_2                -6.968854e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634214e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353582e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085438e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023846e-01 1 1  ON 20
 eO_1                -5.750441e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092094e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252688e-02 1 1  ON 32
eH1_3                -5.421651e-02 1 1  ON 33
eH1_4                -7.657330e-03 1 1  ON 34
eH1_5                 4.140145e-03 1 1  ON 35
eH1_6                 4.927092e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210309e-03 1 1  ON 44
eH2_5                 7.615139e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002303e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1697
    reference variance = 0.235255
====================================================
  Execution time = 1.9483e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3490e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334958174542
                                         uncertainty =       0.005887952587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334958174542
                                         uncertainty =       0.005887952587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409207113
  error estimate for blocks of size 2^( 2) =       0.000418847426
  error estimate for blocks of size 2^( 3) =       0.000427225120
  error estimate for blocks of size 2^( 4) =       0.000433196362
  error estimate for blocks of size 2^( 5) =       0.000437511173
  error estimate for blocks of size 2^( 6) =       0.000440675250
  error estimate for blocks of size 2^( 7) =       0.000441442317

      target function =                  N/A
              le_mean =     -17.214369131261
             les_mean =     296.669405343251
             stat err =       0.000438206275
             autocorr =       1.146755511549
              std dev =       0.578706249650
             le_variance =       0.334900923384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721436913126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214369131261       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214369131268       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214369131271       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214369131299       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214369131326       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214369131329       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214369131326       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.318930e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214369131261       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214369131263       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214369131264       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214369131271       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214369131279       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214369131288       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214369131325       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 5.797357e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214369131261       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214369131262       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214369131262       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214369131264       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214369131269       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214369131155       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214369131553       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.449341e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284280 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4940e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876447e-02 1 1  ON 1
 uu_2                -6.968854e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634214e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353582e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085438e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023846e-01 1 1  ON 20
 eO_1                -5.750442e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092094e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252688e-02 1 1  ON 32
eH1_3                -5.421651e-02 1 1  ON 33
eH1_4                -7.657333e-03 1 1  ON 34
eH1_5                 4.140145e-03 1 1  ON 35
eH1_6                 4.927092e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210310e-03 1 1  ON 44
eH2_5                 7.615137e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002304e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2136
    reference variance = 0.272075
====================================================
  Execution time = 1.9137e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2616e-01
  Total weights = 2.0000e+06
  Execution time = 1.7024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326073051763
                                         uncertainty =       0.004100575723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326073051763
                                         uncertainty =       0.004100575723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403830821
  error estimate for blocks of size 2^( 2) =       0.000414112459
  error estimate for blocks of size 2^( 3) =       0.000422902442
  error estimate for blocks of size 2^( 4) =       0.000428694135
  error estimate for blocks of size 2^( 5) =       0.000432465468
  error estimate for blocks of size 2^( 6) =       0.000434179547
  error estimate for blocks of size 2^( 7) =       0.000435894384

      target function =                  N/A
              le_mean =     -17.214780140448
             les_mean =     296.674813785376
             stat err =       0.000432808384
             autocorr =       1.148662398560
              std dev =       0.571103024410
             le_variance =       0.326158664490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326073054434
                                         uncertainty =       0.004100575805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326073054434
                                         uncertainty =       0.004100575805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403830823
  error estimate for blocks of size 2^( 2) =       0.000414112460
  error estimate for blocks of size 2^( 3) =       0.000422902443
  error estimate for blocks of size 2^( 4) =       0.000428694137
  error estimate for blocks of size 2^( 5) =       0.000432465469
  error estimate for blocks of size 2^( 6) =       0.000434179548
  error estimate for blocks of size 2^( 7) =       0.000435894385

      target function =                  N/A
              le_mean =     -17.214780140449
             les_mean =     296.674813788079
             stat err =       0.000432808385
             autocorr =       1.148662394602
              std dev =       0.571103026746
             le_variance =       0.326158667158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326073053098
                                         uncertainty =       0.004100575764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326073053098
                                         uncertainty =       0.004100575764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403830822
  error estimate for blocks of size 2^( 2) =       0.000414112459
  error estimate for blocks of size 2^( 3) =       0.000422902443
  error estimate for blocks of size 2^( 4) =       0.000428694136
  error estimate for blocks of size 2^( 5) =       0.000432465469
  error estimate for blocks of size 2^( 6) =       0.000434179547
  error estimate for blocks of size 2^( 7) =       0.000435894385

      target function =                  N/A
              le_mean =     -17.214780140449
             les_mean =     296.674813786728
             stat err =       0.000432808384
             autocorr =       1.148662396587
              std dev =       0.571103025578
             le_variance =       0.326158665824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326073051930
                                         uncertainty =       0.004100575728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326073051930
                                         uncertainty =       0.004100575728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403830821
  error estimate for blocks of size 2^( 2) =       0.000414112459
  error estimate for blocks of size 2^( 3) =       0.000422902442
  error estimate for blocks of size 2^( 4) =       0.000428694135
  error estimate for blocks of size 2^( 5) =       0.000432465468
  error estimate for blocks of size 2^( 6) =       0.000434179547
  error estimate for blocks of size 2^( 7) =       0.000435894384

      target function =                  N/A
              le_mean =     -17.214780140448
             les_mean =     296.674813785545
             stat err =       0.000432808384
             autocorr =       1.148662398310
              std dev =       0.571103024556
             le_variance =       0.326158664657


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214780140448        initial
     1.4901e+04     1.4901e+05             2.3189e-08       -17.214780140449  <--
     5.9605e+04     5.9605e+05             5.7974e-09       -17.214780140449
     2.3842e+05     2.3842e+06             1.4493e-09       -17.214780140448

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 2.7731e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876447e-02 1 1  ON 1
 uu_2                -6.968854e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634214e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353582e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085439e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023847e-01 1 1  ON 20
 eO_1                -5.750442e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092094e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252688e-02 1 1  ON 32
eH1_3                -5.421651e-02 1 1  ON 33
eH1_4                -7.657341e-03 1 1  ON 34
eH1_5                 4.140143e-03 1 1  ON 35
eH1_6                 4.927092e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210314e-03 1 1  ON 44
eH2_5                 7.615131e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002304e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2676e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2419
    reference variance = 0.233601
====================================================
  Execution time = 1.9313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2849e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328587737088
                                         uncertainty =       0.004523762179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328587737088
                                         uncertainty =       0.004523762179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405272462
  error estimate for blocks of size 2^( 2) =       0.000415335743
  error estimate for blocks of size 2^( 3) =       0.000424302760
  error estimate for blocks of size 2^( 4) =       0.000430809346
  error estimate for blocks of size 2^( 5) =       0.000435131158
  error estimate for blocks of size 2^( 6) =       0.000436405095
  error estimate for blocks of size 2^( 7) =       0.000437607882

      target function =                  N/A
              le_mean =     -17.214618061779
             les_mean =     296.671566386258
             stat err =       0.000434988370
             autocorr =       1.152022871289
              std dev =       0.573141812792
             le_variance =       0.328491537570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721461806178e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214618061779       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214618061962       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214618062302       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214618062383       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214618062387       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214618062275       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214618062252       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 1.074276e-07

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214618061779       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214618061825       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214618061910       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214618061930       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214618061930       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214618061911       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214618061876       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.685776e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214618061779       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214618061791       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214618061812       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214618061817       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214618061744       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214618061773       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214618061811       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 6.714493e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4681e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876446e-02 1 1  ON 1
 uu_2                -6.968853e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634214e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353583e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085439e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023847e-01 1 1  ON 20
 eO_1                -5.750442e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092094e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252688e-02 1 1  ON 32
eH1_3                -5.421651e-02 1 1  ON 33
eH1_4                -7.657348e-03 1 1  ON 34
eH1_5                 4.140137e-03 1 1  ON 35
eH1_6                 4.927091e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210324e-03 1 1  ON 44
eH2_5                 7.615129e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002305e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1654
    reference variance = 0.178775
====================================================
  Execution time = 1.8957e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2158e-01
  Total weights = 2.0000e+06
  Execution time = 1.6962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321651746741
                                         uncertainty =       0.002495259911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321651746741
                                         uncertainty =       0.002495259911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400987753
  error estimate for blocks of size 2^( 2) =       0.000411237060
  error estimate for blocks of size 2^( 3) =       0.000420193017
  error estimate for blocks of size 2^( 4) =       0.000426955342
  error estimate for blocks of size 2^( 5) =       0.000430911055
  error estimate for blocks of size 2^( 6) =       0.000432653931
  error estimate for blocks of size 2^( 7) =       0.000434550823

      target function =                  N/A
              le_mean =     -17.214669421144
             les_mean =     296.666425474720
             stat err =       0.000431267788
             autocorr =       1.156729534486
              std dev =       0.567082318752
             le_variance =       0.321582356241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321651765556
                                         uncertainty =       0.002495260097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321651765556
                                         uncertainty =       0.002495260097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400987765
  error estimate for blocks of size 2^( 2) =       0.000411237072
  error estimate for blocks of size 2^( 3) =       0.000420193027
  error estimate for blocks of size 2^( 4) =       0.000426955352
  error estimate for blocks of size 2^( 5) =       0.000430911065
  error estimate for blocks of size 2^( 6) =       0.000432653940
  error estimate for blocks of size 2^( 7) =       0.000434550833

      target function =                  N/A
              le_mean =     -17.214669421387
             les_mean =     296.666425501904
             stat err =       0.000431267797
             autocorr =       1.156729518416
              std dev =       0.567082335340
             le_variance =       0.321582375054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321651756148
                                         uncertainty =       0.002495260004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321651756148
                                         uncertainty =       0.002495260004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400987759
  error estimate for blocks of size 2^( 2) =       0.000411237066
  error estimate for blocks of size 2^( 3) =       0.000420193022
  error estimate for blocks of size 2^( 4) =       0.000426955347
  error estimate for blocks of size 2^( 5) =       0.000430911060
  error estimate for blocks of size 2^( 6) =       0.000432653935
  error estimate for blocks of size 2^( 7) =       0.000434550828

      target function =                  N/A
              le_mean =     -17.214669421266
             les_mean =     296.666425488312
             stat err =       0.000431267792
             autocorr =       1.156729526453
              std dev =       0.567082327045
             le_variance =       0.321582365646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321651747917
                                         uncertainty =       0.002495259922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321651747917
                                         uncertainty =       0.002495259922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400987754
  error estimate for blocks of size 2^( 2) =       0.000411237061
  error estimate for blocks of size 2^( 3) =       0.000420193017
  error estimate for blocks of size 2^( 4) =       0.000426955343
  error estimate for blocks of size 2^( 5) =       0.000430911055
  error estimate for blocks of size 2^( 6) =       0.000432653932
  error estimate for blocks of size 2^( 7) =       0.000434550823

      target function =                  N/A
              le_mean =     -17.214669421159
             les_mean =     296.666425476419
             stat err =       0.000431267788
             autocorr =       1.156729533482
              std dev =       0.567082319788
             le_variance =       0.321582357417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214669421144        initial
     3.7253e+03     3.7253e+04             1.0743e-07       -17.214669421387  <--
     1.4901e+04     1.4901e+05             2.6858e-08       -17.214669421266
     5.9605e+04     5.9605e+05             6.7145e-09       -17.214669421159

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 2.7523e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876445e-02 1 1  ON 1
 uu_2                -6.968853e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634213e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353585e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085441e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023848e-01 1 1  ON 20
 eO_1                -5.750442e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092094e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252687e-02 1 1  ON 32
eH1_3                -5.421649e-02 1 1  ON 33
eH1_4                -7.657369e-03 1 1  ON 34
eH1_5                 4.140119e-03 1 1  ON 35
eH1_6                 4.927088e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210351e-03 1 1  ON 44
eH2_5                 7.615124e-03 1 1  ON 45
eH2_6                 4.784832e-02 1 1  ON 46
eH2_7                 1.002307e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2209e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1737
    reference variance = 0.177934
====================================================
  Execution time = 1.9454e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1780e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317359002473
                                         uncertainty =       0.002350283120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317359002473
                                         uncertainty =       0.002350283120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398624286
  error estimate for blocks of size 2^( 2) =       0.000408561657
  error estimate for blocks of size 2^( 3) =       0.000417444962
  error estimate for blocks of size 2^( 4) =       0.000423806407
  error estimate for blocks of size 2^( 5) =       0.000427202152
  error estimate for blocks of size 2^( 6) =       0.000429172834
  error estimate for blocks of size 2^( 7) =       0.000428592101

      target function =                  N/A
              le_mean =     -17.214703898508
             les_mean =     296.663832797390
             stat err =       0.000427193374
             autocorr =       1.148474894477
              std dev =       0.563739871747
             le_variance =       0.317802642997


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721470389851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214703898508       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214703898481       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214703898900       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214703899529       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214703899471       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214703899153       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214703899238       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.693587e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214703898508       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214703898501       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214703898606       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214703898763       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214703898752       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214703898671       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214703898689       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 6.734088e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214703898508       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214703898506       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214703898532       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214703898571       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214703898566       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214703898544       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214703898547       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.683529e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4862e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.932454e-01 1 1  ON 0
 uu_1                 2.876443e-02 1 1  ON 1
 uu_2                -6.968853e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634213e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353588e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085444e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270073e-02 1 1  ON 19
 eO_0                -9.023848e-01 1 1  ON 20
 eO_1                -5.750442e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119595e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092095e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352234e-01 1 1  ON 31
eH1_2                -9.252685e-02 1 1  ON 32
eH1_3                -5.421649e-02 1 1  ON 33
eH1_4                -7.657376e-03 1 1  ON 34
eH1_5                 4.140105e-03 1 1  ON 35
eH1_6                 4.927087e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741011e-02 1 1  ON 42
eH2_3                -4.934179e-02 1 1  ON 43
eH2_4                -3.210328e-03 1 1  ON 44
eH2_5                 7.615110e-03 1 1  ON 45
eH2_6                 4.784832e-02 1 1  ON 46
eH2_7                 1.002310e-02 1 1  ON 47
eH2_8                 2.462074e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2087
    reference variance = 0.145149
====================================================
  Execution time = 1.9370e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2378e-01
  Total weights = 2.0000e+06
  Execution time = 1.7229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323804775220
                                         uncertainty =       0.003038777904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323804775220
                                         uncertainty =       0.003038777904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402358387
  error estimate for blocks of size 2^( 2) =       0.000412639072
  error estimate for blocks of size 2^( 3) =       0.000421829613
  error estimate for blocks of size 2^( 4) =       0.000428867562
  error estimate for blocks of size 2^( 5) =       0.000432960836
  error estimate for blocks of size 2^( 6) =       0.000435390072
  error estimate for blocks of size 2^( 7) =       0.000437396036

      target function =                  N/A
              le_mean =     -17.215383104038
             les_mean =     296.693199799788
             stat err =       0.000433653627
             autocorr =       1.161608680351
              std dev =       0.569020687565
             le_variance =       0.323784542877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323804847965
                                         uncertainty =       0.003038777655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323804847965
                                         uncertainty =       0.003038777655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402358432
  error estimate for blocks of size 2^( 2) =       0.000412639116
  error estimate for blocks of size 2^( 3) =       0.000421829654
  error estimate for blocks of size 2^( 4) =       0.000428867601
  error estimate for blocks of size 2^( 5) =       0.000432960875
  error estimate for blocks of size 2^( 6) =       0.000435390108
  error estimate for blocks of size 2^( 7) =       0.000437396073

      target function =                  N/A
              le_mean =     -17.215383104013
             les_mean =     296.693199871705
             stat err =       0.000433653664
             autocorr =       1.161608620947
              std dev =       0.569020751524
             le_variance =       0.323784615665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323804811585
                                         uncertainty =       0.003038777779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323804811585
                                         uncertainty =       0.003038777779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402358409
  error estimate for blocks of size 2^( 2) =       0.000412639094
  error estimate for blocks of size 2^( 3) =       0.000421829633
  error estimate for blocks of size 2^( 4) =       0.000428867582
  error estimate for blocks of size 2^( 5) =       0.000432960855
  error estimate for blocks of size 2^( 6) =       0.000435390090
  error estimate for blocks of size 2^( 7) =       0.000437396054

      target function =                  N/A
              le_mean =     -17.215383104026
             les_mean =     296.693199835742
             stat err =       0.000433653645
             autocorr =       1.161608650655
              std dev =       0.569020719539
             le_variance =       0.323784579264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323804779766
                                         uncertainty =       0.003038777888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323804779766
                                         uncertainty =       0.003038777888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402358390
  error estimate for blocks of size 2^( 2) =       0.000412639075
  error estimate for blocks of size 2^( 3) =       0.000421829616
  error estimate for blocks of size 2^( 4) =       0.000428867565
  error estimate for blocks of size 2^( 5) =       0.000432960839
  error estimate for blocks of size 2^( 6) =       0.000435390074
  error estimate for blocks of size 2^( 7) =       0.000437396038

      target function =                  N/A
              le_mean =     -17.215383104037
             les_mean =     296.693199804282
             stat err =       0.000433653629
             autocorr =       1.161608676648
              std dev =       0.569020691562
             le_variance =       0.323784547426


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215383104038        initial  <--
     9.3132e+02     9.3132e+03             2.6936e-07       -17.215383104013
     3.7253e+03     3.7253e+04             6.7341e-08       -17.215383104026
     1.4901e+04     1.4901e+05             1.6835e-08       -17.215383104037

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.9871
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876445e-02 1 1  ON 1
 uu_2                -6.968853e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634213e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353585e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085441e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023848e-01 1 1  ON 20
 eO_1                -5.750442e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092094e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252687e-02 1 1  ON 32
eH1_3                -5.421649e-02 1 1  ON 33
eH1_4                -7.657369e-03 1 1  ON 34
eH1_5                 4.140119e-03 1 1  ON 35
eH1_6                 4.927088e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210351e-03 1 1  ON 44
eH2_5                 7.615124e-03 1 1  ON 45
eH2_6                 4.784832e-02 1 1  ON 46
eH2_7                 1.002307e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2855e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2217
    reference variance = 0.307048
====================================================
  Execution time = 1.9605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3105e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331047707510
                                         uncertainty =       0.004284758493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331047707510
                                         uncertainty =       0.004284758493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406845491
  error estimate for blocks of size 2^( 2) =       0.000416855185
  error estimate for blocks of size 2^( 3) =       0.000425203533
  error estimate for blocks of size 2^( 4) =       0.000432131584
  error estimate for blocks of size 2^( 5) =       0.000437141597
  error estimate for blocks of size 2^( 6) =       0.000439401327
  error estimate for blocks of size 2^( 7) =       0.000440284136

      target function =                  N/A
              le_mean =     -17.214119794994
             les_mean =     296.656966658658
             stat err =       0.000437239661
             autocorr =       1.154994942713
              std dev =       0.575366411742
             le_variance =       0.331046507761


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721411979499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214119794994       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214119795175       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214119795224       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214119795190       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214119795202       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214119795241       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214119795238       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 3.859853e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214119794994       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214119795040       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214119795052       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214119795048       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214119795036       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214119795058       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214119795060       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 9.649707e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214119794994       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214119795006       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214119795009       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214119795007       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214119795045       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214119795104       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214119794955       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 2.412431e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290952 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5100e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876445e-02 1 1  ON 1
 uu_2                -6.968853e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634213e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353585e-02 1 1  ON 11
 ud_2                -1.941873e-02 1 1  ON 12
 ud_3                -8.085442e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023848e-01 1 1  ON 20
 eO_1                -5.750442e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092094e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252687e-02 1 1  ON 32
eH1_3                -5.421649e-02 1 1  ON 33
eH1_4                -7.657370e-03 1 1  ON 34
eH1_5                 4.140118e-03 1 1  ON 35
eH1_6                 4.927088e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210356e-03 1 1  ON 44
eH2_5                 7.615125e-03 1 1  ON 45
eH2_6                 4.784832e-02 1 1  ON 46
eH2_7                 1.002307e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2798
    reference variance = 0.693385
====================================================
  Execution time = 2.1508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2912e-01
  Total weights = 2.0000e+06
  Execution time = 1.7041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329016205917
                                         uncertainty =       0.004231353205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329016205917
                                         uncertainty =       0.004231353205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405661857
  error estimate for blocks of size 2^( 2) =       0.000415273283
  error estimate for blocks of size 2^( 3) =       0.000424067795
  error estimate for blocks of size 2^( 4) =       0.000430504941
  error estimate for blocks of size 2^( 5) =       0.000434941583
  error estimate for blocks of size 2^( 6) =       0.000435651340
  error estimate for blocks of size 2^( 7) =       0.000436952536

      target function =                  N/A
              le_mean =     -17.215118805514
             les_mean =     296.689438408128
             stat err =       0.000434512600
             autocorr =       1.147298432613
              std dev =       0.573692500162
             le_variance =       0.329123084743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329016227168
                                         uncertainty =       0.004231353538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329016227168
                                         uncertainty =       0.004231353538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405661870
  error estimate for blocks of size 2^( 2) =       0.000415273295
  error estimate for blocks of size 2^( 3) =       0.000424067806
  error estimate for blocks of size 2^( 4) =       0.000430504953
  error estimate for blocks of size 2^( 5) =       0.000434941594
  error estimate for blocks of size 2^( 6) =       0.000435651351
  error estimate for blocks of size 2^( 7) =       0.000436952548

      target function =                  N/A
              le_mean =     -17.215118805573
             les_mean =     296.689438431461
             stat err =       0.000434512611
             autocorr =       1.147298417323
              std dev =       0.573692518709
             le_variance =       0.329123106022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329016216542
                                         uncertainty =       0.004231353372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329016216542
                                         uncertainty =       0.004231353372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405661864
  error estimate for blocks of size 2^( 2) =       0.000415273289
  error estimate for blocks of size 2^( 3) =       0.000424067801
  error estimate for blocks of size 2^( 4) =       0.000430504947
  error estimate for blocks of size 2^( 5) =       0.000434941589
  error estimate for blocks of size 2^( 6) =       0.000435651345
  error estimate for blocks of size 2^( 7) =       0.000436952542

      target function =                  N/A
              le_mean =     -17.215118805543
             les_mean =     296.689438419794
             stat err =       0.000434512606
             autocorr =       1.147298424964
              std dev =       0.573692509436
             le_variance =       0.329123095383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329016207245
                                         uncertainty =       0.004231353226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329016207245
                                         uncertainty =       0.004231353226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405661858
  error estimate for blocks of size 2^( 2) =       0.000415273284
  error estimate for blocks of size 2^( 3) =       0.000424067795
  error estimate for blocks of size 2^( 4) =       0.000430504942
  error estimate for blocks of size 2^( 5) =       0.000434941584
  error estimate for blocks of size 2^( 6) =       0.000435651340
  error estimate for blocks of size 2^( 7) =       0.000436952537

      target function =                  N/A
              le_mean =     -17.215118805517
             les_mean =     296.689438409586
             stat err =       0.000434512601
             autocorr =       1.147298431664
              std dev =       0.573692501321
             le_variance =       0.329123086072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215118805514        initial
     9.3132e+03     9.3132e+04             3.8599e-08       -17.215118805573  <--
     3.7253e+04     3.7253e+05             9.6497e-09       -17.215118805543
     1.4901e+05     1.4901e+06             2.4124e-09       -17.215118805517

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 3.0109e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876444e-02 1 1  ON 1
 uu_2                -6.968852e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634213e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353585e-02 1 1  ON 11
 ud_2                -1.941874e-02 1 1  ON 12
 ud_3                -8.085442e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023848e-01 1 1  ON 20
 eO_1                -5.750442e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119594e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092095e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252686e-02 1 1  ON 32
eH1_3                -5.421649e-02 1 1  ON 33
eH1_4                -7.657374e-03 1 1  ON 34
eH1_5                 4.140115e-03 1 1  ON 35
eH1_6                 4.927088e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741012e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210370e-03 1 1  ON 44
eH2_5                 7.615128e-03 1 1  ON 45
eH2_6                 4.784832e-02 1 1  ON 46
eH2_7                 1.002308e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5214e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.168
    reference variance = 0.183769
====================================================
  Execution time = 1.9410e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2859e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4448e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328684651537
                                         uncertainty =       0.006122762640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328684651537
                                         uncertainty =       0.006122762640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405335033
  error estimate for blocks of size 2^( 2) =       0.000415524796
  error estimate for blocks of size 2^( 3) =       0.000424649681
  error estimate for blocks of size 2^( 4) =       0.000431087792
  error estimate for blocks of size 2^( 5) =       0.000434602146
  error estimate for blocks of size 2^( 6) =       0.000437363098
  error estimate for blocks of size 2^( 7) =       0.000438410373

      target function =                  N/A
              le_mean =     -17.215373103077
             les_mean =     296.697663891551
             stat err =       0.000435365852
             autocorr =       1.153666927227
              std dev =       0.573230300759
             le_variance =       0.328592977708


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721537310308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215373103077       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215373102997       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215373102921       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215373102945       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215373103077       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215373102985       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215373102975       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 1.753817e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215373103077       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215373103057       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215373103038       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215373103044       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215373103078       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215373103064       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215373103054       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 4.384784e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215373103077       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215373103072       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215373103067       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215373103068       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215373103077       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215373103072       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215373103079       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.096211e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293188 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4862e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876443e-02 1 1  ON 1
 uu_2                -6.968853e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634213e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353586e-02 1 1  ON 11
 ud_2                -1.941874e-02 1 1  ON 12
 ud_3                -8.085443e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344528e-02 1 1  ON 18
 ud_9                 4.270074e-02 1 1  ON 19
 eO_0                -9.023848e-01 1 1  ON 20
 eO_1                -5.750442e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119595e-01 1 1  ON 23
 eO_4                 2.237990e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092095e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428752e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352235e-01 1 1  ON 31
eH1_2                -9.252686e-02 1 1  ON 32
eH1_3                -5.421649e-02 1 1  ON 33
eH1_4                -7.657380e-03 1 1  ON 34
eH1_5                 4.140115e-03 1 1  ON 35
eH1_6                 4.927087e-02 1 1  ON 36
eH1_7                 5.245198e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934178e-02 1 1  ON 43
eH2_4                -3.210382e-03 1 1  ON 44
eH2_5                 7.615127e-03 1 1  ON 45
eH2_6                 4.784832e-02 1 1  ON 46
eH2_7                 1.002310e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2514
    reference variance = 0.195192
====================================================
  Execution time = 1.9112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2216e-01
  Total weights = 2.0000e+06
  Execution time = 1.7149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322147926619
                                         uncertainty =       0.002963695321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322147926619
                                         uncertainty =       0.002963695321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401346935
  error estimate for blocks of size 2^( 2) =       0.000411646118
  error estimate for blocks of size 2^( 3) =       0.000420719701
  error estimate for blocks of size 2^( 4) =       0.000427020188
  error estimate for blocks of size 2^( 5) =       0.000431625091
  error estimate for blocks of size 2^( 6) =       0.000431537842
  error estimate for blocks of size 2^( 7) =       0.000434137559

      target function =                  N/A
              le_mean =     -17.213803021748
             les_mean =     296.637173034188
             stat err =       0.000431080170
             autocorr =       1.153655632761
              std dev =       0.567590278027
             le_variance =       0.322158723711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322147935445
                                         uncertainty =       0.002963695456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322147935445
                                         uncertainty =       0.002963695456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401346940
  error estimate for blocks of size 2^( 2) =       0.000411646123
  error estimate for blocks of size 2^( 3) =       0.000420719705
  error estimate for blocks of size 2^( 4) =       0.000427020191
  error estimate for blocks of size 2^( 5) =       0.000431625094
  error estimate for blocks of size 2^( 6) =       0.000431537845
  error estimate for blocks of size 2^( 7) =       0.000434137562

      target function =                  N/A
              le_mean =     -17.213803021904
             les_mean =     296.637173048343
             stat err =       0.000431080173
             autocorr =       1.153655617813
              std dev =       0.567590285777
             le_variance =       0.322158732509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322147931030
                                         uncertainty =       0.002963695389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322147931030
                                         uncertainty =       0.002963695389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401346937
  error estimate for blocks of size 2^( 2) =       0.000411646121
  error estimate for blocks of size 2^( 3) =       0.000420719703
  error estimate for blocks of size 2^( 4) =       0.000427020190
  error estimate for blocks of size 2^( 5) =       0.000431625093
  error estimate for blocks of size 2^( 6) =       0.000431537844
  error estimate for blocks of size 2^( 7) =       0.000434137561

      target function =                  N/A
              le_mean =     -17.213803021826
             les_mean =     296.637173041265
             stat err =       0.000431080172
             autocorr =       1.153655625279
              std dev =       0.567590281900
             le_variance =       0.322158728107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322147927171
                                         uncertainty =       0.002963695329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322147927171
                                         uncertainty =       0.002963695329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401346935
  error estimate for blocks of size 2^( 2) =       0.000411646119
  error estimate for blocks of size 2^( 3) =       0.000420719701
  error estimate for blocks of size 2^( 4) =       0.000427020188
  error estimate for blocks of size 2^( 5) =       0.000431625092
  error estimate for blocks of size 2^( 6) =       0.000431537842
  error estimate for blocks of size 2^( 7) =       0.000434137559

      target function =                  N/A
              le_mean =     -17.213803021758
             les_mean =     296.637173035072
             stat err =       0.000431080170
             autocorr =       1.153655631834
              std dev =       0.567590278511
             le_variance =       0.322158724260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213803021748        initial
     2.3283e+03     2.3283e+04             1.7538e-07       -17.213803021904  <--
     9.3132e+03     9.3132e+04             4.3848e-08       -17.213803021826
     3.7253e+04     3.7253e+05             1.0962e-08       -17.213803021758

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 2.7744e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.932453e-01 1 1  ON 0
 uu_1                 2.876439e-02 1 1  ON 1
 uu_2                -6.968855e-02 1 1  ON 2
 uu_3                -1.271955e-01 1 1  ON 3
 uu_4                -1.623998e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634212e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553720e-01 1 1  ON 10
 ud_1                 9.353589e-02 1 1  ON 11
 ud_2                -1.941875e-02 1 1  ON 12
 ud_3                -8.085445e-02 1 1  ON 13
 ud_4                -1.285597e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344526e-02 1 1  ON 18
 ud_9                 4.270075e-02 1 1  ON 19
 eO_0                -9.023850e-01 1 1  ON 20
 eO_1                -5.750442e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119595e-01 1 1  ON 23
 eO_4                 2.237991e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092095e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428753e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352234e-01 1 1  ON 31
eH1_2                -9.252686e-02 1 1  ON 32
eH1_3                -5.421648e-02 1 1  ON 33
eH1_4                -7.657396e-03 1 1  ON 34
eH1_5                 4.140117e-03 1 1  ON 35
eH1_6                 4.927085e-02 1 1  ON 36
eH1_7                 5.245197e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741013e-02 1 1  ON 42
eH2_3                -4.934179e-02 1 1  ON 43
eH2_4                -3.210419e-03 1 1  ON 44
eH2_5                 7.615126e-03 1 1  ON 45
eH2_6                 4.784833e-02 1 1  ON 46
eH2_7                 1.002314e-02 1 1  ON 47
eH2_8                 2.462075e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2612e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1963
    reference variance = 0.436791
====================================================
  Execution time = 1.9490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2288e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322968692133
                                         uncertainty =       0.002877372746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322968692133
                                         uncertainty =       0.002877372746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401795474
  error estimate for blocks of size 2^( 2) =       0.000411727898
  error estimate for blocks of size 2^( 3) =       0.000420619026
  error estimate for blocks of size 2^( 4) =       0.000428582715
  error estimate for blocks of size 2^( 5) =       0.000433514877
  error estimate for blocks of size 2^( 6) =       0.000435327201
  error estimate for blocks of size 2^( 7) =       0.000435634123

      target function =                  N/A
              le_mean =     -17.214314195847
             les_mean =     296.655492277508
             stat err =       0.000433264729
             autocorr =       1.162777422444
              std dev =       0.568224608415
             le_variance =       0.322879205609


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721431419585e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214314195847       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214314196160       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214314198804       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214314198905       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214314198332       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214314198006       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214314198117       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.255596e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214314195847       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214314195925       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214314196586       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214314196611       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214314196468       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214314196388       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214314196415       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 8.137818e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214314195847       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214314195867       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214314196032       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214314196038       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214314196003       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214314195982       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214314195986       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.034381e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295396 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4989e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.932454e-01 1 1  ON 0
 uu_1                 2.876438e-02 1 1  ON 1
 uu_2                -6.968853e-02 1 1  ON 2
 uu_3                -1.271956e-01 1 1  ON 3
 uu_4                -1.623998e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110799e-01 1 1  ON 7
 uu_8                -3.634211e-02 1 1  ON 8
 uu_9                 2.143648e-01 1 1  ON 9
 ud_0                 3.553721e-01 1 1  ON 10
 ud_1                 9.353588e-02 1 1  ON 11
 ud_2                -1.941874e-02 1 1  ON 12
 ud_3                -8.085447e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719126e-01 1 1  ON 16
 ud_7                -1.451566e-01 1 1  ON 17
 ud_8                -9.344527e-02 1 1  ON 18
 ud_9                 4.270073e-02 1 1  ON 19
 eO_0                -9.023851e-01 1 1  ON 20
 eO_1                -5.750443e-01 1 1  ON 21
 eO_2                -1.550353e-01 1 1  ON 22
 eO_3                 1.119596e-01 1 1  ON 23
 eO_4                 2.237991e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092095e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428753e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352234e-01 1 1  ON 31
eH1_2                -9.252684e-02 1 1  ON 32
eH1_3                -5.421650e-02 1 1  ON 33
eH1_4                -7.657397e-03 1 1  ON 34
eH1_5                 4.140133e-03 1 1  ON 35
eH1_6                 4.927082e-02 1 1  ON 36
eH1_7                 5.245197e-02 1 1  ON 37
eH1_8                 2.208608e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089017e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.741008e-02 1 1  ON 42
eH2_3                -4.934179e-02 1 1  ON 43
eH2_4                -3.210434e-03 1 1  ON 44
eH2_5                 7.615091e-03 1 1  ON 45
eH2_6                 4.784832e-02 1 1  ON 46
eH2_7                 1.002319e-02 1 1  ON 47
eH2_8                 2.462074e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2239
    reference variance = 0.247007
====================================================
  Execution time = 1.8913e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2613e-01
  Total weights = 2.0000e+06
  Execution time = 1.6968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326168784423
                                         uncertainty =       0.003157332048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326168784423
                                         uncertainty =       0.003157332048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403810415
  error estimate for blocks of size 2^( 2) =       0.000413969844
  error estimate for blocks of size 2^( 3) =       0.000422612396
  error estimate for blocks of size 2^( 4) =       0.000430298698
  error estimate for blocks of size 2^( 5) =       0.000433840374
  error estimate for blocks of size 2^( 6) =       0.000436430792
  error estimate for blocks of size 2^( 7) =       0.000437624601

      target function =                  N/A
              le_mean =     -17.215052613548
             les_mean =     296.684162027428
             stat err =       0.000434548616
             autocorr =       1.158035065187
              std dev =       0.571074166168
             le_variance =       0.326125703265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326169043349
                                         uncertainty =       0.003157336627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326169043349
                                         uncertainty =       0.003157336627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403810576
  error estimate for blocks of size 2^( 2) =       0.000413969999
  error estimate for blocks of size 2^( 3) =       0.000422612544
  error estimate for blocks of size 2^( 4) =       0.000430298843
  error estimate for blocks of size 2^( 5) =       0.000433840520
  error estimate for blocks of size 2^( 6) =       0.000436430947
  error estimate for blocks of size 2^( 7) =       0.000437624758

      target function =                  N/A
              le_mean =     -17.215052615483
             les_mean =     296.684162352922
             stat err =       0.000434548767
             autocorr =       1.158034947968
              std dev =       0.571074392827
             le_variance =       0.326125962142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326168913927
                                         uncertainty =       0.003157334338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326168913927
                                         uncertainty =       0.003157334338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403810496
  error estimate for blocks of size 2^( 2) =       0.000413969921
  error estimate for blocks of size 2^( 3) =       0.000422612470
  error estimate for blocks of size 2^( 4) =       0.000430298771
  error estimate for blocks of size 2^( 5) =       0.000433840447
  error estimate for blocks of size 2^( 6) =       0.000436430870
  error estimate for blocks of size 2^( 7) =       0.000437624680

      target function =                  N/A
              le_mean =     -17.215052614516
             les_mean =     296.684162190236
             stat err =       0.000434548692
             autocorr =       1.158035006561
              std dev =       0.571074279533
             le_variance =       0.326125832744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326168800612
                                         uncertainty =       0.003157332334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326168800612
                                         uncertainty =       0.003157332334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403810425
  error estimate for blocks of size 2^( 2) =       0.000413969854
  error estimate for blocks of size 2^( 3) =       0.000422612405
  error estimate for blocks of size 2^( 4) =       0.000430298707
  error estimate for blocks of size 2^( 5) =       0.000433840383
  error estimate for blocks of size 2^( 6) =       0.000436430802
  error estimate for blocks of size 2^( 7) =       0.000437624611

      target function =                  N/A
              le_mean =     -17.215052613669
             les_mean =     296.684162047781
             stat err =       0.000434548626
             autocorr =       1.158035057867
              std dev =       0.571074180340
             le_variance =       0.326125719451


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215052613548        initial
     5.8208e+02     5.8208e+03             3.2556e-07       -17.215052615483  <--
     2.3283e+03     2.3283e+04             8.1378e-08       -17.215052614516
     9.3132e+03     9.3132e+04             2.0344e-08       -17.215052613669

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 2.7489e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.932456e-01 1 1  ON 0
 uu_1                 2.876438e-02 1 1  ON 1
 uu_2                -6.968849e-02 1 1  ON 2
 uu_3                -1.271957e-01 1 1  ON 3
 uu_4                -1.623999e-01 1 1  ON 4
 uu_5                -1.731313e-01 1 1  ON 5
 uu_6                -1.585908e-01 1 1  ON 6
 uu_7                -1.110798e-01 1 1  ON 7
 uu_8                -3.634208e-02 1 1  ON 8
 uu_9                 2.143647e-01 1 1  ON 9
 ud_0                 3.553723e-01 1 1  ON 10
 ud_1                 9.353587e-02 1 1  ON 11
 ud_2                -1.941871e-02 1 1  ON 12
 ud_3                -8.085454e-02 1 1  ON 13
 ud_4                -1.285596e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719127e-01 1 1  ON 16
 ud_7                -1.451567e-01 1 1  ON 17
 ud_8                -9.344529e-02 1 1  ON 18
 ud_9                 4.270068e-02 1 1  ON 19
 eO_0                -9.023853e-01 1 1  ON 20
 eO_1                -5.750445e-01 1 1  ON 21
 eO_2                -1.550352e-01 1 1  ON 22
 eO_3                 1.119598e-01 1 1  ON 23
 eO_4                 2.237993e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092095e-01 1 1  ON 26
 eO_7                 4.645358e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428753e-02 1 1  ON 29
eH1_0                -2.142366e-01 1 1  ON 30
eH1_1                -1.352233e-01 1 1  ON 31
eH1_2                -9.252677e-02 1 1  ON 32
eH1_3                -5.421659e-02 1 1  ON 33
eH1_4                -7.657399e-03 1 1  ON 34
eH1_5                 4.140183e-03 1 1  ON 35
eH1_6                 4.927072e-02 1 1  ON 36
eH1_7                 5.245195e-02 1 1  ON 37
eH1_8                 2.208607e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089018e-01 1 1  ON 40
eH2_1                -1.300881e-01 1 1  ON 41
eH2_2                -8.740994e-02 1 1  ON 42
eH2_3                -4.934180e-02 1 1  ON 43
eH2_4                -3.210479e-03 1 1  ON 44
eH2_5                 7.614986e-03 1 1  ON 45
eH2_6                 4.784830e-02 1 1  ON 46
eH2_7                 1.002333e-02 1 1  ON 47
eH2_8                 2.462074e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.196
    reference variance = 0.434484
====================================================
  Execution time = 1.9224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2531e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325312333781
                                         uncertainty =       0.004448818273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325312333781
                                         uncertainty =       0.004448818273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403302157
  error estimate for blocks of size 2^( 2) =       0.000413329203
  error estimate for blocks of size 2^( 3) =       0.000422122342
  error estimate for blocks of size 2^( 4) =       0.000428211261
  error estimate for blocks of size 2^( 5) =       0.000432596610
  error estimate for blocks of size 2^( 6) =       0.000432970214
  error estimate for blocks of size 2^( 7) =       0.000434476149

      target function =                  N/A
              le_mean =     -17.214041091228
             les_mean =     296.648515787847
             stat err =       0.000432063558
             autocorr =       1.147715340000
              std dev =       0.570355380442
             le_variance =       0.325305259999


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721404109123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214041091228       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214041094665       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214041096680       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214041095852       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214041099552       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214041100571       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214041100141       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.161061e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214041091228       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214041092089       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214041092596       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214041092388       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214041093315       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214041093569       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214041093461       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 2.901880e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214041091228       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214041091444       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214041091571       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214041091518       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214041091751       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214041091813       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214041091787       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 7.254215e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297622 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4560e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.932459e-01 1 1  ON 0
 uu_1                 2.876422e-02 1 1  ON 1
 uu_2                -6.968846e-02 1 1  ON 2
 uu_3                -1.271958e-01 1 1  ON 3
 uu_4                -1.623999e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585909e-01 1 1  ON 6
 uu_7                -1.110798e-01 1 1  ON 7
 uu_8                -3.634204e-02 1 1  ON 8
 uu_9                 2.143647e-01 1 1  ON 9
 ud_0                 3.553725e-01 1 1  ON 10
 ud_1                 9.353593e-02 1 1  ON 11
 ud_2                -1.941883e-02 1 1  ON 12
 ud_3                -8.085466e-02 1 1  ON 13
 ud_4                -1.285597e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719126e-01 1 1  ON 16
 ud_7                -1.451567e-01 1 1  ON 17
 ud_8                -9.344532e-02 1 1  ON 18
 ud_9                 4.270065e-02 1 1  ON 19
 eO_0                -9.023856e-01 1 1  ON 20
 eO_1                -5.750448e-01 1 1  ON 21
 eO_2                -1.550352e-01 1 1  ON 22
 eO_3                 1.119601e-01 1 1  ON 23
 eO_4                 2.237995e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092095e-01 1 1  ON 26
 eO_7                 4.645357e-01 1 1  ON 27
 eO_8                 1.268483e-01 1 1  ON 28
 eO_9                 5.428754e-02 1 1  ON 29
eH1_0                -2.142365e-01 1 1  ON 30
eH1_1                -1.352231e-01 1 1  ON 31
eH1_2                -9.252657e-02 1 1  ON 32
eH1_3                -5.421661e-02 1 1  ON 33
eH1_4                -7.657479e-03 1 1  ON 34
eH1_5                 4.139966e-03 1 1  ON 35
eH1_6                 4.927053e-02 1 1  ON 36
eH1_7                 5.245192e-02 1 1  ON 37
eH1_8                 2.208607e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089019e-01 1 1  ON 40
eH2_1                -1.300882e-01 1 1  ON 41
eH2_2                -8.740991e-02 1 1  ON 42
eH2_3                -4.934171e-02 1 1  ON 43
eH2_4                -3.210422e-03 1 1  ON 44
eH2_5                 7.614889e-03 1 1  ON 45
eH2_6                 4.784826e-02 1 1  ON 46
eH2_7                 1.002349e-02 1 1  ON 47
eH2_8                 2.462074e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1767
    reference variance = 0.176807
====================================================
  Execution time = 1.9097e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3596e-01
  Total weights = 2.0000e+06
  Execution time = 1.6971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336021160576
                                         uncertainty =       0.011395194128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336021160576
                                         uncertainty =       0.011395194128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409853109
  error estimate for blocks of size 2^( 2) =       0.000419415542
  error estimate for blocks of size 2^( 3) =       0.000427774319
  error estimate for blocks of size 2^( 4) =       0.000434335409
  error estimate for blocks of size 2^( 5) =       0.000438929975
  error estimate for blocks of size 2^( 6) =       0.000441322553
  error estimate for blocks of size 2^( 7) =       0.000444027755

      target function =                  N/A
              le_mean =     -17.214383053072
             les_mean =     296.670942872338
             stat err =       0.000439653923
             autocorr =       1.150708806066
              std dev =       0.579619825780
             le_variance =       0.335959142437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336022329740
                                         uncertainty =       0.011395232195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336022329740
                                         uncertainty =       0.011395232195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409853822
  error estimate for blocks of size 2^( 2) =       0.000419416220
  error estimate for blocks of size 2^( 3) =       0.000427774968
  error estimate for blocks of size 2^( 4) =       0.000434336036
  error estimate for blocks of size 2^( 5) =       0.000438930611
  error estimate for blocks of size 2^( 6) =       0.000441323190
  error estimate for blocks of size 2^( 7) =       0.000444028394

      target function =                  N/A
              le_mean =     -17.214383060207
             les_mean =     296.670944286885
             stat err =       0.000439654558
             autocorr =       1.150708126866
              std dev =       0.579620834090
             le_variance =       0.335960311311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336021745939
                                         uncertainty =       0.011395213187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336021745939
                                         uncertainty =       0.011395213187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409853466
  error estimate for blocks of size 2^( 2) =       0.000419415881
  error estimate for blocks of size 2^( 3) =       0.000427774644
  error estimate for blocks of size 2^( 4) =       0.000434335723
  error estimate for blocks of size 2^( 5) =       0.000438930293
  error estimate for blocks of size 2^( 6) =       0.000441322872
  error estimate for blocks of size 2^( 7) =       0.000444028075

      target function =                  N/A
              le_mean =     -17.214383056650
             les_mean =     296.670943580753
             stat err =       0.000439654241
             autocorr =       1.150708466021
              std dev =       0.579620330609
             le_variance =       0.335959727655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336021233770
                                         uncertainty =       0.011395196511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336021233770
                                         uncertainty =       0.011395196511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409853154
  error estimate for blocks of size 2^( 2) =       0.000419415584
  error estimate for blocks of size 2^( 3) =       0.000427774360
  error estimate for blocks of size 2^( 4) =       0.000434335448
  error estimate for blocks of size 2^( 5) =       0.000438930014
  error estimate for blocks of size 2^( 6) =       0.000441322592
  error estimate for blocks of size 2^( 7) =       0.000444027795

      target function =                  N/A
              le_mean =     -17.214383053519
             les_mean =     296.670942960921
             stat err =       0.000439653963
             autocorr =       1.150708763543
              std dev =       0.579619888904
             le_variance =       0.335959215613


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214383053072        initial
     1.4552e+02     1.4552e+03             1.1611e-06       -17.214383060207  <--
     5.8208e+02     5.8208e+03             2.9019e-07       -17.214383056650
     2.3283e+03     2.3283e+04             7.2542e-08       -17.214383053519

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 2.7665e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.932466e-01 1 1  ON 0
 uu_1                 2.876375e-02 1 1  ON 1
 uu_2                -6.968838e-02 1 1  ON 2
 uu_3                -1.271961e-01 1 1  ON 3
 uu_4                -1.623999e-01 1 1  ON 4
 uu_5                -1.731309e-01 1 1  ON 5
 uu_6                -1.585914e-01 1 1  ON 6
 uu_7                -1.110798e-01 1 1  ON 7
 uu_8                -3.634191e-02 1 1  ON 8
 uu_9                 2.143645e-01 1 1  ON 9
 ud_0                 3.553733e-01 1 1  ON 10
 ud_1                 9.353612e-02 1 1  ON 11
 ud_2                -1.941919e-02 1 1  ON 12
 ud_3                -8.085499e-02 1 1  ON 13
 ud_4                -1.285601e-01 1 1  ON 14
 ud_5                -1.623155e-01 1 1  ON 15
 ud_6                -1.719123e-01 1 1  ON 16
 ud_7                -1.451569e-01 1 1  ON 17
 ud_8                -9.344541e-02 1 1  ON 18
 ud_9                 4.270054e-02 1 1  ON 19
 eO_0                -9.023865e-01 1 1  ON 20
 eO_1                -5.750456e-01 1 1  ON 21
 eO_2                -1.550352e-01 1 1  ON 22
 eO_3                 1.119609e-01 1 1  ON 23
 eO_4                 2.238002e-01 1 1  ON 24
 eO_5                 2.974363e-01 1 1  ON 25
 eO_6                 3.092096e-01 1 1  ON 26
 eO_7                 4.645356e-01 1 1  ON 27
 eO_8                 1.268484e-01 1 1  ON 28
 eO_9                 5.428758e-02 1 1  ON 29
eH1_0                -2.142361e-01 1 1  ON 30
eH1_1                -1.352225e-01 1 1  ON 31
eH1_2                -9.252599e-02 1 1  ON 32
eH1_3                -5.421666e-02 1 1  ON 33
eH1_4                -7.657720e-03 1 1  ON 34
eH1_5                 4.139317e-03 1 1  ON 35
eH1_6                 4.926996e-02 1 1  ON 36
eH1_7                 5.245184e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089021e-01 1 1  ON 40
eH2_1                -1.300885e-01 1 1  ON 41
eH2_2                -8.740982e-02 1 1  ON 42
eH2_3                -4.934146e-02 1 1  ON 43
eH2_4                -3.210251e-03 1 1  ON 44
eH2_5                 7.614598e-03 1 1  ON 45
eH2_6                 4.784813e-02 1 1  ON 46
eH2_7                 1.002394e-02 1 1  ON 47
eH2_8                 2.462073e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2231e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2258
    reference variance = 0.326886
====================================================
  Execution time = 1.9316e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2615e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326194585556
                                         uncertainty =       0.004089339279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326194585556
                                         uncertainty =       0.004089339279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403823977
  error estimate for blocks of size 2^( 2) =       0.000413809578
  error estimate for blocks of size 2^( 3) =       0.000422694785
  error estimate for blocks of size 2^( 4) =       0.000429071420
  error estimate for blocks of size 2^( 5) =       0.000433551816
  error estimate for blocks of size 2^( 6) =       0.000435030399
  error estimate for blocks of size 2^( 7) =       0.000435066304

      target function =                  N/A
              le_mean =     -17.214823921577
             les_mean =     296.676310096536
             stat err =       0.000433179985
             autocorr =       1.150674690401
              std dev =       0.571093344997
             le_variance =       0.326147608700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721482392158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214823921577       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214823939222       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214823948718       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214823953696       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214823950195       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214823955907       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214823955585       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 6.098401e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214823921577       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214823926019       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214823928405       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214823929666       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214823928825       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214823930241       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214823930161       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.528076e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214823921577       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214823922690       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214823923287       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214823923603       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214823923395       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214823923748       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214823923729       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.822391e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299881 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4655e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.932471e-01 1 1  ON 0
 uu_1                 2.876341e-02 1 1  ON 1
 uu_2                -6.968864e-02 1 1  ON 2
 uu_3                -1.271964e-01 1 1  ON 3
 uu_4                -1.624007e-01 1 1  ON 4
 uu_5                -1.731309e-01 1 1  ON 5
 uu_6                -1.585911e-01 1 1  ON 6
 uu_7                -1.110795e-01 1 1  ON 7
 uu_8                -3.634152e-02 1 1  ON 8
 uu_9                 2.143644e-01 1 1  ON 9
 ud_0                 3.553727e-01 1 1  ON 10
 ud_1                 9.353642e-02 1 1  ON 11
 ud_2                -1.941888e-02 1 1  ON 12
 ud_3                -8.085538e-02 1 1  ON 13
 ud_4                -1.285602e-01 1 1  ON 14
 ud_5                -1.623157e-01 1 1  ON 15
 ud_6                -1.719124e-01 1 1  ON 16
 ud_7                -1.451565e-01 1 1  ON 17
 ud_8                -9.344517e-02 1 1  ON 18
 ud_9                 4.270051e-02 1 1  ON 19
 eO_0                -9.023880e-01 1 1  ON 20
 eO_1                -5.750464e-01 1 1  ON 21
 eO_2                -1.550356e-01 1 1  ON 22
 eO_3                 1.119618e-01 1 1  ON 23
 eO_4                 2.238014e-01 1 1  ON 24
 eO_5                 2.974365e-01 1 1  ON 25
 eO_6                 3.092098e-01 1 1  ON 26
 eO_7                 4.645356e-01 1 1  ON 27
 eO_8                 1.268486e-01 1 1  ON 28
 eO_9                 5.428763e-02 1 1  ON 29
eH1_0                -2.142362e-01 1 1  ON 30
eH1_1                -1.352225e-01 1 1  ON 31
eH1_2                -9.252563e-02 1 1  ON 32
eH1_3                -5.421594e-02 1 1  ON 33
eH1_4                -7.658381e-03 1 1  ON 34
eH1_5                 4.138617e-03 1 1  ON 35
eH1_6                 4.927001e-02 1 1  ON 36
eH1_7                 5.245197e-02 1 1  ON 37
eH1_8                 2.208607e-01 1 1  ON 38
eH1_9                 1.118297e-01 1 1  ON 39
eH2_0                -2.089025e-01 1 1  ON 40
eH2_1                -1.300882e-01 1 1  ON 41
eH2_2                -8.741037e-02 1 1  ON 42
eH2_3                -4.934130e-02 1 1  ON 43
eH2_4                -3.210084e-03 1 1  ON 44
eH2_5                 7.614225e-03 1 1  ON 45
eH2_6                 4.784829e-02 1 1  ON 46
eH2_7                 1.002456e-02 1 1  ON 47
eH2_8                 2.462072e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.0217
    reference variance = 1.99059
====================================================
  Execution time = 1.9083e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2610e-01
  Total weights = 2.0000e+06
  Execution time = 1.7031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326121669165
                                         uncertainty =       0.002985174113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326121669165
                                         uncertainty =       0.002985174113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403796405
  error estimate for blocks of size 2^( 2) =       0.000414015371
  error estimate for blocks of size 2^( 3) =       0.000422860791
  error estimate for blocks of size 2^( 4) =       0.000430176894
  error estimate for blocks of size 2^( 5) =       0.000433132096
  error estimate for blocks of size 2^( 6) =       0.000434745999
  error estimate for blocks of size 2^( 7) =       0.000437070484

      target function =                  N/A
              le_mean =     -17.214998960723
             les_mean =     296.682292128111
             stat err =       0.000433781368
             autocorr =       1.154029451515
              std dev =       0.571054352468
             le_variance =       0.326103073473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119317019
                                         uncertainty =       0.002985153491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119317019
                                         uncertainty =       0.002985153491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403794949
  error estimate for blocks of size 2^( 2) =       0.000414014012
  error estimate for blocks of size 2^( 3) =       0.000422859482
  error estimate for blocks of size 2^( 4) =       0.000430175609
  error estimate for blocks of size 2^( 5) =       0.000433130826
  error estimate for blocks of size 2^( 6) =       0.000434744817
  error estimate for blocks of size 2^( 7) =       0.000437069342

      target function =                  N/A
              le_mean =     -17.214998953301
             les_mean =     296.682289521099
             stat err =       0.000433780149
             autocorr =       1.154031282945
              std dev =       0.571052293567
             le_variance =       0.326100721988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326120476874
                                         uncertainty =       0.002985163639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326120476874
                                         uncertainty =       0.002985163639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403795667
  error estimate for blocks of size 2^( 2) =       0.000414014682
  error estimate for blocks of size 2^( 3) =       0.000422860127
  error estimate for blocks of size 2^( 4) =       0.000430176243
  error estimate for blocks of size 2^( 5) =       0.000433131452
  error estimate for blocks of size 2^( 6) =       0.000434745400
  error estimate for blocks of size 2^( 7) =       0.000437069905

      target function =                  N/A
              le_mean =     -17.214998956987
             les_mean =     296.682290807536
             stat err =       0.000433780750
             autocorr =       1.154030380287
              std dev =       0.571053308821
             le_variance =       0.326101881515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326121519605
                                         uncertainty =       0.002985172799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326121519605
                                         uncertainty =       0.002985172799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403796312
  error estimate for blocks of size 2^( 2) =       0.000414015284
  error estimate for blocks of size 2^( 3) =       0.000422860707
  error estimate for blocks of size 2^( 4) =       0.000430176813
  error estimate for blocks of size 2^( 5) =       0.000433132015
  error estimate for blocks of size 2^( 6) =       0.000434745924
  error estimate for blocks of size 2^( 7) =       0.000437070411

      target function =                  N/A
              le_mean =     -17.214998960254
             les_mean =     296.682291962444
             stat err =       0.000433781291
             autocorr =       1.154029568023
              std dev =       0.571054221554
             le_variance =       0.326102923955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214998960723        initial  <--
     3.6380e+01     3.6380e+02             6.0984e-06       -17.214998953301
     1.4552e+02     1.4552e+03             1.5281e-06       -17.214998956987
     5.8208e+02     5.8208e+03             3.8224e-07       -17.214998960254

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.6971
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.932466e-01 1 1  ON 0
 uu_1                 2.876375e-02 1 1  ON 1
 uu_2                -6.968838e-02 1 1  ON 2
 uu_3                -1.271961e-01 1 1  ON 3
 uu_4                -1.623999e-01 1 1  ON 4
 uu_5                -1.731309e-01 1 1  ON 5
 uu_6                -1.585914e-01 1 1  ON 6
 uu_7                -1.110798e-01 1 1  ON 7
 uu_8                -3.634191e-02 1 1  ON 8
 uu_9                 2.143645e-01 1 1  ON 9
 ud_0                 3.553733e-01 1 1  ON 10
 ud_1                 9.353612e-02 1 1  ON 11
 ud_2                -1.941919e-02 1 1  ON 12
 ud_3                -8.085499e-02 1 1  ON 13
 ud_4                -1.285601e-01 1 1  ON 14
 ud_5                -1.623155e-01 1 1  ON 15
 ud_6                -1.719123e-01 1 1  ON 16
 ud_7                -1.451569e-01 1 1  ON 17
 ud_8                -9.344541e-02 1 1  ON 18
 ud_9                 4.270054e-02 1 1  ON 19
 eO_0                -9.023865e-01 1 1  ON 20
 eO_1                -5.750456e-01 1 1  ON 21
 eO_2                -1.550352e-01 1 1  ON 22
 eO_3                 1.119609e-01 1 1  ON 23
 eO_4                 2.238002e-01 1 1  ON 24
 eO_5                 2.974363e-01 1 1  ON 25
 eO_6                 3.092096e-01 1 1  ON 26
 eO_7                 4.645356e-01 1 1  ON 27
 eO_8                 1.268484e-01 1 1  ON 28
 eO_9                 5.428758e-02 1 1  ON 29
eH1_0                -2.142361e-01 1 1  ON 30
eH1_1                -1.352225e-01 1 1  ON 31
eH1_2                -9.252599e-02 1 1  ON 32
eH1_3                -5.421666e-02 1 1  ON 33
eH1_4                -7.657720e-03 1 1  ON 34
eH1_5                 4.139317e-03 1 1  ON 35
eH1_6                 4.926996e-02 1 1  ON 36
eH1_7                 5.245184e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118295e-01 1 1  ON 39
eH2_0                -2.089021e-01 1 1  ON 40
eH2_1                -1.300885e-01 1 1  ON 41
eH2_2                -8.740982e-02 1 1  ON 42
eH2_3                -4.934146e-02 1 1  ON 43
eH2_4                -3.210251e-03 1 1  ON 44
eH2_5                 7.614598e-03 1 1  ON 45
eH2_6                 4.784813e-02 1 1  ON 46
eH2_7                 1.002394e-02 1 1  ON 47
eH2_8                 2.462073e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2358e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2056
    reference variance = 0.147875
====================================================
  Execution time = 1.9549e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3291e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332906164880
                                         uncertainty =       0.006689429897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332906164880
                                         uncertainty =       0.006689429897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407986189
  error estimate for blocks of size 2^( 2) =       0.000418345929
  error estimate for blocks of size 2^( 3) =       0.000427125569
  error estimate for blocks of size 2^( 4) =       0.000434659958
  error estimate for blocks of size 2^( 5) =       0.000438710433
  error estimate for blocks of size 2^( 6) =       0.000439528244
  error estimate for blocks of size 2^( 7) =       0.000439275662

      target function =                  N/A
              le_mean =     -17.214983876360
             les_mean =     296.688575158028
             stat err =       0.000438043574
             autocorr =       1.152772756108
              std dev =       0.576979602011
             le_variance =       0.332905461137


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721498387636e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214983876360       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214983876473       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214983877091       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214983877715       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214983877919       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214983878356       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214983878245       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 8.511028e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214983876360       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214983876388       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214983876543       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214983876699       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214983876750       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214983876860       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214983876832       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 2.128324e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214983876360       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214983876367       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214983876406       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214983876447       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214983876455       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214983876486       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214983876477       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 5.321164e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5026e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.932467e-01 1 1  ON 0
 uu_1                 2.876376e-02 1 1  ON 1
 uu_2                -6.968839e-02 1 1  ON 2
 uu_3                -1.271962e-01 1 1  ON 3
 uu_4                -1.623999e-01 1 1  ON 4
 uu_5                -1.731310e-01 1 1  ON 5
 uu_6                -1.585914e-01 1 1  ON 6
 uu_7                -1.110798e-01 1 1  ON 7
 uu_8                -3.634191e-02 1 1  ON 8
 uu_9                 2.143645e-01 1 1  ON 9
 ud_0                 3.553734e-01 1 1  ON 10
 ud_1                 9.353620e-02 1 1  ON 11
 ud_2                -1.941923e-02 1 1  ON 12
 ud_3                -8.085503e-02 1 1  ON 13
 ud_4                -1.285602e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719124e-01 1 1  ON 16
 ud_7                -1.451569e-01 1 1  ON 17
 ud_8                -9.344537e-02 1 1  ON 18
 ud_9                 4.270054e-02 1 1  ON 19
 eO_0                -9.023867e-01 1 1  ON 20
 eO_1                -5.750457e-01 1 1  ON 21
 eO_2                -1.550351e-01 1 1  ON 22
 eO_3                 1.119610e-01 1 1  ON 23
 eO_4                 2.238003e-01 1 1  ON 24
 eO_5                 2.974363e-01 1 1  ON 25
 eO_6                 3.092096e-01 1 1  ON 26
 eO_7                 4.645356e-01 1 1  ON 27
 eO_8                 1.268485e-01 1 1  ON 28
 eO_9                 5.428759e-02 1 1  ON 29
eH1_0                -2.142361e-01 1 1  ON 30
eH1_1                -1.352224e-01 1 1  ON 31
eH1_2                -9.252594e-02 1 1  ON 32
eH1_3                -5.421663e-02 1 1  ON 33
eH1_4                -7.657706e-03 1 1  ON 34
eH1_5                 4.139287e-03 1 1  ON 35
eH1_6                 4.926989e-02 1 1  ON 36
eH1_7                 5.245181e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118296e-01 1 1  ON 39
eH2_0                -2.089021e-01 1 1  ON 40
eH2_1                -1.300886e-01 1 1  ON 41
eH2_2                -8.740983e-02 1 1  ON 42
eH2_3                -4.934143e-02 1 1  ON 43
eH2_4                -3.210291e-03 1 1  ON 44
eH2_5                 7.614571e-03 1 1  ON 45
eH2_6                 4.784816e-02 1 1  ON 46
eH2_7                 1.002402e-02 1 1  ON 47
eH2_8                 2.462073e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2032
    reference variance = 0.493615
====================================================
  Execution time = 2.0102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2636e-01
  Total weights = 2.0000e+06
  Execution time = 1.7016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326379234352
                                         uncertainty =       0.003693560259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326379234352
                                         uncertainty =       0.003693560259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403955665
  error estimate for blocks of size 2^( 2) =       0.000413957270
  error estimate for blocks of size 2^( 3) =       0.000422400336
  error estimate for blocks of size 2^( 4) =       0.000428459152
  error estimate for blocks of size 2^( 5) =       0.000432300741
  error estimate for blocks of size 2^( 6) =       0.000432891777
  error estimate for blocks of size 2^( 7) =       0.000432535787

      target function =                  N/A
              le_mean =     -17.214736433206
             les_mean =     296.673510659509
             stat err =       0.000431546864
             autocorr =       1.141270326668
              std dev =       0.571279579478
             le_variance =       0.326360357928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326379445077
                                         uncertainty =       0.003693562062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326379445077
                                         uncertainty =       0.003693562062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403955795
  error estimate for blocks of size 2^( 2) =       0.000413957392
  error estimate for blocks of size 2^( 3) =       0.000422400448
  error estimate for blocks of size 2^( 4) =       0.000428459257
  error estimate for blocks of size 2^( 5) =       0.000432300839
  error estimate for blocks of size 2^( 6) =       0.000432891878
  error estimate for blocks of size 2^( 7) =       0.000432535888

      target function =                  N/A
              le_mean =     -17.214736435691
             les_mean =     296.673510955734
             stat err =       0.000431546965
             autocorr =       1.141270124192
              std dev =       0.571279763864
             le_variance =       0.326360568600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326379339677
                                         uncertainty =       0.003693561160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326379339677
                                         uncertainty =       0.003693561160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403955730
  error estimate for blocks of size 2^( 2) =       0.000413957331
  error estimate for blocks of size 2^( 3) =       0.000422400392
  error estimate for blocks of size 2^( 4) =       0.000428459204
  error estimate for blocks of size 2^( 5) =       0.000432300790
  error estimate for blocks of size 2^( 6) =       0.000432891828
  error estimate for blocks of size 2^( 7) =       0.000432535838

      target function =                  N/A
              le_mean =     -17.214736434450
             les_mean =     296.673510807624
             stat err =       0.000431546915
             autocorr =       1.141270225403
              std dev =       0.571279671638
             le_variance =       0.326360463227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326379247516
                                         uncertainty =       0.003693560371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326379247516
                                         uncertainty =       0.003693560371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403955673
  error estimate for blocks of size 2^( 2) =       0.000413957277
  error estimate for blocks of size 2^( 3) =       0.000422400343
  error estimate for blocks of size 2^( 4) =       0.000428459158
  error estimate for blocks of size 2^( 5) =       0.000432300747
  error estimate for blocks of size 2^( 6) =       0.000432891784
  error estimate for blocks of size 2^( 7) =       0.000432535793

      target function =                  N/A
              le_mean =     -17.214736433362
             les_mean =     296.673510678023
             stat err =       0.000431546871
             autocorr =       1.141270314006
              std dev =       0.571279590997
             le_variance =       0.326360371089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214736433206        initial
     3.6380e+02     3.6380e+03             8.5110e-07       -17.214736435691  <--
     1.4552e+03     1.4552e+04             2.1283e-07       -17.214736434450
     5.8208e+03     5.8208e+04             5.3212e-08       -17.214736433362

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 2.8696e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.932467e-01 1 1  ON 0
 uu_1                 2.876377e-02 1 1  ON 1
 uu_2                -6.968842e-02 1 1  ON 2
 uu_3                -1.271962e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731310e-01 1 1  ON 5
 uu_6                -1.585917e-01 1 1  ON 6
 uu_7                -1.110798e-01 1 1  ON 7
 uu_8                -3.634190e-02 1 1  ON 8
 uu_9                 2.143644e-01 1 1  ON 9
 ud_0                 3.553735e-01 1 1  ON 10
 ud_1                 9.353643e-02 1 1  ON 11
 ud_2                -1.941933e-02 1 1  ON 12
 ud_3                -8.085516e-02 1 1  ON 13
 ud_4                -1.285603e-01 1 1  ON 14
 ud_5                -1.623157e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451569e-01 1 1  ON 17
 ud_8                -9.344526e-02 1 1  ON 18
 ud_9                 4.270054e-02 1 1  ON 19
 eO_0                -9.023873e-01 1 1  ON 20
 eO_1                -5.750460e-01 1 1  ON 21
 eO_2                -1.550349e-01 1 1  ON 22
 eO_3                 1.119613e-01 1 1  ON 23
 eO_4                 2.238007e-01 1 1  ON 24
 eO_5                 2.974363e-01 1 1  ON 25
 eO_6                 3.092095e-01 1 1  ON 26
 eO_7                 4.645355e-01 1 1  ON 27
 eO_8                 1.268485e-01 1 1  ON 28
 eO_9                 5.428761e-02 1 1  ON 29
eH1_0                -2.142364e-01 1 1  ON 30
eH1_1                -1.352221e-01 1 1  ON 31
eH1_2                -9.252578e-02 1 1  ON 32
eH1_3                -5.421653e-02 1 1  ON 33
eH1_4                -7.657663e-03 1 1  ON 34
eH1_5                 4.139197e-03 1 1  ON 35
eH1_6                 4.926967e-02 1 1  ON 36
eH1_7                 5.245174e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118296e-01 1 1  ON 39
eH2_0                -2.089022e-01 1 1  ON 40
eH2_1                -1.300888e-01 1 1  ON 41
eH2_2                -8.740986e-02 1 1  ON 42
eH2_3                -4.934133e-02 1 1  ON 43
eH2_4                -3.210411e-03 1 1  ON 44
eH2_5                 7.614492e-03 1 1  ON 45
eH2_6                 4.784828e-02 1 1  ON 46
eH2_7                 1.002425e-02 1 1  ON 47
eH2_8                 2.462073e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3728e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2311
    reference variance = 0.263116
====================================================
  Execution time = 1.9641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2262e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713950066
                                         uncertainty =       0.003075509300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713950066
                                         uncertainty =       0.003075509300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401634616
  error estimate for blocks of size 2^( 2) =       0.000411744368
  error estimate for blocks of size 2^( 3) =       0.000421072057
  error estimate for blocks of size 2^( 4) =       0.000427591116
  error estimate for blocks of size 2^( 5) =       0.000432241848
  error estimate for blocks of size 2^( 6) =       0.000435428677
  error estimate for blocks of size 2^( 7) =       0.000437468631

      target function =                  N/A
              le_mean =     -17.214529723525
             les_mean =     296.662654170529
             stat err =       0.000433182568
             autocorr =       1.163267701131
              std dev =       0.567997121206
             le_variance =       0.322620729699


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721452972353e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214529723525       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214529722058       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214529721100       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214529722215       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214529720728       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214529725806       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214529725990       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 3.525798e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214529723525       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214529723158       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214529722918       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214529723196       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214529722824       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214529724091       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214529724136       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 8.819396e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214529723525       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214529723434       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214529723373       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214529723444       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214529723350       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214529723667       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214529723678       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 2.205156e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8110e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.932467e-01 1 1  ON 0
 uu_1                 2.876395e-02 1 1  ON 1
 uu_2                -6.968834e-02 1 1  ON 2
 uu_3                -1.271962e-01 1 1  ON 3
 uu_4                -1.624001e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585916e-01 1 1  ON 6
 uu_7                -1.110796e-01 1 1  ON 7
 uu_8                -3.634181e-02 1 1  ON 8
 uu_9                 2.143644e-01 1 1  ON 9
 ud_0                 3.553741e-01 1 1  ON 10
 ud_1                 9.353637e-02 1 1  ON 11
 ud_2                -1.941935e-02 1 1  ON 12
 ud_3                -8.085538e-02 1 1  ON 13
 ud_4                -1.285605e-01 1 1  ON 14
 ud_5                -1.623156e-01 1 1  ON 15
 ud_6                -1.719126e-01 1 1  ON 16
 ud_7                -1.451569e-01 1 1  ON 17
 ud_8                -9.344523e-02 1 1  ON 18
 ud_9                 4.270050e-02 1 1  ON 19
 eO_0                -9.023880e-01 1 1  ON 20
 eO_1                -5.750467e-01 1 1  ON 21
 eO_2                -1.550346e-01 1 1  ON 22
 eO_3                 1.119622e-01 1 1  ON 23
 eO_4                 2.238009e-01 1 1  ON 24
 eO_5                 2.974362e-01 1 1  ON 25
 eO_6                 3.092096e-01 1 1  ON 26
 eO_7                 4.645355e-01 1 1  ON 27
 eO_8                 1.268486e-01 1 1  ON 28
 eO_9                 5.428762e-02 1 1  ON 29
eH1_0                -2.142365e-01 1 1  ON 30
eH1_1                -1.352220e-01 1 1  ON 31
eH1_2                -9.252561e-02 1 1  ON 32
eH1_3                -5.421645e-02 1 1  ON 33
eH1_4                -7.657827e-03 1 1  ON 34
eH1_5                 4.139256e-03 1 1  ON 35
eH1_6                 4.926953e-02 1 1  ON 36
eH1_7                 5.245170e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118296e-01 1 1  ON 39
eH2_0                -2.089022e-01 1 1  ON 40
eH2_1                -1.300887e-01 1 1  ON 41
eH2_2                -8.740970e-02 1 1  ON 42
eH2_3                -4.934165e-02 1 1  ON 43
eH2_4                -3.210447e-03 1 1  ON 44
eH2_5                 7.614280e-03 1 1  ON 45
eH2_6                 4.784835e-02 1 1  ON 46
eH2_7                 1.002453e-02 1 1  ON 47
eH2_8                 2.462072e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2218
    reference variance = 0.489986
====================================================
  Execution time = 1.9254e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2652e-01
  Total weights = 2.0000e+06
  Execution time = 1.6953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326594061404
                                         uncertainty =       0.006713364153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326594061404
                                         uncertainty =       0.006713364153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404052317
  error estimate for blocks of size 2^( 2) =       0.000414277021
  error estimate for blocks of size 2^( 3) =       0.000423009834
  error estimate for blocks of size 2^( 4) =       0.000429705824
  error estimate for blocks of size 2^( 5) =       0.000433667193
  error estimate for blocks of size 2^( 6) =       0.000436026653
  error estimate for blocks of size 2^( 7) =       0.000436381960

      target function =                  N/A
              le_mean =     -17.214020269953
             les_mean =     296.649010240242
             stat err =       0.000433945407
             autocorr =       1.153439953276
              std dev =       0.571416266088
             le_variance =       0.326516549150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326595844868
                                         uncertainty =       0.006713374858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326595844868
                                         uncertainty =       0.006713374858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404053420
  error estimate for blocks of size 2^( 2) =       0.000414278083
  error estimate for blocks of size 2^( 3) =       0.000423010858
  error estimate for blocks of size 2^( 4) =       0.000429706834
  error estimate for blocks of size 2^( 5) =       0.000433668170
  error estimate for blocks of size 2^( 6) =       0.000436027619
  error estimate for blocks of size 2^( 7) =       0.000436382942

      target function =                  N/A
              le_mean =     -17.214020263303
             les_mean =     296.649011794474
             stat err =       0.000433946391
             autocorr =       1.153438883906
              std dev =       0.571417826400
             le_variance =       0.326518332328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326594955426
                                         uncertainty =       0.006713369534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326594955426
                                         uncertainty =       0.006713369534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404052870
  error estimate for blocks of size 2^( 2) =       0.000414277553
  error estimate for blocks of size 2^( 3) =       0.000423010347
  error estimate for blocks of size 2^( 4) =       0.000429706330
  error estimate for blocks of size 2^( 5) =       0.000433667683
  error estimate for blocks of size 2^( 6) =       0.000436027137
  error estimate for blocks of size 2^( 7) =       0.000436382452

      target function =                  N/A
              le_mean =     -17.214020266623
             les_mean =     296.649011019471
             stat err =       0.000433945901
             autocorr =       1.153439417546
              std dev =       0.571417048248
             le_variance =       0.326517443029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326594173226
                                         uncertainty =       0.006713364827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326594173226
                                         uncertainty =       0.006713364827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404052386
  error estimate for blocks of size 2^( 2) =       0.000414277088
  error estimate for blocks of size 2^( 3) =       0.000423009899
  error estimate for blocks of size 2^( 4) =       0.000429705888
  error estimate for blocks of size 2^( 5) =       0.000433667254
  error estimate for blocks of size 2^( 6) =       0.000436026714
  error estimate for blocks of size 2^( 7) =       0.000436382021

      target function =                  N/A
              le_mean =     -17.214020269536
             les_mean =     296.649010337700
             stat err =       0.000433945469
             autocorr =       1.153439886282
              std dev =       0.571416363919
             le_variance =       0.326516660955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214020269953        initial  <--
     9.0949e+01     9.0949e+02             3.5258e-06       -17.214020263303
     3.6380e+02     3.6380e+03             8.8194e-07       -17.214020266623
     1.4552e+03     1.4552e+04             2.2052e-07       -17.214020269536

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.8199
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.932467e-01 1 1  ON 0
 uu_1                 2.876377e-02 1 1  ON 1
 uu_2                -6.968842e-02 1 1  ON 2
 uu_3                -1.271962e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731310e-01 1 1  ON 5
 uu_6                -1.585917e-01 1 1  ON 6
 uu_7                -1.110798e-01 1 1  ON 7
 uu_8                -3.634190e-02 1 1  ON 8
 uu_9                 2.143644e-01 1 1  ON 9
 ud_0                 3.553735e-01 1 1  ON 10
 ud_1                 9.353643e-02 1 1  ON 11
 ud_2                -1.941933e-02 1 1  ON 12
 ud_3                -8.085516e-02 1 1  ON 13
 ud_4                -1.285603e-01 1 1  ON 14
 ud_5                -1.623157e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451569e-01 1 1  ON 17
 ud_8                -9.344526e-02 1 1  ON 18
 ud_9                 4.270054e-02 1 1  ON 19
 eO_0                -9.023873e-01 1 1  ON 20
 eO_1                -5.750460e-01 1 1  ON 21
 eO_2                -1.550349e-01 1 1  ON 22
 eO_3                 1.119613e-01 1 1  ON 23
 eO_4                 2.238007e-01 1 1  ON 24
 eO_5                 2.974363e-01 1 1  ON 25
 eO_6                 3.092095e-01 1 1  ON 26
 eO_7                 4.645355e-01 1 1  ON 27
 eO_8                 1.268485e-01 1 1  ON 28
 eO_9                 5.428761e-02 1 1  ON 29
eH1_0                -2.142364e-01 1 1  ON 30
eH1_1                -1.352221e-01 1 1  ON 31
eH1_2                -9.252578e-02 1 1  ON 32
eH1_3                -5.421653e-02 1 1  ON 33
eH1_4                -7.657663e-03 1 1  ON 34
eH1_5                 4.139197e-03 1 1  ON 35
eH1_6                 4.926967e-02 1 1  ON 36
eH1_7                 5.245174e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118296e-01 1 1  ON 39
eH2_0                -2.089022e-01 1 1  ON 40
eH2_1                -1.300888e-01 1 1  ON 41
eH2_2                -8.740986e-02 1 1  ON 42
eH2_3                -4.934133e-02 1 1  ON 43
eH2_4                -3.210411e-03 1 1  ON 44
eH2_5                 7.614492e-03 1 1  ON 45
eH2_6                 4.784828e-02 1 1  ON 46
eH2_7                 1.002425e-02 1 1  ON 47
eH2_8                 2.462073e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2836
    reference variance = 0.229549
====================================================
  Execution time = 1.9104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2239e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322451759104
                                         uncertainty =       0.003174481716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322451759104
                                         uncertainty =       0.003174481716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401490690
  error estimate for blocks of size 2^( 2) =       0.000411470109
  error estimate for blocks of size 2^( 3) =       0.000420813311
  error estimate for blocks of size 2^( 4) =       0.000427136113
  error estimate for blocks of size 2^( 5) =       0.000431228493
  error estimate for blocks of size 2^( 6) =       0.000431594267
  error estimate for blocks of size 2^( 7) =       0.000432034579

      target function =                  N/A
              le_mean =     -17.214156645472
             les_mean =     296.649578401267
             stat err =       0.000430498363
             autocorr =       1.149719908562
              std dev =       0.567793578351
             le_variance =       0.322389547617


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721415664547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214156645472       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214156645724       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214156646123       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214156646287       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214156646498       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214156646243       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214156646307       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 2.729994e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214156645472       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214156645535       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214156645635       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214156645676       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214156645729       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214156645661       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214156645679       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 6.825149e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214156645472       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214156645488       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214156645513       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214156645523       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214156645535       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214156645499       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214156645506       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.706297e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306679 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4545e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.932468e-01 1 1  ON 0
 uu_1                 2.876376e-02 1 1  ON 1
 uu_2                -6.968844e-02 1 1  ON 2
 uu_3                -1.271963e-01 1 1  ON 3
 uu_4                -1.623997e-01 1 1  ON 4
 uu_5                -1.731310e-01 1 1  ON 5
 uu_6                -1.585916e-01 1 1  ON 6
 uu_7                -1.110797e-01 1 1  ON 7
 uu_8                -3.634189e-02 1 1  ON 8
 uu_9                 2.143644e-01 1 1  ON 9
 ud_0                 3.553736e-01 1 1  ON 10
 ud_1                 9.353645e-02 1 1  ON 11
 ud_2                -1.941935e-02 1 1  ON 12
 ud_3                -8.085518e-02 1 1  ON 13
 ud_4                -1.285603e-01 1 1  ON 14
 ud_5                -1.623157e-01 1 1  ON 15
 ud_6                -1.719126e-01 1 1  ON 16
 ud_7                -1.451569e-01 1 1  ON 17
 ud_8                -9.344527e-02 1 1  ON 18
 ud_9                 4.270054e-02 1 1  ON 19
 eO_0                -9.023874e-01 1 1  ON 20
 eO_1                -5.750461e-01 1 1  ON 21
 eO_2                -1.550348e-01 1 1  ON 22
 eO_3                 1.119613e-01 1 1  ON 23
 eO_4                 2.238007e-01 1 1  ON 24
 eO_5                 2.974363e-01 1 1  ON 25
 eO_6                 3.092096e-01 1 1  ON 26
 eO_7                 4.645355e-01 1 1  ON 27
 eO_8                 1.268485e-01 1 1  ON 28
 eO_9                 5.428761e-02 1 1  ON 29
eH1_0                -2.142364e-01 1 1  ON 30
eH1_1                -1.352221e-01 1 1  ON 31
eH1_2                -9.252576e-02 1 1  ON 32
eH1_3                -5.421653e-02 1 1  ON 33
eH1_4                -7.657666e-03 1 1  ON 34
eH1_5                 4.139179e-03 1 1  ON 35
eH1_6                 4.926964e-02 1 1  ON 36
eH1_7                 5.245175e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118296e-01 1 1  ON 39
eH2_0                -2.089022e-01 1 1  ON 40
eH2_1                -1.300888e-01 1 1  ON 41
eH2_2                -8.740986e-02 1 1  ON 42
eH2_3                -4.934136e-02 1 1  ON 43
eH2_4                -3.210409e-03 1 1  ON 44
eH2_5                 7.614476e-03 1 1  ON 45
eH2_6                 4.784829e-02 1 1  ON 46
eH2_7                 1.002428e-02 1 1  ON 47
eH2_8                 2.462073e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.267
    reference variance = 0.438856
====================================================
  Execution time = 1.9371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2832e-01
  Total weights = 2.0000e+06
  Execution time = 1.6953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328277955142
                                         uncertainty =       0.004800260891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328277955142
                                         uncertainty =       0.004800260891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405169528
  error estimate for blocks of size 2^( 2) =       0.000415242256
  error estimate for blocks of size 2^( 3) =       0.000424494000
  error estimate for blocks of size 2^( 4) =       0.000430595756
  error estimate for blocks of size 2^( 5) =       0.000433564946
  error estimate for blocks of size 2^( 6) =       0.000434923733
  error estimate for blocks of size 2^( 7) =       0.000433886785

      target function =                  N/A
              le_mean =     -17.214424356196
             les_mean =     296.664730444595
             stat err =       0.000433242805
             autocorr =       1.143376247853
              std dev =       0.572996242181
             le_variance =       0.328324693554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328278211880
                                         uncertainty =       0.004800266349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328278211880
                                         uncertainty =       0.004800266349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405169687
  error estimate for blocks of size 2^( 2) =       0.000415242408
  error estimate for blocks of size 2^( 3) =       0.000424494145
  error estimate for blocks of size 2^( 4) =       0.000430595897
  error estimate for blocks of size 2^( 5) =       0.000433565085
  error estimate for blocks of size 2^( 6) =       0.000434923872
  error estimate for blocks of size 2^( 7) =       0.000433886922

      target function =                  N/A
              le_mean =     -17.214424358433
             les_mean =     296.664730778433
             stat err =       0.000433242944
             autocorr =       1.143376088134
              std dev =       0.572996466290
             le_variance =       0.328324950381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328278083542
                                         uncertainty =       0.004800263620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328278083542
                                         uncertainty =       0.004800263620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405169608
  error estimate for blocks of size 2^( 2) =       0.000415242332
  error estimate for blocks of size 2^( 3) =       0.000424494073
  error estimate for blocks of size 2^( 4) =       0.000430595827
  error estimate for blocks of size 2^( 5) =       0.000433565016
  error estimate for blocks of size 2^( 6) =       0.000434923803
  error estimate for blocks of size 2^( 7) =       0.000433886853

      target function =                  N/A
              le_mean =     -17.214424357315
             les_mean =     296.664730611560
             stat err =       0.000433242875
             autocorr =       1.143376167965
              std dev =       0.572996354263
             le_variance =       0.328324821999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328277971193
                                         uncertainty =       0.004800261232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328277971193
                                         uncertainty =       0.004800261232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405169538
  error estimate for blocks of size 2^( 2) =       0.000415242265
  error estimate for blocks of size 2^( 3) =       0.000424494009
  error estimate for blocks of size 2^( 4) =       0.000430595765
  error estimate for blocks of size 2^( 5) =       0.000433564954
  error estimate for blocks of size 2^( 6) =       0.000434923742
  error estimate for blocks of size 2^( 7) =       0.000433886793

      target function =                  N/A
              le_mean =     -17.214424356336
             les_mean =     296.664730465467
             stat err =       0.000433242814
             autocorr =       1.143376237860
              std dev =       0.572996256193
             le_variance =       0.328324709611


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214424356196        initial
     9.0949e+02     9.0949e+03             2.7300e-07       -17.214424358433  <--
     3.6380e+03     3.6380e+04             6.8251e-08       -17.214424357315
     1.4552e+04     1.4552e+05             1.7063e-08       -17.214424356336

*****************************************************************************
Applying the update for shift_i =   9.0949e+02     and shift_s =   9.0949e+03
*****************************************************************************

  Execution time = 2.7926e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.932469e-01 1 1  ON 0
 uu_1                 2.876374e-02 1 1  ON 1
 uu_2                -6.968848e-02 1 1  ON 2
 uu_3                -1.271963e-01 1 1  ON 3
 uu_4                -1.623998e-01 1 1  ON 4
 uu_5                -1.731311e-01 1 1  ON 5
 uu_6                -1.585916e-01 1 1  ON 6
 uu_7                -1.110797e-01 1 1  ON 7
 uu_8                -3.634185e-02 1 1  ON 8
 uu_9                 2.143644e-01 1 1  ON 9
 ud_0                 3.553737e-01 1 1  ON 10
 ud_1                 9.353648e-02 1 1  ON 11
 ud_2                -1.941941e-02 1 1  ON 12
 ud_3                -8.085521e-02 1 1  ON 13
 ud_4                -1.285603e-01 1 1  ON 14
 ud_5                -1.623157e-01 1 1  ON 15
 ud_6                -1.719126e-01 1 1  ON 16
 ud_7                -1.451569e-01 1 1  ON 17
 ud_8                -9.344527e-02 1 1  ON 18
 ud_9                 4.270052e-02 1 1  ON 19
 eO_0                -9.023876e-01 1 1  ON 20
 eO_1                -5.750463e-01 1 1  ON 21
 eO_2                -1.550348e-01 1 1  ON 22
 eO_3                 1.119615e-01 1 1  ON 23
 eO_4                 2.238008e-01 1 1  ON 24
 eO_5                 2.974362e-01 1 1  ON 25
 eO_6                 3.092096e-01 1 1  ON 26
 eO_7                 4.645355e-01 1 1  ON 27
 eO_8                 1.268485e-01 1 1  ON 28
 eO_9                 5.428762e-02 1 1  ON 29
eH1_0                -2.142364e-01 1 1  ON 30
eH1_1                -1.352220e-01 1 1  ON 31
eH1_2                -9.252568e-02 1 1  ON 32
eH1_3                -5.421653e-02 1 1  ON 33
eH1_4                -7.657675e-03 1 1  ON 34
eH1_5                 4.139126e-03 1 1  ON 35
eH1_6                 4.926956e-02 1 1  ON 36
eH1_7                 5.245176e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118296e-01 1 1  ON 39
eH2_0                -2.089022e-01 1 1  ON 40
eH2_1                -1.300888e-01 1 1  ON 41
eH2_2                -8.740985e-02 1 1  ON 42
eH2_3                -4.934143e-02 1 1  ON 43
eH2_4                -3.210401e-03 1 1  ON 44
eH2_5                 7.614430e-03 1 1  ON 45
eH2_6                 4.784830e-02 1 1  ON 46
eH2_7                 1.002438e-02 1 1  ON 47
eH2_8                 2.462073e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2478e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2364
    reference variance = 0.201801
====================================================
  Execution time = 1.9398e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2516e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325129277926
                                         uncertainty =       0.004240151402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325129277926
                                         uncertainty =       0.004240151402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403211359
  error estimate for blocks of size 2^( 2) =       0.000413693704
  error estimate for blocks of size 2^( 3) =       0.000422720261
  error estimate for blocks of size 2^( 4) =       0.000428456655
  error estimate for blocks of size 2^( 5) =       0.000432858145
  error estimate for blocks of size 2^( 6) =       0.000435554622
  error estimate for blocks of size 2^( 7) =       0.000437001676

      target function =                  N/A
              le_mean =     -17.213823681500
             les_mean =     296.640884375595
             stat err =       0.000433467775
             autocorr =       1.155707988352
              std dev =       0.570226972699
             le_variance =       0.325158800393


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721382368150e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213823681500       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213823680642       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213823681314       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213823683958       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213823683869       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213823685835       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213823685639       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 1.228758e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213823681500       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213823681286       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213823681454       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213823682114       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213823682092       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213823682584       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213823682535       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 3.072842e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213823681500       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213823681447       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213823681489       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213823681653       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213823681651       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213823681771       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213823681762       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 7.682697e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4825e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.932471e-01 1 1  ON 0
 uu_1                 2.876373e-02 1 1  ON 1
 uu_2                -6.968851e-02 1 1  ON 2
 uu_3                -1.271963e-01 1 1  ON 3
 uu_4                -1.623999e-01 1 1  ON 4
 uu_5                -1.731311e-01 1 1  ON 5
 uu_6                -1.585916e-01 1 1  ON 6
 uu_7                -1.110797e-01 1 1  ON 7
 uu_8                -3.634184e-02 1 1  ON 8
 uu_9                 2.143644e-01 1 1  ON 9
 ud_0                 3.553739e-01 1 1  ON 10
 ud_1                 9.353662e-02 1 1  ON 11
 ud_2                -1.941947e-02 1 1  ON 12
 ud_3                -8.085520e-02 1 1  ON 13
 ud_4                -1.285603e-01 1 1  ON 14
 ud_5                -1.623157e-01 1 1  ON 15
 ud_6                -1.719127e-01 1 1  ON 16
 ud_7                -1.451570e-01 1 1  ON 17
 ud_8                -9.344529e-02 1 1  ON 18
 ud_9                 4.270049e-02 1 1  ON 19
 eO_0                -9.023879e-01 1 1  ON 20
 eO_1                -5.750465e-01 1 1  ON 21
 eO_2                -1.550348e-01 1 1  ON 22
 eO_3                 1.119618e-01 1 1  ON 23
 eO_4                 2.238010e-01 1 1  ON 24
 eO_5                 2.974362e-01 1 1  ON 25
 eO_6                 3.092096e-01 1 1  ON 26
 eO_7                 4.645355e-01 1 1  ON 27
 eO_8                 1.268485e-01 1 1  ON 28
 eO_9                 5.428762e-02 1 1  ON 29
eH1_0                -2.142363e-01 1 1  ON 30
eH1_1                -1.352220e-01 1 1  ON 31
eH1_2                -9.252563e-02 1 1  ON 32
eH1_3                -5.421644e-02 1 1  ON 33
eH1_4                -7.657771e-03 1 1  ON 34
eH1_5                 4.139069e-03 1 1  ON 35
eH1_6                 4.926946e-02 1 1  ON 36
eH1_7                 5.245177e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118296e-01 1 1  ON 39
eH2_0                -2.089022e-01 1 1  ON 40
eH2_1                -1.300889e-01 1 1  ON 41
eH2_2                -8.740991e-02 1 1  ON 42
eH2_3                -4.934135e-02 1 1  ON 43
eH2_4                -3.210433e-03 1 1  ON 44
eH2_5                 7.614462e-03 1 1  ON 45
eH2_6                 4.784830e-02 1 1  ON 46
eH2_7                 1.002449e-02 1 1  ON 47
eH2_8                 2.462073e-01 1 1  ON 48
eH2_9                 1.127407e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1851
    reference variance = 0.387487
====================================================
  Execution time = 1.9455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2264e-01
  Total weights = 2.0000e+06
  Execution time = 1.6942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322671405340
                                         uncertainty =       0.003088297703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322671405340
                                         uncertainty =       0.003088297703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401643574
  error estimate for blocks of size 2^( 2) =       0.000412021579
  error estimate for blocks of size 2^( 3) =       0.000421898668
  error estimate for blocks of size 2^( 4) =       0.000428784526
  error estimate for blocks of size 2^( 5) =       0.000432751041
  error estimate for blocks of size 2^( 6) =       0.000435582575
  error estimate for blocks of size 2^( 7) =       0.000435853604

      target function =                  N/A
              le_mean =     -17.214854705612
             les_mean =     296.673857494468
             stat err =       0.000433242936
             autocorr =       1.163540049116
              std dev =       0.568009789057
             le_variance =       0.322635120465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322672074891
                                         uncertainty =       0.003088305150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322672074891
                                         uncertainty =       0.003088305150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401643990
  error estimate for blocks of size 2^( 2) =       0.000412021973
  error estimate for blocks of size 2^( 3) =       0.000421899036
  error estimate for blocks of size 2^( 4) =       0.000428784869
  error estimate for blocks of size 2^( 5) =       0.000432751364
  error estimate for blocks of size 2^( 6) =       0.000435582905
  error estimate for blocks of size 2^( 7) =       0.000435853906

      target function =                  N/A
              le_mean =     -17.214854706770
             les_mean =     296.673858203967
             stat err =       0.000433243261
             autocorr =       1.163539376718
              std dev =       0.568010378489
             le_variance =       0.322635790071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322671740306
                                         uncertainty =       0.003088301429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322671740306
                                         uncertainty =       0.003088301429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401643782
  error estimate for blocks of size 2^( 2) =       0.000412021776
  error estimate for blocks of size 2^( 3) =       0.000421898852
  error estimate for blocks of size 2^( 4) =       0.000428784698
  error estimate for blocks of size 2^( 5) =       0.000432751202
  error estimate for blocks of size 2^( 6) =       0.000435582740
  error estimate for blocks of size 2^( 7) =       0.000435853755

      target function =                  N/A
              le_mean =     -17.214854706190
             les_mean =     296.673857849365
             stat err =       0.000433243099
             autocorr =       1.163539712600
              std dev =       0.568010083941
             le_variance =       0.322635455459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322671447217
                                         uncertainty =       0.003088298169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322671447217
                                         uncertainty =       0.003088298169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401643600
  error estimate for blocks of size 2^( 2) =       0.000412021604
  error estimate for blocks of size 2^( 3) =       0.000421898691
  error estimate for blocks of size 2^( 4) =       0.000428784547
  error estimate for blocks of size 2^( 5) =       0.000432751061
  error estimate for blocks of size 2^( 6) =       0.000435582596
  error estimate for blocks of size 2^( 7) =       0.000435853623

      target function =                  N/A
              le_mean =     -17.214854705684
             les_mean =     296.673857538833
             stat err =       0.000433242957
             autocorr =       1.163540007044
              std dev =       0.568009825923
             le_variance =       0.322635162345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214854705612        initial
     2.2737e+02     2.2737e+03             1.2288e-06       -17.214854706770  <--
     9.0949e+02     9.0949e+03             3.0728e-07       -17.214854706190
     3.6380e+03     3.6380e+04             7.6827e-08       -17.214854705684

*****************************************************************************
Applying the update for shift_i =   2.2737e+02     and shift_s =   2.2737e+03
*****************************************************************************

  Execution time = 2.8018e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.932476e-01 1 1  ON 0
 uu_1                 2.876373e-02 1 1  ON 1
 uu_2                -6.968857e-02 1 1  ON 2
 uu_3                -1.271964e-01 1 1  ON 3
 uu_4                -1.624004e-01 1 1  ON 4
 uu_5                -1.731312e-01 1 1  ON 5
 uu_6                -1.585917e-01 1 1  ON 6
 uu_7                -1.110797e-01 1 1  ON 7
 uu_8                -3.634181e-02 1 1  ON 8
 uu_9                 2.143643e-01 1 1  ON 9
 ud_0                 3.553742e-01 1 1  ON 10
 ud_1                 9.353704e-02 1 1  ON 11
 ud_2                -1.941965e-02 1 1  ON 12
 ud_3                -8.085517e-02 1 1  ON 13
 ud_4                -1.285604e-01 1 1  ON 14
 ud_5                -1.623159e-01 1 1  ON 15
 ud_6                -1.719129e-01 1 1  ON 16
 ud_7                -1.451572e-01 1 1  ON 17
 ud_8                -9.344533e-02 1 1  ON 18
 ud_9                 4.270041e-02 1 1  ON 19
 eO_0                -9.023888e-01 1 1  ON 20
 eO_1                -5.750470e-01 1 1  ON 21
 eO_2                -1.550348e-01 1 1  ON 22
 eO_3                 1.119626e-01 1 1  ON 23
 eO_4                 2.238018e-01 1 1  ON 24
 eO_5                 2.974361e-01 1 1  ON 25
 eO_6                 3.092097e-01 1 1  ON 26
 eO_7                 4.645354e-01 1 1  ON 27
 eO_8                 1.268486e-01 1 1  ON 28
 eO_9                 5.428764e-02 1 1  ON 29
eH1_0                -2.142362e-01 1 1  ON 30
eH1_1                -1.352219e-01 1 1  ON 31
eH1_2                -9.252549e-02 1 1  ON 32
eH1_3                -5.421615e-02 1 1  ON 33
eH1_4                -7.658058e-03 1 1  ON 34
eH1_5                 4.138900e-03 1 1  ON 35
eH1_6                 4.926916e-02 1 1  ON 36
eH1_7                 5.245180e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118296e-01 1 1  ON 39
eH2_0                -2.089023e-01 1 1  ON 40
eH2_1                -1.300892e-01 1 1  ON 41
eH2_2                -8.741009e-02 1 1  ON 42
eH2_3                -4.934113e-02 1 1  ON 43
eH2_4                -3.210530e-03 1 1  ON 44
eH2_5                 7.614559e-03 1 1  ON 45
eH2_6                 4.784830e-02 1 1  ON 46
eH2_7                 1.002481e-02 1 1  ON 47
eH2_8                 2.462072e-01 1 1  ON 48
eH2_9                 1.127408e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2849e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2432
    reference variance = 0.357113
====================================================
  Execution time = 1.9425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3365e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333681366658
                                         uncertainty =       0.006347517095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333681366658
                                         uncertainty =       0.006347517095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408439671
  error estimate for blocks of size 2^( 2) =       0.000418394338
  error estimate for blocks of size 2^( 3) =       0.000427229843
  error estimate for blocks of size 2^( 4) =       0.000433153362
  error estimate for blocks of size 2^( 5) =       0.000436809649
  error estimate for blocks of size 2^( 6) =       0.000438531506
  error estimate for blocks of size 2^( 7) =       0.000438180185

      target function =                  N/A
              le_mean =     -17.215401818886
             les_mean =     296.703705549296
             stat err =       0.000436668676
             autocorr =       1.143005294473
              std dev =       0.577620922764
             le_variance =       0.333645930415


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721540181889e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215401818886       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215401815785       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215401809019       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215401808214       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215401824545       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215401825852       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215401822542       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+01 is 6.073239e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215401818886       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215401818109       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215401816404       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215401816193       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215401820262       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215401820601       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215401819786       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 1.521066e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215401818886       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215401818692       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215401818265       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215401818211       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215401819227       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215401819309       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215401819109       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 3.804392e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311075 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4915e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.932479e-01 1 1  ON 0
 uu_1                 2.876322e-02 1 1  ON 1
 uu_2                -6.968860e-02 1 1  ON 2
 uu_3                -1.271969e-01 1 1  ON 3
 uu_4                -1.624007e-01 1 1  ON 4
 uu_5                -1.731310e-01 1 1  ON 5
 uu_6                -1.585913e-01 1 1  ON 6
 uu_7                -1.110793e-01 1 1  ON 7
 uu_8                -3.634167e-02 1 1  ON 8
 uu_9                 2.143642e-01 1 1  ON 9
 ud_0                 3.553742e-01 1 1  ON 10
 ud_1                 9.353736e-02 1 1  ON 11
 ud_2                -1.941954e-02 1 1  ON 12
 ud_3                -8.085551e-02 1 1  ON 13
 ud_4                -1.285609e-01 1 1  ON 14
 ud_5                -1.623160e-01 1 1  ON 15
 ud_6                -1.719125e-01 1 1  ON 16
 ud_7                -1.451571e-01 1 1  ON 17
 ud_8                -9.344527e-02 1 1  ON 18
 ud_9                 4.270038e-02 1 1  ON 19
 eO_0                -9.023903e-01 1 1  ON 20
 eO_1                -5.750474e-01 1 1  ON 21
 eO_2                -1.550345e-01 1 1  ON 22
 eO_3                 1.119634e-01 1 1  ON 23
 eO_4                 2.238021e-01 1 1  ON 24
 eO_5                 2.974363e-01 1 1  ON 25
 eO_6                 3.092099e-01 1 1  ON 26
 eO_7                 4.645354e-01 1 1  ON 27
 eO_8                 1.268487e-01 1 1  ON 28
 eO_9                 5.428766e-02 1 1  ON 29
eH1_0                -2.142364e-01 1 1  ON 30
eH1_1                -1.352224e-01 1 1  ON 31
eH1_2                -9.252544e-02 1 1  ON 32
eH1_3                -5.421567e-02 1 1  ON 33
eH1_4                -7.658355e-03 1 1  ON 34
eH1_5                 4.139220e-03 1 1  ON 35
eH1_6                 4.926901e-02 1 1  ON 36
eH1_7                 5.245200e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118296e-01 1 1  ON 39
eH2_0                -2.089025e-01 1 1  ON 40
eH2_1                -1.300889e-01 1 1  ON 41
eH2_2                -8.741009e-02 1 1  ON 42
eH2_3                -4.934127e-02 1 1  ON 43
eH2_4                -3.210596e-03 1 1  ON 44
eH2_5                 7.614163e-03 1 1  ON 45
eH2_6                 4.784830e-02 1 1  ON 46
eH2_7                 1.002531e-02 1 1  ON 47
eH2_8                 2.462072e-01 1 1  ON 48
eH2_9                 1.127408e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1425
    reference variance = 0.328806
====================================================
  Execution time = 1.9041e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.0000e+06
  Execution time = 1.7043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336167752850
                                         uncertainty =       0.010093780907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336167752850
                                         uncertainty =       0.010093780907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410127622
  error estimate for blocks of size 2^( 2) =       0.000420323563
  error estimate for blocks of size 2^( 3) =       0.000429316172
  error estimate for blocks of size 2^( 4) =       0.000435747528
  error estimate for blocks of size 2^( 5) =       0.000439956531
  error estimate for blocks of size 2^( 6) =       0.000442038412
  error estimate for blocks of size 2^( 7) =       0.000442454572

      target function =                  N/A
              le_mean =     -17.214878842402
             les_mean =     296.688462723181
             stat err =       0.000440049261
             autocorr =       1.151236502583
              std dev =       0.580008045472
             le_variance =       0.336409332812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336167453994
                                         uncertainty =       0.010093790756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336167453994
                                         uncertainty =       0.010093790756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410127439
  error estimate for blocks of size 2^( 2) =       0.000420323377
  error estimate for blocks of size 2^( 3) =       0.000429315987
  error estimate for blocks of size 2^( 4) =       0.000435747325
  error estimate for blocks of size 2^( 5) =       0.000439956344
  error estimate for blocks of size 2^( 6) =       0.000442038168
  error estimate for blocks of size 2^( 7) =       0.000442454391

      target function =                  N/A
              le_mean =     -17.214878859681
             les_mean =     296.688463017502
             stat err =       0.000440049057
             autocorr =       1.151236466102
              std dev =       0.580007786346
             le_variance =       0.336409032222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336167597938
                                         uncertainty =       0.010093785591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336167597938
                                         uncertainty =       0.010093785591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410127527
  error estimate for blocks of size 2^( 2) =       0.000420323467
  error estimate for blocks of size 2^( 3) =       0.000429316077
  error estimate for blocks of size 2^( 4) =       0.000435747424
  error estimate for blocks of size 2^( 5) =       0.000439956434
  error estimate for blocks of size 2^( 6) =       0.000442038287
  error estimate for blocks of size 2^( 7) =       0.000442454479

      target function =                  N/A
              le_mean =     -17.214878851070
             les_mean =     296.688462865848
             stat err =       0.000440049156
             autocorr =       1.151236486922
              std dev =       0.580007911177
             le_variance =       0.336409177028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336167733307
                                         uncertainty =       0.010093781485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336167733307
                                         uncertainty =       0.010093781485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410127610
  error estimate for blocks of size 2^( 2) =       0.000420323551
  error estimate for blocks of size 2^( 3) =       0.000429316160
  error estimate for blocks of size 2^( 4) =       0.000435747515
  error estimate for blocks of size 2^( 5) =       0.000439956518
  error estimate for blocks of size 2^( 6) =       0.000442038396
  error estimate for blocks of size 2^( 7) =       0.000442454560

      target function =                  N/A
              le_mean =     -17.214878843485
             les_mean =     296.688462740834
             stat err =       0.000440049248
             autocorr =       1.151236500701
              std dev =       0.580008028530
             le_variance =       0.336409313159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214878842402        initial
     5.6843e+01     5.6843e+02             6.0732e-06       -17.214878859681  <--
     2.2737e+02     2.2737e+03             1.5211e-06       -17.214878851070
     9.0949e+02     9.0949e+03             3.8044e-07       -17.214878843485

*****************************************************************************
Applying the update for shift_i =   5.6843e+01     and shift_s =   5.6843e+02
*****************************************************************************

  Execution time = 2.7644e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.932486e-01 1 1  ON 0
 uu_1                 2.876171e-02 1 1  ON 1
 uu_2                -6.968869e-02 1 1  ON 2
 uu_3                -1.271982e-01 1 1  ON 3
 uu_4                -1.624019e-01 1 1  ON 4
 uu_5                -1.731305e-01 1 1  ON 5
 uu_6                -1.585900e-01 1 1  ON 6
 uu_7                -1.110782e-01 1 1  ON 7
 uu_8                -3.634125e-02 1 1  ON 8
 uu_9                 2.143639e-01 1 1  ON 9
 ud_0                 3.553741e-01 1 1  ON 10
 ud_1                 9.353829e-02 1 1  ON 11
 ud_2                -1.941920e-02 1 1  ON 12
 ud_3                -8.085652e-02 1 1  ON 13
 ud_4                -1.285622e-01 1 1  ON 14
 ud_5                -1.623164e-01 1 1  ON 15
 ud_6                -1.719113e-01 1 1  ON 16
 ud_7                -1.451569e-01 1 1  ON 17
 ud_8                -9.344509e-02 1 1  ON 18
 ud_9                 4.270027e-02 1 1  ON 19
 eO_0                -9.023949e-01 1 1  ON 20
 eO_1                -5.750486e-01 1 1  ON 21
 eO_2                -1.550335e-01 1 1  ON 22
 eO_3                 1.119659e-01 1 1  ON 23
 eO_4                 2.238030e-01 1 1  ON 24
 eO_5                 2.974370e-01 1 1  ON 25
 eO_6                 3.092104e-01 1 1  ON 26
 eO_7                 4.645352e-01 1 1  ON 27
 eO_8                 1.268489e-01 1 1  ON 28
 eO_9                 5.428770e-02 1 1  ON 29
eH1_0                -2.142369e-01 1 1  ON 30
eH1_1                -1.352238e-01 1 1  ON 31
eH1_2                -9.252529e-02 1 1  ON 32
eH1_3                -5.421423e-02 1 1  ON 33
eH1_4                -7.659244e-03 1 1  ON 34
eH1_5                 4.140180e-03 1 1  ON 35
eH1_6                 4.926856e-02 1 1  ON 36
eH1_7                 5.245259e-02 1 1  ON 37
eH1_8                 2.208607e-01 1 1  ON 38
eH1_9                 1.118297e-01 1 1  ON 39
eH2_0                -2.089031e-01 1 1  ON 40
eH2_1                -1.300880e-01 1 1  ON 41
eH2_2                -8.741009e-02 1 1  ON 42
eH2_3                -4.934167e-02 1 1  ON 43
eH2_4                -3.210796e-03 1 1  ON 44
eH2_5                 7.612977e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002682e-02 1 1  ON 47
eH2_8                 2.462071e-01 1 1  ON 48
eH2_9                 1.127408e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2564e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1874
    reference variance = 0.440689
====================================================
  Execution time = 1.9323e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2387e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323974859964
                                         uncertainty =       0.002588446370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323974859964
                                         uncertainty =       0.002588446370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402408478
  error estimate for blocks of size 2^( 2) =       0.000412523034
  error estimate for blocks of size 2^( 3) =       0.000422185221
  error estimate for blocks of size 2^( 4) =       0.000429719302
  error estimate for blocks of size 2^( 5) =       0.000433919441
  error estimate for blocks of size 2^( 6) =       0.000436200614
  error estimate for blocks of size 2^( 7) =       0.000438063037

      target function =                  N/A
              le_mean =     -17.214398295752
             les_mean =     296.659373689868
             stat err =       0.000434475599
             autocorr =       1.165726141388
              std dev =       0.569091527808
             le_variance =       0.323865167023


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721439829575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214398295752       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214398295539       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214398225461       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214398252312       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214398291653       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214398312223       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214398311639       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+01 is 2.535732e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214398295752       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214398295698       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214398277899       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214398284612       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214398294736       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214398299749       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214398299609       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+01 is 6.375449e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214398295752       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214398295738       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214398291271       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214398292949       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214398295498       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214398296743       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214398296709       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 1.596137e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4776e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.932496e-01 1 1  ON 0
 uu_1                 2.876016e-02 1 1  ON 1
 uu_2                -6.969004e-02 1 1  ON 2
 uu_3                -1.271996e-01 1 1  ON 3
 uu_4                -1.624024e-01 1 1  ON 4
 uu_5                -1.731297e-01 1 1  ON 5
 uu_6                -1.585898e-01 1 1  ON 6
 uu_7                -1.110768e-01 1 1  ON 7
 uu_8                -3.634049e-02 1 1  ON 8
 uu_9                 2.143636e-01 1 1  ON 9
 ud_0                 3.553766e-01 1 1  ON 10
 ud_1                 9.353790e-02 1 1  ON 11
 ud_2                -1.941921e-02 1 1  ON 12
 ud_3                -8.085754e-02 1 1  ON 13
 ud_4                -1.285648e-01 1 1  ON 14
 ud_5                -1.623173e-01 1 1  ON 15
 ud_6                -1.719094e-01 1 1  ON 16
 ud_7                -1.451570e-01 1 1  ON 17
 ud_8                -9.344494e-02 1 1  ON 18
 ud_9                 4.270010e-02 1 1  ON 19
 eO_0                -9.024012e-01 1 1  ON 20
 eO_1                -5.750504e-01 1 1  ON 21
 eO_2                -1.550317e-01 1 1  ON 22
 eO_3                 1.119686e-01 1 1  ON 23
 eO_4                 2.238042e-01 1 1  ON 24
 eO_5                 2.974379e-01 1 1  ON 25
 eO_6                 3.092117e-01 1 1  ON 26
 eO_7                 4.645349e-01 1 1  ON 27
 eO_8                 1.268493e-01 1 1  ON 28
 eO_9                 5.428780e-02 1 1  ON 29
eH1_0                -2.142365e-01 1 1  ON 30
eH1_1                -1.352237e-01 1 1  ON 31
eH1_2                -9.252503e-02 1 1  ON 32
eH1_3                -5.421520e-02 1 1  ON 33
eH1_4                -7.660289e-03 1 1  ON 34
eH1_5                 4.141210e-03 1 1  ON 35
eH1_6                 4.926814e-02 1 1  ON 36
eH1_7                 5.245297e-02 1 1  ON 37
eH1_8                 2.208605e-01 1 1  ON 38
eH1_9                 1.118299e-01 1 1  ON 39
eH2_0                -2.089038e-01 1 1  ON 40
eH2_1                -1.300885e-01 1 1  ON 41
eH2_2                -8.740891e-02 1 1  ON 42
eH2_3                -4.934156e-02 1 1  ON 43
eH2_4                -3.213042e-03 1 1  ON 44
eH2_5                 7.611611e-03 1 1  ON 45
eH2_6                 4.784949e-02 1 1  ON 46
eH2_7                 1.002922e-02 1 1  ON 47
eH2_8                 2.462070e-01 1 1  ON 48
eH2_9                 1.127408e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.184
    reference variance = 0.275475
====================================================
  Execution time = 1.9493e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2274e-01
  Total weights = 2.0000e+06
  Execution time = 1.6963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322755402719
                                         uncertainty =       0.002676776449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322755402719
                                         uncertainty =       0.002676776449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401706043
  error estimate for blocks of size 2^( 2) =       0.000411628230
  error estimate for blocks of size 2^( 3) =       0.000419640135
  error estimate for blocks of size 2^( 4) =       0.000426019735
  error estimate for blocks of size 2^( 5) =       0.000429099379
  error estimate for blocks of size 2^( 6) =       0.000430702576
  error estimate for blocks of size 2^( 7) =       0.000431832366

      target function =                  N/A
              le_mean =     -17.214667120594
             les_mean =     296.667499400706
             stat err =       0.000429413514
             autocorr =       1.142706471498
              std dev =       0.568098133429
             le_variance =       0.322735489205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322766399268
                                         uncertainty =       0.002676870636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322766399268
                                         uncertainty =       0.002676870636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401712885
  error estimate for blocks of size 2^( 2) =       0.000411634853
  error estimate for blocks of size 2^( 3) =       0.000419646566
  error estimate for blocks of size 2^( 4) =       0.000426026074
  error estimate for blocks of size 2^( 5) =       0.000429105510
  error estimate for blocks of size 2^( 6) =       0.000430708786
  error estimate for blocks of size 2^( 7) =       0.000431838589

      target function =                  N/A
              le_mean =     -17.214667025986
             les_mean =     296.667507138260
             stat err =       0.000429419740
             autocorr =       1.142700677753
              std dev =       0.568107810233
             le_variance =       0.322746484047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322760996574
                                         uncertainty =       0.002676824156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322760996574
                                         uncertainty =       0.002676824156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401709523
  error estimate for blocks of size 2^( 2) =       0.000411631599
  error estimate for blocks of size 2^( 3) =       0.000419643407
  error estimate for blocks of size 2^( 4) =       0.000426022962
  error estimate for blocks of size 2^( 5) =       0.000429102499
  error estimate for blocks of size 2^( 6) =       0.000430705737
  error estimate for blocks of size 2^( 7) =       0.000431835533

      target function =                  N/A
              le_mean =     -17.214667072553
             les_mean =     296.667503339658
             stat err =       0.000429416683
             autocorr =       1.142703532517
              std dev =       0.568103055947
             le_variance =       0.322741082176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322756104967
                                         uncertainty =       0.002676782432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322756104967
                                         uncertainty =       0.002676782432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401706479
  error estimate for blocks of size 2^( 2) =       0.000411628653
  error estimate for blocks of size 2^( 3) =       0.000419640545
  error estimate for blocks of size 2^( 4) =       0.000426020140
  error estimate for blocks of size 2^( 5) =       0.000429099770
  error estimate for blocks of size 2^( 6) =       0.000430702973
  error estimate for blocks of size 2^( 7) =       0.000431832764

      target function =                  N/A
              le_mean =     -17.214667114556
             les_mean =     296.667499894951
             stat err =       0.000429413912
             autocorr =       1.142706102732
              std dev =       0.568098751399
             le_variance =       0.322736191342


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214667120594        initial  <--
     1.4211e+01     1.4211e+02             2.5357e-05       -17.214667025986
     5.6843e+01     5.6843e+02             6.3754e-06       -17.214667072553
     2.2737e+02     2.2737e+03             1.5961e-06       -17.214667114556

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.0892
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.932486e-01 1 1  ON 0
 uu_1                 2.876171e-02 1 1  ON 1
 uu_2                -6.968869e-02 1 1  ON 2
 uu_3                -1.271982e-01 1 1  ON 3
 uu_4                -1.624019e-01 1 1  ON 4
 uu_5                -1.731305e-01 1 1  ON 5
 uu_6                -1.585900e-01 1 1  ON 6
 uu_7                -1.110782e-01 1 1  ON 7
 uu_8                -3.634125e-02 1 1  ON 8
 uu_9                 2.143639e-01 1 1  ON 9
 ud_0                 3.553741e-01 1 1  ON 10
 ud_1                 9.353829e-02 1 1  ON 11
 ud_2                -1.941920e-02 1 1  ON 12
 ud_3                -8.085652e-02 1 1  ON 13
 ud_4                -1.285622e-01 1 1  ON 14
 ud_5                -1.623164e-01 1 1  ON 15
 ud_6                -1.719113e-01 1 1  ON 16
 ud_7                -1.451569e-01 1 1  ON 17
 ud_8                -9.344509e-02 1 1  ON 18
 ud_9                 4.270027e-02 1 1  ON 19
 eO_0                -9.023949e-01 1 1  ON 20
 eO_1                -5.750486e-01 1 1  ON 21
 eO_2                -1.550335e-01 1 1  ON 22
 eO_3                 1.119659e-01 1 1  ON 23
 eO_4                 2.238030e-01 1 1  ON 24
 eO_5                 2.974370e-01 1 1  ON 25
 eO_6                 3.092104e-01 1 1  ON 26
 eO_7                 4.645352e-01 1 1  ON 27
 eO_8                 1.268489e-01 1 1  ON 28
 eO_9                 5.428770e-02 1 1  ON 29
eH1_0                -2.142369e-01 1 1  ON 30
eH1_1                -1.352238e-01 1 1  ON 31
eH1_2                -9.252529e-02 1 1  ON 32
eH1_3                -5.421423e-02 1 1  ON 33
eH1_4                -7.659244e-03 1 1  ON 34
eH1_5                 4.140180e-03 1 1  ON 35
eH1_6                 4.926856e-02 1 1  ON 36
eH1_7                 5.245259e-02 1 1  ON 37
eH1_8                 2.208607e-01 1 1  ON 38
eH1_9                 1.118297e-01 1 1  ON 39
eH2_0                -2.089031e-01 1 1  ON 40
eH2_1                -1.300880e-01 1 1  ON 41
eH2_2                -8.741009e-02 1 1  ON 42
eH2_3                -4.934167e-02 1 1  ON 43
eH2_4                -3.210796e-03 1 1  ON 44
eH2_5                 7.612977e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002682e-02 1 1  ON 47
eH2_8                 2.462071e-01 1 1  ON 48
eH2_9                 1.127408e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2871e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2595
    reference variance = 0.152757
====================================================
  Execution time = 2.0010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3264e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725415240
                                         uncertainty =       0.008967612061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725415240
                                         uncertainty =       0.008967612061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407824505
  error estimate for blocks of size 2^( 2) =       0.000417651801
  error estimate for blocks of size 2^( 3) =       0.000426351945
  error estimate for blocks of size 2^( 4) =       0.000432747470
  error estimate for blocks of size 2^( 5) =       0.000437034830
  error estimate for blocks of size 2^( 6) =       0.000438504521
  error estimate for blocks of size 2^( 7) =       0.000439830628

      target function =                  N/A
              le_mean =     -17.215625284664
             les_mean =     296.710395429222
             stat err =       0.000437029362
             autocorr =       1.148350853294
              std dev =       0.576750945893
             le_variance =       0.332641653588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721562528466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215625284664       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215625289671       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215625289744       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215625293851       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215625288982       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215625291598       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215625291677       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+02 is 2.061854e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215625284664       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215625285917       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215625285935       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215625286964       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215625285747       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215625286402       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215625286420       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 5.157452e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215625284664       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215625284977       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215625284982       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215625285239       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215625284936       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215625285098       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215625285103       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.289539e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315576 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5381e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.932488e-01 1 1  ON 0
 uu_1                 2.876166e-02 1 1  ON 1
 uu_2                -6.968876e-02 1 1  ON 2
 uu_3                -1.271984e-01 1 1  ON 3
 uu_4                -1.624019e-01 1 1  ON 4
 uu_5                -1.731305e-01 1 1  ON 5
 uu_6                -1.585900e-01 1 1  ON 6
 uu_7                -1.110781e-01 1 1  ON 7
 uu_8                -3.634123e-02 1 1  ON 8
 uu_9                 2.143639e-01 1 1  ON 9
 ud_0                 3.553741e-01 1 1  ON 10
 ud_1                 9.353841e-02 1 1  ON 11
 ud_2                -1.941912e-02 1 1  ON 12
 ud_3                -8.085668e-02 1 1  ON 13
 ud_4                -1.285622e-01 1 1  ON 14
 ud_5                -1.623165e-01 1 1  ON 15
 ud_6                -1.719113e-01 1 1  ON 16
 ud_7                -1.451570e-01 1 1  ON 17
 ud_8                -9.344512e-02 1 1  ON 18
 ud_9                 4.270023e-02 1 1  ON 19
 eO_0                -9.023954e-01 1 1  ON 20
 eO_1                -5.750488e-01 1 1  ON 21
 eO_2                -1.550333e-01 1 1  ON 22
 eO_3                 1.119660e-01 1 1  ON 23
 eO_4                 2.238034e-01 1 1  ON 24
 eO_5                 2.974370e-01 1 1  ON 25
 eO_6                 3.092105e-01 1 1  ON 26
 eO_7                 4.645352e-01 1 1  ON 27
 eO_8                 1.268490e-01 1 1  ON 28
 eO_9                 5.428771e-02 1 1  ON 29
eH1_0                -2.142369e-01 1 1  ON 30
eH1_1                -1.352236e-01 1 1  ON 31
eH1_2                -9.252512e-02 1 1  ON 32
eH1_3                -5.421418e-02 1 1  ON 33
eH1_4                -7.659393e-03 1 1  ON 34
eH1_5                 4.140260e-03 1 1  ON 35
eH1_6                 4.926834e-02 1 1  ON 36
eH1_7                 5.245253e-02 1 1  ON 37
eH1_8                 2.208606e-01 1 1  ON 38
eH1_9                 1.118297e-01 1 1  ON 39
eH2_0                -2.089033e-01 1 1  ON 40
eH2_1                -1.300879e-01 1 1  ON 41
eH2_2                -8.741016e-02 1 1  ON 42
eH2_3                -4.934164e-02 1 1  ON 43
eH2_4                -3.210810e-03 1 1  ON 44
eH2_5                 7.613088e-03 1 1  ON 45
eH2_6                 4.784834e-02 1 1  ON 46
eH2_7                 1.002698e-02 1 1  ON 47
eH2_8                 2.462070e-01 1 1  ON 48
eH2_9                 1.127408e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.306834
====================================================
  Execution time = 1.9632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2577e-01
  Total weights = 2.0000e+06
  Execution time = 1.6924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325642369132
                                         uncertainty =       0.003997064643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325642369132
                                         uncertainty =       0.003997064643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403589103
  error estimate for blocks of size 2^( 2) =       0.000413740220
  error estimate for blocks of size 2^( 3) =       0.000422950105
  error estimate for blocks of size 2^( 4) =       0.000429715634
  error estimate for blocks of size 2^( 5) =       0.000433343983
  error estimate for blocks of size 2^( 6) =       0.000435791482
  error estimate for blocks of size 2^( 7) =       0.000436988127

      target function =                  N/A
              le_mean =     -17.214702602651
             les_mean =     296.671753863425
             stat err =       0.000433959806
             autocorr =       1.156165883107
              std dev =       0.570761183494
             le_variance =       0.325768328584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325642313318
                                         uncertainty =       0.003997066314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325642313318
                                         uncertainty =       0.003997066314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403589069
  error estimate for blocks of size 2^( 2) =       0.000413740193
  error estimate for blocks of size 2^( 3) =       0.000422950081
  error estimate for blocks of size 2^( 4) =       0.000429715609
  error estimate for blocks of size 2^( 5) =       0.000433343970
  error estimate for blocks of size 2^( 6) =       0.000435791458
  error estimate for blocks of size 2^( 7) =       0.000436988087

      target function =                  N/A
              le_mean =     -17.214702600083
             les_mean =     296.671753719120
             stat err =       0.000433959781
             autocorr =       1.156165947339
              std dev =       0.570761134533
             le_variance =       0.325768272693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325642340467
                                         uncertainty =       0.003997065473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325642340467
                                         uncertainty =       0.003997065473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403589086
  error estimate for blocks of size 2^( 2) =       0.000413740206
  error estimate for blocks of size 2^( 3) =       0.000422950092
  error estimate for blocks of size 2^( 4) =       0.000429715621
  error estimate for blocks of size 2^( 5) =       0.000433343976
  error estimate for blocks of size 2^( 6) =       0.000435791470
  error estimate for blocks of size 2^( 7) =       0.000436988107

      target function =                  N/A
              le_mean =     -17.214702601361
             les_mean =     296.671753790302
             stat err =       0.000433959794
             autocorr =       1.156165915740
              std dev =       0.570761158349
             le_variance =       0.325768299880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325642365525
                                         uncertainty =       0.003997064747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325642365525
                                         uncertainty =       0.003997064747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403589101
  error estimate for blocks of size 2^( 2) =       0.000413740218
  error estimate for blocks of size 2^( 3) =       0.000422950103
  error estimate for blocks of size 2^( 4) =       0.000429715632
  error estimate for blocks of size 2^( 5) =       0.000433343982
  error estimate for blocks of size 2^( 6) =       0.000435791480
  error estimate for blocks of size 2^( 7) =       0.000436988124

      target function =                  N/A
              le_mean =     -17.214702602490
             les_mean =     296.671753854250
             stat err =       0.000433959805
             autocorr =       1.156165887215
              std dev =       0.570761180330
             le_variance =       0.325768324971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214702602651        initial  <--
     1.4211e+02     1.4211e+03             2.0619e-06       -17.214702600083
     5.6843e+02     5.6843e+03             5.1575e-07       -17.214702601361
     2.2737e+03     2.2737e+04             1.2895e-07       -17.214702602490

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.2030
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.932486e-01 1 1  ON 0
 uu_1                 2.876171e-02 1 1  ON 1
 uu_2                -6.968869e-02 1 1  ON 2
 uu_3                -1.271982e-01 1 1  ON 3
 uu_4                -1.624019e-01 1 1  ON 4
 uu_5                -1.731305e-01 1 1  ON 5
 uu_6                -1.585900e-01 1 1  ON 6
 uu_7                -1.110782e-01 1 1  ON 7
 uu_8                -3.634125e-02 1 1  ON 8
 uu_9                 2.143639e-01 1 1  ON 9
 ud_0                 3.553741e-01 1 1  ON 10
 ud_1                 9.353829e-02 1 1  ON 11
 ud_2                -1.941920e-02 1 1  ON 12
 ud_3                -8.085652e-02 1 1  ON 13
 ud_4                -1.285622e-01 1 1  ON 14
 ud_5                -1.623164e-01 1 1  ON 15
 ud_6                -1.719113e-01 1 1  ON 16
 ud_7                -1.451569e-01 1 1  ON 17
 ud_8                -9.344509e-02 1 1  ON 18
 ud_9                 4.270027e-02 1 1  ON 19
 eO_0                -9.023949e-01 1 1  ON 20
 eO_1                -5.750486e-01 1 1  ON 21
 eO_2                -1.550335e-01 1 1  ON 22
 eO_3                 1.119659e-01 1 1  ON 23
 eO_4                 2.238030e-01 1 1  ON 24
 eO_5                 2.974370e-01 1 1  ON 25
 eO_6                 3.092104e-01 1 1  ON 26
 eO_7                 4.645352e-01 1 1  ON 27
 eO_8                 1.268489e-01 1 1  ON 28
 eO_9                 5.428770e-02 1 1  ON 29
eH1_0                -2.142369e-01 1 1  ON 30
eH1_1                -1.352238e-01 1 1  ON 31
eH1_2                -9.252529e-02 1 1  ON 32
eH1_3                -5.421423e-02 1 1  ON 33
eH1_4                -7.659244e-03 1 1  ON 34
eH1_5                 4.140180e-03 1 1  ON 35
eH1_6                 4.926856e-02 1 1  ON 36
eH1_7                 5.245259e-02 1 1  ON 37
eH1_8                 2.208607e-01 1 1  ON 38
eH1_9                 1.118297e-01 1 1  ON 39
eH2_0                -2.089031e-01 1 1  ON 40
eH2_1                -1.300880e-01 1 1  ON 41
eH2_2                -8.741009e-02 1 1  ON 42
eH2_3                -4.934167e-02 1 1  ON 43
eH2_4                -3.210796e-03 1 1  ON 44
eH2_5                 7.612977e-03 1 1  ON 45
eH2_6                 4.784831e-02 1 1  ON 46
eH2_7                 1.002682e-02 1 1  ON 47
eH2_8                 2.462071e-01 1 1  ON 48
eH2_9                 1.127408e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3590e+01 secs
  Total Execution time = 2.1308e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
