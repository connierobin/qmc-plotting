Rank =    0  Free Memory = 74319 MB
Rank =    1  Free Memory = 74319 MB
Rank =    2  Free Memory = 74319 MB
Rank =    3  Free Memory = 74319 MB
Rank =    4  Free Memory = 74319 MB
Rank =    5  Free Memory = 74319 MB
Rank =    6  Free Memory = 74319 MB
Rank =    7  Free Memory = 74319 MB
Rank =    8  Free Memory = 74319 MB
Rank =    9  Free Memory = 74319 MB
Rank =   10  Free Memory = 74318 MB
Rank =   11  Free Memory = 74318 MB
Rank =   12  Free Memory = 74318 MB
Rank =   13  Free Memory = 74318 MB
Rank =   14  Free Memory = 74317 MB
Rank =   15  Free Memory = 74302 MB
Rank =   16  Free Memory = 74302 MB
Rank =   17  Free Memory = 74302 MB
Rank =   18  Free Memory = 74302 MB
Rank =   19  Free Memory = 74302 MB
Rank =   20  Free Memory = 74302 MB
Rank =   21  Free Memory = 74302 MB
Rank =   22  Free Memory = 74302 MB
Rank =   23  Free Memory = 74302 MB
Rank =   24  Free Memory = 74302 MB
Rank =   25  Free Memory = 74302 MB
Rank =   26  Free Memory = 74302 MB
Rank =   27  Free Memory = 74302 MB
Rank =   28  Free Memory = 74302 MB
Rank =   29  Free Memory = 74302 MB
Rank =   30  Free Memory = 74302 MB
Rank =   31  Free Memory = 74302 MB
Rank =   32  Free Memory = 64498 MB
Rank =   33  Free Memory = 64498 MB
Rank =   34  Free Memory = 64498 MB
Rank =   35  Free Memory = 64497 MB
Rank =   36  Free Memory = 64497 MB
Rank =   37  Free Memory = 64497 MB
Rank =   38  Free Memory = 64497 MB
Rank =   39  Free Memory = 64497 MB
Rank =   40  Free Memory = 64497 MB
Rank =   41  Free Memory = 64497 MB
Rank =   42  Free Memory = 64497 MB
Rank =   43  Free Memory = 64497 MB
Rank =   44  Free Memory = 64497 MB
Rank =   45  Free Memory = 64496 MB
Rank =   46  Free Memory = 64496 MB
Rank =   47  Free Memory = 64496 MB
Rank =   48  Free Memory = 64496 MB
Rank =   49  Free Memory = 64496 MB
Rank =   50  Free Memory = 64496 MB
Rank =   51  Free Memory = 64496 MB
Rank =   52  Free Memory = 64496 MB
Rank =   53  Free Memory = 64496 MB
Rank =   54  Free Memory = 64496 MB
Rank =   55  Free Memory = 64496 MB
Rank =   56  Free Memory = 64496 MB
Rank =   57  Free Memory = 64495 MB
Rank =   58  Free Memory = 64495 MB
Rank =   59  Free Memory = 64495 MB
Rank =   60  Free Memory = 64495 MB
Rank =   61  Free Memory = 64495 MB
Rank =   62  Free Memory = 64495 MB
Rank =   63  Free Memory = 64495 MB
Rank =   64  Free Memory = 74566 MB
Rank =   65  Free Memory = 74566 MB
Rank =   66  Free Memory = 74566 MB
Rank =   67  Free Memory = 74566 MB
Rank =   68  Free Memory = 74566 MB
Rank =   69  Free Memory = 74566 MB
Rank =   70  Free Memory = 74566 MB
Rank =   71  Free Memory = 74566 MB
Rank =   72  Free Memory = 74566 MB
Rank =   73  Free Memory = 74566 MB
Rank =   74  Free Memory = 74565 MB
Rank =   75  Free Memory = 74565 MB
Rank =   76  Free Memory = 74565 MB
Rank =   77  Free Memory = 74565 MB
Rank =   78  Free Memory = 74565 MB
Rank =   79  Free Memory = 74565 MB
Rank =   80  Free Memory = 74565 MB
Rank =   81  Free Memory = 74565 MB
Rank =   82  Free Memory = 74565 MB
Rank =   83  Free Memory = 74565 MB
Rank =   84  Free Memory = 74565 MB
Rank =   85  Free Memory = 74565 MB
Rank =   86  Free Memory = 74565 MB
Rank =   87  Free Memory = 74565 MB
Rank =   88  Free Memory = 74565 MB
Rank =   89  Free Memory = 74565 MB
Rank =   90  Free Memory = 74565 MB
Rank =   91  Free Memory = 74565 MB
Rank =   92  Free Memory = 74565 MB
Rank =   93  Free Memory = 74565 MB
Rank =   94  Free Memory = 74565 MB
Rank =   95  Free Memory = 74565 MB
Rank =   96  Free Memory = 53344 MB
Rank =   97  Free Memory = 53344 MB
Rank =   98  Free Memory = 53344 MB
Rank =   99  Free Memory = 53344 MB
Rank =  100  Free Memory = 53344 MB
Rank =  101  Free Memory = 53344 MB
Rank =  102  Free Memory = 53344 MB
Rank =  103  Free Memory = 53344 MB
Rank =  104  Free Memory = 53344 MB
Rank =  105  Free Memory = 53344 MB
Rank =  106  Free Memory = 53344 MB
Rank =  107  Free Memory = 53344 MB
Rank =  108  Free Memory = 53344 MB
Rank =  109  Free Memory = 53344 MB
Rank =  110  Free Memory = 53344 MB
Rank =  111  Free Memory = 53344 MB
Rank =  112  Free Memory = 53344 MB
Rank =  113  Free Memory = 53344 MB
Rank =  114  Free Memory = 53344 MB
Rank =  115  Free Memory = 53344 MB
Rank =  116  Free Memory = 53344 MB
Rank =  117  Free Memory = 53344 MB
Rank =  118  Free Memory = 53344 MB
Rank =  119  Free Memory = 53344 MB
Rank =  120  Free Memory = 53344 MB
Rank =  121  Free Memory = 53344 MB
Rank =  122  Free Memory = 53344 MB
Rank =  123  Free Memory = 53344 MB
Rank =  124  Free Memory = 53344 MB
Rank =  125  Free Memory = 53344 MB
Rank =  126  Free Memory = 53344 MB
Rank =  127  Free Memory = 53344 MB
  Input file(s): opt_h2o_gs_gvptt_32dets_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_32dets_run001d.xml

  Project = H2O
  date    = 2023-05-11 17:02:47 PDT
  host    = n0057.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 551

  Range of prime numbers to use as seeds over processors and threads = 4007-5099


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.130867e-01    1         1  ON     0
     uu_1                 4.837172e-02    1         1  ON     1
     uu_2                -4.948551e-02    1         1  ON     2
     uu_3                -1.044222e-01    1         1  ON     3
     uu_4                -1.348568e-01    1         1  ON     4
     uu_5                -1.379275e-01    1         1  ON     5
     uu_6                -1.122503e-01    1         1  ON     6
     uu_7                -3.948566e-02    1         1  ON     7
     uu_8                 9.976297e-02    1         1  ON     8
     uu_9                 1.222580e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.560752e-01    1         1  ON     0
     ud_1                 9.347116e-02    1         1  ON     1
     ud_2                -1.734102e-02    1         1  ON     2
     ud_3                -7.670014e-02    1         1  ON     3
     ud_4                -1.233598e-01    1         1  ON     4
     ud_5                -1.546620e-01    1         1  ON     5
     ud_6                -1.563664e-01    1         1  ON     6
     ud_7                -1.120708e-01    1         1  ON     7
     ud_8                 3.203600e-03    1         1  ON     8
     ud_9                 9.332770e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.669853e-01    1         1  ON     0
     eO_1                -4.441208e-01    1         1  ON     1
     eO_2                -3.323454e-02    1         1  ON     2
     eO_3                 2.162427e-01    1         1  ON     3
     eO_4                 2.985180e-01    1         1  ON     4
     eO_5                 3.079234e-01    1         1  ON     5
     eO_6                 2.503777e-01    1         1  ON     6
     eO_7                 1.132198e-01    1         1  ON     7
     eO_8                 2.823466e-02    1         1  ON     8
     eO_9                 1.877818e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.831449e-01    1         1  ON     0
     eH1_1                -1.046086e-01    1         1  ON     1
     eH1_2                -6.298052e-02    1         1  ON     2
     eH1_3                -2.596974e-02    1         1  ON     3
     eH1_4                 1.969020e-02    1         1  ON     4
     eH1_5                 3.582189e-02    1         1  ON     5
     eH1_6                 7.813637e-02    1         1  ON     6
     eH1_7                 1.104745e-01    1         1  ON     7
     eH1_8                 9.203333e-02    1         1  ON     8
     eH1_9                 2.490717e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.838179e-01    1         1  ON     0
     eH2_1                -1.054818e-01    1         1  ON     1
     eH2_2                -6.370237e-02    1         1  ON     2
     eH2_3                -2.661790e-02    1         1  ON     3
     eH2_4                 1.862577e-02    1         1  ON     4
     eH2_5                 3.500778e-02    1         1  ON     5
     eH2_6                 7.871536e-02    1         1  ON     6
     eH2_7                 1.135374e-01    1         1  ON     7
     eH2_8                 9.461342e-02    1         1  ON     8
     eH2_9                 2.673079e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 32 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.679499e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 11 unique up determinants.
Found 11 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.0121e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1606
    reference variance = 0.372097
====================================================
  Execution time = 3.9032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3110e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0391e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331119544638
                                         uncertainty =       0.002378440951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331119544638
                                         uncertainty =       0.002378440951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406878797
  error estimate for blocks of size 2^( 2) =       0.000417722437
  error estimate for blocks of size 2^( 3) =       0.000427717275
  error estimate for blocks of size 2^( 4) =       0.000434743763
  error estimate for blocks of size 2^( 5) =       0.000439280452
  error estimate for blocks of size 2^( 6) =       0.000442171750
  error estimate for blocks of size 2^( 7) =       0.000443812142

      target function =                  N/A
              le_mean =     -17.211291134414
             les_mean =     296.559643059056
             stat err =       0.000440002026
             autocorr =       1.169443476662
              std dev =       0.575413513079
             le_variance =       0.331100711034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721129113441e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211291134414       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211314909840       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211318852650       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211328488839       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211334176055       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211335410242       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211336003098       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211335690512       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211336381194       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211337122126       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211337162451       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211337211756       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.873865e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211291134414       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211301704503       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211303252997       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211306743216       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211308572330       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211308903920       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211308984210       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211308803464       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211308966380       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211308993461       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.505141e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211291134414       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211294415338       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211294888693       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211295908862       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211296332974       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211296470346       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211296443124       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211296412167       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211296440955       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 4.058105e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9794e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.132531e-01                 1 1 ON  0
uu_1  4.836970e-02                 1 1 ON  1
uu_2  -4.952123e-02                1 1 ON  2
uu_3  -1.044499e-01                1 1 ON  3
uu_4  -1.347676e-01                1 1 ON  4
uu_5  -1.379345e-01                1 1 ON  5
uu_6  -1.123783e-01                1 1 ON  6
uu_7  -3.962968e-02                1 1 ON  7
uu_8  9.968719e-02                 1 1 ON  8
uu_9  1.223201e-01                 1 1 ON  9
ud_0  3.570885e-01                 1 1 ON  10
ud_1  9.411244e-02                 1 1 ON  11
ud_2  -1.782088e-02                1 1 ON  12
ud_3  -7.730941e-02                1 1 ON  13
ud_4  -1.235285e-01                1 1 ON  14
ud_5  -1.545961e-01                1 1 ON  15
ud_6  -1.565505e-01                1 1 ON  16
ud_7  -1.122800e-01                1 1 ON  17
ud_8  3.032968e-03                 1 1 ON  18
ud_9  9.332637e-02                 1 1 ON  19
eO_0  -7.684905e-01                1 1 ON  20
eO_1  -4.448024e-01                1 1 ON  21
eO_2  -3.251861e-02                1 1 ON  22
eO_3  2.170498e-01                 1 1 ON  23
eO_4  2.989538e-01                 1 1 ON  24
eO_5  3.079712e-01                 1 1 ON  25
eO_6  2.504137e-01                 1 1 ON  26
eO_7  1.133163e-01                 1 1 ON  27
eO_8  2.825389e-02                 1 1 ON  28
eO_9  1.878960e-02                 1 1 ON  29
eH1_0 -1.832287e-01                1 1 ON  30
eH1_1 -1.045258e-01                1 1 ON  31
eH1_2 -6.301454e-02                1 1 ON  32
eH1_3 -2.586337e-02                1 1 ON  33
eH1_4 1.969093e-02                 1 1 ON  34
eH1_5 3.578148e-02                 1 1 ON  35
eH1_6 7.807650e-02                 1 1 ON  36
eH1_7 1.104130e-01                 1 1 ON  37
eH1_8 9.209159e-02                 1 1 ON  38
eH1_9 2.492543e-02                 1 1 ON  39
eH2_0 -1.839883e-01                1 1 ON  40
eH2_1 -1.054495e-01                1 1 ON  41
eH2_2 -6.362271e-02                1 1 ON  42
eH2_3 -2.648436e-02                1 1 ON  43
eH2_4 1.866039e-02                 1 1 ON  44
eH2_5 3.490895e-02                 1 1 ON  45
eH2_6 7.863005e-02                 1 1 ON  46
eH2_7 1.135067e-01                 1 1 ON  47
eH2_8 9.468025e-02                 1 1 ON  48
eH2_9 2.675539e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1401
    reference variance = 0.247991
====================================================
  Execution time = 3.7049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.9573e-01
  Total weights = 2.0000e+06
  Execution time = 3.0850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395129471776
                                         uncertainty =       0.058723845300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395129471776
                                         uncertainty =       0.058723845300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444377420
  error estimate for blocks of size 2^( 2) =       0.000455065535
  error estimate for blocks of size 2^( 3) =       0.000464544251
  error estimate for blocks of size 2^( 4) =       0.000471415037
  error estimate for blocks of size 2^( 5) =       0.000475046495
  error estimate for blocks of size 2^( 6) =       0.000478012573
  error estimate for blocks of size 2^( 7) =       0.000478938932

      target function =                  N/A
              le_mean =     -17.211908848742
             les_mean =     296.644748602290
             stat err =       0.000475853259
             autocorr =       1.146679715868
              std dev =       0.628444573806
             le_variance =       0.394942582346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397339798464
                                         uncertainty =       0.058419810548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397339798464
                                         uncertainty =       0.058419810548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445618891
  error estimate for blocks of size 2^( 2) =       0.000456205414
  error estimate for blocks of size 2^( 3) =       0.000465587661
  error estimate for blocks of size 2^( 4) =       0.000472379865
  error estimate for blocks of size 2^( 5) =       0.000475934680
  error estimate for blocks of size 2^( 6) =       0.000478860032
  error estimate for blocks of size 2^( 7) =       0.000479767112

      target function =                  N/A
              le_mean =     -17.211911575689
             les_mean =     296.647052282988
             stat err =       0.000476735422
             autocorr =       1.144531253692
              std dev =       0.630200279452
             le_variance =       0.397152392222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396763103447
                                         uncertainty =       0.058464957799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396763103447
                                         uncertainty =       0.058464957799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445295333
  error estimate for blocks of size 2^( 2) =       0.000455904428
  error estimate for blocks of size 2^( 3) =       0.000465310598
  error estimate for blocks of size 2^( 4) =       0.000472120929
  error estimate for blocks of size 2^( 5) =       0.000475688030
  error estimate for blocks of size 2^( 6) =       0.000478618845
  error estimate for blocks of size 2^( 7) =       0.000479531216

      target function =                  N/A
              le_mean =     -17.211907064035
             les_mean =     296.646320449675
             stat err =       0.000476489755
             autocorr =       1.145014133636
              std dev =       0.629742699040
             le_variance =       0.396575866995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395352897913
                                         uncertainty =       0.058684963392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395352897913
                                         uncertainty =       0.058684963392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444503071
  error estimate for blocks of size 2^( 2) =       0.000455178715
  error estimate for blocks of size 2^( 3) =       0.000464646283
  error estimate for blocks of size 2^( 4) =       0.000471507911
  error estimate for blocks of size 2^( 5) =       0.000475129224
  error estimate for blocks of size 2^( 6) =       0.000478089585
  error estimate for blocks of size 2^( 7) =       0.000479013956

      target function =                  N/A
              le_mean =     -17.211906521953
             les_mean =     296.644891883126
             stat err =       0.000475935169
             autocorr =       1.146426098056
              std dev =       0.628622271528
             le_variance =       0.395165960261


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211908848742        initial
     2.5000e-01     2.5000e+00             4.8739e-03       -17.211911575689  <--
     1.0000e+00     1.0000e+01             1.5051e-03       -17.211907064035
     4.0000e+00     4.0000e+01             4.0581e-04       -17.211906521953

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.2571e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.137134e-01 1 1  ON 0
 uu_1                 4.852756e-02 1 1  ON 1
 uu_2                -4.951545e-02 1 1  ON 2
 uu_3                -1.045399e-01 1 1  ON 3
 uu_4                -1.347900e-01 1 1  ON 4
 uu_5                -1.380494e-01 1 1  ON 5
 uu_6                -1.126623e-01 1 1  ON 6
 uu_7                -4.001964e-02 1 1  ON 7
 uu_8                 9.946563e-02 1 1  ON 8
 uu_9                 1.225087e-01 1 1  ON 9
 ud_0                 3.588878e-01 1 1  ON 10
 ud_1                 9.506081e-02 1 1  ON 11
 ud_2                -1.822224e-02 1 1  ON 12
 ud_3                -7.830401e-02 1 1  ON 13
 ud_4                -1.240534e-01 1 1  ON 14
 ud_5                -1.545111e-01 1 1  ON 15
 ud_6                -1.567838e-01 1 1  ON 16
 ud_7                -1.127758e-01 1 1  ON 17
 ud_8                 2.541613e-03 1 1  ON 18
 ud_9                 9.332514e-02 1 1  ON 19
 eO_0                -7.718592e-01 1 1  ON 20
 eO_1                -4.465427e-01 1 1  ON 21
 eO_2                -3.170887e-02 1 1  ON 22
 eO_3                 2.188946e-01 1 1  ON 23
 eO_4                 3.004922e-01 1 1  ON 24
 eO_5                 3.082962e-01 1 1  ON 25
 eO_6                 2.505630e-01 1 1  ON 26
 eO_7                 1.136130e-01 1 1  ON 27
 eO_8                 2.831276e-02 1 1  ON 28
 eO_9                 1.882421e-02 1 1  ON 29
eH1_0                -1.834159e-01 1 1  ON 30
eH1_1                -1.044871e-01 1 1  ON 31
eH1_2                -6.298436e-02 1 1  ON 32
eH1_3                -2.566391e-02 1 1  ON 33
eH1_4                 1.965349e-02 1 1  ON 34
eH1_5                 3.571677e-02 1 1  ON 35
eH1_6                 7.798201e-02 1 1  ON 36
eH1_7                 1.102540e-01 1 1  ON 37
eH1_8                 9.227109e-02 1 1  ON 38
eH1_9                 2.498107e-02 1 1  ON 39
eH2_0                -1.843584e-01 1 1  ON 40
eH2_1                -1.054431e-01 1 1  ON 41
eH2_2                -6.340701e-02 1 1  ON 42
eH2_3                -2.622556e-02 1 1  ON 43
eH2_4                 1.869336e-02 1 1  ON 44
eH2_5                 3.468875e-02 1 1  ON 45
eH2_6                 7.845411e-02 1 1  ON 46
eH2_7                 1.134381e-01 1 1  ON 47
eH2_8                 9.488533e-02 1 1  ON 48
eH2_9                 2.683029e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0237e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7150e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2557
    reference variance = 0.240149
====================================================
  Execution time = 3.8797e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3674e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0466e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336826599203
                                         uncertainty =       0.003852404295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336826599203
                                         uncertainty =       0.003852404295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410329367
  error estimate for blocks of size 2^( 2) =       0.000421455763
  error estimate for blocks of size 2^( 3) =       0.000431405818
  error estimate for blocks of size 2^( 4) =       0.000437957352
  error estimate for blocks of size 2^( 5) =       0.000441974331
  error estimate for blocks of size 2^( 6) =       0.000444491465
  error estimate for blocks of size 2^( 7) =       0.000445966028

      target function =                  N/A
              le_mean =     -17.212203567255
             les_mean =     296.596691851343
             stat err =       0.000442597294
             autocorr =       1.163462280616
              std dev =       0.580293356073
             le_variance =       0.336740379102


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721220356725e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212203567255       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212216585342       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212222761638       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212232244941       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212233284130       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212233659984       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212243374163       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212243262858       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212247132381       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212248776763       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212246713669       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212246119748       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.212246259132       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.212246166880       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.212246537778       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.041760e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212203567255       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212212192526       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212215668086       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212220226629       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212221480423       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212220918667       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212223904612       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212223558417       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212224292726       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212224528603       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212224318110       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 3.770381e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212203567255       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212207237958       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212208554856       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212209932383       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212210370919       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212210200218       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212210800514       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212210656864       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212210781747       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.126294e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.372554 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9277e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.140977e-01 1 1  ON 0
 uu_1                 4.888280e-02 1 1  ON 1
 uu_2                -4.927977e-02 1 1  ON 2
 uu_3                -1.046124e-01 1 1  ON 3
 uu_4                -1.349581e-01 1 1  ON 4
 uu_5                -1.381401e-01 1 1  ON 5
 uu_6                -1.130679e-01 1 1  ON 6
 uu_7                -4.062009e-02 1 1  ON 7
 uu_8                 9.915788e-02 1 1  ON 8
 uu_9                 1.227910e-01 1 1  ON 9
 ud_0                 3.605288e-01 1 1  ON 10
 ud_1                 9.586293e-02 1 1  ON 11
 ud_2                -1.858170e-02 1 1  ON 12
 ud_3                -7.948415e-02 1 1  ON 13
 ud_4                -1.249566e-01 1 1  ON 14
 ud_5                -1.545280e-01 1 1  ON 15
 ud_6                -1.564757e-01 1 1  ON 16
 ud_7                -1.129337e-01 1 1  ON 17
 ud_8                 2.040515e-03 1 1  ON 18
 ud_9                 9.339083e-02 1 1  ON 19
 eO_0                -7.756296e-01 1 1  ON 20
 eO_1                -4.487874e-01 1 1  ON 21
 eO_2                -3.094245e-02 1 1  ON 22
 eO_3                 2.210439e-01 1 1  ON 23
 eO_4                 3.022982e-01 1 1  ON 24
 eO_5                 3.086976e-01 1 1  ON 25
 eO_6                 2.507887e-01 1 1  ON 26
 eO_7                 1.140884e-01 1 1  ON 27
 eO_8                 2.841413e-02 1 1  ON 28
 eO_9                 1.887141e-02 1 1  ON 29
eH1_0                -1.837643e-01 1 1  ON 30
eH1_1                -1.047400e-01 1 1  ON 31
eH1_2                -6.306319e-02 1 1  ON 32
eH1_3                -2.574551e-02 1 1  ON 33
eH1_4                 1.964164e-02 1 1  ON 34
eH1_5                 3.606398e-02 1 1  ON 35
eH1_6                 7.812311e-02 1 1  ON 36
eH1_7                 1.101049e-01 1 1  ON 37
eH1_8                 9.255904e-02 1 1  ON 38
eH1_9                 2.510917e-02 1 1  ON 39
eH2_0                -1.844428e-01 1 1  ON 40
eH2_1                -1.053246e-01 1 1  ON 41
eH2_2                -6.342644e-02 1 1  ON 42
eH2_3                -2.631203e-02 1 1  ON 43
eH2_4                 1.862291e-02 1 1  ON 44
eH2_5                 3.465180e-02 1 1  ON 45
eH2_6                 7.846030e-02 1 1  ON 46
eH2_7                 1.132644e-01 1 1  ON 47
eH2_8                 9.507151e-02 1 1  ON 48
eH2_9                 2.692191e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.3283
    reference variance = 0.550868
====================================================
  Execution time = 3.7163e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3872e-01
  Total weights = 2.0000e+06
  Execution time = 3.0893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336944199148
                                         uncertainty =       0.003952057999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336944199148
                                         uncertainty =       0.003952057999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410605434
  error estimate for blocks of size 2^( 2) =       0.000421565038
  error estimate for blocks of size 2^( 3) =       0.000431698154
  error estimate for blocks of size 2^( 4) =       0.000438830474
  error estimate for blocks of size 2^( 5) =       0.000443584963
  error estimate for blocks of size 2^( 6) =       0.000446235954
  error estimate for blocks of size 2^( 7) =       0.000445719057

      target function =                  N/A
              le_mean =     -17.211519334880
             les_mean =     296.573591291012
             stat err =       0.000443592612
             autocorr =       1.167129977725
              std dev =       0.580683773379
             le_variance =       0.337193644665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339946846909
                                         uncertainty =       0.003989231965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339946846909
                                         uncertainty =       0.003989231965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412430438
  error estimate for blocks of size 2^( 2) =       0.000423275195
  error estimate for blocks of size 2^( 3) =       0.000433289033
  error estimate for blocks of size 2^( 4) =       0.000440323554
  error estimate for blocks of size 2^( 5) =       0.000445042542
  error estimate for blocks of size 2^( 6) =       0.000447636987
  error estimate for blocks of size 2^( 7) =       0.000447154211

      target function =                  N/A
              le_mean =     -17.211510125868
             les_mean =     296.576278375270
             stat err =       0.000445039324
             autocorr =       1.164381655352
              std dev =       0.583264719076
             le_variance =       0.340197732519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340062483216
                                         uncertainty =       0.003992274878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340062483216
                                         uncertainty =       0.003992274878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412500890
  error estimate for blocks of size 2^( 2) =       0.000423343554
  error estimate for blocks of size 2^( 3) =       0.000433358118
  error estimate for blocks of size 2^( 4) =       0.000440399144
  error estimate for blocks of size 2^( 5) =       0.000445120206
  error estimate for blocks of size 2^( 6) =       0.000447716642
  error estimate for blocks of size 2^( 7) =       0.000447204214

      target function =                  N/A
              le_mean =     -17.211514323973
             les_mean =     296.576539122016
             stat err =       0.000445110051
             autocorr =       1.164353958967
              std dev =       0.583364352567
             le_variance =       0.340313967846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337476731368
                                         uncertainty =       0.003959225091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337476731368
                                         uncertainty =       0.003959225091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410929793
  error estimate for blocks of size 2^( 2) =       0.000421865692
  error estimate for blocks of size 2^( 3) =       0.000431975095
  error estimate for blocks of size 2^( 4) =       0.000439090351
  error estimate for blocks of size 2^( 5) =       0.000443837809
  error estimate for blocks of size 2^( 6) =       0.000446477958
  error estimate for blocks of size 2^( 7) =       0.000445956461

      target function =                  N/A
              le_mean =     -17.211514671077
             les_mean =     296.573963692715
             stat err =       0.000443840645
             autocorr =       1.166591701051
              std dev =       0.581142485865
             le_variance =       0.337726588878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211519334880        initial  <--
     6.2500e-02     6.2500e-01             1.0418e-02       -17.211510125868
     2.5000e-01     2.5000e+00             3.7704e-03       -17.211514323973
     1.0000e+00     1.0000e+01             1.1263e-03       -17.211514671077

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.7761
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.137134e-01 1 1  ON 0
 uu_1                 4.852756e-02 1 1  ON 1
 uu_2                -4.951545e-02 1 1  ON 2
 uu_3                -1.045399e-01 1 1  ON 3
 uu_4                -1.347900e-01 1 1  ON 4
 uu_5                -1.380494e-01 1 1  ON 5
 uu_6                -1.126623e-01 1 1  ON 6
 uu_7                -4.001964e-02 1 1  ON 7
 uu_8                 9.946563e-02 1 1  ON 8
 uu_9                 1.225087e-01 1 1  ON 9
 ud_0                 3.588878e-01 1 1  ON 10
 ud_1                 9.506081e-02 1 1  ON 11
 ud_2                -1.822224e-02 1 1  ON 12
 ud_3                -7.830401e-02 1 1  ON 13
 ud_4                -1.240534e-01 1 1  ON 14
 ud_5                -1.545111e-01 1 1  ON 15
 ud_6                -1.567838e-01 1 1  ON 16
 ud_7                -1.127758e-01 1 1  ON 17
 ud_8                 2.541613e-03 1 1  ON 18
 ud_9                 9.332514e-02 1 1  ON 19
 eO_0                -7.718592e-01 1 1  ON 20
 eO_1                -4.465427e-01 1 1  ON 21
 eO_2                -3.170887e-02 1 1  ON 22
 eO_3                 2.188946e-01 1 1  ON 23
 eO_4                 3.004922e-01 1 1  ON 24
 eO_5                 3.082962e-01 1 1  ON 25
 eO_6                 2.505630e-01 1 1  ON 26
 eO_7                 1.136130e-01 1 1  ON 27
 eO_8                 2.831276e-02 1 1  ON 28
 eO_9                 1.882421e-02 1 1  ON 29
eH1_0                -1.834159e-01 1 1  ON 30
eH1_1                -1.044871e-01 1 1  ON 31
eH1_2                -6.298436e-02 1 1  ON 32
eH1_3                -2.566391e-02 1 1  ON 33
eH1_4                 1.965349e-02 1 1  ON 34
eH1_5                 3.571677e-02 1 1  ON 35
eH1_6                 7.798201e-02 1 1  ON 36
eH1_7                 1.102540e-01 1 1  ON 37
eH1_8                 9.227109e-02 1 1  ON 38
eH1_9                 2.498107e-02 1 1  ON 39
eH2_0                -1.843584e-01 1 1  ON 40
eH2_1                -1.054431e-01 1 1  ON 41
eH2_2                -6.340701e-02 1 1  ON 42
eH2_3                -2.622556e-02 1 1  ON 43
eH2_4                 1.869336e-02 1 1  ON 44
eH2_5                 3.468875e-02 1 1  ON 45
eH2_6                 7.845411e-02 1 1  ON 46
eH2_7                 1.134381e-01 1 1  ON 47
eH2_8                 9.488533e-02 1 1  ON 48
eH2_9                 2.683029e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0206e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.3042
    reference variance = 0.348143
====================================================
  Execution time = 3.7608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0267e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819690099
                                         uncertainty =       0.006406839432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819690099
                                         uncertainty =       0.006406839432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412134909
  error estimate for blocks of size 2^( 2) =       0.000422719583
  error estimate for blocks of size 2^( 3) =       0.000432302662
  error estimate for blocks of size 2^( 4) =       0.000439434078
  error estimate for blocks of size 2^( 5) =       0.000444487899
  error estimate for blocks of size 2^( 6) =       0.000445209708
  error estimate for blocks of size 2^( 7) =       0.000448151190

      target function =                  N/A
              le_mean =     -17.211911395588
             les_mean =     296.589604086435
             stat err =       0.000444320719
             autocorr =       1.162289529609
              std dev =       0.582846778073
             le_variance =       0.339710366710


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721191139559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211911395588       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211914163733       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211914196576       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211915378516       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211919547760       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211920295352       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211919035725       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211918885402       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211918768331       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211918998200       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.579194e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211911395588       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211912316339       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211912349741       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211912631444       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211913948156       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211914045882       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211913741090       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211913692929       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211913687171       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 4.347240e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211911395588       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211911646508       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211911657911       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211911727171       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211912078199       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211912090795       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211912018788       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211912008200       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.117749e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.377025 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7884e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.137225e-01 1 1  ON 0
 uu_1                 4.856042e-02 1 1  ON 1
 uu_2                -4.949696e-02 1 1  ON 2
 uu_3                -1.045191e-01 1 1  ON 3
 uu_4                -1.347764e-01 1 1  ON 4
 uu_5                -1.380333e-01 1 1  ON 5
 uu_6                -1.127021e-01 1 1  ON 6
 uu_7                -4.009338e-02 1 1  ON 7
 uu_8                 9.942333e-02 1 1  ON 8
 uu_9                 1.225282e-01 1 1  ON 9
 ud_0                 3.591016e-01 1 1  ON 10
 ud_1                 9.522993e-02 1 1  ON 11
 ud_2                -1.828216e-02 1 1  ON 12
 ud_3                -7.846774e-02 1 1  ON 13
 ud_4                -1.241095e-01 1 1  ON 14
 ud_5                -1.545026e-01 1 1  ON 15
 ud_6                -1.568038e-01 1 1  ON 16
 ud_7                -1.128148e-01 1 1  ON 17
 ud_8                 2.472916e-03 1 1  ON 18
 ud_9                 9.332237e-02 1 1  ON 19
 eO_0                -7.722939e-01 1 1  ON 20
 eO_1                -4.467592e-01 1 1  ON 21
 eO_2                -3.159902e-02 1 1  ON 22
 eO_3                 2.191261e-01 1 1  ON 23
 eO_4                 3.006730e-01 1 1  ON 24
 eO_5                 3.083598e-01 1 1  ON 25
 eO_6                 2.505811e-01 1 1  ON 26
 eO_7                 1.136514e-01 1 1  ON 27
 eO_8                 2.831717e-02 1 1  ON 28
 eO_9                 1.882679e-02 1 1  ON 29
eH1_0                -1.834198e-01 1 1  ON 30
eH1_1                -1.044726e-01 1 1  ON 31
eH1_2                -6.299744e-02 1 1  ON 32
eH1_3                -2.563464e-02 1 1  ON 33
eH1_4                 1.969018e-02 1 1  ON 34
eH1_5                 3.565931e-02 1 1  ON 35
eH1_6                 7.796100e-02 1 1  ON 36
eH1_7                 1.102382e-01 1 1  ON 37
eH1_8                 9.229406e-02 1 1  ON 38
eH1_9                 2.498743e-02 1 1  ON 39
eH2_0                -1.844173e-01 1 1  ON 40
eH2_1                -1.054521e-01 1 1  ON 41
eH2_2                -6.342354e-02 1 1  ON 42
eH2_3                -2.622420e-02 1 1  ON 43
eH2_4                 1.873734e-02 1 1  ON 44
eH2_5                 3.469844e-02 1 1  ON 45
eH2_6                 7.844833e-02 1 1  ON 46
eH2_7                 1.134320e-01 1 1  ON 47
eH2_8                 9.491258e-02 1 1  ON 48
eH2_9                 2.684076e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2219
    reference variance = 0.380027
====================================================
  Execution time = 3.7025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3755e-01
  Total weights = 2.0000e+06
  Execution time = 3.0827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337382701779
                                         uncertainty =       0.004811354228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337382701779
                                         uncertainty =       0.004811354228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410721003
  error estimate for blocks of size 2^( 2) =       0.000421391108
  error estimate for blocks of size 2^( 3) =       0.000430936864
  error estimate for blocks of size 2^( 4) =       0.000438331915
  error estimate for blocks of size 2^( 5) =       0.000443437893
  error estimate for blocks of size 2^( 6) =       0.000444859152
  error estimate for blocks of size 2^( 7) =       0.000447396271

      target function =                  N/A
              le_mean =     -17.212007885090
             les_mean =     296.590598751926
             stat err =       0.000443506308
             autocorr =       1.166019406763
              std dev =       0.580847212449
             le_variance =       0.337383484209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337963313914
                                         uncertainty =       0.004816021012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337963313914
                                         uncertainty =       0.004816021012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411074275
  error estimate for blocks of size 2^( 2) =       0.000421715001
  error estimate for blocks of size 2^( 3) =       0.000431230917
  error estimate for blocks of size 2^( 4) =       0.000438604580
  error estimate for blocks of size 2^( 5) =       0.000443697474
  error estimate for blocks of size 2^( 6) =       0.000445105003
  error estimate for blocks of size 2^( 7) =       0.000447638990

      target function =                  N/A
              le_mean =     -17.212005167973
             les_mean =     296.591085851979
             stat err =       0.000443761512
             autocorr =       1.165356132650
              std dev =       0.581346814413
             le_variance =       0.337964118628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337722078088
                                         uncertainty =       0.004813176119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337722078088
                                         uncertainty =       0.004813176119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410927545
  error estimate for blocks of size 2^( 2) =       0.000421579281
  error estimate for blocks of size 2^( 3) =       0.000431106560
  error estimate for blocks of size 2^( 4) =       0.000438488749
  error estimate for blocks of size 2^( 5) =       0.000443586312
  error estimate for blocks of size 2^( 6) =       0.000444999373
  error estimate for blocks of size 2^( 7) =       0.000447533486

      target function =                  N/A
              le_mean =     -17.212005915962
             les_mean =     296.590870375930
             stat err =       0.000443651980
             autocorr =       1.165612891652
              std dev =       0.581139306599
             le_variance =       0.337722893674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337426577293
                                         uncertainty =       0.004811545542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337426577293
                                         uncertainty =       0.004811545542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410747712
  error estimate for blocks of size 2^( 2) =       0.000421415322
  error estimate for blocks of size 2^( 3) =       0.000430958582
  error estimate for blocks of size 2^( 4) =       0.000438351925
  error estimate for blocks of size 2^( 5) =       0.000443456755
  error estimate for blocks of size 2^( 6) =       0.000444876922
  error estimate for blocks of size 2^( 7) =       0.000447413585

      target function =                  N/A
              le_mean =     -17.212007540876
             les_mean =     296.590630783755
             stat err =       0.000443524797
             autocorr =       1.165964978030
              std dev =       0.580884984555
             le_variance =       0.337427365282


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212007885090        initial  <--
     6.2500e-01     6.2500e+00             1.5792e-03       -17.212005167973
     2.5000e+00     2.5000e+01             4.3472e-04       -17.212005915962
     1.0000e+01     1.0000e+02             1.1177e-04       -17.212007540876

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.5790
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.137134e-01 1 1  ON 0
 uu_1                 4.852756e-02 1 1  ON 1
 uu_2                -4.951545e-02 1 1  ON 2
 uu_3                -1.045399e-01 1 1  ON 3
 uu_4                -1.347900e-01 1 1  ON 4
 uu_5                -1.380494e-01 1 1  ON 5
 uu_6                -1.126623e-01 1 1  ON 6
 uu_7                -4.001964e-02 1 1  ON 7
 uu_8                 9.946563e-02 1 1  ON 8
 uu_9                 1.225087e-01 1 1  ON 9
 ud_0                 3.588878e-01 1 1  ON 10
 ud_1                 9.506081e-02 1 1  ON 11
 ud_2                -1.822224e-02 1 1  ON 12
 ud_3                -7.830401e-02 1 1  ON 13
 ud_4                -1.240534e-01 1 1  ON 14
 ud_5                -1.545111e-01 1 1  ON 15
 ud_6                -1.567838e-01 1 1  ON 16
 ud_7                -1.127758e-01 1 1  ON 17
 ud_8                 2.541613e-03 1 1  ON 18
 ud_9                 9.332514e-02 1 1  ON 19
 eO_0                -7.718592e-01 1 1  ON 20
 eO_1                -4.465427e-01 1 1  ON 21
 eO_2                -3.170887e-02 1 1  ON 22
 eO_3                 2.188946e-01 1 1  ON 23
 eO_4                 3.004922e-01 1 1  ON 24
 eO_5                 3.082962e-01 1 1  ON 25
 eO_6                 2.505630e-01 1 1  ON 26
 eO_7                 1.136130e-01 1 1  ON 27
 eO_8                 2.831276e-02 1 1  ON 28
 eO_9                 1.882421e-02 1 1  ON 29
eH1_0                -1.834159e-01 1 1  ON 30
eH1_1                -1.044871e-01 1 1  ON 31
eH1_2                -6.298436e-02 1 1  ON 32
eH1_3                -2.566391e-02 1 1  ON 33
eH1_4                 1.965349e-02 1 1  ON 34
eH1_5                 3.571677e-02 1 1  ON 35
eH1_6                 7.798201e-02 1 1  ON 36
eH1_7                 1.102540e-01 1 1  ON 37
eH1_8                 9.227109e-02 1 1  ON 38
eH1_9                 2.498107e-02 1 1  ON 39
eH2_0                -1.843584e-01 1 1  ON 40
eH2_1                -1.054431e-01 1 1  ON 41
eH2_2                -6.340701e-02 1 1  ON 42
eH2_3                -2.622556e-02 1 1  ON 43
eH2_4                 1.869336e-02 1 1  ON 44
eH2_5                 3.468875e-02 1 1  ON 45
eH2_6                 7.845411e-02 1 1  ON 46
eH2_7                 1.134381e-01 1 1  ON 47
eH2_8                 9.488533e-02 1 1  ON 48
eH2_9                 2.683029e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0047e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2161
    reference variance = 0.255254
====================================================
  Execution time = 3.7054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4213e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0500e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342119340502
                                         uncertainty =       0.004626451668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342119340502
                                         uncertainty =       0.004626451668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413602202
  error estimate for blocks of size 2^( 2) =       0.000423925933
  error estimate for blocks of size 2^( 3) =       0.000433633010
  error estimate for blocks of size 2^( 4) =       0.000440634825
  error estimate for blocks of size 2^( 5) =       0.000444956965
  error estimate for blocks of size 2^( 6) =       0.000446132399
  error estimate for blocks of size 2^( 7) =       0.000448748099

      target function =                  N/A
              le_mean =     -17.211887508170
             les_mean =     296.591204985258
             stat err =       0.000445118072
             autocorr =       1.158203227920
              std dev =       0.584921843017
             le_variance =       0.342133562439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721188750817e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211887508170       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211887802422       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211887863467       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211888104808       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211888213633       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211888404773       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211888419862       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211888398784       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211888393930       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.770246e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211887508170       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211887584453       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211887598072       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211887660136       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211887686670       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211887734775       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211887738306       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211887734151       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 4.458173e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211887508170       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211887527418       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211887530719       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211887546346       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211887552922       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211887564958       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211887565831       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211887564866       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 1.117779e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380768 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7563e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.137170e-01 1 1  ON 0
 uu_1                 4.853334e-02 1 1  ON 1
 uu_2                -4.951499e-02 1 1  ON 2
 uu_3                -1.045394e-01 1 1  ON 3
 uu_4                -1.347914e-01 1 1  ON 4
 uu_5                -1.380484e-01 1 1  ON 5
 uu_6                -1.126655e-01 1 1  ON 6
 uu_7                -4.002727e-02 1 1  ON 7
 uu_8                 9.946101e-02 1 1  ON 8
 uu_9                 1.225108e-01 1 1  ON 9
 ud_0                 3.589137e-01 1 1  ON 10
 ud_1                 9.507472e-02 1 1  ON 11
 ud_2                -1.823343e-02 1 1  ON 12
 ud_3                -7.831890e-02 1 1  ON 13
 ud_4                -1.240629e-01 1 1  ON 14
 ud_5                -1.545081e-01 1 1  ON 15
 ud_6                -1.567848e-01 1 1  ON 16
 ud_7                -1.127793e-01 1 1  ON 17
 ud_8                 2.535764e-03 1 1  ON 18
 ud_9                 9.332516e-02 1 1  ON 19
 eO_0                -7.719038e-01 1 1  ON 20
 eO_1                -4.465677e-01 1 1  ON 21
 eO_2                -3.169306e-02 1 1  ON 22
 eO_3                 2.189177e-01 1 1  ON 23
 eO_4                 3.005108e-01 1 1  ON 24
 eO_5                 3.083018e-01 1 1  ON 25
 eO_6                 2.505642e-01 1 1  ON 26
 eO_7                 1.136168e-01 1 1  ON 27
 eO_8                 2.831344e-02 1 1  ON 28
 eO_9                 1.882467e-02 1 1  ON 29
eH1_0                -1.834212e-01 1 1  ON 30
eH1_1                -1.044945e-01 1 1  ON 31
eH1_2                -6.298390e-02 1 1  ON 32
eH1_3                -2.565846e-02 1 1  ON 33
eH1_4                 1.965527e-02 1 1  ON 34
eH1_5                 3.571559e-02 1 1  ON 35
eH1_6                 7.798648e-02 1 1  ON 36
eH1_7                 1.102535e-01 1 1  ON 37
eH1_8                 9.227249e-02 1 1  ON 38
eH1_9                 2.498155e-02 1 1  ON 39
eH2_0                -1.843625e-01 1 1  ON 40
eH2_1                -1.054376e-01 1 1  ON 41
eH2_2                -6.341284e-02 1 1  ON 42
eH2_3                -2.622235e-02 1 1  ON 43
eH2_4                 1.869462e-02 1 1  ON 44
eH2_5                 3.468488e-02 1 1  ON 45
eH2_6                 7.845525e-02 1 1  ON 46
eH2_7                 1.134372e-01 1 1  ON 47
eH2_8                 9.488745e-02 1 1  ON 48
eH2_9                 2.683108e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2298
    reference variance = 0.195703
====================================================
  Execution time = 3.6990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3200e-01
  Total weights = 2.0000e+06
  Execution time = 3.0998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332060988907
                                         uncertainty =       0.002545203638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332060988907
                                         uncertainty =       0.002545203638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407416962
  error estimate for blocks of size 2^( 2) =       0.000418314486
  error estimate for blocks of size 2^( 3) =       0.000428373130
  error estimate for blocks of size 2^( 4) =       0.000436172470
  error estimate for blocks of size 2^( 5) =       0.000441123797
  error estimate for blocks of size 2^( 6) =       0.000446181364
  error estimate for blocks of size 2^( 7) =       0.000446511780

      target function =                  N/A
              le_mean =     -17.212033571060
             les_mean =     296.586076646526
             stat err =       0.000442497353
             autocorr =       1.179622757844
              std dev =       0.576174592657
             le_variance =       0.331977161223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332162707067
                                         uncertainty =       0.002546129708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332162707067
                                         uncertainty =       0.002546129708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407479364
  error estimate for blocks of size 2^( 2) =       0.000418372012
  error estimate for blocks of size 2^( 3) =       0.000428425486
  error estimate for blocks of size 2^( 4) =       0.000436221451
  error estimate for blocks of size 2^( 5) =       0.000441171130
  error estimate for blocks of size 2^( 6) =       0.000446228254
  error estimate for blocks of size 2^( 7) =       0.000446559389

      target function =                  N/A
              le_mean =     -17.212033902081
             les_mean =     296.586189744052
             stat err =       0.000442545056
             autocorr =       1.179515760678
              std dev =       0.576262842558
             le_variance =       0.332078863713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332113569874
                                         uncertainty =       0.002545685195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332113569874
                                         uncertainty =       0.002545685195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407449220
  error estimate for blocks of size 2^( 2) =       0.000418344212
  error estimate for blocks of size 2^( 3) =       0.000428400185
  error estimate for blocks of size 2^( 4) =       0.000436197801
  error estimate for blocks of size 2^( 5) =       0.000441148276
  error estimate for blocks of size 2^( 6) =       0.000446205605
  error estimate for blocks of size 2^( 7) =       0.000446536386

      target function =                  N/A
              le_mean =     -17.212033734344
             les_mean =     296.586134840666
             stat err =       0.000442522017
             autocorr =       1.179567460775
              std dev =       0.576220213548
             le_variance =       0.332029734501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332067601132
                                         uncertainty =       0.002545264149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332067601132
                                         uncertainty =       0.002545264149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407421018
  error estimate for blocks of size 2^( 2) =       0.000418318223
  error estimate for blocks of size 2^( 3) =       0.000428376531
  error estimate for blocks of size 2^( 4) =       0.000436175654
  error estimate for blocks of size 2^( 5) =       0.000441126873
  error estimate for blocks of size 2^( 6) =       0.000446184409
  error estimate for blocks of size 2^( 7) =       0.000446514871

      target function =                  N/A
              le_mean =     -17.212033590747
             les_mean =     296.586083935499
             stat err =       0.000442500452
             autocorr =       1.179615788669
              std dev =       0.576180329830
             le_variance =       0.331983772483


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212033571060        initial
     6.2500e+00     6.2500e+01             1.7702e-04       -17.212033902081  <--
     2.5000e+01     2.5000e+02             4.4582e-05       -17.212033734344
     1.0000e+02     1.0000e+03             1.1178e-05       -17.212033590747

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 5.2593e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.137288e-01 1 1  ON 0
 uu_1                 4.854974e-02 1 1  ON 1
 uu_2                -4.951414e-02 1 1  ON 2
 uu_3                -1.045377e-01 1 1  ON 3
 uu_4                -1.347953e-01 1 1  ON 4
 uu_5                -1.380460e-01 1 1  ON 5
 uu_6                -1.126750e-01 1 1  ON 6
 uu_7                -4.005025e-02 1 1  ON 7
 uu_8                 9.944697e-02 1 1  ON 8
 uu_9                 1.225174e-01 1 1  ON 9
 ud_0                 3.589888e-01 1 1  ON 10
 ud_1                 9.511547e-02 1 1  ON 11
 ud_2                -1.826369e-02 1 1  ON 12
 ud_3                -7.836257e-02 1 1  ON 13
 ud_4                -1.240917e-01 1 1  ON 14
 ud_5                -1.545001e-01 1 1  ON 15
 ud_6                -1.567872e-01 1 1  ON 16
 ud_7                -1.127893e-01 1 1  ON 17
 ud_8                 2.518016e-03 1 1  ON 18
 ud_9                 9.332526e-02 1 1  ON 19
 eO_0                -7.720362e-01 1 1  ON 20
 eO_1                -4.466421e-01 1 1  ON 21
 eO_2                -3.164980e-02 1 1  ON 22
 eO_3                 2.189859e-01 1 1  ON 23
 eO_4                 3.005680e-01 1 1  ON 24
 eO_5                 3.083199e-01 1 1  ON 25
 eO_6                 2.505683e-01 1 1  ON 26
 eO_7                 1.136285e-01 1 1  ON 27
 eO_8                 2.831554e-02 1 1  ON 28
 eO_9                 1.882608e-02 1 1  ON 29
eH1_0                -1.834366e-01 1 1  ON 30
eH1_1                -1.045148e-01 1 1  ON 31
eH1_2                -6.298373e-02 1 1  ON 32
eH1_3                -2.564403e-02 1 1  ON 33
eH1_4                 1.966080e-02 1 1  ON 34
eH1_5                 3.571217e-02 1 1  ON 35
eH1_6                 7.800039e-02 1 1  ON 36
eH1_7                 1.102520e-01 1 1  ON 37
eH1_8                 9.227684e-02 1 1  ON 38
eH1_9                 2.498302e-02 1 1  ON 39
eH2_0                -1.843743e-01 1 1  ON 40
eH2_1                -1.054227e-01 1 1  ON 41
eH2_2                -6.343014e-02 1 1  ON 42
eH2_3                -2.621281e-02 1 1  ON 43
eH2_4                 1.869857e-02 1 1  ON 44
eH2_5                 3.467361e-02 1 1  ON 45
eH2_6                 7.845910e-02 1 1  ON 46
eH2_7                 1.134347e-01 1 1  ON 47
eH2_8                 9.489402e-02 1 1  ON 48
eH2_9                 2.683353e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0016e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7232e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1438
    reference variance = 0.1418
====================================================
  Execution time = 3.8470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4679e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0668e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346857035559
                                         uncertainty =       0.009737612335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346857035559
                                         uncertainty =       0.009737612335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416408905
  error estimate for blocks of size 2^( 2) =       0.000427037583
  error estimate for blocks of size 2^( 3) =       0.000436807384
  error estimate for blocks of size 2^( 4) =       0.000443490614
  error estimate for blocks of size 2^( 5) =       0.000447389865
  error estimate for blocks of size 2^( 6) =       0.000448697069
  error estimate for blocks of size 2^( 7) =       0.000448743575

      target function =                  N/A
              le_mean =     -17.212087937720
             les_mean =     296.602763755404
             stat err =       0.000447080281
             autocorr =       1.152739067375
              std dev =       0.588891121517
             le_variance =       0.346792753001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721208793772e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212087937720       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212090200287       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212091715824       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212092637879       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212092331013       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212092563487       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212092920404       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212092829992       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212092851196       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 6.741266e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212087937720       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212088566693       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212089011066       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212089200441       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212089145485       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212089166243       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212089280332       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212089258437       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212089263790       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.751955e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212087937720       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212088099491       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212088215612       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212088259167       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212088248567       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212088251630       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212088279899       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212088274599       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 4.408169e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.384904 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9147e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.137355e-01 1 1  ON 0
 uu_1                 4.855913e-02 1 1  ON 1
 uu_2                -4.949550e-02 1 1  ON 2
 uu_3                -1.045368e-01 1 1  ON 3
 uu_4                -1.347884e-01 1 1  ON 4
 uu_5                -1.380493e-01 1 1  ON 5
 uu_6                -1.127067e-01 1 1  ON 6
 uu_7                -4.007236e-02 1 1  ON 7
 uu_8                 9.943763e-02 1 1  ON 8
 uu_9                 1.225282e-01 1 1  ON 9
 ud_0                 3.590736e-01 1 1  ON 10
 ud_1                 9.516841e-02 1 1  ON 11
 ud_2                -1.828485e-02 1 1  ON 12
 ud_3                -7.842171e-02 1 1  ON 13
 ud_4                -1.241339e-01 1 1  ON 14
 ud_5                -1.544876e-01 1 1  ON 15
 ud_6                -1.567838e-01 1 1  ON 16
 ud_7                -1.128032e-01 1 1  ON 17
 ud_8                 2.494516e-03 1 1  ON 18
 ud_9                 9.332253e-02 1 1  ON 19
 eO_0                -7.722114e-01 1 1  ON 20
 eO_1                -4.467407e-01 1 1  ON 21
 eO_2                -3.159650e-02 1 1  ON 22
 eO_3                 2.190812e-01 1 1  ON 23
 eO_4                 3.006549e-01 1 1  ON 24
 eO_5                 3.083269e-01 1 1  ON 25
 eO_6                 2.505743e-01 1 1  ON 26
 eO_7                 1.136483e-01 1 1  ON 27
 eO_8                 2.831882e-02 1 1  ON 28
 eO_9                 1.882716e-02 1 1  ON 29
eH1_0                -1.834533e-01 1 1  ON 30
eH1_1                -1.045329e-01 1 1  ON 31
eH1_2                -6.297176e-02 1 1  ON 32
eH1_3                -2.562572e-02 1 1  ON 33
eH1_4                 1.964863e-02 1 1  ON 34
eH1_5                 3.572263e-02 1 1  ON 35
eH1_6                 7.799996e-02 1 1  ON 36
eH1_7                 1.102442e-01 1 1  ON 37
eH1_8                 9.228603e-02 1 1  ON 38
eH1_9                 2.498664e-02 1 1  ON 39
eH2_0                -1.843913e-01 1 1  ON 40
eH2_1                -1.054129e-01 1 1  ON 41
eH2_2                -6.344024e-02 1 1  ON 42
eH2_3                -2.620967e-02 1 1  ON 43
eH2_4                 1.869848e-02 1 1  ON 44
eH2_5                 3.467339e-02 1 1  ON 45
eH2_6                 7.846658e-02 1 1  ON 46
eH2_7                 1.134299e-01 1 1  ON 47
eH2_8                 9.490222e-02 1 1  ON 48
eH2_9                 2.683569e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2538
    reference variance = 0.237342
====================================================
  Execution time = 3.6985e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4163e-01
  Total weights = 2.0000e+06
  Execution time = 3.1665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341625228245
                                         uncertainty =       0.003672458562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341625228245
                                         uncertainty =       0.003672458562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413258005
  error estimate for blocks of size 2^( 2) =       0.000423946420
  error estimate for blocks of size 2^( 3) =       0.000433640870
  error estimate for blocks of size 2^( 4) =       0.000440890703
  error estimate for blocks of size 2^( 5) =       0.000446312343
  error estimate for blocks of size 2^( 6) =       0.000447609488
  error estimate for blocks of size 2^( 7) =       0.000449245567

      target function =                  N/A
              le_mean =     -17.212495480122
             les_mean =     296.611564839928
             stat err =       0.000446014525
             autocorr =       1.164810976912
              std dev =       0.584435075526
             le_variance =       0.341564357505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341874299705
                                         uncertainty =       0.003674127880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341874299705
                                         uncertainty =       0.003674127880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413408644
  error estimate for blocks of size 2^( 2) =       0.000424084148
  error estimate for blocks of size 2^( 3) =       0.000433767119
  error estimate for blocks of size 2^( 4) =       0.000441007359
  error estimate for blocks of size 2^( 5) =       0.000446424625
  error estimate for blocks of size 2^( 6) =       0.000447717249
  error estimate for blocks of size 2^( 7) =       0.000449350064

      target function =                  N/A
              le_mean =     -17.212497034072
             les_mean =     296.611867390846
             stat err =       0.000446124824
             autocorr =       1.164538023790
              std dev =       0.584648111096
             le_variance =       0.341813413809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341758036424
                                         uncertainty =       0.003673346462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341758036424
                                         uncertainty =       0.003673346462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413338333
  error estimate for blocks of size 2^( 2) =       0.000424019691
  error estimate for blocks of size 2^( 3) =       0.000433707943
  error estimate for blocks of size 2^( 4) =       0.000440952569
  error estimate for blocks of size 2^( 5) =       0.000446371797
  error estimate for blocks of size 2^( 6) =       0.000447666408
  error estimate for blocks of size 2^( 7) =       0.000449300715

      target function =                  N/A
              le_mean =     -17.212496265867
             les_mean =     296.611724686807
             stat err =       0.000446072872
             autocorr =       1.164662943214
              std dev =       0.584548676491
             le_variance =       0.341697155187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341642223319
                                         uncertainty =       0.003672576662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341642223319
                                         uncertainty =       0.003672576662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413268285
  error estimate for blocks of size 2^( 2) =       0.000423955786
  error estimate for blocks of size 2^( 3) =       0.000433649438
  error estimate for blocks of size 2^( 4) =       0.000440898605
  error estimate for blocks of size 2^( 5) =       0.000446319938
  error estimate for blocks of size 2^( 6) =       0.000447616756
  error estimate for blocks of size 2^( 7) =       0.000449252591

      target function =                  N/A
              le_mean =     -17.212495567851
             les_mean =     296.611584853342
             stat err =       0.000446021972
             autocorr =       1.164791927061
              std dev =       0.584449613600
             le_variance =       0.341581350838


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212495480122        initial
     1.5625e+00     1.5625e+01             6.7413e-04       -17.212497034072  <--
     6.2500e+00     6.2500e+01             1.7520e-04       -17.212496265867
     2.5000e+01     2.5000e+02             4.4082e-05       -17.212495567851

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 5.2649e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.137628e-01 1 1  ON 0
 uu_1                 4.859661e-02 1 1  ON 1
 uu_2                -4.944998e-02 1 1  ON 2
 uu_3                -1.045305e-01 1 1  ON 3
 uu_4                -1.347805e-01 1 1  ON 4
 uu_5                -1.380592e-01 1 1  ON 5
 uu_6                -1.127986e-01 1 1  ON 6
 uu_7                -4.013798e-02 1 1  ON 7
 uu_8                 9.940991e-02 1 1  ON 8
 uu_9                 1.225599e-01 1 1  ON 9
 ud_0                 3.593050e-01 1 1  ON 10
 ud_1                 9.530769e-02 1 1  ON 11
 ud_2                -1.833149e-02 1 1  ON 12
 ud_3                -7.857718e-02 1 1  ON 13
 ud_4                -1.242561e-01 1 1  ON 14
 ud_5                -1.544590e-01 1 1  ON 15
 ud_6                -1.567694e-01 1 1  ON 16
 ud_7                -1.128418e-01 1 1  ON 17
 ud_8                 2.425454e-03 1 1  ON 18
 ud_9                 9.331448e-02 1 1  ON 19
 eO_0                -7.727103e-01 1 1  ON 20
 eO_1                -4.470237e-01 1 1  ON 21
 eO_2                -3.146506e-02 1 1  ON 22
 eO_3                 2.193581e-01 1 1  ON 23
 eO_4                 3.009127e-01 1 1  ON 24
 eO_5                 3.083500e-01 1 1  ON 25
 eO_6                 2.505924e-01 1 1  ON 26
 eO_7                 1.137068e-01 1 1  ON 27
 eO_8                 2.832846e-02 1 1  ON 28
 eO_9                 1.883033e-02 1 1  ON 29
eH1_0                -1.835036e-01 1 1  ON 30
eH1_1                -1.045803e-01 1 1  ON 31
eH1_2                -6.293795e-02 1 1  ON 32
eH1_3                -2.557584e-02 1 1  ON 33
eH1_4                 1.961423e-02 1 1  ON 34
eH1_5                 3.575205e-02 1 1  ON 35
eH1_6                 7.799922e-02 1 1  ON 36
eH1_7                 1.102213e-01 1 1  ON 37
eH1_8                 9.231310e-02 1 1  ON 38
eH1_9                 2.499732e-02 1 1  ON 39
eH2_0                -1.844396e-01 1 1  ON 40
eH2_1                -1.053914e-01 1 1  ON 41
eH2_2                -6.346397e-02 1 1  ON 42
eH2_3                -2.620167e-02 1 1  ON 43
eH2_4                 1.869610e-02 1 1  ON 44
eH2_5                 3.467440e-02 1 1  ON 45
eH2_6                 7.848983e-02 1 1  ON 46
eH2_7                 1.134161e-01 1 1  ON 47
eH2_8                 9.492642e-02 1 1  ON 48
eH2_9                 2.684208e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0180e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2035
    reference variance = 0.183721
====================================================
  Execution time = 3.7202e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3561e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0600e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335454241262
                                         uncertainty =       0.003298159923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335454241262
                                         uncertainty =       0.003298159923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409637994
  error estimate for blocks of size 2^( 2) =       0.000420497892
  error estimate for blocks of size 2^( 3) =       0.000430346819
  error estimate for blocks of size 2^( 4) =       0.000438526572
  error estimate for blocks of size 2^( 5) =       0.000441478476
  error estimate for blocks of size 2^( 6) =       0.000444116918
  error estimate for blocks of size 2^( 7) =       0.000444375712

      target function =                  N/A
              le_mean =     -17.211939481007
             les_mean =     296.586467102478
             stat err =       0.000442124419
             autocorr =       1.164899726620
              std dev =       0.579315606940
             le_variance =       0.335606572444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721193948101e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211939481007       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211942823397       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211947776210       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211949707368       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211950499962       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211952222799       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211953871676       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211953786771       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211953614007       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211953412741       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211953563663       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 2.348074e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211939481007       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211940653700       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211942423196       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211943166600       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211943339714       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211943768463       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211944095000       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211944060658       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211944017333       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 6.757770e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211939481007       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211939807064       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211940304930       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211940522798       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211940559508       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211940665402       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211940735073       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211940724226       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211940716801       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.766105e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389510 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7812e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.138374e-01 1 1  ON 0
 uu_1                 4.865906e-02 1 1  ON 1
 uu_2                -4.944078e-02 1 1  ON 2
 uu_3                -1.045600e-01 1 1  ON 3
 uu_4                -1.348044e-01 1 1  ON 4
 uu_5                -1.380291e-01 1 1  ON 5
 uu_6                -1.128626e-01 1 1  ON 6
 uu_7                -4.022897e-02 1 1  ON 7
 uu_8                 9.935466e-02 1 1  ON 8
 uu_9                 1.225918e-01 1 1  ON 9
 ud_0                 3.596037e-01 1 1  ON 10
 ud_1                 9.547269e-02 1 1  ON 11
 ud_2                -1.839717e-02 1 1  ON 12
 ud_3                -7.882177e-02 1 1  ON 13
 ud_4                -1.243611e-01 1 1  ON 14
 ud_5                -1.544147e-01 1 1  ON 15
 ud_6                -1.567830e-01 1 1  ON 16
 ud_7                -1.128747e-01 1 1  ON 17
 ud_8                 2.337799e-03 1 1  ON 18
 ud_9                 9.330560e-02 1 1  ON 19
 eO_0                -7.733861e-01 1 1  ON 20
 eO_1                -4.473253e-01 1 1  ON 21
 eO_2                -3.130158e-02 1 1  ON 22
 eO_3                 2.196484e-01 1 1  ON 23
 eO_4                 3.012368e-01 1 1  ON 24
 eO_5                 3.084118e-01 1 1  ON 25
 eO_6                 2.506322e-01 1 1  ON 26
 eO_7                 1.137825e-01 1 1  ON 27
 eO_8                 2.833701e-02 1 1  ON 28
 eO_9                 1.883610e-02 1 1  ON 29
eH1_0                -1.836497e-01 1 1  ON 30
eH1_1                -1.046012e-01 1 1  ON 31
eH1_2                -6.291196e-02 1 1  ON 32
eH1_3                -2.549350e-02 1 1  ON 33
eH1_4                 1.967816e-02 1 1  ON 34
eH1_5                 3.569377e-02 1 1  ON 35
eH1_6                 7.800305e-02 1 1  ON 36
eH1_7                 1.102021e-01 1 1  ON 37
eH1_8                 9.235600e-02 1 1  ON 38
eH1_9                 2.501191e-02 1 1  ON 39
eH2_0                -1.844482e-01 1 1  ON 40
eH2_1                -1.054057e-01 1 1  ON 41
eH2_2                -6.345272e-02 1 1  ON 42
eH2_3                -2.617910e-02 1 1  ON 43
eH2_4                 1.873043e-02 1 1  ON 44
eH2_5                 3.463941e-02 1 1  ON 45
eH2_6                 7.844348e-02 1 1  ON 46
eH2_7                 1.133936e-01 1 1  ON 47
eH2_8                 9.496628e-02 1 1  ON 48
eH2_9                 2.685457e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2135
    reference variance = 0.251113
====================================================
  Execution time = 3.6848e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4117e-01
  Total weights = 2.0000e+06
  Execution time = 3.1087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340900311284
                                         uncertainty =       0.008266790205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340900311284
                                         uncertainty =       0.008266790205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412846094
  error estimate for blocks of size 2^( 2) =       0.000423644559
  error estimate for blocks of size 2^( 3) =       0.000433795800
  error estimate for blocks of size 2^( 4) =       0.000440388096
  error estimate for blocks of size 2^( 5) =       0.000444800468
  error estimate for blocks of size 2^( 6) =       0.000447213819
  error estimate for blocks of size 2^( 7) =       0.000449542027

      target function =                  N/A
              le_mean =     -17.212215676181
             les_mean =     296.601252106781
             stat err =       0.000445486102
             autocorr =       1.164372557554
              std dev =       0.583852544607
             le_variance =       0.340883793844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341794302141
                                         uncertainty =       0.008284735662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341794302141
                                         uncertainty =       0.008284735662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413387209
  error estimate for blocks of size 2^( 2) =       0.000424149479
  error estimate for blocks of size 2^( 3) =       0.000434265194
  error estimate for blocks of size 2^( 4) =       0.000440833950
  error estimate for blocks of size 2^( 5) =       0.000445239407
  error estimate for blocks of size 2^( 6) =       0.000447644919
  error estimate for blocks of size 2^( 7) =       0.000449961954

      target function =                  N/A
              le_mean =     -17.212216634444
             les_mean =     296.602179269215
             stat err =       0.000445920057
             autocorr =       1.163589907028
              std dev =       0.584617797432
             le_variance =       0.341777969074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341474678325
                                         uncertainty =       0.008276988722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341474678325
                                         uncertainty =       0.008276988722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413193822
  error estimate for blocks of size 2^( 2) =       0.000423968306
  error estimate for blocks of size 2^( 3) =       0.000434096067
  error estimate for blocks of size 2^( 4) =       0.000440673095
  error estimate for blocks of size 2^( 5) =       0.000445081951
  error estimate for blocks of size 2^( 6) =       0.000447489536
  error estimate for blocks of size 2^( 7) =       0.000449809813

      target function =                  N/A
              le_mean =     -17.212216186582
             les_mean =     296.601844152703
             stat err =       0.000445763598
             autocorr =       1.163862195246
              std dev =       0.584344307573
             le_variance =       0.341458269793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340976924043
                                         uncertainty =       0.008268065426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340976924043
                                         uncertainty =       0.008268065426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412892493
  error estimate for blocks of size 2^( 2) =       0.000423687635
  error estimate for blocks of size 2^( 3) =       0.000433835613
  error estimate for blocks of size 2^( 4) =       0.000440425806
  error estimate for blocks of size 2^( 5) =       0.000444837745
  error estimate for blocks of size 2^( 6) =       0.000447250275
  error estimate for blocks of size 2^( 7) =       0.000449577345

      target function =                  N/A
              le_mean =     -17.212215621019
             les_mean =     296.601326834705
             stat err =       0.000445522793
             autocorr =       1.164302639468
              std dev =       0.583918162712
             le_variance =       0.340960420745


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212215676181        initial
     3.9062e-01     3.9062e+00             2.3481e-03       -17.212216634444  <--
     1.5625e+00     1.5625e+01             6.7578e-04       -17.212216186582
     6.2500e+00     6.2500e+01             1.7661e-04       -17.212215621019

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 5.2428e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.141026e-01 1 1  ON 0
 uu_1                 4.882976e-02 1 1  ON 1
 uu_2                -4.938896e-02 1 1  ON 2
 uu_3                -1.046271e-01 1 1  ON 3
 uu_4                -1.349089e-01 1 1  ON 4
 uu_5                -1.380317e-01 1 1  ON 5
 uu_6                -1.130212e-01 1 1  ON 6
 uu_7                -4.048546e-02 1 1  ON 7
 uu_8                 9.918923e-02 1 1  ON 8
 uu_9                 1.226892e-01 1 1  ON 9
 ud_0                 3.602457e-01 1 1  ON 10
 ud_1                 9.581135e-02 1 1  ON 11
 ud_2                -1.847836e-02 1 1  ON 12
 ud_3                -7.926806e-02 1 1  ON 13
 ud_4                -1.246872e-01 1 1  ON 14
 ud_5                -1.543695e-01 1 1  ON 15
 ud_6                -1.567617e-01 1 1  ON 16
 ud_7                -1.129380e-01 1 1  ON 17
 ud_8                 2.079791e-03 1 1  ON 18
 ud_9                 9.327985e-02 1 1  ON 19
 eO_0                -7.750584e-01 1 1  ON 20
 eO_1                -4.482062e-01 1 1  ON 21
 eO_2                -3.111630e-02 1 1  ON 22
 eO_3                 2.203433e-01 1 1  ON 23
 eO_4                 3.022221e-01 1 1  ON 24
 eO_5                 3.086598e-01 1 1  ON 25
 eO_6                 2.507706e-01 1 1  ON 26
 eO_7                 1.140158e-01 1 1  ON 27
 eO_8                 2.836339e-02 1 1  ON 28
 eO_9                 1.885375e-02 1 1  ON 29
eH1_0                -1.840043e-01 1 1  ON 30
eH1_1                -1.046681e-01 1 1  ON 31
eH1_2                -6.283162e-02 1 1  ON 32
eH1_3                -2.533636e-02 1 1  ON 33
eH1_4                 1.982399e-02 1 1  ON 34
eH1_5                 3.554098e-02 1 1  ON 35
eH1_6                 7.803385e-02 1 1  ON 36
eH1_7                 1.101521e-01 1 1  ON 37
eH1_8                 9.248839e-02 1 1  ON 38
eH1_9                 2.505656e-02 1 1  ON 39
eH2_0                -1.844794e-01 1 1  ON 40
eH2_1                -1.054534e-01 1 1  ON 41
eH2_2                -6.339658e-02 1 1  ON 42
eH2_3                -2.613412e-02 1 1  ON 43
eH2_4                 1.879358e-02 1 1  ON 44
eH2_5                 3.454593e-02 1 1  ON 45
eH2_6                 7.832999e-02 1 1  ON 46
eH2_7                 1.133352e-01 1 1  ON 47
eH2_8                 9.508945e-02 1 1  ON 48
eH2_9                 2.689292e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0025e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2096
    reference variance = 0.242937
====================================================
  Execution time = 3.7506e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4059e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0464e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340674377417
                                         uncertainty =       0.004423548331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340674377417
                                         uncertainty =       0.004423548331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412666868
  error estimate for blocks of size 2^( 2) =       0.000423304721
  error estimate for blocks of size 2^( 3) =       0.000433041260
  error estimate for blocks of size 2^( 4) =       0.000440025123
  error estimate for blocks of size 2^( 5) =       0.000442749879
  error estimate for blocks of size 2^( 6) =       0.000445934825
  error estimate for blocks of size 2^( 7) =       0.000445540696

      target function =                  N/A
              le_mean =     -17.211761679391
             les_mean =     296.585327825731
             stat err =       0.000443562631
             autocorr =       1.155342363014
              std dev =       0.583599081464
             le_variance =       0.340587887885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721176167939e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211761679391       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211762869377       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211757652466       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211761103857       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211760760843       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211767529135       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211771003093       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211770649858       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211771811780       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211772022065       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211771803010       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211771874633       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 6.304910e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211761679391       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211762334706       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211760023275       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211760087804       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211761215400       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211763453988       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211763900104       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211763838749       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211764100546       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211763966134       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 2.023970e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211761679391       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211761913663       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211761316992       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211761200246       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211761556267       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211762095212       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211762108057       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211762111554       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211762137458       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 5.636078e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.394721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7980e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.143530e-01 1 1  ON 0
 uu_1                 4.907619e-02 1 1  ON 1
 uu_2                -4.931327e-02 1 1  ON 2
 uu_3                -1.046711e-01 1 1  ON 3
 uu_4                -1.350273e-01 1 1  ON 4
 uu_5                -1.383144e-01 1 1  ON 5
 uu_6                -1.130434e-01 1 1  ON 6
 uu_7                -4.069564e-02 1 1  ON 7
 uu_8                 9.902038e-02 1 1  ON 8
 uu_9                 1.228118e-01 1 1  ON 9
 ud_0                 3.609343e-01 1 1  ON 10
 ud_1                 9.614650e-02 1 1  ON 11
 ud_2                -1.863556e-02 1 1  ON 12
 ud_3                -7.976464e-02 1 1  ON 13
 ud_4                -1.251274e-01 1 1  ON 14
 ud_5                -1.546022e-01 1 1  ON 15
 ud_6                -1.564082e-01 1 1  ON 16
 ud_7                -1.127565e-01 1 1  ON 17
 ud_8                 1.778964e-03 1 1  ON 18
 ud_9                 9.326032e-02 1 1  ON 19
 eO_0                -7.770824e-01 1 1  ON 20
 eO_1                -4.495060e-01 1 1  ON 21
 eO_2                -3.117297e-02 1 1  ON 22
 eO_3                 2.213613e-01 1 1  ON 23
 eO_4                 3.035964e-01 1 1  ON 24
 eO_5                 3.090269e-01 1 1  ON 25
 eO_6                 2.510070e-01 1 1  ON 26
 eO_7                 1.143321e-01 1 1  ON 27
 eO_8                 2.841464e-02 1 1  ON 28
 eO_9                 1.886288e-02 1 1  ON 29
eH1_0                -1.841419e-01 1 1  ON 30
eH1_1                -1.045698e-01 1 1  ON 31
eH1_2                -6.286588e-02 1 1  ON 32
eH1_3                -2.526693e-02 1 1  ON 33
eH1_4                 1.975107e-02 1 1  ON 34
eH1_5                 3.540131e-02 1 1  ON 35
eH1_6                 7.813603e-02 1 1  ON 36
eH1_7                 1.100908e-01 1 1  ON 37
eH1_8                 9.259645e-02 1 1  ON 38
eH1_9                 2.511272e-02 1 1  ON 39
eH2_0                -1.846527e-01 1 1  ON 40
eH2_1                -1.053993e-01 1 1  ON 41
eH2_2                -6.357550e-02 1 1  ON 42
eH2_3                -2.602389e-02 1 1  ON 43
eH2_4                 1.882213e-02 1 1  ON 44
eH2_5                 3.450170e-02 1 1  ON 45
eH2_6                 7.828815e-02 1 1  ON 46
eH2_7                 1.133314e-01 1 1  ON 47
eH2_8                 9.526757e-02 1 1  ON 48
eH2_9                 2.695051e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2363
    reference variance = 0.214694
====================================================
  Execution time = 3.6839e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4575e-01
  Total weights = 2.0000e+06
  Execution time = 3.0947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345122721352
                                         uncertainty =       0.005927494363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345122721352
                                         uncertainty =       0.005927494363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415343149
  error estimate for blocks of size 2^( 2) =       0.000425983952
  error estimate for blocks of size 2^( 3) =       0.000435345495
  error estimate for blocks of size 2^( 4) =       0.000442091631
  error estimate for blocks of size 2^( 5) =       0.000446999232
  error estimate for blocks of size 2^( 6) =       0.000449690882
  error estimate for blocks of size 2^( 7) =       0.000449739007

      target function =                  N/A
              le_mean =     -17.211612838028
             les_mean =     296.584636176591
             stat err =       0.000447130188
             autocorr =       1.158921132310
              std dev =       0.587383914421
             le_variance =       0.345019862920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346795048661
                                         uncertainty =       0.005932213524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346795048661
                                         uncertainty =       0.005932213524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416348447
  error estimate for blocks of size 2^( 2) =       0.000426933985
  error estimate for blocks of size 2^( 3) =       0.000436231277
  error estimate for blocks of size 2^( 4) =       0.000442924444
  error estimate for blocks of size 2^( 5) =       0.000447789053
  error estimate for blocks of size 2^( 6) =       0.000450472573
  error estimate for blocks of size 2^( 7) =       0.000450512354

      target function =                  N/A
              le_mean =     -17.211623444594
             les_mean =     296.586673484569
             stat err =       0.000447924606
             autocorr =       1.157433216555
              std dev =       0.588805621091
             le_variance =       0.346692059428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346604419092
                                         uncertainty =       0.005939256735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346604419092
                                         uncertainty =       0.005939256735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416233953
  error estimate for blocks of size 2^( 2) =       0.000426827498
  error estimate for blocks of size 2^( 3) =       0.000436134831
  error estimate for blocks of size 2^( 4) =       0.000442836196
  error estimate for blocks of size 2^( 5) =       0.000447709450
  error estimate for blocks of size 2^( 6) =       0.000450389564
  error estimate for blocks of size 2^( 7) =       0.000450432570

      target function =                  N/A
              le_mean =     -17.211618962032
             les_mean =     296.586328528644
             stat err =       0.000447841945
             autocorr =       1.157642671265
              std dev =       0.588643701847
             le_variance =       0.346501407725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345370559072
                                         uncertainty =       0.005929690920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345370559072
                                         uncertainty =       0.005929690920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415492283
  error estimate for blocks of size 2^( 2) =       0.000426124761
  error estimate for blocks of size 2^( 3) =       0.000435476977
  error estimate for blocks of size 2^( 4) =       0.000442215556
  error estimate for blocks of size 2^( 5) =       0.000447117572
  error estimate for blocks of size 2^( 6) =       0.000449807145
  error estimate for blocks of size 2^( 7) =       0.000449854507

      target function =                  N/A
              le_mean =     -17.211612915668
             les_mean =     296.584886661268
             stat err =       0.000447248695
             autocorr =       1.158703287746
              std dev =       0.587594822234
             le_variance =       0.345267675116


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211612838028        initial
     9.7656e-02     9.7656e-01             6.3049e-03       -17.211623444594  <--
     3.9062e-01     3.9062e+00             2.0240e-03       -17.211618962032
     1.5625e+00     1.5625e+01             5.6361e-04       -17.211612915668

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 5.2419e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.151531e-01 1 1  ON 0
 uu_1                 4.972574e-02 1 1  ON 1
 uu_2                -4.898987e-02 1 1  ON 2
 uu_3                -1.046866e-01 1 1  ON 3
 uu_4                -1.353906e-01 1 1  ON 4
 uu_5                -1.390980e-01 1 1  ON 5
 uu_6                -1.133592e-01 1 1  ON 6
 uu_7                -4.130344e-02 1 1  ON 7
 uu_8                 9.854943e-02 1 1  ON 8
 uu_9                 1.231630e-01 1 1  ON 9
 ud_0                 3.618897e-01 1 1  ON 10
 ud_1                 9.668204e-02 1 1  ON 11
 ud_2                -1.861243e-02 1 1  ON 12
 ud_3                -8.028580e-02 1 1  ON 13
 ud_4                -1.258680e-01 1 1  ON 14
 ud_5                -1.552356e-01 1 1  ON 15
 ud_6                -1.559440e-01 1 1  ON 16
 ud_7                -1.122421e-01 1 1  ON 17
 ud_8                 9.765595e-04 1 1  ON 18
 ud_9                 9.321203e-02 1 1  ON 19
 eO_0                -7.813633e-01 1 1  ON 20
 eO_1                -4.525999e-01 1 1  ON 21
 eO_2                -3.211473e-02 1 1  ON 22
 eO_3                 2.228746e-01 1 1  ON 23
 eO_4                 3.072985e-01 1 1  ON 24
 eO_5                 3.103133e-01 1 1  ON 25
 eO_6                 2.517143e-01 1 1  ON 26
 eO_7                 1.152404e-01 1 1  ON 27
 eO_8                 2.856376e-02 1 1  ON 28
 eO_9                 1.888929e-02 1 1  ON 29
eH1_0                -1.843181e-01 1 1  ON 30
eH1_1                -1.045655e-01 1 1  ON 31
eH1_2                -6.283317e-02 1 1  ON 32
eH1_3                -2.515547e-02 1 1  ON 33
eH1_4                 1.961454e-02 1 1  ON 34
eH1_5                 3.491519e-02 1 1  ON 35
eH1_6                 7.842898e-02 1 1  ON 36
eH1_7                 1.099406e-01 1 1  ON 37
eH1_8                 9.290886e-02 1 1  ON 38
eH1_9                 2.527423e-02 1 1  ON 39
eH2_0                -1.849464e-01 1 1  ON 40
eH2_1                -1.055146e-01 1 1  ON 41
eH2_2                -6.372667e-02 1 1  ON 42
eH2_3                -2.591843e-02 1 1  ON 43
eH2_4                 1.884827e-02 1 1  ON 44
eH2_5                 3.426838e-02 1 1  ON 45
eH2_6                 7.821718e-02 1 1  ON 46
eH2_7                 1.133484e-01 1 1  ON 47
eH2_8                 9.577916e-02 1 1  ON 48
eH2_9                 2.711594e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0041e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2734
    reference variance = 0.360874
====================================================
  Execution time = 4.0369e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4565e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0584e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345626182360
                                         uncertainty =       0.012334769632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345626182360
                                         uncertainty =       0.012334769632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415719811
  error estimate for blocks of size 2^( 2) =       0.000426619292
  error estimate for blocks of size 2^( 3) =       0.000435194308
  error estimate for blocks of size 2^( 4) =       0.000441792715
  error estimate for blocks of size 2^( 5) =       0.000446158929
  error estimate for blocks of size 2^( 6) =       0.000446411769
  error estimate for blocks of size 2^( 7) =       0.000448259534

      target function =                  N/A
              le_mean =     -17.211485062285
             les_mean =     296.580863799372
             stat err =       0.000445655736
             autocorr =       1.149205138655
              std dev =       0.587916595207
             le_variance =       0.345645922920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721148506229e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211485062285       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211489995203       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211492966987       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211494151439       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211498689484       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211504170167       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211503108879       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211502667651       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211503767168       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211507385547       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211506823465       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211506515467       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211507533460       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211508470250       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211508124448       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211508581552       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211508564449       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.272774e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211485062285       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211488591658       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211491062089       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211491790337       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211494123469       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211496655099       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211495150064       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211494612107       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211494869330       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211495700799       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211495605161       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211495379079       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 4.685540e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211485062285       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211486712985       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211488250383       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211488620676       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211489328553       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211489860302       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211489215724       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211489079837       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211489111378       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211489221932       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.445682e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.403306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0967e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.160583e-01 1 1  ON 0
 uu_1                 5.044637e-02 1 1  ON 1
 uu_2                -4.835124e-02 1 1  ON 2
 uu_3                -1.043952e-01 1 1  ON 3
 uu_4                -1.357047e-01 1 1  ON 4
 uu_5                -1.393730e-01 1 1  ON 5
 uu_6                -1.144892e-01 1 1  ON 6
 uu_7                -4.247717e-02 1 1  ON 7
 uu_8                 9.755680e-02 1 1  ON 8
 uu_9                 1.236371e-01 1 1  ON 9
 ud_0                 3.629425e-01 1 1  ON 10
 ud_1                 9.761065e-02 1 1  ON 11
 ud_2                -1.833839e-02 1 1  ON 12
 ud_3                -8.038660e-02 1 1  ON 13
 ud_4                -1.266177e-01 1 1  ON 14
 ud_5                -1.557567e-01 1 1  ON 15
 ud_6                -1.561624e-01 1 1  ON 16
 ud_7                -1.126654e-01 1 1  ON 17
 ud_8                -1.519669e-04 1 1  ON 18
 ud_9                 9.326721e-02 1 1  ON 19
 eO_0                -7.860489e-01 1 1  ON 20
 eO_1                -4.559314e-01 1 1  ON 21
 eO_2                -3.319512e-02 1 1  ON 22
 eO_3                 2.246582e-01 1 1  ON 23
 eO_4                 3.108405e-01 1 1  ON 24
 eO_5                 3.119757e-01 1 1  ON 25
 eO_6                 2.524697e-01 1 1  ON 26
 eO_7                 1.162057e-01 1 1  ON 27
 eO_8                 2.871095e-02 1 1  ON 28
 eO_9                 1.898195e-02 1 1  ON 29
eH1_0                -1.846592e-01 1 1  ON 30
eH1_1                -1.048166e-01 1 1  ON 31
eH1_2                -6.262592e-02 1 1  ON 32
eH1_3                -2.515608e-02 1 1  ON 33
eH1_4                 1.955956e-02 1 1  ON 34
eH1_5                 3.471718e-02 1 1  ON 35
eH1_6                 7.840012e-02 1 1  ON 36
eH1_7                 1.095909e-01 1 1  ON 37
eH1_8                 9.350486e-02 1 1  ON 38
eH1_9                 2.552605e-02 1 1  ON 39
eH2_0                -1.851667e-01 1 1  ON 40
eH2_1                -1.057354e-01 1 1  ON 41
eH2_2                -6.312845e-02 1 1  ON 42
eH2_3                -2.578583e-02 1 1  ON 43
eH2_4                 1.853635e-02 1 1  ON 44
eH2_5                 3.348780e-02 1 1  ON 45
eH2_6                 7.825435e-02 1 1  ON 46
eH2_7                 1.131921e-01 1 1  ON 47
eH2_8                 9.639566e-02 1 1  ON 48
eH2_9                 2.730771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2414
    reference variance = 0.169738
====================================================
  Execution time = 3.6927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.6051e-01
  Total weights = 2.0000e+06
  Execution time = 3.1086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360041148424
                                         uncertainty =       0.013148807469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360041148424
                                         uncertainty =       0.013148807469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424224318
  error estimate for blocks of size 2^( 2) =       0.000435063826
  error estimate for blocks of size 2^( 3) =       0.000444394434
  error estimate for blocks of size 2^( 4) =       0.000451542303
  error estimate for blocks of size 2^( 5) =       0.000455969199
  error estimate for blocks of size 2^( 6) =       0.000458439091
  error estimate for blocks of size 2^( 7) =       0.000460320485

      target function =                  N/A
              le_mean =     -17.211150235725
             les_mean =     296.583624800688
             stat err =       0.000456567770
             autocorr =       1.158295530062
              std dev =       0.599943783985
             le_variance =       0.359932543942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361385872259
                                         uncertainty =       0.013130494988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361385872259
                                         uncertainty =       0.013130494988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425015948
  error estimate for blocks of size 2^( 2) =       0.000435815873
  error estimate for blocks of size 2^( 3) =       0.000445083944
  error estimate for blocks of size 2^( 4) =       0.000452181653
  error estimate for blocks of size 2^( 5) =       0.000456604179
  error estimate for blocks of size 2^( 6) =       0.000459053669
  error estimate for blocks of size 2^( 7) =       0.000460911515

      target function =                  N/A
              le_mean =     -17.211154266366
             les_mean =     296.585108112433
             stat err =       0.000457187754
             autocorr =       1.157120865308
              std dev =       0.601063318149
             le_variance =       0.361277112424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361225531620
                                         uncertainty =       0.013134166869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361225531620
                                         uncertainty =       0.013134166869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424921613
  error estimate for blocks of size 2^( 2) =       0.000435727006
  error estimate for blocks of size 2^( 3) =       0.000445006894
  error estimate for blocks of size 2^( 4) =       0.000452115564
  error estimate for blocks of size 2^( 5) =       0.000456541911
  error estimate for blocks of size 2^( 6) =       0.000458989959
  error estimate for blocks of size 2^( 7) =       0.000460850128

      target function =                  N/A
              le_mean =     -17.211157427179
             les_mean =     296.585056557485
             stat err =       0.000457124390
             autocorr =       1.157313835611
              std dev =       0.600929908472
             le_variance =       0.361116754897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360188838052
                                         uncertainty =       0.013145452074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360188838052
                                         uncertainty =       0.013145452074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424311323
  error estimate for blocks of size 2^( 2) =       0.000435145190
  error estimate for blocks of size 2^( 3) =       0.000444468016
  error estimate for blocks of size 2^( 4) =       0.000451609438
  error estimate for blocks of size 2^( 5) =       0.000456036739
  error estimate for blocks of size 2^( 6) =       0.000458501874
  error estimate for blocks of size 2^( 7) =       0.000460379636

      target function =                  N/A
              le_mean =     -17.211150564742
             les_mean =     296.583783780476
             stat err =       0.000456631922
             autocorr =       1.158145951048
              std dev =       0.600066828202
             le_variance =       0.360080198309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211150235725        initial
     2.4414e-02     2.4414e-01             1.2728e-02       -17.211154266366
     9.7656e-02     9.7656e-01             4.6855e-03       -17.211157427179  <--
     3.9062e-01     3.9062e+00             1.4457e-03       -17.211150564742

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 5.2622e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.160583e-01 1 1  ON 0
 uu_1                 5.044637e-02 1 1  ON 1
 uu_2                -4.835124e-02 1 1  ON 2
 uu_3                -1.043952e-01 1 1  ON 3
 uu_4                -1.357047e-01 1 1  ON 4
 uu_5                -1.393730e-01 1 1  ON 5
 uu_6                -1.144892e-01 1 1  ON 6
 uu_7                -4.247717e-02 1 1  ON 7
 uu_8                 9.755680e-02 1 1  ON 8
 uu_9                 1.236371e-01 1 1  ON 9
 ud_0                 3.629425e-01 1 1  ON 10
 ud_1                 9.761065e-02 1 1  ON 11
 ud_2                -1.833839e-02 1 1  ON 12
 ud_3                -8.038660e-02 1 1  ON 13
 ud_4                -1.266177e-01 1 1  ON 14
 ud_5                -1.557567e-01 1 1  ON 15
 ud_6                -1.561624e-01 1 1  ON 16
 ud_7                -1.126654e-01 1 1  ON 17
 ud_8                -1.519669e-04 1 1  ON 18
 ud_9                 9.326721e-02 1 1  ON 19
 eO_0                -7.860489e-01 1 1  ON 20
 eO_1                -4.559314e-01 1 1  ON 21
 eO_2                -3.319512e-02 1 1  ON 22
 eO_3                 2.246582e-01 1 1  ON 23
 eO_4                 3.108405e-01 1 1  ON 24
 eO_5                 3.119757e-01 1 1  ON 25
 eO_6                 2.524697e-01 1 1  ON 26
 eO_7                 1.162057e-01 1 1  ON 27
 eO_8                 2.871095e-02 1 1  ON 28
 eO_9                 1.898195e-02 1 1  ON 29
eH1_0                -1.846592e-01 1 1  ON 30
eH1_1                -1.048166e-01 1 1  ON 31
eH1_2                -6.262592e-02 1 1  ON 32
eH1_3                -2.515608e-02 1 1  ON 33
eH1_4                 1.955956e-02 1 1  ON 34
eH1_5                 3.471718e-02 1 1  ON 35
eH1_6                 7.840012e-02 1 1  ON 36
eH1_7                 1.095909e-01 1 1  ON 37
eH1_8                 9.350486e-02 1 1  ON 38
eH1_9                 2.552605e-02 1 1  ON 39
eH2_0                -1.851667e-01 1 1  ON 40
eH2_1                -1.057354e-01 1 1  ON 41
eH2_2                -6.312845e-02 1 1  ON 42
eH2_3                -2.578583e-02 1 1  ON 43
eH2_4                 1.853635e-02 1 1  ON 44
eH2_5                 3.348780e-02 1 1  ON 45
eH2_6                 7.825435e-02 1 1  ON 46
eH2_7                 1.131921e-01 1 1  ON 47
eH2_8                 9.639566e-02 1 1  ON 48
eH2_9                 2.730771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0359e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2622
    reference variance = 0.334375
====================================================
  Execution time = 3.7858e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 4.6200e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0531e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462230772413
                                         uncertainty =       0.118278910763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462230772413
                                         uncertainty =       0.118278910763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480626237
  error estimate for blocks of size 2^( 2) =       0.000489885148
  error estimate for blocks of size 2^( 3) =       0.000498104522
  error estimate for blocks of size 2^( 4) =       0.000504495701
  error estimate for blocks of size 2^( 5) =       0.000508267908
  error estimate for blocks of size 2^( 6) =       0.000510909214
  error estimate for blocks of size 2^( 7) =       0.000511976764

      target function =                  N/A
              le_mean =     -17.211534936798
             les_mean =     296.698937808592
             stat err =       0.000508912397
             autocorr =       1.121169076479
              std dev =       0.679708142488
             le_variance =       0.462003158965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721153493680e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211534936798       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211536997579       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211536712593       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211539020213       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211545032831       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211543982368       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211543260628       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211548487763       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211549701830       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211553038110       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211549582976       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211550043666       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211550399724       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211550695394       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211551223169       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211551049067       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211550433754       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.115435e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211534936798       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211536573983       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211536526029       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211538346728       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211539448463       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211539395532       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211538748635       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211540411652       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211540648045       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211541259554       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211540350712       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211540481359       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 3.329744e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211534936798       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211535835261       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211535974895       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211536860563       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211536799512       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211536404198       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211536474098       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211536773169       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211536737104       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 9.419646e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.411247 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8402e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.173566e-01 1 1  ON 0
 uu_1                 5.112198e-02 1 1  ON 1
 uu_2                -4.782571e-02 1 1  ON 2
 uu_3                -1.041592e-01 1 1  ON 3
 uu_4                -1.356757e-01 1 1  ON 4
 uu_5                -1.396232e-01 1 1  ON 5
 uu_6                -1.152720e-01 1 1  ON 6
 uu_7                -4.385142e-02 1 1  ON 7
 uu_8                 9.654450e-02 1 1  ON 8
 uu_9                 1.239278e-01 1 1  ON 9
 ud_0                 3.640082e-01 1 1  ON 10
 ud_1                 9.831887e-02 1 1  ON 11
 ud_2                -1.758564e-02 1 1  ON 12
 ud_3                -8.003113e-02 1 1  ON 13
 ud_4                -1.265204e-01 1 1  ON 14
 ud_5                -1.559138e-01 1 1  ON 15
 ud_6                -1.562201e-01 1 1  ON 16
 ud_7                -1.135941e-01 1 1  ON 17
 ud_8                -1.828519e-03 1 1  ON 18
 ud_9                 9.286925e-02 1 1  ON 19
 eO_0                -7.893786e-01 1 1  ON 20
 eO_1                -4.585174e-01 1 1  ON 21
 eO_2                -3.461613e-02 1 1  ON 22
 eO_3                 2.248453e-01 1 1  ON 23
 eO_4                 3.131088e-01 1 1  ON 24
 eO_5                 3.149888e-01 1 1  ON 25
 eO_6                 2.533634e-01 1 1  ON 26
 eO_7                 1.171204e-01 1 1  ON 27
 eO_8                 2.874185e-02 1 1  ON 28
 eO_9                 1.899972e-02 1 1  ON 29
eH1_0                -1.844410e-01 1 1  ON 30
eH1_1                -1.049406e-01 1 1  ON 31
eH1_2                -6.248032e-02 1 1  ON 32
eH1_3                -2.530520e-02 1 1  ON 33
eH1_4                 1.938819e-02 1 1  ON 34
eH1_5                 3.419626e-02 1 1  ON 35
eH1_6                 7.836785e-02 1 1  ON 36
eH1_7                 1.094944e-01 1 1  ON 37
eH1_8                 9.407307e-02 1 1  ON 38
eH1_9                 2.566037e-02 1 1  ON 39
eH2_0                -1.854763e-01 1 1  ON 40
eH2_1                -1.057916e-01 1 1  ON 41
eH2_2                -6.324112e-02 1 1  ON 42
eH2_3                -2.617261e-02 1 1  ON 43
eH2_4                 1.845011e-02 1 1  ON 44
eH2_5                 3.403067e-02 1 1  ON 45
eH2_6                 7.816769e-02 1 1  ON 46
eH2_7                 1.131457e-01 1 1  ON 47
eH2_8                 9.689510e-02 1 1  ON 48
eH2_9                 2.736472e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.3004
    reference variance = 0.383963
====================================================
  Execution time = 3.7141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4361e-01
  Total weights = 2.0000e+06
  Execution time = 3.1250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343148432632
                                         uncertainty =       0.003907193711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343148432632
                                         uncertainty =       0.003907193711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414145810
  error estimate for blocks of size 2^( 2) =       0.000424890786
  error estimate for blocks of size 2^( 3) =       0.000434855590
  error estimate for blocks of size 2^( 4) =       0.000441992552
  error estimate for blocks of size 2^( 5) =       0.000446490237
  error estimate for blocks of size 2^( 6) =       0.000449091022
  error estimate for blocks of size 2^( 7) =       0.000452317992

      target function =                  N/A
              le_mean =     -17.210970055379
             les_mean =     296.560523580166
             stat err =       0.000447472951
             autocorr =       1.167419736326
              std dev =       0.585690621846
             le_variance =       0.343033504518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344304293136
                                         uncertainty =       0.003931354411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344304293136
                                         uncertainty =       0.003931354411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414842647
  error estimate for blocks of size 2^( 2) =       0.000425550095
  error estimate for blocks of size 2^( 3) =       0.000435458321
  error estimate for blocks of size 2^( 4) =       0.000442552332
  error estimate for blocks of size 2^( 5) =       0.000447022999
  error estimate for blocks of size 2^( 6) =       0.000449625022
  error estimate for blocks of size 2^( 7) =       0.000452879789

      target function =                  N/A
              le_mean =     -17.210965160365
             les_mean =     296.561510423502
             stat err =       0.000448020036
             autocorr =       1.166347809417
              std dev =       0.586676098274
             le_variance =       0.344188844286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344312011613
                                         uncertainty =       0.003925722645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344312011613
                                         uncertainty =       0.003925722645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414847323
  error estimate for blocks of size 2^( 2) =       0.000425563125
  error estimate for blocks of size 2^( 3) =       0.000435484714
  error estimate for blocks of size 2^( 4) =       0.000442588694
  error estimate for blocks of size 2^( 5) =       0.000447062595
  error estimate for blocks of size 2^( 6) =       0.000449656756
  error estimate for blocks of size 2^( 7) =       0.000452901722

      target function =                  N/A
              le_mean =     -17.210966178662
             les_mean =     296.561553233170
             stat err =       0.000448052442
             autocorr =       1.166490252516
              std dev =       0.586682710021
             le_variance =       0.344196602237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343365374509
                                         uncertainty =       0.003909367023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343365374509
                                         uncertainty =       0.003909367023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414276699
  error estimate for blocks of size 2^( 2) =       0.000425017467
  error estimate for blocks of size 2^( 3) =       0.000434975701
  error estimate for blocks of size 2^( 4) =       0.000442107605
  error estimate for blocks of size 2^( 5) =       0.000446600630
  error estimate for blocks of size 2^( 6) =       0.000449199612
  error estimate for blocks of size 2^( 7) =       0.000452429167

      target function =                  N/A
              le_mean =     -17.210968685334
             les_mean =     296.560693281903
             stat err =       0.000447584253
             autocorr =       1.167262638724
              std dev =       0.585875725709
             le_variance =       0.343250365975


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210970055379        initial  <--
     2.4414e-02     2.4414e-01             1.1154e-02       -17.210965160365
     9.7656e-02     9.7656e-01             3.3297e-03       -17.210966178662
     3.9062e-01     3.9062e+00             9.4196e-04       -17.210968685334

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.8315
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.160583e-01 1 1  ON 0
 uu_1                 5.044637e-02 1 1  ON 1
 uu_2                -4.835124e-02 1 1  ON 2
 uu_3                -1.043952e-01 1 1  ON 3
 uu_4                -1.357047e-01 1 1  ON 4
 uu_5                -1.393730e-01 1 1  ON 5
 uu_6                -1.144892e-01 1 1  ON 6
 uu_7                -4.247717e-02 1 1  ON 7
 uu_8                 9.755680e-02 1 1  ON 8
 uu_9                 1.236371e-01 1 1  ON 9
 ud_0                 3.629425e-01 1 1  ON 10
 ud_1                 9.761065e-02 1 1  ON 11
 ud_2                -1.833839e-02 1 1  ON 12
 ud_3                -8.038660e-02 1 1  ON 13
 ud_4                -1.266177e-01 1 1  ON 14
 ud_5                -1.557567e-01 1 1  ON 15
 ud_6                -1.561624e-01 1 1  ON 16
 ud_7                -1.126654e-01 1 1  ON 17
 ud_8                -1.519669e-04 1 1  ON 18
 ud_9                 9.326721e-02 1 1  ON 19
 eO_0                -7.860489e-01 1 1  ON 20
 eO_1                -4.559314e-01 1 1  ON 21
 eO_2                -3.319512e-02 1 1  ON 22
 eO_3                 2.246582e-01 1 1  ON 23
 eO_4                 3.108405e-01 1 1  ON 24
 eO_5                 3.119757e-01 1 1  ON 25
 eO_6                 2.524697e-01 1 1  ON 26
 eO_7                 1.162057e-01 1 1  ON 27
 eO_8                 2.871095e-02 1 1  ON 28
 eO_9                 1.898195e-02 1 1  ON 29
eH1_0                -1.846592e-01 1 1  ON 30
eH1_1                -1.048166e-01 1 1  ON 31
eH1_2                -6.262592e-02 1 1  ON 32
eH1_3                -2.515608e-02 1 1  ON 33
eH1_4                 1.955956e-02 1 1  ON 34
eH1_5                 3.471718e-02 1 1  ON 35
eH1_6                 7.840012e-02 1 1  ON 36
eH1_7                 1.095909e-01 1 1  ON 37
eH1_8                 9.350486e-02 1 1  ON 38
eH1_9                 2.552605e-02 1 1  ON 39
eH2_0                -1.851667e-01 1 1  ON 40
eH2_1                -1.057354e-01 1 1  ON 41
eH2_2                -6.312845e-02 1 1  ON 42
eH2_3                -2.578583e-02 1 1  ON 43
eH2_4                 1.853635e-02 1 1  ON 44
eH2_5                 3.348780e-02 1 1  ON 45
eH2_6                 7.825435e-02 1 1  ON 46
eH2_7                 1.131921e-01 1 1  ON 47
eH2_8                 9.639566e-02 1 1  ON 48
eH2_9                 2.730771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0124e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7233e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2113
    reference variance = 0.144707
====================================================
  Execution time = 3.8664e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4514e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0367e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345201190135
                                         uncertainty =       0.003716999488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345201190135
                                         uncertainty =       0.003716999488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415413976
  error estimate for blocks of size 2^( 2) =       0.000426102576
  error estimate for blocks of size 2^( 3) =       0.000435192118
  error estimate for blocks of size 2^( 4) =       0.000442861659
  error estimate for blocks of size 2^( 5) =       0.000447581290
  error estimate for blocks of size 2^( 6) =       0.000449134440
  error estimate for blocks of size 2^( 7) =       0.000451925230

      target function =                  N/A
              le_mean =     -17.211969287882
             les_mean =     296.597024137809
             stat err =       0.000447875655
             autocorr =       1.162392245959
              std dev =       0.587484079250
             le_variance =       0.345137543372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721196928788e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211969287882       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211969619271       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211968852569       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211968985441       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211968344728       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211970629292       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211971680351       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211971139211       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211971143240       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211970983354       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.622928e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211969287882       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211969428028       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211969189386       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211969177616       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211968756564       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211969484251       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211969626363       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211969570589       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.468863e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211969287882       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211969330243       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211969281696       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211969118651       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211969109563       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211969282498       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211969312038       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211969318662       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.158839e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.415232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9040e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.162329e-01 1 1  ON 0
 uu_1                 5.057253e-02 1 1  ON 1
 uu_2                -4.833423e-02 1 1  ON 2
 uu_3                -1.044100e-01 1 1  ON 3
 uu_4                -1.358130e-01 1 1  ON 4
 uu_5                -1.394660e-01 1 1  ON 5
 uu_6                -1.144731e-01 1 1  ON 6
 uu_7                -4.257916e-02 1 1  ON 7
 uu_8                 9.743898e-02 1 1  ON 8
 uu_9                 1.236733e-01 1 1  ON 9
 ud_0                 3.629207e-01 1 1  ON 10
 ud_1                 9.771353e-02 1 1  ON 11
 ud_2                -1.823455e-02 1 1  ON 12
 ud_3                -8.033066e-02 1 1  ON 13
 ud_4                -1.266389e-01 1 1  ON 14
 ud_5                -1.557464e-01 1 1  ON 15
 ud_6                -1.561393e-01 1 1  ON 16
 ud_7                -1.127585e-01 1 1  ON 17
 ud_8                -3.183932e-04 1 1  ON 18
 ud_9                 9.323663e-02 1 1  ON 19
 eO_0                -7.864957e-01 1 1  ON 20
 eO_1                -4.562110e-01 1 1  ON 21
 eO_2                -3.334291e-02 1 1  ON 22
 eO_3                 2.248209e-01 1 1  ON 23
 eO_4                 3.110896e-01 1 1  ON 24
 eO_5                 3.122556e-01 1 1  ON 25
 eO_6                 2.525500e-01 1 1  ON 26
 eO_7                 1.162902e-01 1 1  ON 27
 eO_8                 2.871951e-02 1 1  ON 28
 eO_9                 1.898702e-02 1 1  ON 29
eH1_0                -1.846479e-01 1 1  ON 30
eH1_1                -1.049117e-01 1 1  ON 31
eH1_2                -6.263939e-02 1 1  ON 32
eH1_3                -2.515130e-02 1 1  ON 33
eH1_4                 1.960008e-02 1 1  ON 34
eH1_5                 3.468324e-02 1 1  ON 35
eH1_6                 7.841281e-02 1 1  ON 36
eH1_7                 1.095796e-01 1 1  ON 37
eH1_8                 9.356271e-02 1 1  ON 38
eH1_9                 2.554372e-02 1 1  ON 39
eH2_0                -1.852057e-01 1 1  ON 40
eH2_1                -1.057611e-01 1 1  ON 41
eH2_2                -6.318178e-02 1 1  ON 42
eH2_3                -2.570814e-02 1 1  ON 43
eH2_4                 1.863970e-02 1 1  ON 44
eH2_5                 3.343855e-02 1 1  ON 45
eH2_6                 7.818580e-02 1 1  ON 46
eH2_7                 1.131665e-01 1 1  ON 47
eH2_8                 9.645252e-02 1 1  ON 48
eH2_9                 2.732653e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2674
    reference variance = 0.313798
====================================================
  Execution time = 3.7828e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.6113e-01
  Total weights = 2.0000e+06
  Execution time = 3.1211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361124492168
                                         uncertainty =       0.015459178386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361124492168
                                         uncertainty =       0.015459178386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424942202
  error estimate for blocks of size 2^( 2) =       0.000435029911
  error estimate for blocks of size 2^( 3) =       0.000444374944
  error estimate for blocks of size 2^( 4) =       0.000451264597
  error estimate for blocks of size 2^( 5) =       0.000456384114
  error estimate for blocks of size 2^( 6) =       0.000458955673
  error estimate for blocks of size 2^( 7) =       0.000461123445

      target function =                  N/A
              le_mean =     -17.211546870343
             les_mean =     296.598497239754
             stat err =       0.000456931957
             autocorr =       1.156227615481
              std dev =       0.600959025486
             le_variance =       0.361151750313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361224452588
                                         uncertainty =       0.015476172082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361224452588
                                         uncertainty =       0.015476172082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425001068
  error estimate for blocks of size 2^( 2) =       0.000435086851
  error estimate for blocks of size 2^( 3) =       0.000444426031
  error estimate for blocks of size 2^( 4) =       0.000451313659
  error estimate for blocks of size 2^( 5) =       0.000456430193
  error estimate for blocks of size 2^( 6) =       0.000458995315
  error estimate for blocks of size 2^( 7) =       0.000461165155

      target function =                  N/A
              le_mean =     -17.211547666025
             les_mean =     296.598624695011
             stat err =       0.000456976080
             autocorr =       1.156130593540
              std dev =       0.601042274552
             le_variance =       0.361251815798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361088502165
                                         uncertainty =       0.015468710030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361088502165
                                         uncertainty =       0.015468710030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424921071
  error estimate for blocks of size 2^( 2) =       0.000435010679
  error estimate for blocks of size 2^( 3) =       0.000444354930
  error estimate for blocks of size 2^( 4) =       0.000451245744
  error estimate for blocks of size 2^( 5) =       0.000456364605
  error estimate for blocks of size 2^( 6) =       0.000458932290
  error estimate for blocks of size 2^( 7) =       0.000461101382

      target function =                  N/A
              le_mean =     -17.211547797004
             les_mean =     296.598493221015
             stat err =       0.000456911005
             autocorr =       1.156236573824
              std dev =       0.600929141426
             le_variance =       0.361115833016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361110213128
                                         uncertainty =       0.015460342119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361110213128
                                         uncertainty =       0.015460342119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424933808
  error estimate for blocks of size 2^( 2) =       0.000435022032
  error estimate for blocks of size 2^( 3) =       0.000444367190
  error estimate for blocks of size 2^( 4) =       0.000451257204
  error estimate for blocks of size 2^( 5) =       0.000456376729
  error estimate for blocks of size 2^( 6) =       0.000458947741
  error estimate for blocks of size 2^( 7) =       0.000461115674

      target function =                  N/A
              le_mean =     -17.211547008647
             les_mean =     296.598487732448
             stat err =       0.000456924337
             autocorr =       1.156234732103
              std dev =       0.600947154208
             le_variance =       0.361137482150


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211546870343        initial
     2.4414e-01     2.4414e+00             1.6229e-03       -17.211547666025
     9.7656e-01     9.7656e+00             4.4689e-04       -17.211547797004  <--
     3.9062e+00     3.9062e+01             1.1588e-04       -17.211547008647

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 5.3726e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.162329e-01 1 1  ON 0
 uu_1                 5.057253e-02 1 1  ON 1
 uu_2                -4.833423e-02 1 1  ON 2
 uu_3                -1.044100e-01 1 1  ON 3
 uu_4                -1.358130e-01 1 1  ON 4
 uu_5                -1.394660e-01 1 1  ON 5
 uu_6                -1.144731e-01 1 1  ON 6
 uu_7                -4.257916e-02 1 1  ON 7
 uu_8                 9.743898e-02 1 1  ON 8
 uu_9                 1.236733e-01 1 1  ON 9
 ud_0                 3.629207e-01 1 1  ON 10
 ud_1                 9.771353e-02 1 1  ON 11
 ud_2                -1.823455e-02 1 1  ON 12
 ud_3                -8.033066e-02 1 1  ON 13
 ud_4                -1.266389e-01 1 1  ON 14
 ud_5                -1.557464e-01 1 1  ON 15
 ud_6                -1.561393e-01 1 1  ON 16
 ud_7                -1.127585e-01 1 1  ON 17
 ud_8                -3.183932e-04 1 1  ON 18
 ud_9                 9.323663e-02 1 1  ON 19
 eO_0                -7.864957e-01 1 1  ON 20
 eO_1                -4.562110e-01 1 1  ON 21
 eO_2                -3.334291e-02 1 1  ON 22
 eO_3                 2.248209e-01 1 1  ON 23
 eO_4                 3.110896e-01 1 1  ON 24
 eO_5                 3.122556e-01 1 1  ON 25
 eO_6                 2.525500e-01 1 1  ON 26
 eO_7                 1.162902e-01 1 1  ON 27
 eO_8                 2.871951e-02 1 1  ON 28
 eO_9                 1.898702e-02 1 1  ON 29
eH1_0                -1.846479e-01 1 1  ON 30
eH1_1                -1.049117e-01 1 1  ON 31
eH1_2                -6.263939e-02 1 1  ON 32
eH1_3                -2.515130e-02 1 1  ON 33
eH1_4                 1.960008e-02 1 1  ON 34
eH1_5                 3.468324e-02 1 1  ON 35
eH1_6                 7.841281e-02 1 1  ON 36
eH1_7                 1.095796e-01 1 1  ON 37
eH1_8                 9.356271e-02 1 1  ON 38
eH1_9                 2.554372e-02 1 1  ON 39
eH2_0                -1.852057e-01 1 1  ON 40
eH2_1                -1.057611e-01 1 1  ON 41
eH2_2                -6.318178e-02 1 1  ON 42
eH2_3                -2.570814e-02 1 1  ON 43
eH2_4                 1.863970e-02 1 1  ON 44
eH2_5                 3.343855e-02 1 1  ON 45
eH2_6                 7.818580e-02 1 1  ON 46
eH2_7                 1.131665e-01 1 1  ON 47
eH2_8                 9.645252e-02 1 1  ON 48
eH2_9                 2.732653e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0277e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7234e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1995
    reference variance = 0.190525
====================================================
  Execution time = 3.9385e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3380e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0687e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333852487448
                                         uncertainty =       0.002014067514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333852487448
                                         uncertainty =       0.002014067514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408531907
  error estimate for blocks of size 2^( 2) =       0.000419330962
  error estimate for blocks of size 2^( 3) =       0.000429212617
  error estimate for blocks of size 2^( 4) =       0.000435579571
  error estimate for blocks of size 2^( 5) =       0.000439767674
  error estimate for blocks of size 2^( 6) =       0.000441858939
  error estimate for blocks of size 2^( 7) =       0.000442355731

      target function =                  N/A
              le_mean =     -17.212015898739
             les_mean =     296.587287770045
             stat err =       0.000439890479
             autocorr =       1.159410318065
              std dev =       0.577751363907
             le_variance =       0.333796638496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721201589874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212015898739       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212015455076       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212014169757       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212017375190       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212016889930       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212017863116       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212018321472       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212018643450       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212018424103       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.483996e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212015898739       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212015733361       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212015052719       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212015956500       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212016204713       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212016179814       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212016441566       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212016391806       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.021540e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212015898739       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212015851609       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212015630763       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212015843012       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212015956081       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212015944459       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212015994416       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.031358e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.418838 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0081e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.162666e-01 1 1  ON 0
 uu_1                 5.070770e-02 1 1  ON 1
 uu_2                -4.831604e-02 1 1  ON 2
 uu_3                -1.043668e-01 1 1  ON 3
 uu_4                -1.357714e-01 1 1  ON 4
 uu_5                -1.395814e-01 1 1  ON 5
 uu_6                -1.145096e-01 1 1  ON 6
 uu_7                -4.269071e-02 1 1  ON 7
 uu_8                 9.734776e-02 1 1  ON 8
 uu_9                 1.237115e-01 1 1  ON 9
 ud_0                 3.631197e-01 1 1  ON 10
 ud_1                 9.771959e-02 1 1  ON 11
 ud_2                -1.811897e-02 1 1  ON 12
 ud_3                -8.029372e-02 1 1  ON 13
 ud_4                -1.266302e-01 1 1  ON 14
 ud_5                -1.558027e-01 1 1  ON 15
 ud_6                -1.562164e-01 1 1  ON 16
 ud_7                -1.128277e-01 1 1  ON 17
 ud_8                -4.808790e-04 1 1  ON 18
 ud_9                 9.320462e-02 1 1  ON 19
 eO_0                -7.868979e-01 1 1  ON 20
 eO_1                -4.564884e-01 1 1  ON 21
 eO_2                -3.355435e-02 1 1  ON 22
 eO_3                 2.248303e-01 1 1  ON 23
 eO_4                 3.114760e-01 1 1  ON 24
 eO_5                 3.125499e-01 1 1  ON 25
 eO_6                 2.526228e-01 1 1  ON 26
 eO_7                 1.164025e-01 1 1  ON 27
 eO_8                 2.873295e-02 1 1  ON 28
 eO_9                 1.898817e-02 1 1  ON 29
eH1_0                -1.846238e-01 1 1  ON 30
eH1_1                -1.049000e-01 1 1  ON 31
eH1_2                -6.271221e-02 1 1  ON 32
eH1_3                -2.515121e-02 1 1  ON 33
eH1_4                 1.964189e-02 1 1  ON 34
eH1_5                 3.458894e-02 1 1  ON 35
eH1_6                 7.844748e-02 1 1  ON 36
eH1_7                 1.095579e-01 1 1  ON 37
eH1_8                 9.362083e-02 1 1  ON 38
eH1_9                 2.556138e-02 1 1  ON 39
eH2_0                -1.852726e-01 1 1  ON 40
eH2_1                -1.057212e-01 1 1  ON 41
eH2_2                -6.324644e-02 1 1  ON 42
eH2_3                -2.573331e-02 1 1  ON 43
eH2_4                 1.860764e-02 1 1  ON 44
eH2_5                 3.342751e-02 1 1  ON 45
eH2_6                 7.827168e-02 1 1  ON 46
eH2_7                 1.131422e-01 1 1  ON 47
eH2_8                 9.651843e-02 1 1  ON 48
eH2_9                 2.735262e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2246
    reference variance = 0.398497
====================================================
  Execution time = 3.6893e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3147e-01
  Total weights = 2.0000e+06
  Execution time = 3.1164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331327394271
                                         uncertainty =       0.002335841574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331327394271
                                         uncertainty =       0.002335841574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407015869
  error estimate for blocks of size 2^( 2) =       0.000417647541
  error estimate for blocks of size 2^( 3) =       0.000426861516
  error estimate for blocks of size 2^( 4) =       0.000434146397
  error estimate for blocks of size 2^( 5) =       0.000439091162
  error estimate for blocks of size 2^( 6) =       0.000441067266
  error estimate for blocks of size 2^( 7) =       0.000441158263

      target function =                  N/A
              le_mean =     -17.211739914647
             les_mean =     296.575314559798
             stat err =       0.000438865772
             autocorr =       1.162627888267
              std dev =       0.575607362699
             le_variance =       0.331323835993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331635137099
                                         uncertainty =       0.002337557709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331635137099
                                         uncertainty =       0.002337557709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407204717
  error estimate for blocks of size 2^( 2) =       0.000417826900
  error estimate for blocks of size 2^( 3) =       0.000427028101
  error estimate for blocks of size 2^( 4) =       0.000434303135
  error estimate for blocks of size 2^( 5) =       0.000439239768
  error estimate for blocks of size 2^( 6) =       0.000441218172
  error estimate for blocks of size 2^( 7) =       0.000441304841

      target function =                  N/A
              le_mean =     -17.211743422760
             les_mean =     296.575742848178
             stat err =       0.000439016479
             autocorr =       1.162347655747
              std dev =       0.575874433422
             le_variance =       0.331631363069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331613194366
                                         uncertainty =       0.002337456488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331613194366
                                         uncertainty =       0.002337456488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407191295
  error estimate for blocks of size 2^( 2) =       0.000417814751
  error estimate for blocks of size 2^( 3) =       0.000427019176
  error estimate for blocks of size 2^( 4) =       0.000434297287
  error estimate for blocks of size 2^( 5) =       0.000439236508
  error estimate for blocks of size 2^( 6) =       0.000441213578
  error estimate for blocks of size 2^( 7) =       0.000441302443

      target function =                  N/A
              le_mean =     -17.211742886336
             les_mean =     296.575702520938
             stat err =       0.000439012454
             autocorr =       1.162402972400
              std dev =       0.575855451822
             le_variance =       0.331609501393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331376346254
                                         uncertainty =       0.002336132908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331376346254
                                         uncertainty =       0.002336132908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407045925
  error estimate for blocks of size 2^( 2) =       0.000417676220
  error estimate for blocks of size 2^( 3) =       0.000426888714
  error estimate for blocks of size 2^( 4) =       0.000434172582
  error estimate for blocks of size 2^( 5) =       0.000439116485
  error estimate for blocks of size 2^( 6) =       0.000441092632
  error estimate for blocks of size 2^( 7) =       0.000441183309

      target function =                  N/A
              le_mean =     -17.211740341049
             les_mean =     296.575378172677
             stat err =       0.000438891252
             autocorr =       1.162591184056
              std dev =       0.575649868122
             le_variance =       0.331372770669


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211739914647        initial
     2.4414e-01     2.4414e+00             1.4840e-03       -17.211743422760  <--
     9.7656e-01     9.7656e+00             4.0215e-04       -17.211742886336
     3.9062e+00     3.9062e+01             1.0314e-04       -17.211740341049

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 5.2691e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.164563e-01 1 1  ON 0
 uu_1                 5.096648e-02 1 1  ON 1
 uu_2                -4.819283e-02 1 1  ON 2
 uu_3                -1.042847e-01 1 1  ON 3
 uu_4                -1.357330e-01 1 1  ON 4
 uu_5                -1.398091e-01 1 1  ON 5
 uu_6                -1.146232e-01 1 1  ON 6
 uu_7                -4.301565e-02 1 1  ON 7
 uu_8                 9.708284e-02 1 1  ON 8
 uu_9                 1.238217e-01 1 1  ON 9
 ud_0                 3.634684e-01 1 1  ON 10
 ud_1                 9.793222e-02 1 1  ON 11
 ud_2                -1.785598e-02 1 1  ON 12
 ud_3                -8.014360e-02 1 1  ON 13
 ud_4                -1.265855e-01 1 1  ON 14
 ud_5                -1.559287e-01 1 1  ON 15
 ud_6                -1.564288e-01 1 1  ON 16
 ud_7                -1.130325e-01 1 1  ON 17
 ud_8                -9.526189e-04 1 1  ON 18
 ud_9                 9.311101e-02 1 1  ON 19
 eO_0                -7.879797e-01 1 1  ON 20
 eO_1                -4.573676e-01 1 1  ON 21
 eO_2                -3.413386e-02 1 1  ON 22
 eO_3                 2.248528e-01 1 1  ON 23
 eO_4                 3.125565e-01 1 1  ON 24
 eO_5                 3.134061e-01 1 1  ON 25
 eO_6                 2.528346e-01 1 1  ON 26
 eO_7                 1.167267e-01 1 1  ON 27
 eO_8                 2.877157e-02 1 1  ON 28
 eO_9                 1.899145e-02 1 1  ON 29
eH1_0                -1.845658e-01 1 1  ON 30
eH1_1                -1.049101e-01 1 1  ON 31
eH1_2                -6.284150e-02 1 1  ON 32
eH1_3                -2.517383e-02 1 1  ON 33
eH1_4                 1.973498e-02 1 1  ON 34
eH1_5                 3.434663e-02 1 1  ON 35
eH1_6                 7.854347e-02 1 1  ON 36
eH1_7                 1.094946e-01 1 1  ON 37
eH1_8                 9.378870e-02 1 1  ON 38
eH1_9                 2.561237e-02 1 1  ON 39
eH2_0                -1.854217e-01 1 1  ON 40
eH2_1                -1.057206e-01 1 1  ON 41
eH2_2                -6.337939e-02 1 1  ON 42
eH2_3                -2.579654e-02 1 1  ON 43
eH2_4                 1.854217e-02 1 1  ON 44
eH2_5                 3.338057e-02 1 1  ON 45
eH2_6                 7.851260e-02 1 1  ON 46
eH2_7                 1.130737e-01 1 1  ON 47
eH2_8                 9.670922e-02 1 1  ON 48
eH2_9                 2.742803e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0278e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7232e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.0939
    reference variance = 0.326213
====================================================
  Execution time = 3.7447e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4435e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0595e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344460416029
                                         uncertainty =       0.005091419641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344460416029
                                         uncertainty =       0.005091419641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414941622
  error estimate for blocks of size 2^( 2) =       0.000425639441
  error estimate for blocks of size 2^( 3) =       0.000435120219
  error estimate for blocks of size 2^( 4) =       0.000442089642
  error estimate for blocks of size 2^( 5) =       0.000446224490
  error estimate for blocks of size 2^( 6) =       0.000448752935
  error estimate for blocks of size 2^( 7) =       0.000449663957

      target function =                  N/A
              le_mean =     -17.211877006154
             les_mean =     296.593063002780
             stat err =       0.000446682756
             autocorr =       1.158842389831
              std dev =       0.586816069979
             le_variance =       0.344353099986


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721187700615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211877006154       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211877917399       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211880202438       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211879685877       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211879385409       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211881648978       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211882104710       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211882246839       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211884706648       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211884128794       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211883876602       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211884200999       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211883843350       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211883914610       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.750906e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211877006154       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211877516962       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211879137921       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211878221633       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211877957427       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211878827553       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211879060112       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211879055805       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211879393824       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211879188532       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.396049e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211877006154       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211877191380       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211877903019       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211877260354       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211877384514       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211877600727       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211877604901       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211877656823       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 3.543165e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.424652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8053e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.171190e-01 1 1  ON 0
 uu_1                 5.115871e-02 1 1  ON 1
 uu_2                -4.799507e-02 1 1  ON 2
 uu_3                -1.043194e-01 1 1  ON 3
 uu_4                -1.358355e-01 1 1  ON 4
 uu_5                -1.399485e-01 1 1  ON 5
 uu_6                -1.149776e-01 1 1  ON 6
 uu_7                -4.351153e-02 1 1  ON 7
 uu_8                 9.674130e-02 1 1  ON 8
 uu_9                 1.240060e-01 1 1  ON 9
 ud_0                 3.636546e-01 1 1  ON 10
 ud_1                 9.823289e-02 1 1  ON 11
 ud_2                -1.755492e-02 1 1  ON 12
 ud_3                -8.000520e-02 1 1  ON 13
 ud_4                -1.264878e-01 1 1  ON 14
 ud_5                -1.559979e-01 1 1  ON 15
 ud_6                -1.564612e-01 1 1  ON 16
 ud_7                -1.133034e-01 1 1  ON 17
 ud_8                -1.649911e-03 1 1  ON 18
 ud_9                 9.299681e-02 1 1  ON 19
 eO_0                -7.893758e-01 1 1  ON 20
 eO_1                -4.584401e-01 1 1  ON 21
 eO_2                -3.484788e-02 1 1  ON 22
 eO_3                 2.250954e-01 1 1  ON 23
 eO_4                 3.135873e-01 1 1  ON 24
 eO_5                 3.145074e-01 1 1  ON 25
 eO_6                 2.531264e-01 1 1  ON 26
 eO_7                 1.171577e-01 1 1  ON 27
 eO_8                 2.883078e-02 1 1  ON 28
 eO_9                 1.900502e-02 1 1  ON 29
eH1_0                -1.847637e-01 1 1  ON 30
eH1_1                -1.051514e-01 1 1  ON 31
eH1_2                -6.275381e-02 1 1  ON 32
eH1_3                -2.497395e-02 1 1  ON 33
eH1_4                 1.981868e-02 1 1  ON 34
eH1_5                 3.392685e-02 1 1  ON 35
eH1_6                 7.862436e-02 1 1  ON 36
eH1_7                 1.095837e-01 1 1  ON 37
eH1_8                 9.404368e-02 1 1  ON 38
eH1_9                 2.566752e-02 1 1  ON 39
eH2_0                -1.853205e-01 1 1  ON 40
eH2_1                -1.059540e-01 1 1  ON 41
eH2_2                -6.323440e-02 1 1  ON 42
eH2_3                -2.584351e-02 1 1  ON 43
eH2_4                 1.892782e-02 1 1  ON 44
eH2_5                 3.313575e-02 1 1  ON 45
eH2_6                 7.817676e-02 1 1  ON 46
eH2_7                 1.129972e-01 1 1  ON 47
eH2_8                 9.694264e-02 1 1  ON 48
eH2_9                 2.749300e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.3113
    reference variance = 0.393935
====================================================
  Execution time = 3.8924e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3695e-01
  Total weights = 2.0000e+06
  Execution time = 3.0824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336866318592
                                         uncertainty =       0.003076187876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336866318592
                                         uncertainty =       0.003076187876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410449308
  error estimate for blocks of size 2^( 2) =       0.000420970503
  error estimate for blocks of size 2^( 3) =       0.000430431321
  error estimate for blocks of size 2^( 4) =       0.000437332185
  error estimate for blocks of size 2^( 5) =       0.000441262835
  error estimate for blocks of size 2^( 6) =       0.000442723364
  error estimate for blocks of size 2^( 7) =       0.000443985280

      target function =                  N/A
              le_mean =     -17.212230933706
             les_mean =     296.597830815116
             stat err =       0.000441325916
             autocorr =       1.156111728934
              std dev =       0.580462977607
             le_variance =       0.336937268373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337119363190
                                         uncertainty =       0.003078295515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337119363190
                                         uncertainty =       0.003078295515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410603329
  error estimate for blocks of size 2^( 2) =       0.000421112750
  error estimate for blocks of size 2^( 3) =       0.000430556192
  error estimate for blocks of size 2^( 4) =       0.000437448379
  error estimate for blocks of size 2^( 5) =       0.000441375422
  error estimate for blocks of size 2^( 6) =       0.000442838429
  error estimate for blocks of size 2^( 7) =       0.000444112244

      target function =                  N/A
              le_mean =     -17.212232548534
             les_mean =     296.598139324275
             stat err =       0.000441443618
             autocorr =       1.155860847150
              std dev =       0.580680797035
             le_variance =       0.337190188045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336889273289
                                         uncertainty =       0.003077476774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336889273289
                                         uncertainty =       0.003077476774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410463280
  error estimate for blocks of size 2^( 2) =       0.000420982544
  error estimate for blocks of size 2^( 3) =       0.000430438295
  error estimate for blocks of size 2^( 4) =       0.000437341282
  error estimate for blocks of size 2^( 5) =       0.000441272676
  error estimate for blocks of size 2^( 6) =       0.000442741832
  error estimate for blocks of size 2^( 7) =       0.000444013461

      target function =                  N/A
              le_mean =     -17.212231721827
             les_mean =     296.597880886424
             stat err =       0.000441342313
             autocorr =       1.156118923277
              std dev =       0.580482737923
             le_variance =       0.336960209026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336835591378
                                         uncertainty =       0.003076233605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336835591378
                                         uncertainty =       0.003076233605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410430601
  error estimate for blocks of size 2^( 2) =       0.000420952715
  error estimate for blocks of size 2^( 3) =       0.000430413906
  error estimate for blocks of size 2^( 4) =       0.000437316071
  error estimate for blocks of size 2^( 5) =       0.000441247004
  error estimate for blocks of size 2^( 6) =       0.000442709614
  error estimate for blocks of size 2^( 7) =       0.000443972898

      target function =                  N/A
              le_mean =     -17.212230728592
             les_mean =     296.597793042745
             stat err =       0.000441311397
             autocorr =       1.156141042353
              std dev =       0.580436522718
             le_variance =       0.336906556904


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212230933706        initial
     6.1035e-02     6.1035e-01             4.7509e-03       -17.212232548534  <--
     2.4414e-01     2.4414e+00             1.3960e-03       -17.212231721827
     9.7656e-01     9.7656e+00             3.5432e-04       -17.212230728592

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 5.4422e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.180109e-01 1 1  ON 0
 uu_1                 5.175123e-02 1 1  ON 1
 uu_2                -4.754008e-02 1 1  ON 2
 uu_3                -1.041436e-01 1 1  ON 3
 uu_4                -1.359727e-01 1 1  ON 4
 uu_5                -1.403871e-01 1 1  ON 5
 uu_6                -1.156061e-01 1 1  ON 6
 uu_7                -4.471073e-02 1 1  ON 7
 uu_8                 9.574700e-02 1 1  ON 8
 uu_9                 1.245734e-01 1 1  ON 9
 ud_0                 3.644013e-01 1 1  ON 10
 ud_1                 9.895396e-02 1 1  ON 11
 ud_2                -1.692878e-02 1 1  ON 12
 ud_3                -7.957924e-02 1 1  ON 13
 ud_4                -1.263230e-01 1 1  ON 14
 ud_5                -1.561732e-01 1 1  ON 15
 ud_6                -1.566223e-01 1 1  ON 16
 ud_7                -1.138128e-01 1 1  ON 17
 ud_8                -3.638629e-03 1 1  ON 18
 ud_9                 9.265276e-02 1 1  ON 19
 eO_0                -7.927306e-01 1 1  ON 20
 eO_1                -4.612429e-01 1 1  ON 21
 eO_2                -3.683923e-02 1 1  ON 22
 eO_3                 2.248804e-01 1 1  ON 23
 eO_4                 3.157804e-01 1 1  ON 24
 eO_5                 3.179242e-01 1 1  ON 25
 eO_6                 2.542282e-01 1 1  ON 26
 eO_7                 1.185423e-01 1 1  ON 27
 eO_8                 2.901942e-02 1 1  ON 28
 eO_9                 1.904645e-02 1 1  ON 29
eH1_0                -1.850778e-01 1 1  ON 30
eH1_1                -1.054825e-01 1 1  ON 31
eH1_2                -6.281896e-02 1 1  ON 32
eH1_3                -2.491089e-02 1 1  ON 33
eH1_4                 1.989568e-02 1 1  ON 34
eH1_5                 3.306473e-02 1 1  ON 35
eH1_6                 7.873268e-02 1 1  ON 36
eH1_7                 1.098936e-01 1 1  ON 37
eH1_8                 9.485981e-02 1 1  ON 38
eH1_9                 2.584223e-02 1 1  ON 39
eH2_0                -1.852763e-01 1 1  ON 40
eH2_1                -1.061764e-01 1 1  ON 41
eH2_2                -6.311347e-02 1 1  ON 42
eH2_3                -2.580103e-02 1 1  ON 43
eH2_4                 1.936358e-02 1 1  ON 44
eH2_5                 3.274722e-02 1 1  ON 45
eH2_6                 7.733534e-02 1 1  ON 46
eH2_7                 1.128374e-01 1 1  ON 47
eH2_8                 9.768519e-02 1 1  ON 48
eH2_9                 2.769637e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0248e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1374
    reference variance = 0.246197
====================================================
  Execution time = 3.7797e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4492e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0515e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344994454722
                                         uncertainty =       0.004162429885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344994454722
                                         uncertainty =       0.004162429885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415280824
  error estimate for blocks of size 2^( 2) =       0.000425614158
  error estimate for blocks of size 2^( 3) =       0.000434908401
  error estimate for blocks of size 2^( 4) =       0.000442128416
  error estimate for blocks of size 2^( 5) =       0.000445020171
  error estimate for blocks of size 2^( 6) =       0.000448971249
  error estimate for blocks of size 2^( 7) =       0.000449740932

      target function =                  N/A
              le_mean =     -17.211634839873
             les_mean =     296.585290013956
             stat err =       0.000446465192
             autocorr =       1.155823328507
              std dev =       0.587295773253
             le_variance =       0.344916325281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721163483987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211634839873       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211636846204       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211638399618       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211636867300       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211638227764       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211645538415       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211653620428       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211654373164       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211654442584       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211654427202       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211656933185       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211657430630       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211659551493       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211660214382       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211659792622       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211661114896       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211661507963       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.211661059306       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.211661125058       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.181197e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211634839873       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211636546286       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211637832110       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211636671395       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211637289723       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211642392460       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211646114455       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211645225807       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211644978130       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211644059901       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211644641496       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211644735166       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211644950128       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 3.999901e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211634839873       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211635907755       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211636671646       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211636115152       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211636224580       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211638434046       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211639057538       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211638563626       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211638482261       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211638316670       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.246301e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.435273 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8327e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.180814e-01 1 1  ON 0
 uu_1                 5.211914e-02 1 1  ON 1
 uu_2                -4.739123e-02 1 1  ON 2
 uu_3                -1.040373e-01 1 1  ON 3
 uu_4                -1.360862e-01 1 1  ON 4
 uu_5                -1.407645e-01 1 1  ON 5
 uu_6                -1.159643e-01 1 1  ON 6
 uu_7                -4.591442e-02 1 1  ON 7
 uu_8                 9.486184e-02 1 1  ON 8
 uu_9                 1.255826e-01 1 1  ON 9
 ud_0                 3.660538e-01 1 1  ON 10
 ud_1                 1.000921e-01 1 1  ON 11
 ud_2                -1.617520e-02 1 1  ON 12
 ud_3                -7.921729e-02 1 1  ON 13
 ud_4                -1.263613e-01 1 1  ON 14
 ud_5                -1.570285e-01 1 1  ON 15
 ud_6                -1.579699e-01 1 1  ON 16
 ud_7                -1.143430e-01 1 1  ON 17
 ud_8                -5.829552e-03 1 1  ON 18
 ud_9                 9.253698e-02 1 1  ON 19
 eO_0                -7.967305e-01 1 1  ON 20
 eO_1                -4.651185e-01 1 1  ON 21
 eO_2                -3.840644e-02 1 1  ON 22
 eO_3                 2.247880e-01 1 1  ON 23
 eO_4                 3.182794e-01 1 1  ON 24
 eO_5                 3.212593e-01 1 1  ON 25
 eO_6                 2.556203e-01 1 1  ON 26
 eO_7                 1.202199e-01 1 1  ON 27
 eO_8                 2.930742e-02 1 1  ON 28
 eO_9                 1.920766e-02 1 1  ON 29
eH1_0                -1.850425e-01 1 1  ON 30
eH1_1                -1.053115e-01 1 1  ON 31
eH1_2                -6.293061e-02 1 1  ON 32
eH1_3                -2.504243e-02 1 1  ON 33
eH1_4                 1.944202e-02 1 1  ON 34
eH1_5                 3.273781e-02 1 1  ON 35
eH1_6                 7.862040e-02 1 1  ON 36
eH1_7                 1.094621e-01 1 1  ON 37
eH1_8                 9.573841e-02 1 1  ON 38
eH1_9                 2.620261e-02 1 1  ON 39
eH2_0                -1.861099e-01 1 1  ON 40
eH2_1                -1.063901e-01 1 1  ON 41
eH2_2                -6.357489e-02 1 1  ON 42
eH2_3                -2.567061e-02 1 1  ON 43
eH2_4                 1.897966e-02 1 1  ON 44
eH2_5                 3.237936e-02 1 1  ON 45
eH2_6                 7.799536e-02 1 1  ON 46
eH2_7                 1.127039e-01 1 1  ON 47
eH2_8                 9.877430e-02 1 1  ON 48
eH2_9                 2.798232e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1726
    reference variance = 0.348106
====================================================
  Execution time = 3.6817e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4288e-01
  Total weights = 2.0000e+06
  Execution time = 3.1012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342177845630
                                         uncertainty =       0.003403101301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342177845630
                                         uncertainty =       0.003403101301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413597068
  error estimate for blocks of size 2^( 2) =       0.000423852643
  error estimate for blocks of size 2^( 3) =       0.000433599761
  error estimate for blocks of size 2^( 4) =       0.000440332847
  error estimate for blocks of size 2^( 5) =       0.000444978847
  error estimate for blocks of size 2^( 6) =       0.000445861901
  error estimate for blocks of size 2^( 7) =       0.000448512791

      target function =                  N/A
              le_mean =     -17.211935712431
             les_mean =     296.592855866657
             stat err =       0.000444921596
             autocorr =       1.157209716728
              std dev =       0.584914582548
             le_variance =       0.342125068877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343518844795
                                         uncertainty =       0.003414174962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343518844795
                                         uncertainty =       0.003414174962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414406923
  error estimate for blocks of size 2^( 2) =       0.000424622003
  error estimate for blocks of size 2^( 3) =       0.000434307199
  error estimate for blocks of size 2^( 4) =       0.000440983505
  error estimate for blocks of size 2^( 5) =       0.000445579707
  error estimate for blocks of size 2^( 6) =       0.000446453333
  error estimate for blocks of size 2^( 7) =       0.000449093265

      target function =                  N/A
              le_mean =     -17.211936884925
             les_mean =     296.594237355181
             stat err =       0.000445527453
             autocorr =       1.155832587380
              std dev =       0.586059891380
             le_variance =       0.343466196285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343706731591
                                         uncertainty =       0.003413402630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343706731591
                                         uncertainty =       0.003413402630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414520262
  error estimate for blocks of size 2^( 2) =       0.000424735029
  error estimate for blocks of size 2^( 3) =       0.000434422615
  error estimate for blocks of size 2^( 4) =       0.000441095634
  error estimate for blocks of size 2^( 5) =       0.000445686413
  error estimate for blocks of size 2^( 6) =       0.000446557111
  error estimate for blocks of size 2^( 7) =       0.000449203102

      target function =                  N/A
              le_mean =     -17.211934378598
             les_mean =     296.594338976445
             stat err =       0.000445635565
             autocorr =       1.155761327895
              std dev =       0.586220176311
             le_variance =       0.343654095114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342550297958
                                         uncertainty =       0.003405228760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342550297958
                                         uncertainty =       0.003405228760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413822179
  error estimate for blocks of size 2^( 2) =       0.000424066931
  error estimate for blocks of size 2^( 3) =       0.000433799579
  error estimate for blocks of size 2^( 4) =       0.000440518041
  error estimate for blocks of size 2^( 5) =       0.000445150120
  error estimate for blocks of size 2^( 6) =       0.000446029389
  error estimate for blocks of size 2^( 7) =       0.000448680638

      target function =                  N/A
              le_mean =     -17.211933312172
             les_mean =     296.593145762299
             stat err =       0.000445094547
             autocorr =       1.156849921607
              std dev =       0.585232937291
             le_variance =       0.342497590890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211935712431        initial
     1.5259e-02     1.5259e-01             1.1812e-02       -17.211936884925  <--
     6.1035e-02     6.1035e-01             3.9999e-03       -17.211934378598
     2.4414e-01     2.4414e+00             1.2463e-03       -17.211933312172

*****************************************************************************
Applying the update for shift_i =   1.5259e-02     and shift_s =   1.5259e-01
*****************************************************************************

  Execution time = 5.2405e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.186947e-01 1 1  ON 0
 uu_1                 5.266477e-02 1 1  ON 1
 uu_2                -4.709160e-02 1 1  ON 2
 uu_3                -1.040507e-01 1 1  ON 3
 uu_4                -1.365488e-01 1 1  ON 4
 uu_5                -1.418747e-01 1 1  ON 5
 uu_6                -1.176310e-01 1 1  ON 6
 uu_7                -4.846998e-02 1 1  ON 7
 uu_8                 9.238406e-02 1 1  ON 8
 uu_9                 1.286145e-01 1 1  ON 9
 ud_0                 3.679912e-01 1 1  ON 10
 ud_1                 1.018187e-01 1 1  ON 11
 ud_2                -1.472736e-02 1 1  ON 12
 ud_3                -7.821778e-02 1 1  ON 13
 ud_4                -1.259379e-01 1 1  ON 14
 ud_5                -1.575809e-01 1 1  ON 15
 ud_6                -1.598925e-01 1 1  ON 16
 ud_7                -1.155976e-01 1 1  ON 17
 ud_8                -1.184561e-02 1 1  ON 18
 ud_9                 9.217486e-02 1 1  ON 19
 eO_0                -8.045426e-01 1 1  ON 20
 eO_1                -4.722167e-01 1 1  ON 21
 eO_2                -4.368036e-02 1 1  ON 22
 eO_3                 2.225516e-01 1 1  ON 23
 eO_4                 3.198767e-01 1 1  ON 24
 eO_5                 3.295433e-01 1 1  ON 25
 eO_6                 2.607898e-01 1 1  ON 26
 eO_7                 1.256374e-01 1 1  ON 27
 eO_8                 3.021399e-02 1 1  ON 28
 eO_9                 1.969679e-02 1 1  ON 29
eH1_0                -1.853244e-01 1 1  ON 30
eH1_1                -1.057373e-01 1 1  ON 31
eH1_2                -6.330207e-02 1 1  ON 32
eH1_3                -2.524681e-02 1 1  ON 33
eH1_4                 1.907480e-02 1 1  ON 34
eH1_5                 3.204875e-02 1 1  ON 35
eH1_6                 7.772615e-02 1 1  ON 36
eH1_7                 1.083847e-01 1 1  ON 37
eH1_8                 9.855964e-02 1 1  ON 38
eH1_9                 2.732198e-02 1 1  ON 39
eH2_0                -1.872365e-01 1 1  ON 40
eH2_1                -1.073865e-01 1 1  ON 41
eH2_2                -6.447759e-02 1 1  ON 42
eH2_3                -2.627264e-02 1 1  ON 43
eH2_4                 1.831992e-02 1 1  ON 44
eH2_5                 3.157646e-02 1 1  ON 45
eH2_6                 7.828377e-02 1 1  ON 46
eH2_7                 1.124369e-01 1 1  ON 47
eH2_8                 1.022486e-01 1 1  ON 48
eH2_9                 2.887500e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0074e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1615
    reference variance = 0.20114
====================================================
  Execution time = 3.9060e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4713e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0711e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347155413369
                                         uncertainty =       0.005268098503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347155413369
                                         uncertainty =       0.005268098503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416610818
  error estimate for blocks of size 2^( 2) =       0.000426866004
  error estimate for blocks of size 2^( 3) =       0.000436641314
  error estimate for blocks of size 2^( 4) =       0.000443583017
  error estimate for blocks of size 2^( 5) =       0.000446807847
  error estimate for blocks of size 2^( 6) =       0.000447563147
  error estimate for blocks of size 2^( 7) =       0.000447932784

      target function =                  N/A
              le_mean =     -17.211833346153
             les_mean =     296.594336109222
             stat err =       0.000446471699
             autocorr =       1.148488852383
              std dev =       0.589176668781
             le_variance =       0.347129147036


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721183334615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211833346153       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211834399318       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211832591751       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211836133464       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211840318005       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211845847937       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211846198458       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211850602864       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211852467825       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211863435941       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211862644476       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211864989195       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211865950509       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211870981878       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211870690470       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211872938491       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211872342469       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.211871646672       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.211875902767       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.211874960550       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.211875313207       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.211874340476       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.211874701242       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.211874729237       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.211874695437       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-03 is 4.228063e-02

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211833346153       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211834339134       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211832702476       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211836082634       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211839816481       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211844501660       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211844253311       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211847272632       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211848521017       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211854482686       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211852732591       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211852163424       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211852380891       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211853845929       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211853017918       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211853330805       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211853150065       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.211852587795       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.211853248611       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.211853156786       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.016785e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211833346153       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211834154388       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211833124861       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211836183403       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211838326665       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211840977745       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211840004484       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211841170073       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211842107860       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211842922034       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211842335858       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211841607628       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211841837380       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 3.292039e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.455316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9797e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.201802e-01 1 1  ON 0
 uu_1                 5.392790e-02 1 1  ON 1
 uu_2                -4.613812e-02 1 1  ON 2
 uu_3                -1.035920e-01 1 1  ON 3
 uu_4                -1.372677e-01 1 1  ON 4
 uu_5                -1.434729e-01 1 1  ON 5
 uu_6                -1.206148e-01 1 1  ON 6
 uu_7                -5.118273e-02 1 1  ON 7
 uu_8                 8.823824e-02 1 1  ON 8
 uu_9                 1.317065e-01 1 1  ON 9
 ud_0                 3.685903e-01 1 1  ON 10
 ud_1                 1.028054e-01 1 1  ON 11
 ud_2                -1.411984e-02 1 1  ON 12
 ud_3                -7.793813e-02 1 1  ON 13
 ud_4                -1.263807e-01 1 1  ON 14
 ud_5                -1.577506e-01 1 1  ON 15
 ud_6                -1.597460e-01 1 1  ON 16
 ud_7                -1.150796e-01 1 1  ON 17
 ud_8                -1.618208e-02 1 1  ON 18
 ud_9                 9.083430e-02 1 1  ON 19
 eO_0                -8.147105e-01 1 1  ON 20
 eO_1                -4.809331e-01 1 1  ON 21
 eO_2                -5.127847e-02 1 1  ON 22
 eO_3                 2.183600e-01 1 1  ON 23
 eO_4                 3.202555e-01 1 1  ON 24
 eO_5                 3.377765e-01 1 1  ON 25
 eO_6                 2.708533e-01 1 1  ON 26
 eO_7                 1.355426e-01 1 1  ON 27
 eO_8                 3.166862e-02 1 1  ON 28
 eO_9                 2.007811e-02 1 1  ON 29
eH1_0                -1.886565e-01 1 1  ON 30
eH1_1                -1.082695e-01 1 1  ON 31
eH1_2                -6.483892e-02 1 1  ON 32
eH1_3                -2.684341e-02 1 1  ON 33
eH1_4                 1.850376e-02 1 1  ON 34
eH1_5                 3.211868e-02 1 1  ON 35
eH1_6                 7.905440e-02 1 1  ON 36
eH1_7                 1.097262e-01 1 1  ON 37
eH1_8                 1.036440e-01 1 1  ON 38
eH1_9                 2.876269e-02 1 1  ON 39
eH2_0                -1.880868e-01 1 1  ON 40
eH2_1                -1.076518e-01 1 1  ON 41
eH2_2                -6.401396e-02 1 1  ON 42
eH2_3                -2.576855e-02 1 1  ON 43
eH2_4                 1.807306e-02 1 1  ON 44
eH2_5                 2.933144e-02 1 1  ON 45
eH2_6                 7.388113e-02 1 1  ON 46
eH2_7                 1.121457e-01 1 1  ON 47
eH2_8                 1.073832e-01 1 1  ON 48
eH2_9                 3.055534e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1902
    reference variance = 0.415951
====================================================
  Execution time = 3.7566e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5027e-01
  Total weights = 2.0000e+06
  Execution time = 3.1249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350098373291
                                         uncertainty =       0.007571917226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350098373291
                                         uncertainty =       0.007571917226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418438920
  error estimate for blocks of size 2^( 2) =       0.000429045033
  error estimate for blocks of size 2^( 3) =       0.000438324101
  error estimate for blocks of size 2^( 4) =       0.000444679760
  error estimate for blocks of size 2^( 5) =       0.000448973879
  error estimate for blocks of size 2^( 6) =       0.000449718005
  error estimate for blocks of size 2^( 7) =       0.000450782653

      target function =                  N/A
              le_mean =     -17.211965659786
             les_mean =     296.601943957316
             stat err =       0.000448538574
             autocorr =       1.149040807268
              std dev =       0.591761995034
             le_variance =       0.350182258767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350726433355
                                         uncertainty =       0.007586886368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350726433355
                                         uncertainty =       0.007586886368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418813885
  error estimate for blocks of size 2^( 2) =       0.000429402644
  error estimate for blocks of size 2^( 3) =       0.000438641818
  error estimate for blocks of size 2^( 4) =       0.000444951874
  error estimate for blocks of size 2^( 5) =       0.000449202683
  error estimate for blocks of size 2^( 6) =       0.000449936926
  error estimate for blocks of size 2^( 7) =       0.000450968577

      target function =                  N/A
              le_mean =     -17.211957313511
             les_mean =     296.602284526446
             stat err =       0.000448765015
             autocorr =       1.148142631479
              std dev =       0.592292275589
             le_variance =       0.350810139722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350319018493
                                         uncertainty =       0.007576245163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350319018493
                                         uncertainty =       0.007576245163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418570660
  error estimate for blocks of size 2^( 2) =       0.000429175376
  error estimate for blocks of size 2^( 3) =       0.000438443050
  error estimate for blocks of size 2^( 4) =       0.000444780061
  error estimate for blocks of size 2^( 5) =       0.000449057648
  error estimate for blocks of size 2^( 6) =       0.000449808508
  error estimate for blocks of size 2^( 7) =       0.000450841946

      target function =                  N/A
              le_mean =     -17.211952984320
             les_mean =     296.601728154656
             stat err =       0.000448622041
             autocorr =       1.148745033167
              std dev =       0.591948304679
             le_variance =       0.350402795412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349950254998
                                         uncertainty =       0.007568354201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349950254998
                                         uncertainty =       0.007568354201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418350381
  error estimate for blocks of size 2^( 2) =       0.000428958699
  error estimate for blocks of size 2^( 3) =       0.000438240457
  error estimate for blocks of size 2^( 4) =       0.000444596812
  error estimate for blocks of size 2^( 5) =       0.000448891137
  error estimate for blocks of size 2^( 6) =       0.000449640291
  error estimate for blocks of size 2^( 7) =       0.000450694602

      target function =                  N/A
              le_mean =     -17.211956119634
             les_mean =     296.601467371884
             stat err =       0.000448455710
             autocorr =       1.149102525729
              std dev =       0.591636782740
             le_variance =       0.350034082691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211965659786        initial  <--
     3.8147e-03     3.8147e-02             4.2281e-02       -17.211957313511
     1.5259e-02     1.5259e-01             1.0168e-02       -17.211952984320
     6.1035e-02     6.1035e-01             3.2920e-03       -17.211956119634

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2006
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.186947e-01 1 1  ON 0
 uu_1                 5.266477e-02 1 1  ON 1
 uu_2                -4.709160e-02 1 1  ON 2
 uu_3                -1.040507e-01 1 1  ON 3
 uu_4                -1.365488e-01 1 1  ON 4
 uu_5                -1.418747e-01 1 1  ON 5
 uu_6                -1.176310e-01 1 1  ON 6
 uu_7                -4.846998e-02 1 1  ON 7
 uu_8                 9.238406e-02 1 1  ON 8
 uu_9                 1.286145e-01 1 1  ON 9
 ud_0                 3.679912e-01 1 1  ON 10
 ud_1                 1.018187e-01 1 1  ON 11
 ud_2                -1.472736e-02 1 1  ON 12
 ud_3                -7.821778e-02 1 1  ON 13
 ud_4                -1.259379e-01 1 1  ON 14
 ud_5                -1.575809e-01 1 1  ON 15
 ud_6                -1.598925e-01 1 1  ON 16
 ud_7                -1.155976e-01 1 1  ON 17
 ud_8                -1.184561e-02 1 1  ON 18
 ud_9                 9.217486e-02 1 1  ON 19
 eO_0                -8.045426e-01 1 1  ON 20
 eO_1                -4.722167e-01 1 1  ON 21
 eO_2                -4.368036e-02 1 1  ON 22
 eO_3                 2.225516e-01 1 1  ON 23
 eO_4                 3.198767e-01 1 1  ON 24
 eO_5                 3.295433e-01 1 1  ON 25
 eO_6                 2.607898e-01 1 1  ON 26
 eO_7                 1.256374e-01 1 1  ON 27
 eO_8                 3.021399e-02 1 1  ON 28
 eO_9                 1.969679e-02 1 1  ON 29
eH1_0                -1.853244e-01 1 1  ON 30
eH1_1                -1.057373e-01 1 1  ON 31
eH1_2                -6.330207e-02 1 1  ON 32
eH1_3                -2.524681e-02 1 1  ON 33
eH1_4                 1.907480e-02 1 1  ON 34
eH1_5                 3.204875e-02 1 1  ON 35
eH1_6                 7.772615e-02 1 1  ON 36
eH1_7                 1.083847e-01 1 1  ON 37
eH1_8                 9.855964e-02 1 1  ON 38
eH1_9                 2.732198e-02 1 1  ON 39
eH2_0                -1.872365e-01 1 1  ON 40
eH2_1                -1.073865e-01 1 1  ON 41
eH2_2                -6.447759e-02 1 1  ON 42
eH2_3                -2.627264e-02 1 1  ON 43
eH2_4                 1.831992e-02 1 1  ON 44
eH2_5                 3.157646e-02 1 1  ON 45
eH2_6                 7.828377e-02 1 1  ON 46
eH2_7                 1.124369e-01 1 1  ON 47
eH2_8                 1.022486e-01 1 1  ON 48
eH2_9                 2.887500e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0301e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.185
    reference variance = 0.134097
====================================================
  Execution time = 3.7610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.6408e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0530e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364163463218
                                         uncertainty =       0.019169211053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364163463218
                                         uncertainty =       0.019169211053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426663960
  error estimate for blocks of size 2^( 2) =       0.000437410207
  error estimate for blocks of size 2^( 3) =       0.000446608612
  error estimate for blocks of size 2^( 4) =       0.000454119897
  error estimate for blocks of size 2^( 5) =       0.000458505514
  error estimate for blocks of size 2^( 6) =       0.000459949089
  error estimate for blocks of size 2^( 7) =       0.000462044422

      target function =                  N/A
              le_mean =     -17.212074787940
             les_mean =     296.619602592393
             stat err =       0.000458654731
             autocorr =       1.155579518083
              std dev =       0.603393958208
             le_variance =       0.364084268801


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721207478794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212074787940       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212075472095       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212076367799       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212077230316       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212077566440       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212076878392       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212076497809       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212076270101       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212077219735       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212079181875       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212079685691       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212078994083       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.212079130942       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.212079974868       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 3.803156e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212074787940       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212075232829       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212075959167       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212076473466       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212076593389       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212075893699       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212075339932       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212075915734       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212076388342       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212076652474       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.011672e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212074787940       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212074973396       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212075388844       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212075520157       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212075473750       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212075147288       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212075162726       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212075153496       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212075295360       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.993071e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.461375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8151e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.192407e-01 1 1  ON 0
 uu_1                 5.288035e-02 1 1  ON 1
 uu_2                -4.670182e-02 1 1  ON 2
 uu_3                -1.039317e-01 1 1  ON 3
 uu_4                -1.367496e-01 1 1  ON 4
 uu_5                -1.422550e-01 1 1  ON 5
 uu_6                -1.182879e-01 1 1  ON 6
 uu_7                -4.875929e-02 1 1  ON 7
 uu_8                 9.185022e-02 1 1  ON 8
 uu_9                 1.289003e-01 1 1  ON 9
 ud_0                 3.677517e-01 1 1  ON 10
 ud_1                 1.018207e-01 1 1  ON 11
 ud_2                -1.462018e-02 1 1  ON 12
 ud_3                -7.825482e-02 1 1  ON 13
 ud_4                -1.262272e-01 1 1  ON 14
 ud_5                -1.572971e-01 1 1  ON 15
 ud_6                -1.591681e-01 1 1  ON 16
 ud_7                -1.157187e-01 1 1  ON 17
 ud_8                -1.262399e-02 1 1  ON 18
 ud_9                 9.207236e-02 1 1  ON 19
 eO_0                -8.054956e-01 1 1  ON 20
 eO_1                -4.732284e-01 1 1  ON 21
 eO_2                -4.453195e-02 1 1  ON 22
 eO_3                 2.222454e-01 1 1  ON 23
 eO_4                 3.201373e-01 1 1  ON 24
 eO_5                 3.304659e-01 1 1  ON 25
 eO_6                 2.617013e-01 1 1  ON 26
 eO_7                 1.264706e-01 1 1  ON 27
 eO_8                 3.031675e-02 1 1  ON 28
 eO_9                 1.972636e-02 1 1  ON 29
eH1_0                -1.855895e-01 1 1  ON 30
eH1_1                -1.061383e-01 1 1  ON 31
eH1_2                -6.315566e-02 1 1  ON 32
eH1_3                -2.538119e-02 1 1  ON 33
eH1_4                 1.895385e-02 1 1  ON 34
eH1_5                 3.216174e-02 1 1  ON 35
eH1_6                 7.768617e-02 1 1  ON 36
eH1_7                 1.084798e-01 1 1  ON 37
eH1_8                 9.895926e-02 1 1  ON 38
eH1_9                 2.746607e-02 1 1  ON 39
eH2_0                -1.874980e-01 1 1  ON 40
eH2_1                -1.072860e-01 1 1  ON 41
eH2_2                -6.436100e-02 1 1  ON 42
eH2_3                -2.640935e-02 1 1  ON 43
eH2_4                 1.866440e-02 1 1  ON 44
eH2_5                 3.136848e-02 1 1  ON 45
eH2_6                 7.783952e-02 1 1  ON 46
eH2_7                 1.123219e-01 1 1  ON 47
eH2_8                 1.026860e-01 1 1  ON 48
eH2_9                 2.901114e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1959
    reference variance = 0.374619
====================================================
  Execution time = 3.6878e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4492e-01
  Total weights = 2.0000e+06
  Execution time = 3.0904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345282221113
                                         uncertainty =       0.004787594504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345282221113
                                         uncertainty =       0.004787594504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415466986
  error estimate for blocks of size 2^( 2) =       0.000425524628
  error estimate for blocks of size 2^( 3) =       0.000435358330
  error estimate for blocks of size 2^( 4) =       0.000442658855
  error estimate for blocks of size 2^( 5) =       0.000447870147
  error estimate for blocks of size 2^( 6) =       0.000450240916
  error estimate for blocks of size 2^( 7) =       0.000451579099

      target function =                  N/A
              le_mean =     -17.211424443899
             les_mean =     296.578356848702
             stat err =       0.000448087254
             autocorr =       1.163193969606
              std dev =       0.587559046624
             le_variance =       0.345225633270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345049771806
                                         uncertainty =       0.004775030392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345049771806
                                         uncertainty =       0.004775030392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415327134
  error estimate for blocks of size 2^( 2) =       0.000425390279
  error estimate for blocks of size 2^( 3) =       0.000435221625
  error estimate for blocks of size 2^( 4) =       0.000442513272
  error estimate for blocks of size 2^( 5) =       0.000447730239
  error estimate for blocks of size 2^( 6) =       0.000450105232
  error estimate for blocks of size 2^( 7) =       0.000451462292

      target function =                  N/A
              le_mean =     -17.211421745098
             les_mean =     296.578031571301
             stat err =       0.000447952759
             autocorr =       1.163278820101
              std dev =       0.587361265475
             le_variance =       0.344993256180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344674817535
                                         uncertainty =       0.004768523444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344674817535
                                         uncertainty =       0.004768523444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415101451
  error estimate for blocks of size 2^( 2) =       0.000425179875
  error estimate for blocks of size 2^( 3) =       0.000435025072
  error estimate for blocks of size 2^( 4) =       0.000442323794
  error estimate for blocks of size 2^( 5) =       0.000447551528
  error estimate for blocks of size 2^( 6) =       0.000449930945
  error estimate for blocks of size 2^( 7) =       0.000451296407

      target function =                  N/A
              le_mean =     -17.211422232303
             les_mean =     296.577673515232
             stat err =       0.000447775669
             autocorr =       1.163623489076
              std dev =       0.587042101495
             le_variance =       0.344618428928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345072163483
                                         uncertainty =       0.004782743559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345072163483
                                         uncertainty =       0.004782743559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415340613
  error estimate for blocks of size 2^( 2) =       0.000425405238
  error estimate for blocks of size 2^( 3) =       0.000435243833
  error estimate for blocks of size 2^( 4) =       0.000442545246
  error estimate for blocks of size 2^( 5) =       0.000447761892
  error estimate for blocks of size 2^( 6) =       0.000450135211
  error estimate for blocks of size 2^( 7) =       0.000451480778

      target function =                  N/A
              le_mean =     -17.211423204686
             les_mean =     296.578104207368
             stat err =       0.000447980782
             autocorr =       1.163348859873
              std dev =       0.587380327434
             le_variance =       0.345015649056


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211424443899        initial  <--
     3.8147e-02     3.8147e-01             3.8032e-03       -17.211421745098
     1.5259e-01     1.5259e+00             1.0117e-03       -17.211422232303
     6.1035e-01     6.1035e+00             2.9931e-04       -17.211423204686

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.4355
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.186947e-01 1 1  ON 0
 uu_1                 5.266477e-02 1 1  ON 1
 uu_2                -4.709160e-02 1 1  ON 2
 uu_3                -1.040507e-01 1 1  ON 3
 uu_4                -1.365488e-01 1 1  ON 4
 uu_5                -1.418747e-01 1 1  ON 5
 uu_6                -1.176310e-01 1 1  ON 6
 uu_7                -4.846998e-02 1 1  ON 7
 uu_8                 9.238406e-02 1 1  ON 8
 uu_9                 1.286145e-01 1 1  ON 9
 ud_0                 3.679912e-01 1 1  ON 10
 ud_1                 1.018187e-01 1 1  ON 11
 ud_2                -1.472736e-02 1 1  ON 12
 ud_3                -7.821778e-02 1 1  ON 13
 ud_4                -1.259379e-01 1 1  ON 14
 ud_5                -1.575809e-01 1 1  ON 15
 ud_6                -1.598925e-01 1 1  ON 16
 ud_7                -1.155976e-01 1 1  ON 17
 ud_8                -1.184561e-02 1 1  ON 18
 ud_9                 9.217486e-02 1 1  ON 19
 eO_0                -8.045426e-01 1 1  ON 20
 eO_1                -4.722167e-01 1 1  ON 21
 eO_2                -4.368036e-02 1 1  ON 22
 eO_3                 2.225516e-01 1 1  ON 23
 eO_4                 3.198767e-01 1 1  ON 24
 eO_5                 3.295433e-01 1 1  ON 25
 eO_6                 2.607898e-01 1 1  ON 26
 eO_7                 1.256374e-01 1 1  ON 27
 eO_8                 3.021399e-02 1 1  ON 28
 eO_9                 1.969679e-02 1 1  ON 29
eH1_0                -1.853244e-01 1 1  ON 30
eH1_1                -1.057373e-01 1 1  ON 31
eH1_2                -6.330207e-02 1 1  ON 32
eH1_3                -2.524681e-02 1 1  ON 33
eH1_4                 1.907480e-02 1 1  ON 34
eH1_5                 3.204875e-02 1 1  ON 35
eH1_6                 7.772615e-02 1 1  ON 36
eH1_7                 1.083847e-01 1 1  ON 37
eH1_8                 9.855964e-02 1 1  ON 38
eH1_9                 2.732198e-02 1 1  ON 39
eH2_0                -1.872365e-01 1 1  ON 40
eH2_1                -1.073865e-01 1 1  ON 41
eH2_2                -6.447759e-02 1 1  ON 42
eH2_3                -2.627264e-02 1 1  ON 43
eH2_4                 1.831992e-02 1 1  ON 44
eH2_5                 3.157646e-02 1 1  ON 45
eH2_6                 7.828377e-02 1 1  ON 46
eH2_7                 1.124369e-01 1 1  ON 47
eH2_8                 1.022486e-01 1 1  ON 48
eH2_9                 2.887500e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0059e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.177
    reference variance = 0.612227
====================================================
  Execution time = 3.7922e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4547e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0671e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345494117716
                                         uncertainty =       0.004390643333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345494117716
                                         uncertainty =       0.004390643333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415616761
  error estimate for blocks of size 2^( 2) =       0.000426353564
  error estimate for blocks of size 2^( 3) =       0.000435987780
  error estimate for blocks of size 2^( 4) =       0.000443529093
  error estimate for blocks of size 2^( 5) =       0.000448747230
  error estimate for blocks of size 2^( 6) =       0.000451288853
  error estimate for blocks of size 2^( 7) =       0.000451455396

      target function =                  N/A
              le_mean =     -17.211948578943
             les_mean =     296.596648295320
             stat err =       0.000448755143
             autocorr =       1.165823407372
              std dev =       0.587770860016
             le_variance =       0.345474583884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721194857894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211948578943       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211948402082       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211947817304       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211945895440       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211946326042       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211945893859       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211946181038       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211946200972       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211946260295       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.035348e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211948578943       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211948515368       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211948355121       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211947615924       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211947759682       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211947611353       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211947623373       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211947667941       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.497179e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211948578943       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211948561096       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211948520212       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211948308158       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211948345578       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211948307089       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211948302947       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.006781e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.464991 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8601e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.187311e-01 1 1  ON 0
 uu_1                 5.267170e-02 1 1  ON 1
 uu_2                -4.712750e-02 1 1  ON 2
 uu_3                -1.040514e-01 1 1  ON 3
 uu_4                -1.365770e-01 1 1  ON 4
 uu_5                -1.418560e-01 1 1  ON 5
 uu_6                -1.176679e-01 1 1  ON 6
 uu_7                -4.847231e-02 1 1  ON 7
 uu_8                 9.236322e-02 1 1  ON 8
 uu_9                 1.286498e-01 1 1  ON 9
 ud_0                 3.678897e-01 1 1  ON 10
 ud_1                 1.018310e-01 1 1  ON 11
 ud_2                -1.474950e-02 1 1  ON 12
 ud_3                -7.818448e-02 1 1  ON 13
 ud_4                -1.259750e-01 1 1  ON 14
 ud_5                -1.575582e-01 1 1  ON 15
 ud_6                -1.598257e-01 1 1  ON 16
 ud_7                -1.155552e-01 1 1  ON 17
 ud_8                -1.188032e-02 1 1  ON 18
 ud_9                 9.217104e-02 1 1  ON 19
 eO_0                -8.046923e-01 1 1  ON 20
 eO_1                -4.722025e-01 1 1  ON 21
 eO_2                -4.382343e-02 1 1  ON 22
 eO_3                 2.224660e-01 1 1  ON 23
 eO_4                 3.199067e-01 1 1  ON 24
 eO_5                 3.296659e-01 1 1  ON 25
 eO_6                 2.608892e-01 1 1  ON 26
 eO_7                 1.257302e-01 1 1  ON 27
 eO_8                 3.022815e-02 1 1  ON 28
 eO_9                 1.970052e-02 1 1  ON 29
eH1_0                -1.853052e-01 1 1  ON 30
eH1_1                -1.057626e-01 1 1  ON 31
eH1_2                -6.328736e-02 1 1  ON 32
eH1_3                -2.523793e-02 1 1  ON 33
eH1_4                 1.902465e-02 1 1  ON 34
eH1_5                 3.204776e-02 1 1  ON 35
eH1_6                 7.769953e-02 1 1  ON 36
eH1_7                 1.083774e-01 1 1  ON 37
eH1_8                 9.860198e-02 1 1  ON 38
eH1_9                 2.734192e-02 1 1  ON 39
eH2_0                -1.872324e-01 1 1  ON 40
eH2_1                -1.074077e-01 1 1  ON 41
eH2_2                -6.443133e-02 1 1  ON 42
eH2_3                -2.636399e-02 1 1  ON 43
eH2_4                 1.831515e-02 1 1  ON 44
eH2_5                 3.157321e-02 1 1  ON 45
eH2_6                 7.827030e-02 1 1  ON 46
eH2_7                 1.124534e-01 1 1  ON 47
eH2_8                 1.022985e-01 1 1  ON 48
eH2_9                 2.889092e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2807
    reference variance = 0.35848
====================================================
  Execution time = 3.6859e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4484e-01
  Total weights = 2.0000e+06
  Execution time = 3.0970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344951791362
                                         uncertainty =       0.006258993942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344951791362
                                         uncertainty =       0.006258993942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415265046
  error estimate for blocks of size 2^( 2) =       0.000425875547
  error estimate for blocks of size 2^( 3) =       0.000435367789
  error estimate for blocks of size 2^( 4) =       0.000442463839
  error estimate for blocks of size 2^( 5) =       0.000446381084
  error estimate for blocks of size 2^( 6) =       0.000449022071
  error estimate for blocks of size 2^( 7) =       0.000453109264

      target function =                  N/A
              le_mean =     -17.210694984850
             les_mean =     296.552911805215
             stat err =       0.000447744065
             autocorr =       1.162542722594
              std dev =       0.587273459412
             le_variance =       0.344890116130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344851438289
                                         uncertainty =       0.006258751859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344851438289
                                         uncertainty =       0.006258751859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415204649
  error estimate for blocks of size 2^( 2) =       0.000425816384
  error estimate for blocks of size 2^( 3) =       0.000435309439
  error estimate for blocks of size 2^( 4) =       0.000442410125
  error estimate for blocks of size 2^( 5) =       0.000446327550
  error estimate for blocks of size 2^( 6) =       0.000448971800
  error estimate for blocks of size 2^( 7) =       0.000453061469

      target function =                  N/A
              le_mean =     -17.210696121563
             les_mean =     296.552850617740
             stat err =       0.000447692736
             autocorr =       1.162614353375
              std dev =       0.587188045976
             le_variance =       0.344789801337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344847316650
                                         uncertainty =       0.006258532940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344847316650
                                         uncertainty =       0.006258532940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415202170
  error estimate for blocks of size 2^( 2) =       0.000425814224
  error estimate for blocks of size 2^( 3) =       0.000435307604
  error estimate for blocks of size 2^( 4) =       0.000442407756
  error estimate for blocks of size 2^( 5) =       0.000446325065
  error estimate for blocks of size 2^( 6) =       0.000448968705
  error estimate for blocks of size 2^( 7) =       0.000453058860

      target function =                  N/A
              le_mean =     -17.210696257822
             les_mean =     296.552851190327
             stat err =       0.000447690097
             autocorr =       1.162614528403
              std dev =       0.587184539737
             le_variance =       0.344785683706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344933984005
                                         uncertainty =       0.006258893693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344933984005
                                         uncertainty =       0.006258893693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415254329
  error estimate for blocks of size 2^( 2) =       0.000425865109
  error estimate for blocks of size 2^( 3) =       0.000435357529
  error estimate for blocks of size 2^( 4) =       0.000442454203
  error estimate for blocks of size 2^( 5) =       0.000446371420
  error estimate for blocks of size 2^( 6) =       0.000449012806
  error estimate for blocks of size 2^( 7) =       0.000453100524

      target function =                  N/A
              le_mean =     -17.210695199309
             les_mean =     296.552901387251
             stat err =       0.000447734738
             autocorr =       1.162554293319
              std dev =       0.587258304481
             le_variance =       0.344872316181


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210694984850        initial
     3.8147e-01     3.8147e+00             5.0353e-04       -17.210696121563
     1.5259e+00     1.5259e+01             1.4972e-04       -17.210696257822  <--
     6.1035e+00     6.1035e+01             4.0068e-05       -17.210695199309

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 5.2444e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.187311e-01 1 1  ON 0
 uu_1                 5.267170e-02 1 1  ON 1
 uu_2                -4.712750e-02 1 1  ON 2
 uu_3                -1.040514e-01 1 1  ON 3
 uu_4                -1.365770e-01 1 1  ON 4
 uu_5                -1.418560e-01 1 1  ON 5
 uu_6                -1.176679e-01 1 1  ON 6
 uu_7                -4.847231e-02 1 1  ON 7
 uu_8                 9.236322e-02 1 1  ON 8
 uu_9                 1.286498e-01 1 1  ON 9
 ud_0                 3.678897e-01 1 1  ON 10
 ud_1                 1.018310e-01 1 1  ON 11
 ud_2                -1.474950e-02 1 1  ON 12
 ud_3                -7.818448e-02 1 1  ON 13
 ud_4                -1.259750e-01 1 1  ON 14
 ud_5                -1.575582e-01 1 1  ON 15
 ud_6                -1.598257e-01 1 1  ON 16
 ud_7                -1.155552e-01 1 1  ON 17
 ud_8                -1.188032e-02 1 1  ON 18
 ud_9                 9.217104e-02 1 1  ON 19
 eO_0                -8.046923e-01 1 1  ON 20
 eO_1                -4.722025e-01 1 1  ON 21
 eO_2                -4.382343e-02 1 1  ON 22
 eO_3                 2.224660e-01 1 1  ON 23
 eO_4                 3.199067e-01 1 1  ON 24
 eO_5                 3.296659e-01 1 1  ON 25
 eO_6                 2.608892e-01 1 1  ON 26
 eO_7                 1.257302e-01 1 1  ON 27
 eO_8                 3.022815e-02 1 1  ON 28
 eO_9                 1.970052e-02 1 1  ON 29
eH1_0                -1.853052e-01 1 1  ON 30
eH1_1                -1.057626e-01 1 1  ON 31
eH1_2                -6.328736e-02 1 1  ON 32
eH1_3                -2.523793e-02 1 1  ON 33
eH1_4                 1.902465e-02 1 1  ON 34
eH1_5                 3.204776e-02 1 1  ON 35
eH1_6                 7.769953e-02 1 1  ON 36
eH1_7                 1.083774e-01 1 1  ON 37
eH1_8                 9.860198e-02 1 1  ON 38
eH1_9                 2.734192e-02 1 1  ON 39
eH2_0                -1.872324e-01 1 1  ON 40
eH2_1                -1.074077e-01 1 1  ON 41
eH2_2                -6.443133e-02 1 1  ON 42
eH2_3                -2.636399e-02 1 1  ON 43
eH2_4                 1.831515e-02 1 1  ON 44
eH2_5                 3.157321e-02 1 1  ON 45
eH2_6                 7.827030e-02 1 1  ON 46
eH2_7                 1.124534e-01 1 1  ON 47
eH2_8                 1.022985e-01 1 1  ON 48
eH2_9                 2.889092e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0105e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1305
    reference variance = 0.219985
====================================================
  Execution time = 3.8909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.4422e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0476e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344040724125
                                         uncertainty =       0.004569091974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344040724125
                                         uncertainty =       0.004569091974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414859638
  error estimate for blocks of size 2^( 2) =       0.000425072123
  error estimate for blocks of size 2^( 3) =       0.000434505156
  error estimate for blocks of size 2^( 4) =       0.000441013186
  error estimate for blocks of size 2^( 5) =       0.000444623416
  error estimate for blocks of size 2^( 6) =       0.000448234651
  error estimate for blocks of size 2^( 7) =       0.000448480895

      target function =                  N/A
              le_mean =     -17.212675222308
             les_mean =     296.620405174761
             stat err =       0.000445588037
             autocorr =       1.153625049668
              std dev =       0.586700126322
             le_variance =       0.344217038226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721267522231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212675222308       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212676295181       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212677398838       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212678408572       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212677730887       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212678065990       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212678220266       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212678114751       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212678145302       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 3.961515e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212675222308       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212675573282       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212676123631       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212676470069       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212676300487       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212676427459       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212676467546       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212676433170       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.120296e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212675222308       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212675317385       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212675491608       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212675587409       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212675553445       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212675587941       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212675596704       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.053755e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.468553 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9394e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.187515e-01 1 1  ON 0
 uu_1                 5.265466e-02 1 1  ON 1
 uu_2                -4.702971e-02 1 1  ON 2
 uu_3                -1.040354e-01 1 1  ON 3
 uu_4                -1.365575e-01 1 1  ON 4
 uu_5                -1.419090e-01 1 1  ON 5
 uu_6                -1.177638e-01 1 1  ON 6
 uu_7                -4.853419e-02 1 1  ON 7
 uu_8                 9.232622e-02 1 1  ON 8
 uu_9                 1.286954e-01 1 1  ON 9
 ud_0                 3.677980e-01 1 1  ON 10
 ud_1                 1.018314e-01 1 1  ON 11
 ud_2                -1.475046e-02 1 1  ON 12
 ud_3                -7.821494e-02 1 1  ON 13
 ud_4                -1.260362e-01 1 1  ON 14
 ud_5                -1.574945e-01 1 1  ON 15
 ud_6                -1.597598e-01 1 1  ON 16
 ud_7                -1.155436e-01 1 1  ON 17
 ud_8                -1.192384e-02 1 1  ON 18
 ud_9                 9.219134e-02 1 1  ON 19
 eO_0                -8.047943e-01 1 1  ON 20
 eO_1                -4.722682e-01 1 1  ON 21
 eO_2                -4.393546e-02 1 1  ON 22
 eO_3                 2.224350e-01 1 1  ON 23
 eO_4                 3.199217e-01 1 1  ON 24
 eO_5                 3.297595e-01 1 1  ON 25
 eO_6                 2.609698e-01 1 1  ON 26
 eO_7                 1.258127e-01 1 1  ON 27
 eO_8                 3.024665e-02 1 1  ON 28
 eO_9                 1.971257e-02 1 1  ON 29
eH1_0                -1.853099e-01 1 1  ON 30
eH1_1                -1.058587e-01 1 1  ON 31
eH1_2                -6.324231e-02 1 1  ON 32
eH1_3                -2.522719e-02 1 1  ON 33
eH1_4                 1.905373e-02 1 1  ON 34
eH1_5                 3.203744e-02 1 1  ON 35
eH1_6                 7.767214e-02 1 1  ON 36
eH1_7                 1.083675e-01 1 1  ON 37
eH1_8                 9.864153e-02 1 1  ON 38
eH1_9                 2.735875e-02 1 1  ON 39
eH2_0                -1.872351e-01 1 1  ON 40
eH2_1                -1.073617e-01 1 1  ON 41
eH2_2                -6.441966e-02 1 1  ON 42
eH2_3                -2.640913e-02 1 1  ON 43
eH2_4                 1.828005e-02 1 1  ON 44
eH2_5                 3.156908e-02 1 1  ON 45
eH2_6                 7.823029e-02 1 1  ON 46
eH2_7                 1.124511e-01 1 1  ON 47
eH2_8                 1.023436e-01 1 1  ON 48
eH2_9                 2.890794e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1607
    reference variance = 0.199955
====================================================
  Execution time = 3.7017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.8776e-01
  Total weights = 2.0000e+06
  Execution time = 3.1084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.388042414659
                                         uncertainty =       0.040022877509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.388042414659
                                         uncertainty =       0.040022877509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000440398081
  error estimate for blocks of size 2^( 2) =       0.000450468818
  error estimate for blocks of size 2^( 3) =       0.000458949234
  error estimate for blocks of size 2^( 4) =       0.000465302705
  error estimate for blocks of size 2^( 5) =       0.000470705548
  error estimate for blocks of size 2^( 6) =       0.000472299151
  error estimate for blocks of size 2^( 7) =       0.000475000364

      target function =                  N/A
              le_mean =     -17.211386026336
             les_mean =     296.619709692813
             stat err =       0.000470826942
             autocorr =       1.142961962528
              std dev =       0.622816938751
             le_variance =       0.387900939195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387747559355
                                         uncertainty =       0.039968822573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387747559355
                                         uncertainty =       0.039968822573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000440230715
  error estimate for blocks of size 2^( 2) =       0.000450307300
  error estimate for blocks of size 2^( 3) =       0.000458793163
  error estimate for blocks of size 2^( 4) =       0.000465148240
  error estimate for blocks of size 2^( 5) =       0.000470551030
  error estimate for blocks of size 2^( 6) =       0.000472146706
  error estimate for blocks of size 2^( 7) =       0.000474849414

      target function =                  N/A
              le_mean =     -17.211386184023
             les_mean =     296.619420345918
             stat err =       0.000470673847
             autocorr =       1.143087448379
              std dev =       0.622580247143
             le_variance =       0.387606164133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387768375931
                                         uncertainty =       0.039973170940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387768375931
                                         uncertainty =       0.039973170940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000440242544
  error estimate for blocks of size 2^( 2) =       0.000450319107
  error estimate for blocks of size 2^( 3) =       0.000458804774
  error estimate for blocks of size 2^( 4) =       0.000465160776
  error estimate for blocks of size 2^( 5) =       0.000470564051
  error estimate for blocks of size 2^( 6) =       0.000472159524
  error estimate for blocks of size 2^( 7) =       0.000474861910

      target function =                  N/A
              le_mean =     -17.211386120241
             les_mean =     296.619438980918
             stat err =       0.000470686565
             autocorr =       1.143087792814
              std dev =       0.622596976146
             le_variance =       0.387626994706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387998107147
                                         uncertainty =       0.040014893694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387998107147
                                         uncertainty =       0.040014893694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000440372937
  error estimate for blocks of size 2^( 2) =       0.000450444650
  error estimate for blocks of size 2^( 3) =       0.000458925904
  error estimate for blocks of size 2^( 4) =       0.000465279860
  error estimate for blocks of size 2^( 5) =       0.000470682817
  error estimate for blocks of size 2^( 6) =       0.000472276703
  error estimate for blocks of size 2^( 7) =       0.000474978056

      target function =                  N/A
              le_mean =     -17.211386000169
             les_mean =     296.619664500748
             stat err =       0.000470804359
             autocorr =       1.142982829098
              std dev =       0.622781380463
             le_variance =       0.387856647851


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211386026336        initial
     3.8147e-01     3.8147e+00             3.9615e-04       -17.211386184023  <--
     1.5259e+00     1.5259e+01             1.1203e-04       -17.211386120241
     6.1035e+00     6.1035e+01             3.0538e-05       -17.211386000169

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 5.2633e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.188318e-01 1 1  ON 0
 uu_1                 5.270215e-02 1 1  ON 1
 uu_2                -4.686541e-02 1 1  ON 2
 uu_3                -1.039483e-01 1 1  ON 3
 uu_4                -1.365372e-01 1 1  ON 4
 uu_5                -1.420473e-01 1 1  ON 5
 uu_6                -1.180529e-01 1 1  ON 6
 uu_7                -4.872603e-02 1 1  ON 7
 uu_8                 9.221370e-02 1 1  ON 8
 uu_9                 1.288321e-01 1 1  ON 9
 ud_0                 3.676553e-01 1 1  ON 10
 ud_1                 1.017945e-01 1 1  ON 11
 ud_2                -1.478908e-02 1 1  ON 12
 ud_3                -7.830538e-02 1 1  ON 13
 ud_4                -1.261625e-01 1 1  ON 14
 ud_5                -1.574094e-01 1 1  ON 15
 ud_6                -1.595804e-01 1 1  ON 16
 ud_7                -1.155024e-01 1 1  ON 17
 ud_8                -1.205295e-02 1 1  ON 18
 ud_9                 9.225210e-02 1 1  ON 19
 eO_0                -8.050885e-01 1 1  ON 20
 eO_1                -4.724955e-01 1 1  ON 21
 eO_2                -4.419283e-02 1 1  ON 22
 eO_3                 2.223067e-01 1 1  ON 23
 eO_4                 3.199438e-01 1 1  ON 24
 eO_5                 3.300378e-01 1 1  ON 25
 eO_6                 2.612120e-01 1 1  ON 26
 eO_7                 1.260601e-01 1 1  ON 27
 eO_8                 3.030215e-02 1 1  ON 28
 eO_9                 1.974868e-02 1 1  ON 29
eH1_0                -1.853419e-01 1 1  ON 30
eH1_1                -1.060260e-01 1 1  ON 31
eH1_2                -6.315990e-02 1 1  ON 32
eH1_3                -2.520472e-02 1 1  ON 33
eH1_4                 1.911871e-02 1 1  ON 34
eH1_5                 3.199288e-02 1 1  ON 35
eH1_6                 7.758666e-02 1 1  ON 36
eH1_7                 1.083368e-01 1 1  ON 37
eH1_8                 9.876001e-02 1 1  ON 38
eH1_9                 2.740922e-02 1 1  ON 39
eH2_0                -1.872268e-01 1 1  ON 40
eH2_1                -1.072837e-01 1 1  ON 41
eH2_2                -6.438970e-02 1 1  ON 42
eH2_3                -2.649733e-02 1 1  ON 43
eH2_4                 1.818794e-02 1 1  ON 44
eH2_5                 3.154359e-02 1 1  ON 45
eH2_6                 7.811100e-02 1 1  ON 46
eH2_7                 1.124448e-01 1 1  ON 47
eH2_8                 1.024790e-01 1 1  ON 48
eH2_9                 2.895900e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0203e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.246
    reference variance = 0.328603
====================================================
  Execution time = 3.7812e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4674e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0419e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346848548902
                                         uncertainty =       0.006272864098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346848548902
                                         uncertainty =       0.006272864098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416376013
  error estimate for blocks of size 2^( 2) =       0.000426976985
  error estimate for blocks of size 2^( 3) =       0.000435872064
  error estimate for blocks of size 2^( 4) =       0.000442020639
  error estimate for blocks of size 2^( 5) =       0.000446218089
  error estimate for blocks of size 2^( 6) =       0.000448155777
  error estimate for blocks of size 2^( 7) =       0.000450607840

      target function =                  N/A
              le_mean =     -17.212024004516
             les_mean =     296.600508126795
             stat err =       0.000446750586
             autocorr =       1.151221410383
              std dev =       0.588844604403
             le_variance =       0.346737968134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721202400452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212024004516       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212023191105       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212023776584       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212025336077       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212025803160       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212026949516       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212026025204       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212025968115       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212025549761       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212026620923       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212026374068       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.629116e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212024004516       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212023562721       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212023744347       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212024544574       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212024657406       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212024729844       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212024710195       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212024741925       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212024606467       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.818884e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212024004516       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212023848264       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212023884511       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212024150959       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212024168517       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212024159495       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212024158588       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212024199147       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.333744e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.473104 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8241e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.190544e-01 1 1  ON 0
 uu_1                 5.276431e-02 1 1  ON 1
 uu_2                -4.682603e-02 1 1  ON 2
 uu_3                -1.038937e-01 1 1  ON 3
 uu_4                -1.365782e-01 1 1  ON 4
 uu_5                -1.422329e-01 1 1  ON 5
 uu_6                -1.181774e-01 1 1  ON 6
 uu_7                -4.891726e-02 1 1  ON 7
 uu_8                 9.201913e-02 1 1  ON 8
 uu_9                 1.289692e-01 1 1  ON 9
 ud_0                 3.676191e-01 1 1  ON 10
 ud_1                 1.018431e-01 1 1  ON 11
 ud_2                -1.479661e-02 1 1  ON 12
 ud_3                -7.817013e-02 1 1  ON 13
 ud_4                -1.260985e-01 1 1  ON 14
 ud_5                -1.573446e-01 1 1  ON 15
 ud_6                -1.596533e-01 1 1  ON 16
 ud_7                -1.155611e-01 1 1  ON 17
 ud_8                -1.227787e-02 1 1  ON 18
 ud_9                 9.220131e-02 1 1  ON 19
 eO_0                -8.052715e-01 1 1  ON 20
 eO_1                -4.728727e-01 1 1  ON 21
 eO_2                -4.467472e-02 1 1  ON 22
 eO_3                 2.219359e-01 1 1  ON 23
 eO_4                 3.202463e-01 1 1  ON 24
 eO_5                 3.303397e-01 1 1  ON 25
 eO_6                 2.615873e-01 1 1  ON 26
 eO_7                 1.263915e-01 1 1  ON 27
 eO_8                 3.036782e-02 1 1  ON 28
 eO_9                 1.976356e-02 1 1  ON 29
eH1_0                -1.855081e-01 1 1  ON 30
eH1_1                -1.059061e-01 1 1  ON 31
eH1_2                -6.309417e-02 1 1  ON 32
eH1_3                -2.531287e-02 1 1  ON 33
eH1_4                 1.919858e-02 1 1  ON 34
eH1_5                 3.186782e-02 1 1  ON 35
eH1_6                 7.750331e-02 1 1  ON 36
eH1_7                 1.082950e-01 1 1  ON 37
eH1_8                 9.893786e-02 1 1  ON 38
eH1_9                 2.746747e-02 1 1  ON 39
eH2_0                -1.869459e-01 1 1  ON 40
eH2_1                -1.072193e-01 1 1  ON 41
eH2_2                -6.429879e-02 1 1  ON 42
eH2_3                -2.660524e-02 1 1  ON 43
eH2_4                 1.798397e-02 1 1  ON 44
eH2_5                 3.130392e-02 1 1  ON 45
eH2_6                 7.798920e-02 1 1  ON 46
eH2_7                 1.124349e-01 1 1  ON 47
eH2_8                 1.026503e-01 1 1  ON 48
eH2_9                 2.901481e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1701
    reference variance = 0.273697
====================================================
  Execution time = 3.6974e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4897e-01
  Total weights = 2.0000e+06
  Execution time = 3.1254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349000810541
                                         uncertainty =       0.008599244263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349000810541
                                         uncertainty =       0.008599244263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417730621
  error estimate for blocks of size 2^( 2) =       0.000428547025
  error estimate for blocks of size 2^( 3) =       0.000438315259
  error estimate for blocks of size 2^( 4) =       0.000445335440
  error estimate for blocks of size 2^( 5) =       0.000449394066
  error estimate for blocks of size 2^( 6) =       0.000452878352
  error estimate for blocks of size 2^( 7) =       0.000455119231

      target function =                  N/A
              le_mean =     -17.211787808710
             les_mean =     296.594637140631
             stat err =       0.000450681772
             autocorr =       1.163984947625
              std dev =       0.590760309315
             le_variance =       0.348997743062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348928644258
                                         uncertainty =       0.008590942750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348928644258
                                         uncertainty =       0.008590942750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417687429
  error estimate for blocks of size 2^( 2) =       0.000428504657
  error estimate for blocks of size 2^( 3) =       0.000438272779
  error estimate for blocks of size 2^( 4) =       0.000445293452
  error estimate for blocks of size 2^( 5) =       0.000449355215
  error estimate for blocks of size 2^( 6) =       0.000452837325
  error estimate for blocks of size 2^( 7) =       0.000455092070

      target function =                  N/A
              le_mean =     -17.211788310291
             les_mean =     296.594582241159
             stat err =       0.000450644516
             autocorr =       1.164033206826
              std dev =       0.590699227493
             le_variance =       0.348925577361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348952770493
                                         uncertainty =       0.008591049015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348952770493
                                         uncertainty =       0.008591049015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417701870
  error estimate for blocks of size 2^( 2) =       0.000428519260
  error estimate for blocks of size 2^( 3) =       0.000438287594
  error estimate for blocks of size 2^( 4) =       0.000445308729
  error estimate for blocks of size 2^( 5) =       0.000449370977
  error estimate for blocks of size 2^( 6) =       0.000452853568
  error estimate for blocks of size 2^( 7) =       0.000455104011

      target function =                  N/A
              le_mean =     -17.211788385589
             les_mean =     296.594608961003
             stat err =       0.000450659321
             autocorr =       1.164029204664
              std dev =       0.590719650249
             le_variance =       0.348949705190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348989184949
                                         uncertainty =       0.008597984604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348989184949
                                         uncertainty =       0.008597984604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417723668
  error estimate for blocks of size 2^( 2) =       0.000428540243
  error estimate for blocks of size 2^( 3) =       0.000438308411
  error estimate for blocks of size 2^( 4) =       0.000445328698
  error estimate for blocks of size 2^( 5) =       0.000449388028
  error estimate for blocks of size 2^( 6) =       0.000452871849
  error estimate for blocks of size 2^( 7) =       0.000455113858

      target function =                  N/A
              le_mean =     -17.211787744698
             les_mean =     296.594623320252
             stat err =       0.000450675608
             autocorr =       1.163991852616
              std dev =       0.590750477123
             le_variance =       0.348986126221


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211787808710        initial
     9.5367e-02     9.5367e-01             1.6291e-03       -17.211788310291
     3.8147e-01     3.8147e+00             4.8189e-04       -17.211788385589  <--
     1.5259e+00     1.5259e+01             1.3337e-04       -17.211787744698

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 5.2705e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.190544e-01 1 1  ON 0
 uu_1                 5.276431e-02 1 1  ON 1
 uu_2                -4.682603e-02 1 1  ON 2
 uu_3                -1.038937e-01 1 1  ON 3
 uu_4                -1.365782e-01 1 1  ON 4
 uu_5                -1.422329e-01 1 1  ON 5
 uu_6                -1.181774e-01 1 1  ON 6
 uu_7                -4.891726e-02 1 1  ON 7
 uu_8                 9.201913e-02 1 1  ON 8
 uu_9                 1.289692e-01 1 1  ON 9
 ud_0                 3.676191e-01 1 1  ON 10
 ud_1                 1.018431e-01 1 1  ON 11
 ud_2                -1.479661e-02 1 1  ON 12
 ud_3                -7.817013e-02 1 1  ON 13
 ud_4                -1.260985e-01 1 1  ON 14
 ud_5                -1.573446e-01 1 1  ON 15
 ud_6                -1.596533e-01 1 1  ON 16
 ud_7                -1.155611e-01 1 1  ON 17
 ud_8                -1.227787e-02 1 1  ON 18
 ud_9                 9.220131e-02 1 1  ON 19
 eO_0                -8.052715e-01 1 1  ON 20
 eO_1                -4.728727e-01 1 1  ON 21
 eO_2                -4.467472e-02 1 1  ON 22
 eO_3                 2.219359e-01 1 1  ON 23
 eO_4                 3.202463e-01 1 1  ON 24
 eO_5                 3.303397e-01 1 1  ON 25
 eO_6                 2.615873e-01 1 1  ON 26
 eO_7                 1.263915e-01 1 1  ON 27
 eO_8                 3.036782e-02 1 1  ON 28
 eO_9                 1.976356e-02 1 1  ON 29
eH1_0                -1.855081e-01 1 1  ON 30
eH1_1                -1.059061e-01 1 1  ON 31
eH1_2                -6.309417e-02 1 1  ON 32
eH1_3                -2.531287e-02 1 1  ON 33
eH1_4                 1.919858e-02 1 1  ON 34
eH1_5                 3.186782e-02 1 1  ON 35
eH1_6                 7.750331e-02 1 1  ON 36
eH1_7                 1.082950e-01 1 1  ON 37
eH1_8                 9.893786e-02 1 1  ON 38
eH1_9                 2.746747e-02 1 1  ON 39
eH2_0                -1.869459e-01 1 1  ON 40
eH2_1                -1.072193e-01 1 1  ON 41
eH2_2                -6.429879e-02 1 1  ON 42
eH2_3                -2.660524e-02 1 1  ON 43
eH2_4                 1.798397e-02 1 1  ON 44
eH2_5                 3.130392e-02 1 1  ON 45
eH2_6                 7.798920e-02 1 1  ON 46
eH2_7                 1.124349e-01 1 1  ON 47
eH2_8                 1.026503e-01 1 1  ON 48
eH2_9                 2.901481e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0095e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1717
    reference variance = 0.327934
====================================================
  Execution time = 3.7702e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5866e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0378e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358621996430
                                         uncertainty =       0.018187086408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358621996430
                                         uncertainty =       0.018187086408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423473356
  error estimate for blocks of size 2^( 2) =       0.000434224262
  error estimate for blocks of size 2^( 3) =       0.000443691801
  error estimate for blocks of size 2^( 4) =       0.000449846707
  error estimate for blocks of size 2^( 5) =       0.000453740127
  error estimate for blocks of size 2^( 6) =       0.000454946326
  error estimate for blocks of size 2^( 7) =       0.000457366290

      target function =                  N/A
              le_mean =     -17.211957368029
             les_mean =     296.610135626470
             stat err =       0.000453974862
             autocorr =       1.149241841216
              std dev =       0.598881763756
             le_variance =       0.358659366960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721195736803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211957368029       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211956907353       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211960528069       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211958885576       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211959079814       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211959311020       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211960575130       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211959701203       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211958870095       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211959103837       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211959194075       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.540613e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211957368029       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211957144380       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211959335360       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211958306916       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211958209382       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211958254678       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211958685543       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211958578360       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211958415245       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.231183e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211957368029       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211957294895       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211958119021       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211957693577       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211957686636       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211957712098       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211957809899       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211957795272       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.110451e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.477675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8089e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.190953e-01 1 1  ON 0
 uu_1                 5.307030e-02 1 1  ON 1
 uu_2                -4.673463e-02 1 1  ON 2
 uu_3                -1.038540e-01 1 1  ON 3
 uu_4                -1.366839e-01 1 1  ON 4
 uu_5                -1.423337e-01 1 1  ON 5
 uu_6                -1.184397e-01 1 1  ON 6
 uu_7                -4.914791e-02 1 1  ON 7
 uu_8                 9.188331e-02 1 1  ON 8
 uu_9                 1.290974e-01 1 1  ON 9
 ud_0                 3.676191e-01 1 1  ON 10
 ud_1                 1.018099e-01 1 1  ON 11
 ud_2                -1.477722e-02 1 1  ON 12
 ud_3                -7.824447e-02 1 1  ON 13
 ud_4                -1.261206e-01 1 1  ON 14
 ud_5                -1.570279e-01 1 1  ON 15
 ud_6                -1.596175e-01 1 1  ON 16
 ud_7                -1.156756e-01 1 1  ON 17
 ud_8                -1.258424e-02 1 1  ON 18
 ud_9                 9.214397e-02 1 1  ON 19
 eO_0                -8.056946e-01 1 1  ON 20
 eO_1                -4.732548e-01 1 1  ON 21
 eO_2                -4.495044e-02 1 1  ON 22
 eO_3                 2.220119e-01 1 1  ON 23
 eO_4                 3.201481e-01 1 1  ON 24
 eO_5                 3.307392e-01 1 1  ON 25
 eO_6                 2.619027e-01 1 1  ON 26
 eO_7                 1.266662e-01 1 1  ON 27
 eO_8                 3.041584e-02 1 1  ON 28
 eO_9                 1.978871e-02 1 1  ON 29
eH1_0                -1.853980e-01 1 1  ON 30
eH1_1                -1.059014e-01 1 1  ON 31
eH1_2                -6.311036e-02 1 1  ON 32
eH1_3                -2.512574e-02 1 1  ON 33
eH1_4                 1.917110e-02 1 1  ON 34
eH1_5                 3.168502e-02 1 1  ON 35
eH1_6                 7.727084e-02 1 1  ON 36
eH1_7                 1.082391e-01 1 1  ON 37
eH1_8                 9.909021e-02 1 1  ON 38
eH1_9                 2.750453e-02 1 1  ON 39
eH2_0                -1.870924e-01 1 1  ON 40
eH2_1                -1.071011e-01 1 1  ON 41
eH2_2                -6.434221e-02 1 1  ON 42
eH2_3                -2.644811e-02 1 1  ON 43
eH2_4                 1.814101e-02 1 1  ON 44
eH2_5                 3.101563e-02 1 1  ON 45
eH2_6                 7.780776e-02 1 1  ON 46
eH2_7                 1.123776e-01 1 1  ON 47
eH2_8                 1.028300e-01 1 1  ON 48
eH2_9                 2.907340e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.178
    reference variance = 0.198456
====================================================
  Execution time = 3.6976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4651e-01
  Total weights = 2.0000e+06
  Execution time = 3.1068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346450345490
                                         uncertainty =       0.006073326285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346450345490
                                         uncertainty =       0.006073326285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416206670
  error estimate for blocks of size 2^( 2) =       0.000426864328
  error estimate for blocks of size 2^( 3) =       0.000436240006
  error estimate for blocks of size 2^( 4) =       0.000442474928
  error estimate for blocks of size 2^( 5) =       0.000447286853
  error estimate for blocks of size 2^( 6) =       0.000451248736
  error estimate for blocks of size 2^( 7) =       0.000452520062

      target function =                  N/A
              le_mean =     -17.212143793882
             les_mean =     296.604349792394
             stat err =       0.000448382645
             autocorr =       1.160591850382
              std dev =       0.588605117515
             le_variance =       0.346455984365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346617818731
                                         uncertainty =       0.006071486967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346617818731
                                         uncertainty =       0.006071486967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416307322
  error estimate for blocks of size 2^( 2) =       0.000426957687
  error estimate for blocks of size 2^( 3) =       0.000436324490
  error estimate for blocks of size 2^( 4) =       0.000442553169
  error estimate for blocks of size 2^( 5) =       0.000447357953
  error estimate for blocks of size 2^( 6) =       0.000451320258
  error estimate for blocks of size 2^( 7) =       0.000452580894

      target function =                  N/A
              le_mean =     -17.212144759700
             les_mean =     296.604550628300
             stat err =       0.000448453069
             autocorr =       1.160395141016
              std dev =       0.588747460924
             le_variance =       0.346623572745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346556098317
                                         uncertainty =       0.006066449161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346556098317
                                         uncertainty =       0.006066449161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416270298
  error estimate for blocks of size 2^( 2) =       0.000426922565
  error estimate for blocks of size 2^( 3) =       0.000436291515
  error estimate for blocks of size 2^( 4) =       0.000442522076
  error estimate for blocks of size 2^( 5) =       0.000447326155
  error estimate for blocks of size 2^( 6) =       0.000451290283
  error estimate for blocks of size 2^( 7) =       0.000452552651

      target function =                  N/A
              le_mean =     -17.212145240655
             les_mean =     296.604505534776
             stat err =       0.000448422791
             autocorr =       1.160444852797
              std dev =       0.588695101605
             le_variance =       0.346561922653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346463726332
                                         uncertainty =       0.006071178346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346463726332
                                         uncertainty =       0.006071178346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416214734
  error estimate for blocks of size 2^( 2) =       0.000426871549
  error estimate for blocks of size 2^( 3) =       0.000436246094
  error estimate for blocks of size 2^( 4) =       0.000442480385
  error estimate for blocks of size 2^( 5) =       0.000447290745
  error estimate for blocks of size 2^( 6) =       0.000451253157
  error estimate for blocks of size 2^( 7) =       0.000452522968

      target function =                  N/A
              le_mean =     -17.212143947375
             les_mean =     296.604368502162
             stat err =       0.000448386814
             autocorr =       1.160568459016
              std dev =       0.588616522228
             le_variance =       0.346469410239


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212143793882        initial
     9.5367e-02     9.5367e-01             1.5406e-03       -17.212144759700
     3.8147e-01     3.8147e+00             4.2312e-04       -17.212145240655  <--
     1.5259e+00     1.5259e+01             1.1105e-04       -17.212143947375

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 5.6194e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.190953e-01 1 1  ON 0
 uu_1                 5.307030e-02 1 1  ON 1
 uu_2                -4.673463e-02 1 1  ON 2
 uu_3                -1.038540e-01 1 1  ON 3
 uu_4                -1.366839e-01 1 1  ON 4
 uu_5                -1.423337e-01 1 1  ON 5
 uu_6                -1.184397e-01 1 1  ON 6
 uu_7                -4.914791e-02 1 1  ON 7
 uu_8                 9.188331e-02 1 1  ON 8
 uu_9                 1.290974e-01 1 1  ON 9
 ud_0                 3.676191e-01 1 1  ON 10
 ud_1                 1.018099e-01 1 1  ON 11
 ud_2                -1.477722e-02 1 1  ON 12
 ud_3                -7.824447e-02 1 1  ON 13
 ud_4                -1.261206e-01 1 1  ON 14
 ud_5                -1.570279e-01 1 1  ON 15
 ud_6                -1.596175e-01 1 1  ON 16
 ud_7                -1.156756e-01 1 1  ON 17
 ud_8                -1.258424e-02 1 1  ON 18
 ud_9                 9.214397e-02 1 1  ON 19
 eO_0                -8.056946e-01 1 1  ON 20
 eO_1                -4.732548e-01 1 1  ON 21
 eO_2                -4.495044e-02 1 1  ON 22
 eO_3                 2.220119e-01 1 1  ON 23
 eO_4                 3.201481e-01 1 1  ON 24
 eO_5                 3.307392e-01 1 1  ON 25
 eO_6                 2.619027e-01 1 1  ON 26
 eO_7                 1.266662e-01 1 1  ON 27
 eO_8                 3.041584e-02 1 1  ON 28
 eO_9                 1.978871e-02 1 1  ON 29
eH1_0                -1.853980e-01 1 1  ON 30
eH1_1                -1.059014e-01 1 1  ON 31
eH1_2                -6.311036e-02 1 1  ON 32
eH1_3                -2.512574e-02 1 1  ON 33
eH1_4                 1.917110e-02 1 1  ON 34
eH1_5                 3.168502e-02 1 1  ON 35
eH1_6                 7.727084e-02 1 1  ON 36
eH1_7                 1.082391e-01 1 1  ON 37
eH1_8                 9.909021e-02 1 1  ON 38
eH1_9                 2.750453e-02 1 1  ON 39
eH2_0                -1.870924e-01 1 1  ON 40
eH2_1                -1.071011e-01 1 1  ON 41
eH2_2                -6.434221e-02 1 1  ON 42
eH2_3                -2.644811e-02 1 1  ON 43
eH2_4                 1.814101e-02 1 1  ON 44
eH2_5                 3.101563e-02 1 1  ON 45
eH2_6                 7.780776e-02 1 1  ON 46
eH2_7                 1.123776e-01 1 1  ON 47
eH2_8                 1.028300e-01 1 1  ON 48
eH2_9                 2.907340e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0430e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1887
    reference variance = 0.156558
====================================================
  Execution time = 3.8077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4142e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0567e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341358719079
                                         uncertainty =       0.003722866385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341358719079
                                         uncertainty =       0.003722866385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413171180
  error estimate for blocks of size 2^( 2) =       0.000423726163
  error estimate for blocks of size 2^( 3) =       0.000432564852
  error estimate for blocks of size 2^( 4) =       0.000439236914
  error estimate for blocks of size 2^( 5) =       0.000443115992
  error estimate for blocks of size 2^( 6) =       0.000445145679
  error estimate for blocks of size 2^( 7) =       0.000445575824

      target function =                  N/A
              le_mean =     -17.211545550270
             les_mean =     296.578720905492
             stat err =       0.000443268602
             autocorr =       1.150996229009
              std dev =       0.584312285668
             le_variance =       0.341420847182


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721154555027e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211545550270       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211545382511       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211545949133       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211546658856       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211549304130       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211548430846       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211548853108       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211548932354       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211548958920       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211549603511       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211549369909       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.645576e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211545550270       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211545474165       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211545741648       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211546004673       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211547142393       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211546796165       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211546849092       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211546768080       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211546756965       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.184519e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211545550270       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211545526378       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211545612418       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211545682430       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211546044391       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211545949614       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211545947291       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.150200e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.482228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8655e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.192439e-01 1 1  ON 0
 uu_1                 5.320161e-02 1 1  ON 1
 uu_2                -4.659936e-02 1 1  ON 2
 uu_3                -1.038729e-01 1 1  ON 3
 uu_4                -1.366825e-01 1 1  ON 4
 uu_5                -1.422763e-01 1 1  ON 5
 uu_6                -1.186664e-01 1 1  ON 6
 uu_7                -4.939814e-02 1 1  ON 7
 uu_8                 9.162333e-02 1 1  ON 8
 uu_9                 1.291857e-01 1 1  ON 9
 ud_0                 3.675909e-01 1 1  ON 10
 ud_1                 1.018250e-01 1 1  ON 11
 ud_2                -1.473760e-02 1 1  ON 12
 ud_3                -7.823337e-02 1 1  ON 13
 ud_4                -1.260826e-01 1 1  ON 14
 ud_5                -1.570789e-01 1 1  ON 15
 ud_6                -1.594170e-01 1 1  ON 16
 ud_7                -1.157823e-01 1 1  ON 17
 ud_8                -1.285380e-02 1 1  ON 18
 ud_9                 9.214671e-02 1 1  ON 19
 eO_0                -8.060838e-01 1 1  ON 20
 eO_1                -4.736732e-01 1 1  ON 21
 eO_2                -4.528102e-02 1 1  ON 22
 eO_3                 2.219126e-01 1 1  ON 23
 eO_4                 3.202639e-01 1 1  ON 24
 eO_5                 3.311527e-01 1 1  ON 25
 eO_6                 2.622138e-01 1 1  ON 26
 eO_7                 1.269774e-01 1 1  ON 27
 eO_8                 3.045529e-02 1 1  ON 28
 eO_9                 1.981471e-02 1 1  ON 29
eH1_0                -1.852645e-01 1 1  ON 30
eH1_1                -1.061528e-01 1 1  ON 31
eH1_2                -6.329437e-02 1 1  ON 32
eH1_3                -2.526354e-02 1 1  ON 33
eH1_4                 1.928691e-02 1 1  ON 34
eH1_5                 3.182618e-02 1 1  ON 35
eH1_6                 7.719393e-02 1 1  ON 36
eH1_7                 1.082320e-01 1 1  ON 37
eH1_8                 9.927452e-02 1 1  ON 38
eH1_9                 2.756121e-02 1 1  ON 39
eH2_0                -1.871005e-01 1 1  ON 40
eH2_1                -1.070462e-01 1 1  ON 41
eH2_2                -6.443444e-02 1 1  ON 42
eH2_3                -2.643110e-02 1 1  ON 43
eH2_4                 1.817459e-02 1 1  ON 44
eH2_5                 3.093223e-02 1 1  ON 45
eH2_6                 7.769834e-02 1 1  ON 46
eH2_7                 1.123227e-01 1 1  ON 47
eH2_8                 1.029993e-01 1 1  ON 48
eH2_9                 2.912337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.196
    reference variance = 0.240816
====================================================
  Execution time = 3.6956e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.3808e-01
  Total weights = 2.0000e+06
  Execution time = 3.1135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338161368628
                                         uncertainty =       0.002974197401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338161368628
                                         uncertainty =       0.002974197401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411148189
  error estimate for blocks of size 2^( 2) =       0.000421245910
  error estimate for blocks of size 2^( 3) =       0.000430445721
  error estimate for blocks of size 2^( 4) =       0.000437140077
  error estimate for blocks of size 2^( 5) =       0.000441607522
  error estimate for blocks of size 2^( 6) =       0.000444067269
  error estimate for blocks of size 2^( 7) =       0.000445819909

      target function =                  N/A
              le_mean =     -17.212630715517
             les_mean =     296.612741646745
             stat err =       0.000442158694
             autocorr =       1.156537113780
              std dev =       0.581451345365
             le_variance =       0.338085667027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338203308950
                                         uncertainty =       0.002973156639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338203308950
                                         uncertainty =       0.002973156639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411173750
  error estimate for blocks of size 2^( 2) =       0.000421269658
  error estimate for blocks of size 2^( 3) =       0.000430463437
  error estimate for blocks of size 2^( 4) =       0.000437151476
  error estimate for blocks of size 2^( 5) =       0.000441610698
  error estimate for blocks of size 2^( 6) =       0.000444069725
  error estimate for blocks of size 2^( 7) =       0.000445814061

      target function =                  N/A
              le_mean =     -17.212632386579
             les_mean =     296.612841211230
             stat err =       0.000442161490
             autocorr =       1.156407951363
              std dev =       0.581487493235
             le_variance =       0.338127704788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338147136585
                                         uncertainty =       0.002972982159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338147136585
                                         uncertainty =       0.002972982159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411139596
  error estimate for blocks of size 2^( 2) =       0.000421237116
  error estimate for blocks of size 2^( 3) =       0.000430433249
  error estimate for blocks of size 2^( 4) =       0.000437123856
  error estimate for blocks of size 2^( 5) =       0.000441584526
  error estimate for blocks of size 2^( 6) =       0.000444044688
  error estimate for blocks of size 2^( 7) =       0.000445790081

      target function =                  N/A
              le_mean =     -17.212632913835
             les_mean =     296.612803192097
             stat err =       0.000442135788
             autocorr =       1.156465627939
              std dev =       0.581439192606
             le_variance =       0.338071534698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338144460771
                                         uncertainty =       0.002973909451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338144460771
                                         uncertainty =       0.002973909451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411137920
  error estimate for blocks of size 2^( 2) =       0.000421235992
  error estimate for blocks of size 2^( 3) =       0.000430435635
  error estimate for blocks of size 2^( 4) =       0.000437129722
  error estimate for blocks of size 2^( 5) =       0.000441596063
  error estimate for blocks of size 2^( 6) =       0.000444056186
  error estimate for blocks of size 2^( 7) =       0.000445807544

      target function =                  N/A
              le_mean =     -17.212631078548
             les_mean =     296.612737256014
             stat err =       0.000442147379
             autocorr =       1.156535691351
              std dev =       0.581436822747
             le_variance =       0.338068778846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212630715517        initial
     9.5367e-02     9.5367e-01             1.6456e-03       -17.212632386579
     3.8147e-01     3.8147e+00             4.1845e-04       -17.212632913835  <--
     1.5259e+00     1.5259e+01             1.1502e-04       -17.212631078548

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 5.2595e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.192439e-01 1 1  ON 0
 uu_1                 5.320161e-02 1 1  ON 1
 uu_2                -4.659936e-02 1 1  ON 2
 uu_3                -1.038729e-01 1 1  ON 3
 uu_4                -1.366825e-01 1 1  ON 4
 uu_5                -1.422763e-01 1 1  ON 5
 uu_6                -1.186664e-01 1 1  ON 6
 uu_7                -4.939814e-02 1 1  ON 7
 uu_8                 9.162333e-02 1 1  ON 8
 uu_9                 1.291857e-01 1 1  ON 9
 ud_0                 3.675909e-01 1 1  ON 10
 ud_1                 1.018250e-01 1 1  ON 11
 ud_2                -1.473760e-02 1 1  ON 12
 ud_3                -7.823337e-02 1 1  ON 13
 ud_4                -1.260826e-01 1 1  ON 14
 ud_5                -1.570789e-01 1 1  ON 15
 ud_6                -1.594170e-01 1 1  ON 16
 ud_7                -1.157823e-01 1 1  ON 17
 ud_8                -1.285380e-02 1 1  ON 18
 ud_9                 9.214671e-02 1 1  ON 19
 eO_0                -8.060838e-01 1 1  ON 20
 eO_1                -4.736732e-01 1 1  ON 21
 eO_2                -4.528102e-02 1 1  ON 22
 eO_3                 2.219126e-01 1 1  ON 23
 eO_4                 3.202639e-01 1 1  ON 24
 eO_5                 3.311527e-01 1 1  ON 25
 eO_6                 2.622138e-01 1 1  ON 26
 eO_7                 1.269774e-01 1 1  ON 27
 eO_8                 3.045529e-02 1 1  ON 28
 eO_9                 1.981471e-02 1 1  ON 29
eH1_0                -1.852645e-01 1 1  ON 30
eH1_1                -1.061528e-01 1 1  ON 31
eH1_2                -6.329437e-02 1 1  ON 32
eH1_3                -2.526354e-02 1 1  ON 33
eH1_4                 1.928691e-02 1 1  ON 34
eH1_5                 3.182618e-02 1 1  ON 35
eH1_6                 7.719393e-02 1 1  ON 36
eH1_7                 1.082320e-01 1 1  ON 37
eH1_8                 9.927452e-02 1 1  ON 38
eH1_9                 2.756121e-02 1 1  ON 39
eH2_0                -1.871005e-01 1 1  ON 40
eH2_1                -1.070462e-01 1 1  ON 41
eH2_2                -6.443444e-02 1 1  ON 42
eH2_3                -2.643110e-02 1 1  ON 43
eH2_4                 1.817459e-02 1 1  ON 44
eH2_5                 3.093223e-02 1 1  ON 45
eH2_6                 7.769834e-02 1 1  ON 46
eH2_7                 1.123227e-01 1 1  ON 47
eH2_8                 1.029993e-01 1 1  ON 48
eH2_9                 2.912337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0141e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.281
    reference variance = 0.543464
====================================================
  Execution time = 3.7569e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3917e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0441e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339103473913
                                         uncertainty =       0.003968369011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339103473913
                                         uncertainty =       0.003968369011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411806584
  error estimate for blocks of size 2^( 2) =       0.000422555651
  error estimate for blocks of size 2^( 3) =       0.000432388898
  error estimate for blocks of size 2^( 4) =       0.000440201630
  error estimate for blocks of size 2^( 5) =       0.000444575345
  error estimate for blocks of size 2^( 6) =       0.000446332720
  error estimate for blocks of size 2^( 7) =       0.000446902575

      target function =                  N/A
              le_mean =     -17.212217281777
             les_mean =     296.599592911513
             stat err =       0.000444503067
             autocorr =       1.165099328127
              std dev =       0.582382456805
             le_variance =       0.339169325995


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721221728178e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212217281777       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212218975529       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212216939866       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212215246869       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212216709707       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212215757681       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212216940592       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212216961962       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212217076068       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212217288328       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212217670189       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.648608e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212217281777       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212218101522       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212216618616       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212216419696       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212216990960       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212216792516       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212217182876       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212216925097       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212216884955       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.666510e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212217281777       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212217549311       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212217004663       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212217085111       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212217125014       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212217106467       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212217205296       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.318811e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.486677 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8020e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.193791e-01 1 1  ON 0
 uu_1                 5.315693e-02 1 1  ON 1
 uu_2                -4.659793e-02 1 1  ON 2
 uu_3                -1.037931e-01 1 1  ON 3
 uu_4                -1.366598e-01 1 1  ON 4
 uu_5                -1.423375e-01 1 1  ON 5
 uu_6                -1.186394e-01 1 1  ON 6
 uu_7                -4.957514e-02 1 1  ON 7
 uu_8                 9.135602e-02 1 1  ON 8
 uu_9                 1.293065e-01 1 1  ON 9
 ud_0                 3.676952e-01 1 1  ON 10
 ud_1                 1.017689e-01 1 1  ON 11
 ud_2                -1.465643e-02 1 1  ON 12
 ud_3                -7.807093e-02 1 1  ON 13
 ud_4                -1.259580e-01 1 1  ON 14
 ud_5                -1.569582e-01 1 1  ON 15
 ud_6                -1.595565e-01 1 1  ON 16
 ud_7                -1.159282e-01 1 1  ON 17
 ud_8                -1.313379e-02 1 1  ON 18
 ud_9                 9.207572e-02 1 1  ON 19
 eO_0                -8.062985e-01 1 1  ON 20
 eO_1                -4.738346e-01 1 1  ON 21
 eO_2                -4.565520e-02 1 1  ON 22
 eO_3                 2.214459e-01 1 1  ON 23
 eO_4                 3.203422e-01 1 1  ON 24
 eO_5                 3.315752e-01 1 1  ON 25
 eO_6                 2.625609e-01 1 1  ON 26
 eO_7                 1.273009e-01 1 1  ON 27
 eO_8                 3.048184e-02 1 1  ON 28
 eO_9                 1.982254e-02 1 1  ON 29
eH1_0                -1.853804e-01 1 1  ON 30
eH1_1                -1.059886e-01 1 1  ON 31
eH1_2                -6.327037e-02 1 1  ON 32
eH1_3                -2.518119e-02 1 1  ON 33
eH1_4                 1.918993e-02 1 1  ON 34
eH1_5                 3.161897e-02 1 1  ON 35
eH1_6                 7.708550e-02 1 1  ON 36
eH1_7                 1.082508e-01 1 1  ON 37
eH1_8                 9.944818e-02 1 1  ON 38
eH1_9                 2.761490e-02 1 1  ON 39
eH2_0                -1.869018e-01 1 1  ON 40
eH2_1                -1.071870e-01 1 1  ON 41
eH2_2                -6.446287e-02 1 1  ON 42
eH2_3                -2.658157e-02 1 1  ON 43
eH2_4                 1.810106e-02 1 1  ON 44
eH2_5                 3.098849e-02 1 1  ON 45
eH2_6                 7.757130e-02 1 1  ON 46
eH2_7                 1.123509e-01 1 1  ON 47
eH2_8                 1.031788e-01 1 1  ON 48
eH2_9                 2.917168e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2121
    reference variance = 0.18444
====================================================
  Execution time = 3.6927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4066e-01
  Total weights = 2.0000e+06
  Execution time = 3.0946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340545859283
                                         uncertainty =       0.002785155002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340545859283
                                         uncertainty =       0.002785155002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412666314
  error estimate for blocks of size 2^( 2) =       0.000423147855
  error estimate for blocks of size 2^( 3) =       0.000432523949
  error estimate for blocks of size 2^( 4) =       0.000440563919
  error estimate for blocks of size 2^( 5) =       0.000445469585
  error estimate for blocks of size 2^( 6) =       0.000448343931
  error estimate for blocks of size 2^( 7) =       0.000450977519

      target function =                  N/A
              le_mean =     -17.212450912623
             les_mean =     296.609053223402
             stat err =       0.000446338738
             autocorr =       1.169852544970
              std dev =       0.583598298698
             le_variance =       0.340586974243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340560266967
                                         uncertainty =       0.002785524342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340560266967
                                         uncertainty =       0.002785524342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412675055
  error estimate for blocks of size 2^( 2) =       0.000423156667
  error estimate for blocks of size 2^( 3) =       0.000432533531
  error estimate for blocks of size 2^( 4) =       0.000440575839
  error estimate for blocks of size 2^( 5) =       0.000445482062
  error estimate for blocks of size 2^( 6) =       0.000448357426
  error estimate for blocks of size 2^( 7) =       0.000450998936

      target function =                  N/A
              le_mean =     -17.212451332372
             les_mean =     296.609082100560
             stat err =       0.000446353566
             autocorr =       1.169880714459
              std dev =       0.583610659232
             le_variance =       0.340601401569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340690333659
                                         uncertainty =       0.002786792737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340690333659
                                         uncertainty =       0.002786792737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412753861
  error estimate for blocks of size 2^( 2) =       0.000423233393
  error estimate for blocks of size 2^( 3) =       0.000432608050
  error estimate for blocks of size 2^( 4) =       0.000440649303
  error estimate for blocks of size 2^( 5) =       0.000445556631
  error estimate for blocks of size 2^( 6) =       0.000448432637
  error estimate for blocks of size 2^( 7) =       0.000451076678

      target function =                  N/A
              le_mean =     -17.212450948716
             les_mean =     296.609198991381
             stat err =       0.000446428813
             autocorr =       1.169828353646
              std dev =       0.583722108374
             le_variance =       0.340731499805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340594353150
                                         uncertainty =       0.002785610317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340594353150
                                         uncertainty =       0.002785610317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412695699
  error estimate for blocks of size 2^( 2) =       0.000423176307
  error estimate for blocks of size 2^( 3) =       0.000432551566
  error estimate for blocks of size 2^( 4) =       0.000440591396
  error estimate for blocks of size 2^( 5) =       0.000445497220
  error estimate for blocks of size 2^( 6) =       0.000448371733
  error estimate for blocks of size 2^( 7) =       0.000451007451

      target function =                  N/A
              le_mean =     -17.212450768115
             les_mean =     296.609096754805
             stat err =       0.000446366950
             autocorr =       1.169833829231
              std dev =       0.583639855003
             le_variance =       0.340635480348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212450912623        initial
     9.5367e-02     9.5367e-01             1.6486e-03       -17.212451332372  <--
     3.8147e-01     3.8147e+00             4.6665e-04       -17.212450948716
     1.5259e+00     1.5259e+01             1.3188e-04       -17.212450768115

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 5.2539e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.194495e-01 1 1  ON 0
 uu_1                 5.318172e-02 1 1  ON 1
 uu_2                -4.653058e-02 1 1  ON 2
 uu_3                -1.036603e-01 1 1  ON 3
 uu_4                -1.365376e-01 1 1  ON 4
 uu_5                -1.423852e-01 1 1  ON 5
 uu_6                -1.185927e-01 1 1  ON 6
 uu_7                -5.005695e-02 1 1  ON 7
 uu_8                 9.057626e-02 1 1  ON 8
 uu_9                 1.296653e-01 1 1  ON 9
 ud_0                 3.678524e-01 1 1  ON 10
 ud_1                 1.019272e-01 1 1  ON 11
 ud_2                -1.442653e-02 1 1  ON 12
 ud_3                -7.775164e-02 1 1  ON 13
 ud_4                -1.256921e-01 1 1  ON 14
 ud_5                -1.567668e-01 1 1  ON 15
 ud_6                -1.597659e-01 1 1  ON 16
 ud_7                -1.163030e-01 1 1  ON 17
 ud_8                -1.395557e-02 1 1  ON 18
 ud_9                 9.186460e-02 1 1  ON 19
 eO_0                -8.070784e-01 1 1  ON 20
 eO_1                -4.745780e-01 1 1  ON 21
 eO_2                -4.662836e-02 1 1  ON 22
 eO_3                 2.205099e-01 1 1  ON 23
 eO_4                 3.203869e-01 1 1  ON 24
 eO_5                 3.328013e-01 1 1  ON 25
 eO_6                 2.636169e-01 1 1  ON 26
 eO_7                 1.282709e-01 1 1  ON 27
 eO_8                 3.056151e-02 1 1  ON 28
 eO_9                 1.984572e-02 1 1  ON 29
eH1_0                -1.854357e-01 1 1  ON 30
eH1_1                -1.058282e-01 1 1  ON 31
eH1_2                -6.323804e-02 1 1  ON 32
eH1_3                -2.512932e-02 1 1  ON 33
eH1_4                 1.911485e-02 1 1  ON 34
eH1_5                 3.110020e-02 1 1  ON 35
eH1_6                 7.672097e-02 1 1  ON 36
eH1_7                 1.083046e-01 1 1  ON 37
eH1_8                 9.996753e-02 1 1  ON 38
eH1_9                 2.777542e-02 1 1  ON 39
eH2_0                -1.867334e-01 1 1  ON 40
eH2_1                -1.073594e-01 1 1  ON 41
eH2_2                -6.458156e-02 1 1  ON 42
eH2_3                -2.682204e-02 1 1  ON 43
eH2_4                 1.797515e-02 1 1  ON 44
eH2_5                 3.103936e-02 1 1  ON 45
eH2_6                 7.720366e-02 1 1  ON 46
eH2_7                 1.124475e-01 1 1  ON 47
eH2_8                 1.037157e-01 1 1  ON 48
eH2_9                 2.931608e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0057e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2246
    reference variance = 0.211059
====================================================
  Execution time = 3.7859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3907e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0423e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339045507035
                                         uncertainty =       0.003689456299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339045507035
                                         uncertainty =       0.003689456299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411745001
  error estimate for blocks of size 2^( 2) =       0.000422613231
  error estimate for blocks of size 2^( 3) =       0.000431237932
  error estimate for blocks of size 2^( 4) =       0.000438378359
  error estimate for blocks of size 2^( 5) =       0.000442068972
  error estimate for blocks of size 2^( 6) =       0.000445468635
  error estimate for blocks of size 2^( 7) =       0.000446827904

      target function =                  N/A
              le_mean =     -17.212176199234
             les_mean =     296.598077234929
             stat err =       0.000443185968
             autocorr =       1.158551470683
              std dev =       0.582295364045
             le_variance =       0.339067890988


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721217619923e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212176199234       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212176977906       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212178648384       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212180570349       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212181392581       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212182815974       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212183114887       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212182937353       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212186256255       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212184543448       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212183854369       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212184700931       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.212185074812       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.212185524635       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.212184939777       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 5.996920e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212176199234       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212176854218       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212178052534       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212179371525       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212180277161       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212181100213       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212180728710       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212180306383       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212181327045       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212180713355       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212180635662       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.703527e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212176199234       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212176599743       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212177182630       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212177726021       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212178413081       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212178813558       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212178367947       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212178287375       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212178409381       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.411173e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.493489 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8294e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.200078e-01 1 1  ON 0
 uu_1                 5.345536e-02 1 1  ON 1
 uu_2                -4.628792e-02 1 1  ON 2
 uu_3                -1.035480e-01 1 1  ON 3
 uu_4                -1.365377e-01 1 1  ON 4
 uu_5                -1.428920e-01 1 1  ON 5
 uu_6                -1.198378e-01 1 1  ON 6
 uu_7                -5.032673e-02 1 1  ON 7
 uu_8                 9.004582e-02 1 1  ON 8
 uu_9                 1.302720e-01 1 1  ON 9
 ud_0                 3.678557e-01 1 1  ON 10
 ud_1                 1.020523e-01 1 1  ON 11
 ud_2                -1.459851e-02 1 1  ON 12
 ud_3                -7.794470e-02 1 1  ON 13
 ud_4                -1.255927e-01 1 1  ON 14
 ud_5                -1.571396e-01 1 1  ON 15
 ud_6                -1.595356e-01 1 1  ON 16
 ud_7                -1.160259e-01 1 1  ON 17
 ud_8                -1.472604e-02 1 1  ON 18
 ud_9                 9.190608e-02 1 1  ON 19
 eO_0                -8.087819e-01 1 1  ON 20
 eO_1                -4.759969e-01 1 1  ON 21
 eO_2                -4.763354e-02 1 1  ON 22
 eO_3                 2.203803e-01 1 1  ON 23
 eO_4                 3.204083e-01 1 1  ON 24
 eO_5                 3.337315e-01 1 1  ON 25
 eO_6                 2.649974e-01 1 1  ON 26
 eO_7                 1.297573e-01 1 1  ON 27
 eO_8                 3.084068e-02 1 1  ON 28
 eO_9                 1.993283e-02 1 1  ON 29
eH1_0                -1.849263e-01 1 1  ON 30
eH1_1                -1.060566e-01 1 1  ON 31
eH1_2                -6.337589e-02 1 1  ON 32
eH1_3                -2.554820e-02 1 1  ON 33
eH1_4                 1.884207e-02 1 1  ON 34
eH1_5                 3.144546e-02 1 1  ON 35
eH1_6                 7.603955e-02 1 1  ON 36
eH1_7                 1.081314e-01 1 1  ON 37
eH1_8                 1.007006e-01 1 1  ON 38
eH1_9                 2.800296e-02 1 1  ON 39
eH2_0                -1.869885e-01 1 1  ON 40
eH2_1                -1.071288e-01 1 1  ON 41
eH2_2                -6.441692e-02 1 1  ON 42
eH2_3                -2.679219e-02 1 1  ON 43
eH2_4                 1.788640e-02 1 1  ON 44
eH2_5                 3.037967e-02 1 1  ON 45
eH2_6                 7.676930e-02 1 1  ON 46
eH2_7                 1.123572e-01 1 1  ON 47
eH2_8                 1.044841e-01 1 1  ON 48
eH2_9                 2.956983e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2033
    reference variance = 0.527117
====================================================
  Execution time = 3.6660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.7510e-01
  Total weights = 2.0000e+06
  Execution time = 3.1079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.374895983979
                                         uncertainty =       0.033799258421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.374895983979
                                         uncertainty =       0.033799258421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000432941587
  error estimate for blocks of size 2^( 2) =       0.000442869412
  error estimate for blocks of size 2^( 3) =       0.000451822939
  error estimate for blocks of size 2^( 4) =       0.000458578390
  error estimate for blocks of size 2^( 5) =       0.000462111705
  error estimate for blocks of size 2^( 6) =       0.000465734185
  error estimate for blocks of size 2^( 7) =       0.000467026680

      target function =                  N/A
              le_mean =     -17.212597235570
             les_mean =     296.648380241860
             stat err =       0.000463362740
             autocorr =       1.145469704694
              std dev =       0.612271863906
             le_variance =       0.374876835331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375348793447
                                         uncertainty =       0.033867225259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375348793447
                                         uncertainty =       0.033867225259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433202929
  error estimate for blocks of size 2^( 2) =       0.000443120621
  error estimate for blocks of size 2^( 3) =       0.000452056573
  error estimate for blocks of size 2^( 4) =       0.000458799423
  error estimate for blocks of size 2^( 5) =       0.000462312957
  error estimate for blocks of size 2^( 6) =       0.000465937704
  error estimate for blocks of size 2^( 7) =       0.000467218832

      target function =                  N/A
              le_mean =     -17.212603852947
             les_mean =     296.649060766787
             stat err =       0.000463567229
             autocorr =       1.145098074146
              std dev =       0.612641457917
             le_variance =       0.375329555958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375359876431
                                         uncertainty =       0.033860959793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375359876431
                                         uncertainty =       0.033860959793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433209293
  error estimate for blocks of size 2^( 2) =       0.000443125316
  error estimate for blocks of size 2^( 3) =       0.000452061046
  error estimate for blocks of size 2^( 4) =       0.000458805855
  error estimate for blocks of size 2^( 5) =       0.000462318404
  error estimate for blocks of size 2^( 6) =       0.000465950162
  error estimate for blocks of size 2^( 7) =       0.000467228199

      target function =                  N/A
              le_mean =     -17.212605412262
             les_mean =     296.649125473131
             stat err =       0.000463575655
             autocorr =       1.145106060911
              std dev =       0.612650457078
             le_variance =       0.375340582558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.374945960473
                                         uncertainty =       0.033806420240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.374945960473
                                         uncertainty =       0.033806420240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000432970422
  error estimate for blocks of size 2^( 2) =       0.000442896179
  error estimate for blocks of size 2^( 3) =       0.000451846814
  error estimate for blocks of size 2^( 4) =       0.000458600830
  error estimate for blocks of size 2^( 5) =       0.000462129490
  error estimate for blocks of size 2^( 6) =       0.000465755716
  error estimate for blocks of size 2^( 7) =       0.000467044789

      target function =                  N/A
              le_mean =     -17.212598978828
             les_mean =     296.648490191999
             stat err =       0.000463382706
             autocorr =       1.145415839460
              std dev =       0.612312643591
             le_variance =       0.374926773502


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212597235570        initial
     2.3842e-02     2.3842e-01             5.9969e-03       -17.212603852947
     9.5367e-02     9.5367e-01             1.7035e-03       -17.212605412262  <--
     3.8147e-01     3.8147e+00             4.4112e-04       -17.212598978828

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 5.6078e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.200078e-01 1 1  ON 0
 uu_1                 5.345536e-02 1 1  ON 1
 uu_2                -4.628792e-02 1 1  ON 2
 uu_3                -1.035480e-01 1 1  ON 3
 uu_4                -1.365377e-01 1 1  ON 4
 uu_5                -1.428920e-01 1 1  ON 5
 uu_6                -1.198378e-01 1 1  ON 6
 uu_7                -5.032673e-02 1 1  ON 7
 uu_8                 9.004582e-02 1 1  ON 8
 uu_9                 1.302720e-01 1 1  ON 9
 ud_0                 3.678557e-01 1 1  ON 10
 ud_1                 1.020523e-01 1 1  ON 11
 ud_2                -1.459851e-02 1 1  ON 12
 ud_3                -7.794470e-02 1 1  ON 13
 ud_4                -1.255927e-01 1 1  ON 14
 ud_5                -1.571396e-01 1 1  ON 15
 ud_6                -1.595356e-01 1 1  ON 16
 ud_7                -1.160259e-01 1 1  ON 17
 ud_8                -1.472604e-02 1 1  ON 18
 ud_9                 9.190608e-02 1 1  ON 19
 eO_0                -8.087819e-01 1 1  ON 20
 eO_1                -4.759969e-01 1 1  ON 21
 eO_2                -4.763354e-02 1 1  ON 22
 eO_3                 2.203803e-01 1 1  ON 23
 eO_4                 3.204083e-01 1 1  ON 24
 eO_5                 3.337315e-01 1 1  ON 25
 eO_6                 2.649974e-01 1 1  ON 26
 eO_7                 1.297573e-01 1 1  ON 27
 eO_8                 3.084068e-02 1 1  ON 28
 eO_9                 1.993283e-02 1 1  ON 29
eH1_0                -1.849263e-01 1 1  ON 30
eH1_1                -1.060566e-01 1 1  ON 31
eH1_2                -6.337589e-02 1 1  ON 32
eH1_3                -2.554820e-02 1 1  ON 33
eH1_4                 1.884207e-02 1 1  ON 34
eH1_5                 3.144546e-02 1 1  ON 35
eH1_6                 7.603955e-02 1 1  ON 36
eH1_7                 1.081314e-01 1 1  ON 37
eH1_8                 1.007006e-01 1 1  ON 38
eH1_9                 2.800296e-02 1 1  ON 39
eH2_0                -1.869885e-01 1 1  ON 40
eH2_1                -1.071288e-01 1 1  ON 41
eH2_2                -6.441692e-02 1 1  ON 42
eH2_3                -2.679219e-02 1 1  ON 43
eH2_4                 1.788640e-02 1 1  ON 44
eH2_5                 3.037967e-02 1 1  ON 45
eH2_6                 7.676930e-02 1 1  ON 46
eH2_7                 1.123572e-01 1 1  ON 47
eH2_8                 1.044841e-01 1 1  ON 48
eH2_9                 2.956983e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0438e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.11
    reference variance = 0.387794
====================================================
  Execution time = 3.8352e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4752e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0581e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347356081228
                                         uncertainty =       0.005243777488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347356081228
                                         uncertainty =       0.005243777488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416846002
  error estimate for blocks of size 2^( 2) =       0.000427344767
  error estimate for blocks of size 2^( 3) =       0.000436590726
  error estimate for blocks of size 2^( 4) =       0.000443125317
  error estimate for blocks of size 2^( 5) =       0.000447144041
  error estimate for blocks of size 2^( 6) =       0.000450188012
  error estimate for blocks of size 2^( 7) =       0.000452731381

      target function =                  N/A
              le_mean =     -17.212033081811
             les_mean =     296.601603815145
             stat err =       0.000448297188
             autocorr =       1.156593499354
              std dev =       0.589509270101
             le_variance =       0.347521179536


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721203308181e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212033081811       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212038649310       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212035792271       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212037119740       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212035023913       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212038114562       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212040454834       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212041393227       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212044429659       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212043165069       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212041730635       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212041453776       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.212041330992       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.212042020877       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.212042366269       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 5.234026e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212033081811       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212037317647       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212035256577       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212036022998       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212034450769       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212036888663       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212036925626       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212037727673       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212037898289       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212037508351       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212037250582       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.326134e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212033081811       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212035246551       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212034252847       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212034847274       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212033897842       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212034458920       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212034602209       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212034731126       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212034581088       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 3.352372e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.500490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8946e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.200213e-01 1 1  ON 0
 uu_1                 5.398863e-02 1 1  ON 1
 uu_2                -4.600976e-02 1 1  ON 2
 uu_3                -1.035129e-01 1 1  ON 3
 uu_4                -1.369662e-01 1 1  ON 4
 uu_5                -1.429711e-01 1 1  ON 5
 uu_6                -1.202644e-01 1 1  ON 6
 uu_7                -5.073070e-02 1 1  ON 7
 uu_8                 8.943029e-02 1 1  ON 8
 uu_9                 1.306795e-01 1 1  ON 9
 ud_0                 3.679290e-01 1 1  ON 10
 ud_1                 1.020756e-01 1 1  ON 11
 ud_2                -1.425865e-02 1 1  ON 12
 ud_3                -7.759405e-02 1 1  ON 13
 ud_4                -1.256387e-01 1 1  ON 14
 ud_5                -1.570190e-01 1 1  ON 15
 ud_6                -1.591570e-01 1 1  ON 16
 ud_7                -1.163926e-01 1 1  ON 17
 ud_8                -1.593853e-02 1 1  ON 18
 ud_9                 9.169223e-02 1 1  ON 19
 eO_0                -8.099023e-01 1 1  ON 20
 eO_1                -4.769087e-01 1 1  ON 21
 eO_2                -4.862351e-02 1 1  ON 22
 eO_3                 2.201102e-01 1 1  ON 23
 eO_4                 3.202750e-01 1 1  ON 24
 eO_5                 3.344167e-01 1 1  ON 25
 eO_6                 2.663236e-01 1 1  ON 26
 eO_7                 1.308878e-01 1 1  ON 27
 eO_8                 3.097458e-02 1 1  ON 28
 eO_9                 1.998929e-02 1 1  ON 29
eH1_0                -1.852278e-01 1 1  ON 30
eH1_1                -1.060409e-01 1 1  ON 31
eH1_2                -6.366709e-02 1 1  ON 32
eH1_3                -2.533036e-02 1 1  ON 33
eH1_4                 1.872266e-02 1 1  ON 34
eH1_5                 3.041162e-02 1 1  ON 35
eH1_6                 7.661784e-02 1 1  ON 36
eH1_7                 1.082415e-01 1 1  ON 37
eH1_8                 1.013372e-01 1 1  ON 38
eH1_9                 2.817366e-02 1 1  ON 39
eH2_0                -1.869391e-01 1 1  ON 40
eH2_1                -1.076461e-01 1 1  ON 41
eH2_2                -6.462784e-02 1 1  ON 42
eH2_3                -2.686161e-02 1 1  ON 43
eH2_4                 1.833713e-02 1 1  ON 44
eH2_5                 3.049901e-02 1 1  ON 45
eH2_6                 7.634626e-02 1 1  ON 46
eH2_7                 1.121173e-01 1 1  ON 47
eH2_8                 1.050344e-01 1 1  ON 48
eH2_9                 2.973439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2054
    reference variance = 0.270784
====================================================
  Execution time = 3.6835e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4884e-01
  Total weights = 2.0000e+06
  Execution time = 3.1020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348636230713
                                         uncertainty =       0.006308673704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348636230713
                                         uncertainty =       0.006308673704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417668231
  error estimate for blocks of size 2^( 2) =       0.000428213246
  error estimate for blocks of size 2^( 3) =       0.000437794739
  error estimate for blocks of size 2^( 4) =       0.000444424293
  error estimate for blocks of size 2^( 5) =       0.000448893852
  error estimate for blocks of size 2^( 6) =       0.000450522704
  error estimate for blocks of size 2^( 7) =       0.000451523895

      target function =                  N/A
              le_mean =     -17.211049086841
             les_mean =     296.569103996729
             stat err =       0.000448841186
             autocorr =       1.154841860359
              std dev =       0.590672076148
             le_variance =       0.348893501542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348716635207
                                         uncertainty =       0.006310563823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348716635207
                                         uncertainty =       0.006310563823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417716556
  error estimate for blocks of size 2^( 2) =       0.000428254369
  error estimate for blocks of size 2^( 3) =       0.000437825778
  error estimate for blocks of size 2^( 4) =       0.000444449830
  error estimate for blocks of size 2^( 5) =       0.000448905691
  error estimate for blocks of size 2^( 6) =       0.000450545604
  error estimate for blocks of size 2^( 7) =       0.000451564142

      target function =                  N/A
              le_mean =     -17.211047397300
             les_mean =     296.569126579772
             stat err =       0.000448866317
             autocorr =       1.154703963728
              std dev =       0.590740418589
             le_variance =       0.348974242154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348547236810
                                         uncertainty =       0.006310028034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348547236810
                                         uncertainty =       0.006310028034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417614932
  error estimate for blocks of size 2^( 2) =       0.000428156785
  error estimate for blocks of size 2^( 3) =       0.000437734257
  error estimate for blocks of size 2^( 4) =       0.000444368263
  error estimate for blocks of size 2^( 5) =       0.000448825908
  error estimate for blocks of size 2^( 6) =       0.000450474925
  error estimate for blocks of size 2^( 7) =       0.000451501989

      target function =                  N/A
              le_mean =     -17.211048760050
             les_mean =     296.569003709621
             stat err =       0.000448792771
             autocorr =       1.154887466551
              std dev =       0.590596700989
             le_variance =       0.348804463219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348597580581
                                         uncertainty =       0.006310534995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348597580581
                                         uncertainty =       0.006310534995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417645003
  error estimate for blocks of size 2^( 2) =       0.000428188892
  error estimate for blocks of size 2^( 3) =       0.000437769380
  error estimate for blocks of size 2^( 4) =       0.000444400760
  error estimate for blocks of size 2^( 5) =       0.000448868515
  error estimate for blocks of size 2^( 6) =       0.000450503872
  error estimate for blocks of size 2^( 7) =       0.000451513346

      target function =                  N/A
              le_mean =     -17.211047745971
             les_mean =     296.569019037384
             stat err =       0.000448821623
             autocorr =       1.154869640120
              std dev =       0.590639228068
             le_variance =       0.348854697733


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211049086841        initial  <--
     2.3842e-02     2.3842e-01             5.2340e-03       -17.211047397300
     9.5367e-02     9.5367e-01             1.3261e-03       -17.211048760050
     3.8147e-01     3.8147e+00             3.3524e-04       -17.211047745971

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.4315
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.200078e-01 1 1  ON 0
 uu_1                 5.345536e-02 1 1  ON 1
 uu_2                -4.628792e-02 1 1  ON 2
 uu_3                -1.035480e-01 1 1  ON 3
 uu_4                -1.365377e-01 1 1  ON 4
 uu_5                -1.428920e-01 1 1  ON 5
 uu_6                -1.198378e-01 1 1  ON 6
 uu_7                -5.032673e-02 1 1  ON 7
 uu_8                 9.004582e-02 1 1  ON 8
 uu_9                 1.302720e-01 1 1  ON 9
 ud_0                 3.678557e-01 1 1  ON 10
 ud_1                 1.020523e-01 1 1  ON 11
 ud_2                -1.459851e-02 1 1  ON 12
 ud_3                -7.794470e-02 1 1  ON 13
 ud_4                -1.255927e-01 1 1  ON 14
 ud_5                -1.571396e-01 1 1  ON 15
 ud_6                -1.595356e-01 1 1  ON 16
 ud_7                -1.160259e-01 1 1  ON 17
 ud_8                -1.472604e-02 1 1  ON 18
 ud_9                 9.190608e-02 1 1  ON 19
 eO_0                -8.087819e-01 1 1  ON 20
 eO_1                -4.759969e-01 1 1  ON 21
 eO_2                -4.763354e-02 1 1  ON 22
 eO_3                 2.203803e-01 1 1  ON 23
 eO_4                 3.204083e-01 1 1  ON 24
 eO_5                 3.337315e-01 1 1  ON 25
 eO_6                 2.649974e-01 1 1  ON 26
 eO_7                 1.297573e-01 1 1  ON 27
 eO_8                 3.084068e-02 1 1  ON 28
 eO_9                 1.993283e-02 1 1  ON 29
eH1_0                -1.849263e-01 1 1  ON 30
eH1_1                -1.060566e-01 1 1  ON 31
eH1_2                -6.337589e-02 1 1  ON 32
eH1_3                -2.554820e-02 1 1  ON 33
eH1_4                 1.884207e-02 1 1  ON 34
eH1_5                 3.144546e-02 1 1  ON 35
eH1_6                 7.603955e-02 1 1  ON 36
eH1_7                 1.081314e-01 1 1  ON 37
eH1_8                 1.007006e-01 1 1  ON 38
eH1_9                 2.800296e-02 1 1  ON 39
eH2_0                -1.869885e-01 1 1  ON 40
eH2_1                -1.071288e-01 1 1  ON 41
eH2_2                -6.441692e-02 1 1  ON 42
eH2_3                -2.679219e-02 1 1  ON 43
eH2_4                 1.788640e-02 1 1  ON 44
eH2_5                 3.037967e-02 1 1  ON 45
eH2_6                 7.676930e-02 1 1  ON 46
eH2_7                 1.123572e-01 1 1  ON 47
eH2_8                 1.044841e-01 1 1  ON 48
eH2_9                 2.956983e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0138e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1185
    reference variance = 0.218094
====================================================
  Execution time = 3.7739e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.5411e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0644e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354137111368
                                         uncertainty =       0.009102348781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354137111368
                                         uncertainty =       0.009102348781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420779908
  error estimate for blocks of size 2^( 2) =       0.000430893402
  error estimate for blocks of size 2^( 3) =       0.000439452335
  error estimate for blocks of size 2^( 4) =       0.000446382677
  error estimate for blocks of size 2^( 5) =       0.000451555645
  error estimate for blocks of size 2^( 6) =       0.000453280610
  error estimate for blocks of size 2^( 7) =       0.000453852807

      target function =                  N/A
              le_mean =     -17.212785152877
             les_mean =     296.634084004363
             stat err =       0.000451267935
             autocorr =       1.150161859948
              std dev =       0.595072652978
             le_variance =       0.354111462322


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721278515288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212785152877       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212787343387       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212788104532       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212787958745       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212789189413       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212788964366       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212789396022       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212789504503       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212789210272       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 5.644668e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212785152877       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212785924006       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212786239216       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212786044963       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212786465789       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212786401869       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212786469859       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.661630e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212785152877       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212785367564       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212785465293       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212785402583       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212785500421       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212785488003       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212785490801       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.451599e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.503944 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8392e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.200212e-01 1 1  ON 0
 uu_1                 5.343206e-02 1 1  ON 1
 uu_2                -4.623784e-02 1 1  ON 2
 uu_3                -1.035564e-01 1 1  ON 3
 uu_4                -1.366401e-01 1 1  ON 4
 uu_5                -1.427947e-01 1 1  ON 5
 uu_6                -1.198331e-01 1 1  ON 6
 uu_7                -5.039892e-02 1 1  ON 7
 uu_8                 9.000371e-02 1 1  ON 8
 uu_9                 1.303220e-01 1 1  ON 9
 ud_0                 3.679657e-01 1 1  ON 10
 ud_1                 1.020850e-01 1 1  ON 11
 ud_2                -1.450956e-02 1 1  ON 12
 ud_3                -7.791606e-02 1 1  ON 13
 ud_4                -1.256438e-01 1 1  ON 14
 ud_5                -1.571883e-01 1 1  ON 15
 ud_6                -1.595901e-01 1 1  ON 16
 ud_7                -1.160602e-01 1 1  ON 17
 ud_8                -1.481257e-02 1 1  ON 18
 ud_9                 9.189459e-02 1 1  ON 19
 eO_0                -8.088888e-01 1 1  ON 20
 eO_1                -4.761631e-01 1 1  ON 21
 eO_2                -4.773218e-02 1 1  ON 22
 eO_3                 2.203860e-01 1 1  ON 23
 eO_4                 3.204173e-01 1 1  ON 24
 eO_5                 3.338461e-01 1 1  ON 25
 eO_6                 2.650977e-01 1 1  ON 26
 eO_7                 1.298781e-01 1 1  ON 27
 eO_8                 3.085785e-02 1 1  ON 28
 eO_9                 1.993527e-02 1 1  ON 29
eH1_0                -1.849218e-01 1 1  ON 30
eH1_1                -1.060896e-01 1 1  ON 31
eH1_2                -6.338242e-02 1 1  ON 32
eH1_3                -2.554265e-02 1 1  ON 33
eH1_4                 1.878934e-02 1 1  ON 34
eH1_5                 3.141345e-02 1 1  ON 35
eH1_6                 7.604064e-02 1 1  ON 36
eH1_7                 1.081497e-01 1 1  ON 37
eH1_8                 1.007668e-01 1 1  ON 38
eH1_9                 2.802763e-02 1 1  ON 39
eH2_0                -1.869943e-01 1 1  ON 40
eH2_1                -1.071636e-01 1 1  ON 41
eH2_2                -6.441031e-02 1 1  ON 42
eH2_3                -2.676092e-02 1 1  ON 43
eH2_4                 1.794563e-02 1 1  ON 44
eH2_5                 3.034778e-02 1 1  ON 45
eH2_6                 7.670800e-02 1 1  ON 46
eH2_7                 1.123174e-01 1 1  ON 47
eH2_8                 1.045411e-01 1 1  ON 48
eH2_9                 2.958748e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1875
    reference variance = 0.213468
====================================================
  Execution time = 3.6857e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.5356e-01
  Total weights = 2.0000e+06
  Execution time = 3.0968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353437982220
                                         uncertainty =       0.012852317173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353437982220
                                         uncertainty =       0.012852317173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420443595
  error estimate for blocks of size 2^( 2) =       0.000431165306
  error estimate for blocks of size 2^( 3) =       0.000440877933
  error estimate for blocks of size 2^( 4) =       0.000447978923
  error estimate for blocks of size 2^( 5) =       0.000452284039
  error estimate for blocks of size 2^( 6) =       0.000454101651
  error estimate for blocks of size 2^( 7) =       0.000458019189

      target function =                  N/A
              le_mean =     -17.212698987419
             les_mean =     296.630551888081
             stat err =       0.000453095951
             autocorr =       1.161354694333
              std dev =       0.594597034433
             le_variance =       0.353545633356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353509352171
                                         uncertainty =       0.012851380644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353509352171
                                         uncertainty =       0.012851380644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420485938
  error estimate for blocks of size 2^( 2) =       0.000431206150
  error estimate for blocks of size 2^( 3) =       0.000440915571
  error estimate for blocks of size 2^( 4) =       0.000448011984
  error estimate for blocks of size 2^( 5) =       0.000452314932
  error estimate for blocks of size 2^( 6) =       0.000454132571
  error estimate for blocks of size 2^( 7) =       0.000458040462

      target function =                  N/A
              le_mean =     -17.212699435022
             les_mean =     296.630638511550
             stat err =       0.000453124987
             autocorr =       1.161269635569
              std dev =       0.594656916175
             le_variance =       0.353616847954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353470291962
                                         uncertainty =       0.012847973577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353470291962
                                         uncertainty =       0.012847973577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420462776
  error estimate for blocks of size 2^( 2) =       0.000431184116
  error estimate for blocks of size 2^( 3) =       0.000440895203
  error estimate for blocks of size 2^( 4) =       0.000447993440
  error estimate for blocks of size 2^( 5) =       0.000452297227
  error estimate for blocks of size 2^( 6) =       0.000454115211
  error estimate for blocks of size 2^( 7) =       0.000458025108

      target function =                  N/A
              le_mean =     -17.212699483003
             les_mean =     296.630601206854
             stat err =       0.000453107747
             autocorr =       1.161309205018
              std dev =       0.594624159841
             le_variance =       0.353577891466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353443365402
                                         uncertainty =       0.012851538091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353443365402
                                         uncertainty =       0.012851538091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420446795
  error estimate for blocks of size 2^( 2) =       0.000431168441
  error estimate for blocks of size 2^( 3) =       0.000440880863
  error estimate for blocks of size 2^( 4) =       0.000447981459
  error estimate for blocks of size 2^( 5) =       0.000452286397
  error estimate for blocks of size 2^( 6) =       0.000454104037
  error estimate for blocks of size 2^( 7) =       0.000458020369

      target function =                  N/A
              le_mean =     -17.212699048069
             les_mean =     296.630559357345
             stat err =       0.000453098065
             autocorr =       1.161347857884
              std dev =       0.594601559649
             le_variance =       0.353551014737


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212698987419        initial
     2.3842e-01     2.3842e+00             5.6447e-04       -17.212699435022
     9.5367e-01     9.5367e+00             1.6616e-04       -17.212699483003  <--
     3.8147e+00     3.8147e+01             4.4516e-05       -17.212699048069

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 5.2486e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.200212e-01 1 1  ON 0
 uu_1                 5.343206e-02 1 1  ON 1
 uu_2                -4.623784e-02 1 1  ON 2
 uu_3                -1.035564e-01 1 1  ON 3
 uu_4                -1.366401e-01 1 1  ON 4
 uu_5                -1.427947e-01 1 1  ON 5
 uu_6                -1.198331e-01 1 1  ON 6
 uu_7                -5.039892e-02 1 1  ON 7
 uu_8                 9.000371e-02 1 1  ON 8
 uu_9                 1.303220e-01 1 1  ON 9
 ud_0                 3.679657e-01 1 1  ON 10
 ud_1                 1.020850e-01 1 1  ON 11
 ud_2                -1.450956e-02 1 1  ON 12
 ud_3                -7.791606e-02 1 1  ON 13
 ud_4                -1.256438e-01 1 1  ON 14
 ud_5                -1.571883e-01 1 1  ON 15
 ud_6                -1.595901e-01 1 1  ON 16
 ud_7                -1.160602e-01 1 1  ON 17
 ud_8                -1.481257e-02 1 1  ON 18
 ud_9                 9.189459e-02 1 1  ON 19
 eO_0                -8.088888e-01 1 1  ON 20
 eO_1                -4.761631e-01 1 1  ON 21
 eO_2                -4.773218e-02 1 1  ON 22
 eO_3                 2.203860e-01 1 1  ON 23
 eO_4                 3.204173e-01 1 1  ON 24
 eO_5                 3.338461e-01 1 1  ON 25
 eO_6                 2.650977e-01 1 1  ON 26
 eO_7                 1.298781e-01 1 1  ON 27
 eO_8                 3.085785e-02 1 1  ON 28
 eO_9                 1.993527e-02 1 1  ON 29
eH1_0                -1.849218e-01 1 1  ON 30
eH1_1                -1.060896e-01 1 1  ON 31
eH1_2                -6.338242e-02 1 1  ON 32
eH1_3                -2.554265e-02 1 1  ON 33
eH1_4                 1.878934e-02 1 1  ON 34
eH1_5                 3.141345e-02 1 1  ON 35
eH1_6                 7.604064e-02 1 1  ON 36
eH1_7                 1.081497e-01 1 1  ON 37
eH1_8                 1.007668e-01 1 1  ON 38
eH1_9                 2.802763e-02 1 1  ON 39
eH2_0                -1.869943e-01 1 1  ON 40
eH2_1                -1.071636e-01 1 1  ON 41
eH2_2                -6.441031e-02 1 1  ON 42
eH2_3                -2.676092e-02 1 1  ON 43
eH2_4                 1.794563e-02 1 1  ON 44
eH2_5                 3.034778e-02 1 1  ON 45
eH2_6                 7.670800e-02 1 1  ON 46
eH2_7                 1.123174e-01 1 1  ON 47
eH2_8                 1.045411e-01 1 1  ON 48
eH2_9                 2.958748e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0088e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.0789
    reference variance = 0.902466
====================================================
  Execution time = 3.7977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3893e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0835e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338904202559
                                         uncertainty =       0.003749370984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338904202559
                                         uncertainty =       0.003749370984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411664226
  error estimate for blocks of size 2^( 2) =       0.000421993697
  error estimate for blocks of size 2^( 3) =       0.000431193448
  error estimate for blocks of size 2^( 4) =       0.000438380814
  error estimate for blocks of size 2^( 5) =       0.000442692289
  error estimate for blocks of size 2^( 6) =       0.000444513943
  error estimate for blocks of size 2^( 7) =       0.000445519345

      target function =                  N/A
              le_mean =     -17.211788378467
             les_mean =     296.584593886391
             stat err =       0.000442776598
             autocorr =       1.156866009270
              std dev =       0.582181132245
             le_variance =       0.338934870743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721178837847e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211788378467       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211789390042       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211790599115       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211791203889       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211790985256       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211791087342       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211790862505       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211791097326       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211791127996       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211791180626       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 6.757641e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211788378467       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211788781274       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211789241296       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211789548066       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211789443391       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211789469840       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211789383649       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211789412673       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.706332e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211788378467       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211788496689       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211788636057       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211788730098       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211788705125       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211788713398       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211788687130       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.275654e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.507798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8824e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.200510e-01 1 1  ON 0
 uu_1                 5.340360e-02 1 1  ON 1
 uu_2                -4.625304e-02 1 1  ON 2
 uu_3                -1.035698e-01 1 1  ON 3
 uu_4                -1.367451e-01 1 1  ON 4
 uu_5                -1.428172e-01 1 1  ON 5
 uu_6                -1.197496e-01 1 1  ON 6
 uu_7                -5.038405e-02 1 1  ON 7
 uu_8                 8.995892e-02 1 1  ON 8
 uu_9                 1.303692e-01 1 1  ON 9
 ud_0                 3.679283e-01 1 1  ON 10
 ud_1                 1.020749e-01 1 1  ON 11
 ud_2                -1.449575e-02 1 1  ON 12
 ud_3                -7.787592e-02 1 1  ON 13
 ud_4                -1.257389e-01 1 1  ON 14
 ud_5                -1.571922e-01 1 1  ON 15
 ud_6                -1.595641e-01 1 1  ON 16
 ud_7                -1.159949e-01 1 1  ON 17
 ud_8                -1.485833e-02 1 1  ON 18
 ud_9                 9.189046e-02 1 1  ON 19
 eO_0                -8.090093e-01 1 1  ON 20
 eO_1                -4.763287e-01 1 1  ON 21
 eO_2                -4.786754e-02 1 1  ON 22
 eO_3                 2.203179e-01 1 1  ON 23
 eO_4                 3.204323e-01 1 1  ON 24
 eO_5                 3.340167e-01 1 1  ON 25
 eO_6                 2.652378e-01 1 1  ON 26
 eO_7                 1.300042e-01 1 1  ON 27
 eO_8                 3.088335e-02 1 1  ON 28
 eO_9                 1.994372e-02 1 1  ON 29
eH1_0                -1.850407e-01 1 1  ON 30
eH1_1                -1.060731e-01 1 1  ON 31
eH1_2                -6.331841e-02 1 1  ON 32
eH1_3                -2.550929e-02 1 1  ON 33
eH1_4                 1.879887e-02 1 1  ON 34
eH1_5                 3.134189e-02 1 1  ON 35
eH1_6                 7.600872e-02 1 1  ON 36
eH1_7                 1.081449e-01 1 1  ON 37
eH1_8                 1.008402e-01 1 1  ON 38
eH1_9                 2.804919e-02 1 1  ON 39
eH2_0                -1.869454e-01 1 1  ON 40
eH2_1                -1.072324e-01 1 1  ON 41
eH2_2                -6.449529e-02 1 1  ON 42
eH2_3                -2.673812e-02 1 1  ON 43
eH2_4                 1.788028e-02 1 1  ON 44
eH2_5                 3.040604e-02 1 1  ON 45
eH2_6                 7.671413e-02 1 1  ON 46
eH2_7                 1.123066e-01 1 1  ON 47
eH2_8                 1.046139e-01 1 1  ON 48
eH2_9                 2.960613e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.0994
    reference variance = 0.361901
====================================================
  Execution time = 3.7012e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4476e-01
  Total weights = 2.0000e+06
  Execution time = 3.0929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344851677230
                                         uncertainty =       0.003660464833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344851677230
                                         uncertainty =       0.003660464833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415209697
  error estimate for blocks of size 2^( 2) =       0.000425353216
  error estimate for blocks of size 2^( 3) =       0.000434827938
  error estimate for blocks of size 2^( 4) =       0.000441543652
  error estimate for blocks of size 2^( 5) =       0.000446343049
  error estimate for blocks of size 2^( 6) =       0.000448304746
  error estimate for blocks of size 2^( 7) =       0.000448601771

      target function =                  N/A
              le_mean =     -17.211712424036
             les_mean =     296.587842580922
             stat err =       0.000446198305
             autocorr =       1.154837441186
              std dev =       0.587195185258
             le_variance =       0.344798185590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344827894563
                                         uncertainty =       0.003659835684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344827894563
                                         uncertainty =       0.003659835684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415195320
  error estimate for blocks of size 2^( 2) =       0.000425339975
  error estimate for blocks of size 2^( 3) =       0.000434814980
  error estimate for blocks of size 2^( 4) =       0.000441527542
  error estimate for blocks of size 2^( 5) =       0.000446328583
  error estimate for blocks of size 2^( 6) =       0.000448291469
  error estimate for blocks of size 2^( 7) =       0.000448584763

      target function =                  N/A
              le_mean =     -17.211712950906
             les_mean =     296.587836839920
             stat err =       0.000446183089
             autocorr =       1.154838655344
              std dev =       0.587174852946
             le_variance =       0.344774307932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344786164367
                                         uncertainty =       0.003659489296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344786164367
                                         uncertainty =       0.003659489296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415170205
  error estimate for blocks of size 2^( 2) =       0.000425316095
  error estimate for blocks of size 2^( 3) =       0.000434792449
  error estimate for blocks of size 2^( 4) =       0.000441507034
  error estimate for blocks of size 2^( 5) =       0.000446308920
  error estimate for blocks of size 2^( 6) =       0.000448273257
  error estimate for blocks of size 2^( 7) =       0.000448567743

      target function =                  N/A
              le_mean =     -17.211713067241
             les_mean =     296.587799134243
             stat err =       0.000446164239
             autocorr =       1.154880792661
              std dev =       0.587139334027
             le_variance =       0.344732597561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344841609908
                                         uncertainty =       0.003660328492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344841609908
                                         uncertainty =       0.003660328492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415203628
  error estimate for blocks of size 2^( 2) =       0.000425347494
  error estimate for blocks of size 2^( 3) =       0.000434822463
  error estimate for blocks of size 2^( 4) =       0.000441538021
  error estimate for blocks of size 2^( 5) =       0.000446337840
  error estimate for blocks of size 2^( 6) =       0.000448300015
  error estimate for blocks of size 2^( 7) =       0.000448596682

      target function =                  N/A
              le_mean =     -17.211712522539
             les_mean =     296.587835891620
             stat err =       0.000446193139
             autocorr =       1.154844464428
              std dev =       0.587186601921
             le_variance =       0.344788105475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211712424036        initial
     2.3842e-01     2.3842e+00             6.7576e-04       -17.211712950906
     9.5367e-01     9.5367e+00             1.7063e-04       -17.211713067241  <--
     3.8147e+00     3.8147e+01             4.2757e-05       -17.211712522539

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 5.3517e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.200510e-01 1 1  ON 0
 uu_1                 5.340360e-02 1 1  ON 1
 uu_2                -4.625304e-02 1 1  ON 2
 uu_3                -1.035698e-01 1 1  ON 3
 uu_4                -1.367451e-01 1 1  ON 4
 uu_5                -1.428172e-01 1 1  ON 5
 uu_6                -1.197496e-01 1 1  ON 6
 uu_7                -5.038405e-02 1 1  ON 7
 uu_8                 8.995892e-02 1 1  ON 8
 uu_9                 1.303692e-01 1 1  ON 9
 ud_0                 3.679283e-01 1 1  ON 10
 ud_1                 1.020749e-01 1 1  ON 11
 ud_2                -1.449575e-02 1 1  ON 12
 ud_3                -7.787592e-02 1 1  ON 13
 ud_4                -1.257389e-01 1 1  ON 14
 ud_5                -1.571922e-01 1 1  ON 15
 ud_6                -1.595641e-01 1 1  ON 16
 ud_7                -1.159949e-01 1 1  ON 17
 ud_8                -1.485833e-02 1 1  ON 18
 ud_9                 9.189046e-02 1 1  ON 19
 eO_0                -8.090093e-01 1 1  ON 20
 eO_1                -4.763287e-01 1 1  ON 21
 eO_2                -4.786754e-02 1 1  ON 22
 eO_3                 2.203179e-01 1 1  ON 23
 eO_4                 3.204323e-01 1 1  ON 24
 eO_5                 3.340167e-01 1 1  ON 25
 eO_6                 2.652378e-01 1 1  ON 26
 eO_7                 1.300042e-01 1 1  ON 27
 eO_8                 3.088335e-02 1 1  ON 28
 eO_9                 1.994372e-02 1 1  ON 29
eH1_0                -1.850407e-01 1 1  ON 30
eH1_1                -1.060731e-01 1 1  ON 31
eH1_2                -6.331841e-02 1 1  ON 32
eH1_3                -2.550929e-02 1 1  ON 33
eH1_4                 1.879887e-02 1 1  ON 34
eH1_5                 3.134189e-02 1 1  ON 35
eH1_6                 7.600872e-02 1 1  ON 36
eH1_7                 1.081449e-01 1 1  ON 37
eH1_8                 1.008402e-01 1 1  ON 38
eH1_9                 2.804919e-02 1 1  ON 39
eH2_0                -1.869454e-01 1 1  ON 40
eH2_1                -1.072324e-01 1 1  ON 41
eH2_2                -6.449529e-02 1 1  ON 42
eH2_3                -2.673812e-02 1 1  ON 43
eH2_4                 1.788028e-02 1 1  ON 44
eH2_5                 3.040604e-02 1 1  ON 45
eH2_6                 7.671413e-02 1 1  ON 46
eH2_7                 1.123066e-01 1 1  ON 47
eH2_8                 1.046139e-01 1 1  ON 48
eH2_9                 2.960613e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0235e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1787
    reference variance = 0.390693
====================================================
  Execution time = 3.7859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4462e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0645e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344654327188
                                         uncertainty =       0.004361417042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344654327188
                                         uncertainty =       0.004361417042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415103056
  error estimate for blocks of size 2^( 2) =       0.000425475431
  error estimate for blocks of size 2^( 3) =       0.000435045879
  error estimate for blocks of size 2^( 4) =       0.000442280019
  error estimate for blocks of size 2^( 5) =       0.000446580149
  error estimate for blocks of size 2^( 6) =       0.000448549545
  error estimate for blocks of size 2^( 7) =       0.000450759151

      target function =                  N/A
              le_mean =     -17.211411674355
             les_mean =     296.577312745481
             stat err =       0.000447042216
             autocorr =       1.159805632753
              std dev =       0.587044371111
             le_variance =       0.344621093653


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721141167436e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211411674355       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211413184759       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211413454951       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211413028021       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211414282655       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211414483060       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211414509595       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211414599923       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211414493418       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211414704023       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 6.521982e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211411674355       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211412310719       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211412535795       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211412408144       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211412878013       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211412762643       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211412800998       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211412734452       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.648314e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211411674355       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211411866337       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211411955718       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211411927731       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211412075650       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211412022729       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211412021160       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.676581e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.511856 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8514e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.199565e-01 1 1  ON 0
 uu_1                 5.346210e-02 1 1  ON 1
 uu_2                -4.624682e-02 1 1  ON 2
 uu_3                -1.035751e-01 1 1  ON 3
 uu_4                -1.367543e-01 1 1  ON 4
 uu_5                -1.429072e-01 1 1  ON 5
 uu_6                -1.197497e-01 1 1  ON 6
 uu_7                -5.035907e-02 1 1  ON 7
 uu_8                 8.991725e-02 1 1  ON 8
 uu_9                 1.304209e-01 1 1  ON 9
 ud_0                 3.678535e-01 1 1  ON 10
 ud_1                 1.020063e-01 1 1  ON 11
 ud_2                -1.446185e-02 1 1  ON 12
 ud_3                -7.790742e-02 1 1  ON 13
 ud_4                -1.257975e-01 1 1  ON 14
 ud_5                -1.572288e-01 1 1  ON 15
 ud_6                -1.594273e-01 1 1  ON 16
 ud_7                -1.159516e-01 1 1  ON 17
 ud_8                -1.491656e-02 1 1  ON 18
 ud_9                 9.190546e-02 1 1  ON 19
 eO_0                -8.091585e-01 1 1  ON 20
 eO_1                -4.764181e-01 1 1  ON 21
 eO_2                -4.803237e-02 1 1  ON 22
 eO_3                 2.202670e-01 1 1  ON 23
 eO_4                 3.204771e-01 1 1  ON 24
 eO_5                 3.340843e-01 1 1  ON 25
 eO_6                 2.653983e-01 1 1  ON 26
 eO_7                 1.301447e-01 1 1  ON 27
 eO_8                 3.090054e-02 1 1  ON 28
 eO_9                 1.995216e-02 1 1  ON 29
eH1_0                -1.850691e-01 1 1  ON 30
eH1_1                -1.060675e-01 1 1  ON 31
eH1_2                -6.334661e-02 1 1  ON 32
eH1_3                -2.553396e-02 1 1  ON 33
eH1_4                 1.875589e-02 1 1  ON 34
eH1_5                 3.139857e-02 1 1  ON 35
eH1_6                 7.598404e-02 1 1  ON 36
eH1_7                 1.081293e-01 1 1  ON 37
eH1_8                 1.009081e-01 1 1  ON 38
eH1_9                 2.807131e-02 1 1  ON 39
eH2_0                -1.868673e-01 1 1  ON 40
eH2_1                -1.073603e-01 1 1  ON 41
eH2_2                -6.449818e-02 1 1  ON 42
eH2_3                -2.670505e-02 1 1  ON 43
eH2_4                 1.789049e-02 1 1  ON 44
eH2_5                 3.034871e-02 1 1  ON 45
eH2_6                 7.663921e-02 1 1  ON 46
eH2_7                 1.123199e-01 1 1  ON 47
eH2_8                 1.047042e-01 1 1  ON 48
eH2_9                 2.963218e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1756
    reference variance = 0.285543
====================================================
  Execution time = 3.7866e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4171e-01
  Total weights = 2.0000e+06
  Execution time = 3.1051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341469929651
                                         uncertainty =       0.004753551460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341469929651
                                         uncertainty =       0.004753551460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413391168
  error estimate for blocks of size 2^( 2) =       0.000424039936
  error estimate for blocks of size 2^( 3) =       0.000433532319
  error estimate for blocks of size 2^( 4) =       0.000440029027
  error estimate for blocks of size 2^( 5) =       0.000444565062
  error estimate for blocks of size 2^( 6) =       0.000446601793
  error estimate for blocks of size 2^( 7) =       0.000446817354

      target function =                  N/A
              le_mean =     -17.212118576948
             les_mean =     296.598810252065
             stat err =       0.000444503309
             autocorr =       1.156185738839
              std dev =       0.584623396752
             le_variance =       0.341784516030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341343251820
                                         uncertainty =       0.004747959763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341343251820
                                         uncertainty =       0.004747959763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413314370
  error estimate for blocks of size 2^( 2) =       0.000423964038
  error estimate for blocks of size 2^( 3) =       0.000433456996
  error estimate for blocks of size 2^( 4) =       0.000439953729
  error estimate for blocks of size 2^( 5) =       0.000444489881
  error estimate for blocks of size 2^( 6) =       0.000446527114
  error estimate for blocks of size 2^( 7) =       0.000446733658

      target function =                  N/A
              le_mean =     -17.212117702153
             les_mean =     296.598653159310
             stat err =       0.000444426095
             autocorr =       1.156213651074
              std dev =       0.584514787984
             le_variance =       0.341657537372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341313349521
                                         uncertainty =       0.004747265131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341313349521
                                         uncertainty =       0.004747265131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413296340
  error estimate for blocks of size 2^( 2) =       0.000423947075
  error estimate for blocks of size 2^( 3) =       0.000433441205
  error estimate for blocks of size 2^( 4) =       0.000439938738
  error estimate for blocks of size 2^( 5) =       0.000444476144
  error estimate for blocks of size 2^( 6) =       0.000446515046
  error estimate for blocks of size 2^( 7) =       0.000446721237

      target function =                  N/A
              le_mean =     -17.212117863151
             les_mean =     296.598628893191
             stat err =       0.000444412791
             autocorr =       1.156245305812
              std dev =       0.584489289032
             le_variance =       0.341627728993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341445463146
                                         uncertainty =       0.004752579861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341445463146
                                         uncertainty =       0.004752579861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413376358
  error estimate for blocks of size 2^( 2) =       0.000424025449
  error estimate for blocks of size 2^( 3) =       0.000433518142
  error estimate for blocks of size 2^( 4) =       0.000440014989
  error estimate for blocks of size 2^( 5) =       0.000444551337
  error estimate for blocks of size 2^( 6) =       0.000446588496
  error estimate for blocks of size 2^( 7) =       0.000446802424

      target function =                  N/A
              le_mean =     -17.212118437493
             les_mean =     296.598780961345
             stat err =       0.000444489312
             autocorr =       1.156195769798
              std dev =       0.584602451189
             le_variance =       0.341760025936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212118576948        initial  <--
     2.3842e-01     2.3842e+00             6.5220e-04       -17.212117702153
     9.5367e-01     9.5367e+00             1.6483e-04       -17.212117863151
     3.8147e+00     3.8147e+01             4.6766e-05       -17.212118437493

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.4870
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.200510e-01 1 1  ON 0
 uu_1                 5.340360e-02 1 1  ON 1
 uu_2                -4.625304e-02 1 1  ON 2
 uu_3                -1.035698e-01 1 1  ON 3
 uu_4                -1.367451e-01 1 1  ON 4
 uu_5                -1.428172e-01 1 1  ON 5
 uu_6                -1.197496e-01 1 1  ON 6
 uu_7                -5.038405e-02 1 1  ON 7
 uu_8                 8.995892e-02 1 1  ON 8
 uu_9                 1.303692e-01 1 1  ON 9
 ud_0                 3.679283e-01 1 1  ON 10
 ud_1                 1.020749e-01 1 1  ON 11
 ud_2                -1.449575e-02 1 1  ON 12
 ud_3                -7.787592e-02 1 1  ON 13
 ud_4                -1.257389e-01 1 1  ON 14
 ud_5                -1.571922e-01 1 1  ON 15
 ud_6                -1.595641e-01 1 1  ON 16
 ud_7                -1.159949e-01 1 1  ON 17
 ud_8                -1.485833e-02 1 1  ON 18
 ud_9                 9.189046e-02 1 1  ON 19
 eO_0                -8.090093e-01 1 1  ON 20
 eO_1                -4.763287e-01 1 1  ON 21
 eO_2                -4.786754e-02 1 1  ON 22
 eO_3                 2.203179e-01 1 1  ON 23
 eO_4                 3.204323e-01 1 1  ON 24
 eO_5                 3.340167e-01 1 1  ON 25
 eO_6                 2.652378e-01 1 1  ON 26
 eO_7                 1.300042e-01 1 1  ON 27
 eO_8                 3.088335e-02 1 1  ON 28
 eO_9                 1.994372e-02 1 1  ON 29
eH1_0                -1.850407e-01 1 1  ON 30
eH1_1                -1.060731e-01 1 1  ON 31
eH1_2                -6.331841e-02 1 1  ON 32
eH1_3                -2.550929e-02 1 1  ON 33
eH1_4                 1.879887e-02 1 1  ON 34
eH1_5                 3.134189e-02 1 1  ON 35
eH1_6                 7.600872e-02 1 1  ON 36
eH1_7                 1.081449e-01 1 1  ON 37
eH1_8                 1.008402e-01 1 1  ON 38
eH1_9                 2.804919e-02 1 1  ON 39
eH2_0                -1.869454e-01 1 1  ON 40
eH2_1                -1.072324e-01 1 1  ON 41
eH2_2                -6.449529e-02 1 1  ON 42
eH2_3                -2.673812e-02 1 1  ON 43
eH2_4                 1.788028e-02 1 1  ON 44
eH2_5                 3.040604e-02 1 1  ON 45
eH2_6                 7.671413e-02 1 1  ON 46
eH2_7                 1.123066e-01 1 1  ON 47
eH2_8                 1.046139e-01 1 1  ON 48
eH2_9                 2.960613e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0201e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2124
    reference variance = 0.32047
====================================================
  Execution time = 3.7850e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3409e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0653e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334155759119
                                         uncertainty =       0.002100977346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334155759119
                                         uncertainty =       0.002100977346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408713706
  error estimate for blocks of size 2^( 2) =       0.000419073334
  error estimate for blocks of size 2^( 3) =       0.000428908007
  error estimate for blocks of size 2^( 4) =       0.000436093011
  error estimate for blocks of size 2^( 5) =       0.000440310780
  error estimate for blocks of size 2^( 6) =       0.000443318723
  error estimate for blocks of size 2^( 7) =       0.000445981253

      target function =                  N/A
              le_mean =     -17.211949930638
             les_mean =     296.585314034251
             stat err =       0.000441425942
             autocorr =       1.166480012207
              std dev =       0.578008465764
             le_variance =       0.334093786495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721194993064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211949930638       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211950105166       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211950231033       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211950258792       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211950281353       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211950366410       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211950313501       residual = 8.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 7.583824e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211949930638       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211949977197       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211950011956       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211950019430       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211950024597       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211950048241       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211950036510       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.973669e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211949930638       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211949942477       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211949951401       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211949953313       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211949954555       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211949960605       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211949957805       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.990111e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.514989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8513e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.200458e-01 1 1  ON 0
 uu_1                 5.341026e-02 1 1  ON 1
 uu_2                -4.625804e-02 1 1  ON 2
 uu_3                -1.035716e-01 1 1  ON 3
 uu_4                -1.367356e-01 1 1  ON 4
 uu_5                -1.428127e-01 1 1  ON 5
 uu_6                -1.197546e-01 1 1  ON 6
 uu_7                -5.039061e-02 1 1  ON 7
 uu_8                 8.995184e-02 1 1  ON 8
 uu_9                 1.303735e-01 1 1  ON 9
 ud_0                 3.679219e-01 1 1  ON 10
 ud_1                 1.020834e-01 1 1  ON 11
 ud_2                -1.449207e-02 1 1  ON 12
 ud_3                -7.787544e-02 1 1  ON 13
 ud_4                -1.257416e-01 1 1  ON 14
 ud_5                -1.571954e-01 1 1  ON 15
 ud_6                -1.595595e-01 1 1  ON 16
 ud_7                -1.159965e-01 1 1  ON 17
 ud_8                -1.486430e-02 1 1  ON 18
 ud_9                 9.188943e-02 1 1  ON 19
 eO_0                -8.090290e-01 1 1  ON 20
 eO_1                -4.763382e-01 1 1  ON 21
 eO_2                -4.787483e-02 1 1  ON 22
 eO_3                 2.203113e-01 1 1  ON 23
 eO_4                 3.204404e-01 1 1  ON 24
 eO_5                 3.340232e-01 1 1  ON 25
 eO_6                 2.652515e-01 1 1  ON 26
 eO_7                 1.300164e-01 1 1  ON 27
 eO_8                 3.088488e-02 1 1  ON 28
 eO_9                 1.994428e-02 1 1  ON 29
eH1_0                -1.850423e-01 1 1  ON 30
eH1_1                -1.060818e-01 1 1  ON 31
eH1_2                -6.331741e-02 1 1  ON 32
eH1_3                -2.550600e-02 1 1  ON 33
eH1_4                 1.880386e-02 1 1  ON 34
eH1_5                 3.133988e-02 1 1  ON 35
eH1_6                 7.600573e-02 1 1  ON 36
eH1_7                 1.081438e-01 1 1  ON 37
eH1_8                 1.008451e-01 1 1  ON 38
eH1_9                 2.805100e-02 1 1  ON 39
eH2_0                -1.869367e-01 1 1  ON 40
eH2_1                -1.072361e-01 1 1  ON 41
eH2_2                -6.448806e-02 1 1  ON 42
eH2_3                -2.673174e-02 1 1  ON 43
eH2_4                 1.787455e-02 1 1  ON 44
eH2_5                 3.038857e-02 1 1  ON 45
eH2_6                 7.671038e-02 1 1  ON 46
eH2_7                 1.123074e-01 1 1  ON 47
eH2_8                 1.046197e-01 1 1  ON 48
eH2_9                 2.960731e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2163
    reference variance = 0.195341
====================================================
  Execution time = 3.6504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3490e-01
  Total weights = 2.0000e+06
  Execution time = 3.1261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334959924525
                                         uncertainty =       0.002569899606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334959924525
                                         uncertainty =       0.002569899606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409212212
  error estimate for blocks of size 2^( 2) =       0.000419906661
  error estimate for blocks of size 2^( 3) =       0.000429221084
  error estimate for blocks of size 2^( 4) =       0.000436180296
  error estimate for blocks of size 2^( 5) =       0.000440519219
  error estimate for blocks of size 2^( 6) =       0.000443646179
  error estimate for blocks of size 2^( 7) =       0.000445539571

      target function =                  N/A
              le_mean =     -17.211438614262
             les_mean =     296.568528273797
             stat err =       0.000441471316
             autocorr =       1.163878944856
              std dev =       0.578713459948
             le_variance =       0.334909268725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334931926659
                                         uncertainty =       0.002569763612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334931926659
                                         uncertainty =       0.002569763612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409195123
  error estimate for blocks of size 2^( 2) =       0.000419889898
  error estimate for blocks of size 2^( 3) =       0.000429204325
  error estimate for blocks of size 2^( 4) =       0.000436163743
  error estimate for blocks of size 2^( 5) =       0.000440502877
  error estimate for blocks of size 2^( 6) =       0.000443629750
  error estimate for blocks of size 2^( 7) =       0.000445523256

      target function =                  N/A
              le_mean =     -17.211438375512
             les_mean =     296.568492083476
             stat err =       0.000441454906
             autocorr =       1.163889630310
              std dev =       0.578689292162
             le_variance =       0.334881296863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334943730326
                                         uncertainty =       0.002569818082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334943730326
                                         uncertainty =       0.002569818082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409202327
  error estimate for blocks of size 2^( 2) =       0.000419896973
  error estimate for blocks of size 2^( 3) =       0.000429211399
  error estimate for blocks of size 2^( 4) =       0.000436170732
  error estimate for blocks of size 2^( 5) =       0.000440509760
  error estimate for blocks of size 2^( 6) =       0.000443636707
  error estimate for blocks of size 2^( 7) =       0.000445530205

      target function =                  N/A
              le_mean =     -17.211438475433
             les_mean =     296.568507315801
             stat err =       0.000441461851
             autocorr =       1.163885263753
              std dev =       0.578699481274
             le_variance =       0.334893089627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334957819364
                                         uncertainty =       0.002569888930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334957819364
                                         uncertainty =       0.002569888930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409210927
  error estimate for blocks of size 2^( 2) =       0.000419905402
  error estimate for blocks of size 2^( 3) =       0.000429219825
  error estimate for blocks of size 2^( 4) =       0.000436179053
  error estimate for blocks of size 2^( 5) =       0.000440517989
  error estimate for blocks of size 2^( 6) =       0.000443644949
  error estimate for blocks of size 2^( 7) =       0.000445538355

      target function =                  N/A
              le_mean =     -17.211438595927
             les_mean =     296.568525539439
             stat err =       0.000441470086
             autocorr =       1.163879768691
              std dev =       0.578711642813
             le_variance =       0.334907165527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211438614262        initial  <--
     2.3842e+00     2.3842e+01             7.5838e-05       -17.211438375512
     9.5367e+00     9.5367e+01             1.9737e-05       -17.211438475433
     3.8147e+01     3.8147e+02             4.9901e-06       -17.211438595927

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.1408
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.200510e-01 1 1  ON 0
 uu_1                 5.340360e-02 1 1  ON 1
 uu_2                -4.625304e-02 1 1  ON 2
 uu_3                -1.035698e-01 1 1  ON 3
 uu_4                -1.367451e-01 1 1  ON 4
 uu_5                -1.428172e-01 1 1  ON 5
 uu_6                -1.197496e-01 1 1  ON 6
 uu_7                -5.038405e-02 1 1  ON 7
 uu_8                 8.995892e-02 1 1  ON 8
 uu_9                 1.303692e-01 1 1  ON 9
 ud_0                 3.679283e-01 1 1  ON 10
 ud_1                 1.020749e-01 1 1  ON 11
 ud_2                -1.449575e-02 1 1  ON 12
 ud_3                -7.787592e-02 1 1  ON 13
 ud_4                -1.257389e-01 1 1  ON 14
 ud_5                -1.571922e-01 1 1  ON 15
 ud_6                -1.595641e-01 1 1  ON 16
 ud_7                -1.159949e-01 1 1  ON 17
 ud_8                -1.485833e-02 1 1  ON 18
 ud_9                 9.189046e-02 1 1  ON 19
 eO_0                -8.090093e-01 1 1  ON 20
 eO_1                -4.763287e-01 1 1  ON 21
 eO_2                -4.786754e-02 1 1  ON 22
 eO_3                 2.203179e-01 1 1  ON 23
 eO_4                 3.204323e-01 1 1  ON 24
 eO_5                 3.340167e-01 1 1  ON 25
 eO_6                 2.652378e-01 1 1  ON 26
 eO_7                 1.300042e-01 1 1  ON 27
 eO_8                 3.088335e-02 1 1  ON 28
 eO_9                 1.994372e-02 1 1  ON 29
eH1_0                -1.850407e-01 1 1  ON 30
eH1_1                -1.060731e-01 1 1  ON 31
eH1_2                -6.331841e-02 1 1  ON 32
eH1_3                -2.550929e-02 1 1  ON 33
eH1_4                 1.879887e-02 1 1  ON 34
eH1_5                 3.134189e-02 1 1  ON 35
eH1_6                 7.600872e-02 1 1  ON 36
eH1_7                 1.081449e-01 1 1  ON 37
eH1_8                 1.008402e-01 1 1  ON 38
eH1_9                 2.804919e-02 1 1  ON 39
eH2_0                -1.869454e-01 1 1  ON 40
eH2_1                -1.072324e-01 1 1  ON 41
eH2_2                -6.449529e-02 1 1  ON 42
eH2_3                -2.673812e-02 1 1  ON 43
eH2_4                 1.788028e-02 1 1  ON 44
eH2_5                 3.040604e-02 1 1  ON 45
eH2_6                 7.671413e-02 1 1  ON 46
eH2_7                 1.123066e-01 1 1  ON 47
eH2_8                 1.046139e-01 1 1  ON 48
eH2_9                 2.960613e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0066e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2239
    reference variance = 0.276468
====================================================
  Execution time = 3.8144e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3623e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0480e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336258424407
                                         uncertainty =       0.002999083605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336258424407
                                         uncertainty =       0.002999083605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410019411
  error estimate for blocks of size 2^( 2) =       0.000420579340
  error estimate for blocks of size 2^( 3) =       0.000430692916
  error estimate for blocks of size 2^( 4) =       0.000438125998
  error estimate for blocks of size 2^( 5) =       0.000442526541
  error estimate for blocks of size 2^( 6) =       0.000443595988
  error estimate for blocks of size 2^( 7) =       0.000444951415

      target function =                  N/A
              le_mean =     -17.211861913202
             les_mean =     296.584422186072
             stat err =       0.000442299986
             autocorr =       1.163657077399
              std dev =       0.579855012104
             le_variance =       0.336231835063


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721186191320e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211861913202       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211861929646       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211861909085       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211861908964       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211861917801       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211861920397       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211861919023       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 7.061222e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211861913202       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211861917334       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211861912145       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211861912076       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211861914335       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211861914981       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211861914640       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.771492e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211861913202       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211861914236       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211861912936       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211861912916       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211861913484       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211861913645       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211861913560       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.432649e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.518153 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8651e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.200513e-01 1 1  ON 0
 uu_1                 5.340451e-02 1 1  ON 1
 uu_2                -4.625332e-02 1 1  ON 2
 uu_3                -1.035695e-01 1 1  ON 3
 uu_4                -1.367450e-01 1 1  ON 4
 uu_5                -1.428184e-01 1 1  ON 5
 uu_6                -1.197503e-01 1 1  ON 6
 uu_7                -5.038426e-02 1 1  ON 7
 uu_8                 8.995851e-02 1 1  ON 8
 uu_9                 1.303697e-01 1 1  ON 9
 ud_0                 3.679289e-01 1 1  ON 10
 ud_1                 1.020748e-01 1 1  ON 11
 ud_2                -1.449575e-02 1 1  ON 12
 ud_3                -7.787629e-02 1 1  ON 13
 ud_4                -1.257398e-01 1 1  ON 14
 ud_5                -1.571927e-01 1 1  ON 15
 ud_6                -1.595631e-01 1 1  ON 16
 ud_7                -1.159945e-01 1 1  ON 17
 ud_8                -1.485882e-02 1 1  ON 18
 ud_9                 9.189051e-02 1 1  ON 19
 eO_0                -8.090102e-01 1 1  ON 20
 eO_1                -4.763305e-01 1 1  ON 21
 eO_2                -4.786885e-02 1 1  ON 22
 eO_3                 2.203175e-01 1 1  ON 23
 eO_4                 3.204323e-01 1 1  ON 24
 eO_5                 3.340178e-01 1 1  ON 25
 eO_6                 2.652392e-01 1 1  ON 26
 eO_7                 1.300056e-01 1 1  ON 27
 eO_8                 3.088355e-02 1 1  ON 28
 eO_9                 1.994376e-02 1 1  ON 29
eH1_0                -1.850412e-01 1 1  ON 30
eH1_1                -1.060733e-01 1 1  ON 31
eH1_2                -6.331854e-02 1 1  ON 32
eH1_3                -2.550921e-02 1 1  ON 33
eH1_4                 1.879897e-02 1 1  ON 34
eH1_5                 3.134189e-02 1 1  ON 35
eH1_6                 7.600825e-02 1 1  ON 36
eH1_7                 1.081451e-01 1 1  ON 37
eH1_8                 1.008408e-01 1 1  ON 38
eH1_9                 2.804934e-02 1 1  ON 39
eH2_0                -1.869451e-01 1 1  ON 40
eH2_1                -1.072324e-01 1 1  ON 41
eH2_2                -6.449601e-02 1 1  ON 42
eH2_3                -2.673796e-02 1 1  ON 43
eH2_4                 1.788035e-02 1 1  ON 44
eH2_5                 3.040527e-02 1 1  ON 45
eH2_6                 7.671388e-02 1 1  ON 46
eH2_7                 1.123067e-01 1 1  ON 47
eH2_8                 1.046147e-01 1 1  ON 48
eH2_9                 2.960640e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.298
    reference variance = 0.35024
====================================================
  Execution time = 3.7741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4101e-01
  Total weights = 2.0000e+06
  Execution time = 3.1268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341068155820
                                         uncertainty =       0.003343700537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341068155820
                                         uncertainty =       0.003343700537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412920704
  error estimate for blocks of size 2^( 2) =       0.000423024723
  error estimate for blocks of size 2^( 3) =       0.000432357245
  error estimate for blocks of size 2^( 4) =       0.000439150077
  error estimate for blocks of size 2^( 5) =       0.000442925074
  error estimate for blocks of size 2^( 6) =       0.000446353863
  error estimate for blocks of size 2^( 7) =       0.000449395074

      target function =                  N/A
              le_mean =     -17.211643212587
             les_mean =     296.581668922171
             stat err =       0.000444456022
             autocorr =       1.158575317476
              std dev =       0.583958059515
             le_variance =       0.341007015272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341071857852
                                         uncertainty =       0.003343785667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341071857852
                                         uncertainty =       0.003343785667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412922944
  error estimate for blocks of size 2^( 2) =       0.000423026876
  error estimate for blocks of size 2^( 3) =       0.000432359280
  error estimate for blocks of size 2^( 4) =       0.000439152020
  error estimate for blocks of size 2^( 5) =       0.000442926944
  error estimate for blocks of size 2^( 6) =       0.000446355627
  error estimate for blocks of size 2^( 7) =       0.000449396922

      target function =                  N/A
              le_mean =     -17.211643217097
             les_mean =     296.581672778066
             stat err =       0.000444457878
             autocorr =       1.158572422401
              std dev =       0.583961228095
             le_variance =       0.341010715919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341070033261
                                         uncertainty =       0.003343743747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341070033261
                                         uncertainty =       0.003343743747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412921840
  error estimate for blocks of size 2^( 2) =       0.000423025815
  error estimate for blocks of size 2^( 3) =       0.000432358277
  error estimate for blocks of size 2^( 4) =       0.000439151063
  error estimate for blocks of size 2^( 5) =       0.000442926023
  error estimate for blocks of size 2^( 6) =       0.000446354759
  error estimate for blocks of size 2^( 7) =       0.000449396012

      target function =                  N/A
              le_mean =     -17.211643214835
             les_mean =     296.581670876271
             stat err =       0.000444456964
             autocorr =       1.158573853525
              std dev =       0.583959666420
             le_variance =       0.341008892005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341068391328
                                         uncertainty =       0.003343705959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341068391328
                                         uncertainty =       0.003343705959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412920846
  error estimate for blocks of size 2^( 2) =       0.000423024860
  error estimate for blocks of size 2^( 3) =       0.000432357375
  error estimate for blocks of size 2^( 4) =       0.000439150201
  error estimate for blocks of size 2^( 5) =       0.000442925193
  error estimate for blocks of size 2^( 6) =       0.000446353975
  error estimate for blocks of size 2^( 7) =       0.000449395191

      target function =                  N/A
              le_mean =     -17.211643212866
             les_mean =     296.581669167180
             stat err =       0.000444456140
             autocorr =       1.158575133950
              std dev =       0.583958261087
             le_variance =       0.341007250692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211643212587        initial
     2.3842e+01     2.3842e+02             7.0612e-06       -17.211643217097  <--
     9.5367e+01     9.5367e+02             1.7715e-06       -17.211643214835
     3.8147e+02     3.8147e+03             4.4326e-07       -17.211643212866

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 5.3445e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.200523e-01 1 1  ON 0
 uu_1                 5.340721e-02 1 1  ON 1
 uu_2                -4.625412e-02 1 1  ON 2
 uu_3                -1.035685e-01 1 1  ON 3
 uu_4                -1.367449e-01 1 1  ON 4
 uu_5                -1.428219e-01 1 1  ON 5
 uu_6                -1.197522e-01 1 1  ON 6
 uu_7                -5.038490e-02 1 1  ON 7
 uu_8                 8.995731e-02 1 1  ON 8
 uu_9                 1.303712e-01 1 1  ON 9
 ud_0                 3.679307e-01 1 1  ON 10
 ud_1                 1.020745e-01 1 1  ON 11
 ud_2                -1.449575e-02 1 1  ON 12
 ud_3                -7.787739e-02 1 1  ON 13
 ud_4                -1.257424e-01 1 1  ON 14
 ud_5                -1.571944e-01 1 1  ON 15
 ud_6                -1.595603e-01 1 1  ON 16
 ud_7                -1.159932e-01 1 1  ON 17
 ud_8                -1.486030e-02 1 1  ON 18
 ud_9                 9.189065e-02 1 1  ON 19
 eO_0                -8.090128e-01 1 1  ON 20
 eO_1                -4.763357e-01 1 1  ON 21
 eO_2                -4.787281e-02 1 1  ON 22
 eO_3                 2.203165e-01 1 1  ON 23
 eO_4                 3.204323e-01 1 1  ON 24
 eO_5                 3.340213e-01 1 1  ON 25
 eO_6                 2.652436e-01 1 1  ON 26
 eO_7                 1.300098e-01 1 1  ON 27
 eO_8                 3.088414e-02 1 1  ON 28
 eO_9                 1.994386e-02 1 1  ON 29
eH1_0                -1.850424e-01 1 1  ON 30
eH1_1                -1.060739e-01 1 1  ON 31
eH1_2                -6.331892e-02 1 1  ON 32
eH1_3                -2.550897e-02 1 1  ON 33
eH1_4                 1.879927e-02 1 1  ON 34
eH1_5                 3.134191e-02 1 1  ON 35
eH1_6                 7.600683e-02 1 1  ON 36
eH1_7                 1.081458e-01 1 1  ON 37
eH1_8                 1.008429e-01 1 1  ON 38
eH1_9                 2.804976e-02 1 1  ON 39
eH2_0                -1.869443e-01 1 1  ON 40
eH2_1                -1.072321e-01 1 1  ON 41
eH2_2                -6.449816e-02 1 1  ON 42
eH2_3                -2.673746e-02 1 1  ON 43
eH2_4                 1.788057e-02 1 1  ON 44
eH2_5                 3.040296e-02 1 1  ON 45
eH2_6                 7.671312e-02 1 1  ON 46
eH2_7                 1.123070e-01 1 1  ON 47
eH2_8                 1.046170e-01 1 1  ON 48
eH2_9                 2.960718e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0210e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2543
    reference variance = 0.290785
====================================================
  Execution time = 3.7738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.4226e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0420e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342124939419
                                         uncertainty =       0.003775209977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342124939419
                                         uncertainty =       0.003775209977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413681732
  error estimate for blocks of size 2^( 2) =       0.000424381332
  error estimate for blocks of size 2^( 3) =       0.000434123884
  error estimate for blocks of size 2^( 4) =       0.000441085754
  error estimate for blocks of size 2^( 5) =       0.000445705362
  error estimate for blocks of size 2^( 6) =       0.000449926564
  error estimate for blocks of size 2^( 7) =       0.000453775772

      target function =                  N/A
              le_mean =     -17.212813041703
             les_mean =     296.623197787486
             stat err =       0.000447623363
             autocorr =       1.170827208497
              std dev =       0.585034315228
             le_variance =       0.342265149994


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721281304170e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212813041703       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212813069243       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212813112934       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212813164848       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212813095417       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212813124089       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212813114529       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 3.771093e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212813041703       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212813048747       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212813060531       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212813074041       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212813056756       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212813064001       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212813061196       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 9.458672e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212813041703       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212813043474       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212813046478       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212813049891       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212813045579       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212813047399       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212813046669       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.366576e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.521281 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8167e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.200509e-01 1 1  ON 0
 uu_1                 5.341427e-02 1 1  ON 1
 uu_2                -4.625758e-02 1 1  ON 2
 uu_3                -1.035677e-01 1 1  ON 3
 uu_4                -1.367441e-01 1 1  ON 4
 uu_5                -1.428234e-01 1 1  ON 5
 uu_6                -1.197540e-01 1 1  ON 6
 uu_7                -5.038765e-02 1 1  ON 7
 uu_8                 8.995439e-02 1 1  ON 8
 uu_9                 1.303735e-01 1 1  ON 9
 ud_0                 3.679255e-01 1 1  ON 10
 ud_1                 1.020723e-01 1 1  ON 11
 ud_2                -1.449160e-02 1 1  ON 12
 ud_3                -7.787568e-02 1 1  ON 13
 ud_4                -1.257465e-01 1 1  ON 14
 ud_5                -1.571915e-01 1 1  ON 15
 ud_6                -1.595563e-01 1 1  ON 16
 ud_7                -1.159945e-01 1 1  ON 17
 ud_8                -1.486283e-02 1 1  ON 18
 ud_9                 9.189093e-02 1 1  ON 19
 eO_0                -8.090195e-01 1 1  ON 20
 eO_1                -4.763381e-01 1 1  ON 21
 eO_2                -4.787742e-02 1 1  ON 22
 eO_3                 2.203083e-01 1 1  ON 23
 eO_4                 3.204356e-01 1 1  ON 24
 eO_5                 3.340288e-01 1 1  ON 25
 eO_6                 2.652484e-01 1 1  ON 26
 eO_7                 1.300144e-01 1 1  ON 27
 eO_8                 3.088516e-02 1 1  ON 28
 eO_9                 1.994427e-02 1 1  ON 29
eH1_0                -1.850431e-01 1 1  ON 30
eH1_1                -1.060722e-01 1 1  ON 31
eH1_2                -6.331985e-02 1 1  ON 32
eH1_3                -2.550492e-02 1 1  ON 33
eH1_4                 1.879960e-02 1 1  ON 34
eH1_5                 3.133245e-02 1 1  ON 35
eH1_6                 7.600658e-02 1 1  ON 36
eH1_7                 1.081459e-01 1 1  ON 37
eH1_8                 1.008459e-01 1 1  ON 38
eH1_9                 2.805113e-02 1 1  ON 39
eH2_0                -1.869406e-01 1 1  ON 40
eH2_1                -1.072376e-01 1 1  ON 41
eH2_2                -6.449828e-02 1 1  ON 42
eH2_3                -2.673630e-02 1 1  ON 43
eH2_4                 1.787918e-02 1 1  ON 44
eH2_5                 3.040326e-02 1 1  ON 45
eH2_6                 7.671179e-02 1 1  ON 46
eH2_7                 1.123061e-01 1 1  ON 47
eH2_8                 1.046200e-01 1 1  ON 48
eH2_9                 2.960806e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.217
    reference variance = 0.184925
====================================================
  Execution time = 3.7264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3974e-01
  Total weights = 2.0000e+06
  Execution time = 3.1036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339836592544
                                         uncertainty =       0.004500851625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339836592544
                                         uncertainty =       0.004500851625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412156520
  error estimate for blocks of size 2^( 2) =       0.000422867178
  error estimate for blocks of size 2^( 3) =       0.000432687144
  error estimate for blocks of size 2^( 4) =       0.000439464066
  error estimate for blocks of size 2^( 5) =       0.000443203219
  error estimate for blocks of size 2^( 6) =       0.000445615403
  error estimate for blocks of size 2^( 7) =       0.000447457664

      target function =                  N/A
              le_mean =     -17.211935135275
             les_mean =     296.590456925539
             stat err =       0.000443935088
             autocorr =       1.160151204615
              std dev =       0.582877340856
             le_variance =       0.339745994484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339822375162
                                         uncertainty =       0.004500678597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339822375162
                                         uncertainty =       0.004500678597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412147902
  error estimate for blocks of size 2^( 2) =       0.000422859089
  error estimate for blocks of size 2^( 3) =       0.000432679541
  error estimate for blocks of size 2^( 4) =       0.000439456767
  error estimate for blocks of size 2^( 5) =       0.000443195949
  error estimate for blocks of size 2^( 6) =       0.000445608635
  error estimate for blocks of size 2^( 7) =       0.000447450757

      target function =                  N/A
              le_mean =     -17.211935199053
             les_mean =     296.590444912131
             stat err =       0.000443928027
             autocorr =       1.160162819145
              std dev =       0.582865152168
             le_variance =       0.339731785612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339829395316
                                         uncertainty =       0.004500764253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339829395316
                                         uncertainty =       0.004500764253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412152157
  error estimate for blocks of size 2^( 2) =       0.000422863087
  error estimate for blocks of size 2^( 3) =       0.000432683302
  error estimate for blocks of size 2^( 4) =       0.000439460382
  error estimate for blocks of size 2^( 5) =       0.000443199550
  error estimate for blocks of size 2^( 6) =       0.000445611997
  error estimate for blocks of size 2^( 7) =       0.000447454181

      target function =                  N/A
              le_mean =     -17.211935167944
             les_mean =     296.590450857185
             stat err =       0.000443931527
             autocorr =       1.160157156610
              std dev =       0.582871170638
             le_variance =       0.339738801561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339835689235
                                         uncertainty =       0.004500840682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339835689235
                                         uncertainty =       0.004500840682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412155973
  error estimate for blocks of size 2^( 2) =       0.000422866665
  error estimate for blocks of size 2^( 3) =       0.000432686662
  error estimate for blocks of size 2^( 4) =       0.000439463604
  error estimate for blocks of size 2^( 5) =       0.000443202759
  error estimate for blocks of size 2^( 6) =       0.000445614976
  error estimate for blocks of size 2^( 7) =       0.000447457227

      target function =                  N/A
              le_mean =     -17.211935139244
             les_mean =     296.590456159392
             stat err =       0.000443934641
             autocorr =       1.160151952919
              std dev =       0.582876566448
             le_variance =       0.339745091714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211935135275        initial
     5.9605e+00     5.9605e+01             3.7711e-05       -17.211935199053  <--
     2.3842e+01     2.3842e+02             9.4587e-06       -17.211935167944
     9.5367e+01     9.5367e+02             2.3666e-06       -17.211935139244

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 5.2881e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.200472e-01 1 1  ON 0
 uu_1                 5.343398e-02 1 1  ON 1
 uu_2                -4.626686e-02 1 1  ON 2
 uu_3                -1.035656e-01 1 1  ON 3
 uu_4                -1.367417e-01 1 1  ON 4
 uu_5                -1.428276e-01 1 1  ON 5
 uu_6                -1.197593e-01 1 1  ON 6
 uu_7                -5.039582e-02 1 1  ON 7
 uu_8                 8.994571e-02 1 1  ON 8
 uu_9                 1.303803e-01 1 1  ON 9
 ud_0                 3.679102e-01 1 1  ON 10
 ud_1                 1.020667e-01 1 1  ON 11
 ud_2                -1.448023e-02 1 1  ON 12
 ud_3                -7.787059e-02 1 1  ON 13
 ud_4                -1.257583e-01 1 1  ON 14
 ud_5                -1.571834e-01 1 1  ON 15
 ud_6                -1.595446e-01 1 1  ON 16
 ud_7                -1.159981e-01 1 1  ON 17
 ud_8                -1.487035e-02 1 1  ON 18
 ud_9                 9.189177e-02 1 1  ON 19
 eO_0                -8.090388e-01 1 1  ON 20
 eO_1                -4.763456e-01 1 1  ON 21
 eO_2                -4.789104e-02 1 1  ON 22
 eO_3                 2.202843e-01 1 1  ON 23
 eO_4                 3.204452e-01 1 1  ON 24
 eO_5                 3.340511e-01 1 1  ON 25
 eO_6                 2.652625e-01 1 1  ON 26
 eO_7                 1.300278e-01 1 1  ON 27
 eO_8                 3.088821e-02 1 1  ON 28
 eO_9                 1.994548e-02 1 1  ON 29
eH1_0                -1.850451e-01 1 1  ON 30
eH1_1                -1.060673e-01 1 1  ON 31
eH1_2                -6.332210e-02 1 1  ON 32
eH1_3                -2.549326e-02 1 1  ON 33
eH1_4                 1.880077e-02 1 1  ON 34
eH1_5                 3.130420e-02 1 1  ON 35
eH1_6                 7.600575e-02 1 1  ON 36
eH1_7                 1.081463e-01 1 1  ON 37
eH1_8                 1.008551e-01 1 1  ON 38
eH1_9                 2.805521e-02 1 1  ON 39
eH2_0                -1.869298e-01 1 1  ON 40
eH2_1                -1.072536e-01 1 1  ON 41
eH2_2                -6.449852e-02 1 1  ON 42
eH2_3                -2.673316e-02 1 1  ON 43
eH2_4                 1.787527e-02 1 1  ON 44
eH2_5                 3.040407e-02 1 1  ON 45
eH2_6                 7.670785e-02 1 1  ON 46
eH2_7                 1.123034e-01 1 1  ON 47
eH2_8                 1.046291e-01 1 1  ON 48
eH2_9                 2.961067e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0105e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1526
    reference variance = 0.25599
====================================================
  Execution time = 3.7675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4281e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0418e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342749050812
                                         uncertainty =       0.004060999090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342749050812
                                         uncertainty =       0.004060999090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414011295
  error estimate for blocks of size 2^( 2) =       0.000424635094
  error estimate for blocks of size 2^( 3) =       0.000434511822
  error estimate for blocks of size 2^( 4) =       0.000441264774
  error estimate for blocks of size 2^( 5) =       0.000445182276
  error estimate for blocks of size 2^( 6) =       0.000447183070
  error estimate for blocks of size 2^( 7) =       0.000448046858

      target function =                  N/A
              le_mean =     -17.212262773335
             les_mean =     296.604800311881
             stat err =       0.000445419245
             autocorr =       1.157480210050
              std dev =       0.585500388508
             le_variance =       0.342810704943


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721226277334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212262773335       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212263231589       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212263412916       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212263655653       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212263688027       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212263639028       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212263731815       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212263693129       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.369999e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212262773335       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212262896532       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212262945793       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212263016771       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212263037155       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212263020953       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212263037287       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 3.617564e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212262773335       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212262804726       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212262817333       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212262835838       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212262841970       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212262837687       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212262841192       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 9.245187e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.524473 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8102e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.200469e-01 1 1  ON 0
 uu_1                 5.343945e-02 1 1  ON 1
 uu_2                -4.626921e-02 1 1  ON 2
 uu_3                -1.035634e-01 1 1  ON 3
 uu_4                -1.367431e-01 1 1  ON 4
 uu_5                -1.428291e-01 1 1  ON 5
 uu_6                -1.197622e-01 1 1  ON 6
 uu_7                -5.040606e-02 1 1  ON 7
 uu_8                 8.993336e-02 1 1  ON 8
 uu_9                 1.303889e-01 1 1  ON 9
 ud_0                 3.679317e-01 1 1  ON 10
 ud_1                 1.020629e-01 1 1  ON 11
 ud_2                -1.448167e-02 1 1  ON 12
 ud_3                -7.787819e-02 1 1  ON 13
 ud_4                -1.257592e-01 1 1  ON 14
 ud_5                -1.571647e-01 1 1  ON 15
 ud_6                -1.595569e-01 1 1  ON 16
 ud_7                -1.160051e-01 1 1  ON 17
 ud_8                -1.488427e-02 1 1  ON 18
 ud_9                 9.188883e-02 1 1  ON 19
 eO_0                -8.090750e-01 1 1  ON 20
 eO_1                -4.763458e-01 1 1  ON 21
 eO_2                -4.790071e-02 1 1  ON 22
 eO_3                 2.202683e-01 1 1  ON 23
 eO_4                 3.204407e-01 1 1  ON 24
 eO_5                 3.340721e-01 1 1  ON 25
 eO_6                 2.652834e-01 1 1  ON 26
 eO_7                 1.300459e-01 1 1  ON 27
 eO_8                 3.089148e-02 1 1  ON 28
 eO_9                 1.994741e-02 1 1  ON 29
eH1_0                -1.850633e-01 1 1  ON 30
eH1_1                -1.060890e-01 1 1  ON 31
eH1_2                -6.332305e-02 1 1  ON 32
eH1_3                -2.548992e-02 1 1  ON 33
eH1_4                 1.881747e-02 1 1  ON 34
eH1_5                 3.130917e-02 1 1  ON 35
eH1_6                 7.600959e-02 1 1  ON 36
eH1_7                 1.081454e-01 1 1  ON 37
eH1_8                 1.008634e-01 1 1  ON 38
eH1_9                 2.805810e-02 1 1  ON 39
eH2_0                -1.869175e-01 1 1  ON 40
eH2_1                -1.072604e-01 1 1  ON 41
eH2_2                -6.450733e-02 1 1  ON 42
eH2_3                -2.673357e-02 1 1  ON 43
eH2_4                 1.786496e-02 1 1  ON 44
eH2_5                 3.040334e-02 1 1  ON 45
eH2_6                 7.670752e-02 1 1  ON 46
eH2_7                 1.123046e-01 1 1  ON 47
eH2_8                 1.046386e-01 1 1  ON 48
eH2_9                 2.961397e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1704
    reference variance = 0.207166
====================================================
  Execution time = 3.7124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4359e-01
  Total weights = 2.0000e+06
  Execution time = 3.1054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343607719435
                                         uncertainty =       0.005990058751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343607719435
                                         uncertainty =       0.005990058751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414466896
  error estimate for blocks of size 2^( 2) =       0.000424731020
  error estimate for blocks of size 2^( 3) =       0.000433986710
  error estimate for blocks of size 2^( 4) =       0.000440519368
  error estimate for blocks of size 2^( 5) =       0.000444623941
  error estimate for blocks of size 2^( 6) =       0.000447622963
  error estimate for blocks of size 2^( 7) =       0.000447435394

      target function =                  N/A
              le_mean =     -17.211940039864
             les_mean =     296.594445380273
             stat err =       0.000445050416
             autocorr =       1.153025005026
              std dev =       0.586144705845
             le_variance =       0.343565616190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343689369961
                                         uncertainty =       0.005991032518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343689369961
                                         uncertainty =       0.005991032518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414516139
  error estimate for blocks of size 2^( 2) =       0.000424777074
  error estimate for blocks of size 2^( 3) =       0.000434030329
  error estimate for blocks of size 2^( 4) =       0.000440561480
  error estimate for blocks of size 2^( 5) =       0.000444664673
  error estimate for blocks of size 2^( 6) =       0.000447663578
  error estimate for blocks of size 2^( 7) =       0.000447474842

      target function =                  N/A
              le_mean =     -17.211940662182
             les_mean =     296.594548446090
             stat err =       0.000445091143
             autocorr =       1.152962057359
              std dev =       0.586214345986
             le_variance =       0.343647259440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343657000575
                                         uncertainty =       0.005990850879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343657000575
                                         uncertainty =       0.005990850879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414496618
  error estimate for blocks of size 2^( 2) =       0.000424758889
  error estimate for blocks of size 2^( 3) =       0.000434013237
  error estimate for blocks of size 2^( 4) =       0.000440545067
  error estimate for blocks of size 2^( 5) =       0.000444648764
  error estimate for blocks of size 2^( 6) =       0.000447647753
  error estimate for blocks of size 2^( 7) =       0.000447459445

      target function =                  N/A
              le_mean =     -17.211940412648
             les_mean =     296.594507489836
             stat err =       0.000445075257
             autocorr =       1.152988352813
              std dev =       0.586186739107
             le_variance =       0.343614893104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343614187482
                                         uncertainty =       0.005990165869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343614187482
                                         uncertainty =       0.005990165869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414470797
  error estimate for blocks of size 2^( 2) =       0.000424734679
  error estimate for blocks of size 2^( 3) =       0.000433990193
  error estimate for blocks of size 2^( 4) =       0.000440522742
  error estimate for blocks of size 2^( 5) =       0.000444627200
  error estimate for blocks of size 2^( 6) =       0.000447626217
  error estimate for blocks of size 2^( 7) =       0.000447438555

      target function =                  N/A
              le_mean =     -17.211940087158
             les_mean =     296.594453475774
             stat err =       0.000445053678
             autocorr =       1.153020201412
              std dev =       0.586150222760
             le_variance =       0.343572083641


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211940039864        initial
     1.4901e+00     1.4901e+01             1.3700e-04       -17.211940662182  <--
     5.9605e+00     5.9605e+01             3.6176e-05       -17.211940412648
     2.3842e+01     2.3842e+02             9.2452e-06       -17.211940087158

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 5.2721e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.200502e-01 1 1  ON 0
 uu_1                 5.345199e-02 1 1  ON 1
 uu_2                -4.627315e-02 1 1  ON 2
 uu_3                -1.035610e-01 1 1  ON 3
 uu_4                -1.367469e-01 1 1  ON 4
 uu_5                -1.428345e-01 1 1  ON 5
 uu_6                -1.197716e-01 1 1  ON 6
 uu_7                -5.043784e-02 1 1  ON 7
 uu_8                 8.989435e-02 1 1  ON 8
 uu_9                 1.304162e-01 1 1  ON 9
 ud_0                 3.679826e-01 1 1  ON 10
 ud_1                 1.020637e-01 1 1  ON 11
 ud_2                -1.448699e-02 1 1  ON 12
 ud_3                -7.789121e-02 1 1  ON 13
 ud_4                -1.257602e-01 1 1  ON 14
 ud_5                -1.571178e-01 1 1  ON 15
 ud_6                -1.595930e-01 1 1  ON 16
 ud_7                -1.160255e-01 1 1  ON 17
 ud_8                -1.492818e-02 1 1  ON 18
 ud_9                 9.187954e-02 1 1  ON 19
 eO_0                -8.091758e-01 1 1  ON 20
 eO_1                -4.763612e-01 1 1  ON 21
 eO_2                -4.793414e-02 1 1  ON 22
 eO_3                 2.202218e-01 1 1  ON 23
 eO_4                 3.204251e-01 1 1  ON 24
 eO_5                 3.341387e-01 1 1  ON 25
 eO_6                 2.653502e-01 1 1  ON 26
 eO_7                 1.301040e-01 1 1  ON 27
 eO_8                 3.090192e-02 1 1  ON 28
 eO_9                 1.995355e-02 1 1  ON 29
eH1_0                -1.851166e-01 1 1  ON 30
eH1_1                -1.061493e-01 1 1  ON 31
eH1_2                -6.333069e-02 1 1  ON 32
eH1_3                -2.547842e-02 1 1  ON 33
eH1_4                 1.886344e-02 1 1  ON 34
eH1_5                 3.132210e-02 1 1  ON 35
eH1_6                 7.602180e-02 1 1  ON 36
eH1_7                 1.081428e-01 1 1  ON 37
eH1_8                 1.008898e-01 1 1  ON 38
eH1_9                 2.806731e-02 1 1  ON 39
eH2_0                -1.868832e-01 1 1  ON 40
eH2_1                -1.072833e-01 1 1  ON 41
eH2_2                -6.452891e-02 1 1  ON 42
eH2_3                -2.674090e-02 1 1  ON 43
eH2_4                 1.783825e-02 1 1  ON 44
eH2_5                 3.040018e-02 1 1  ON 45
eH2_6                 7.670630e-02 1 1  ON 46
eH2_7                 1.123085e-01 1 1  ON 47
eH2_8                 1.046687e-01 1 1  ON 48
eH2_9                 2.962449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0083e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2593
    reference variance = 0.495978
====================================================
  Execution time = 3.7268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3893e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0426e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338683051984
                                         uncertainty =       0.004187159163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338683051984
                                         uncertainty =       0.004187159163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411662112
  error estimate for blocks of size 2^( 2) =       0.000422438120
  error estimate for blocks of size 2^( 3) =       0.000431958978
  error estimate for blocks of size 2^( 4) =       0.000438244381
  error estimate for blocks of size 2^( 5) =       0.000442862236
  error estimate for blocks of size 2^( 6) =       0.000444871796
  error estimate for blocks of size 2^( 7) =       0.000446370296

      target function =                  N/A
              le_mean =     -17.212281310571
             les_mean =     296.601559133596
             stat err =       0.000443087177
             autocorr =       1.158501413892
              std dev =       0.582178141826
             le_variance =       0.338931388820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721228131057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212281310571       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212281930202       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212282500795       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212282664657       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212282796776       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212282541295       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212282600803       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212282668998       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212282577106       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 5.116175e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212281310571       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212281526015       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212281729083       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212281766134       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212281817477       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212281770401       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212281803821       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212281787319       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.311509e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212281310571       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212281370264       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212281427946       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212281436228       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212281451081       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212281442442       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212281453091       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 3.268129e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.528235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7704e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.199786e-01 1 1  ON 0
 uu_1                 5.349958e-02 1 1  ON 1
 uu_2                -4.625491e-02 1 1  ON 2
 uu_3                -1.035800e-01 1 1  ON 3
 uu_4                -1.367776e-01 1 1  ON 4
 uu_5                -1.428821e-01 1 1  ON 5
 uu_6                -1.197460e-01 1 1  ON 6
 uu_7                -5.042377e-02 1 1  ON 7
 uu_8                 8.987315e-02 1 1  ON 8
 uu_9                 1.304545e-01 1 1  ON 9
 ud_0                 3.679192e-01 1 1  ON 10
 ud_1                 1.021001e-01 1 1  ON 11
 ud_2                -1.447140e-02 1 1  ON 12
 ud_3                -7.788175e-02 1 1  ON 13
 ud_4                -1.258011e-01 1 1  ON 14
 ud_5                -1.570829e-01 1 1  ON 15
 ud_6                -1.595718e-01 1 1  ON 16
 ud_7                -1.160153e-01 1 1  ON 17
 ud_8                -1.497552e-02 1 1  ON 18
 ud_9                 9.187724e-02 1 1  ON 19
 eO_0                -8.093069e-01 1 1  ON 20
 eO_1                -4.764877e-01 1 1  ON 21
 eO_2                -4.801020e-02 1 1  ON 22
 eO_3                 2.202604e-01 1 1  ON 23
 eO_4                 3.204479e-01 1 1  ON 24
 eO_5                 3.342043e-01 1 1  ON 25
 eO_6                 2.654497e-01 1 1  ON 26
 eO_7                 1.301947e-01 1 1  ON 27
 eO_8                 3.091473e-02 1 1  ON 28
 eO_9                 1.995604e-02 1 1  ON 29
eH1_0                -1.851416e-01 1 1  ON 30
eH1_1                -1.062199e-01 1 1  ON 31
eH1_2                -6.328818e-02 1 1  ON 32
eH1_3                -2.549385e-02 1 1  ON 33
eH1_4                 1.895978e-02 1 1  ON 34
eH1_5                 3.125402e-02 1 1  ON 35
eH1_6                 7.599771e-02 1 1  ON 36
eH1_7                 1.081476e-01 1 1  ON 37
eH1_8                 1.009333e-01 1 1  ON 38
eH1_9                 2.808267e-02 1 1  ON 39
eH2_0                -1.869458e-01 1 1  ON 40
eH2_1                -1.073706e-01 1 1  ON 41
eH2_2                -6.455821e-02 1 1  ON 42
eH2_3                -2.671608e-02 1 1  ON 43
eH2_4                 1.789398e-02 1 1  ON 44
eH2_5                 3.040322e-02 1 1  ON 45
eH2_6                 7.670647e-02 1 1  ON 46
eH2_7                 1.123274e-01 1 1  ON 47
eH2_8                 1.047249e-01 1 1  ON 48
eH2_9                 2.964175e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1677
    reference variance = 0.259916
====================================================
  Execution time = 3.7494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4240e-01
  Total weights = 2.0000e+06
  Execution time = 3.0868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342615084961
                                         uncertainty =       0.004070845514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342615084961
                                         uncertainty =       0.004070845514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413822499
  error estimate for blocks of size 2^( 2) =       0.000424145722
  error estimate for blocks of size 2^( 3) =       0.000433936204
  error estimate for blocks of size 2^( 4) =       0.000441718513
  error estimate for blocks of size 2^( 5) =       0.000445679609
  error estimate for blocks of size 2^( 6) =       0.000448478273
  error estimate for blocks of size 2^( 7) =       0.000449150373

      target function =                  N/A
              le_mean =     -17.211990510604
             les_mean =     296.595115287269
             stat err =       0.000446256692
             autocorr =       1.162897094983
              std dev =       0.585233390549
             le_variance =       0.342498121413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342432551143
                                         uncertainty =       0.004068856485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342432551143
                                         uncertainty =       0.004068856485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413712177
  error estimate for blocks of size 2^( 2) =       0.000424039805
  error estimate for blocks of size 2^( 3) =       0.000433833965
  error estimate for blocks of size 2^( 4) =       0.000441616545
  error estimate for blocks of size 2^( 5) =       0.000445584609
  error estimate for blocks of size 2^( 6) =       0.000448384654
  error estimate for blocks of size 2^( 7) =       0.000449068191

      target function =                  N/A
              le_mean =     -17.211990238685
             les_mean =     296.594923335486
             stat err =       0.000446163500
             autocorr =       1.163031479183
              std dev =       0.585077371015
             le_variance =       0.342315530073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342426626229
                                         uncertainty =       0.004068709914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342426626229
                                         uncertainty =       0.004068709914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413708615
  error estimate for blocks of size 2^( 2) =       0.000424036614
  error estimate for blocks of size 2^( 3) =       0.000433830954
  error estimate for blocks of size 2^( 4) =       0.000441614257
  error estimate for blocks of size 2^( 5) =       0.000445581465
  error estimate for blocks of size 2^( 6) =       0.000448381002
  error estimate for blocks of size 2^( 7) =       0.000449061705

      target function =                  N/A
              le_mean =     -17.211989886432
             les_mean =     296.594905315125
             stat err =       0.000446159608
             autocorr =       1.163031213106
              std dev =       0.585072333683
             le_variance =       0.342309635641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342583923840
                                         uncertainty =       0.004070488409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342583923840
                                         uncertainty =       0.004070488409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413803672
  error estimate for blocks of size 2^( 2) =       0.000424127695
  error estimate for blocks of size 2^( 3) =       0.000433918818
  error estimate for blocks of size 2^( 4) =       0.000441701334
  error estimate for blocks of size 2^( 5) =       0.000445663377
  error estimate for blocks of size 2^( 6) =       0.000448462175
  error estimate for blocks of size 2^( 7) =       0.000449135528

      target function =                  N/A
              le_mean =     -17.211990385095
             les_mean =     296.595079803218
             stat err =       0.000446240604
             autocorr =       1.162919059998
              std dev =       0.585206765054
             le_variance =       0.342466957865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211990510604        initial  <--
     3.7253e-01     3.7253e+00             5.1162e-04       -17.211990238685
     1.4901e+00     1.4901e+01             1.3115e-04       -17.211989886432
     5.9605e+00     5.9605e+01             3.2681e-05       -17.211990385095

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0579
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.200502e-01 1 1  ON 0
 uu_1                 5.345199e-02 1 1  ON 1
 uu_2                -4.627315e-02 1 1  ON 2
 uu_3                -1.035610e-01 1 1  ON 3
 uu_4                -1.367469e-01 1 1  ON 4
 uu_5                -1.428345e-01 1 1  ON 5
 uu_6                -1.197716e-01 1 1  ON 6
 uu_7                -5.043784e-02 1 1  ON 7
 uu_8                 8.989435e-02 1 1  ON 8
 uu_9                 1.304162e-01 1 1  ON 9
 ud_0                 3.679826e-01 1 1  ON 10
 ud_1                 1.020637e-01 1 1  ON 11
 ud_2                -1.448699e-02 1 1  ON 12
 ud_3                -7.789121e-02 1 1  ON 13
 ud_4                -1.257602e-01 1 1  ON 14
 ud_5                -1.571178e-01 1 1  ON 15
 ud_6                -1.595930e-01 1 1  ON 16
 ud_7                -1.160255e-01 1 1  ON 17
 ud_8                -1.492818e-02 1 1  ON 18
 ud_9                 9.187954e-02 1 1  ON 19
 eO_0                -8.091758e-01 1 1  ON 20
 eO_1                -4.763612e-01 1 1  ON 21
 eO_2                -4.793414e-02 1 1  ON 22
 eO_3                 2.202218e-01 1 1  ON 23
 eO_4                 3.204251e-01 1 1  ON 24
 eO_5                 3.341387e-01 1 1  ON 25
 eO_6                 2.653502e-01 1 1  ON 26
 eO_7                 1.301040e-01 1 1  ON 27
 eO_8                 3.090192e-02 1 1  ON 28
 eO_9                 1.995355e-02 1 1  ON 29
eH1_0                -1.851166e-01 1 1  ON 30
eH1_1                -1.061493e-01 1 1  ON 31
eH1_2                -6.333069e-02 1 1  ON 32
eH1_3                -2.547842e-02 1 1  ON 33
eH1_4                 1.886344e-02 1 1  ON 34
eH1_5                 3.132210e-02 1 1  ON 35
eH1_6                 7.602180e-02 1 1  ON 36
eH1_7                 1.081428e-01 1 1  ON 37
eH1_8                 1.008898e-01 1 1  ON 38
eH1_9                 2.806731e-02 1 1  ON 39
eH2_0                -1.868832e-01 1 1  ON 40
eH2_1                -1.072833e-01 1 1  ON 41
eH2_2                -6.452891e-02 1 1  ON 42
eH2_3                -2.674090e-02 1 1  ON 43
eH2_4                 1.783825e-02 1 1  ON 44
eH2_5                 3.040018e-02 1 1  ON 45
eH2_6                 7.670630e-02 1 1  ON 46
eH2_7                 1.123085e-01 1 1  ON 47
eH2_8                 1.046687e-01 1 1  ON 48
eH2_9                 2.962449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0077e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.185
    reference variance = 0.154062
====================================================
  Execution time = 3.7526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3891e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0541e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338968980737
                                         uncertainty =       0.003638649701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338968980737
                                         uncertainty =       0.003638649701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411650414
  error estimate for blocks of size 2^( 2) =       0.000422568441
  error estimate for blocks of size 2^( 3) =       0.000432420120
  error estimate for blocks of size 2^( 4) =       0.000439605128
  error estimate for blocks of size 2^( 5) =       0.000444355246
  error estimate for blocks of size 2^( 6) =       0.000446063375
  error estimate for blocks of size 2^( 7) =       0.000448306568

      target function =                  N/A
              le_mean =     -17.212030267903
             les_mean =     296.592897900665
             stat err =       0.000444582579
             autocorr =       1.166400690761
              std dev =       0.582161598615
             le_variance =       0.338912126902


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721203026790e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212030267903       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212030436899       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212030543315       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212030441729       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212030396352       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212030449422       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212030459055       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 5.156299e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212030267903       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212030312479       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212030342348       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212030317159       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212030305273       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212030317631       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212030320402       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.339691e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212030267903       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212030279203       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212030286902       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212030280633       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212030277629       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212030280651       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212030281364       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.383670e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.531310 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8076e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.200563e-01 1 1  ON 0
 uu_1                 5.345439e-02 1 1  ON 1
 uu_2                -4.628099e-02 1 1  ON 2
 uu_3                -1.035616e-01 1 1  ON 3
 uu_4                -1.367501e-01 1 1  ON 4
 uu_5                -1.428367e-01 1 1  ON 5
 uu_6                -1.197706e-01 1 1  ON 6
 uu_7                -5.043907e-02 1 1  ON 7
 uu_8                 8.989155e-02 1 1  ON 8
 uu_9                 1.304197e-01 1 1  ON 9
 ud_0                 3.679814e-01 1 1  ON 10
 ud_1                 1.020668e-01 1 1  ON 11
 ud_2                -1.448321e-02 1 1  ON 12
 ud_3                -7.788902e-02 1 1  ON 13
 ud_4                -1.257685e-01 1 1  ON 14
 ud_5                -1.571200e-01 1 1  ON 15
 ud_6                -1.595903e-01 1 1  ON 16
 ud_7                -1.160258e-01 1 1  ON 17
 ud_8                -1.493178e-02 1 1  ON 18
 ud_9                 9.187956e-02 1 1  ON 19
 eO_0                -8.091831e-01 1 1  ON 20
 eO_1                -4.763746e-01 1 1  ON 21
 eO_2                -4.794099e-02 1 1  ON 22
 eO_3                 2.202244e-01 1 1  ON 23
 eO_4                 3.204187e-01 1 1  ON 24
 eO_5                 3.341490e-01 1 1  ON 25
 eO_6                 2.653604e-01 1 1  ON 26
 eO_7                 1.301121e-01 1 1  ON 27
 eO_8                 3.090346e-02 1 1  ON 28
 eO_9                 1.995407e-02 1 1  ON 29
eH1_0                -1.851200e-01 1 1  ON 30
eH1_1                -1.061499e-01 1 1  ON 31
eH1_2                -6.332720e-02 1 1  ON 32
eH1_3                -2.548234e-02 1 1  ON 33
eH1_4                 1.886894e-02 1 1  ON 34
eH1_5                 3.131763e-02 1 1  ON 35
eH1_6                 7.601883e-02 1 1  ON 36
eH1_7                 1.081416e-01 1 1  ON 37
eH1_8                 1.008950e-01 1 1  ON 38
eH1_9                 2.806928e-02 1 1  ON 39
eH2_0                -1.868838e-01 1 1  ON 40
eH2_1                -1.072832e-01 1 1  ON 41
eH2_2                -6.453240e-02 1 1  ON 42
eH2_3                -2.674631e-02 1 1  ON 43
eH2_4                 1.784323e-02 1 1  ON 44
eH2_5                 3.039845e-02 1 1  ON 45
eH2_6                 7.670858e-02 1 1  ON 46
eH2_7                 1.123068e-01 1 1  ON 47
eH2_8                 1.046726e-01 1 1  ON 48
eH2_9                 2.962565e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2052
    reference variance = 0.229101
====================================================
  Execution time = 3.6862e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4250e-01
  Total weights = 2.0000e+06
  Execution time = 3.0936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342552887877
                                         uncertainty =       0.003336126921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342552887877
                                         uncertainty =       0.003336126921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413823565
  error estimate for blocks of size 2^( 2) =       0.000424320756
  error estimate for blocks of size 2^( 3) =       0.000434076260
  error estimate for blocks of size 2^( 4) =       0.000441840225
  error estimate for blocks of size 2^( 5) =       0.000445783326
  error estimate for blocks of size 2^( 6) =       0.000448575546
  error estimate for blocks of size 2^( 7) =       0.000449839990

      target function =                  N/A
              le_mean =     -17.211411953557
             les_mean =     296.575201150016
             stat err =       0.000446509772
             autocorr =       1.164210466621
              std dev =       0.585234898337
             le_variance =       0.342499886231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342552129463
                                         uncertainty =       0.003336395894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342552129463
                                         uncertainty =       0.003336395894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413823101
  error estimate for blocks of size 2^( 2) =       0.000424320944
  error estimate for blocks of size 2^( 3) =       0.000434076648
  error estimate for blocks of size 2^( 4) =       0.000441840566
  error estimate for blocks of size 2^( 5) =       0.000445783493
  error estimate for blocks of size 2^( 6) =       0.000448575095
  error estimate for blocks of size 2^( 7) =       0.000449838647

      target function =                  N/A
              le_mean =     -17.211411883649
             les_mean =     296.575197974837
             stat err =       0.000446509450
             autocorr =       1.164211404240
              std dev =       0.585234241550
             le_variance =       0.342499117483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342552577448
                                         uncertainty =       0.003336272759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342552577448
                                         uncertainty =       0.003336272759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413823374
  error estimate for blocks of size 2^( 2) =       0.000424320910
  error estimate for blocks of size 2^( 3) =       0.000434076519
  error estimate for blocks of size 2^( 4) =       0.000441840464
  error estimate for blocks of size 2^( 5) =       0.000445783474
  error estimate for blocks of size 2^( 6) =       0.000448575340
  error estimate for blocks of size 2^( 7) =       0.000449839292

      target function =                  N/A
              le_mean =     -17.211411908245
             les_mean =     296.575199274081
             stat err =       0.000446509642
             autocorr =       1.164210867568
              std dev =       0.585234628200
             le_variance =       0.342499570045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342552852557
                                         uncertainty =       0.003336145561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342552852557
                                         uncertainty =       0.003336145561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413823543
  error estimate for blocks of size 2^( 2) =       0.000424320778
  error estimate for blocks of size 2^( 3) =       0.000434076295
  error estimate for blocks of size 2^( 4) =       0.000441840258
  error estimate for blocks of size 2^( 5) =       0.000445783347
  error estimate for blocks of size 2^( 6) =       0.000448575521
  error estimate for blocks of size 2^( 7) =       0.000449839902

      target function =                  N/A
              le_mean =     -17.211411947268
             les_mean =     296.575200897466
             stat err =       0.000446509757
             autocorr =       1.164210511338
              std dev =       0.585234867528
             le_variance =       0.342499850170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211411953557        initial  <--
     3.7253e+00     3.7253e+01             5.1563e-05       -17.211411883649
     1.4901e+01     1.4901e+02             1.3397e-05       -17.211411908245
     5.9605e+01     5.9605e+02             3.3837e-06       -17.211411947268

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.4308
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.200502e-01 1 1  ON 0
 uu_1                 5.345199e-02 1 1  ON 1
 uu_2                -4.627315e-02 1 1  ON 2
 uu_3                -1.035610e-01 1 1  ON 3
 uu_4                -1.367469e-01 1 1  ON 4
 uu_5                -1.428345e-01 1 1  ON 5
 uu_6                -1.197716e-01 1 1  ON 6
 uu_7                -5.043784e-02 1 1  ON 7
 uu_8                 8.989435e-02 1 1  ON 8
 uu_9                 1.304162e-01 1 1  ON 9
 ud_0                 3.679826e-01 1 1  ON 10
 ud_1                 1.020637e-01 1 1  ON 11
 ud_2                -1.448699e-02 1 1  ON 12
 ud_3                -7.789121e-02 1 1  ON 13
 ud_4                -1.257602e-01 1 1  ON 14
 ud_5                -1.571178e-01 1 1  ON 15
 ud_6                -1.595930e-01 1 1  ON 16
 ud_7                -1.160255e-01 1 1  ON 17
 ud_8                -1.492818e-02 1 1  ON 18
 ud_9                 9.187954e-02 1 1  ON 19
 eO_0                -8.091758e-01 1 1  ON 20
 eO_1                -4.763612e-01 1 1  ON 21
 eO_2                -4.793414e-02 1 1  ON 22
 eO_3                 2.202218e-01 1 1  ON 23
 eO_4                 3.204251e-01 1 1  ON 24
 eO_5                 3.341387e-01 1 1  ON 25
 eO_6                 2.653502e-01 1 1  ON 26
 eO_7                 1.301040e-01 1 1  ON 27
 eO_8                 3.090192e-02 1 1  ON 28
 eO_9                 1.995355e-02 1 1  ON 29
eH1_0                -1.851166e-01 1 1  ON 30
eH1_1                -1.061493e-01 1 1  ON 31
eH1_2                -6.333069e-02 1 1  ON 32
eH1_3                -2.547842e-02 1 1  ON 33
eH1_4                 1.886344e-02 1 1  ON 34
eH1_5                 3.132210e-02 1 1  ON 35
eH1_6                 7.602180e-02 1 1  ON 36
eH1_7                 1.081428e-01 1 1  ON 37
eH1_8                 1.008898e-01 1 1  ON 38
eH1_9                 2.806731e-02 1 1  ON 39
eH2_0                -1.868832e-01 1 1  ON 40
eH2_1                -1.072833e-01 1 1  ON 41
eH2_2                -6.452891e-02 1 1  ON 42
eH2_3                -2.674090e-02 1 1  ON 43
eH2_4                 1.783825e-02 1 1  ON 44
eH2_5                 3.040018e-02 1 1  ON 45
eH2_6                 7.670630e-02 1 1  ON 46
eH2_7                 1.123085e-01 1 1  ON 47
eH2_8                 1.046687e-01 1 1  ON 48
eH2_9                 2.962449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0051e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2149
    reference variance = 0.140708
====================================================
  Execution time = 3.7705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4162e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0265e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341725034159
                                         uncertainty =       0.004377983063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341725034159
                                         uncertainty =       0.004377983063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413290810
  error estimate for blocks of size 2^( 2) =       0.000423955733
  error estimate for blocks of size 2^( 3) =       0.000433655474
  error estimate for blocks of size 2^( 4) =       0.000440857484
  error estimate for blocks of size 2^( 5) =       0.000445325917
  error estimate for blocks of size 2^( 6) =       0.000446429288
  error estimate for blocks of size 2^( 7) =       0.000447731565

      target function =                  N/A
              le_mean =     -17.212247338834
             les_mean =     296.603076869430
             stat err =       0.000445086063
             autocorr =       1.159782349758
              std dev =       0.584481468507
             le_variance =       0.341618587028


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721224733883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212247338834       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212247344711       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212247352813       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212247335368       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212247333394       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212247334795       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212247339560       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 6.002695e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212247338834       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212247340309       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212247342348       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212247337969       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212247337468       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212247337783       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212247338985       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.505436e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212247338834       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212247339203       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212247339714       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212247338618       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212247338492       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212247338569       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212247338870       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.766576e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.534439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7980e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.200492e-01 1 1  ON 0
 uu_1                 5.345246e-02 1 1  ON 1
 uu_2                -4.627293e-02 1 1  ON 2
 uu_3                -1.035609e-01 1 1  ON 3
 uu_4                -1.367466e-01 1 1  ON 4
 uu_5                -1.428350e-01 1 1  ON 5
 uu_6                -1.197715e-01 1 1  ON 6
 uu_7                -5.043762e-02 1 1  ON 7
 uu_8                 8.989394e-02 1 1  ON 8
 uu_9                 1.304164e-01 1 1  ON 9
 ud_0                 3.679825e-01 1 1  ON 10
 ud_1                 1.020636e-01 1 1  ON 11
 ud_2                -1.448717e-02 1 1  ON 12
 ud_3                -7.789075e-02 1 1  ON 13
 ud_4                -1.257602e-01 1 1  ON 14
 ud_5                -1.571178e-01 1 1  ON 15
 ud_6                -1.595925e-01 1 1  ON 16
 ud_7                -1.160256e-01 1 1  ON 17
 ud_8                -1.492883e-02 1 1  ON 18
 ud_9                 9.187939e-02 1 1  ON 19
 eO_0                -8.091772e-01 1 1  ON 20
 eO_1                -4.763610e-01 1 1  ON 21
 eO_2                -4.793565e-02 1 1  ON 22
 eO_3                 2.202215e-01 1 1  ON 23
 eO_4                 3.204249e-01 1 1  ON 24
 eO_5                 3.341397e-01 1 1  ON 25
 eO_6                 2.653512e-01 1 1  ON 26
 eO_7                 1.301049e-01 1 1  ON 27
 eO_8                 3.090202e-02 1 1  ON 28
 eO_9                 1.995357e-02 1 1  ON 29
eH1_0                -1.851173e-01 1 1  ON 30
eH1_1                -1.061492e-01 1 1  ON 31
eH1_2                -6.333049e-02 1 1  ON 32
eH1_3                -2.547801e-02 1 1  ON 33
eH1_4                 1.886389e-02 1 1  ON 34
eH1_5                 3.132133e-02 1 1  ON 35
eH1_6                 7.602141e-02 1 1  ON 36
eH1_7                 1.081428e-01 1 1  ON 37
eH1_8                 1.008903e-01 1 1  ON 38
eH1_9                 2.806743e-02 1 1  ON 39
eH2_0                -1.868832e-01 1 1  ON 40
eH2_1                -1.072837e-01 1 1  ON 41
eH2_2                -6.452926e-02 1 1  ON 42
eH2_3                -2.674066e-02 1 1  ON 43
eH2_4                 1.783802e-02 1 1  ON 44
eH2_5                 3.040006e-02 1 1  ON 45
eH2_6                 7.670644e-02 1 1  ON 46
eH2_7                 1.123086e-01 1 1  ON 47
eH2_8                 1.046692e-01 1 1  ON 48
eH2_9                 2.962464e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1785
    reference variance = 0.22735
====================================================
  Execution time = 3.6789e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3824e-01
  Total weights = 2.0000e+06
  Execution time = 3.1174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338226558943
                                         uncertainty =       0.002840806612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338226558943
                                         uncertainty =       0.002840806612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411243771
  error estimate for blocks of size 2^( 2) =       0.000421952712
  error estimate for blocks of size 2^( 3) =       0.000431801374
  error estimate for blocks of size 2^( 4) =       0.000438726629
  error estimate for blocks of size 2^( 5) =       0.000443835734
  error estimate for blocks of size 2^( 6) =       0.000447415412
  error estimate for blocks of size 2^( 7) =       0.000448268704

      target function =                  N/A
              le_mean =     -17.212130500813
             les_mean =     296.595679086433
             stat err =       0.000444561620
             autocorr =       1.168598342412
              std dev =       0.581586518531
             le_variance =       0.338242878537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338226129537
                                         uncertainty =       0.002840781071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338226129537
                                         uncertainty =       0.002840781071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411243510
  error estimate for blocks of size 2^( 2) =       0.000421952414
  error estimate for blocks of size 2^( 3) =       0.000431801038
  error estimate for blocks of size 2^( 4) =       0.000438726324
  error estimate for blocks of size 2^( 5) =       0.000443835430
  error estimate for blocks of size 2^( 6) =       0.000447415073
  error estimate for blocks of size 2^( 7) =       0.000448268438

      target function =                  N/A
              le_mean =     -17.212130488175
             les_mean =     296.595678221788
             stat err =       0.000444561316
             autocorr =       1.168598232711
              std dev =       0.581586149196
             le_variance =       0.338242448936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338226346505
                                         uncertainty =       0.002840793763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338226346505
                                         uncertainty =       0.002840793763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411243642
  error estimate for blocks of size 2^( 2) =       0.000421952564
  error estimate for blocks of size 2^( 3) =       0.000431801207
  error estimate for blocks of size 2^( 4) =       0.000438726477
  error estimate for blocks of size 2^( 5) =       0.000443835582
  error estimate for blocks of size 2^( 6) =       0.000447415243
  error estimate for blocks of size 2^( 7) =       0.000448268572

      target function =                  N/A
              le_mean =     -17.212130494459
             les_mean =     296.595678655155
             stat err =       0.000444561469
             autocorr =       1.168598283358
              std dev =       0.581586335812
             le_variance =       0.338242666003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338226532446
                                         uncertainty =       0.002840805003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338226532446
                                         uncertainty =       0.002840805003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411243755
  error estimate for blocks of size 2^( 2) =       0.000421952694
  error estimate for blocks of size 2^( 3) =       0.000431801353
  error estimate for blocks of size 2^( 4) =       0.000438726610
  error estimate for blocks of size 2^( 5) =       0.000443835715
  error estimate for blocks of size 2^( 6) =       0.000447415391
  error estimate for blocks of size 2^( 7) =       0.000448268687

      target function =                  N/A
              le_mean =     -17.212130500016
             les_mean =     296.595679032496
             stat err =       0.000444561601
             autocorr =       1.168598334913
              std dev =       0.581586495741
             le_variance =       0.338242852029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212130500813        initial  <--
     3.7253e+01     3.7253e+02             6.0027e-06       -17.212130488175
     1.4901e+02     1.4901e+03             1.5054e-06       -17.212130494459
     5.9605e+02     5.9605e+03             3.7666e-07       -17.212130500016

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.4513
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.200502e-01 1 1  ON 0
 uu_1                 5.345199e-02 1 1  ON 1
 uu_2                -4.627315e-02 1 1  ON 2
 uu_3                -1.035610e-01 1 1  ON 3
 uu_4                -1.367469e-01 1 1  ON 4
 uu_5                -1.428345e-01 1 1  ON 5
 uu_6                -1.197716e-01 1 1  ON 6
 uu_7                -5.043784e-02 1 1  ON 7
 uu_8                 8.989435e-02 1 1  ON 8
 uu_9                 1.304162e-01 1 1  ON 9
 ud_0                 3.679826e-01 1 1  ON 10
 ud_1                 1.020637e-01 1 1  ON 11
 ud_2                -1.448699e-02 1 1  ON 12
 ud_3                -7.789121e-02 1 1  ON 13
 ud_4                -1.257602e-01 1 1  ON 14
 ud_5                -1.571178e-01 1 1  ON 15
 ud_6                -1.595930e-01 1 1  ON 16
 ud_7                -1.160255e-01 1 1  ON 17
 ud_8                -1.492818e-02 1 1  ON 18
 ud_9                 9.187954e-02 1 1  ON 19
 eO_0                -8.091758e-01 1 1  ON 20
 eO_1                -4.763612e-01 1 1  ON 21
 eO_2                -4.793414e-02 1 1  ON 22
 eO_3                 2.202218e-01 1 1  ON 23
 eO_4                 3.204251e-01 1 1  ON 24
 eO_5                 3.341387e-01 1 1  ON 25
 eO_6                 2.653502e-01 1 1  ON 26
 eO_7                 1.301040e-01 1 1  ON 27
 eO_8                 3.090192e-02 1 1  ON 28
 eO_9                 1.995355e-02 1 1  ON 29
eH1_0                -1.851166e-01 1 1  ON 30
eH1_1                -1.061493e-01 1 1  ON 31
eH1_2                -6.333069e-02 1 1  ON 32
eH1_3                -2.547842e-02 1 1  ON 33
eH1_4                 1.886344e-02 1 1  ON 34
eH1_5                 3.132210e-02 1 1  ON 35
eH1_6                 7.602180e-02 1 1  ON 36
eH1_7                 1.081428e-01 1 1  ON 37
eH1_8                 1.008898e-01 1 1  ON 38
eH1_9                 2.806731e-02 1 1  ON 39
eH2_0                -1.868832e-01 1 1  ON 40
eH2_1                -1.072833e-01 1 1  ON 41
eH2_2                -6.452891e-02 1 1  ON 42
eH2_3                -2.674090e-02 1 1  ON 43
eH2_4                 1.783825e-02 1 1  ON 44
eH2_5                 3.040018e-02 1 1  ON 45
eH2_6                 7.670630e-02 1 1  ON 46
eH2_7                 1.123085e-01 1 1  ON 47
eH2_8                 1.046687e-01 1 1  ON 48
eH2_9                 2.962449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0044e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1834
    reference variance = 0.581361
====================================================
  Execution time = 3.7358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4377e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0366e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343711017326
                                         uncertainty =       0.005891740974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343711017326
                                         uncertainty =       0.005891740974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414590155
  error estimate for blocks of size 2^( 2) =       0.000425586588
  error estimate for blocks of size 2^( 3) =       0.000435222711
  error estimate for blocks of size 2^( 4) =       0.000442360790
  error estimate for blocks of size 2^( 5) =       0.000446595352
  error estimate for blocks of size 2^( 6) =       0.000449974298
  error estimate for blocks of size 2^( 7) =       0.000452135977

      target function =                  N/A
              le_mean =     -17.211797235612
             les_mean =     296.589733901786
             stat err =       0.000447766604
             autocorr =       1.166448121978
              std dev =       0.586319020557
             le_variance =       0.343769993867


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721179723561e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211797235612       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211797237013       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211797236644       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211797237338       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211797237773       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211797238657       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211797238385       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 6.684336e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211797235612       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211797235962       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211797235870       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211797236043       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211797236152       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211797236373       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211797236307       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.671506e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211797235612       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211797235699       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211797235676       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211797235719       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211797235749       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211797235798       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211797235785       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 4.179029e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.537420 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7733e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.200502e-01 1 1  ON 0
 uu_1                 5.345202e-02 1 1  ON 1
 uu_2                -4.627326e-02 1 1  ON 2
 uu_3                -1.035609e-01 1 1  ON 3
 uu_4                -1.367469e-01 1 1  ON 4
 uu_5                -1.428344e-01 1 1  ON 5
 uu_6                -1.197716e-01 1 1  ON 6
 uu_7                -5.043785e-02 1 1  ON 7
 uu_8                 8.989431e-02 1 1  ON 8
 uu_9                 1.304162e-01 1 1  ON 9
 ud_0                 3.679825e-01 1 1  ON 10
 ud_1                 1.020637e-01 1 1  ON 11
 ud_2                -1.448699e-02 1 1  ON 12
 ud_3                -7.789123e-02 1 1  ON 13
 ud_4                -1.257602e-01 1 1  ON 14
 ud_5                -1.571178e-01 1 1  ON 15
 ud_6                -1.595930e-01 1 1  ON 16
 ud_7                -1.160255e-01 1 1  ON 17
 ud_8                -1.492824e-02 1 1  ON 18
 ud_9                 9.187952e-02 1 1  ON 19
 eO_0                -8.091759e-01 1 1  ON 20
 eO_1                -4.763613e-01 1 1  ON 21
 eO_2                -4.793412e-02 1 1  ON 22
 eO_3                 2.202217e-01 1 1  ON 23
 eO_4                 3.204251e-01 1 1  ON 24
 eO_5                 3.341388e-01 1 1  ON 25
 eO_6                 2.653503e-01 1 1  ON 26
 eO_7                 1.301040e-01 1 1  ON 27
 eO_8                 3.090193e-02 1 1  ON 28
 eO_9                 1.995355e-02 1 1  ON 29
eH1_0                -1.851167e-01 1 1  ON 30
eH1_1                -1.061492e-01 1 1  ON 31
eH1_2                -6.333065e-02 1 1  ON 32
eH1_3                -2.547844e-02 1 1  ON 33
eH1_4                 1.886344e-02 1 1  ON 34
eH1_5                 3.132200e-02 1 1  ON 35
eH1_6                 7.602179e-02 1 1  ON 36
eH1_7                 1.081428e-01 1 1  ON 37
eH1_8                 1.008899e-01 1 1  ON 38
eH1_9                 2.806733e-02 1 1  ON 39
eH2_0                -1.868832e-01 1 1  ON 40
eH2_1                -1.072833e-01 1 1  ON 41
eH2_2                -6.452893e-02 1 1  ON 42
eH2_3                -2.674093e-02 1 1  ON 43
eH2_4                 1.783823e-02 1 1  ON 44
eH2_5                 3.040020e-02 1 1  ON 45
eH2_6                 7.670629e-02 1 1  ON 46
eH2_7                 1.123085e-01 1 1  ON 47
eH2_8                 1.046688e-01 1 1  ON 48
eH2_9                 2.962450e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1878
    reference variance = 0.227837
====================================================
  Execution time = 3.7874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5027e-01
  Total weights = 2.0000e+06
  Execution time = 3.1027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350322254781
                                         uncertainty =       0.008927600273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350322254781
                                         uncertainty =       0.008927600273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418488648
  error estimate for blocks of size 2^( 2) =       0.000428692657
  error estimate for blocks of size 2^( 3) =       0.000438337902
  error estimate for blocks of size 2^( 4) =       0.000445172257
  error estimate for blocks of size 2^( 5) =       0.000449441241
  error estimate for blocks of size 2^( 6) =       0.000451978658
  error estimate for blocks of size 2^( 7) =       0.000455217441

      target function =                  N/A
              le_mean =     -17.212486130059
             les_mean =     296.619944099604
             stat err =       0.000450452399
             autocorr =       1.158591786203
              std dev =       0.591832321911
             le_variance =       0.350265497259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350322193958
                                         uncertainty =       0.008927595338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350322193958
                                         uncertainty =       0.008927595338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418488612
  error estimate for blocks of size 2^( 2) =       0.000428692624
  error estimate for blocks of size 2^( 3) =       0.000438337866
  error estimate for blocks of size 2^( 4) =       0.000445172219
  error estimate for blocks of size 2^( 5) =       0.000449441205
  error estimate for blocks of size 2^( 6) =       0.000451978621
  error estimate for blocks of size 2^( 7) =       0.000455217414

      target function =                  N/A
              le_mean =     -17.212486131103
             les_mean =     296.619944074686
             stat err =       0.000450452365
             autocorr =       1.158591809007
              std dev =       0.591832270494
             le_variance =       0.350265436398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350322224297
                                         uncertainty =       0.008927597800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350322224297
                                         uncertainty =       0.008927597800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418488630
  error estimate for blocks of size 2^( 2) =       0.000428692641
  error estimate for blocks of size 2^( 3) =       0.000438337884
  error estimate for blocks of size 2^( 4) =       0.000445172238
  error estimate for blocks of size 2^( 5) =       0.000449441223
  error estimate for blocks of size 2^( 6) =       0.000451978639
  error estimate for blocks of size 2^( 7) =       0.000455217428

      target function =                  N/A
              le_mean =     -17.212486130581
             les_mean =     296.619944087070
             stat err =       0.000450452382
             autocorr =       1.158591797631
              std dev =       0.591832296141
             le_variance =       0.350265466756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350322250968
                                         uncertainty =       0.008927599964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350322250968
                                         uncertainty =       0.008927599964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418488646
  error estimate for blocks of size 2^( 2) =       0.000428692655
  error estimate for blocks of size 2^( 3) =       0.000438337900
  error estimate for blocks of size 2^( 4) =       0.000445172255
  error estimate for blocks of size 2^( 5) =       0.000449441239
  error estimate for blocks of size 2^( 6) =       0.000451978656
  error estimate for blocks of size 2^( 7) =       0.000455217440

      target function =                  N/A
              le_mean =     -17.212486130124
             les_mean =     296.619944098034
             stat err =       0.000450452397
             autocorr =       1.158591787635
              std dev =       0.591832318688
             le_variance =       0.350265493443


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212486130059        initial
     3.7253e+02     3.7253e+03             6.6843e-07       -17.212486131103  <--
     1.4901e+03     1.4901e+04             1.6715e-07       -17.212486130581
     5.9605e+03     5.9605e+04             4.1790e-08       -17.212486130124

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 5.3513e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.200502e-01 1 1  ON 0
 uu_1                 5.345209e-02 1 1  ON 1
 uu_2                -4.627357e-02 1 1  ON 2
 uu_3                -1.035609e-01 1 1  ON 3
 uu_4                -1.367470e-01 1 1  ON 4
 uu_5                -1.428344e-01 1 1  ON 5
 uu_6                -1.197715e-01 1 1  ON 6
 uu_7                -5.043789e-02 1 1  ON 7
 uu_8                 8.989419e-02 1 1  ON 8
 uu_9                 1.304163e-01 1 1  ON 9
 ud_0                 3.679824e-01 1 1  ON 10
 ud_1                 1.020639e-01 1 1  ON 11
 ud_2                -1.448701e-02 1 1  ON 12
 ud_3                -7.789131e-02 1 1  ON 13
 ud_4                -1.257602e-01 1 1  ON 14
 ud_5                -1.571177e-01 1 1  ON 15
 ud_6                -1.595929e-01 1 1  ON 16
 ud_7                -1.160256e-01 1 1  ON 17
 ud_8                -1.492841e-02 1 1  ON 18
 ud_9                 9.187948e-02 1 1  ON 19
 eO_0                -8.091764e-01 1 1  ON 20
 eO_1                -4.763615e-01 1 1  ON 21
 eO_2                -4.793404e-02 1 1  ON 22
 eO_3                 2.202215e-01 1 1  ON 23
 eO_4                 3.204251e-01 1 1  ON 24
 eO_5                 3.341391e-01 1 1  ON 25
 eO_6                 2.653505e-01 1 1  ON 26
 eO_7                 1.301043e-01 1 1  ON 27
 eO_8                 3.090195e-02 1 1  ON 28
 eO_9                 1.995357e-02 1 1  ON 29
eH1_0                -1.851169e-01 1 1  ON 30
eH1_1                -1.061490e-01 1 1  ON 31
eH1_2                -6.333052e-02 1 1  ON 32
eH1_3                -2.547851e-02 1 1  ON 33
eH1_4                 1.886347e-02 1 1  ON 34
eH1_5                 3.132172e-02 1 1  ON 35
eH1_6                 7.602177e-02 1 1  ON 36
eH1_7                 1.081427e-01 1 1  ON 37
eH1_8                 1.008900e-01 1 1  ON 38
eH1_9                 2.806738e-02 1 1  ON 39
eH2_0                -1.868831e-01 1 1  ON 40
eH2_1                -1.072833e-01 1 1  ON 41
eH2_2                -6.452900e-02 1 1  ON 42
eH2_3                -2.674104e-02 1 1  ON 43
eH2_4                 1.783817e-02 1 1  ON 44
eH2_5                 3.040025e-02 1 1  ON 45
eH2_6                 7.670626e-02 1 1  ON 46
eH2_7                 1.123085e-01 1 1  ON 47
eH2_8                 1.046689e-01 1 1  ON 48
eH2_9                 2.962453e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0126e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1652
    reference variance = 0.183044
====================================================
  Execution time = 3.7353e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4235e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0496e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342448643220
                                         uncertainty =       0.006847977684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342448643220
                                         uncertainty =       0.006847977684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413733735
  error estimate for blocks of size 2^( 2) =       0.000424044933
  error estimate for blocks of size 2^( 3) =       0.000433609031
  error estimate for blocks of size 2^( 4) =       0.000440772612
  error estimate for blocks of size 2^( 5) =       0.000445783384
  error estimate for blocks of size 2^( 6) =       0.000447584363
  error estimate for blocks of size 2^( 7) =       0.000448589799

      target function =                  N/A
              le_mean =     -17.212062934857
             les_mean =     296.597461509859
             stat err =       0.000445682539
             autocorr =       1.160404412565
              std dev =       0.585107859756
             le_variance =       0.342351207548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721206293486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212062934857       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212062944680       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212062955480       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212062958666       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212062957900       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212062956927       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212062956259       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.669102e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212062934857       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212062937318       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212062940026       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212062940829       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212062940649       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212062940400       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212062940233       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 6.682649e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212062934857       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212062935473       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212062936150       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212062936352       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212062936307       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212062936245       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212062936203       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.671283e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.540540 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7858e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.200499e-01 1 1  ON 0
 uu_1                 5.345228e-02 1 1  ON 1
 uu_2                -4.627337e-02 1 1  ON 2
 uu_3                -1.035610e-01 1 1  ON 3
 uu_4                -1.367469e-01 1 1  ON 4
 uu_5                -1.428341e-01 1 1  ON 5
 uu_6                -1.197716e-01 1 1  ON 6
 uu_7                -5.043818e-02 1 1  ON 7
 uu_8                 8.989397e-02 1 1  ON 8
 uu_9                 1.304164e-01 1 1  ON 9
 ud_0                 3.679820e-01 1 1  ON 10
 ud_1                 1.020641e-01 1 1  ON 11
 ud_2                -1.448689e-02 1 1  ON 12
 ud_3                -7.789130e-02 1 1  ON 13
 ud_4                -1.257601e-01 1 1  ON 14
 ud_5                -1.571175e-01 1 1  ON 15
 ud_6                -1.595929e-01 1 1  ON 16
 ud_7                -1.160257e-01 1 1  ON 17
 ud_8                -1.492861e-02 1 1  ON 18
 ud_9                 9.187948e-02 1 1  ON 19
 eO_0                -8.091771e-01 1 1  ON 20
 eO_1                -4.763617e-01 1 1  ON 21
 eO_2                -4.793428e-02 1 1  ON 22
 eO_3                 2.202212e-01 1 1  ON 23
 eO_4                 3.204254e-01 1 1  ON 24
 eO_5                 3.341395e-01 1 1  ON 25
 eO_6                 2.653508e-01 1 1  ON 26
 eO_7                 1.301046e-01 1 1  ON 27
 eO_8                 3.090199e-02 1 1  ON 28
 eO_9                 1.995358e-02 1 1  ON 29
eH1_0                -1.851171e-01 1 1  ON 30
eH1_1                -1.061490e-01 1 1  ON 31
eH1_2                -6.333031e-02 1 1  ON 32
eH1_3                -2.547850e-02 1 1  ON 33
eH1_4                 1.886362e-02 1 1  ON 34
eH1_5                 3.132156e-02 1 1  ON 35
eH1_6                 7.602161e-02 1 1  ON 36
eH1_7                 1.081427e-01 1 1  ON 37
eH1_8                 1.008902e-01 1 1  ON 38
eH1_9                 2.806743e-02 1 1  ON 39
eH2_0                -1.868829e-01 1 1  ON 40
eH2_1                -1.072835e-01 1 1  ON 41
eH2_2                -6.452924e-02 1 1  ON 42
eH2_3                -2.674098e-02 1 1  ON 43
eH2_4                 1.783825e-02 1 1  ON 44
eH2_5                 3.040049e-02 1 1  ON 45
eH2_6                 7.670609e-02 1 1  ON 46
eH2_7                 1.123084e-01 1 1  ON 47
eH2_8                 1.046690e-01 1 1  ON 48
eH2_9                 2.962457e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1947
    reference variance = 0.30445
====================================================
  Execution time = 3.6919e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3977e-01
  Total weights = 2.0000e+06
  Execution time = 3.1029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339761187040
                                         uncertainty =       0.003458945366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339761187040
                                         uncertainty =       0.003458945366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412169606
  error estimate for blocks of size 2^( 2) =       0.000422816089
  error estimate for blocks of size 2^( 3) =       0.000432528449
  error estimate for blocks of size 2^( 4) =       0.000440129031
  error estimate for blocks of size 2^( 5) =       0.000443987985
  error estimate for blocks of size 2^( 6) =       0.000446922564
  error estimate for blocks of size 2^( 7) =       0.000447347817

      target function =                  N/A
              le_mean =     -17.211832816447
             les_mean =     296.586956298966
             stat err =       0.000444596849
             autocorr =       1.163538708506
              std dev =       0.582895846217
             le_variance =       0.339767567537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339759285622
                                         uncertainty =       0.003458926596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339759285622
                                         uncertainty =       0.003458926596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412168452
  error estimate for blocks of size 2^( 2) =       0.000422814970
  error estimate for blocks of size 2^( 3) =       0.000432527355
  error estimate for blocks of size 2^( 4) =       0.000440127943
  error estimate for blocks of size 2^( 5) =       0.000443986924
  error estimate for blocks of size 2^( 6) =       0.000446921491
  error estimate for blocks of size 2^( 7) =       0.000447346809

      target function =                  N/A
              le_mean =     -17.211832832500
             les_mean =     296.586954949746
             stat err =       0.000444595792
             autocorr =       1.163539685857
              std dev =       0.582894214843
             le_variance =       0.339765665697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339760232074
                                         uncertainty =       0.003458935937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339760232074
                                         uncertainty =       0.003458935937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412169026
  error estimate for blocks of size 2^( 2) =       0.000422815527
  error estimate for blocks of size 2^( 3) =       0.000432527900
  error estimate for blocks of size 2^( 4) =       0.000440128484
  error estimate for blocks of size 2^( 5) =       0.000443987453
  error estimate for blocks of size 2^( 6) =       0.000446922025
  error estimate for blocks of size 2^( 7) =       0.000447347311

      target function =                  N/A
              le_mean =     -17.211832824504
             les_mean =     296.586955621149
             stat err =       0.000444596318
             autocorr =       1.163539199816
              std dev =       0.582895026878
             le_variance =       0.339766612359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339761067532
                                         uncertainty =       0.003458944186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339761067532
                                         uncertainty =       0.003458944186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412169533
  error estimate for blocks of size 2^( 2) =       0.000422816019
  error estimate for blocks of size 2^( 3) =       0.000432528380
  error estimate for blocks of size 2^( 4) =       0.000440128962
  error estimate for blocks of size 2^( 5) =       0.000443987919
  error estimate for blocks of size 2^( 6) =       0.000446922496
  error estimate for blocks of size 2^( 7) =       0.000447347754

      target function =                  N/A
              le_mean =     -17.211832817455
             les_mean =     296.586956214123
             stat err =       0.000444596783
             autocorr =       1.163538770009
              std dev =       0.582895743682
             le_variance =       0.339767448003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211832816447        initial
     9.3132e+01     9.3132e+02             2.6691e-06       -17.211832832500  <--
     3.7253e+02     3.7253e+03             6.6826e-07       -17.211832824504
     1.4901e+03     1.4901e+04             1.6713e-07       -17.211832817455

*****************************************************************************
Applying the update for shift_i =   9.3132e+01     and shift_s =   9.3132e+02
*****************************************************************************

  Execution time = 5.2523e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.200491e-01 1 1  ON 0
 uu_1                 5.345285e-02 1 1  ON 1
 uu_2                -4.627277e-02 1 1  ON 2
 uu_3                -1.035613e-01 1 1  ON 3
 uu_4                -1.367466e-01 1 1  ON 4
 uu_5                -1.428332e-01 1 1  ON 5
 uu_6                -1.197719e-01 1 1  ON 6
 uu_7                -5.043904e-02 1 1  ON 7
 uu_8                 8.989330e-02 1 1  ON 8
 uu_9                 1.304166e-01 1 1  ON 9
 ud_0                 3.679810e-01 1 1  ON 10
 ud_1                 1.020648e-01 1 1  ON 11
 ud_2                -1.448652e-02 1 1  ON 12
 ud_3                -7.789128e-02 1 1  ON 13
 ud_4                -1.257600e-01 1 1  ON 14
 ud_5                -1.571169e-01 1 1  ON 15
 ud_6                -1.595930e-01 1 1  ON 16
 ud_7                -1.160262e-01 1 1  ON 17
 ud_8                -1.492921e-02 1 1  ON 18
 ud_9                 9.187948e-02 1 1  ON 19
 eO_0                -8.091791e-01 1 1  ON 20
 eO_1                -4.763624e-01 1 1  ON 21
 eO_2                -4.793499e-02 1 1  ON 22
 eO_3                 2.202205e-01 1 1  ON 23
 eO_4                 3.204263e-01 1 1  ON 24
 eO_5                 3.341409e-01 1 1  ON 25
 eO_6                 2.653517e-01 1 1  ON 26
 eO_7                 1.301053e-01 1 1  ON 27
 eO_8                 3.090211e-02 1 1  ON 28
 eO_9                 1.995362e-02 1 1  ON 29
eH1_0                -1.851178e-01 1 1  ON 30
eH1_1                -1.061489e-01 1 1  ON 31
eH1_2                -6.332968e-02 1 1  ON 32
eH1_3                -2.547847e-02 1 1  ON 33
eH1_4                 1.886407e-02 1 1  ON 34
eH1_5                 3.132105e-02 1 1  ON 35
eH1_6                 7.602115e-02 1 1  ON 36
eH1_7                 1.081424e-01 1 1  ON 37
eH1_8                 1.008906e-01 1 1  ON 38
eH1_9                 2.806757e-02 1 1  ON 39
eH2_0                -1.868825e-01 1 1  ON 40
eH2_1                -1.072843e-01 1 1  ON 41
eH2_2                -6.452998e-02 1 1  ON 42
eH2_3                -2.674079e-02 1 1  ON 43
eH2_4                 1.783849e-02 1 1  ON 44
eH2_5                 3.040118e-02 1 1  ON 45
eH2_6                 7.670557e-02 1 1  ON 46
eH2_7                 1.123082e-01 1 1  ON 47
eH2_8                 1.046694e-01 1 1  ON 48
eH2_9                 2.962468e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0039e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1034
    reference variance = 0.677426
====================================================
  Execution time = 3.7386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4575e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0580e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345848618351
                                         uncertainty =       0.007941569055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345848618351
                                         uncertainty =       0.007941569055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415783605
  error estimate for blocks of size 2^( 2) =       0.000427055789
  error estimate for blocks of size 2^( 3) =       0.000436514088
  error estimate for blocks of size 2^( 4) =       0.000444304702
  error estimate for blocks of size 2^( 5) =       0.000448989384
  error estimate for blocks of size 2^( 6) =       0.000450206085
  error estimate for blocks of size 2^( 7) =       0.000451318190

      target function =                  N/A
              le_mean =     -17.212193058810
             les_mean =     296.605341732526
             stat err =       0.000448704590
             autocorr =       1.164625527494
              std dev =       0.588006812595
             le_variance =       0.345752011658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721219305881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212193058810       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212193093534       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212193083994       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212193100711       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212193098802       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212193100735       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212193094387       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 7.861211e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212193058810       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212193067553       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212193065164       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212193069438       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212193068958       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212193069399       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212193067799       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.971872e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212193058810       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212193061000       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212193060402       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212193061476       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212193061356       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212193061464       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212193061065       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 4.933814e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.543522 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7979e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.200494e-01 1 1  ON 0
 uu_1                 5.345217e-02 1 1  ON 1
 uu_2                -4.627326e-02 1 1  ON 2
 uu_3                -1.035619e-01 1 1  ON 3
 uu_4                -1.367473e-01 1 1  ON 4
 uu_5                -1.428326e-01 1 1  ON 5
 uu_6                -1.197713e-01 1 1  ON 6
 uu_7                -5.043858e-02 1 1  ON 7
 uu_8                 8.989276e-02 1 1  ON 8
 uu_9                 1.304170e-01 1 1  ON 9
 ud_0                 3.679809e-01 1 1  ON 10
 ud_1                 1.020649e-01 1 1  ON 11
 ud_2                -1.448666e-02 1 1  ON 12
 ud_3                -7.789083e-02 1 1  ON 13
 ud_4                -1.257615e-01 1 1  ON 14
 ud_5                -1.571166e-01 1 1  ON 15
 ud_6                -1.595924e-01 1 1  ON 16
 ud_7                -1.160259e-01 1 1  ON 17
 ud_8                -1.492979e-02 1 1  ON 18
 ud_9                 9.187951e-02 1 1  ON 19
 eO_0                -8.091811e-01 1 1  ON 20
 eO_1                -4.763632e-01 1 1  ON 21
 eO_2                -4.793578e-02 1 1  ON 22
 eO_3                 2.202193e-01 1 1  ON 23
 eO_4                 3.204258e-01 1 1  ON 24
 eO_5                 3.341425e-01 1 1  ON 25
 eO_6                 2.653534e-01 1 1  ON 26
 eO_7                 1.301069e-01 1 1  ON 27
 eO_8                 3.090234e-02 1 1  ON 28
 eO_9                 1.995368e-02 1 1  ON 29
eH1_0                -1.851182e-01 1 1  ON 30
eH1_1                -1.061499e-01 1 1  ON 31
eH1_2                -6.333003e-02 1 1  ON 32
eH1_3                -2.547844e-02 1 1  ON 33
eH1_4                 1.886385e-02 1 1  ON 34
eH1_5                 3.132203e-02 1 1  ON 35
eH1_6                 7.602113e-02 1 1  ON 36
eH1_7                 1.081423e-01 1 1  ON 37
eH1_8                 1.008915e-01 1 1  ON 38
eH1_9                 2.806782e-02 1 1  ON 39
eH2_0                -1.868830e-01 1 1  ON 40
eH2_1                -1.072844e-01 1 1  ON 41
eH2_2                -6.453007e-02 1 1  ON 42
eH2_3                -2.674067e-02 1 1  ON 43
eH2_4                 1.783858e-02 1 1  ON 44
eH2_5                 3.040051e-02 1 1  ON 45
eH2_6                 7.670545e-02 1 1  ON 46
eH2_7                 1.123084e-01 1 1  ON 47
eH2_8                 1.046702e-01 1 1  ON 48
eH2_9                 2.962491e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1834
    reference variance = 0.312851
====================================================
  Execution time = 3.7283e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3819e-01
  Total weights = 2.0000e+06
  Execution time = 3.1202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277345053
                                         uncertainty =       0.002678052868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277345053
                                         uncertainty =       0.002678052868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411209482
  error estimate for blocks of size 2^( 2) =       0.000421635824
  error estimate for blocks of size 2^( 3) =       0.000431016081
  error estimate for blocks of size 2^( 4) =       0.000438082129
  error estimate for blocks of size 2^( 5) =       0.000441463227
  error estimate for blocks of size 2^( 6) =       0.000442832358
  error estimate for blocks of size 2^( 7) =       0.000443844823

      target function =                  N/A
              le_mean =     -17.212164009648
             les_mean =     296.596776201791
             stat err =       0.000441555634
             autocorr =       1.153040657304
              std dev =       0.581538026149
             le_variance =       0.338186475857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278376753
                                         uncertainty =       0.002678050052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278376753
                                         uncertainty =       0.002678050052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411210109
  error estimate for blocks of size 2^( 2) =       0.000421636420
  error estimate for blocks of size 2^( 3) =       0.000431016634
  error estimate for blocks of size 2^( 4) =       0.000438082596
  error estimate for blocks of size 2^( 5) =       0.000441463708
  error estimate for blocks of size 2^( 6) =       0.000442832835
  error estimate for blocks of size 2^( 7) =       0.000443845237

      target function =                  N/A
              le_mean =     -17.212164010063
             les_mean =     296.596777247339
             stat err =       0.000441556094
             autocorr =       1.153039540265
              std dev =       0.581538912815
             le_variance =       0.338187507118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277872826
                                         uncertainty =       0.002678051560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277872826
                                         uncertainty =       0.002678051560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411209803
  error estimate for blocks of size 2^( 2) =       0.000421636129
  error estimate for blocks of size 2^( 3) =       0.000431016364
  error estimate for blocks of size 2^( 4) =       0.000438082368
  error estimate for blocks of size 2^( 5) =       0.000441463473
  error estimate for blocks of size 2^( 6) =       0.000442832602
  error estimate for blocks of size 2^( 7) =       0.000443845036

      target function =                  N/A
              le_mean =     -17.212164009788
             les_mean =     296.596776734153
             stat err =       0.000441555870
             autocorr =       1.153040088173
              std dev =       0.581538479730
             le_variance =       0.338187003406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277411393
                                         uncertainty =       0.002678052708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277411393
                                         uncertainty =       0.002678052708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411209522
  error estimate for blocks of size 2^( 2) =       0.000421635862
  error estimate for blocks of size 2^( 3) =       0.000431016117
  error estimate for blocks of size 2^( 4) =       0.000438082159
  error estimate for blocks of size 2^( 5) =       0.000441463258
  error estimate for blocks of size 2^( 6) =       0.000442832389
  error estimate for blocks of size 2^( 7) =       0.000443844850

      target function =                  N/A
              le_mean =     -17.212164009661
             les_mean =     296.596776268553
             stat err =       0.000441555664
             autocorr =       1.153040585807
              std dev =       0.581538083164
             le_variance =       0.338186542169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212164009648        initial
     2.3283e+01     2.3283e+02             7.8612e-06       -17.212164010063  <--
     9.3132e+01     9.3132e+02             1.9719e-06       -17.212164009788
     3.7253e+02     3.7253e+03             4.9338e-07       -17.212164009661

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 5.2948e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.200503e-01 1 1  ON 0
 uu_1                 5.345014e-02 1 1  ON 1
 uu_2                -4.627474e-02 1 1  ON 2
 uu_3                -1.035637e-01 1 1  ON 3
 uu_4                -1.367496e-01 1 1  ON 4
 uu_5                -1.428308e-01 1 1  ON 5
 uu_6                -1.197693e-01 1 1  ON 6
 uu_7                -5.043722e-02 1 1  ON 7
 uu_8                 8.989116e-02 1 1  ON 8
 uu_9                 1.304180e-01 1 1  ON 9
 ud_0                 3.679806e-01 1 1  ON 10
 ud_1                 1.020651e-01 1 1  ON 11
 ud_2                -1.448707e-02 1 1  ON 12
 ud_3                -7.788952e-02 1 1  ON 13
 ud_4                -1.257658e-01 1 1  ON 14
 ud_5                -1.571158e-01 1 1  ON 15
 ud_6                -1.595908e-01 1 1  ON 16
 ud_7                -1.160252e-01 1 1  ON 17
 ud_8                -1.493150e-02 1 1  ON 18
 ud_9                 9.187961e-02 1 1  ON 19
 eO_0                -8.091870e-01 1 1  ON 20
 eO_1                -4.763657e-01 1 1  ON 21
 eO_2                -4.793814e-02 1 1  ON 22
 eO_3                 2.202160e-01 1 1  ON 23
 eO_4                 3.204240e-01 1 1  ON 24
 eO_5                 3.341474e-01 1 1  ON 25
 eO_6                 2.653586e-01 1 1  ON 26
 eO_7                 1.301116e-01 1 1  ON 27
 eO_8                 3.090303e-02 1 1  ON 28
 eO_9                 1.995387e-02 1 1  ON 29
eH1_0                -1.851194e-01 1 1  ON 30
eH1_1                -1.061531e-01 1 1  ON 31
eH1_2                -6.333107e-02 1 1  ON 32
eH1_3                -2.547839e-02 1 1  ON 33
eH1_4                 1.886320e-02 1 1  ON 34
eH1_5                 3.132498e-02 1 1  ON 35
eH1_6                 7.602106e-02 1 1  ON 36
eH1_7                 1.081420e-01 1 1  ON 37
eH1_8                 1.008940e-01 1 1  ON 38
eH1_9                 2.806858e-02 1 1  ON 39
eH2_0                -1.868845e-01 1 1  ON 40
eH2_1                -1.072847e-01 1 1  ON 41
eH2_2                -6.453032e-02 1 1  ON 42
eH2_3                -2.674031e-02 1 1  ON 43
eH2_4                 1.783883e-02 1 1  ON 44
eH2_5                 3.039848e-02 1 1  ON 45
eH2_6                 7.670509e-02 1 1  ON 46
eH2_7                 1.123090e-01 1 1  ON 47
eH2_8                 1.046724e-01 1 1  ON 48
eH2_9                 2.962563e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0093e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1729
    reference variance = 0.175923
====================================================
  Execution time = 3.7306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4650e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0564e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346499931755
                                         uncertainty =       0.003757050028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346499931755
                                         uncertainty =       0.003757050028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416235976
  error estimate for blocks of size 2^( 2) =       0.000426839493
  error estimate for blocks of size 2^( 3) =       0.000435798769
  error estimate for blocks of size 2^( 4) =       0.000442453490
  error estimate for blocks of size 2^( 5) =       0.000446316861
  error estimate for blocks of size 2^( 6) =       0.000449759283
  error estimate for blocks of size 2^( 7) =       0.000451829599

      target function =                  N/A
              le_mean =     -17.212229641917
             les_mean =     296.607353848297
             stat err =       0.000447589808
             autocorr =       1.156328286625
              std dev =       0.588646562431
             le_variance =       0.346504775462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721222964192e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212229641917       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212229674789       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212229629542       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212229541336       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212229526308       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212229573286       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212229576901       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 3.613167e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212229641917       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212229650316       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212229638798       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212229615817       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212229611321       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212229623042       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212229623947       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 9.239962e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212229641917       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212229644028       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212229641136       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212229635328       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212229634154       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212229637080       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212229637307       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.323711e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.546643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7880e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.200527e-01 1 1  ON 0
 uu_1                 5.345112e-02 1 1  ON 1
 uu_2                -4.627643e-02 1 1  ON 2
 uu_3                -1.035636e-01 1 1  ON 3
 uu_4                -1.367516e-01 1 1  ON 4
 uu_5                -1.428304e-01 1 1  ON 5
 uu_6                -1.197659e-01 1 1  ON 6
 uu_7                -5.044120e-02 1 1  ON 7
 uu_8                 8.988828e-02 1 1  ON 8
 uu_9                 1.304193e-01 1 1  ON 9
 ud_0                 3.679772e-01 1 1  ON 10
 ud_1                 1.020665e-01 1 1  ON 11
 ud_2                -1.448887e-02 1 1  ON 12
 ud_3                -7.788789e-02 1 1  ON 13
 ud_4                -1.257674e-01 1 1  ON 14
 ud_5                -1.571149e-01 1 1  ON 15
 ud_6                -1.595873e-01 1 1  ON 16
 ud_7                -1.160256e-01 1 1  ON 17
 ud_8                -1.493400e-02 1 1  ON 18
 ud_9                 9.187991e-02 1 1  ON 19
 eO_0                -8.091962e-01 1 1  ON 20
 eO_1                -4.763675e-01 1 1  ON 21
 eO_2                -4.793804e-02 1 1  ON 22
 eO_3                 2.202083e-01 1 1  ON 23
 eO_4                 3.204255e-01 1 1  ON 24
 eO_5                 3.341533e-01 1 1  ON 25
 eO_6                 2.653635e-01 1 1  ON 26
 eO_7                 1.301165e-01 1 1  ON 27
 eO_8                 3.090392e-02 1 1  ON 28
 eO_9                 1.995413e-02 1 1  ON 29
eH1_0                -1.851202e-01 1 1  ON 30
eH1_1                -1.061552e-01 1 1  ON 31
eH1_2                -6.333073e-02 1 1  ON 32
eH1_3                -2.547752e-02 1 1  ON 33
eH1_4                 1.886328e-02 1 1  ON 34
eH1_5                 3.132377e-02 1 1  ON 35
eH1_6                 7.602162e-02 1 1  ON 36
eH1_7                 1.081411e-01 1 1  ON 37
eH1_8                 1.008964e-01 1 1  ON 38
eH1_9                 2.806922e-02 1 1  ON 39
eH2_0                -1.868853e-01 1 1  ON 40
eH2_1                -1.072878e-01 1 1  ON 41
eH2_2                -6.453250e-02 1 1  ON 42
eH2_3                -2.673891e-02 1 1  ON 43
eH2_4                 1.784054e-02 1 1  ON 44
eH2_5                 3.039933e-02 1 1  ON 45
eH2_6                 7.670499e-02 1 1  ON 46
eH2_7                 1.123074e-01 1 1  ON 47
eH2_8                 1.046752e-01 1 1  ON 48
eH2_9                 2.962639e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1901
    reference variance = 0.200363
====================================================
  Execution time = 3.7721e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4566e-01
  Total weights = 2.0000e+06
  Execution time = 3.1052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345724061234
                                         uncertainty =       0.004039493657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345724061234
                                         uncertainty =       0.004039493657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415726545
  error estimate for blocks of size 2^( 2) =       0.000426265730
  error estimate for blocks of size 2^( 3) =       0.000435241256
  error estimate for blocks of size 2^( 4) =       0.000441968684
  error estimate for blocks of size 2^( 5) =       0.000446617946
  error estimate for blocks of size 2^( 6) =       0.000449647740
  error estimate for blocks of size 2^( 7) =       0.000451356706

      target function =                  N/A
              le_mean =     -17.212342763370
             les_mean =     296.610400351577
             stat err =       0.000447397769
             autocorr =       1.158169479628
              std dev =       0.587926118385
             le_variance =       0.345657120679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345722532684
                                         uncertainty =       0.004039393125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345722532684
                                         uncertainty =       0.004039393125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415725630
  error estimate for blocks of size 2^( 2) =       0.000426264666
  error estimate for blocks of size 2^( 3) =       0.000435240032
  error estimate for blocks of size 2^( 4) =       0.000441967431
  error estimate for blocks of size 2^( 5) =       0.000446616766
  error estimate for blocks of size 2^( 6) =       0.000449645988
  error estimate for blocks of size 2^( 7) =       0.000451354163

      target function =                  N/A
              le_mean =     -17.212342793710
             les_mean =     296.610399874006
             stat err =       0.000447396087
             autocorr =       1.158165871054
              std dev =       0.587924823979
             le_variance =       0.345655598651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345723220397
                                         uncertainty =       0.004039441224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345723220397
                                         uncertainty =       0.004039441224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415726042
  error estimate for blocks of size 2^( 2) =       0.000426265146
  error estimate for blocks of size 2^( 3) =       0.000435240586
  error estimate for blocks of size 2^( 4) =       0.000441967997
  error estimate for blocks of size 2^( 5) =       0.000446617296
  error estimate for blocks of size 2^( 6) =       0.000449646787
  error estimate for blocks of size 2^( 7) =       0.000451355349

      target function =                  N/A
              le_mean =     -17.212342781720
             les_mean =     296.610400145873
             stat err =       0.000447396857
             autocorr =       1.158167564627
              std dev =       0.587925406201
             le_variance =       0.345656283257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345723953361
                                         uncertainty =       0.004039487032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345723953361
                                         uncertainty =       0.004039487032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415726481
  error estimate for blocks of size 2^( 2) =       0.000426265655
  error estimate for blocks of size 2^( 3) =       0.000435241171
  error estimate for blocks of size 2^( 4) =       0.000441968596
  error estimate for blocks of size 2^( 5) =       0.000446617863
  error estimate for blocks of size 2^( 6) =       0.000449647618
  error estimate for blocks of size 2^( 7) =       0.000451356533

      target function =                  N/A
              le_mean =     -17.212342765734
             les_mean =     296.610400325509
             stat err =       0.000447397653
             autocorr =       1.158169236266
              std dev =       0.587926027012
             le_variance =       0.345657013238


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212342763370        initial
     5.8208e+00     5.8208e+01             3.6132e-05       -17.212342793710  <--
     2.3283e+01     2.3283e+02             9.2400e-06       -17.212342781720
     9.3132e+01     9.3132e+02             2.3237e-06       -17.212342765734

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 5.3395e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.200596e-01 1 1  ON 0
 uu_1                 5.345395e-02 1 1  ON 1
 uu_2                -4.628113e-02 1 1  ON 2
 uu_3                -1.035636e-01 1 1  ON 3
 uu_4                -1.367571e-01 1 1  ON 4
 uu_5                -1.428297e-01 1 1  ON 5
 uu_6                -1.197556e-01 1 1  ON 6
 uu_7                -5.045306e-02 1 1  ON 7
 uu_8                 8.987969e-02 1 1  ON 8
 uu_9                 1.304232e-01 1 1  ON 9
 ud_0                 3.679676e-01 1 1  ON 10
 ud_1                 1.020702e-01 1 1  ON 11
 ud_2                -1.449373e-02 1 1  ON 12
 ud_3                -7.788362e-02 1 1  ON 13
 ud_4                -1.257718e-01 1 1  ON 14
 ud_5                -1.571125e-01 1 1  ON 15
 ud_6                -1.595767e-01 1 1  ON 16
 ud_7                -1.160269e-01 1 1  ON 17
 ud_8                -1.494143e-02 1 1  ON 18
 ud_9                 9.188083e-02 1 1  ON 19
 eO_0                -8.092231e-01 1 1  ON 20
 eO_1                -4.763734e-01 1 1  ON 21
 eO_2                -4.793817e-02 1 1  ON 22
 eO_3                 2.201860e-01 1 1  ON 23
 eO_4                 3.204299e-01 1 1  ON 24
 eO_5                 3.341709e-01 1 1  ON 25
 eO_6                 2.653781e-01 1 1  ON 26
 eO_7                 1.301314e-01 1 1  ON 27
 eO_8                 3.090658e-02 1 1  ON 28
 eO_9                 1.995491e-02 1 1  ON 29
eH1_0                -1.851229e-01 1 1  ON 30
eH1_1                -1.061611e-01 1 1  ON 31
eH1_2                -6.332965e-02 1 1  ON 32
eH1_3                -2.547516e-02 1 1  ON 33
eH1_4                 1.886367e-02 1 1  ON 34
eH1_5                 3.132007e-02 1 1  ON 35
eH1_6                 7.602325e-02 1 1  ON 36
eH1_7                 1.081384e-01 1 1  ON 37
eH1_8                 1.009035e-01 1 1  ON 38
eH1_9                 2.807114e-02 1 1  ON 39
eH2_0                -1.868879e-01 1 1  ON 40
eH2_1                -1.072970e-01 1 1  ON 41
eH2_2                -6.453864e-02 1 1  ON 42
eH2_3                -2.673512e-02 1 1  ON 43
eH2_4                 1.784578e-02 1 1  ON 44
eH2_5                 3.040187e-02 1 1  ON 45
eH2_6                 7.670468e-02 1 1  ON 46
eH2_7                 1.123028e-01 1 1  ON 47
eH2_8                 1.046834e-01 1 1  ON 48
eH2_9                 2.962865e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0128e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1969
    reference variance = 0.271019
====================================================
  Execution time = 3.7400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4936e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0568e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349364596119
                                         uncertainty =       0.006326477483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349364596119
                                         uncertainty =       0.006326477483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417949825
  error estimate for blocks of size 2^( 2) =       0.000428560058
  error estimate for blocks of size 2^( 3) =       0.000438407978
  error estimate for blocks of size 2^( 4) =       0.000445130520
  error estimate for blocks of size 2^( 5) =       0.000450221270
  error estimate for blocks of size 2^( 6) =       0.000452093774
  error estimate for blocks of size 2^( 7) =       0.000454858788

      target function =                  N/A
              le_mean =     -17.211615364440
             les_mean =     296.589067390900
             stat err =       0.000450576088
             autocorr =       1.162219039083
              std dev =       0.591070310658
             le_variance =       0.349364112141


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721161536444e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211615364440       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211615380209       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211615193265       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211614998213       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211615126538       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211615214387       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211615142375       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211615164259       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 9.465433e-05

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211615364440       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211615368848       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211615318398       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211615255877       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211615279142       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211615301113       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211615286040       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.420620e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211615364440       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211615365576       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211615352702       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211615335977       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211615340927       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211615346372       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211615342937       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 6.086110e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.550021 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7976e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.200544e-01 1 1  ON 0
 uu_1                 5.345564e-02 1 1  ON 1
 uu_2                -4.627723e-02 1 1  ON 2
 uu_3                -1.035759e-01 1 1  ON 3
 uu_4                -1.367628e-01 1 1  ON 4
 uu_5                -1.428188e-01 1 1  ON 5
 uu_6                -1.197561e-01 1 1  ON 6
 uu_7                -5.046113e-02 1 1  ON 7
 uu_8                 8.987165e-02 1 1  ON 8
 uu_9                 1.304317e-01 1 1  ON 9
 ud_0                 3.679713e-01 1 1  ON 10
 ud_1                 1.020731e-01 1 1  ON 11
 ud_2                -1.449355e-02 1 1  ON 12
 ud_3                -7.787722e-02 1 1  ON 13
 ud_4                -1.257809e-01 1 1  ON 14
 ud_5                -1.571145e-01 1 1  ON 15
 ud_6                -1.595725e-01 1 1  ON 16
 ud_7                -1.160319e-01 1 1  ON 17
 ud_8                -1.495636e-02 1 1  ON 18
 ud_9                 9.187964e-02 1 1  ON 19
 eO_0                -8.092266e-01 1 1  ON 20
 eO_1                -4.763968e-01 1 1  ON 21
 eO_2                -4.796238e-02 1 1  ON 22
 eO_3                 2.201777e-01 1 1  ON 23
 eO_4                 3.204208e-01 1 1  ON 24
 eO_5                 3.341899e-01 1 1  ON 25
 eO_6                 2.653992e-01 1 1  ON 26
 eO_7                 1.301526e-01 1 1  ON 27
 eO_8                 3.090989e-02 1 1  ON 28
 eO_9                 1.995648e-02 1 1  ON 29
eH1_0                -1.851278e-01 1 1  ON 30
eH1_1                -1.061709e-01 1 1  ON 31
eH1_2                -6.332664e-02 1 1  ON 32
eH1_3                -2.547765e-02 1 1  ON 33
eH1_4                 1.887043e-02 1 1  ON 34
eH1_5                 3.131476e-02 1 1  ON 35
eH1_6                 7.602310e-02 1 1  ON 36
eH1_7                 1.081355e-01 1 1  ON 37
eH1_8                 1.009133e-01 1 1  ON 38
eH1_9                 2.807506e-02 1 1  ON 39
eH2_0                -1.868855e-01 1 1  ON 40
eH2_1                -1.073073e-01 1 1  ON 41
eH2_2                -6.455266e-02 1 1  ON 42
eH2_3                -2.673086e-02 1 1  ON 43
eH2_4                 1.785650e-02 1 1  ON 44
eH2_5                 3.039959e-02 1 1  ON 45
eH2_6                 7.669080e-02 1 1  ON 46
eH2_7                 1.123070e-01 1 1  ON 47
eH2_8                 1.046978e-01 1 1  ON 48
eH2_9                 2.963130e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2106
    reference variance = 0.319496
====================================================
  Execution time = 3.6826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3914e-01
  Total weights = 2.0000e+06
  Execution time = 3.1098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339154082279
                                         uncertainty =       0.003015594778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339154082279
                                         uncertainty =       0.003015594778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411785792
  error estimate for blocks of size 2^( 2) =       0.000422197418
  error estimate for blocks of size 2^( 3) =       0.000431584666
  error estimate for blocks of size 2^( 4) =       0.000438776349
  error estimate for blocks of size 2^( 5) =       0.000442051282
  error estimate for blocks of size 2^( 6) =       0.000444161378
  error estimate for blocks of size 2^( 7) =       0.000445622353

      target function =                  N/A
              le_mean =     -17.211746245782
             les_mean =     296.583343736461
             stat err =       0.000442652841
             autocorr =       1.155536839551
              std dev =       0.582353051699
             le_variance =       0.339135076824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157098360
                                         uncertainty =       0.003015442119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157098360
                                         uncertainty =       0.003015442119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411787614
  error estimate for blocks of size 2^( 2) =       0.000422198879
  error estimate for blocks of size 2^( 3) =       0.000431585164
  error estimate for blocks of size 2^( 4) =       0.000438776421
  error estimate for blocks of size 2^( 5) =       0.000442051449
  error estimate for blocks of size 2^( 6) =       0.000444162699
  error estimate for blocks of size 2^( 7) =       0.000445624136

      target function =                  N/A
              le_mean =     -17.211746025454
             les_mean =     296.583339153278
             stat err =       0.000442653676
             autocorr =       1.155530974073
              std dev =       0.582355628571
             le_variance =       0.339138078128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339156485766
                                         uncertainty =       0.003015510405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339156485766
                                         uncertainty =       0.003015510405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411787245
  error estimate for blocks of size 2^( 2) =       0.000422198627
  error estimate for blocks of size 2^( 3) =       0.000431585274
  error estimate for blocks of size 2^( 4) =       0.000438776682
  error estimate for blocks of size 2^( 5) =       0.000442051656
  error estimate for blocks of size 2^( 6) =       0.000444162479
  error estimate for blocks of size 2^( 7) =       0.000445623691

      target function =                  N/A
              le_mean =     -17.211746085661
             les_mean =     296.583340617850
             stat err =       0.000442653627
             autocorr =       1.155532788997
              std dev =       0.582355106587
             le_variance =       0.339137470168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339154424461
                                         uncertainty =       0.003015584085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339154424461
                                         uncertainty =       0.003015584085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411785999
  error estimate for blocks of size 2^( 2) =       0.000422197591
  error estimate for blocks of size 2^( 3) =       0.000431584760
  error estimate for blocks of size 2^( 4) =       0.000438776409
  error estimate for blocks of size 2^( 5) =       0.000442051347
  error estimate for blocks of size 2^( 6) =       0.000444161539
  error estimate for blocks of size 2^( 7) =       0.000445622541

      target function =                  N/A
              le_mean =     -17.211746224607
             les_mean =     296.583343348369
             stat err =       0.000442652959
             autocorr =       1.155536294022
              std dev =       0.582353344347
             le_variance =       0.339135417672


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211746245782        initial  <--
     1.4552e+00     1.4552e+01             9.4654e-05       -17.211746025454
     5.8208e+00     5.8208e+01             2.4206e-05       -17.211746085661
     2.3283e+01     2.3283e+02             6.0861e-06       -17.211746224607

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.4689
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.200596e-01 1 1  ON 0
 uu_1                 5.345395e-02 1 1  ON 1
 uu_2                -4.628113e-02 1 1  ON 2
 uu_3                -1.035636e-01 1 1  ON 3
 uu_4                -1.367571e-01 1 1  ON 4
 uu_5                -1.428297e-01 1 1  ON 5
 uu_6                -1.197556e-01 1 1  ON 6
 uu_7                -5.045306e-02 1 1  ON 7
 uu_8                 8.987969e-02 1 1  ON 8
 uu_9                 1.304232e-01 1 1  ON 9
 ud_0                 3.679676e-01 1 1  ON 10
 ud_1                 1.020702e-01 1 1  ON 11
 ud_2                -1.449373e-02 1 1  ON 12
 ud_3                -7.788362e-02 1 1  ON 13
 ud_4                -1.257718e-01 1 1  ON 14
 ud_5                -1.571125e-01 1 1  ON 15
 ud_6                -1.595767e-01 1 1  ON 16
 ud_7                -1.160269e-01 1 1  ON 17
 ud_8                -1.494143e-02 1 1  ON 18
 ud_9                 9.188083e-02 1 1  ON 19
 eO_0                -8.092231e-01 1 1  ON 20
 eO_1                -4.763734e-01 1 1  ON 21
 eO_2                -4.793817e-02 1 1  ON 22
 eO_3                 2.201860e-01 1 1  ON 23
 eO_4                 3.204299e-01 1 1  ON 24
 eO_5                 3.341709e-01 1 1  ON 25
 eO_6                 2.653781e-01 1 1  ON 26
 eO_7                 1.301314e-01 1 1  ON 27
 eO_8                 3.090658e-02 1 1  ON 28
 eO_9                 1.995491e-02 1 1  ON 29
eH1_0                -1.851229e-01 1 1  ON 30
eH1_1                -1.061611e-01 1 1  ON 31
eH1_2                -6.332965e-02 1 1  ON 32
eH1_3                -2.547516e-02 1 1  ON 33
eH1_4                 1.886367e-02 1 1  ON 34
eH1_5                 3.132007e-02 1 1  ON 35
eH1_6                 7.602325e-02 1 1  ON 36
eH1_7                 1.081384e-01 1 1  ON 37
eH1_8                 1.009035e-01 1 1  ON 38
eH1_9                 2.807114e-02 1 1  ON 39
eH2_0                -1.868879e-01 1 1  ON 40
eH2_1                -1.072970e-01 1 1  ON 41
eH2_2                -6.453864e-02 1 1  ON 42
eH2_3                -2.673512e-02 1 1  ON 43
eH2_4                 1.784578e-02 1 1  ON 44
eH2_5                 3.040187e-02 1 1  ON 45
eH2_6                 7.670468e-02 1 1  ON 46
eH2_7                 1.123028e-01 1 1  ON 47
eH2_8                 1.046834e-01 1 1  ON 48
eH2_9                 2.962865e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0045e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.0758
    reference variance = 0.329997
====================================================
  Execution time = 3.7412e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4560e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0480e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345662869637
                                         uncertainty =       0.005564857127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345662869637
                                         uncertainty =       0.005564857127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415692177
  error estimate for blocks of size 2^( 2) =       0.000426267522
  error estimate for blocks of size 2^( 3) =       0.000435432391
  error estimate for blocks of size 2^( 4) =       0.000441911416
  error estimate for blocks of size 2^( 5) =       0.000446243242
  error estimate for blocks of size 2^( 6) =       0.000448236567
  error estimate for blocks of size 2^( 7) =       0.000450846186

      target function =                  N/A
              le_mean =     -17.211956576833
             les_mean =     296.597049001699
             stat err =       0.000446809353
             autocorr =       1.155316053499
              std dev =       0.587877514212
             le_variance =       0.345599971716


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721195657683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211956576833       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211956653848       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211956676990       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211956727554       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211956726743       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211956741658       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211956745834       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.249272e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211956576833       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211956596317       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211956602294       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211956615139       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211956615249       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211956618923       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211956619948       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.133320e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211956576833       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211956581719       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211956583225       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211956586450       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211956586498       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211956587413       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211956587668       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 7.839670e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.553092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7900e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.200597e-01 1 1  ON 0
 uu_1                 5.345526e-02 1 1  ON 1
 uu_2                -4.628234e-02 1 1  ON 2
 uu_3                -1.035628e-01 1 1  ON 3
 uu_4                -1.367575e-01 1 1  ON 4
 uu_5                -1.428282e-01 1 1  ON 5
 uu_6                -1.197573e-01 1 1  ON 6
 uu_7                -5.045460e-02 1 1  ON 7
 uu_8                 8.987864e-02 1 1  ON 8
 uu_9                 1.304242e-01 1 1  ON 9
 ud_0                 3.679673e-01 1 1  ON 10
 ud_1                 1.020718e-01 1 1  ON 11
 ud_2                -1.449309e-02 1 1  ON 12
 ud_3                -7.788318e-02 1 1  ON 13
 ud_4                -1.257713e-01 1 1  ON 14
 ud_5                -1.571122e-01 1 1  ON 15
 ud_6                -1.595779e-01 1 1  ON 16
 ud_7                -1.160276e-01 1 1  ON 17
 ud_8                -1.494334e-02 1 1  ON 18
 ud_9                 9.188048e-02 1 1  ON 19
 eO_0                -8.092262e-01 1 1  ON 20
 eO_1                -4.763755e-01 1 1  ON 21
 eO_2                -4.793950e-02 1 1  ON 22
 eO_3                 2.201876e-01 1 1  ON 23
 eO_4                 3.204292e-01 1 1  ON 24
 eO_5                 3.341726e-01 1 1  ON 25
 eO_6                 2.653797e-01 1 1  ON 26
 eO_7                 1.301331e-01 1 1  ON 27
 eO_8                 3.090681e-02 1 1  ON 28
 eO_9                 1.995505e-02 1 1  ON 29
eH1_0                -1.851226e-01 1 1  ON 30
eH1_1                -1.061601e-01 1 1  ON 31
eH1_2                -6.332925e-02 1 1  ON 32
eH1_3                -2.547747e-02 1 1  ON 33
eH1_4                 1.886277e-02 1 1  ON 34
eH1_5                 3.132047e-02 1 1  ON 35
eH1_6                 7.602300e-02 1 1  ON 36
eH1_7                 1.081385e-01 1 1  ON 37
eH1_8                 1.009045e-01 1 1  ON 38
eH1_9                 2.807136e-02 1 1  ON 39
eH2_0                -1.868881e-01 1 1  ON 40
eH2_1                -1.072963e-01 1 1  ON 41
eH2_2                -6.453866e-02 1 1  ON 42
eH2_3                -2.673473e-02 1 1  ON 43
eH2_4                 1.784541e-02 1 1  ON 44
eH2_5                 3.040095e-02 1 1  ON 45
eH2_6                 7.670391e-02 1 1  ON 46
eH2_7                 1.123024e-01 1 1  ON 47
eH2_8                 1.046845e-01 1 1  ON 48
eH2_9                 2.962904e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.184
    reference variance = 0.196265
====================================================
  Execution time = 3.6884e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.4278e-01
  Total weights = 2.0000e+06
  Execution time = 3.0967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342759119693
                                         uncertainty =       0.004416688032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342759119693
                                         uncertainty =       0.004416688032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413992822
  error estimate for blocks of size 2^( 2) =       0.000424412740
  error estimate for blocks of size 2^( 3) =       0.000434440427
  error estimate for blocks of size 2^( 4) =       0.000441103968
  error estimate for blocks of size 2^( 5) =       0.000445271478
  error estimate for blocks of size 2^( 6) =       0.000448080768
  error estimate for blocks of size 2^( 7) =       0.000448442224

      target function =                  N/A
              le_mean =     -17.212715801185
             les_mean =     296.620365193622
             stat err =       0.000445724609
             autocorr =       1.159171259076
              std dev =       0.585474263018
             le_variance =       0.342780112657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342757386904
                                         uncertainty =       0.004416719962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342757386904
                                         uncertainty =       0.004416719962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413991772
  error estimate for blocks of size 2^( 2) =       0.000424411779
  error estimate for blocks of size 2^( 3) =       0.000434439526
  error estimate for blocks of size 2^( 4) =       0.000441103086
  error estimate for blocks of size 2^( 5) =       0.000445270624
  error estimate for blocks of size 2^( 6) =       0.000448079915
  error estimate for blocks of size 2^( 7) =       0.000448441143

      target function =                  N/A
              le_mean =     -17.212715834851
             les_mean =     296.620364614424
             stat err =       0.000445723692
             autocorr =       1.159172365260
              std dev =       0.585472778615
             le_variance =       0.342778374499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342758219695
                                         uncertainty =       0.004416704018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342758219695
                                         uncertainty =       0.004416704018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413992276
  error estimate for blocks of size 2^( 2) =       0.000424412240
  error estimate for blocks of size 2^( 3) =       0.000434439958
  error estimate for blocks of size 2^( 4) =       0.000441103508
  error estimate for blocks of size 2^( 5) =       0.000445271033
  error estimate for blocks of size 2^( 6) =       0.000448080324
  error estimate for blocks of size 2^( 7) =       0.000448441663

      target function =                  N/A
              le_mean =     -17.212715818716
             les_mean =     296.620364894376
             stat err =       0.000445724132
             autocorr =       1.159171829352
              std dev =       0.585473492056
             le_variance =       0.342779209901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342759006045
                                         uncertainty =       0.004416690031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342759006045
                                         uncertainty =       0.004416690031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413992753
  error estimate for blocks of size 2^( 2) =       0.000424412676
  error estimate for blocks of size 2^( 3) =       0.000434440368
  error estimate for blocks of size 2^( 4) =       0.000441103910
  error estimate for blocks of size 2^( 5) =       0.000445271422
  error estimate for blocks of size 2^( 6) =       0.000448080712
  error estimate for blocks of size 2^( 7) =       0.000448442153

      target function =                  N/A
              le_mean =     -17.212715803390
             les_mean =     296.620365155553
             stat err =       0.000445724549
             autocorr =       1.159171330886
              std dev =       0.585474165666
             le_variance =       0.342779998662


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212715801185        initial
     1.4552e+01     1.4552e+02             1.2493e-05       -17.212715834851  <--
     5.8208e+01     5.8208e+02             3.1333e-06       -17.212715818716
     2.3283e+02     2.3283e+03             7.8397e-07       -17.212715803390

*****************************************************************************
Applying the update for shift_i =   1.4552e+01     and shift_s =   1.4552e+02
*****************************************************************************

  Execution time = 5.2436e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.200599e-01 1 1  ON 0
 uu_1                 5.345904e-02 1 1  ON 1
 uu_2                -4.628583e-02 1 1  ON 2
 uu_3                -1.035602e-01 1 1  ON 3
 uu_4                -1.367585e-01 1 1  ON 4
 uu_5                -1.428237e-01 1 1  ON 5
 uu_6                -1.197624e-01 1 1  ON 6
 uu_7                -5.045922e-02 1 1  ON 7
 uu_8                 8.987551e-02 1 1  ON 8
 uu_9                 1.304272e-01 1 1  ON 9
 ud_0                 3.679667e-01 1 1  ON 10
 ud_1                 1.020765e-01 1 1  ON 11
 ud_2                -1.449117e-02 1 1  ON 12
 ud_3                -7.788186e-02 1 1  ON 13
 ud_4                -1.257697e-01 1 1  ON 14
 ud_5                -1.571113e-01 1 1  ON 15
 ud_6                -1.595816e-01 1 1  ON 16
 ud_7                -1.160295e-01 1 1  ON 17
 ud_8                -1.494907e-02 1 1  ON 18
 ud_9                 9.187944e-02 1 1  ON 19
 eO_0                -8.092356e-01 1 1  ON 20
 eO_1                -4.763816e-01 1 1  ON 21
 eO_2                -4.794348e-02 1 1  ON 22
 eO_3                 2.201925e-01 1 1  ON 23
 eO_4                 3.204269e-01 1 1  ON 24
 eO_5                 3.341776e-01 1 1  ON 25
 eO_6                 2.653847e-01 1 1  ON 26
 eO_7                 1.301385e-01 1 1  ON 27
 eO_8                 3.090750e-02 1 1  ON 28
 eO_9                 1.995549e-02 1 1  ON 29
eH1_0                -1.851217e-01 1 1  ON 30
eH1_1                -1.061574e-01 1 1  ON 31
eH1_2                -6.332812e-02 1 1  ON 32
eH1_3                -2.548430e-02 1 1  ON 33
eH1_4                 1.886006e-02 1 1  ON 34
eH1_5                 3.132167e-02 1 1  ON 35
eH1_6                 7.602225e-02 1 1  ON 36
eH1_7                 1.081388e-01 1 1  ON 37
eH1_8                 1.009076e-01 1 1  ON 38
eH1_9                 2.807201e-02 1 1  ON 39
eH2_0                -1.868889e-01 1 1  ON 40
eH2_1                -1.072943e-01 1 1  ON 41
eH2_2                -6.453868e-02 1 1  ON 42
eH2_3                -2.673359e-02 1 1  ON 43
eH2_4                 1.784429e-02 1 1  ON 44
eH2_5                 3.039819e-02 1 1  ON 45
eH2_6                 7.670160e-02 1 1  ON 46
eH2_7                 1.123014e-01 1 1  ON 47
eH2_8                 1.046877e-01 1 1  ON 48
eH2_9                 2.963018e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0034e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1577
    reference variance = 0.198604
====================================================
  Execution time = 3.7423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4167e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0470e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341716908550
                                         uncertainty =       0.003165020220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341716908550
                                         uncertainty =       0.003165020220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413323610
  error estimate for blocks of size 2^( 2) =       0.000423886314
  error estimate for blocks of size 2^( 3) =       0.000433382440
  error estimate for blocks of size 2^( 4) =       0.000440770685
  error estimate for blocks of size 2^( 5) =       0.000444539127
  error estimate for blocks of size 2^( 6) =       0.000446468140
  error estimate for blocks of size 2^( 7) =       0.000449149851

      target function =                  N/A
              le_mean =     -17.211172581197
             les_mean =     296.566134262443
             stat err =       0.000445231951
             autocorr =       1.160358576777
              std dev =       0.584527855218
             le_variance =       0.341672813526


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721117258120e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211172581197       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211172700584       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211172836130       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211172857764       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211173069583       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211173031581       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211173025837       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 4.233033e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211172581197       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211172612358       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211172647996       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211172653334       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211172706188       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211172697345       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211172695957       residual = 7.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.062570e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211172581197       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211172589074       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211172598101       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211172599434       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211172612616       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211172610463       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211172610113       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 2.658361e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.556233 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7901e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.200624e-01 1 1  ON 0
 uu_1                 5.345946e-02 1 1  ON 1
 uu_2                -4.627801e-02 1 1  ON 2
 uu_3                -1.035621e-01 1 1  ON 3
 uu_4                -1.367560e-01 1 1  ON 4
 uu_5                -1.428292e-01 1 1  ON 5
 uu_6                -1.197662e-01 1 1  ON 6
 uu_7                -5.046276e-02 1 1  ON 7
 uu_8                 8.987102e-02 1 1  ON 8
 uu_9                 1.304298e-01 1 1  ON 9
 ud_0                 3.679746e-01 1 1  ON 10
 ud_1                 1.020714e-01 1 1  ON 11
 ud_2                -1.449110e-02 1 1  ON 12
 ud_3                -7.788324e-02 1 1  ON 13
 ud_4                -1.257752e-01 1 1  ON 14
 ud_5                -1.571082e-01 1 1  ON 15
 ud_6                -1.595759e-01 1 1  ON 16
 ud_7                -1.160311e-01 1 1  ON 17
 ud_8                -1.495516e-02 1 1  ON 18
 ud_9                 9.187915e-02 1 1  ON 19
 eO_0                -8.092396e-01 1 1  ON 20
 eO_1                -4.763897e-01 1 1  ON 21
 eO_2                -4.795094e-02 1 1  ON 22
 eO_3                 2.201819e-01 1 1  ON 23
 eO_4                 3.204292e-01 1 1  ON 24
 eO_5                 3.341878e-01 1 1  ON 25
 eO_6                 2.653926e-01 1 1  ON 26
 eO_7                 1.301466e-01 1 1  ON 27
 eO_8                 3.090856e-02 1 1  ON 28
 eO_9                 1.995583e-02 1 1  ON 29
eH1_0                -1.851210e-01 1 1  ON 30
eH1_1                -1.061653e-01 1 1  ON 31
eH1_2                -6.332751e-02 1 1  ON 32
eH1_3                -2.549082e-02 1 1  ON 33
eH1_4                 1.886781e-02 1 1  ON 34
eH1_5                 3.132240e-02 1 1  ON 35
eH1_6                 7.602044e-02 1 1  ON 36
eH1_7                 1.081391e-01 1 1  ON 37
eH1_8                 1.009123e-01 1 1  ON 38
eH1_9                 2.807327e-02 1 1  ON 39
eH2_0                -1.868946e-01 1 1  ON 40
eH2_1                -1.072960e-01 1 1  ON 41
eH2_2                -6.453952e-02 1 1  ON 42
eH2_3                -2.674018e-02 1 1  ON 43
eH2_4                 1.785115e-02 1 1  ON 44
eH2_5                 3.040081e-02 1 1  ON 45
eH2_6                 7.670183e-02 1 1  ON 46
eH2_7                 1.123000e-01 1 1  ON 47
eH2_8                 1.046917e-01 1 1  ON 48
eH2_9                 2.963179e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1766
    reference variance = 0.176425
====================================================
  Execution time = 3.8473e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5367e-01
  Total weights = 2.0000e+06
  Execution time = 3.1175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353735267648
                                         uncertainty =       0.010929794394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353735267648
                                         uncertainty =       0.010929794394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420516883
  error estimate for blocks of size 2^( 2) =       0.000430849081
  error estimate for blocks of size 2^( 3) =       0.000440166811
  error estimate for blocks of size 2^( 4) =       0.000447068982
  error estimate for blocks of size 2^( 5) =       0.000451558979
  error estimate for blocks of size 2^( 6) =       0.000453176154
  error estimate for blocks of size 2^( 7) =       0.000455404773

      target function =                  N/A
              le_mean =     -17.211698443635
             les_mean =     296.596232035054
             stat err =       0.000451802222
             autocorr =       1.154329653627
              std dev =       0.594700678710
             le_variance =       0.353668897258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353756632029
                                         uncertainty =       0.010929974308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353756632029
                                         uncertainty =       0.010929974308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420529582
  error estimate for blocks of size 2^( 2) =       0.000430861250
  error estimate for blocks of size 2^( 3) =       0.000440178781
  error estimate for blocks of size 2^( 4) =       0.000447080709
  error estimate for blocks of size 2^( 5) =       0.000451570772
  error estimate for blocks of size 2^( 6) =       0.000453187680
  error estimate for blocks of size 2^( 7) =       0.000455416876

      target function =                  N/A
              le_mean =     -17.211698588337
             les_mean =     296.596258377726
             stat err =       0.000451814009
             autocorr =       1.154320163852
              std dev =       0.594718638358
             le_variance =       0.353690258810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353747053157
                                         uncertainty =       0.010929884088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353747053157
                                         uncertainty =       0.010929884088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420523888
  error estimate for blocks of size 2^( 2) =       0.000430855799
  error estimate for blocks of size 2^( 3) =       0.000440173421
  error estimate for blocks of size 2^( 4) =       0.000447075458
  error estimate for blocks of size 2^( 5) =       0.000451565491
  error estimate for blocks of size 2^( 6) =       0.000453182519
  error estimate for blocks of size 2^( 7) =       0.000455411449

      target function =                  N/A
              le_mean =     -17.211698519293
             les_mean =     296.596246423238
             stat err =       0.000451808729
             autocorr =       1.154324445427
              std dev =       0.594710585958
             le_variance =       0.353680681051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353736777798
                                         uncertainty =       0.010929805581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353736777798
                                         uncertainty =       0.010929805581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420517780
  error estimate for blocks of size 2^( 2) =       0.000430849942
  error estimate for blocks of size 2^( 3) =       0.000440167659
  error estimate for blocks of size 2^( 4) =       0.000447069812
  error estimate for blocks of size 2^( 5) =       0.000451559813
  error estimate for blocks of size 2^( 6) =       0.000453176970
  error estimate for blocks of size 2^( 7) =       0.000455405628

      target function =                  N/A
              le_mean =     -17.211698453049
             les_mean =     296.596233869034
             stat err =       0.000451803056
             autocorr =       1.154328986547
              std dev =       0.594701948190
             le_variance =       0.353670407181


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211698443635        initial
     3.6380e+00     3.6380e+01             4.2330e-05       -17.211698588337  <--
     1.4552e+01     1.4552e+02             1.0626e-05       -17.211698519293
     5.8208e+01     5.8208e+02             2.6584e-06       -17.211698453049

*****************************************************************************
Applying the update for shift_i =   3.6380e+00     and shift_s =   3.6380e+01
*****************************************************************************

  Execution time = 5.4157e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.200698e-01 1 1  ON 0
 uu_1                 5.346208e-02 1 1  ON 1
 uu_2                -4.625710e-02 1 1  ON 2
 uu_3                -1.035660e-01 1 1  ON 3
 uu_4                -1.367493e-01 1 1  ON 4
 uu_5                -1.428450e-01 1 1  ON 5
 uu_6                -1.197772e-01 1 1  ON 6
 uu_7                -5.047321e-02 1 1  ON 7
 uu_8                 8.985774e-02 1 1  ON 8
 uu_9                 1.304373e-01 1 1  ON 9
 ud_0                 3.679948e-01 1 1  ON 10
 ud_1                 1.020584e-01 1 1  ON 11
 ud_2                -1.449103e-02 1 1  ON 12
 ud_3                -7.788714e-02 1 1  ON 13
 ud_4                -1.257901e-01 1 1  ON 14
 ud_5                -1.570998e-01 1 1  ON 15
 ud_6                -1.595589e-01 1 1  ON 16
 ud_7                -1.160356e-01 1 1  ON 17
 ud_8                -1.497313e-02 1 1  ON 18
 ud_9                 9.187830e-02 1 1  ON 19
 eO_0                -8.092529e-01 1 1  ON 20
 eO_1                -4.764127e-01 1 1  ON 21
 eO_2                -4.797272e-02 1 1  ON 22
 eO_3                 2.201502e-01 1 1  ON 23
 eO_4                 3.204359e-01 1 1  ON 24
 eO_5                 3.342181e-01 1 1  ON 25
 eO_6                 2.654162e-01 1 1  ON 26
 eO_7                 1.301709e-01 1 1  ON 27
 eO_8                 3.091170e-02 1 1  ON 28
 eO_9                 1.995683e-02 1 1  ON 29
eH1_0                -1.851191e-01 1 1  ON 30
eH1_1                -1.061882e-01 1 1  ON 31
eH1_2                -6.332660e-02 1 1  ON 32
eH1_3                -2.550935e-02 1 1  ON 33
eH1_4                 1.889038e-02 1 1  ON 34
eH1_5                 3.132479e-02 1 1  ON 35
eH1_6                 7.601514e-02 1 1  ON 36
eH1_7                 1.081401e-01 1 1  ON 37
eH1_8                 1.009262e-01 1 1  ON 38
eH1_9                 2.807699e-02 1 1  ON 39
eH2_0                -1.869111e-01 1 1  ON 40
eH2_1                -1.073016e-01 1 1  ON 41
eH2_2                -6.454256e-02 1 1  ON 42
eH2_3                -2.675873e-02 1 1  ON 43
eH2_4                 1.787106e-02 1 1  ON 44
eH2_5                 3.040885e-02 1 1  ON 45
eH2_6                 7.670263e-02 1 1  ON 46
eH2_7                 1.122960e-01 1 1  ON 47
eH2_8                 1.047039e-01 1 1  ON 48
eH2_9                 2.963655e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0206e+02 secs
  Total Execution time = 4.0595e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
